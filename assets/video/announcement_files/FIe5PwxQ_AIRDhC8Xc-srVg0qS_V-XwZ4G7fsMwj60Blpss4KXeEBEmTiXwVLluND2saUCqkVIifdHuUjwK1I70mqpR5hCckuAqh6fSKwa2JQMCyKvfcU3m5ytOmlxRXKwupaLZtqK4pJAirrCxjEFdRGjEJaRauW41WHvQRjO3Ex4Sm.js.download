;/*FB_PKG_DELIM*/

__d("EBGetContactEpochHead",["EBMinosSecureMailboxKeysForContact","WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";async function e(e){var t=e.rawContactId;if(t==null)return Promise.reject(o("WAResultOrError").makeError("invalid-arguments"));var n=await o("EBMinosSecureMailboxKeysForContact").getSecureMailboxKeysForContact(t);return n==null?o("WAResultOrError").makeResult():o("WAResultOrError").makeResult({epochHead:n.epoch_head,epochHeadCreationTime:n.epoch_head_creation_time})}l.getContactEpochHead=e}),98);
__d("EBGetMessageKeys",["EBMinosDb","FBLogger","WAResultOrError","WebMps","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e,s=async function(t,n){var e=await o("EBMinosDb").getEBMinosDb(),r=await e.runInTransaction(["secure_minos_message_epoch_heads"],"readonly",function(e){return e.stores.secure_minos_message_epoch_heads.readIndex("[thread_id+message_id]",[t,n])},"LoadNewMinosMessageEpochHead");return r.length===0?null:{epochHead:r[0].epoch_head}};async function u(t){var n=t.messageId,a=t.threadId;try{if(n==null||a==null)return o("WAResultOrError").makeError("invalid-arguments");var i=await o("WebMps").mps().loadMessage({config:{shouldFetchSupplementals:!0,strategy:"local-only"},debug:{purpose:"get-message-keys"},messageId:n,threadId:a}),l=await s(a,n);if(l==null)return o("WAResultOrError").makeError("no-epoch-head-found");if(i.success===!1)return o("WAResultOrError").makeError(i.error);var u=i.value;if(u==null)return o("WAResultOrError").makeError("no-message");var c=new Map;await Promise.all(Array.from(u.supplementalProtobufs).map(async function(e){var t=e[0],n=e[1],r=await s(a,n.messageId);if(r==null)return o("WAResultOrError").makeError("no-epoch-head-found");c.set(t,babelHelpers.extends({},n,{senderEpochHead:r.epochHead}))}));var d=babelHelpers.extends({},u.toplevelProtobuf,{senderEpochHead:l.epochHead});return o("WAResultOrError").makeResult(babelHelpers.extends({},u,{supplementalProtobufs:c,toplevelProtobuf:d}))}catch(t){throw r("FBLogger")("wmi_minos").catching(r("getErrorSafe")(t)).MUSTFIX(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Runtime error in EBGetMessageKeys"]))),t}}l.getMessageKeys=u}),98);
__d("MAWAdminWriteUserDeviceMsgTxn",["MAWAckLevel","MAWAdminMsgHelpers","MAWDbMsgTxns","MAWDexieTable","MAWExternalId","MAWGetUserDeviceChangeAdminType","MAWLocalizationType","MAWLocalizationUtils","MAWMsgType","MAWUserJidWrapper","MAWWriteMsgTxns","WAJids","WATimeUtils","emptyFunction"],(function(t,n,r,o,a,i,l){"use strict";var e={add:"add",remove:"remove",update:"update"};function s(e,t,n,a,i){return o("MAWDbMsgTxns").getIsThreadEmpty(e,n.jid).then(function(l){if(l)return o("MAWDexieTable").dexieResolve();var s=t===o("MAWUserJidWrapper").getMyUserJid(),u=o("MAWGetUserDeviceChangeAdminType").getUserDeviceAdminType(a,s),c=s?[]:[o("WAJids").userIdFromJid(t)],d=o("MAWLocalizationUtils").buildUnstoredDbAdminMsg({adminMsgContent:c,adminType:u,version:1},n.jid,o("MAWExternalId").generateExternalId(),i);return o("MAWWriteMsgTxns").writeMsg(e,d,n).then(r("emptyFunction"))})}function u(e,t,n,a){var i=o("MAWAdminMsgHelpers").UNKNOWN_USER,l=t===o("MAWUserJidWrapper").getMyUserJid(),s={ack:o("MAWAckLevel").ACK.received,altIndex:void 0,author:l?o("WAJids").AUTHOR_ME:t,externalId:o("MAWExternalId").generateExternalId(),msgContent:{adminType:o("MAWLocalizationType").LOCALIZATION_TYPE.ICDC_ALERT_ADMIN_MESSAGE,authorName:i},threadJid:n.jid,ts:a!=null?a:o("WATimeUtils").unixTime(),type:o("MAWMsgType").MSG_TYPE.ICDC_ALERT};return o("MAWWriteMsgTxns").writeMsg(e,s,n).then(r("emptyFunction"))}l.DeviceChange=e,l.writeUserDeviceAdminMsg=s,l.writeICDCAlert=u}),98);
__d("MpsFutureProofKey",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum")({WCEPlaintextPayloadFutureProofPlaceholder:0,WCEPlaintextPayloadFutureProofNoPlaceholder:1,WCEPlaintextPayloadFutureProofIgnore:2});i.WCEPlaintextPayloadFutureProof=e}),66);
__d("WABuildMpsPayload",["MpsFutureProofKey","MpsTypes","WAArmadilloBackupMessage.pb","WAArmadilloMiTransportAdminMessage.pb","WAArmadilloTransportEvent.pb","WAGlobals","WAJids","WALogger","WATimeUtils","encodeProtobuf"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;function c(e,t){var n=o("WAJids").extractUserId(t.senderJid),r;t.hideDecryptionFailure!=null&&(r=t.hideDecryptionFailure?o("MpsFutureProofKey").WCEPlaintextPayloadFutureProof.WCEPlaintextPayloadFutureProofNoPlaceholder:o("MpsFutureProofKey").WCEPlaintextPayloadFutureProof.WCEPlaintextPayloadFutureProofPlaceholder);var a=o("encodeProtobuf").encodeProtobuf(o("WAArmadilloBackupMessage.pb").BackupMessageSpec,babelHelpers.extends({},e,{metadata:{frankingMetadata:{frankingTag:t.frankingTag,reportingTag:t.reportingTag},messageId:t.externalId,payloadVersion:2,senderId:n,futureProofBehavior:r,timestampMs:t.timestampMs}})).readBuffer();return a}function d(e,t){var n=o("WAJids").extractUserId(t.senderJid),r=o("MpsTypes").toThreadId(t.threadId),a=t.millisServerTs!=null?t.millisServerTs:t.serverTs*1e3+o("WAGlobals").getDependencies().extractMsFromStanzaId(t.externalId),i=c(e,{senderJid:t.senderJid,externalId:t.externalId,frankingTag:t.frankingTag,reportingTag:t.reportingTag,hideDecryptionFailure:t.hideDecryptionFailure,threadId:t.threadId,timestampMs:o("MpsTypes").toTimestamp(a)});return{messageId:o("MpsTypes").toMessageId(t.externalId),payload:o("MpsTypes").toBytes(i),senderId:n,threadId:r,timestampMs:o("MpsTypes").toTimestamp(a)}}function m(t,n,r){try{var a={};switch(r.type){case"message":a={encryptedTransportMessage:r.applicationPayload};break;case"ciphertext":a={encryptedTransportEvent:{payload:o("encodeProtobuf").encodeProtobuf(o("WAArmadilloTransportEvent.pb").TransportEventSpec,{placeholder:{type:o("WAArmadilloTransportEvent.pb").TransportEvent$Placeholder$Type.DECRYPTION_FAILURE}}).readBuffer(),version:3}};break;case"unavailable":a={encryptedTransportEvent:{payload:o("encodeProtobuf").encodeProtobuf(o("WAArmadilloTransportEvent.pb").TransportEventSpec,{placeholder:{type:o("WAArmadilloTransportEvent.pb").TransportEvent$Placeholder$Type.DECRYPTION_FAILURE}}).readBuffer(),version:3}};break;default:r.type}var i=n.type==="Available"?n.originalMsgTimestampMs:null;return d(a,babelHelpers.extends({senderJid:o("WAJids").extractUserJid(n.from),externalId:t.stanzaId},i!=null?{millisServerTs:o("WATimeUtils").castToMillisTime(i)}:{serverTs:t.serverTs},{frankingTag:t.frankingTag,reportingTag:t.reportingTag,hideDecryptionFailure:t.hideDecryptionFailure,threadId:n.chat}))}catch(t){return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["buildMpsMessagePayload: ",""])),t),null}}function p(e,t,n){if(n.payload==null)return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["buildMpsAppdataPayload: No appdata payload"]))),null;try{return d({encryptedTransportMessage:n.payload},{senderJid:o("WAJids").extractUserJid(e.from),externalId:e.stanzaId,serverTs:t,threadId:o("WAJids").extractUserJid(e.from)})}catch(e){return o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["buildMpsAppdataPayload: ",""])),e),null}}function _(e,t,n,r,a){var i={payload:o("encodeProtobuf").encodeProtobuf(o("WAArmadilloMiTransportAdminMessage.pb").MiTransportAdminMessageSpec,{groupMembershipAddModeChanged:{mode:n}}).readBuffer(),version:3};return d({miTransportAdminMessage:i},{serverTs:r!=null?r:o("WATimeUtils").unixTime(),externalId:a,hideDecryptionFailure:!1,senderJid:t,threadId:e})}function f(e,t,n,r,a,i){var l={payload:o("encodeProtobuf").encodeProtobuf(o("WAArmadilloMiTransportAdminMessage.pb").MiTransportAdminMessageSpec,{groupAdminChanged:{targetUserId:n.map(o("WAJids").extractUserId),action:r}}).readBuffer(),version:3};return d({miTransportAdminMessage:l},{serverTs:a!=null?a:o("WATimeUtils").unixTime(),externalId:i,hideDecryptionFailure:!1,senderJid:t,threadId:e})}function g(e,t,n,r,a,i){var l={payload:o("encodeProtobuf").encodeProtobuf(o("WAArmadilloMiTransportAdminMessage.pb").MiTransportAdminMessageSpec,{groupParticipantChanged:{targetUserId:n.map(o("WAJids").extractUserId),action:r}}).readBuffer(),version:3};return d({miTransportAdminMessage:l},{serverTs:a!=null?a:o("WATimeUtils").unixTime(),externalId:i,hideDecryptionFailure:!1,senderJid:t,threadId:e})}function h(e,t,n,r,a){var i={payload:o("encodeProtobuf").encodeProtobuf(o("WAArmadilloMiTransportAdminMessage.pb").MiTransportAdminMessageSpec,{groupNameChanged:{groupName:n}}).readBuffer(),version:3};return d({miTransportAdminMessage:i},{serverTs:r!=null?r:o("WATimeUtils").unixTime(),externalId:a,hideDecryptionFailure:!1,senderJid:t,threadId:e})}function y(e,t,n){var r={payload:o("encodeProtobuf").encodeProtobuf(o("WAArmadilloTransportEvent.pb").TransportEventSpec,{event:{icdcAlert:{type:o("WAArmadilloTransportEvent.pb").TransportEvent$Event$IcdcAlert$Type.DETECTED}}}).readBuffer(),version:3};return d({encryptedTransportEvent:r},{serverTs:t!=null?t:o("WATimeUtils").unixTime(),externalId:n,hideDecryptionFailure:!1,senderJid:e,threadId:e})}function C(e,t,n,r,a,i){var l={payload:o("encodeProtobuf").encodeProtobuf(o("WAArmadilloTransportEvent.pb").TransportEventSpec,{event:{deviceChange:{type:r,devicePlatform:a,deviceModel:i}}}).readBuffer(),version:3};return d({encryptedTransportEvent:l},{serverTs:t!=null?t:o("WATimeUtils").unixTime(),externalId:n,hideDecryptionFailure:!1,senderJid:e,threadId:e})}l.buildBackupProtobufBytes=c,l.buildMpsMessage=d,l.buildMpsMessageFromIncomingMessage=m,l.buildMpsAppdataPayload=p,l.buildMpsGroupMemberAddType=_,l.buildMpsGroupAdminChangedMsg=f,l.buildMpsGroupParticipantsChanged=g,l.buildMpsGroupNameChangedMsg=h,l.buildMpsIcdcAdminMessage=y,l.buildMpsDeviceChangeAdminMessage=C}),98);
__d("EBMinosWriteKeyChangeAdminMessage",["EBMinosTypes","FBLogger","MAWAdminWriteUserDeviceMsgTxn","MAWBridge","MAWDbAppMeta","MAWDbThreadTxns","MAWDexieTable","MAWExternalId","MAWIndexedDb","MAWTransactionMode","MpsTypes","WAArmadilloTransportEvent.pb","WABuildMpsPayload","WADbContact","WAGlobals","WAJids","WAStanzaUtils","WebMps","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e){return e.appMeta.get({key:o("MAWDbAppMeta").AppMetaKeysEnum.allowSecurityAlert}).then(function(e){var t;return(t=e==null?void 0:e.value.allowSecurityAlert)!=null?t:!1})}function u(e,t){var n=o("WAGlobals").getMyUserJid()===t;return!n&&e}async function c(e){var t=e.deviceChangeType,n=t===void 0?o("WAArmadilloTransportEvent.pb").TransportEvent$Event$DeviceChange$Type.REPLACED:t,a=e.epochHeadCreationTime,i=e.userJid;try{var l=o("MAWExternalId").generateExternalId(),s=o("WABuildMpsPayload").buildMpsDeviceChangeAdminMessage(i,a,o("WAStanzaUtils").toStanzaId(l),n),u={directive:null,insertionSource:o("MpsTypes").InsertionSource.Receive,message:s};await o("WebMps").mps().saveNewMessages([u],{source:"eb-minos-device-change"}),r("FBLogger")("wmi_minos").info("Sent device change transport event for user %s with type %s",i,String(n))}catch(e){var c=r("getErrorSafe")(e);throw r("FBLogger")("wmi_minos").catching(c).mustfix("Failed to send device change transport event for user %s",i),c}}async function d(t){var n=t.contactId,a=t.epochHeadCreationTime,i=o("EBMinosTypes").userFbidToUserJid(n);if(i==null)return r("FBLogger")("wmi_minos").MUSTFIX(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Invalid userJid generated in writeKeyChangeAdminMessage"]))),Promise.resolve();var l=await o("MAWIndexedDb").makeMsgrTransactor({participants:o("MAWTransactionMode").READONLY,threads:o("MAWTransactionMode").READONLY},"writeKeyChangeAdminMessage",function(e){return function(){return o("MAWDbThreadTxns").getAllThreadsForUsers(e,[i])}})(),d=l.get(i),m=await o("MAWBridge").getBridge().sendAndReceive("event","getLSDBUsersRelationships",{users:[i]});if(d==null||(d==null?void 0:d.length)===0)return Promise.resolve();var p=d.filter(function(e){var t=o("WAJids").switchOnMsgrChatJidType(e.jid,{group:function(){return"group"},user:function(){return"one_to_one"}});return t==="one_to_one"}),_=await Promise.all([c({deviceChangeType:o("WAArmadilloTransportEvent.pb").TransportEvent$Event$DeviceChange$Type.REPLACED,epochHeadCreationTime:a,userJid:i}),o("MAWIndexedDb").makeMsgrTransactor({appMeta:o("MAWTransactionMode").READONLY,ftsBackloggedMessages:o("MAWTransactionMode").READWRITE,groupInfo:o("MAWTransactionMode").READONLY,messages:o("MAWTransactionMode").READWRITE,threads:o("MAWTransactionMode").READWRITE},"writeKeyChangeAdminMessage",function(e){return function(){return o("MAWDexieTable").dexieAll(p.map(function(t){return s(e).then(function(n){u(n,i)&&m.get(i)===o("WADbContact").TWO_WAY_CONTACT?o("MAWAdminWriteUserDeviceMsgTxn").writeUserDeviceAdminMsg(e,i,t,"update",a):o("MAWDexieTable").dexieResolve()})}))}})()]),f=_[1];return f}l.saveDeviceChangeTransportEvent=c,l.writeMinosKeyChangeAdminMessage=d}),98);
__d("MAWDbAddDeviceChangeAlertsTxn",[],(function(t,n,r,o,a,i){"use strict";function e(e,t){return e.deviceChangeAlerts.add(t)}i.addDeviceChangeAlertsTxn=e}),66);
__d("MAWDbDeviceChangeAlerts",[],(function(t,n,r,o,a,i){"use strict";var e="add",l="keyChange",s="remove";function u(e){return e}i.ADD=e,i.KEY_CHANGE=l,i.REMOVE=s,i.unsafeCoerceToDeviceChangeAlertsID=u}),66);
__d("WAXmlParsingFailure",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(e,t){this.parser=e,this.reason=t}var t=e.prototype;return t.toString=function(){return"XmlParsingFailure: "+this.parser+": "+this.reason},e})();i.XmlParsingFailure=e}),66);
__d("WAParsableXmlNode",["WAHasProperty","WAXmlParsingFailure","err"],(function(t,n,r,o,a,i,l){"use strict";function e(e){throw new TypeError('"'+e+'" is read-only')}var s=(function(){function e(e,t){var n=this;this.$1=e,this.$2=t,this.$3=Array.isArray(t.content)?t.content.map(function(t){return new n.constructor(e,t)}):null}var t=e.prototype;return t.name=function(){return this.$1},t.node=function(){return this.$2},t.hasAttr=function(t){return r("WAHasProperty")(this.$2.attrs,t)},t.assertTag=function(t){this.$2.tag!==t&&this.throw("to be <"+t+">")},t.tag=function(){return this.$2.tag},t.maybeChild=function(t){var e=this.$3;if(!e)return null;for(var n=0;n<e.length;n++)if(e[n].tag()===t)return e[n];return null},t.hasChild=function(t){return!!this.maybeChild(t)},t.child=function(t){var e=this.maybeChild(t);return e||this.throw("to have child <"+t+">")},t.assertAttr=function(t,n){var e=this.attrString(t);e!==n&&this.throw('to have "'+t+'"="'+n+'", but instead has "'+e+'"')},t.attrString=function(t){return r("WAHasProperty")(this.$2.attrs,t)?this.decodeAsString(this.$2.attrs[t]):this.throw('to have attribute "'+t+'"')},t.forEachAttributeKey=function(t){var e=this.$2.attrs;Object.keys(e).forEach(function(e){return t(e)})},t.maybeAttrString=function(t){return this.hasAttr(t)?this.decodeAsString(this.$2.attrs[t]):null},t.maybeAttrInt=function(t,n,r){return this.hasAttr(t)?this.attrInt(t,n,r):null},t.attrEnumValues=function(t,n,r){var e=new Set(n),o=this.attrString(t);if(!e.has(o)){if(r!=null)return r;var a=Array.from(e).join("|");return this.throw('to have "'+t+'"={'+a+'} but has value "'+o+'"')}return o},t.attrEnum=function(t,n){var e=this.attrString(t);if(!r("WAHasProperty")(n,e)){var o=Object.keys(n).join("|");return this.throw('to have "'+t+'"={'+o+'} but has value "'+e+'"')}return n[e]},t.attrEnumOrNullIfUnknown=function(t,n){var e=this.attrString(t);return r("WAHasProperty")(n,e)?n[e]:null},t.maybeAttrEnum=function(t,n){return this.hasAttr(t)?this.attrEnum(t,n):null},t.attrInt=function(t,n,r){var e=this.attrString(t);return this.$4(e,t,n,r)},t.$4=function(t,n,r,o){var e=parseInt(t,10);return Number.isNaN(e)?this.throw('to have "'+n+'"={integer} but has value "'+t+'"'):r!==void 0&&e<r?this.throw('to have "'+n+'"={at least '+r+"} but has value "+e):o!==void 0&&e>=o?this.throw('to have "'+n+'"={below '+o+"} but has value "+e):e},t.forEachChild=function(t){var e=this.$3;if(e)e.forEach(function(e){return t(e)});else if(this.$2.content!=null)return this.throw("to have children")},t.forEachChildWithTag=function(t,n){this.forEachChild(function(e){e.tag()===t&&n(e)})},t.mapChildren=function(t){var e=this.$3;return!e&&this.$2.content!=null?this.throw("to have children"):e?e.map(function(e){return t(e)}):[]},t.mapChildrenWithTag=function(t,n){var e=this.$3;return!e&&this.$2.content!=null?this.throw("to have children"):e?e.filter(function(e){return e.tag()===t}).map(function(e){return n(e)}):[]},t.mapFirstChild=function(t){var e=this.$3;return!e||e.length===0?this.throw("to have children"):t(e[0])},t.hasContent=function(){return!this.$3&&!!this.$2.content},t.hasChildren=function(){return this.$3!=null},t.getChildren=function(){return this.$3},t.mapAttrKeys=function(t){var e=this.getAttrKeys();return e&&e.length?e.map(t):[]},t.getAttrKeys=function(){return Object.keys(this.$2.attrs)},t.hasAttrs=function(){var e=this.$2.attrs?Object.keys(this.$2.attrs):[];return e.length>0},t.getNode=function(){return this.$2},t.unsafeSetChildren=function(t){this.$3=t},t.unsafeSetNodeContent=function(t){this.$2.content=t},t.contentUint=function(t){var e=this.contentBytes(t);return u(e,t)},t.contentBytes=function(t){if(t===void 0&&(t=-1),this.$3)return this.throw("to have binary content, but has children instead");if(this.$2.content!=null){var e=this.$2.content;return t!==-1&&e.length!==t?this.throw("to be "+t+" bytes, but got "+e.length+" instead"):e}else return this.throw("to have content")},t.contentString=function(){return this.$3?this.throw("to have string content, but has children instead"):this.$2.content!=null?this.$2.content:this.throw("to have content")},t.contentInt=function(t,n){var e=this.contentString();return this.$4(e,"content",t,n)},t.contentEnum=function(t){var e=this.contentString();if(!r("WAHasProperty")(t,e)){var n=Object.keys(t).join("|");return this.throw("to have content {"+n+'} but has value "'+e+'"')}return t[e]},t.decodeAsString=function(t){if(typeof t!="string")throw r("err")("decodeAsString: attribute is "+typeof t+" not a string: "+t);return t},t.throw=function(t){throw new(o("WAXmlParsingFailure")).XmlParsingFailure(this.$1,"expected <"+this.$2.tag+"> "+t)},t.toString=function(){return this.$2.toString()},e})();function u(e,t){for(var n=0,r=0;r<t;r++)n=n*256+e[r];return n}l.ParsableXmlNode=s,l.convertBytesToUint=u}),98);
__d("WASignalOther",["WACryptoDependencies","WACryptoHkdf","WACryptoUtils","WAParsableXmlNode","decodeProtobuf","encodeProtobuf","err"],(function(t,n,r,o,a,i,l){"use strict";var e={name:"AES-CBC"},s={name:"HMAC",hash:"SHA-256"};function u(e,t){if(e.length!==t)throw r("err")("Signal expected "+t+" bytes, given "+e.length);return e}function c(e,t){return u(new Uint8Array(e),t)}function d(e){var t=e.buffer,n=e.byteOffset,r=e.length;return n===0&&r===t.byteLength?t:t.slice(n,n+r)}function m(e,t){return e.readByteArrayView(t)}function p(e){return new Uint8Array(e)}function _(e,t,n){if(e.length-t<n)throw r("err")("Can not split off "+n+" bytes from index "+t+" of "+e.length+" bytes");return e.slice(t,t+n)}function f(e){var t=e==="extendedRange"?2147483646:16380;return o("WACryptoUtils").randomNumberLessThan(t)+1}function g(e){return b(e)}function h(e){return o("WAParsableXmlNode").convertBytesToUint(e,4)}function y(){var e=2147483647;return o("WACryptoUtils").randomNumberLessThan(e)+1}function C(e){return b(e)}function b(e,t,n){if(t===void 0&&(t=0),n===void 0&&(n=4294967296),typeof e=="number"&&t<=e&&e<n&&Math.floor(e)===e)return e;throw r("err")("Expected integer in range ["+t+", "+n+"), given "+String(e))}function v(e,t){return o("encodeProtobuf").encodeProtobuf(e,t).readByteArrayView()}function S(e,t,n){return n(o("decodeProtobuf").decodeProtobuf(e,t))}function R(e,t,n,r){return o("WACryptoHkdf").extractWithSaltAndExpand(e,t,n,r).then(function(e){return new Uint8Array(e)})}function L(t,n){var r,a;return n==="hmac-sha256"?(r=s,a=["sign"]):(r=e,a=["encrypt","decrypt"]),o("WACryptoDependencies").getCrypto().subtle.importKey("raw",t,r,!1,a)}function E(e){return e}function k(e){return e}function I(e,t){return o("WACryptoUtils").arrayBuffersEqual(e,t)}l.AES_CBC=e,l.HMAC_SHA256=s,l.ensureSize=u,l.toBytes=c,l.toBuffer=d,l.readBytes=m,l.makeBytes=p,l.sliceBytes=_,l.makeRegistrationId=f,l.castRegistrationId=g,l.castRegistrationIdFromBytes=h,l.makeSenderKeyId=y,l.castSenderKeyId=C,l.ensureIntInRange=b,l.encodeSignalProto=v,l.decodeSignalProto=S,l.hkdf=R,l.makeCryptoKey=L,l.castToByteEncoded=E,l.castToSessionHash=k,l.areSessionHashesEqual=I}),98);
__d("EBMinosWriteSecureStorageAlert",["EBMinosTypes","FBLogger","MAWDbAddDeviceChangeAlertsTxn","MAWDbDeviceChangeAlerts","MAWIndexedDb","MAWTransactionMode","MAWUnsafeCoerce","Promise","WAJids","WASignalOther"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t){var a=t.contactId,i=t.epochHead,l=t.epochHeadCreationTime,u=o("WAJids").validateDeviceJid(o("EBMinosTypes").userFbidToUserJid(o("EBMinosTypes").unsafeCastToUserFbId(a)));return u==null?(r("FBLogger")("wmi_minos").MUSTFIX(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Invalid deviceJid generated in writeMinosSecureStorageAlert"]))),(s||(s=n("Promise"))).resolve()):o("MAWIndexedDb").makeMsgrTransactor({deviceChangeAlerts:o("MAWTransactionMode").READWRITE},"writeMinosSecureStorageAlert",function(e){return function(){return o("MAWDbAddDeviceChangeAlertsTxn").addDeviceChangeAlertsTxn(e,{action:o("MAWDbDeviceChangeAlerts").KEY_CHANGE,deviceJid:u,epochHead:i,identity:o("MAWUnsafeCoerce").unsafeCoerce(o("WASignalOther").toBytes(i,32)),isArchived:!1,model:"secure_storage",platform:"Meta",ts:l})}})()}l.writeMinosSecureStorageAlert=u}),98);
__d("EncryptedBackupsResignCdnUrl",["MAWBridge","MAWConfig","MAWLoggerUtils","WAJids","WAPromiseDelays","WAResolvable","WAResultOrError","cr:10071","getSafeQplErrorMessage"],(function(t,n,r,o,a,i,l){"use strict";var e,s=new Map;function u(e){return s.get(e)}function c(t){var n=t.deliveryObjectId,r=t.logger,a=t.mediaDownloadFlow,i=t.mediaKey,l=t.mediaType,s=t.msgId,u=t.protocolMsgId,c=t.sortOrderMs;return a.addPoint("resign_cdn_url_start"),d({deliveryObjectId:n,mediaDownloadFlow:{addAnnotations:function(t){a==null||a.addAnnotations(babelHelpers.extends({},t))},addPoint:function(t,n){a==null||a.addPoint(t,babelHelpers.extends({},n))}},mediaKey:i,mediaType:l,msgId:s,protocolMsgId:u,sortOrderMs:c}).then(function(e){return e.success?(a==null||a.addPoint("resign_cdn_url_end"),e):(a.addPoint("resign_cdn_url_fail",{string:{resignCdnUrlFailReason:e.error}}),e)}).catch(function(t){return r.ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["resignCdnUrl runtime-error: ",""])),t),a.addPoint("resign_cdn_url_fail",{string:{resignCdnUrlFailReason:o("getSafeQplErrorMessage").getSafeQPLErrorMessage(t)}}),o("WAResultOrError").makeError("resign-cdn-url-runtime-error")})}async function d(e){var t=e.deliveryObjectId,r=e.mediaDownloadFlow,a=e.mediaKey,i=e.mediaType,l=e.msgId,u=e.protocolMsgId,c=e.sortOrderMs;if(n("cr:10071")!==null){var d=await n("cr:10071").eblsResignCdnUrlWithGraphQL({chatJid:u.chat,deliveryObjectId:t,externalId:u.externalId,mediaDownloadFlow:r,mediaKey:a,mediaType:i,sortOrderMs:c});return d.success?o("WAResultOrError").makeResult(d.value):d}else{var m=o("MAWLoggerUtils").getInstanceKey(),p=new(o("WAResolvable")).Resolvable;return s.set(m,p),o("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"ResignAttachmentCDNUrl",value:{deliveryObjectId:t,mediaType:i,messageId:u.externalId,msgId:l,productType:o("MAWConfig").getConfig().productTypeForEBAttachments,skipLegacyMediaDownloadFlow:!0,sortOrder:c,threadId:o("WAJids").threadIdForChatJid(u.chat),threadJid:u.chat,traceId:m}}]}),o("WAPromiseDelays").withTimeout(p.promise,900*1e3,function(){return o("WAResultOrError").makeError("resign-cdn-url-timeout")}).finally(function(){s.delete(m)})}}l.getRestoredCdnUrlResolvable=u,l.resignCdnUrl=c}),98);
__d("WADbTransactor",["MAWDexie","MAWIndexedDb","MAWTransactionMode","WAExceededStorageQuota","err"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){var r=Object.keys(e),a=r.some(function(t){return e[t]===o("MAWTransactionMode").READWRITE})?o("MAWTransactionMode").READWRITE:o("MAWTransactionMode").READONLY;return function(){for(var e=arguments.length,i=new Array(e),l=0;l<e;l++)i[l]=arguments[l];return o("MAWIndexedDb").getSignalDB(t).then(function(e){return s(a,r,function(){return n(e.stores).apply(void 0,i)})}).then(function(e){return e}).catch(function(e){throw d(e,t)})}}function s(e,t,n){if(r("MAWDexie").currentTransaction!=null)throw r("err")("protocolDB transactor %s cannot be called within another transaction");return o("MAWIndexedDb").getSignalDB().then(function(r){return r.transact(e,t,n)})}function u(e){return e instanceof Error?e:typeof e=="string"?r("err")(e):null}async function c(e,t,n,r){var a=e+"_"+r,i=await o("MAWIndexedDb").getDB(a);return i.transact(t,[e],function(){return n(i.stores[e])}).then(function(e){return e}).catch(function(e){throw d(e,a)})}function d(e,t){var n;o("WAExceededStorageQuota").checkQuotaExceededError(e);var a=u(e);return a?(a.message="["+((n=a==null?void 0:a.toString())!=null?n:"unknown error")+"] Error performing %s transaction "+t,a):r("err")("[unknown error] Error performing %s transaction "+t)}l.makeSignalTransactor=e,l.persistedQueueTransactor=c}),98);
__d("WAClearSignalStores",["MAWDexieTable","MAWTransactionMode","WADbTransactor"],(function(t,n,r,o,a,i,l){"use strict";var e=o("WADbTransactor").makeSignalTransactor({tasks:o("MAWTransactionMode").READWRITE},"clearSignalStores",function(e){return function(){return o("MAWDexieTable").dexieAll([e.tasks.clear()]).then(function(){})}});l.clearSignalStores=e}),98);
__d("WAClearSignalStoresV2",["WASignalDB"],(function(t,n,r,o,a,i,l){"use strict";var e=function(){return o("WASignalDB").getDb().runInTransaction(["identity","contacts","meta","prekey","prekeyGeneration","senderKeySessions","session","signedPrekey","personalSenderKeyStatuses"],"readwrite",async function(e){await Promise.all([e.stores.identity.clear(),e.stores.contacts.clear(),e.stores.meta.clear(),e.stores.prekey.clear(),e.stores.prekeyGeneration.clear(),e.stores.senderKeySessions.clear(),e.stores.session.clear(),e.stores.signedPrekey.clear(),e.stores.personalSenderKeyStatuses.clear()])},o("WASignalDB").signalOp("clearSignalStores"))};l.clearSignalStores=e}),98);
__d("MAWClearSignalAndTempStores",["MAWDeleteOldLogsFromDisk","MAWJobActionsV2","MAWJobsIndexedDb","MAWLoggingSwitches","MAWTransactionMode","Promise","WAClearSignalStores","WAClearSignalStoresV2","emptyFunction"],(function(t,n,r,o,a,i,l){"use strict";var e,s=o("MAWJobsIndexedDb").makeJobsTransactor("jobs",o("MAWTransactionMode").READWRITE,"clearJob")(o("MAWJobActionsV2").clearJobs),u=function(){return(e||(e=n("Promise"))).all([o("MAWLoggingSwitches").removeLoggingFromBridge&&o("MAWDeleteOldLogsFromDisk").clearLogs(),o("WAClearSignalStores").clearSignalStores(),s(),o("WAClearSignalStoresV2").clearSignalStores()]).then(r("emptyFunction"))};l.clearSignalAndTempStores=u}),98);
__d("MAWCreateMaybeAddPointForMediaRender",["MAWQplProxy","qpl"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return function(t,n){e!=null&&o("MAWQplProxy").sendQplPointThroughBridge(r("qpl")._(25302828,"2195"),t,{annotations:n,instanceKey:e},!0)}}l.createMaybeAddPointForMediaRender=e}),98);
__d("WATypedArraysConcat",[],(function(t,n,r,o,a,i){"use strict";function e(e,t,n){n===void 0&&(n=0);var r=t.reduce(function(e,t){return e+t.length},n),o=new e(r),a=0;return t.forEach(function(e){o.set(e,a),a+=e.length}),o}i.concatTypedArrays=e}),66);
__d("WACryptoAesCbc",["WABinary","WACryptoDependencies","WAPromiseDelays","WATypedArraysCast","WATypedArraysConcat","err"],(function(t,n,r,o,a,i,l){"use strict";var e=16,s=1024,u=16,c=1024*1024,d=e*c,m=(function(){function t(e,t,n,r){this.$4=null,this.$6=!1,this.$1=e,this.$2=t,this.$3=n;var a={name:"AES-CBC",iv:r};this.$5=o("WACryptoDependencies").getCrypto().subtle.importKey("raw",n,"AES-CBC",!1,[t]).then(function(e){return{algo:a,key:e}})}var n=t.prototype;return n.append=function(n){var t=this;this.$7("append");var r,a=this.$4;if(a)if(a.writeByteArray(n),a.size()>s){var i=a.size()%e;r=a.readByteArrayView(a.size()-i),a.size()||(this.$4=null)}else r=null;else if(n.length>s){var l=n.length%e;l?(this.$4=new(o("WABinary")).Binary(n),r=this.$4.readByteArrayView(n.length-l)):r=n}else this.$4=new(o("WABinary")).Binary(n),r=null;var u=r;return u&&(this.$5=this.$5.then(function(n){var r=n.algo,a=n.key;if(t.$2==="encrypt")return o("WACryptoDependencies").getCrypto().subtle.encrypt(r,a,u).then(function(n){return t.$1.writeByteArray(new Uint8Array(n,0,n.byteLength-e)),new Uint8Array(n,n.byteLength-2*e,e)});var i=u.slice(-e);return o("WACryptoDependencies").getCrypto().subtle.decrypt(r,a,u).then(function(e){return t.$1.writeBuffer(e),i})}).then(function(e){var n={name:"AES-CBC",iv:e};return o("WACryptoDependencies").getCrypto().subtle.importKey("raw",t.$3,"AES-CBC",!1,[t.$2]).then(function(e){return{algo:n,key:e}})})),this.$5.then(function(){})},n.finalize=function(t){var e=this;this.$7("finalize");var n;if(this.$4){var r=this.$4;t&&r.writeByteArray(t),n=r.readByteArrayView(),this.$4=null}else t&&(n=t);if(n){var a=n;return this.$5.then(function(t){var n=t.algo,r=t.key;return e.$2==="encrypt"?o("WACryptoDependencies").getCrypto().subtle.encrypt(n,r,a):o("WACryptoDependencies").getCrypto().subtle.decrypt(n,r,a)}).then(function(t){e.$1.writeBuffer(t)})}else return this.$5.then(function(){})},n.$7=function(t){if(this.$6)throw r("err")("AesCbcStream."+t+" called after finalize")},t})();function p(e){return{name:"AES-CBC",iv:o("WATypedArraysCast").castTypedArrays(Uint8Array,e)}}function _(e){return o("WACryptoDependencies").getCrypto().subtle.importKey("raw",o("WATypedArraysCast").castTypedArrays(Uint8Array,e),"AES-CBC",!1,["encrypt"])}function f(e){if(e)return o("WATypedArraysCast").castTypedArrays(Uint8Array,e);var t=new Uint8Array(u);return o("WACryptoDependencies").getCrypto().getRandomValues(t),t}function g(t){var n=t.byteLength,r=e-n%e;return Number.isNaN(r)?n:n+r}function h(e,t,n){var r=p(t);return Promise.resolve(o("WACryptoDependencies").getCrypto().subtle.importKey("raw",o("WATypedArraysCast").castTypedArrays(Uint8Array,e),"AES-CBC",!1,["decrypt"])).then(function(e){return o("WACryptoDependencies").getCrypto().subtle.decrypt(r,e,n)})}function y(e,t){return Promise.resolve().then(function(){var n=t.slice(0,u),r=t.slice(u);return h(e,n,r)})}function C(e,t,n){return Promise.resolve().then(function(){var r=f(n),a=p(r);return Promise.resolve(_(e)).then(function(e){return o("WACryptoDependencies").getCrypto().subtle.encrypt(a,e,t)}).then(function(e){return o("WATypedArraysConcat").concatTypedArrays(Uint8Array,[r,new Uint8Array(e)]).buffer})})}async function b(t){var n=t.encKey,a=t.plaintext,i=t.optionalIv,l=t.chunkSize,s=l===void 0?d:l,u=t.delayInBetween,c=u===void 0?!1:u;if(s%e!==0)throw r("err")("chunkSize must be a multiple of "+e+", "+s+" received");var m=await _(n),p=new Uint8Array(a),h=Math.ceil(p.byteLength/s),y=f(i),C=new Uint8Array(g(p)+y.byteLength);C.set(y);for(var b=0,S=y,R;b<h;b++){var L=b===h-1,E=b*s;R=p.subarray(E,E+s);var k=await v(L,R,S,m),I=k.encryptedChunk,T=k.nextIv;C.set(I,y.byteLength+b*s),S=T,c===!0&&await o("WAPromiseDelays").releaseToMainThread()}return C.buffer}async function v(t,n,r,a){var i=await o("WACryptoDependencies").getCrypto().subtle.encrypt(p(r),a,n).then(function(n){return t?new Uint8Array(n):new Uint8Array(n).subarray(0,-e)}),l=i.slice(-e);return{encryptedChunk:i,nextIv:l}}l.AES_CBC_BLOCK_SIZE=e,l.AesCbcStream=m,l.importRawKey=_,l.getIv=f,l.aesCbcDecrypt=h,l.aesCbcDecryptSplit=y,l.aesCbcEncrypt=C,l.aesCbcEncryptWithChunking=b,l.aesCbcEncryptChunk=v}),98);
__d("WAConcurrentIterate",[],(function(t,n,r,o,a,i){"use strict";function e(e,t,n){for(var r=[],o=[],a=0,i=async function(){for(;a<e;){var n=a;a++,o[n]=await t(n)}},l=Math.min(e,n),s=0;s<l;s++)r.push(i());return Promise.all(r).then(function(){return o})}i.concurrentIterate=e}),66);
__d("WAMediaCryptoSidecar",["WAConcurrentIterate","WACryptoHmac","WAMediaUtils"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return e==="video"}var s=16,u=10,c=64*1024;function d(e,t,n){n===void 0&&(n=1);var r=t.buffer.byteLength,a=Math.ceil((r-s)/c),i=new Uint8Array(u*a);return o("WAConcurrentIterate").concurrentIterate(a,function(n){var r=n*c,a=r+s+c,l=t.subarray(r,a);return o("WACryptoHmac").sign(e,l).then(function(e){var t=new Uint8Array(e,0,u);i.set(t,n*u)})},n).then(function(){return o("WAMediaUtils").castToStreamingSidecar(i.buffer)})}l.shouldHaveStreamingSidecar=e,l.calculateStreamingSidecar=d}),98);
__d("WAMediaHkdfInfo",["err"],(function(t,n,r,o,a,i,l){"use strict";function e(e){switch(e){case"document":return"WhatsApp Document Keys";case"image":case"sticker":case"xma-image":return"WhatsApp Image Keys";case"video":case"gif":return"WhatsApp Video Keys";case"audio":case"ptt":return"WhatsApp Audio Keys";case"md-app-state":return"WhatsApp App State Keys";case"md-msg-hist":return"WhatsApp History Keys";default:throw r("err")("getMediaHkdfInfo: unexpected media type "+e)}}function s(){return"Messenger Preview Keys"}l.getMediaHkdfInfo=e,l.getPreviewMediaHkdfInfo=s}),98);
__d("WAMediaCrypto",["WABinary","WACryptoAesCbc","WACryptoDependencies","WACryptoHkdf","WACryptoHmac","WACryptoSha256","WACryptoUtils","WACustomError","WAHashUtils","WAMediaCryptoSidecar","WAMediaHkdfInfo","WATagsLogger","WATypedArraysConcat","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=o("WATagsLogger").TAGS(["WAMediaCrypto"]),c=(function(e){function t(t){var n;return n=e.call(this,t!=null?t:"")||this,n.name="HmacValidationError",n}return babelHelpers.inheritsLoose(t,e),t})(o("WACustomError").CustomError),d=new Uint8Array([2,2]);function m(e,t){return o("WACryptoHkdf").extractAndExpand(new Uint8Array(e),t,112).then(function(e){return{iv:new Uint8Array(e,0,16),cipherKey:new Uint8Array(e,16,32),hmacKey:new Uint8Array(e,48,32),refKey:new Uint8Array(e,80,32)}})}function p(e,t){var n=o("WAMediaHkdfInfo").getMediaHkdfInfo(t);return m(e,n)}function _(e){var t=o("WAMediaHkdfInfo").getPreviewMediaHkdfInfo();return m(e,t)}async function f(e){var t=new Map,n=await _(e);t.set("preview",n);var r=["document","image","video","audio","md-app-state","md-msg-hist"];return await Promise.all(r.map(function(n){return p(e,n).then(function(e){t.set(n,e)})})),t}function g(e){switch(e){case"image":case"video":return e;default:return null}}var h=16,y=16,C=10,b=64*1024;async function v(e,t,n,r,a){var i=new(o("WABinary")).Binary;i.ensureCapacity(y+r.byteLength+h+C),i.writeByteArray(t);for(var l=new(o("WACryptoAesCbc")).AesCbcStream(i,"encrypt",e,t),s=0,u=s+b;u<r.byteLength;){var c=r.slice(s,u);await l.append(new Uint8Array(c)),s=u,u+=b}var d=await r.slice(s);await l.finalize(new Uint8Array(d));var m=i.peek(function(e){return e.readByteArrayView()}),p=await o("WACryptoHmac").encodeKeySha256(n),_=await o("WACryptoHmac").sign(p,m);i.writeByteArray(new Uint8Array(_,0,C));var f=i.readByteArrayView(),g=f.subarray(y),v=await Promise.all([o("WACryptoDependencies").getCrypto().subtle.digest("SHA-256",g),o("WAMediaCryptoSidecar").shouldHaveStreamingSidecar(a)?o("WAMediaCryptoSidecar").calculateStreamingSidecar(p,f):void 0]),S=v[0],R=v[1];return{ciphertext:g,ciphertextHash:S,sidecar:R,ivCiphertext:m,ivCiphertextHmac:f}}async function S(e,t,n){var r=await o("WACryptoHmac").encodeKeySha256(e),a=o("WABinary").Binary.build(t,n).readByteArrayView();return o("WACryptoHmac").sign(r,a)}async function R(e,t,n,r,a){if(!(10<=a.length&&a.length<=32))throw new c("Bad hmac size "+a.length);var i=o("WABinary").Binary.build(t,n).readByteArrayView(),l=await o("WACryptoHmac").hmacSha256(r,i).then(function(e){return new Uint8Array(e)}),s=l.slice(0,a.length);if(!I(s,a))throw new c("hmacAndDecrypt hmac mismatch");var u=await o("WACryptoAesCbc").aesCbcDecrypt(e,t,n),d=await o("WACryptoDependencies").getCrypto().subtle.digest("SHA-256",u);return{plaintextHash:o("WAHashUtils").toPlaintextHash(d),plaintext:u}}function L(e,t,n,r,a){if(!(10<=a.length&&a.length<=32))throw new c("Bad hmac size "+a.length);var i=o("WATypedArraysConcat").concatTypedArrays(Uint8Array,[t,n]);return o("WACryptoHmac").hmacSha256(r,i,a.length).then(function(e){return new Uint8Array(e)}).then(function(e){if(!o("WACryptoUtils").uint8ArraysEqual(e,a))throw new c("hmacAndDecrypt hmac mismatch")}).then(function(){var e=n.byteLength%h===C;return e===!0?n.subarray(0,-10):n}).then(function(n){return E(e,t,n)})}function E(e,t,n){var r=n.subarray(-h);return o("WACryptoAesCbc").aesCbcEncrypt(e,d,r).then(function(e){return e.slice(y)}).then(function(e){return o("WABinary").Binary.build(n,e).readByteArrayView()}).then(function(n){return o("WACryptoAesCbc").aesCbcDecrypt(e,t,n)}).then(function(e){return new Uint8Array(e,0,e.byteLength-d.byteLength)}).then(function(e){return{plaintext:e,nextIv:r}})}async function k(t,n,a,i,l,c){l>c.scanLengths.length&&u.ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["decryptPartialChunks targetScan greater length of scanLength array"])));var d=Math.min(l,c.scanLengths.length);if(d<1)throw u.ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Unable to decrypt partial due to invalid target scan"]))),r("err")("Unable to decrypt partial due to invalid target scan");for(var m=new(o("WABinary")).Binary,p=[],_=0;_<d;_++)p.push(new Uint8Array(c.sidecar,_*10,10));for(var f=0,g=n,h=0,y=0;y<d;y++){var C=c.alignedScanLengths[y],b=f+C,v=a.subarray(f,b),S=await L(t,g,v,i,p[y]),R=S.nextIv,E=S.plaintext;m.write(E),f+=C,g=R,h+=c.scanLengths[y]}var k=m.readBuffer(h),I=await o("WACryptoSha256").sha256(k);return{plaintextHash:o("WAHashUtils").toPlaintextHash(I),plaintext:k}}function I(e,t){if(e.length!==t.length)return!1;for(var n=1,r=e.length,o=0;o<r;o++)n&=e[o]===t[o]?1:0;return n!==0}l.HmacValidationError=c,l.DEFAULT_PADDING=d,l.computeMediaKeys=p,l.computeMediaKeysForPreview=_,l.deprecated_getAllCommonComputedMediaKeys=f,l.convertServerMediaTypeToPreviewMediaType=g,l.CBC_BLOCK_SIZE=h,l.IV_LENGTH=y,l.HMAC_LENGTH=C,l.encryptAndHmac=v,l.hmacCiphertext=S,l.hmacAndDecrypt=R,l.hmacAndDecryptPartial=L,l.decryptPartialChunks=k}),98);
__d("WAAlignChunkLengthsToMultipleOfAesBlockSize",[],(function(t,n,r,o,a,i){"use strict";function e(e){return parseInt((e+15)/16,10)*16}function l(t,n){for(var r=[],o=0,a=0,i=0,l=0;l<t.length;++l)if(o+=t[l],l===t.length-1&&n!=null&&n>0){o>a?r.push(n-a):(r.pop(),r.push(n-i));break}else if(o>a){var s=e(o-a);i=a,r.push(s),a+=s}return r}i.alignChunkSizeToMultipleAesBlockSize=e,i.alignChunkLengthsToMultipleOfAesBlockSize=l}),66);
__d("WAProgressiveJpegAlignScanLengths",["WAAlignChunkLengthsToMultipleOfAesBlockSize"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.scanLengths,n=e.totalEncryptedBytes;return o("WAAlignChunkLengthsToMultipleOfAesBlockSize").alignChunkLengthsToMultipleOfAesBlockSize(t.map(function(e){return e}),n).map(function(e){return e})}function s(e){return e}l.progressiveJpegAlignChunkLengthsToMultipleOfAesBlockSize=e,l.toProgressiveJpegAlignedScanLength=s}),98);
__d("WAProgressiveJpegGetPJpegDetails",["WAMediaCrypto","WAProgressiveJpegAlignScanLengths","WAProgressiveJpegGetScanLengths","WAResultOrError","WATagsLogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=o("WATagsLogger").TAGS(["WAProgressiveJpegDetails"]);function m(e){var t=e.ciphertextLength,n=e.progressiveJpegDetails;return babelHelpers.extends({},n,{alignedScanLengths:o("WAProgressiveJpegAlignScanLengths").progressiveJpegAlignChunkLengthsToMultipleOfAesBlockSize({scanLengths:n.scanLengths,totalEncryptedBytes:t})})}async function p(e,t,n){var r=t.byteLength-o("WAMediaCrypto").IV_LENGTH,a=o("WAProgressiveJpegGetScanLengths").getProgressiveJpegScanLengths(e),i=o("WAProgressiveJpegAlignScanLengths").progressiveJpegAlignChunkLengthsToMultipleOfAesBlockSize({scanLengths:a,totalEncryptedBytes:r}),l=await _(i,t,n);return{scanLengths:a,sidecar:l}}async function _(e,t,n){for(var r=new Uint8Array(e.length*10),a=0,i=0,l=t.slice(0,16),s=t.slice(16),u=0;u<e.length;u++){var c=e[u];i=a+c;var d=s.subarray(a,i),m=(await o("WAMediaCrypto").hmacCiphertext(n,l,d)).slice(0,10);r.set(new Uint8Array(m),u*10),l=d.slice(d.length-16,d.length),a=i}return r.buffer}function f(t){return t.sidecar.byteLength%o("WAMediaCrypto").HMAC_LENGTH!==0?(d.ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Progressive Jpeg sidecar has an invalid length"]))),o("WAResultOrError").makeError("pjpeg-check-sidecar-invalid-length")):t.scanLengths.length>0&&t.sidecar.byteLength===0?(d.ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Progressive Jpeg sidecar is missing"]))),o("WAResultOrError").makeError("pjpeg-check-no-sidecar")):t.scanLengths.length===0?o("WAResultOrError").makeResult(!1):t.scanLengths.length*o("WAMediaCrypto").HMAC_LENGTH!==t.sidecar.byteLength?(d.ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Progressive Jpeg sidecar size mismatch"]))),o("WAResultOrError").makeError("pjpeg-check-scan-length-mismatch")):t.scanLengths.length<3?(d.WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Progressive Jpeg has too few scans"]))),o("WAResultOrError").makeError("pjpeg-too-few-scans")):o("WAResultOrError").makeResult(!0)}function g(e,t){var n=0;if(t===0)return 0;for(var r=0;r<t;r++){var o=e[r];o!=null&&(n+=o)}return n}function h(e){var t=e.progressiveJpegDetails;if(t==null)return o("WAResultOrError").makeResult(null);var n=f(t);return n.success===!1?n:n.value===!0?o("WAResultOrError").makeResult({scanLengths:t.scanLengths,sidecar:t.sidecar}):o("WAResultOrError").makeResult(null)}l.getExtendedProgressiveJpegDetails=m,l.getProgressiveJpegDetails=p,l.isValidProgressiveJpegDetails=f,l.getTotalByteSizeForScan=g,l.maybeGetProgressiveJpegDetailsUsingMediaEntry=h}),98);
__d("WADownloadDownloadablePreview",["WADownloadMedia","WAMediaCrypto","WAProgressiveJpegGetPJpegDetails","WAResultOrError","WAStartMediaDownloadQplFlow"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_=o("WADownloadMedia").mediaDownloadLogger.TAGS(["DownloadDownloadablePreview"]);async function f(t,n,r,a,i,l,f){var g=l.handleMediaPreviewBeforeDownload,h=l.handleMediaPreviewDownloadFailed,y=a.downloadableThumbnail,C=y==null?void 0:y.directPath,b=C!=null,v=o("WAProgressiveJpegGetPJpegDetails").maybeGetProgressiveJpegDetailsUsingMediaEntry(a);if(_.LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["thumbnail_available: ",""])),b),y==null||C==null)return _.LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["No downloadableThumbnail. Skipping..."]))),o("WAResultOrError").makeError("preview-not-supported");_.LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["DownloadableThumbnail exists. Attempting to download."])));var S=y.fileEncSha256,R=y.fileSha256,L=y.mediaKey,E=y.objectId,k=o("WAStartMediaDownloadQplFlow").startMediaDownloadQplFlow({protocolMsgId:t,downloadEntry:i,msgType:null,triggerUIView:f,isPreview:!0});if(k.addAnnotations({bool:{duplicateDirectPath:C===a.directPath,isProgressiveJpeg:v.success===!0,hasObjectId:E!=null},string:{mediaType:"preview",fullSizeMediaType:a.serverMediaType}}),k.addPoint("wa_protocol_media_download_start"),C==null||S==null||R==null||L==null)return _.ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["media: mediaPreview - mediaEntryData "," is incomplete for media preview"])),a),k.endFail("wa_protocol_media_download_fail",{string:{wa_protocol_media_download_fail_reason:"preview-incomplete-media-entry"}}),o("WAResultOrError").makeError("media-entry-invalid");var I=o("WAMediaCrypto").convertServerMediaTypeToPreviewMediaType(r);if(I==null)return _.ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["media: mediaPreview - unsupported preview media type ",""])),r),k.endFail("wa_protocol_media_download_fail",{string:{wa_protocol_media_download_fail_reason:"preview-unsupported-type"}}),o("WAResultOrError").makeError("request-error");await g(n);var T=await o("WADownloadMedia").downloadMediaImpl({downloadFlow:k,mediaTypeDetails:{messageType:I,type:"preview"},directPath:C,fileEncSha256:S,fileSha256:R,mediaKey:L});return T.success===!1?(_.WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["failed to download media. Reason: ",""])),T.error),h(n,T.error),k.endFail("wa_protocol_media_download_fail",{string:{wa_protocol_media_download_fail_reason:T.error}}),T):(_.LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["finished downloading"]))),k.addPoint("wa_protocol_media_download_end"),k.endSuccess(),o("WAResultOrError").makeResult(T.value))}l.maybeDownloadDownloadablePreview=f}),98);
__d("WADecryptMedia",["WAMediaCrypto","WAResultOrError","WATagsLogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_=o("WATagsLogger").TAGS(["WADecryptMedia"]);async function f(t,n,r,a){_.WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Encountered enc-hash-mismatch - looking for a potential working hmac salt"])));var i=r.type==="preview"?"preview":r.mediaType,l=await o("WAMediaCrypto").deprecated_getAllCommonComputedMediaKeys(a),d;for(var m of l){var p=m[0],f=m[1];try{if(p===i)continue;_.LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Trying "," as an alternative hmac salt."])),p);var g=o("WAResultOrError").makeResult(await o("WAMediaCrypto").hmacAndDecrypt(f.cipherKey,f.iv,t,f.hmacKey,n));return d={hmacAndDecryptResult:g,alternativeHmacSaltUsed:p},_.LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Found a working hmac salt using ","."])),p),d}catch(e){_.LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose([""," is not a working hmac salt."])),p);continue}}return{hmacAndDecryptResult:o("WAResultOrError").makeError("enc-hash-mismatch")}}async function g(e){var t=e.ciphertextHmac,n=e.mediaKey,r=e.mediaTypeDetails,a=e.plaintextHash;_.LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Using default plaintext verifier"])));var i=t.byteLength-o("WAMediaCrypto").HMAC_LENGTH,l=new Uint8Array(t,i),s=new Uint8Array(t,0,i),u;r.type==="preview"?u=o("WAMediaCrypto").computeMediaKeysForPreview(n):u=o("WAMediaCrypto").computeMediaKeys(n,r.mediaType);var c,g=null;if(c=await u.then(function(e){var t=e.cipherKey,n=e.hmacKey,r=e.iv;return o("WAMediaCrypto").hmacAndDecrypt(t,r,s,n,l)}).then(o("WAResultOrError").makeResult).catch(function(e){return _.ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Download Plaintext Error ",""])),e),e instanceof o("WAMediaCrypto").HmacValidationError?o("WAResultOrError").makeError("enc-hash-mismatch"):o("WAResultOrError").makeError("decryption-error")}),c.success===!1&&c.error==="enc-hash-mismatch"){var h=await f(s,l,r,n);c=h.hmacAndDecryptResult,g=h.alternativeHmacSaltUsed}if(!c.success)return c;var y=c.value,C=y.plaintext,b=y.plaintextHash;return a!==b?o("WAResultOrError").makeError("hash-mismatch"):(_.LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Download Plaintext Success"]))),o("WAResultOrError").makeResult({plaintext:C,alternativeHmacSaltUsed:g}))}l.decryptMedia=g}),98);
__d("WAArrayUtils",[],(function(t,n,r,o,a,i){"use strict";function e(e){return e}function l(e,t){var n=e.pop();t<e.length&&(e[t]=n)}function*s(e,t){for(var n=0;n<e.length;n+=t)yield e.slice(n,n+t)}function u(t,n){return c(t,n,e)}function c(e,t,n){var r=new Map;for(var o of e){var a,i=t(o),l=(a=r.get(i))!=null?a:[];l.push(n(o)),r.set(i,l)}return r}i.removeIndexWithoutPreservingOrder=l,i.peekEvery=s,i.groupBy=u,i.groupByAndMap=c}),66);
__d("WABaseGlobals",["err"],(function(t,n,r,o,a,i,l){"use strict";var e=null;function s(t){e=t}function u(){if(e==null)throw r("err")("Trying to access WAGlobals before being set");return e}function c(e){var t=u();t.myJids=e}function d(){var e,t=(e=u().myJids)==null?void 0:e.deviceJid;if(t==null)throw r("err")("Trying to access myDeviceJid, but it's not set");return t}function m(){var e,t=(e=u().myJids)==null?void 0:e.userJid;if(t==null)throw r("err")("Trying to access myUserJid, but it's not set");return t}function p(){return u().jidUtils}function _(){return u().qpl}function f(){return e==null?!1:u().newClockSkewCalculation()}l.setGlobals=s,l.setMyJids=c,l.getMyDeviceJid=d,l.getMyUserJid=m,l.getJidUtilsApi=p,l.getQplConfig=_,l.newClockSkewCalculation=f}),98);
__d("WAErrors",["WACustomError"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(function(e){function t(t){var n;return n=e.call(this,t!=null?t:"")||this,n.name="BufferTooLargeError",n}return babelHelpers.inheritsLoose(t,e),t})((e=o("WACustomError")).CustomError),u=(function(e){function t(t){var n;return n=e.call(this,t!=null?t:"")||this,n.name="Disconnected",n}return babelHelpers.inheritsLoose(t,e),t})(e.CustomError),c=(function(e){function t(t){var n;return n=e.call(this,t!=null?t:"")||this,n.name="Offline",n}return babelHelpers.inheritsLoose(t,e),t})(u),d=(function(e){function t(t){var n;return n=e.call(this,t!=null?t:"")||this,n.name="MaxRetries",n}return babelHelpers.inheritsLoose(t,e),t})(e.CustomError),m=(function(e){function t(t){var n;return n=e.call(this,t!=null?t:"")||this,n.name="Aborted",n}return babelHelpers.inheritsLoose(t,e),t})(e.CustomError);l.BufferTooLargeError=s,l.Disconnected=u,l.Offline=c,l.MaxRetries=d,l.Aborted=m}),98);
__d("WANotifyConnectionChangeFactory",[],(function(t,n,r,o,a,i){"use strict";var e=15e3;function l(t,n,r){r===void 0&&(r=e);var o={timeoutID:null,connectionStatus:"disconnected",optimismLevel:"optimist"},a=function(){var e=o.connectionStatus,t=o.optimismLevel;t==="optimist"?o.timeoutID=setTimeout(function(){o.optimismLevel="realist",n(e)},r):n(e)};return function(e){o.connectionStatus=e,e==="disconnected"||e==="in_handshake"?a():(o.timeoutID!=null&&(clearTimeout(o.timeoutID),o.timeoutID=null),n(e)),t(e)}}i.notifyConnectionChangeFactory=l}),66);
__d("WAPromiseRetryLoop",["Promise","WALogger","WAPromiseBackoffs","WAPromiseDelays","WAResolvable","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g=(function(){function t(e){var t=this;this.$2=new(o("WAResolvable")).Resolvable,this.$3=null,this.$4=null,this.$5=0,this.$6=new(o("WAResolvable")).Resolvable,this.endWithValue=function(e){t.$5++,t.$2.resolve(e)},this.$1=e}var a=t.prototype;return a.resetTimeoutAfter=function(t){this.$4=Date.now()+t},a.cancelReset=function(){this.$4=null},a.reset=function(){this.$2.resolveWasCalled()||(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: resetting ",""])),this.$1.name),this.$5++,this.$6.resolve(),this.$7())},a.start=function(){this.$2.resolveWasCalled()||(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: starting ",""])),this.$1.name),this.$5!==0&&o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop was called several times. You may have race conditions"]))),this.$5++,this.$6.resolve(),this.$7())},a.pauseOnNextIteration=function(){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: pause requested on next iteration"]))),this.$6.resolve(),this.$6=new(o("WAResolvable")).Resolvable},a.unpause=function(){this.$6.resolveWasCalled()||o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: loop unpaused"]))),this.$6.resolve()},a.$7=function(){var e=this,t=this.$1,r=this.$5,a=o("WAPromiseBackoffs").createTimer(this.$1.timer);a();var i=function(){return e.$1.isPauseEnabled!==!0?(f||(f=n("Promise"))).resolve():(e.$6.resolveWasCalled()||o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: loop paused - waiting for unpause"]))),e.$6.promise)},l=function(){if(!e.$2.resolveWasCalled()&&r===e.$5){var n=Date.now();return e.$3=(0,t.code)(e.endWithValue).then(function(){if(!e.$2.resolveWasCalled()){var r=t.resetDelay;(r!==void 0&&Date.now()>=n+r||e.$4!=null&&e.$4<=Date.now())&&(o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: resetting ",""])),t.name),a=o("WAPromiseBackoffs").createTimer(e.$1.timer)),e.$4=null;var s=a();return o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: retrying "," in ","ms"])),t.name,s),o("WAPromiseDelays").delayMs(s).then(i).then(l)}}),e.$3}};this.$3=(f||(f=n("Promise"))).resolve().then(l)},a.promise=function(){var e=this;return this.$2.resolveWasCalled()?this.$2.promise:this.$3?(f||(f=n("Promise"))).race([this.$2.promise,this.$3.then(function(){return e.$2.promise})]):(f||(f=n("Promise"))).reject(r("err")("PromiseRetryLoop "+this.$1.name+" had promise() called before start()"))},t})();l.PromiseRetryLoop=g}),98);
__d("WASmaxInPingsEnums",["WAJids"],(function(t,n,r,o,a,i,l){var e={validators:[o("WAJids").validateDomainJid,o("WAJids").validateUserJid],typeName:"DomainJid|UserJid"};l.DOMAINJID_USERJID=e}),98);
__d("WAWapJid",["$InternalEnum","WAJids"],(function(t,n,r,o,a,i,l){"use strict";var e={JID:0,JID_U:1,JID_AD:1,JID_FB:3,JID_INTEROP:4},s=n("$InternalEnum")({WHATSAPP:0,LID:1,HOSTED:128,HOSTED_LID:129}),u=(function(){function t(e){this.$1=e}t.createAD=function(r,o,a){return new t({type:e.JID_AD,user:r,device:a==null?0:a,agent:o==null?0:o,domainType:s.WHATSAPP})},t.createJidU=function(r,o,a){return new t({type:e.JID_U,user:r,device:a==null?0:a,domainType:o==null?s.WHATSAPP:o})},t.createFbJid=function(r,o){var n=o==null?0:o;return new t({type:e.JID_FB,user:r,device:n})},t.createInteropJid=function(r,o,a){var n=o==null?0:o;return new t({type:e.JID_INTEROP,user:r,device:n,integrator:a})},t.create=function(r,o){return new t({type:e.JID,user:r,server:o})};var n=t.prototype;return n.toString=function(){if(this.$1.type===e.JID_AD||this.$1.type===e.JID_U){var t=this.$1,n=t.device,r=t.domainType,a=t.user,i="";return r===s.WHATSAPP?i=o("WAJids").WA_USER_JID_SUFFIX:r===s.HOSTED?i=o("WAJids").HOSTED_SUFFIX:r===s.HOSTED_LID?i=o("WAJids").HOSTED_LID_SUFFIX:i=o("WAJids").LID_SUFFIX,n===0?a+"@"+i:a+":"+n+"@"+i}else if(this.$1.type===e.JID_FB){var l=this.$1,u=l.device,c=l.user,d=o("WAJids").MSGR_USER_JID_SUFFIX;return c+":"+u+"@"+d}else if(this.$1.type===e.JID_INTEROP){var m=this.$1,p=m.device,_=m.integrator,f=m.user,g=o("WAJids").INTEROP_USER_JID_SUFFIX;return _+"-"+f+":"+p+"@"+g}else{this.$1.type;var h=this.$1,y=h.server,C=h.user;return C!=null?C+"@"+y:y}},n.getInnerJid=function(){return this.$1},t})();l.WAP_JID_SUBTYPE=e,l.DomainType=s,l.WapJid=u}),98);
__d("WASmaxParseUtils",["WABase64","WABinary","WACryptoUtils","WADeepEquals","WAHasProperty","WAResultOrError","WAStanzaUtils","WAWapJid","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e=o("WAResultOrError").makeResult();function s(t,n){return t.tag!==n?O(t,"to be <"+n+">"):e}function u(e,t){return B(e,t)?W(e,e.attrs[t]):O(e,'to have attribute "'+t+'"')}function c(e,t,n,r){var a=u(e,t);if(!a.success)return a;var i=n(a.value);return i!=null?o("WAResultOrError").makeResult(i):O(e,'to have "'+t+'"={'+r+'}, but instead has "'+a.value+'"')}function d(e,t,n){var r=P(e);if(!r.success)return r;var a=t(r.value);return a!=null?o("WAResultOrError").makeResult(a):O(e,"to have "+n+' content, but instead has "'+r.value+'"')}function m(t,n,r){var o=u(t,n);if(o.success){if(o.value!==r)return O(t,'to have "'+n+'"="'+r+'", but instead has "'+o.value+'"')}else return o;return e}function p(e,t){return c(e,t,o("WAStanzaUtils").toStanzaId,"stanzaID")}function _(e,t){return c(e,t,o("WAStanzaUtils").validateCallId,"callID")}function f(e,t){return c(e,t,q,"integer")}function g(e,t,n,r){var a=f(e,t);if(!a.success)return a;var i=a.value;return n!==void 0&&i<n?O(e,'to have "'+t+'"={at least '+n+"} but has value "+i):r!==void 0&&i>r?O(e,'to have "'+t+'"={at most '+r+"} but has value "+i):o("WAResultOrError").makeResult(i)}function h(e){var t=e.content;return t instanceof Uint8Array?O(e,"to have children"):o("WAResultOrError").makeResult(t)}function y(t,n){var r=h(t);if(!r.success)return r;var a=r.value;if(a==null)return e;for(var i=null,l=0;l<a.length;l++){var s=a[l];if(s.tag===n){if(i!=null)return O(t,"to have 1 child <"+n+">, but found more than 1");i=s}}return o("WAResultOrError").makeResult(i)}function C(t,n,r){var o=y(t,n);return o.success?o.value==null?e:r(o.value):o}function b(e,t,n){var r=C(e,t,n);if(!r.success)return r;var a=r.value;return a==null?O(e,"to have 1 child <"+t+">, but found 0"):o("WAResultOrError").makeResult(a)}function v(e,t){var n=y(e,t);return n.success?n.value==null?O(e,"to have 1 child <"+t+">, but found 0"):o("WAResultOrError").makeResult(n.value):n}function S(e,t,n,r,a){var i=U(e,t,n,r);if(!i.success)return i;for(var l=[],s=0;s<i.value.length;s++){var u=a(i.value[s]);if(!u.success)return u;l.push(u.value)}return o("WAResultOrError").makeResult(l)}function R(e,t,n,r,a){var i=U(e,t,n,r);if(!i.success)return i;for(var l=i.value.length,s=0;s<l;s++){var u=a(i.value[s]);if(!u.success)return u}return o("WAResultOrError").makeResult(l)}function L(e,t,n){var r=S(e,t,0,1/0,n);if(!r.success)return r;for(var a=0;a<r.value.length;a++)if(!o("WADeepEquals").deepEqual(r.value[0],r.value[a]))return O(e,"to have homogeneous children, but found two children that are not equal");return r}function E(e,t,n){var r=L(e,t,n);return r.success?o("WAResultOrError").makeResult(r.value.length):r}function k(t,n,r,o,a){return B(n,r)?t(n,r,o,a):e}function I(t,n,r,a){if(a==null)return e;var i=k(t,n,r);return i.success?i.value===a?o("WAResultOrError").makeResult(a):i.value==null?e:O(n,'to have "'+r+'"={'+a+'}, but instead has "'+i.value+'"'):i}function T(e,t,n,r){var a=e(t,n);return a.success?a.value===r?o("WAResultOrError").makeResult(r):O(t,'to have "'+n+'"={'+r+'}, but instead has "'+a.value+'"'):a}function D(e,t,n){var r=e(t);return r.success?r.value===n?o("WAResultOrError").makeResult(n):O(t,'to have content "'+n+'", but instead has "'+r.value+'"'):r}function x(e,t,n){var r=u(e,t);if(!r.success)return r;var a=n[r.value];if(a!=null)return o("WAResultOrError").makeResult(a);var i=Object.values(n).join("|");return O(e,'to have "'+t+'"={'+i+'}, but instead has "'+r.value+'"')}function $(e,t){var n=P(e);if(!n.success)return n;var r=t[n.value];if(r!=null)return o("WAResultOrError").makeResult(r);var a=Object.values(t).join("|");return O(e,'to have content "'+a+'", but instead has "'+n.value+'"')}function P(e){var t=N(e);if(t.success)try{var n=new(o("WABinary")).Binary(t.value),a=n.readString(n.size());return o("WAResultOrError").makeResult(a)}catch(t){return O(e,"to have string content, but run into decoding error: "+r("getErrorSafe")(t).message)}else return t}function N(e){var t=e.content;return t==null?O(e,"to have content"):Array.isArray(t)?O(e,"to have content, but has children instead"):o("WAResultOrError").makeResult(t)}function M(e,t){var n=N(e);return n.success?o("WACryptoUtils").uint8ArraysEqual(n.value,t)?o("WAResultOrError").makeResult(t):O(e,'to have content ":binary:'+o("WABase64").encodeB64(t)+'", but instead has ":binary:'+o("WABase64").encodeB64(n.value)+'"'):n}function w(e,t,n){var r=e.content;if(r==null)return t===void 0||t<1?o("WAResultOrError").makeResult(new Uint8Array([])):O(e,"to have content");if(Array.isArray(r))return O(e,"to have content, but has children instead");var a=r.length;return t!==void 0&&a<t?O(e,"to have binary content at least "+t+" bytes but has "+a+" bytes"):n!==void 0&&a>n?O(e,"to have binary content at most "+n+" bytes but has "+a+" bytes"):o("WAResultOrError").makeResult(r)}function A(e){return d(e,q,"integer")}function F(e){return e}function O(e,t){return o("WAResultOrError").makeError("expected <"+e.tag+">: "+t)}function B(e,t){return r("WAHasProperty")(e.attrs,t)}function W(e,t){return t instanceof o("WAWapJid").WapJid?o("WAResultOrError").makeResult(t.toString()):typeof t=="string"?o("WAResultOrError").makeResult(t):O(e,"decodeAsString: attribute is "+typeof t+" not a string: "+String(t))}function q(e){var t=parseInt(e,10);return Number.isNaN(t)?null:t}function U(e,t,n,r){var a=h(e);if(!a.success)return a;var i=a.value;if(i==null)return n!==0?O(e,"to have at least "+n+" <"+t+"> children, but found 0"):o("WAResultOrError").makeResult([]);for(var l=[],s=0;s<i.length;s++){var u=i[s];u.tag===t&&l.push(u)}var c=l.length;return c<n?O(e,"to have at least "+n+" <"+t+"> children, but found "+c):c>r?O(e,"to have at most "+r+" <"+t+"> children, but found "+c):o("WAResultOrError").makeResult(l)}var V={};function H(e,t,n){var r=t.map(function(e,t){return e+": "+n[t].error});return O(e,["to match any of following mixins: "+t.join(", ")+", but all mixins failed."].concat(r).join(" "))}l.voidSuccess=e,l.assertTag=s,l.attrString=u,l.attrValidate=c,l.contentValidate=d,l.assertAttr=m,l.attrStanzaId=p,l.attrCallId=_,l.attrInt=f,l.attrIntRange=g,l.maybeChildren=h,l.optionalChild=y,l.optionalChildWithTag=C,l.childWithTag=b,l.flattenedChildWithTag=v,l.mapChildrenWithTag=S,l.countChildrenWithTag=R,l.mapHomogeneousChildrenWithTag=L,l.countHomogeneousChildrenWithTag=E,l.optional=k,l.optionalLiteral=I,l.literal=T,l.literalContent=D,l.attrStringEnum=x,l.contentStringEnum=$,l.contentString=P,l.contentBytes=N,l.contentLiteralBytes=M,l.contentBytesRange=w,l.contentInt=A,l.identity=F,l.errorMessage=O,l.emptyObject=V,l.errorMixinDisjunction=H}),98);
__d("WASmaxParseJid",["WAJids","WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return o("WASmaxParseUtils").attrValidate(e,t,o("WAJids").validateUserJid,"UserJid")}function s(e,t){return o("WASmaxParseUtils").attrValidate(e,t,o("WAJids").validateLidUserJid,"LidUserJid")}function u(e,t){return o("WASmaxParseUtils").attrValidate(e,t,o("WAJids").validateDeviceJid,"DeviceJid")}function c(e,t){return o("WASmaxParseUtils").attrValidate(e,t,o("WAJids").validateGroupJid,"GroupJid")}function d(e,t){return o("WASmaxParseUtils").attrValidate(e,t,o("WAJids").validateCallJid,"CallJid")}function m(e,t){return o("WASmaxParseUtils").attrValidate(e,t,o("WAJids").validateDomainJid,"DomainJid")}function p(e,t){return o("WASmaxParseUtils").attrValidate(e,t,o("WAJids").validateBroadcastJid,"BroadcastJid")}function _(e,t){return o("WASmaxParseUtils").attrValidate(e,t,o("WAJids").validateStatusJid,"StatusJid")}function f(e,t){return o("WASmaxParseUtils").attrValidate(e,t,o("WAJids").validateNewsletterJid,"NewsletterJid")}function g(e,t,n){var r=o("WASmaxParseUtils").attrString(e,t);if(!r.success)return r;for(var a=n.typeName,i=n.validators,l=0;l<i.length;l++){var s=i[l](r.value);if(s!=null)return o("WAResultOrError").makeResult(s)}return o("WASmaxParseUtils").errorMessage(e,'to have "'+t+'"={'+a+'}, but instead has "'+r.value+'"')}function h(e,t,n,r){var a=e(t,n);return!a.success||a.value===r?a:o("WASmaxParseUtils").errorMessage(t,'to have "'+n+'"={'+r+'}, but instead has "'+a.value+'"')}function y(e,t,n,r){var a=o("WASmaxParseUtils").optional(e,t,n);return!a.success||a.value==null||a.value===r?a:o("WASmaxParseUtils").errorMessage(t,'to have "'+n+'"={'+r+'}, but instead has "'+a.value+'"')}l.attrUserJid=e,l.attrLidUserJid=s,l.attrDeviceJid=u,l.attrGroupJid=c,l.attrCallJid=d,l.attrDomainJid=m,l.attrBroadcastJid=p,l.attrStatusJid=_,l.attrNewsletterJid=f,l.attrJidEnum=g,l.literalJid=h,l.optionalLiteralJid=y}),98);
__d("WASmaxParseReference",["WAHasProperty","WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n,r,o){var a=m(t,n);if(!a.success)return _(a);var i=e(a.value,n[n.length-1],r,o);return i.success?i:_(i)}function s(t,n,r,a,i){return p(n,r)?e(t,n,r,a,i):o("WASmaxParseUtils").voidSuccess}function u(t,n){return e(o("WASmaxParseUtils").attrString,t,n)}function c(e,t){return p(e,t)?u(e,t):o("WASmaxParseUtils").voidSuccess}function d(e,t){var n=m(e,t);if(!n.success)return _(n);var r=o("WASmaxParseUtils").contentString(n.value);return r.success?r:_(r)}function m(e,t){for(var n=t.length,r=e,a=0;a<n-1;a++){var i=t[a],l=o("WASmaxParseUtils").flattenedChildWithTag(r,i);if(!l.success)return l;r=l.value}return o("WAResultOrError").makeResult(r)}function p(e,t){var n=m(e,t);return n.success&&r("WAHasProperty")(n.value.attrs,t[t.length-1])}function _(e){return o("WAResultOrError").makeError("in the reference, "+e.error)}l.attrFromReference=e,l.optionalAttrFromReference=s,l.attrStringFromReference=u,l.optionalAttrStringFromReference=c,l.contentStringFromReference=d}),98);
__d("WASmaxInPingsClientResponseServerResponse",["WAResultOrError","WASmaxInPingsEnums","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseJid").attrJidEnum(e,"from",o("WASmaxInPingsEnums").DOMAINJID_USERJID);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").attrInt(e,"t");return s.success?o("WAResultOrError").makeResult({from:r.value,type:a.value,t:s.value}):s}l.parseClientResponseServerResponse=e}),98);
__d("WAWapDict",[],(function(t,n,r,o,a,i){"use strict";var e=3,l=["xmlstreamstart","xmlstreamend","s.whatsapp.net","type","participant","from","receipt","id","notification","disappearing_mode","status","jid","broadcast","user","devices","device_hash","to","offline","message","result","class","xmlns","duration","notify","iq","t","ack","g.us","enc","urn:xmpp:whatsapp:push","presence","config_value","picture","verified_name","config_code","key-index-list","contact","mediatype","routing_info","edge_routing","get","read","urn:xmpp:ping","fallback_hostname","0","chatstate","business_hours_config","unavailable","download_buckets","skmsg","verified_level","composing","handshake","device-list","media","text","fallback_ip4","media_conn","device","creation","location","config","item","fallback_ip6","count","w:profile:picture","image","business","2","hostname","call-creator","display_name","relaylatency","platform","abprops","success","msg","offline_preview","prop","key-index","v","day_of_week","pkmsg","version","1","ping","w:p","download","video","set","specific_hours","props","primary","unknown","hash","commerce_experience","last","subscribe","max_buckets","call","profile","member_since_text","close_time","call-id","sticker","mode","participants","value","query","profile_options","open_time","code","list","host","ts","contacts","upload","lid","preview","update","usync","w:stats","delivery","auth_ttl","context","fail","cart_enabled","appdata","category","atn","direct_connection","decrypt-fail","relay_id","mmg-fallback.whatsapp.net","target","available","name","last_id","mmg.whatsapp.net","categories","401","is_new","index","tctoken","ip4","token_id","latency","recipient","edit","ip6","add","thumbnail-document","26","paused","true","identity","stream:error","key","sidelist","background","audio","3","thumbnail-image","biz-cover-photo","cat","gcm","thumbnail-video","error","auth","deny","serial","in","registration","thumbnail-link","remove","00","gif","thumbnail-gif","tag","capability","multicast","item-not-found","description","business_hours","config_expo_key","md-app-state","expiration","fallback","ttl","300","md-msg-hist","device_orientation","out","w:m","open_24h","side_list","token","inactive","01","document","te2","played","encrypt","msgr","hide","direct_path","12","state","not-authorized","url","terminate","signature","status-revoke-delay","02","te","linked_accounts","trusted_contact","timezone","ptt","kyc-id","privacy_token","readreceipts","appointment_only","address","expected_ts","privacy","7","android","interactive","device-identity","enabled","attribute_padding","1080","03","screen_height"],s=["read-self","active","fbns","protocol","reaction","screen_width","heartbeat","deviceid","2:47DEQpj8","uploadfieldstat","voip_settings","retry","priority","longitude","conflict","false","ig_professional","replaced","preaccept","cover_photo","uncompressed","encopt","ppic","04","passive","status-revoke-drop","keygen","540","offer","rate","opus","latitude","w:gp2","ver","4","business_profile","medium","sender","prev_v_id","email","website","invited","sign_credential","05","transport","skey","reason","peer_abtest_bucket","America/Sao_Paulo","appid","refresh","100","06","404","101","104","107","102","109","103","member_add_mode","105","transaction-id","110","106","outgoing","108","111","tokens","followers","ig_handle","self_pid","tue","dec","thu","joinable","peer_pid","mon","features","wed","peer_device_presence","pn","delete","07","fri","audio_duration","admin","connected","delta","rcat","disable","collection","08","480","sat","phash","all","invite","accept","critical_unblock_low","group_update","signed_credential","blinded_credential","eph_setting","net","09","background_location","refresh_id","Asia/Kolkata","privacy_mode_ts","account_sync","voip_payload_type","service_areas","acs_public_key","v_id","0a","fallback_class","relay","actual_actors","metadata","w:biz","5","connected-limit","notice","0b","host_storage","fb_page","subject","privatestats","invis","groupadd","010","note.m4r","uuid","0c","8000","sun","372","1020","stage","1200","720","canonical","fb","011","video_duration","0d","1140","superadmin","012","Opening.m4r","keystore_attestation","dleq_proof","013","timestamp","ab_key","w:sync:app:state","0e","vertical","600","p_v_id","6","likes","014","500","1260","creator","0f","rte","destination","group","group_info","syncd_anti_tampering_fatal_exception_enabled","015","dl_bw","Asia/Jakarta","vp8/h.264","online","1320","fb:multiway","10","timeout","016","nse_retry","urn:xmpp:whatsapp:dirty","017","a_v_id","web_shops_chat_header_button_enabled","nse_call","inactive-upgrade","none","web","groups","2250","mms_hot_content_timespan_in_seconds","contact_blacklist","nse_read","suspended_group_deletion_notification","binary_version","018","https://www.whatsapp.com/otp/copy/","reg_push","shops_hide_catalog_attachment_entrypoint","server_sync",".","ephemeral_messages_allowed_values","019","mms_vcache_aggregation_enabled","iphone","America/Argentina/Buenos_Aires","01a","mms_vcard_autodownload_size_kb","nse_ver","shops_header_dropdown_menu_item","dhash","catalog_status","communities_mvp_new_iqs_serverprop","blocklist","default","11","ephemeral_messages_enabled","01b","original_dimensions","8","mms4_media_retry_notification_encryption_enabled","mms4_server_error_receipt_encryption_enabled","original_image_url","sync","multiway","420","companion_enc_static","shops_profile_drawer_entrypoint","01c","vcard_as_document_size_kb","status_video_max_duration","request_image_url","01d","regular_high","s_t","abt","share_ext_min_preliminary_image_quality","01e","32","syncd_key_rotation_enabled","data_namespace","md_downgrade_read_receipts2","patch","polltype","ephemeral_messages_setting","userrate","15","partial_pjpeg_bw_threshold","played-self","catalog_exists","01f","mute_v2"],u=["reject","dirty","announcement","020","13","9","status_video_max_bitrate","fb:thrift_iq","offline_batch","022","full","ctwa_first_business_reply_logging","h.264","smax_id","group_description_length","https://www.whatsapp.com/otp/code","status_image_max_edge","smb_upsell_business_profile_enabled","021","web_upgrade_to_md_modal","14","023","s_o","smaller_video_thumbs_status_enabled","media_max_autodownload","960","blocking_status","peer_msg","joinable_group_call_client_version","group_call_video_maximization_enabled","return_snapshot","high","America/Mexico_City","entry_point_block_logging_enabled","pop","024","1050","16","1380","one_tap_calling_in_group_chat_size","regular_low","inline_joinable_education_enabled","hq_image_max_edge","locked","America/Bogota","smb_biztools_deeplink_enabled","status_image_quality","1088","025","payments_upi_intent_transaction_limit","voip","w:g2","027","md_pin_chat_enabled","026","multi_scan_pjpeg_download_enabled","shops_product_grid","transaction_id","ctwa_context_enabled","20","fna","hq_image_quality","alt_jpeg_doc_detection_quality","group_call_max_participants","pkey","America/Belem","image_max_kbytes","web_cart_v1_1_order_message_changes_enabled","ctwa_context_enterprise_enabled","urn:xmpp:whatsapp:account","840","Asia/Kuala_Lumpur","max_participants","video_remux_after_repair_enabled","stella_addressbook_restriction_type","660","900","780","context_menu_ios13_enabled","mute-state","ref","payments_request_messages","029","frskmsg","vcard_max_size_kb","sample_buffer_gif_player_enabled","match_last_seen","510","4983","video_max_bitrate","028","w:comms:chat","17","frequently_forwarded_max","groups_privacy_blacklist","Asia/Karachi","02a","web_download_document_thumb_mms_enabled","02b","hist_sync","biz_block_reasons_version","1024","18","web_is_direct_connection_for_plm_transparent","view_once_write","file_max_size","paid_convo_id","online_privacy_setting","video_max_edge","view_once_read","enhanced_storage_management","multi_scan_pjpeg_encoding_enabled","ctwa_context_forward_enabled","video_transcode_downgrade_enable","template_doc_mime_types","hq_image_bw_threshold","30","body","u_aud_limit_sil_restarts_ctrl","other","participating","w:biz:directory","1110","vp8","4018","meta","doc_detection_image_max_edge","image_quality","1170","02c","smb_upsell_chat_banner_enabled","key_expiry_time_second","pid","stella_interop_enabled","19","linked_device_max_count","md_device_sync_enabled","02d","02e","360","enhanced_block_enabled","ephemeral_icon_in_forwarding","paid_convo_status","gif_provider","project_name","server-error","canonical_url_validation_enabled","wallpapers_v2","syncd_clear_chat_delete_chat_enabled","medianotify","02f","shops_required_tos_version","vote","reset_skey_on_id_change","030","image_max_edge","multicast_limit_global","ul_bw","21","25","5000","poll","570","22","031","1280","WhatsApp","032","bloks_shops_enabled","50","upload_host_switching_enabled","web_ctwa_context_compose_enabled","ptt_forwarded_features_enabled","unblocked","partial_pjpeg_enabled","fbid:devices","height","ephemeral_group_query_ts","group_join_permissions","order","033","alt_jpeg_status_quality","migrate","popular-bank","win_uwp_deprecation_killswitch_enabled","web_download_status_thumb_mms_enabled","blocking","url_text","035","web_forwarding_limit_to_groups","1600","val","1000","syncd_msg_date_enabled","bank-ref-id","max_subject","payments_web_enabled","web_upload_document_thumb_mms_enabled","size","request","ephemeral","24","receipt_agg","ptt_remember_play_position","sampling_weight","enc_rekey","mute_always","037","034","23","036","action","click_to_chat_qr_enabled","width","disabled","038","md_blocklist_v2","played_self_enabled","web_buttons_message_enabled","flow_id","clear","450","fbid:thread","bloks_session_state","America/Lima","attachment_picker_refresh","download_host_switching_enabled","1792","u_aud_limit_sil_restarts_test2","custom_urls","device_fanout","optimistic_upload","2000","key_cipher_suite","web_smb_upsell_in_biz_profile_enabled","e","039","siri_post_status_shortcut","pair-device","lg","lc","stream_attribution_url","model","mspjpeg_phash_gen","catalog_send_all","new_multi_vcards_ui","share_biz_vcard_enabled","-","clean","200","md_blocklist_v2_server","03b","03a","web_md_migration_experience","ptt_conversation_waveform","u_aud_limit_sil_restarts_test1"],c=["64","ptt_playback_speed_enabled","web_product_list_message_enabled","paid_convo_ts","27","manufacturer","psp-routing","grp_uii_cleanup","ptt_draft_enabled","03c","business_initiated","web_catalog_products_onoff","web_upload_link_thumb_mms_enabled","03e","mediaretry","35","hfm_string_changes","28","America/Fortaleza","max_keys","md_mhfs_days","streaming_upload_chunk_size","5541","040","03d","2675","03f","...","512","mute","48","041","alt_jpeg_quality","60","042","md_smb_quick_reply","5183","c","1343","40","1230","043","044","mms_cat_v1_forward_hot_override_enabled","user_notice","ptt_waveform_send","047","Asia/Calcutta","250","md_privacy_v2","31","29","128","md_messaging_enabled","046","crypto","690","045","enc_iv","75","failure","ptt_oot_playback","AIzaSyDR5yfaG7OG8sMTUj8kfQEb8T9pN8BM6Lk","w","048","2201","web_large_files_ui","Asia/Makassar","812","status_collapse_muted","1334","257","2HP4dm","049","patches","1290","43cY6T","America/Caracas","web_sticker_maker","campaign","ptt_pausable_enabled","33","42","attestation","biz","04b","query_linked","s","125","04a","810","availability","1411","responsiveness_v2_m1","catalog_not_created","34","America/Santiago","1465","enc_p","04d","status_info","04f","key_version","..","04c","04e","md_group_notification","1598","1215","web_cart_enabled","37","630","1920","2394","-1","vcard","38","elapsed","36","828","peer","pricing_category","1245","invalid","stella_ios_enabled","2687","45","1528","39","u_is_redial_audio_1104_ctrl","1025","1455","58","2524","2603","054","bsp_system_message_enabled","web_pip_redesign","051","verify_apps","1974","1272","1322","1755","052","70","050","1063","1135","1361","80","1096","1828","1851","1251","1921","key_config_id","1254","1566","1252","2525","critical_block","1669","max_available","w:auth:backup:token","product","2530","870","1022","participant_uuid","web_cart_on_off","1255","1432","1867","41","1415","1440","240","1204","1608","1690","1846","1483","1687","1749","69","url_number","053","1325","1040","365","59","Asia/Riyadh","1177","test_recommended","057","1612","43","1061","1518","1635","055","1034","1375","750","1430","event_code","1682","503","55","865","78","1309","1365","44","America/Guayaquil","535","LIMITED","1377","1613","1420","1599","1822","05a","1681","password","1111","1214","1376","1478","47","1082","4282","Europe/Istanbul","1307","46","058","1124","256","rate-overlimit","retail","u_a_socket_err_fix_succ_test","1292","1370","1388","520","861","psa","regular","1181","1766","05b","1183","1213","1304","1537"],d=["1724","profile_picture","1071","1314","1605","407","990","1710","746","pricing_model","056","059","061","1119","6027","65","877","1607","05d","917","seen","1516","49","470","973","1037","1350","1394","1480","1796","keys","794","1536","1594","2378","1333","1524","1825","116","309","52","808","827","909","495","1660","361","957","google","1357","1565","1967","996","1775","586","736","1052","1670","bank","177","1416","2194","2222","1454","1839","1275","53","997","1629","6028","smba","1378","1410","05c","1849","727","create","1559","536","1106","1310","1944","670","1297","1316","1762","en","1148","1295","1551","1853","1890","1208","1784","7200","05f","178","1283","1332","381","643","1056","1238","2024","2387","179","981","1547","1705","05e","290","903","1069","1285","2436","062","251","560","582","719","56","1700","2321","325","448","613","777","791","51","488","902","Asia/Almaty","is_hidden","1398","1527","1893","1999","2367","2642","237","busy","065","067","233","590","993","1511","54","723","860","363","487","522","605","995","1321","1691","1865","2447","2462","NON_TRANSACTIONAL","433","871","432","1004","1207","2032","2050","2379","2446","279","636","703","904","248","370","691","700","1068","1655","2334","060","063","364","533","534","567","1191","1210","1473","1827","069","701","2531","514","prev_dhash","064","496","790","1046","1139","1505","1521","1108","207","544","637","final","1173","1293","1694","1939","1951","1993","2353","2515","504","601","857","modify","spam_request","p_121_aa_1101_test4","866","1427","1502","1638","1744","2153","068","382","725","1704","1864","1990","2003","Asia/Dubai","508","531","1387","1474","1632","2307","2386","819","2014","066","387","1468","1706","2186","2261","471","728","1147","1372","1961"],m=[s,u,c,d];i.DICT_VERSION=e,i.SINGLE_BYTE_TOKEN=l,i.DICTIONARY_0_TOKEN=s,i.DICTIONARY_1_TOKEN=u,i.DICTIONARY_2_TOKEN=c,i.DICTIONARY_3_TOKEN=d,i.DICTIONARIES=m}),66);
__d("WAXmlFormatter",[],(function(t,n,r,o,a,i){"use strict";function e(e){var t=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns:/g,"~::~xmlns:").replace(/\s*xmlns=/g,"~::~xmlns=").split("~::~"),n=t.length,r=!1,o=0,a="",i=0,s=["\n"];for(i=0;i<100;i++)s.push(s[i]+"    ");var u=function(t,n){var e=/^<[\w:\-.,]+/.exec(t[n-1]),r=/^<\/[\w:\-.,]+/.exec(t[n]);return e!=null&&r!=null&&e[0]===r[0]};for(i=0;i<n;i++)t[i].search(/<!/)>-1?(a+=s[o]+t[i],r=!0,(t[i].search(/-->/)>-1||t[i].search(/\]>/)>-1||t[i].search(/!DOCTYPE/)>-1)&&(r=!1)):t[i].search(/-->/)>-1||t[i].search(/\]>/)>-1?(a+=t[i],r=!1):u(t,i)?(a+=t[i],r||o--):t[i].search(/<\w/)>-1&&t[i].search(/<\//)===-1&&t[i].search(/\/>/)===-1?(t[i]=l(t[i]),a=r?a+=t[i]:a+=s[o++]+t[i]):t[i].search(/<\w/)>-1&&t[i].search(/<\//)>-1?a=r?a+=t[i]:a+=s[o]+t[i]:t[i].search(/<\//)>-1?a=r?a+=t[i]:a+=s[o===0?o:--o]+t[i]:t[i].search(/\/>/)>-1?a=r?a+=t[i]:a+=s[o]+t[i]:t[i].search(/<\?/)>-1||t[i].search(/xmlns:/)>-1||t[i].search(/xmlns=/)>-1?a+=s[o]+t[i]:a+=t[i];return a[0]==="\n"?a.slice(1):a}function l(e){var t=e.match(/(<query.*>|<result>)(\{.*\})/);if(t===null)return e;try{var n=t[1],r=JSON.stringify(JSON.parse(t[2]),null,2);return n+"\n"+r}catch(t){return e+"[Error formatting JSON]"}}i.default=e}),66);
__d("WAXmlNode",["WAHex"],(function(t,n,r,o,a,i,l){"use strict";var e={},s=(function(){function t(t,n,r){n===void 0&&(n=e),r===void 0&&(r=null),this.tag=t,this.attrs=n,this.content=r}var n=t.prototype;return n.toString=function(){var e="<"+this.tag;e+=u(this.attrs);var t=this.content;return Array.isArray(t)?e+=">"+t.map(String).join("")+"</"+this.tag+">":t instanceof Uint8Array?e+=">"+c(t)+"</"+this.tag+">":t!=null?e+=">"+String(t)+"</"+this.tag+">":e+=" />",e},t})();function u(e){for(var t=Object.keys(e),n="",r=0;r<t.length;r++){var o=t[r];n+=" "+o+'="'+e[o].toString()+'"'}return n}function c(e){var t="";return e.length===0?t="<!-- empty binary -->":e.length<50?t=o("WAHex").bytesToDebugString(e):t="<!-- "+e.length+" bytes -->",t}l.XmlNode=s,l.attrsToString=u,l.uint8ArrayToDebugString=c}),98);
__d("WAWap",["WAAssertUnreachable","WABinary","WACryptoDependencies","WAJids","WALogger","WALongInt","WATextEncoding","WAWapDict","WAWapJid","WAXmlFormatter","WAXmlNode","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=(s=o("WAJids")).MSGR_USER_DOMAIN.replace("@",""),d=s.WA_USER_DOMAIN.replace("@",""),m=s.LID_DOMAIN.replace("@",""),p=s.INTEROP_DOMAIN.replace("@",""),_=s.HOSTED_DOMAIN.replace("@",""),f=2,g=128,h=0,y=236,C=237,b=238,v=239,S=[y,C,b,v],R=245,L=246,E=247,k=248,I=249,T=250,D=251,x=252,$=253,P=254,N=255,M=["0","1","2","3","4","5","6","7","8","9","-",".","\uFFFD","\uFFFD","\uFFFD","\uFFFD"],w=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],A="",F=1,O={sentinel:"DROP_ATTR"},B=(u=o("WAWapJid")).WapJid.create(null,"g.us"),W=u.WapJid.create(null,s.WA_SERVER_JID_SUFFIX),q=u.WapJid.create("status","broadcast"),U=u.WapJid.create(null,"newsletter"),V=u.WapJid.create(null,"hosted"),H=u.WapJid.create(null,"hosted.lid"),G=u.WapJid.create(null,"call"),z={},j=!1;function K(){j=!0}var Q=o("WATextEncoding").newTextEncoder(),X=(function(){function e(e,t,n){t===void 0&&(t=z),n===void 0&&(n=null),this.tag=e,this.attrs=t,this.content=n}var t=e.prototype;return t.toString=function(){var e="<"+this.tag;e+=o("WAXmlNode").attrsToString(this.attrs);var t=this.content;return Array.isArray(t)?e+=">"+t.map(String).join("")+"</"+this.tag+">":t?e+=">"+o("WAXmlNode").uint8ArrayToDebugString(t)+"</"+this.tag+">":e+=" />",j&&(e=r("WAXmlFormatter")(e)),e},e})();function Y(e,t,n){var a=null;if(t&&t.children!=null)throw r("err")('Children should not be passed via props (see eslint check "react/no-children-props")');if(Array.isArray(n))a=n.filter(Boolean);else if(typeof n=="string")a=o("WABinary").Binary.build(n).readByteArrayView();else if(n instanceof ArrayBuffer)a=new Uint8Array(n);else if(n instanceof Uint8Array)a=n;else{for(var i=[],l=2;l<arguments.length;l++){var s=arguments[l];s&&i.push(s)}a=i}Array.isArray(a)&&a.length===0&&(a=null);var u={};if(t){var c=t;Object.keys(c).forEach(function(t){if(!["__self","__source"].includes(t)){var n=c[t];if(n==null)throw r("err")("Attr "+t+" in <"+e+"> is null");n!==O&&(u[t]=n)}})}return new X(e,u,a)}var J=Y;function Z(e){return e instanceof o("WAWapJid").WapJid?e.toString():e}function ee(e){var t=e.content;return Array.isArray(t)?t=t.map(ee):typeof t=="string"&&(t=o("WABinary").Binary.build(t).readByteArrayView()),new X(e.tag,e.attrs||z,t)}function te(e){var t=e instanceof X?e:ee(e),n=new(o("WABinary")).Binary;ne(t,n);var r=0,a=n.readByteArrayView(),i=new Uint8Array(1+a.length);return i[0]=r,i.set(a,1),i}function ne(e,t){if(e==null)t.writeUint8(h);else if(e instanceof X)oe(e,t);else if(e instanceof o("WAWapJid").WapJid)re(e,t);else if(typeof e=="string")se(e,t);else if(e instanceof Uint8Array)ce(e,t);else{var n=typeof e;throw r("err")("Invalid payload type "+n)}}function re(e,t){var n=e.getInnerJid();if(n.type===o("WAWapJid").WAP_JID_SUBTYPE.JID_U){var r=n.device,a=n.domainType,i=n.user;t.writeUint8(E),t.writeUint8(a),t.writeUint8(r),ne(i,t)}else if(n.type===o("WAWapJid").WAP_JID_SUBTYPE.JID_FB){var l=n.device,s=n.user;t.writeUint8(L),ne(s,t),t.writeUint16(l),ne(c,t)}else if(n.type===o("WAWapJid").WAP_JID_SUBTYPE.JID_INTEROP){var u=n.device,d=n.integrator,m=n.user;t.writeUint8(R),ne(m,t),t.writeUint16(u),t.writeUint16(d)}else{var p=n.server,_=n.user;t.writeUint8(T),_!=null?ne(_,t):t.writeUint8(h),ne(p,t)}}function oe(e,t){if(e.tag===void 0){t.writeUint8(k),t.writeUint8(h);return}var n=1;e.attrs&&(n+=Object.keys(e.attrs).length*2),e.content&&n++,n<256?(t.writeUint8(k),t.writeUint8(n)):n<65536&&(t.writeUint8(I),t.writeUint16(n)),ne(e.tag,t),e.attrs&&Object.keys(e.attrs).forEach(function(n){se(n,t),ne(e.attrs[n],t)});var r=e.content;if(Array.isArray(r)){r.length<256?(t.writeUint8(k),t.writeUint8(r.length)):r.length<65536&&(t.writeUint8(I),t.writeUint16(r.length));for(var o=0;o<r.length;o++)oe(r[o],t)}else r&&ne(r,t)}var ae,ie;function le(e){for(var t=new Map,n=0;n<e.length;n++)t.set(e[n],n);return t}function se(e,t){if(e===""){t.writeUint8(x),t.writeUint8(0);return}ae==null&&(ae=le(o("WAWapDict").SINGLE_BYTE_TOKEN));var n=ae.get(e);if(n!=null){t.writeUint8(n+1);return}if(ie==null){ie=[];for(var r=0;r<o("WAWapDict").DICTIONARIES.length;++r)ie.push(le(o("WAWapDict").DICTIONARIES[r]))}for(var a=0;a<ie.length;++a){var i=ie[a].get(e);if(i!=null){t.writeUint8(S[a]),t.writeUint8(i);return}}var l=o("WABinary").numUtf8Bytes(e);if(l<128){var s=/[^0-9.-]+?/,u=/[^0-9A-F]+?/;if(s.exec(e)){if(!u.exec(e)){ue(e,D,t);return}}else{ue(e,N,t);return}}de(l,t),t.writeString(e)}function ue(e,t,n){var o=e.length%2===1;n.writeUint8(t);var a=Math.ceil(e.length/2);o&&(a|=g),n.writeUint8(a);for(var i=0,l=0;l<e.length;l++){var s=e.charCodeAt(l),u=null;if(48<=s&&s<=57?u=s-48:t===N?s===45?u=10:s===46&&(u=11):t===D&&65<=s&&s<=70&&(u=s-55),u==null)throw r("err")("Cannot nibble encode "+s);l%2===0?(i=u<<4,l===e.length-1&&(i|=15,n.writeUint8(i))):(i|=u,n.writeUint8(i))}}function ce(e,t){de(e.length,t),t.writeByteArray(e)}function de(e,t){if(e<256)t.writeUint8(x),t.writeUint8(e);else if(e<1048576)t.writeUint8($),t.writeUint8(e>>>16&255),t.writeUint8(e>>>8&255),t.writeUint8(e&255);else if(e<4294967296)t.writeUint8(P),t.writeUint32(e);else throw r("err")("Binary with length "+e+" is too big for WAP protocol")}function me(t,n){var r=new(o("WABinary")).Binary(t),a=r.readUint8(),i=a&f;return i?(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Decoding compressed stanza"]))),n(r.readByteArrayView()).then(function(e){return ge(new(o("WABinary")).Binary(e))})):Promise.resolve(ge(r))}function pe(e){var t=new(o("WABinary")).Binary(e),n=t.readUint8(),a=n&f;if(a)throw r("err")("Cannot pass compressed stanza to decodeStanzaDebug");return ge(t)}function _e(e,t){var n=e.readUint8();if(n===h)return null;if(n===k)return fe(e,e.readUint8());if(n===I)return fe(e,e.readUint16());if(n===x){var a=e.readUint8();return Re(e,a,t)}if(n===$){var i=e.readUint8(),l=e.readUint8(),s=e.readUint8(),u=((i&15)<<16)+(l<<8)+s;return Re(e,u,t)}if(n===P){var c=e.readUint32();return Re(e,c,t)}if(n===T)return Ce(e);if(n===L)return be(e);if(n===R)return ve(e);if(n===E)return Se(e);if(n===N){var d=e.readUint8(),m=d>>>7,p=d&127;return Le(e,M,m,p)}if(n===D){var _=e.readUint8(),f=_>>>7,g=_&127;return Le(e,w,f,g)}if(n<=0||n>=240)throw r("err")("Unable to decode WAP buffer");if(n>=y&&n<=v){var C=n-y,b=o("WAWapDict").DICTIONARIES[C];if(b===void 0)throw r("err")("Missing WAP dictionary "+C);var S=e.readUint8(),A=b[S];if(A===void 0)throw r("err")("Invalid value index "+S+" in dict "+C);return A}var F=o("WAWapDict").SINGLE_BYTE_TOKEN[n-1];if(F===void 0)throw r("err")("Undefined token with index "+n);return F}function fe(e,t){for(var n=[],r=0;r<t;r++)n.push(ge(e));return n}function ge(e){var t=e.readUint8(),n;if(t===k)n=e.readUint8();else if(t===I)n=e.readUint16();else throw r("err")("Failed to decode node since type byte "+String(t)+" is invalid");var a=void 0,i=null;if(n===0)throw r("err")("Failed to decode node, list cannot be empty");var l=he(e);for(n-=1;n>1;){a||(a={});var s=he(e),u=_e(e,!0);a[s]=u,n-=2}return n===1&&(i=_e(e,!1),i instanceof o("WAWapJid").WapJid&&(i=String(i)),typeof i=="string"&&(i=Q.encode(i))),new X(l,a,i)}function he(e){var t=_e(e,!0);if(typeof t!="string")throw r("err")("WAWap:decodeString got invalid value, string expected");return t}function ye(e){var t=_e(e,!0);if(t!=null&&typeof t!="string")throw r("err")("WAWap:decodeNullableString got invalid value, string expected");return t}function Ce(e){var t=ye(e),n=he(e);return o("WAWapJid").WapJid.create(t,n)}function be(e){var t=he(e),n=e.readUint16();return he(e),o("WAWapJid").WapJid.createFbJid(t,n)}function ve(e){var t=he(e),n=e.readUint16(),r=e.readUint16();return he(e),o("WAWapJid").WapJid.createInteropJid(t,n,r)}function Se(e){var t=null,n=e.readUint8();if(n===0)t=o("WAWapJid").DomainType.WHATSAPP;else if(n===1)t=o("WAWapJid").DomainType.LID;else if((1&n)===0&&(128&n)!==0)t=o("WAWapJid").DomainType.HOSTED;else if(n===129)t=o("WAWapJid").DomainType.HOSTED_LID;else throw r("err")("decodeJidU - Invalid domain type encoding "+n);var a=e.readUint8(),i=he(e);return o("WAWapJid").WapJid.createJidU(i,t,a)}function Re(e,t,n){return n===void 0&&(n=!1),n?e.readString(t):e.readByteArrayView(t)}function Le(e,t,n,r){for(var o=new Array(r*2-n),a=0;a<o.length-1;a+=2){var i=e.readUint8();o[a]=t[i>>>4],o[a+1]=t[i&15]}if(n){var l=e.readUint8();o[o.length-1]=t[l>>>4]}return o.join("")}function Ee(){if(!A){var e=new Uint16Array(2);o("WACryptoDependencies").getCrypto().getRandomValues(e),A=String(e[0])+"."+String(e[1])+"-"}return""+A+F++}function ke(e){switch(e.type){case"group":return e.groupJid;case"status":return o("WAJids").STATUS_JID;case"device":return e.deviceJid;case"newsletter":return e.newsletterJid;case"hosted":return e.hostedDeviceJid;case"hostedLid":return e.hostedLidDeviceJid;default:return e.type,e.broadcastJid}}function Ie(e){switch(e.type){case"group":return e.author;case"status":return e.author;case"broadcast":return e.author;default:return e.type,null}}function Te(e){return e.type==="status"||e.type==="group"||e.type==="broadcast"?xe(e.author):O}function De(e){return xe(ke(e))}function xe(e){var t=o("WAJids").validateDomainJid(e);if(t!=null)return $e(t);var n=e.split("@"),a=n[0],i=n[1],l=null,s=null;if((i===d||i===c||i===p||i===m||i===_||i===o("WAJids").HOSTED_LID_SUFFIX)&&a.indexOf(":")!==-1){var u=a.split(":");a=u[0],l=u[1],s=parseInt(l,10)}if(i===p){var f=a.split("-"),g=f[0],h=f[1];return o("WAWapJid").WapJid.createInteropJid(h,s,parseInt(g,10))}else if(i===c)return o("WAWapJid").WapJid.createFbJid(a,s);var y=null;if(i===m)y=o("WAWapJid").DomainType.LID;else if(i===_){if(s!==99)throw r("err")("wid unexpected deviceId");y=o("WAWapJid").DomainType.HOSTED}else if(i===o("WAJids").HOSTED_LID_SUFFIX){if(s!==99)throw r("err")("lid invalid deviceId");y=o("WAWapJid").DomainType.HOSTED_LID}else y=o("WAWapJid").DomainType.WHATSAPP;return s!=null&&s!==0?o("WAWapJid").WapJid.createJidU(a,y,s):o("WAWapJid").WapJid.create(a,i)}function $e(e){return e==="s.whatsapp.net"?W:e==="g.us"?B:e==="newsletter"?U:e==="call"?G:r("WAAssertUnreachable")(e)}function Pe(e){return xe(e)}function Ne(e){return xe(e)}function Me(e){return xe(e)}function we(e){return xe(e)}function Ae(e){return xe(e)}function Fe(e){return xe(e)}function Oe(e){return e.jidType==="phoneDevice"||e.jidType==="msgrDevice"||e.jidType==="lidDevice"?xe(e.deviceJid):e.jidType==="phoneUser"||e.jidType==="msgrUser"||e.jidType==="lidUser"?xe(e.userJid):e.jidType==="group"?xe(e.groupJid):e.jidType==="status"?xe(e.statusJid):e.jidType==="call"?xe(e.callJid):e.jidType==="interopDevice"?xe(e.deviceJid):e.jidType==="interopUser"?xe(e.userJid):e.jidType==="newsletter"?xe(e.newsletterJid):e.jidType==="hosted"?xe(e.hostedDeviceJid):e.jidType==="hostedLid"?xe(e.hostedLidDeviceJid):e.jidType==="bot"?xe(e.botJid):(e.jidType,xe(e.broadcastJid))}function Be(e){return e}function We(e){return e.toString()}function qe(e){return e}function Ue(e){return e}function Ve(e){return e==null?O:e}function He(e){return e.toString()}function Ge(e){return o("WALongInt").longIntToDecimalString(e)}function ze(e,t){t===void 0&&(t=4);for(var n=e,r=new Uint8Array(t),o=t-1;o>=0;o--)r[o]=n&255,n>>>=8;return r}l.DROP_ATTR=O,l.G_US=B,l.S_WHATSAPP_NET=W,l.STATUS_BROADCAST=q,l.NEWSLETTER=U,l.HOSTED=V,l.HOSTED_LID=H,l.CALL=G,l.enableXMLFormat=K,l.WapNode=X,l.makeWapNode=Y,l.wap=J,l.decodeAsString=Z,l.makeStanza=ee,l.encodeStanza=te,l.decodeStanza=me,l.decodeStanzaDebug=pe,l.generateId=Ee,l.extractToJid=ke,l.extractParticipantJid=Ie,l.PARTICIPANT_JID=Te,l.TO_JID=De,l.JID=xe,l.DOMAIN_JID=$e,l.USER_JID=Pe,l.DEVICE_JID=Ne,l.GROUP_JID=Me,l.BROADCAST_JID=we,l.CALL_JID=Ae,l.NEWSLETTER_JID=Fe,l.TO_WAP_JID=Oe,l.STANZA_ID=Be,l.SMAX_ID=We,l.CUSTOM_STRING=qe,l.CALL_ID=Ue,l.MAYBE_CUSTOM_STRING=Ve,l.INT=He,l.LONG_INT=Ge,l.BIG_ENDIAN_CONTENT=ze}),98);
__d("WASmaxJsx",["WAWap"],(function(t,n,r,o,a,i,l){"use strict";l.smax=o("WAWap").wap}),98);
__d("WASmaxMixins",["WAArrayBufferUtils","WAWapJid"],(function(t,n,r,o,a,i,l){"use strict";var e="smax$any";function s(e,t){return c(e,t),d(e,t),t.content instanceof Uint8Array?p(e,t.content):t.content!=null&&_(e,t.content),e}function u(e,t,n,r){return n!=null?e(t,n,r):t}function c(t,n){var r=t.tag,o=n.tag;if(o!==e&&r!==o)throw new Error("tag mismatch: "+r+" != "+o)}function d(e,t){var n=e.attrs,r=t.attrs;Object.keys(r).forEach(function(e){var t=r[e],o=n[e];if(t!=null&&o!=null){if(m(t,o))return;throw new Error("conflict for key: "+e)}n[e]=t})}function m(e,t){return typeof e=="string"&&typeof t=="string"?e===t:e instanceof o("WAWapJid").WapJid&&t instanceof o("WAWapJid").WapJid?e.toString()===t.toString():!1}function p(e,t){var n=e.content;if(n instanceof Uint8Array){if(!o("WAArrayBufferUtils").uint8ArraysEqualUNSAFE(n,t))throw new Error("elementValue mismatch: bytes dose not equal");return}if(n!=null)throw new Error("elementValue mismatch: destination has children");e.content=t}function _(e,t){var n=e.content;if(n instanceof Uint8Array)throw new Error("children mismatch: destination has element value");if(n==null||n.length===0){e.content=t;return}if(!f(n,t))throw new Error("children mismatch: child counts are not compatible");var r=[],o=Array.from(n);t.forEach(function(e){var t=o.findIndex(function(t){return t.tag===e.tag});if(t===-1)r.push(e);else{var n=o.splice(t,1),a=s(n[0],e);r.push(a)}}),o.forEach(function(e){return r.push(e)}),e.content=r}function f(e,t){for(var n=g(t),r=g(e),o=Object.keys(n),a=0;a<o.length;a++){var i=o[a],l=n[i],s=r[i];if(l!=null&&s!=null&&l!==s)return!1}return!0}function g(e){return e.reduce(function(e,t){var n=t.tag,r=e[n];return e[n]=r==null?1:r+1,e},{})}l.mergeStanzas=s,l.optionalMerge=u}),98);
__d("WASmaxOutPingsClientWellFormedToMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("iq",{to:o("WAWap").S_WHATSAPP_NET});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeClientWellFormedToMixin=s}),98);
__d("WASmaxOutPingsClientRequest",["WASmaxJsx","WASmaxOutPingsClientWellFormedToMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxOutPingsClientWellFormedToMixin").mergeClientWellFormedToMixin(o("WASmaxJsx").smax("iq",{id:o("WAWap").generateId(),type:"get",xmlns:"w:p"}));return e}l.makeClientRequest=e}),98);
__d("WAComms",["WAArrayUtils","WABaseGlobals","WAErrors","WALogger","WANotifyConnectionChangeFactory","WAPromiseRetryLoop","WAResolvable","WAShiftTimer","WASmaxInPingsClientResponseServerResponse","WASmaxOutPingsClientRequest","WASmaxParseUtils","WATimeUtils","WAWap","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T,D,x,$,P,N,M,w=null,A=null,F=1,O=0,B=(function(){function t(t,n,r){var a=this,i,l,c;this.nextSocketId=1,this.pendingIqs=new Map,this.ackHandlers=[],this.pendingSmaxStanzas=new Map,this.$2=new(o("WAResolvable")).Resolvable,this.socketAbortController=null,this.activePing=null,this.$3=new Set,this.socketId=O,this.socket=null,this.softCloseSocket=null,this.handleStanza=function(t,n,r){var i=o("WASmaxParseUtils").attrString(t,"id");if(i.success&&t.tag!=="receipt"){var l=i.value,u=a.pendingSmaxStanzas.get(l);if(u)return a.pendingSmaxStanzas.delete(l),u.resolve(t),a.maybeScheduleHealthCheck(),"NO_ACK"}var c=ue(t);if(c!=null){var d=a.pendingIqs.get(c);d?(a.pendingIqs.delete(c),d.resolve(t),a.maybeScheduleHealthCheck()):(o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["handleIq no handler for iq with id ",""])),c),o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["handleIq no handler for iq"]))))}else if(t.tag==="ack")a.handleAck(t);else return t.tag==="failure"&&a.config.shouldBlockReceivingUntilSuccess?a.$1(t,n,r):a.$2.promise.then(function(){return a.$1(t,n,r)});return"NO_ACK"},this.healthCheckTimer=new(o("WAShiftTimer")).ShiftTimer(function(){a.socketId&&a.sendPing()}),this.deadSocketTimer=new(o("WAShiftTimer")).ShiftTimer(function(e){e===a.socketId&&(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[comms] Socket "," expired"])),e),a.softCloseSocket&&a.softCloseSocket())}),this.$1=t,this.onConnectionChange=o("WANotifyConnectionChangeFactory").notifyConnectionChangeFactory((i=n.handlers.onConnectionChange)!=null?i:function(){},(l=n.handlers.onOptimisticConnectionChange)!=null?l:function(){}),this.gzipInflate=r,this.config=n,this.socketLoop=new(o("WAPromiseRetryLoop")).PromiseRetryLoop({name:"MainSocketLoop",code:Y,timer:(c=n.socketReconnectBackoffAlgo)!=null?c:{jitter:.1,max:n.maxSocketLoopWaitTime,algo:{type:"fibonacci",first:1e4,second:1e4},relativeDelay:!0},resetDelay:3e4,isPauseEnabled:n.isPauseEnabled===!0})}var n=t.prototype;return n.filterPending=function(t){var e=[];function n(n){t(n)&&e.push(n)}return this.pendingIqs.forEach(n),this.ackHandlers.forEach(n),this.pendingSmaxStanzas.forEach(n),e},n.sendPendingStanza=function(t){t.cleanup==null||t.cleanup(),t.cleanup=void 0,this.callStanza(t.stanza)},n.maybeSendPendingStanza=function(t){if(t.attempt>=this.config.maxRetries){var e,n;(e=(n=this.config.handlers).onDropStanza)==null||e.call(n,t),t.cleanup==null||t.cleanup(),t.cleanup=void 0,this.removeHandler(t,"max-retries")}else if(this.socket){t.attempt+=1,this.sendPendingStanza(t);return}else o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Comms has no open socket, will resend stanza when socket opens"])))},n.callStanzaAsync=async function(t,n){var e=await this.callStanza(t,n);return e},n.callStanza=function(t,n){var e=this.castStanza(t,n);return this.deadSocketTimer.onOrBefore(this.config.deadSocketTime,this.socketId),this.healthCheckTimer.cancel(),e},n.castStanzaAsync=async function(t){var e=await this.castStanza(t);return e},n.castStanza=function(t,n){var e=this;try{var r,a,i=(r=(a=this.config.handlers).onBeforeCastStanzaForE2E)==null?void 0:r.call(a,t,n);if(i!=null)return o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Dropping stanza since onBeforeCastStanza matched. We return mock response directly."]))),Array.isArray(i)?Promise.all(i.map(function(t){return Promise.resolve(e.handleStanza(t,e.socketId,O))})):(this.handleStanza(i,this.socketId,O),Promise.resolve())}catch(e){}var l=this.socketOrThrow("castStanza");try{return l.sendFrame(o("WAWap").encodeStanza(t)).then(function(){e.config.handlers.onCastStanza==null||e.config.handlers.onCastStanza(t,n)}).catch(function(e){if(o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["castStanza async error ",""])),e),e instanceof o("WAErrors").BufferTooLargeError)return Promise.reject(e)})}catch(e){o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["castStanza error ",""])),e)}return Promise.resolve()},n.socketOrThrow=function(t){var e=this.socket;if(e)return e;throw r("err")("Comms."+t+" called while no socket")},n.startHandlingRequests=function(){return o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Comms.startHandlingRequests"]))),this.$2.resolve(),this.$2.promise.then(function(){})},n.parseAndHandleStanza=function(t,n){var e=this;t===this.socketId&&(this.deadSocketTimer.cancel(),A&&(A.resolve(),A=null));var r=o("WAWap").decodeStanza(n,this.gzipInflate).catch(function(e){throw o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["Failure parsing stanza!"]))),e}).then(function(r){e.config.handlers.onHandleStanza==null||e.config.handlers.onHandleStanza(r,t,n.byteLength);var o=e.activePing;return o&&o.socketId===t&&o.stanzaId===ue(r)?(e.activePing=null,o.handler.resolve(r),e.maybeScheduleHealthCheck(),"NO_ACK"):e.handleStanza(r,t,n.byteLength)}).then(function(n){if(t===e.socketId){if(n==="CLOSE_SOCKET"){o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[comms] job response is CLOSE_SOCKET"])));var r=e.socket;r&&r.close()}else n==="NO_ACK"||e.castStanza(n);return"NO_ACK"}});this.$3.add(r),r.finally(function(){return void e.$3.delete(r)})},n.handleAck=function(t){for(var e=this.ackHandlers,n=-1,r=null;!r&&++n<e.length;)r=e[n].parseAndTest(t);if(r){var a,i,l=e[n];o("WAArrayUtils").removeIndexWithoutPreservingOrder(e,n),(a=(i=this.config.handlers).onHandleAck)==null||a.call(i,t),l.resolve(r),this.maybeScheduleHealthCheck()}else o("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["handleAck: unrecognized ",""])),t)},n.removeHandler=function(t,n){if(n===void 0&&(n="disconnect"),t.type==="iq"||t.type==="smax"){var e=t.stanza.attrs.id;if(!e||typeof e!="string"||t.type==="iq"&&!this.pendingIqs.delete(e)||t.type==="smax"&&!this.pendingSmaxStanzas.delete(e))return}else{t.type;var r=this.ackHandlers.indexOf(t);if(r===-1)return;o("WAArrayUtils").removeIndexWithoutPreservingOrder(this.ackHandlers,r)}n==="disconnect"?t.resolve(Promise.reject(new(o("WAErrors")).Disconnected)):n==="abort"?t.resolve(Promise.reject(new(o("WAErrors")).Aborted)):t.resolve(Promise.reject(new(o("WAErrors")).MaxRetries))},n.maybeScheduleHealthCheck=function(){if(!this.healthCheckTimer.isScheduled()&&!(this.activePing||this.ackHandlers.length||this.pendingIqs.size||this.pendingSmaxStanzas.size)){var e=this.config.healthCheckInterval,t=Math.ceil(e*1e3*(1+Math.random()));this.healthCheckTimer.onOrBefore(t)}},n.sendPing=async function(){var e=se("sendPing");if(!e.socketId)return o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[comms] sendPing when socket dead"]))),!1;if(e.activePing&&e.activePing.socketId===e.socketId)return o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[comms] sendPing ping still pending"]))),!1;e.activePing&&e.activePing.handler.resolve();var t=o("WASmaxOutPingsClientRequest").makeClientRequest(),n=t.attrs.id;if(typeof n!="string")return o("WALogger").ERROR(b||(b=babelHelpers.taggedTemplateLiteralLoose(["[comms] No stanzaId in ping request stanza"]))),!1;var r=new(o("WAResolvable")).Resolvable;e.activePing={socketId:e.socketId,stanzaId:n,handler:r};var a=Date.now();e.callStanza(t);var i=await r.promise,l=Date.now();if(i){var s=o("WASmaxInPingsClientResponseServerResponse").parseClientResponseServerResponse(i,t);if(s.success){var u=l-a,c=Math.round(u/2),d=o("WATimeUtils").castToUnixTime(s.value.t),m=o("WABaseGlobals").newClockSkewCalculation()?Math.round((a+c)/1e3-d):Math.round(Date.now()/1e3-d);return e.config.handlers.onClockSkewUpdate==null||e.config.handlers.onClockSkewUpdate(m),!0}}return!1},t})();function W(){return w}function q(e,t,n,r){r===void 0&&(r=!0),!w&&(w=new B(e,t,n),r&&setTimeout(z,0))}function U(){var e=se("stopComms");e.socketLoop.endWithValue(),e.socket&&J(),w=null}function V(){var e=se("closeSocketAndPreventRetry");e.socketLoop.endWithValue(),e.socket&&(o("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[comms] closeSocketAndPreventRetry called"]))),J())}function H(){var e=se("closeSocketAndPause");e.socketLoop.pauseOnNextIteration(),e.socket&&(o("WALogger").LOG(S||(S=babelHelpers.taggedTemplateLiteralLoose(["[comms] closeSocketAndPause called"]))),J())}function G(){var e=se("closeSocketAndResume");e.socketLoop.unpause(),e.socket&&(o("WALogger").LOG(R||(R=babelHelpers.taggedTemplateLiteralLoose(["[comms] closeSocketAndResume called"]))),J())}function z(){se("openSocketLoop").socketLoop.start()}function j(){o("WALogger").LOG(L||(L=babelHelpers.taggedTemplateLiteralLoose(["[comms] maybeResetSocketLoop"]))),X()||se("maybeResetSocketLoop").socketLoop.reset()}function K(){se("forceResetSocketLoop").socketLoop.reset()}function Q(){var e,t=se("socketAbortController");(e=t.socketAbortController)==null||e.abort(),t.softCloseSocket==null||t.softCloseSocket()}function X(){var e;return!!((e=w)!=null&&e.socket)}function Y(){var e,t=se("socketLoopIteration"),n=t.nextSocketId++;o("WALogger").LOG(E||(E=babelHelpers.taggedTemplateLiteralLoose(["[comms] Socket "," opening"])),n);var r=function(){t.onConnectionChange("in_handshake")};return t.config.handlers.onSocketLoopIteration==null||t.config.handlers.onSocketLoopIteration(t.socketAbortController),typeof AbortController=="function"&&(t.socketAbortController=new AbortController),t.config.openChatSocket(r,(e=t.socketAbortController)==null?void 0:e.signal).then(function(e){if(e.success){var r=e.value;t.config.handlers.onSocketOpen==null||t.config.handlers.onSocketOpen();var a=new(o("WAResolvable")).Resolvable;return o("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[comms] Socket "," opened"])),n),t.socketId=n,t.socket=r,t.softCloseSocket=function(){t.softCloseSocket=null,t.socket&&t.config.shouldCloseStaleSocket&&(J(),t.socket=null),a.resolve()},t.socketLoop.resetTimeoutAfter(1e4),t.deadSocketTimer.cancel(),t.maybeScheduleHealthCheck(),r.setOnFrame(function(e){return t.parseAndHandleStanza(n,e)}),r.setOnClose(function(){o("WALogger").LOG(I||(I=babelHelpers.taggedTemplateLiteralLoose(["[comms] Socket "," closed"])),n),t.activePing&&n===t.activePing.socketId&&(t.activePing.handler.resolve(),t.activePing=null),t.filterPending(function(e){return e.attachedToSocketId===n}).forEach(function(e){return void t.removeHandler(e)}),n===t.socketId&&(t.socketId=O,t.socket=null,t.onConnectionChange("disconnected"),t.config.handlers.onDisconnect==null||t.config.handlers.onDisconnect(),a.resolve())}),t.onConnectionChange("connected"),t.config.handlers.onConnect==null||t.config.handlers.onConnect(),t.filterPending(function(e){return!e.attachedToSocketId}).sort(function(e,t){return e.orderedId-t.orderedId}).forEach(function(e){switch(e.type){case"smax":case"iq":t.maybeSendPendingStanza(e);break;case"ack":t.callStanza(e.stanza);break;default:e.type;break}}),a.promise}else{var i=e.error;switch(i){case"max-hunters":o("WALogger").WARN(T||(T=babelHelpers.taggedTemplateLiteralLoose(["[comms] socketLoopIteration socket closed while in noise handshake using treasureHunt strategy"])));break;case"disconnected":o("WALogger").WARN(D||(D=babelHelpers.taggedTemplateLiteralLoose(["[comms] socketLoopIteration socket disconnected while in noise handshake"])));break;default:return}}}).catch(function(e){e instanceof o("WAErrors").Disconnected?o("WALogger").LOG(x||(x=babelHelpers.taggedTemplateLiteralLoose(["[comms] socketLoopIteration socket closed while in noise handshake"]))):o("WALogger").ERROR($||($=babelHelpers.taggedTemplateLiteralLoose(["[comms] socketLoopIteration failed ",""])),e)})}function J(){var e=se("closeSocket");e.socket&&(o("WALogger").LOG(P||(P=babelHelpers.taggedTemplateLiteralLoose(["[comms] Socket "," closed"])),e.socketId),o("WALogger").LOG(N||(N=babelHelpers.taggedTemplateLiteralLoose(["[comms] closeSocket called"]))),e.socket.close())}function Z(){se("onStreamErrorReceived").socketLoop.cancelReset()}function ee(){return se("waitForConnection").sendPing(),A||(A=new(o("WAResolvable")).Resolvable),A.promise}function te(e,t){var n=se("castStanza");n.socket?n.castStanza(e,t):o("WALogger").LOG(M||(M=babelHelpers.taggedTemplateLiteralLoose(["Comms has no open socket"])))}function ne(e){var t=se("castStanza");return t.socketId===e}function re(e,t,n,a,i){return n===void 0&&(n=0),i===void 0&&(i="iq"),new Promise(function(l){var s=se("sendIq"),u=e.attrs.id;if(!u||typeof u!="string")throw r("err")("[comms] sendIq given iq without id: "+String(e));var c=s.socketId;if(t&&!c){l(Promise.reject(new(o("WAErrors")).Offline));return}var d=function(t){t===void 0&&(t="disconnect");var e=i==="iq"?s.pendingIqs.get(u):s.pendingSmaxStanzas.get(u);if(!e){l(Promise.reject(r("err")("[comms] _sendIq unexisting stanza to be cancelled: "+u)));return}s.removeHandler(e,t)},m=null;if(n>0){var p=setTimeout(d,n*1e3);m=function(){clearTimeout(p)}}if(a!=null)if(a.aborted){l(Promise.reject(new(o("WAErrors")).Disconnected));return}else{var _=function(){d("abort")};a.addEventListener("abort",_),m=function(){a.removeEventListener("abort",_)}}var f={resolve:l,stanza:e,attachedToSocketId:t?c:O,orderedId:F++,attempt:0,cleanup:m};if(i==="iq"){var g=babelHelpers.extends({type:i},f);s.pendingIqs.set(u,g),s.config.handlers.onSendIq==null||s.config.handlers.onSendIq(e),s.maybeSendPendingStanza(g)}else{var h=babelHelpers.extends({type:i},f);s.pendingSmaxStanzas.set(u,h),s.maybeSendPendingStanza(h)}})}function oe(e,t){var n,r,o,a=(n=t==null?void 0:t.withoutRetry)!=null?n:!1,i=(r=t==null?void 0:t.timeoutSeconds)!=null?r:0,l=(o=t==null?void 0:t.signal)!=null?o:null;return re(e,a,i,l,"smax")}function ae(){var e=se("sendPing");return e.sendPing()}function ie(){return se("startHandlingRequests").startHandlingRequests()}function le(){w&&w.deadSocketTimer.cancel()}function se(e){if(w)return w;throw r("err")("[comms] "+e+" called before startComms")}function ue(e){if(e.tag==="iq"){var t=e.attrs.type;if(t==="result"||t==="error")return o("WAWap").decodeAsString(e.attrs.id)||null}return null}function ce(){return F++}function de(){w=null,A=new(o("WAResolvable")).Resolvable,F=1}l.DEFAULT_SOCKET_ID=O,l.getComms=W,l.startComms=q,l.stopComms=U,l.closeSocketAndPreventRetry=V,l.closeSocketAndPause=H,l.closeSocketAndResume=G,l.openSocketLoop=z,l.maybeResetSocketLoop=j,l.forceResetSocketLoop=K,l.forceAbortSocketConnection=Q,l.isSocketConnected=X,l.socketLoopIteration=Y,l.closeSocket=J,l.onStreamErrorReceived=Z,l.waitForConnection=ee,l.castSmaxStanza=te,l.isActiveSocket=ne,l._sendIq=re,l.sendSmaxStanza=oe,l.sendPing=ae,l.startHandlingRequests=ie,l.cancelDeadSocketTimer=le,l.singletonOrThrowIfUninitialized=se,l.getAndIncrementNextOrderedId=ce,l.resetStateForTests=de}),98);
__d("WADecimalStringMod",["WALogger","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t,n){if(!/^\d+$/.test(t))throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(['"','" is not a valid decimal string'])),t),r("err")("decimalStringMod is given an invalid decimal string");var a=t.length;if(a<16||a===16&&t<="9007199254740991")return Number(t)%n;if(a>20||a===20&&t>"18446744073709551615")throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(['"','" is over 64 bits'])),t),r("err")("decimalStringMod is given value over 64 bits");for(var i=0,l=0;l<t.length;l++){var u=Number(t[l]);i=(i*10+u)%n}return i}l.decimalStringMod=u}),98);
__d("WACreateGetVcaEnabledBucket",["WAArrayBufferUtils","WADecimalStringMod","WALogger"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e,t){return function(){return t==null?null:o("WAArrayBufferUtils").arrayBufferMod(e,t)+100}}function u(t,n){return function(){if(n==null)return null;var r=t.split("/"),a=r[r.length-1],i=a.split("_")[1];return/^\d+$/.test(i)?i==null?(o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["mediaRouteSelection: can't get fbId from mediaDirectPath"]))),null):o("WADecimalStringMod").decimalStringMod(i,n)+100:null}}l.createGetVcaEnabledBucket=s,l.msgrCreateGetVcaEnabledBucket=u}),98);
__d("WAExtractNcHotTimestamp",["WATimeUtils"],(function(t,n,r,o,a,i,l){"use strict";function e(e){if(e==null)return null;var t=s(e);if(t.has("_nc_hot")){var n=parseInt(t.get("_nc_hot"),10);return Number.isInteger(n)?o("WATimeUtils").castToUnixTime(n):null}else return null}function s(e){var t=e.split("?");return new URLSearchParams(t.length===2?t[1]:"")}l.extractNcHotTimestamp=e}),98);
__d("WASignalLocalStorageProtocol.pb",["WAProtoConst"],(function(t,n,r,o,a,i,l){var e,s={},u={},c={},d={},m={},p={},_={},f={},g={},h={},y={},C={},b={},v={},S={};s.name="SessionStructure",s.internalSpec={sessionVersion:[1,(e=o("WAProtoConst")).TYPES.UINT32],localIdentityPublic:[2,e.TYPES.BYTES],remoteIdentityPublic:[3,e.TYPES.BYTES],rootKey:[4,e.TYPES.BYTES],previousCounter:[5,e.TYPES.UINT32],senderChain:[6,e.TYPES.MESSAGE,d],receiverChains:[7,e.FLAGS.REPEATED|e.TYPES.MESSAGE,d],pendingKeyExchange:[8,e.TYPES.MESSAGE,c],pendingPreKey:[9,e.TYPES.MESSAGE,u],remoteRegistrationId:[10,e.TYPES.UINT32],localRegistrationId:[11,e.TYPES.UINT32],needsRefresh:[12,e.TYPES.BOOL],aliceBaseKey:[13,e.TYPES.BYTES]},u.name="SessionStructure$PendingPreKey",u.internalSpec={preKeyId:[1,e.TYPES.UINT32],signedPreKeyId:[3,e.TYPES.INT32],baseKey:[2,e.TYPES.BYTES]},c.name="SessionStructure$PendingKeyExchange",c.internalSpec={sequence:[1,e.TYPES.UINT32],localBaseKey:[2,e.TYPES.BYTES],localBaseKeyPrivate:[3,e.TYPES.BYTES],localRatchetKey:[4,e.TYPES.BYTES],localRatchetKeyPrivate:[5,e.TYPES.BYTES],localIdentityKey:[7,e.TYPES.BYTES],localIdentityKeyPrivate:[8,e.TYPES.BYTES]},d.name="SessionStructure$Chain",d.internalSpec={senderRatchetKey:[1,e.TYPES.BYTES],senderRatchetKeyPrivate:[2,e.TYPES.BYTES],chainKey:[3,e.TYPES.MESSAGE,p],messageKeys:[4,e.FLAGS.REPEATED|e.TYPES.MESSAGE,m]},m.name="SessionStructure$Chain$MessageKey",m.internalSpec={index:[1,e.TYPES.UINT32],cipherKey:[2,e.TYPES.BYTES],macKey:[3,e.TYPES.BYTES],iv:[4,e.TYPES.BYTES]},p.name="SessionStructure$Chain$ChainKey",p.internalSpec={index:[1,e.TYPES.UINT32],key:[2,e.TYPES.BYTES]},_.name="RecordStructure",_.internalSpec={currentSession:[1,e.TYPES.MESSAGE,s],previousSessions:[2,e.FLAGS.REPEATED|e.TYPES.MESSAGE,s]},f.name="PreKeyRecordStructure",f.internalSpec={id:[1,e.TYPES.UINT32],publicKey:[2,e.TYPES.BYTES],privateKey:[3,e.TYPES.BYTES]},g.name="SignedPreKeyRecordStructure",g.internalSpec={id:[1,e.TYPES.UINT32],publicKey:[2,e.TYPES.BYTES],privateKey:[3,e.TYPES.BYTES],signature:[4,e.TYPES.BYTES],timestamp:[5,e.TYPES.FIXED64]},h.name="IdentityKeyPairStructure",h.internalSpec={publicKey:[1,e.TYPES.BYTES],privateKey:[2,e.TYPES.BYTES]},y.name="SenderKeyStateStructure",y.internalSpec={senderKeyId:[1,e.TYPES.UINT32],senderChainKey:[2,e.TYPES.MESSAGE,v],senderSigningKey:[3,e.TYPES.MESSAGE,C],senderMessageKeys:[4,e.FLAGS.REPEATED|e.TYPES.MESSAGE,b]},C.name="SenderKeyStateStructure$SenderSigningKey",C.internalSpec={public:[1,e.TYPES.BYTES],private:[2,e.TYPES.BYTES]},b.name="SenderKeyStateStructure$SenderMessageKey",b.internalSpec={iteration:[1,e.TYPES.UINT32],seed:[2,e.TYPES.BYTES]},v.name="SenderKeyStateStructure$SenderChainKey",v.internalSpec={iteration:[1,e.TYPES.UINT32],seed:[2,e.TYPES.BYTES]},S.name="SenderKeyRecordStructure",S.internalSpec={senderKeyStates:[1,e.FLAGS.REPEATED|e.TYPES.MESSAGE,y]},l.SessionStructureSpec=s,l.SessionStructure$PendingPreKeySpec=u,l.SessionStructure$PendingKeyExchangeSpec=c,l.SessionStructure$ChainSpec=d,l.SessionStructure$Chain$MessageKeySpec=m,l.SessionStructure$Chain$ChainKeySpec=p,l.RecordStructureSpec=_,l.PreKeyRecordStructureSpec=f,l.SignedPreKeyRecordStructureSpec=g,l.IdentityKeyPairStructureSpec=h,l.SenderKeyStateStructureSpec=y,l.SenderKeyStateStructure$SenderSigningKeySpec=C,l.SenderKeyStateStructure$SenderMessageKeySpec=b,l.SenderKeyStateStructure$SenderChainKeySpec=v,l.SenderKeyRecordStructureSpec=S}),98);
__d("WASignalKeys",["WACryptoDependencies","WACryptoPrimitives","WASignalLocalStorageProtocol.pb","WASignalOther","decodeProtobuf","err"],(function(t,n,r,o,a,i,l){"use strict";var e=5,s=16777215;function u(e,t){return{publicKey:e,privateKey:t}}function c(e){var t=o("WACryptoPrimitives").keypairFromSecretKey(e),n=t.publicKey,r=t.secretKey;return u(o("WASignalOther").ensureSize(n,32),o("WASignalOther").ensureSize(r,32))}function d(e,t){return{publicKey:o("WASignalOther").toBytes(e,32),privateKey:o("WASignalOther").toBytes(t,32)}}function m(){var e=o("WACryptoPrimitives").keyPair(),t=e.publicKey,n=e.secretKey;return n[0]&=248,n[31]=64|n[31]&63,u(o("WASignalOther").ensureSize(t,32),o("WASignalOther").ensureSize(n,32))}function p(e,t){return u(o("WASignalOther").sliceBytes(t,1,32),e)}function _(e,t){return{serializedPubKey:t,privateKey:e}}function f(){var e=m();return _(e.privateKey,g(e))}function g(t){var n=o("WASignalOther").makeBytes(33);return n[0]=e,n.set(t.publicKey,1),n}function h(t){var n=o("WASignalOther").makeBytes(33);return n[0]=e,n.set(o("WASignalOther").ensureSize(t,32),1),n}function y(e){return _(e.privateKey,g(e))}function C(e,t){for(var n=e>=s?0:e-1,r=[],a=0;a<t;a++){var i=n+1>=s?1:n+1,l=m(),u=o("WASignalOther").encodeSignalProto(o("WASignalLocalStorageProtocol.pb").PreKeyRecordStructureSpec,{id:i,publicKey:g(l),privateKey:l.privateKey});r.push({plainObject:{id:i,keyPair:l},record:u}),n=i}return r}function b(e){try{var t=o("decodeProtobuf").decodeProtobuf(o("WASignalLocalStorageProtocol.pb").PreKeyRecordStructureSpec,e),n=t.id,r=t.privateKey,a=t.publicKey;return n==null||a==null||r==null?null:{id:v(n),keyPair:p(o("WASignalOther").toBytes(r,32),R(new Uint8Array(a)))}}catch(e){return null}}function v(e){return o("WASignalOther").ensureIntInRange(e,1,s)}function S(e){return o("WASignalOther").ensureIntInRange(e,0,s)}function R(t){if(t.length===0||t[0]!==e)throw r("err")("Unrecognized public key type");return o("WASignalOther").ensureSize(t,33)}function L(){var e=o("WASignalOther").makeBytes(32);return o("WACryptoDependencies").getCrypto().getRandomValues(e),e}function E(e,t){return o("WACryptoPrimitives").scalarMult(e,t.subarray(1)).buffer}l.KEY_TYPE=e,l.PRE_KEY_NON_INCLUSIVE_UPPER_BORDER=s,l.makeKeyPairFrom=c,l.makeKeyPairFromArrayBuffers=d,l.makeKeyPair=m,l.makeKeyPairFromSerialized=p,l.makeSerializedKeyPairFrom=_,l.makeSerializedKeyPair=f,l.serializePubKey=g,l.serializeIdentity=h,l.toSerializedKeyPair=y,l.makePreKeys=C,l.deserializePreKey=b,l.castToPreKeyId=v,l.castToSignedPreKeyId=S,l.castToSerializedPubKey=R,l.makeRawSenderKey=L,l.ecdh=E}),98);
__d("WAParsableWapNode",["WABinary","WAJids","WALogger","WALongInt","WAParsableXmlNode","WASignalKeys","WATimeUtils","WAWap","WAWapJid","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(function(e){function t(t,n){var r;return r=e.call(this,"XmppParsingFailure: "+t+": "+n)||this,r.name="XmppParsingFailure",r.parser=t,r.reason=n,r}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.toString=function(){return"XmppParsingFailure: "+this.parser+": "+this.reason},t})(babelHelpers.wrapNativeSuper(Error)),c=(function(t){function n(e,n){return t.call(this,e,n)||this}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.assertFromServer=function(){var e=this.attrString("from");e!==o("WAJids").WA_SERVER_JID_SUFFIX&&this.throw('to have "from"="s.whatsapp.net", but instead has "'+e+'"')},a.attrUserJid=function(t){var e=this.attrString(t),n=o("WAJids").interpretAndValidateJid(e);return n.botJid!=null?n.botJid:n.userJid==null?this.throw('to have "'+t+'"={UserJid}, but instead has "'+e+'"'):n.userJid},a.attrPhoneUserJid=function(t){var e=this.attrString(t),n=o("WAJids").interpretAndValidateJid(e);return n.jidType==="phoneUser"?n.userJid:this.throw('to have "'+t+'"={PhoneUserJid}, but instead has "'+e+'"')},a.attrLidUserJid=function(t){var e=this.attrString(t),n=o("WAJids").interpretAndValidateJid(e);return n.jidType==="lidUser"?n.userJid:this.throw('to have "'+t+'"={LidUserJid}, but instead has "'+e+'"')},a.maybeAttrUserJid=function(t){return this.hasAttr(t)?this.attrUserJid(t):null},a.maybeAttrPhoneUserJid=function(t){return this.hasAttr(t)?this.attrPhoneUserJid(t):null},a.maybeAttrLidUserJid=function(t){return this.hasAttr(t)?this.attrLidUserJid(t):null},a.attrGroupJid=function(t){var e=this.attrString(t),n=o("WAJids").interpretAndValidateJid(e);return n.groupJid==null?this.throw('to have "'+t+'"={GroupJid}, but instead has "'+e+'"'):n.groupJid},a.maybeAttrGroupJid=function(t){return this.hasAttr(t)?this.attrGroupJid(t):null},a.attrChatJid=function(t){var e=this.attrString(t),n=o("WAJids").interpretAndValidateJid(e);return n.userJid!=null?n.userJid:n.groupJid!=null?n.groupJid:n.botJid!=null?n.botJid:this.throw('to have "'+t+'"={ChatJid}, but instead has "'+e+'"')},a.attrPhoneChatJid=function(t){var e=this.attrString(t),n=o("WAJids").interpretAndValidateJid(e);return n.jidType==="phoneUser"?n.userJid:n.jidType==="group"?n.groupJid:this.throw('to have "'+t+'"={ChatJid}, but instead has "'+e+'"')},a.attrDeviceJid=function(t){var e=this.attrString(t),n=o("WAJids").interpretAndValidateJid(e);return n.deviceJid!=null?n.deviceJid:n.userJid!=null?o("WAJids").defaultDeviceJidForUser(n.userJid):n.hostedDeviceJid!=null?n.hostedDeviceJid:n.hostedLidDeviceJid!=null?n.hostedLidDeviceJid:n.botJid!=null?n.botJid:this.throw('to have "'+t+'"={DeviceJid}, but instead has "'+e+'"')},a.attrPhoneDeviceJid=function(t){var e=this.attrString(t),n=o("WAJids").interpretAndValidateJid(e);return n.jidType==="phoneDevice"?n.deviceJid:n.jidType==="phoneUser"?o("WAJids").defaultPhoneDeviceJidForUser(n.userJid):this.throw('to have "'+t+'"={PhoneDeviceJid}, but instead has "'+e+'"')},a.attrLidDeviceJid=function(t){var e=this.attrString(t),n=o("WAJids").interpretAndValidateJid(e);return n.jidType==="lidDevice"?n.deviceJid:n.jidType==="lidUser"?o("WAJids").defaultLidDeviceJidForLidUserJid(n.userJid):this.throw('to have "'+t+'"={LidDeviceJid}, but instead has "'+e+'"')},a.attrDeviceId=function(t){var e=this.attrInt(t);return o("WAJids").interpretAsDeviceId(e)},a.attrFromJidChat=function(){var t=this.attrJidWithType();switch(t.jidType){case"msgrUser":{var n=t.userJid,a=o("WAJids").defaultDeviceJidForUser(n);return{type:"device",chat:n,deviceJid:a,author:a}}case"interopUser":{var i=t.userJid,l=o("WAJids").defaultDeviceJidForUser(i);return{type:"device",chat:i,deviceJid:l,author:l}}case"phoneUser":{var s=t.userJid,u=o("WAJids").defaultDeviceJidForUser(s);return{type:"device",chat:s,deviceJid:u,author:u}}case"lidUser":{var c=t.userJid,d=o("WAJids").defaultLidDeviceJidForLidUserJid(c);return{type:"device",chat:c,deviceJid:d,author:d}}case"phoneDevice":{var m=t.deviceJid;return{type:"device",chat:o("WAJids").extractUserJid(m),deviceJid:m,author:m}}case"msgrDevice":{var p=t.deviceJid;return{type:"device",chat:o("WAJids").extractUserJid(p),deviceJid:p,author:p}}case"interopDevice":{var _=t.deviceJid;return{type:"device",chat:o("WAJids").extractUserJid(_),deviceJid:_,author:_}}case"lidDevice":{var f=t.deviceJid;return{type:"device",chat:o("WAJids").extractUserJid(f),deviceJid:f,author:f}}case"group":{var g=this.hasAttr("participant")?this.attrDeviceJid("participant"):null;return g==null?this.throw("expected to have participant JID for group"):{type:"group",chat:t.groupJid,groupJid:t.groupJid,author:g}}case"broadcast":{var h=this.hasAttr("participant")?this.attrDeviceJid("participant"):null;return h==null?this.throw("expected to have participant JID for group"):{type:"broadcast",broadcastJid:t.broadcastJid,chat:o("WAJids").extractUserJid(h),author:h}}case"hosted":{var y=t.hostedDeviceJid;return{type:"device",chat:o("WAJids").extractUserJid(y),deviceJid:y,author:y}}case"hostedLid":{var C=t.hostedLidDeviceJid;return{type:"device",chat:o("WAJids").extractUserJid(C),deviceJid:C,author:C}}case"call":throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["ParsableWapNode: attrFromJid() is called with ",""])),t.callJid),r("err")("ParsableWapNode: attrFromJid() does not support CallJid");default:return t.jidType,this.throw("attrFromJidChat should not be used with jid of type "+t.jidType)}},a.attrFromJidPhoneChat=function(){var e=this.attrJidWithType();switch(e.jidType){case"phoneUser":{var t=e.userJid,n=o("WAJids").defaultPhoneDeviceJidForUser(t);return{type:"device",chat:t,deviceJid:n,author:n}}case"phoneDevice":{var a=e.deviceJid;return{type:"device",chat:o("WAJids").extractPhoneUserJid(a),deviceJid:a,author:a}}case"group":{var i=this.hasAttr("participant")?this.attrPhoneDeviceJid("participant"):null;return i==null?this.throw("expected to have participant JID for group"):{type:"group",chat:e.groupJid,groupJid:e.groupJid,author:i}}case"broadcast":{var l=this.hasAttr("participant")?this.attrPhoneDeviceJid("participant"):null;return l==null?this.throw("expected to have participant JID for group"):{type:"broadcast",broadcastJid:e.broadcastJid,chat:o("WAJids").extractPhoneUserJid(l),author:l}}case"call":throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["ParsableWapNode: attrFromJid() is called with ",""])),e.callJid),r("err")("ParsableWapNode: attrFromJid() does not support CallJid");default:return e.jidType,this.throw("attrFromJidChat should not be used with jid of type "+e.jidType)}},a.attrFromPhoneJid=function(){var e=this.attrJidWithType();if(e.jidType==="status"){var t=this.hasAttr("participant")?this.attrPhoneDeviceJid("participant"):null;return t==null?this.throw("to have participant for status msg"):{type:"status",author:t}}else return this.attrFromJidPhoneChat()},a.attrFromJid=function(){var e=this.attrJidWithType();if(e.jidType==="status"){var t=this.hasAttr("participant")?this.attrPhoneDeviceJid("participant"):null;return t==null?this.throw("to have participant for status msg"):{type:"status",author:t}}return e.jidType==="newsletter"?{type:"newsletter",newsletterJid:e.newsletterJid}:e.jidType==="hosted"?{type:"hosted",hostedDeviceJid:e.hostedDeviceJid}:e.jidType==="hostedLid"?{type:"hostedLid",hostedLidDeviceJid:e.hostedLidDeviceJid}:this.attrFromJidChat()},a.attrJidWithType=function(t){t===void 0&&(t="from");var e=this.attrString(t),n=o("WAJids").interpretAndValidateJid(e);return n.jidType==="unknown"?this.throw('to have "'+t+'"={Jid}, but instead has "'+e+'"'):n},a.attrWapJid=function(t){t===void 0&&(t="from");var e=this.attrString(t),n=o("WAJids").interpretAndValidateJid(e);return n.jidType==="unknown"?o("WAWapJid").WapJid.create(null,e):o("WAWap").JID(o("WAJids").extractFromJid(n))},a.attrLongInt=function(t){var e=this.attrString(t);return o("WALongInt").decimalStringToLongInt(e)},a.attrTime=function(t){return o("WATimeUtils").castToUnixTime(this.attrInt(t))},a.maybeAttrTime=function(t){return this.hasAttr(t)?this.attrTime(t):null},a.attrFutureTime=function(t){var e=this.attrInt(t);return o("WATimeUtils").futureUnixTime(e)},a.contentString=function(){if(this.hasChildren())return this.throw("to have string content, but has children instead");if(this.hasContent()){var e=new(o("WABinary")).Binary(this.contentBytes());return e.readString(e.size())}else return this.throw("to have content")},a.decodeAsString=function(t){return o("WAWap").decodeAsString(t)},a.contentSerializedPubKey=function(){return this.hasContent()?o("WASignalKeys").serializeIdentity(this.contentBytes()):this.throw("to have content")},a.createParseError=function(t){return new u(this.name(),"expected <"+this.tag()+"> "+t)},a.throw=function(t){throw this.createParseError(t)},n})(o("WAParsableXmlNode").ParsableXmlNode);l.XmppParsingFailure=u,l.ParsableWapNode=c}),98);
__d("WADeprecatedWapParser",["WAParsableWapNode","err"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e,t){this.$1=e,this.$2=t}var t=e.prototype;return t.parse=function(t){var e=new(o("WAParsableWapNode")).ParsableWapNode(this.$1,t);try{return{success:this.$2(e)}}catch(e){if(e instanceof o("WAParsableWapNode").XmppParsingFailure)return{error:e};throw e}},t.parseOrThrow=function(t){var e=this.parse(t);if(e.error)throw r("err")(String(e.error));return e.success},e})();l.default=e}),98);
__d("WAAckParser",["WADeprecatedWapParser","WAJids"],(function(t,n,r,o,a,i,l){"use strict";var e=new(r("WADeprecatedWapParser"))("ack",function(e){return e.assertTag("ack"),{id:e.attrString("id"),ts:e.maybeAttrString("t"),class:e.attrString("class"),type:e.maybeAttrString("type"),from:e.attrJidWithType(),participant:e.hasAttr("participant")?e.attrDeviceJid("participant"):null,recipient:e.hasAttr("recipient")?e.attrUserJid("recipient"):null}});function s(e,t){return e.id===t.id&&(t.class===void 0||e.class===t.class)&&(t.type===void 0||e.type===t.type)&&(t.from===void 0||u(e.from,t.from))&&(t.participant===void 0||e.participant===t.participant)&&(t.recipient===void 0||e.recipient===t.recipient)&&(t.ts===void 0||e.ts===t.ts)}function u(e,t){if(o("WAJids").extractFromJid(e)===t)return!0;if(e.userJid!=null)return o("WAJids").defaultDeviceJidForUser(e.userJid)===t;if(e.deviceJid!=null){var n=e.deviceJid;return o("WAJids").extractDeviceId(n)===0&&o("WAJids").extractUserJid(n)===t}return!1}l.AckParser=e,l.ackMatchesTemplate=s,l.fromJidsAreEqual=u}),98);
__d("WAParseIqResponse",["WAWap"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){var r=e.content;if(r&&Array.isArray(r)&&r[0]){var a=r[0];if(a.tag==="error"){var i=a.attrs||{},l;n&&(typeof n=="function"?l=n(e):l=n.parseOrThrow(a));var u=l;return{success:!1,errorCode:parseInt(i.code,10),errorText:o("WAWap").decodeAsString(i.text)||"",errorType:o("WAWap").decodeAsString(i.type)||"",errorBackoff:parseInt(i.backoff,10),toString:s,customError:u}}}return typeof t=="function"?{success:!0,result:t(e)}:{success:!0,result:t.parseOrThrow(e)}}function s(){return"IqError "+this.errorCode+": "+this.errorText}l.parseIqResponse=e}),98);
__d("WADeprecatedSendIq",["Promise","WAAckParser","WAArrayUtils","WAComms","WALogger","WAParseIqResponse"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(e,t){return o("WAComms")._sendIq(e,!1).then(function(e){return o("WAParseIqResponse").parseIqResponse(e,t)})}function c(e,t,n){return o("WAComms")._sendIq(e,!1).then(function(e){return o("WAParseIqResponse").parseIqResponse(e,t,n)})}function d(e,t,n){return o("WAComms")._sendIq(e,!1,n).then(function(e){return o("WAParseIqResponse").parseIqResponse(e,t)})}function m(e,t){return o("WAComms")._sendIq(e,!0).then(function(e){return o("WAParseIqResponse").parseIqResponse(e,t)})}function p(e,t){return _(e,t).then(function(){})}function _(t,r){return new(s||(s=n("Promise")))(function(a){var i=o("WAComms").singletonOrThrowIfUninitialized("deprecatedSendStanzaAndReturnAck"),l=function(t){var e=o("WAAckParser").AckParser.parse(t);return!e.error&&o("WAAckParser").ackMatchesTemplate(e.success,r)?t:null},u={type:"ack",parseAndTest:l,resolve:a,stanza:t,attachedToSocketId:o("WAComms").DEFAULT_SOCKET_ID,orderedId:o("WAComms").getAndIncrementNextOrderedId()};if(i.ackHandlers.push(u),!i.socket){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Comms has no open socket, will send stanza when socket opens"])));return}i.callStanza(t).catch(function(e){var t=i.ackHandlers.indexOf(u);t!==-1&&(o("WAArrayUtils").removeIndexWithoutPreservingOrder(i.ackHandlers,t),u.resolve((s||(s=n("Promise"))).reject(e)))})})}function f(e,t){o("WAComms").castSmaxStanza(e,t)}l.deprecatedSendIq=u,l.deprecatedSendIqErrorParser=c,l.deprecatedSendIqIfConnectedWithin=d,l.deprecatedSendIqWithoutRetry=m,l.deprecatedSendStanzaAndWaitForAck=p,l.deprecatedSendStanzaAndReturnAck=_,l.deprecatedCastStanza=f}),98);
__d("WAMediaConnParser",["WADeprecatedWapParser","WAServerMediaType"],(function(t,n,r,o,a,i,l){"use strict";var e=new(r("WADeprecatedWapParser"))("mediaConnParser",function(e){var t,n,r=e.child("media_conn"),o=c(r);return{hosts:o,authToken:r.attrString("auth"),authTokenExpiryTs:r.attrFutureTime("auth_ttl"),routesExpiryTs:r.attrFutureTime("ttl"),maxBuckets:r.attrInt("max_buckets"),maxManualRetry:(t=r.maybeAttrInt("max_manual_retry",0,4))!=null?t:3,maxAutoDownloadRetry:(n=r.maybeAttrInt("max_auto_download_retry",0,4))!=null?n:3}});function s(e){var t,n;if(e.hasAttr("fallback_hostname"))return{domain:e.attrString("fallback_hostname"),class:e.maybeAttrString("fallback_class"),ip4:(t=e.maybeAttrString("fallback_ip4"))!=null?t:void 0,ip6:(n=e.maybeAttrString("fallback_ip6"))!=null?n:void 0}}function u(e){var t,n,r,o;return{domain:e.attrString("hostname"),fallback:s(e),uploadable:d(e,"upload"),downloadable:d(e,"download"),isFallback:e.maybeAttrString("type")==="fallback",downloadBuckets:(t=(n=e.maybeChild("download_buckets"))==null?void 0:n.mapChildren(function(e){return parseInt(e.tag(),10)}))!=null?t:[],class:e.maybeAttrString("class"),ip4:(r=e.maybeAttrString("ip4"))!=null?r:void 0,ip6:(o=e.maybeAttrString("ip6"))!=null?o:void 0}}function c(e){return e.mapChildrenWithTag("host",u)}function d(e,t){return e.hasChild(t)?e.child(t).mapChildren(function(e){var t=e.tag();return o("WAServerMediaType").castToServerMediaType(t)}).filter(Boolean):o("WAServerMediaType").SERVER_MEDIA}l.mediaConnParser=e}),98);
__d("WAGatherMediaInfo",["WADeprecatedSendIq","WAErrors","WALogger","WAMediaConnParser","WAPromiseManagement","WAPromiseRetryLoop","WAResultOrError","WAWap"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m=507,p=o("WAPromiseManagement").cacheWhilePending(function(){return"gatherMediaInfo"},_);function _(){var e=new(o("WAPromiseRetryLoop")).PromiseRetryLoop({name:"gatherMediaInfo",timer:{jitter:.25,max:987e3,algo:{type:"fibonacci",first:6e3,second:12e3},relativeDelay:!0},code:g});return e.start(),e.promise()}var f=60;function g(t){var n,r=(n=o("WAWap")).wap("iq",{id:n.generateId(),to:n.S_WHATSAPP_NET,type:"set",xmlns:"w:m"},n.wap("media_conn",null));return o("WADeprecatedSendIq").deprecatedSendIqIfConnectedWithin(r,o("WAMediaConnParser").mediaConnParser,f).then(function(n){if(n.success)o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["gatherMediaInfo got "," hosts"])),n.result.hosts.length),t(o("WAResultOrError").makeResult(n.result));else if(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["gatherMediaInfo failure ",""])),n),n.errorCode===m){var r=n.errorBackoff;o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["gatherMediaInfo got "," seconds backoff"])),r),t(o("WAResultOrError").makeError({type:"backoff",backoffMs:r*1e3}))}else n.errorCode<500&&(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["gatherMediaInfo got client error: ",""])),n.errorCode),t(o("WAResultOrError").makeError({type:"client-error",code:n.errorCode,text:n.errorText})))}).catch(function(e){e instanceof o("WAErrors").Disconnected?t(o("WAResultOrError").makeError("disconnected")):o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["gatherMediaInfo error ",""])),e)})}l.gatherMediaInfo=p}),98);
__d("WAMediaRouteSelection",["WATimeUtils"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=null,n=null,r=null,a=e.hosts,i=e.mediaType,l=e.operation;if(e.operation==="download"){var s,u=e.catHotTimespan,c=e.getVcaEnabledBucket,d=e.ncHot,m=new Map;a.forEach(function(e){e.downloadBuckets.forEach(function(t){m.set(t,e)})});var p=m.get(0);u>0&&d!=null&&o("WATimeUtils").happenedWithin(o("WATimeUtils").castToUnixTime(d),u)?t=1:c&&(t=c());var _=null;t!=null&&(_=m.get(t)),(s=_)!=null&&s.downloadable.includes(i)?n=_:p!=null&&p.downloadable.includes(i)&&(n=p)}for(var f=0;f<a.length;f++){var g=a[f];if((l==="upload"&&g.uploadable.includes(i)||l==="download"&&g.downloadable.includes(i))&&(n==null?n=g:g.isFallback&&r==null&&(r=g)),n!=null&&r!=null)break}return{selectedHost:n,fallbackHost:r,bucket:t}}l.mediaRouteSelection=e}),98);
__d("WAGetMediaRoute",["$InternalEnum","WACreateGetVcaEnabledBucket","WAExtractNcHotTimestamp","WAGatherMediaInfo","WAMediaRouteSelection","WAPromiseManagement","WAResultOrError","WATagsLogger","WATimeUtils","WAWaitForComms","WAWorkerGlobalScope"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f=o("WATagsLogger").TAGS(["GetMediaRoute"]),g=86400,h=n("$InternalEnum")({Fresh:"fresh",Cached:"cached",Stale:"stale"}),y=null,C=!1,b=null;async function v(t,n){n==null||n.addPoint("get_cached_or_fresh_media_access_start");var r=await E();if(n==null||n.addPoint("get_cached_or_fresh_media_access_end"),!r.success)return f.ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Failed to get mediaAccess: ",""])),r.error),n==null||n.addPoint("get_media_access_failed",{string:{mediaAccessStatus:r.error}}),r;n==null||n.addAnnotations({string:{mediaAccessStatus:r.value.state}});var a=r.value.mediaAccess,i=a.authToken,l=a.hosts,u=a.maxBuckets,c=t.operation==="upload"?o("WAMediaRouteSelection").mediaRouteSelection({operation:"upload",mediaType:t.serverMediaType,hosts:l}):o("WAMediaRouteSelection").mediaRouteSelection({operation:"download",mediaType:t.serverMediaType,hosts:l,catHotTimespan:g,ncHot:o("WAExtractNcHotTimestamp").extractNcHotTimestamp(t.directPath),getVcaEnabledBucket:o("WACreateGetVcaEnabledBucket").msgrCreateGetVcaEnabledBucket(t.directPath,u)}),d=c.bucket,m=c.fallbackHost,p=c.selectedHost;return p==null?(f.ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Error: no media host"]))),o("WAResultOrError").makeError("no-host")):o("WAResultOrError").makeResult({authToken:i,selectedHost:p,fallbackHost:m,bucket:d})}function S(){var e=b;e!=null&&(o("WAWorkerGlobalScope").workerGlobalScope.clearTimeout(e),b=null)}function R(e){S();var t=Math.max(e.authTokenExpiryTs-o("WATimeUtils").unixTime(),0);if(!(t<=300)){var n=o("WATimeUtils").pastUnixTime(300,e.authTokenExpiryTs),r=o("WATimeUtils").pastUnixTime(Math.floor(t*.2),e.authTokenExpiryTs),a=n<r?n:r,i=o("WATimeUtils").cappedMillisecondsUntil(a),l=Math.floor(Math.random()*o("WATimeUtils").MINUTE_MILLISECONDS),s=o("WAWorkerGlobalScope").workerGlobalScope.setTimeout(function(){f.LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["AuthTTL approaching expiry, refreshing MediaAccess routes"]))),L().catch(function(e){f.ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Error occurred during authTTL automatic refresh: ",""])),e)})},i+l);b=s}}var L=o("WAPromiseManagement").cacheWhilePending(function(){return"all"},async function(){if(C)return f.LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["mediaAccess has gone, but we are still locked by backoff"]))),o("WAResultOrError").makeError("backoff");await o("WAWaitForComms").waitForComms(),f.LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["mediaAccess has gone, gather a new one"]))),S();var e=await o("WAGatherMediaInfo").gatherMediaInfo();if(e.success)return y=e.value,R(e.value),o("WAResultOrError").makeResult({mediaAccess:e.value,state:h.Fresh});var t=e.error,n=t==="disconnected"?"disconnected":t.type;return f.WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Can not get mediaAccess: ",""])),n),t==="disconnected"||t.type==="client-error"?o("WAResultOrError").makeError("disconnected"):(t.type,C=!0,o("WAWorkerGlobalScope").workerGlobalScope.setTimeout(function(){C=!1,L().catch(function(e){f.ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Error occurred on gather after backoff expiry: ",""])),e)})},t.backoffMs),o("WAResultOrError").makeError("backoff"))}),E=function(){var e=y;if(e==null)return L();if(o("WATimeUtils").isInFuture(e.routesExpiryTs))return Promise.resolve(o("WAResultOrError").makeResult({mediaAccess:e,state:h.Cached}));var t=L();return o("WATimeUtils").isInFuture(e.authTokenExpiryTs)?Promise.resolve(o("WAResultOrError").makeResult({mediaAccess:e,state:h.Stale})):t};function k(){y=null,C=!1,S()}l.getMediaRoute=v,l.getCachedOrFreshMediaAccess=E,l.clearCachedMediaAccessForTest=k}),98);
__d("WAMediaOperationsRetrier",["WALogger","WAPromiseBackoffs"],(function(t,n,r,o,a,i,l){"use strict";var e,s=4,u={algo:{type:"constant",delay:1e3},jitter:0},c=(function(){function t(e,t,n){this.$1=e,this.routesInfo=t,this.$2=o("WAPromiseBackoffs").createPromiseTimer(u),this.$3=0,this.$4=!1,this.$5=n}var n=t.prototype;return n.run=async function(n,r){for(;this.$3<s;){await this.$2();var t=void 0;if(this.$3>0){var a;t=this.$3>=s-2&&!this.$4,o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["MediaOperationsRetrier:"," wait for internet, attempt = ",""])),this.$1,this.$3),await((a=this.$5)==null?void 0:a.call(this))}else t=!1;var i=this.routesInfo;if(!i)return null;var l=i.host;t&&i.fallbackHost&&(l=i.fallbackHost);var u=await n(l,i.authToken,this.$3,r);if(u.success)return u.value;++this.$3,this.$4=u.error.progressMade}return null},t})();l.MAX_ATTEMPTS=s,l.BACKOFF_OPTIONS=u,l.MediaOperationsRetrier=c}),98);
__d("WACreateMediaDownloadRetrier",["WAComms","WAGetMediaRoute","WAMediaOperationsRetrier","WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";async function e(e){var t=e.directPath,n=e.eventFlow,r=e.fileEncSha256,a=e.mediaTypeDetails,i=a.type==="regular"?a.mediaType:"preview";n==null||n.addPoint("get_media_route_start");var l=await o("WAGetMediaRoute").getMediaRoute({operation:"download",serverMediaType:i,fileEncSha256:r,directPath:t},n);if(!l.success)return n==null||n.addPoint("get_media_route_fail"),l;n==null||n.addPoint("get_media_route_end");var s=l.value,u=s.authToken,c=s.fallbackHost,d=s.selectedHost,m=new(o("WAMediaOperationsRetrier")).MediaOperationsRetrier("download",{host:{domain:d.domain,class:d.class},fallbackHost:c&&{domain:c.domain,class:c.class},authToken:u,timeElapsed:null},o("WAComms").waitForConnection);return o("WAResultOrError").makeResult({retrier:m,mediaRouteDetails:l.value})}l.createMediaDownloadRetrier=e}),98);
__d("WAHttpDownloadMedia",["WAErrorMessage","WALogger","WAMediaQplHelper","WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d="URL signature expired";async function m(t,n){var r=n!=null?n:{},a=r.abortSignal,i=r.mediaMetrics;i==null||i.addPoint("http_fetch_start");var l=await self.fetch(t,{method:"GET",mode:"cors",cache:"no-store",signal:a}).then(function(e){return i==null||i.addPoint("http_fetch_end"),o("WAResultOrError").makeResult(e)}).catch(function(t){var n=o("WAErrorMessage").maybeGetMessageFromError(t);return i==null||i.addPoint("http_fetch_fail",{string:{httpFetchError:n}}),o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["HttpDownloadMedia: fail to initiate fetch: ",", message: ",""])),t,n),t.name==="AbortError"?o("WAResultOrError").makeError("http-fetch-aborted"):o("WAResultOrError").makeError("http-fetch-exception")});if(l.success===!1)return l;var m=l.value,p=m.headers.get("content-length"),_=m.status;switch(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Fetch Media HTTP status ",""])),_),i==null||i.addAnnotations({string:{ciphertextMediaSizeBucket:p!=null?o("WAMediaQplHelper").convertIntegerSizeToStringBucket(Number(p)):null},int:{httpStatus:_}}),_){case 200:case 206:return o("WAResultOrError").makeResult(m);case 401:return o("WAResultOrError").makeError("access-expired");case 403:return m.text().then(function(e){return e===d?o("WAResultOrError").makeError("signature-expired"):o("WAResultOrError").makeError("access-expired")}).catch(function(e){return o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["HttpDownloadMedia: fail to parse request body: ",""])),e),o("WAResultOrError").makeError("access-expired")});case 404:case 410:return o("WAResultOrError").makeError("media-not-found");case 408:return o("WAResultOrError").makeError("server-timeout");case 416:return o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Download Media Error: can not resume from offset"]))),o("WAResultOrError").makeError("request-error");case 429:case 507:return o("WAResultOrError").makeError("download-throttled");default:return _>=400&&_<500?o("WAResultOrError").makeError("request-error"):o("WAResultOrError").makeError("unspecified-http-error")}}l.httpDownloadMedia=m}),98);
__d("WAHttpUtils",["err"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){if(!/^https:\/\/[-\w.]+\.\w+$/.test(e))throw r("err")('buildUrl given invalid host "'+e+'"');if(!t.startsWith("/"))throw r("err")('buildUrl given invalid path "'+t+'"');var o=n,a=""+e+t;if(!o)return a;var i=Object.keys(o).map(function(e){var t=o[e];t instanceof ArrayBuffer&&(t=new Uint8Array(t));var n=t instanceof Uint8Array?Array.from(t).map(function(e){return"%"+e.toString(16)}).join(""):encodeURIComponent(t.toString());return encodeURIComponent(e)+"="+n});if(i.length>0){var l=i.join("&");return a.includes("?")?a+"&"+l:a+"?"+l}else return a}l.buildUrl=e}),98);
__d("WAMediaUrl",["WABase64","WAGlobals","WAHttpUtils"],(function(t,n,r,o,a,i,l){"use strict";var e=1;function s(t,n,r,a,i,l,s){var u=o("WAGlobals").getDependencies().mediaUploadRoot(),c=o("WABase64").encodeB64UrlSafe(r),d=o("WABase64").encodeB64UrlSafe(n),m={auth:i,token:d};return l&&(m.resume=e),s!=null&&s>0&&(m.bytestart=s),o("WAHttpUtils").buildUrl("https://"+a,u+"/"+t+"/"+c,m)}function u(e,t,n,r,a,i,l){var s=o("WABase64").encodeB64UrlSafe(t),u={hash:s,mode:r};return a!=null&&(u._nc_cat=a),i!=null&&i>=0&&(u.bytestart=i),l!=null&&l>0&&(u.byteend=l),o("WAHttpUtils").buildUrl("https://"+n,e,u)}l.RESUME_PARAM=e,l.buildUploadUrl=s,l.buildDownloadUrl=u}),98);
__d("WADownloadCiphertext",["WAAssertUnreachable","WABase64","WACreateMediaDownloadRetrier","WACryptoSha256","WACryptoUtils","WAHashUtils","WAHttpDownloadMedia","WALogger","WAMediaUrl","WAPromiseManagement","WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m;async function p(t){var n=t.abortSignal,a=t.directPath,i=t.eventFlow,l=t.fileEncSha256,p=t.fromBytes,_=t.mediaTypeDetails,g=t.plaintextHash,h=t.toBytes;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Start download ciphertext for hash: ",""])),o("WAHashUtils").sanitisePlaintextHash(g)),i.addPoint("create_retrier_start");var y=await o("WACreateMediaDownloadRetrier").createMediaDownloadRetrier({mediaTypeDetails:_,directPath:a,eventFlow:i,fileEncSha256:l});if(!y.success)return i.addPoint("create_retrier_fail"),y;i.addPoint("create_retrier_end");var C=y.value,b=C.mediaRouteDetails,v=C.retrier,S=await v.run(function(e,t,r){var d=e.domain,m="http_download_media_"+r,_=o("WAMediaUrl").buildDownloadUrl(a,l,d,"manual",b.bucket,p,h);return i.addPoint(m+"_start"),o("WAHttpDownloadMedia").httpDownloadMedia(_,{mediaMetrics:i,abortSignal:n,cachePolicy:r>0?"no-store":"force-cache"}).then(function(e){if(e.success)return e.value.arrayBuffer().then(function(e){return i.addPoint(m+"_end"),o("WAResultOrError").makeResult(o("WAResultOrError").makeResult(e))}).catch(function(e){return i.addPoint("response_array_buffer_error"),i.addPoint(m+"_fail"),o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["HttpDownloadMedia: fail to parse request body ",""])),e),o("WAResultOrError").makeResult(o("WAResultOrError").makeError("body-network-error"))});i.addPoint(m+"_fail");var t=e.error;switch(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Download Media Error: ",""])),t),i.addPoint(t),t){case"signature-expired":return o("WAResultOrError").makeResult(o("WAResultOrError").makeError("signature-expired"));case"http-fetch-aborted":return o("WAResultOrError").makeResult(o("WAResultOrError").makeError("http-fetch-aborted"));case"http-fetch-exception":case"server-timeout":case"unspecified-http-error":return o("WAResultOrError").makeError({progressMade:!0});default:return o("WAResultOrError").makeResult(o("WAResultOrError").makeError(t))}}).catch(function(e){return i.addPoint(m+"_fail"),o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["downloadCiphertext http download exception: ",""])),e),o("WAResultOrError").makeError({progressMade:!1})})});if(S==null)return o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["downloadMedia given up"]))),o("WAResultOrError").makeError("max-attempts-exceeded");if(S.success===!1){var R=S.error;switch(o("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Download Plaintext failed: ",""])),R),R){case"signature-expired":case"http-fetch-aborted":case"media-not-found":case"download-throttled":case"body-network-error":case"request-error":return o("WAResultOrError").makeError(R);case"access-expired":return o("WAResultOrError").makeError("disconnected");default:throw r("WAAssertUnreachable")(R)}}else{var L=S.value;return!f(p,h)&&!o("WACryptoUtils").arrayBuffersEqual(await o("WACryptoSha256").sha256(L),l)?o("WAResultOrError").makeError("ciphertext-hash-mismatch"):(i.addPoint("download_finish",{int:{byteLength:L.byteLength},bool:{isPartialDownload:f(p,h)}}),o("WAResultOrError").makeResult(L))}}var _=o("WAPromiseManagement").cacheWhilePending(function(e){var t=e.fileEncSha256,n=e.fromBytes,r=e.toBytes;return o("WABase64").encodeB64UrlSafe(t)+"-"+(n!=null?n:"X")+"-"+(r!=null?r:"X")},p);function f(e,t){return e!=null&&e>0?!0:t!=null}l.cachedDownloadCiphertext=_}),98);
__d("WADownloadAndDecryptMedia",["WADecryptMedia","WADownloadCiphertext","WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";async function e(e){var t=e.abortSignal,n=e.directPath,r=e.eventFlow,a=e.fileEncSha256,i=e.mediaKey,l=e.mediaTypeDetails,s=e.plaintextHash,u=await o("WADownloadCiphertext").cachedDownloadCiphertext({abortSignal:t,mediaTypeDetails:l,fileEncSha256:a,directPath:n,eventFlow:r,plaintextHash:s});if(u.success!==!0)return u;var c=await o("WADecryptMedia").decryptMedia({mediaKey:i,mediaTypeDetails:l,plaintextHash:s,ciphertextHmac:u.value});return c.success!==!0?c:(c.value.alternativeHmacSaltUsed!=null&&r.addAnnotations({string:{alternativeHmacSaltUsed:c.value.alternativeHmacSaltUsed}}),o("WAResultOrError").makeResult(c.value.plaintext))}l.downloadAndDecryptMedia=e}),98);
__d("WACreateMediaDecrypterStream",["WABinary","WAMediaCrypto","WAResultOrError","WATagsLogger","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_=o("WATagsLogger").TAGS(["WADecryptStream"]);function f(t,n,r,a,i){if(a.byteLength===0)return _.ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["expectedHmacs must have at least one element"]))),o("WAResultOrError").makeError("missing-expected-hmacs");if(a.byteLength!==i.length*o("WAMediaCrypto").HMAC_LENGTH)return _.ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["expectedHmacs and ciphertextLengths must have the same length"]))),o("WAResultOrError").makeError("hmac-chiphertext-array-mismatch");var l=g(a),m=n,p=new(o("WABinary")).Binary,f=0,y=async function(n,a){for(p.writeByteArray(n);f<l.length&&p.size()>=i[f];f++){var e=p.readByteArrayView(i[f]);_.DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Processing scan "," of size ",""])),f,e.length);var s=f===i.length-1;try{var d=await o("WAMediaCrypto").hmacAndDecryptPartial(t,m,e,r,l[f]),g=d.nextIv,y=d.plaintext;s?a.enqueue(h(y)):a.enqueue(y),m=g}catch(e){_.ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Unable to decrypt chunk. isLastChunk: "," error: ",""])),s,e),e instanceof o("WAMediaCrypto").HmacValidationError?a.error("enc-hash-mismatch"):a.error("decryption-error")}}},C=new TransformStream({transform:function(t,n){var e=t;return y(e,n)},flush:function(t){p.size()>0&&_.ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Unexpected ciphertext in buffer following flush"])))}});return o("WAResultOrError").makeResult(C)}function g(e){var t=[];if(e.byteLength%o("WAMediaCrypto").HMAC_LENGTH!==0)throw r("err")("Sidecar length is not a multiple of hmac length");for(var n=0;n<e.byteLength;n+=o("WAMediaCrypto").HMAC_LENGTH){var a=new Uint8Array(e,n,o("WAMediaCrypto").HMAC_LENGTH);t.push(a)}return t}function h(e){if(e.length<o("WAMediaCrypto").CBC_BLOCK_SIZE)return _.ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Plaintext size is less than CBC_BLOCK_SIZE"]))),e;var t=e[e.length-1];return t===0||t>o("WAMediaCrypto").CBC_BLOCK_SIZE?(_.ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Invalid PKCS padding length"]))),e):e.subarray(0,-t)}l.createDefaultDecryptStream=f}),98);
__d("WAMediaProgressiveJpegTransformStream",["WABinary"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.scanLengths,n=[],r=0;for(var a of t)r+=a,n.push(r);var i=new(o("WABinary")).Binary,l=0,s=0,u=new TransformStream({transform:function(r,o){var e=r;for(s+=e.byteLength,i.writeByteArray(e);l<t.length&&n[l]<s;l++){var a=i.readByteArrayView(t[l]);o.enqueue(a)}},flush:function(t){t.enqueue(i.readByteArrayView())}});return u}l.makeProgressiveJpegHandlerTransformStream=e}),98);
__d("WADownloadProgressiveJpegPlaintextStreamerWithoutRetry",["WACreateMediaDecrypterStream","WAHttpDownloadMedia","WAMediaCrypto","WAMediaProgressiveJpegTransformStream","WAProgressiveJpegGetPJpegDetails","WAResultOrError","WATagsLogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=o("WATagsLogger").TAGS(["WADownloadProgressiveJpegPlaintextStreamer"]);function c(e){return e}async function d(t){var n=t.abortSignal,r=t.cachePolicy,a=t.downloadUrl,i=t.eventFlow,l=t.mediaKey,c=t.progressiveJpegDetails,d=t.serverMediaType,m=await o("WAHttpDownloadMedia").httpDownloadMedia(a,{mediaMetrics:i,abortSignal:n,cachePolicy:r});if(m.success!==!0)return m;var p=m.value.body;if(p==null)return o("WAResultOrError").makeError("body-network-error");var _=m.value.headers.get("Content-Length");if(_==null)return u.ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Content-Length header is missing"]))),o("WAResultOrError").makeError("missing-content-length-header");var f=Number(_);if(Number.isNaN(f))return u.ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Content-Length header is not a number"]))),o("WAResultOrError").makeError("invalid-content-length-header");var g=o("WAProgressiveJpegGetPJpegDetails").getExtendedProgressiveJpegDetails({progressiveJpegDetails:c,ciphertextLength:f}),h=await o("WAMediaCrypto").computeMediaKeys(l,d),y=o("WACreateMediaDecrypterStream").createDefaultDecryptStream(h.cipherKey,h.iv,h.hmacKey,g.sidecar,g.alignedScanLengths);if(y.success!==!0)return y;var C=y.value,b=o("WAMediaProgressiveJpegTransformStream").makeProgressiveJpegHandlerTransformStream(g),v=p.pipeThrough(C).pipeThrough(b);return o("WAResultOrError").makeResult(v)}l.unsafeCastToDownloadAndDecryptPJpegStream=c,l.downloadProgressiveJpegPlaintextUsingStreamsWithoutRetry=d}),98);
__d("WADownloadProgressiveJpegPlaintextStreamer",["WAAssertUnreachable","WACreateMediaDownloadRetrier","WADownloadProgressiveJpegPlaintextStreamerWithoutRetry","WAMediaUrl","WAResultOrError","WATagsLogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s=o("WATagsLogger").TAGS(["WADownloadProgressiveJpegPlaintextStreamer"]);async function u(t){var n=t.abortSignal,a=t.directPath,i=t.eventFlow,l=t.fileEncSha256,u=t.mediaKey,c=t.progressiveJpegDetails,d=t.serverMediaType,m=await o("WACreateMediaDownloadRetrier").createMediaDownloadRetrier({directPath:a,eventFlow:i,fileEncSha256:l,mediaTypeDetails:{type:"regular",mediaType:d}});if(!m.success)return m;var p=m.value,_=p.mediaRouteDetails,f=p.retrier,g=_.bucket,h=await f.run(async function(e,t,s){var m=e.domain,p=o("WAMediaUrl").buildDownloadUrl(a,l,m,"manual",g),_=await o("WADownloadProgressiveJpegPlaintextStreamerWithoutRetry").downloadProgressiveJpegPlaintextUsingStreamsWithoutRetry({abortSignal:n,downloadUrl:p,eventFlow:i,mediaKey:u,progressiveJpegDetails:c,serverMediaType:d,cachePolicy:s>0?"no-store":"force-cache"});if(_.success===!0)return o("WAResultOrError").makeResult(_);var f=_.error;switch(f){case"http-fetch-exception":case"server-timeout":case"unspecified-http-error":case"invalid-content-length-header":case"missing-content-length-header":return o("WAResultOrError").makeError({progressMade:!0});case"access-expired":return o("WAResultOrError").makeResult(o("WAResultOrError").makeError("disconnected"));case"body-network-error":return o("WAResultOrError").makeResult(o("WAResultOrError").makeError("request-error"));case"media-not-found":case"request-error":case"download-throttled":case"signature-expired":case"http-fetch-aborted":return o("WAResultOrError").makeResult(o("WAResultOrError").makeError(f));case"missing-expected-hmacs":case"hmac-chiphertext-array-mismatch":return o("WAResultOrError").makeResult(o("WAResultOrError").makeError(f));default:throw r("WAAssertUnreachable")(f)}});return h==null?(s.WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Download with stream given up"]))),o("WAResultOrError").makeError("max-attempts-exceeded")):h}l.downloadProgressiveJpegPlaintextUsingStreams=u}),98);
__d("WAPrepareMediaDownload",["Promise","WAErrorMessage","WAGetAgeBucketForMediaKeyTimestamp","WAHashUtils","WAMediaQplHelper","WAProgressiveJpegGetPJpegDetails","WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=typeof((e=navigator.storage)==null?void 0:e.getDirectory)=="function",m=typeof self.caches=="object",p=0;function _(e){var t,r=e.hash,a=e.logger,i=e.mediaDownloadFlow,l=e.mediaEntry,_=l.directPath,f=l.downloadableThumbnail,g=l.mediaKeyTimestamp,h=l.serverMediaType,y=l.size,C=o("WAGetAgeBucketForMediaKeyTimestamp").getAgeBucketForMediaKeyTimestamp(g);a.LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["start download ",". mediaKeyTimestampAgeBucket: ",", size: ",", serverMediaType: ",""])),o("WAHashUtils").sanitisePlaintextHash(r),C,y,h);var b=(t=o("WAProgressiveJpegGetPJpegDetails").maybeGetProgressiveJpegDetailsUsingMediaEntry(l).value)!=null?t:null;return i.addPoint("wa_protocol_media_download_start",{string:{mediaType:h,mediaKeyTimestampAgeBucket:C,sanitisedMediaHash:o("WAHashUtils").sanitisePlaintextHash(r)},bool:{isOPFSSupported:d,isWebCacheSupported:m,duplicateDirectPath:(f==null?void 0:f.directPath)===_,hasDownloadableThumbnail:(f==null?void 0:f.directPath)!=null,isProgressiveJpeg:b!=null}}),{logDownloadResult:function(t){return p++,i.addAnnotations({int:{concurrentDownloadCount:p}}),t.then(function(e){if(e.success){var t=e.value.plaintext.byteLength;i.addPoint("wa_protocol_media_download_end",{string:{media_size:o("WAMediaQplHelper").convertIntegerSizeToStringBucket(t)}})}else i.addPoint("wa_protocol_media_download_fail",{string:{wa_protocol_media_download_fail_reason:e.error}});return e}).catch(function(e){i.addPoint("wa_protocol_media_download_fail",{string:{wa_protocol_media_download_fail_reason:"runtime-error"}});var t=o("WAErrorMessage").maybeGetMessageFromError(e);return a.ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media due to runtime-error: ",""])),t),(c||(c=n("Promise"))).resolve(o("WAResultOrError").makeError("runtime-error"))}).finally(function(){p--})}}}l.prepareMediaDownload=_}),98);
__d("WAProgressiveJpegAddJPEGTrailingTag",["WATypedArraysConcat"],(function(t,n,r,o,a,i,l){"use strict";var e=new Uint8Array([255,217]);function s(t){return o("WATypedArraysConcat").concatTypedArrays(Uint8Array,[new Uint8Array(t),e]).buffer}l.JPEG_TRAILING_TAG=e,l.addJPEGTrailingTag=s}),98);
__d("WAStreamAsyncIterator",[],(function(t,n,r,o,a,i){"use strict";function e(e){return l.apply(this,arguments)}function l(){return l=babelHelpers.wrapAsyncGenerator(function*(e){var t=e.getReader();try{for(;;){var n=yield babelHelpers.awaitAsyncGenerator(t.read()),r=n.done,o=n.value;if(r)return;yield o}}finally{t.releaseLock()}}),l.apply(this,arguments)}i.streamAsyncIterator=e}),66);
__d("WADownloadMedia",["WAByteArray","WACryptoSha256","WACryptoUtils","WADownloadAndDecryptMedia","WADownloadDownloadablePreview","WADownloadProgressiveJpegPlaintextStreamer","WADownloadProgressiveJpegPreview","WAErrorMessage","WAHashUtils","WAMediaCrypto","WAMediaUtils","WAPrepareMediaDownload","WAProgressiveJpegAddJPEGTrailingTag","WAProgressiveJpegGetPJpegDetails","WAPromiseManagement","WAResultOrError","WAStreamAsyncIterator","WATagsLogger","WATypedArraysConcat"],(function(t,n,r,o,a,i,l){"use strict";var e=["hash"],s,u,c,d,m,p,_,f,g,h,y,C,b,v,S=o("WATagsLogger").TAGS(["MediaDownload"]);function R(e){var t=e.downloadMediaMetric,n=e.handleMediaPreviewBeforeDownload,r=e.handleMediaPreviewDownload,a=e.handleMediaPreviewDownloadFailed,i=e.hash,l=e.mediaEntry,s=e.protocolMsgId,u=o("WAPrepareMediaDownload").prepareMediaDownload({mediaDownloadFlow:t,mediaEntry:l,hash:i,logger:S}),c=u.logDownloadResult;return c(E({downloadMediaMetric:t,hash:i,mediaEntry:l,protocolMsgId:s,handleMediaPreviewDownload:r,handleMediaPreviewBeforeDownload:n,handleMediaPreviewDownloadFailed:a}))}var L=async function(t){var e=t.downloadMediaMetric,n=t.handleMediaPreviewBeforeDownload,r=t.handleMediaPreviewDownload,a=t.handleMediaPreviewDownloadFailed,i=t.hash,l=t.mediaEntry,p=t.protocolMsgId,_=o("WAMediaUtils").validateDecodedMediaEntryForDownload(l);if(!_.success)return S.ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["mediaEntry is incomplete. ",""])),_.error),_;var f=_.value,g=f.directPath,h=f.fileEncSha256,y=f.fileSha256,C=f.mediaKey,b=f.serverMediaType,v=o("WAProgressiveJpegGetPJpegDetails").maybeGetProgressiveJpegDetailsUsingMediaEntry(l);v.success===!1&&(S.WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Failed to get ProgressiveJpeg details: ",""])),v.error),e.addPoint(v.error));var R=v.success===!0?v.value:null,L=function(t){if(t==null)return Promise.resolve();var e=o("WAMediaCrypto").convertServerMediaTypeToPreviewMediaType(b);return e==null?(S.ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["media: mediaPreview - unsupported preview media type ",""])),b),Promise.resolve()):r(i,t,e,p).then(function(){})};if(R!=null&&o("WAMediaUtils").isTransformStreamSupported()&&b==="image"){var E=await x({directPath:g,downloadFlow:e,fileEncSha256:h,handleMediaPreviewBlob:L,hash:i,mediaKey:C,progressiveJpegDetails:R,serverMediaType:b,fileSha256:y,handleMediaPreviewBeforeDownload:n,handleMediaPreviewDownloadFailed:a});if(E.success)return o("WAResultOrError").makeResult({mimeType:o("WAMediaUtils").getMimeTypeFromServerMediaType(b),plaintext:E.value,serverMediaType:b});var I=E.error;switch(S.WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Media Streaming failed to download progressive jpeg. Reason: ",". PlaintextHash: ",""])),I,o("WAHashUtils").sanitisePlaintextHash(i)),I){case"signature-expired":case"request-error":return S.LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Skipping fallback for ",". PlaintextHash: ",""])),I,o("WAHashUtils").sanitisePlaintextHash(i)),o("WAResultOrError").makeError(I)}}e==null||e.addPoint("fallback_to_non_streaming_download");var T=D({hash:i,mediaEntry:l,progressiveJpegDetails:R,protocolMsgId:p,serverMediaType:b,handleMediaPreviewBeforeDownload:n,handleMediaPreviewDownloadFailed:a,downloadEntry:e.downloadEntry,triggerUIView:e.triggerUIView});return T.then(function(e){return e.success===!1?L(null):L(e.value)}),k({downloadMediaMetric:e,mediaEntry:_.value})},E=o("WAPromiseManagement").cacheWhilePending(function(e){var t=e.hash;return t},L),k=async function(t){var e=t.abortSignal,n=t.downloadMediaMetric,r=t.mediaEntry,a=r.directPath,i=r.fileEncSha256,l=r.fileSha256,s=r.mediaKey,u=r.serverMediaType,c=await T({abortSignal:e,downloadFlow:n,mediaTypeDetails:{mediaType:u,type:"regular"},directPath:a,fileEncSha256:i,fileSha256:l,mediaKey:s});return c.success?o("WAResultOrError").makeResult({mimeType:o("WAMediaUtils").getMimeTypeFromServerMediaType(u),plaintext:c.value,serverMediaType:u}):c},I=o("WAPromiseManagement").cacheWhilePending(function(e){var t=e.hash;return t},function(t){var n=t.hash,r=babelHelpers.objectWithoutPropertiesLoose(t,e),a=o("WAPrepareMediaDownload").prepareMediaDownload({hash:n,mediaDownloadFlow:r.downloadMediaMetric,mediaEntry:r.mediaEntry,logger:S}),i=a.logDownloadResult;return i(k(r))});async function T(e){var t=e.abortSignal,n=e.directPath,r=e.downloadFlow,a=e.fileEncSha256,i=e.fileSha256,l=e.mediaKey,s=e.mediaTypeDetails,u=o("WAHashUtils").toPlaintextHash(i),c=await o("WADownloadAndDecryptMedia").downloadAndDecryptMedia({abortSignal:t,directPath:n,eventFlow:r,fileEncSha256:a,mediaKey:l,mediaTypeDetails:s,plaintextHash:u});if(c.success===!1){var d=c.error;switch(d){case"signature-expired":case"media-not-found":return o("WAResultOrError").makeError(d);case"enc-hash-mismatch":return S.ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["downloadMedia: enc-hash-mismatch"]))),o("WAResultOrError").makeError(d);default:return o("WAResultOrError").makeError(d)}}else{var m=c.value;return o("WAResultOrError").makeResult(m)}}function D(e){var t=e.downloadEntry,n=e.handleMediaPreviewBeforeDownload,r=e.handleMediaPreviewDownloadFailed,a=e.hash,i=e.mediaEntry,l=e.progressiveJpegDetails,s=e.protocolMsgId,u=e.serverMediaType,c=e.triggerUIView;return l==null?o("WADownloadDownloadablePreview").maybeDownloadDownloadablePreview(s,a,u,i,t,{handleMediaPreviewBeforeDownload:n,handleMediaPreviewDownloadFailed:r},c):o("WADownloadProgressiveJpegPreview").maybeDownloadProgressiveJpegPreview({protocolMsgId:s,hash:a,serverMediaType:u,mediaEntry:i,progressiveJpegDetails:l,handleMediaPreviewBeforeDownload:n,handleMediaPreviewDownloadFailed:r,downloadEntry:t,triggerUIView:c}).then(function(e){return e.success!==!0?o("WADownloadDownloadablePreview").maybeDownloadDownloadablePreview(s,a,u,i,t,{handleMediaPreviewBeforeDownload:n,handleMediaPreviewDownloadFailed:r},c):e})}async function x(e){var t=e.directPath,n=e.downloadFlow,r=e.fileEncSha256,a=e.fileSha256,i=e.handleMediaPreviewBeforeDownload,l=e.handleMediaPreviewBlob,s=e.handleMediaPreviewDownloadFailed,u=e.hash,c=e.mediaKey,d=e.progressiveJpegDetails,m=e.serverMediaType,p=S.TAGS(["MediaStreaming"]);p.LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Using Media Streaming to download ProgressiveJpeg. PlaintextHash: ",""])),o("WAHashUtils").sanitisePlaintextHash(u)),n.addPoint("media_streaming_start");var R=o("WADownloadProgressiveJpegPreview").getPreviewTargetScan(d.scanLengths)-1;p.LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["Targeting scanIndex "," for preview. PlaintextHash: ",""])),R,o("WAHashUtils").sanitisePlaintextHash(u)),n.addAnnotations({int:{scans:d.scanLengths.length}}),i(u);var L=await o("WADownloadProgressiveJpegPlaintextStreamer").downloadProgressiveJpegPlaintextUsingStreams({directPath:t,eventFlow:n,fileEncSha256:r,mediaKey:c,progressiveJpegDetails:d,serverMediaType:m});if(L.success===!1)return n.addPoint("media_streaming_fail",{string:{wa_media_download_streaming_fail_reason:L.error}}),s(u,L.error),L;n.addPoint("download_pjpeg_preview_start");var E=[],k=0;try{var I=!1,T=!1,D;try{for(var x=babelHelpers.asyncIterator(o("WAStreamAsyncIterator").streamAsyncIterator(L.value)),$;I=!($=await x.next()).done;I=!1){var P=$.value;{if(P==null)continue;if(p.LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["Processing scan "," for plaintextHash ",""])),k,o("WAHashUtils").sanitisePlaintextHash(u)),E.push(P),k===R){n.addPoint("media_streaming_preview_processed"),p.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Handling preview from scan "," for plaintextHash ",""])),k,o("WAHashUtils").sanitisePlaintextHash(u));var N=o("WAByteArray").uint8ArrayToBuffer(o("WATypedArraysConcat").concatTypedArrays(Uint8Array,[].concat(E,[o("WAProgressiveJpegAddJPEGTrailingTag").JPEG_TRAILING_TAG])));l(N),n.addPoint("download_pjpeg_preview_end")}k++}}}catch(e){T=!0,D=e}finally{try{I&&x.return!=null&&await x.return()}finally{if(T)throw D}}k<R&&(p.ERROR(y||(y=babelHelpers.taggedTemplateLiteralLoose(["pjpeg stream ended before reaching previewTargetScanIndex for plaintextHash ",""])),o("WAHashUtils").sanitisePlaintextHash(u)),n.addPoint("download_pjpeg_preview_fail"));var M=o("WAByteArray").uint8ArrayToBuffer(o("WATypedArraysConcat").concatTypedArrays(Uint8Array,[].concat(E))),w=await o("WACryptoSha256").sha256(M);return o("WACryptoUtils").arrayBuffersEqual(a,w)?(p.LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["Media streaming for ProgressiveJpeg download successful. PlaintextHash: ",""])),o("WAHashUtils").sanitisePlaintextHash(u)),n.addPoint("media_streaming_end"),o("WAResultOrError").makeResult(M)):(p.WARN(C||(C=babelHelpers.taggedTemplateLiteralLoose(["Media streaming for ProgressiveJpeg download failed due to plaintext hash mismatch. PlaintextHash: ",""])),o("WAHashUtils").sanitisePlaintextHash(u)),n.addPoint("media_streaming_fail",{string:{wa_media_download_streaming_fail_reason:"hash-mismatch"}}),o("WAResultOrError").makeError("hash-mismatch"))}catch(e){return p.ERROR(v||(v=babelHelpers.taggedTemplateLiteralLoose(["Exception occurred during Media Streaming: Reason: ",""])),e),k<R&&(n.addPoint("download_pjpeg_preview_fail"),s(u,o("WAErrorMessage").maybeGetMessageFromError(e))),n==null||n.addPoint("media_streaming_fail",{string:{wa_media_download_streaming_fail_reason:o("WAErrorMessage").maybeGetMessageFromError(e)}}),o("WAResultOrError").makeError("stream-error")}}l.mediaDownloadLogger=S,l.downloadMedia=R,l.downloadFullMediaOnly=k,l.cachedDownloadFullMediaOnly=I,l.downloadMediaImpl=T}),98);
__d("WADownloadProgressiveJpegPlaintext",["WADownloadCiphertext","WAMediaCrypto","WAProgressiveJpegAddJPEGTrailingTag","WAProgressiveJpegGetPJpegDetails","WAResultOrError","WATagsLogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=o("WATagsLogger").TAGS(["DownloadProgressiveJpeg"]);async function d(e){var t=e.abortSignal,n=e.directPath,r=e.eventFlow,a=e.fileEncSha256,i=e.mediaKey,l=e.mediaTypeDetails,s=e.plaintextHash,u=e.progressiveJpegDetails,c=e.size,d=e.targetScan,_=o("WAProgressiveJpegGetPJpegDetails").getExtendedProgressiveJpegDetails({progressiveJpegDetails:u,ciphertextLength:p(c)}),f=o("WAProgressiveJpegGetPJpegDetails").getTotalByteSizeForScan(_.alignedScanLengths,d),g=await o("WADownloadCiphertext").cachedDownloadCiphertext({abortSignal:t,mediaTypeDetails:l,fileEncSha256:a,directPath:n,fromBytes:0,toBytes:f-1,eventFlow:r,plaintextHash:s});return g.success!==!0?g:m(i,l,d,_,g.value)}async function m(t,n,r,a,i){c.LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Using progressiveJpeg decryptAndVerify"])));var l=new Uint8Array(i),d;n.type==="preview"?d=o("WAMediaCrypto").computeMediaKeysForPreview(t):d=o("WAMediaCrypto").computeMediaKeys(t,n.mediaType);var m=await d.then(function(e){var t=e.cipherKey,n=e.hmacKey,i=e.iv;return o("WAMediaCrypto").decryptPartialChunks(t,i,l,n,r,a)}).then(o("WAResultOrError").makeResult).catch(function(e){return c.ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Download Plaintext Error ",""])),e),e instanceof o("WAMediaCrypto").HmacValidationError?o("WAResultOrError").makeError("enc-hash-mismatch"):o("WAResultOrError").makeError("decryption-error")});if(!m.success)return m;c.LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["ProgressiveJpeg download and decrypt successful. Partial: ",""])),r<a.scanLengths.length);var p=o("WAProgressiveJpegAddJPEGTrailingTag").addJPEGTrailingTag(m.value.plaintext);return o("WAResultOrError").makeResult(p)}function p(e){if(e==null)return null;var t=o("WAMediaCrypto").CBC_BLOCK_SIZE-e%o("WAMediaCrypto").CBC_BLOCK_SIZE;return e+t+o("WAMediaCrypto").HMAC_LENGTH}l.downloadProgressiveJpegPlaintext=d}),98);
__d("WALoggerTag",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["CryptoManager","MediaPreview","PrekeyGenerateAndUpload","SignedPrekey","SignedPrekeyRotation","OneTimePrekey"]),l=e;i.default=l}),66);
__d("WAProgressiveJpegGetTargetScanLengthForBytes",[],(function(t,n,r,o,a,i){"use strict";function e(e,t){for(var n=0,r=0,o=0;o<e.length&&(r=o+1,n+=e[o],!(n>=t));o++);return r}i.getTargetScanBasedOnByteSize=e}),66);
__d("WADownloadProgressiveJpegPreview",["WADownloadMedia","WADownloadProgressiveJpegPlaintext","WAGlobals","WALoggerTag","WAProgressiveJpegGetTargetScanLengthForBytes","WAResultOrError","WAStartMediaDownloadQplFlow"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=o("WADownloadMedia").mediaDownloadLogger.TAGS([r("WALoggerTag").MediaPreview]),c=3;async function d(t){var n=t.downloadEntry,r=t.handleMediaPreviewBeforeDownload,a=t.handleMediaPreviewDownloadFailed,i=t.hash,l=t.mediaEntry,c=t.progressiveJpegDetails,d=t.protocolMsgId,p=t.serverMediaType,_=t.triggerUIView,f=l.directPath,g=l.fileEncSha256,h=l.mediaKey,y=l.size;if(f==null||g==null||h==null)return o("WAResultOrError").makeError("pjpeg-failed");var C=o("WAStartMediaDownloadQplFlow").startMediaDownloadQplFlow({protocolMsgId:d,downloadEntry:n,isPreview:!0,msgType:null,triggerUIView:_});C.addAnnotations({bool:{isProgressiveJpeg:!0},string:{mediaType:"preview",fullSizeMediaType:l.serverMediaType},int:{mediaEntrySize:l.size}}),u.LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Starting progressiveJpeg preview download"]))),C.addPoint("wa_protocol_media_download_start");var b=o("WAGlobals").getConfig().pjpegPreviewAvoidLastScan()===!0?c.scanLengths.length-1:c.scanLengths.length,v=Math.min(m(c.scanLengths,y),b);await r(i);var S=await o("WADownloadProgressiveJpegPlaintext").downloadProgressiveJpegPlaintext({directPath:f,eventFlow:C,fileEncSha256:g,mediaKey:h,mediaTypeDetails:{mediaType:p,type:"regular"},progressiveJpegDetails:c,plaintextHash:i,targetScan:v,size:y});if(!S.success)return a(i,S.error),C.endFail("wa_protocol_media_download_fail",{string:{wa_protocol_media_download_fail_reason:S.error}}),o("WAResultOrError").makeError("pjpeg-failed");var R=S.value;return u.LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Finished progressiveJpeg preview download"]))),C.addPoint("wa_protocol_media_download_end"),C.endSuccess(),o("WAResultOrError").makeResult(R)}function m(e,t){var n=o("WAGlobals").getConfig().jpegThumbnailTargetByteSizeKB()*1024,r=o("WAProgressiveJpegGetTargetScanLengthForBytes").getTargetScanBasedOnByteSize(e,n);return(t==null||t===0)&&(r=Math.min(r,e.length-1)),r=Math.max(r,c),r}function p(e){var t=e.abortSignal,n=e.hash,r=e.mediaDownloadFlow,a=e.mediaEntry,i=e.progressiveJpegDetails,l=e.serverMediaType,s=a.directPath,u=a.fileEncSha256,c=a.mediaKey,d=a.size,p=o("WAGlobals").getConfig().pjpegPreviewAvoidLastScan()===!0?i.scanLengths.length-1:i.scanLengths.length,_=Math.min(m(i.scanLengths,d),p);return o("WADownloadProgressiveJpegPlaintext").downloadProgressiveJpegPlaintext({abortSignal:t,directPath:s,fileEncSha256:u,mediaKey:c,mediaTypeDetails:{mediaType:l,type:"regular"},progressiveJpegDetails:i,plaintextHash:n,targetScan:_,size:d,eventFlow:r})}l.maybeDownloadProgressiveJpegPreview=d,l.getPreviewTargetScan=m,l.maybeDownloadProgressiveJpegPreviewV2=p}),98);
__d("WAFindMostRecentMediaEntry",["WAMediaUtils","WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=null;for(var n of e){var r,a,i=n[0],l=n[1],s=o("WAMediaUtils").decodeMediaEntryData(l);(((r=t)==null?void 0:r[1].mediaKeyTimestamp)==null||s.mediaKeyTimestamp!=null&&s.mediaKeyTimestamp>((a=t)==null?void 0:a[1].mediaKeyTimestamp))&&(t=[i,s])}return t!=null?o("WAResultOrError").makeResult(t):o("WAResultOrError").makeError("no-media-entry")}l.findMostRecentMediaEntry=e}),98);
__d("WAGetKaleidoscopeWasm",["WAWasmModuleCache","bx"],(function(t,n,r,o,a,i,l){"use strict";var e=r("bx").getURL(r("bx")("33861")),s=function(){return o("WAWasmModuleCache").loadWasmModule(e)};l.getKaleidoscopeWasm=s}),98);
__d("WAMediaUtilsWasmUrl",["bx"],(function(t,n,r,o,a,i,l){"use strict";var e=r("bx").getURL(r("bx")("237"));l.WAMediaUtilsWasmUrl=e}),98);
__d("WAPreloadWamediaUtilsWasm",["WAMediaUtilsWasmUrl","WAWasmModuleCache"],(function(t,n,r,o,a,i,l){"use strict";var e=function(){o("WAWasmModuleCache").loadWasmModule(o("WAMediaUtilsWasmUrl").WAMediaUtilsWasmUrl)};l.preloadWamediaUtilsWasm=e}),98);
__d("WAPreloadWebpCheckWasm",["WAWasmModuleCache","bx"],(function(t,n,r,o,a,i,l){"use strict";var e=r("bx").getURL(r("bx")("6946")),s=function(){o("WAWasmModuleCache").loadWasmModule(e)};l.preloadWebpCheckWasm=s}),98);
__d("WAPrewarmMediaValidate",["WAGetKaleidoscopeWasm","WALogger","WAPreloadWamediaUtilsWasm","WAPreloadWebpCheckWasm","getErrorSafe","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t){if(r("gkx")("3272")){o("WAGetKaleidoscopeWasm").getKaleidoscopeWasm().catch(function(t){var n=r("getErrorSafe")(t);o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["prewarm Kaleidoscop wasm failed with error: ",""])),n.message)});return}if(t==null){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["prewarmMediaValidate: serverMediaType is null"])));return}(t==="sticker"||t==="image")&&o("WAPreloadWebpCheckWasm").preloadWebpCheckWasm(),(t==="video"||t==="audio")&&o("WAPreloadWamediaUtilsWasm").preloadWamediaUtilsWasm()}l.prewarmMediaValidate=u}),98);
__d("WAMediaManagerPrepareMediaDownload",["Promise","WAErrorMessage","WAGetAgeBucketForMediaKeyTimestamp","WAHashUtils","WAMediaQplHelper","WAPrewarmMediaValidate","WAProgressiveJpegGetPJpegDetails","WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=0;function d(t){var r,a=t.hash,i=t.logger,l=t.mediaDownloadFlow,d=t.mediaEntry,m=d.directPath,p=d.downloadableThumbnail,_=d.mediaKeyTimestamp,f=d.serverMediaType,g=d.size;o("WAPrewarmMediaValidate").prewarmMediaValidate(f);var h=o("WAGetAgeBucketForMediaKeyTimestamp").getAgeBucketForMediaKeyTimestamp(_);i.LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["start download ",". entry: "," mediaKeyTimestampAgeBucket: ",", size: ",", serverMediaType: ",""])),o("WAHashUtils").sanitisePlaintextHash(a),l.downloadEntry,h,g,f);var y=(r=o("WAProgressiveJpegGetPJpegDetails").maybeGetProgressiveJpegDetailsUsingMediaEntry(d).value)!=null?r:null;return l.addPoint("wa_protocol_media_download_start",{bool:{duplicateDirectPath:(p==null?void 0:p.directPath)===m,hasDownloadableThumbnail:(p==null?void 0:p.directPath)!=null,isProgressiveJpeg:y!=null},string:{mediaKeyTimestampAgeBucket:h,mediaType:f}}),{logDownloadResult:function(t){return c++,l.addAnnotations({int:{concurrentDownloadCount:c}}),t.then(function(e){if(e.success){var t=e.value.validatedResult.validatedPlaintext.byteLength;l.addPoint("wa_protocol_media_download_end",{string:{media_size:o("WAMediaQplHelper").convertIntegerSizeToStringBucket(t)}})}else l.addPoint("wa_protocol_media_download_fail",{string:{wa_protocol_media_download_fail_reason:e.error}});return e}).catch(function(e){l.addPoint("wa_protocol_media_download_fail",{string:{wa_protocol_media_download_fail_reason:"runtime-error"}});var t=o("WAErrorMessage").maybeGetMessageFromError(e);return i.ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media due to runtime-error: ",""])),t),(u||(u=n("Promise"))).resolve(o("WAResultOrError").makeError("runtime-error"))}).finally(function(){c--})}}}l.mediaManagerPrepareMediaDownload=d}),98);
__d("WAIsMp4",[],(function(t,n,r,o,a,i){"use strict";function e(e){return e.length<8?!1:e[4]===102&&e[5]===116&&e[6]===121&&e[7]===112}i.isMp4=e}),66);
__d("WAIsWebP",[],(function(t,n,r,o,a,i){"use strict";function e(e){return!(e.length<12||e[0]!==82||e[1]!==73||e[2]!==70||e[3]!==70||e[8]!==87||e[9]!==69||e[10]!==66||e[11]!==80)}i.isWebP=e}),66);
__d("WAKaleidoscopeLogger",["FBLogger"],(function(t,n,r,o,a,i,l){"use strict";var e=function(){return r("FBLogger")("wmi").tags(["Kaleidoscope"])};l.ksLogger=e}),98);
__d("WAKaleidoscopeCheck",["WAGetKaleidoscopeWasm","WAKaleidoscopeLogger","WAResultOrError","WASI","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_="input",f="output",g="/"+_,h="/"+f;function y(e){var t,n=e.input,r=e.mediaType,o=e.rawMimeType,a=e.stderr,i=e.stdout;return{args:["kaleidoscope","check","--json-report="+f,"--mimetype-hint="+o,_],fs:(t={},t[g]={path:g,timestamps:{access:new Date,change:new Date,modification:new Date},mode:"binary",content:new Uint8Array(n)},t[h]={path:h,timestamps:{access:new Date,change:new Date,modification:new Date},mode:"string",content:""},t),stdout:i,stderr:a,moduleName:"WAKaleidoscopeCheck_CLI"}}function C(t){var n=t.getWasmModule;return async function(a){var t,i,l,_,f=a.input,g=a.mediaType,C=a.rawMimeType,b=o("WASI").createWasi(y({input:f,rawMimeType:C,mediaType:g,stderr:function(n){o("WAKaleidoscopeLogger").ksLogger().MUSTFIX(e||(e=babelHelpers.taggedTemplateLiteralLoose(["",""])),n)},stdout:function(t){o("WAKaleidoscopeLogger").ksLogger().DEBUG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["",""])),t)}})),v=b.getImportObject,S=b.start,R=await n(),L=await WebAssembly.instantiate(R,v()),E=S(L),k=E.exitCode,I=E.fs;if(k!==0)return o("WAKaleidoscopeLogger").ksLogger().MUSTFIX(u||(u=babelHelpers.taggedTemplateLiteralLoose(["kaleidoscopeCheck failed with exit code ",""])),k),o("WAResultOrError").makeError("wasm-runtime-error");var T=(t=I[h])==null?void 0:t.content;if(typeof T!="string")return o("WAKaleidoscopeLogger").ksLogger().MUSTFIX(c||(c=babelHelpers.taggedTemplateLiteralLoose(["kaleidoscopeCheck failed invalid result type"]))),o("WAResultOrError").makeError("wasm-result-not-json");var D={};try{D=JSON.parse(T)}catch(e){return o("WAKaleidoscopeLogger").ksLogger().catching(r("getErrorSafe")(e)).MUSTFIX(d||(d=babelHelpers.taggedTemplateLiteralLoose(["kaleidoscopeCheck failed to parse JSON"]))),o("WAResultOrError").makeError("wasm-invalid-json")}return typeof((i=D)==null?void 0:i.score)!="number"?(o("WAKaleidoscopeLogger").ksLogger().MUSTFIX(m||(m=babelHelpers.taggedTemplateLiteralLoose(["kaleidoscopeCheck score is null"]))),o("WAResultOrError").makeError("wasm-invalid-json")):(o("WAKaleidoscopeLogger").ksLogger().DEBUG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["kaleidoscopeCheck called with rawMimeType: ",", mediaType: ",""])),C,g),o("WAResultOrError").makeResult({mimetype:((l=D)==null?void 0:l.mimetype)||"application/octet-stream",extension:((_=D)==null?void 0:_.extension)||null,score:D.score}))}}var b=C({getWasmModule:o("WAGetKaleidoscopeWasm").getKaleidoscopeWasm});l.kaleidoscopeCheck=b}),98);
__d("WAMp4Check",["WAMediaUtilsWasmUrl","WAResultOrError","WASI","WAWasmModuleCache"],(function(t,n,r,o,a,i,l){"use strict";var e="input",s="output",u="/"+e,c="/"+s;function d(t){var n,r=t.input,o=t.stderr,a=t.stdout;return{args:["wamediautil","mp4check","--error-tolerance=2","--json-report="+s,e],fs:(n={},n[u]={path:u,timestamps:{access:new Date,change:new Date,modification:new Date},mode:"binary",content:new Uint8Array(r)},n[c]={path:c,timestamps:{access:new Date,change:new Date,modification:new Date},mode:"string",content:""},n),stdout:a,stderr:o,moduleName:"WAMp4Check_CLI"}}function m(e){var t=e.getWasmModule,n=e.logError,r=e.logMessage;return async function(a){var e,i,l,s,u,m,p,_,f,g,h,y,C,b=a.input,v=o("WASI").createWasi(d({input:b,stderr:n,stdout:r})),S=v.getImportObject,R=v.start,L=await t(),E=await WebAssembly.instantiate(L,S()),k=R(E),I=k.exitCode,T=k.fs;if(I!==0)return n("mp4Check failed with exit code "+I),o("WAResultOrError").makeError("invalid-media");var D=(e=T[c])==null?void 0:e.content;if(typeof D!="string")return n("mp4check failed invalid result type"),o("WAResultOrError").makeError("runtime-error");var x=(i=JSON.parse(D))!=null?i:{};return o("WAResultOrError").makeResult({videoStreamReport:(x==null?void 0:x.video_stream_report)==null?null:{streamType:(l=x.video_stream_report)==null?void 0:l.stream_type,calculatedFps:(s=x.video_stream_report)==null?void 0:s.calculated_fps,nominalFps:(u=x.video_stream_report)==null?void 0:u.nominal_fps,videoWidth:(m=x.video_stream_report)==null?void 0:m.video_width,videoHeight:(p=x.video_stream_report)==null?void 0:p.video_height,duration:(_=x.video_stream_report)==null?void 0:_.duration,avgBitsPerSecond:(f=x.video_stream_report)==null?void 0:f.avg_bits_per_second},audioStreamReport:(x==null?void 0:x.audio_stream_report)==null?null:{streamType:(g=x.audio_stream_report)==null?void 0:g.stream_type,samplingRate:(h=x.audio_stream_report)==null?void 0:h.sampling_rate,numberOfChannels:(y=x.audio_stream_report)==null?void 0:y.number_of_channels,avgBitsPerSecond:(C=x.audio_stream_report)==null?void 0:C.avg_bits_per_second}})}}var p=function(){return o("WAWasmModuleCache").loadWasmModule(o("WAMediaUtilsWasmUrl").WAMediaUtilsWasmUrl)};l.createMp4Check=m,l.getMp4CheckWasm=p}),98);
__d("WAParseWav",[],(function(t,n,r,o,a,i){"use strict";function e(e){var t=new DataView(e);return e.byteLength<44||t.getUint32(0)!==1380533830||t.getUint32(8)!==1463899717?null:e}function l(e){var t=new DataView(e),n=t.getUint16(22,!0),r=t.getUint32(24,!0);return{numChannels:n,sampleRate:r}}i.validateWav=e,i.parseWav=l}),66);
__d("WAWebPCheck",["WAResultOrError","WASI","WAWasmModuleCache","bx"],(function(t,n,r,o,a,i,l){"use strict";var e="input",s="/"+e;function u(t){var n,r=t.input,o=t.stderr,a=t.stdout;return{args:["webpcheck",e],fs:(n={},n[s]={path:s,timestamps:{access:new Date,change:new Date,modification:new Date},mode:"binary",content:new Uint8Array(r)},n),stdout:a,stderr:o,moduleName:"WAWebPCheck_CLI"}}function c(e){var t=e.getWasmModule,n=e.logError,r=e.logMessage;return async function(a){var e=a.input,i=o("WASI").createWasi(u({input:e,stderr:n,stdout:r})),l=i.getImportObject,s=i.start,c=await t(),d=await WebAssembly.instantiate(c,l()),m=s(d),p=m.exitCode;return p!==0?(n("WebPCheck failed with exit code "+p),o("WAResultOrError").makeError("invalid-media")):o("WAResultOrError").makeResult()}}var d=r("bx").getURL(r("bx")("6946")),m=function(){return o("WAWasmModuleCache").loadWasmModule(d)};l.createWebPCheck=c,l.getWebpCheckWasm=m}),98);
__d("WAValidateMedia",["FBLogger","WAIsMp4","WAIsOgg","WAIsWebP","WAKaleidoscopeCheck","WAMp4Check","WAParseWav","WAResultOrError","WAWebPCheck","getErrorSafe","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=function(){return r("FBLogger")("wmi").tags(["WAValidateMedia"])};function m(t,n){return n.addPoint("media_validation_start"),(r("gkx")("3272")?p(t):_(t)).then(function(e){return e.success?n.addPoint("media_validation_end",{bool:{is_validation_setup_failed:e.value.validationSetupFailed,is_validation_skipped:e.value.skipValidation},string:{validated_mime_type:e.value.mimeType}}):n.addPoint("media_validation_fail",{string:{validationError:e.error}}),e}).catch(function(a){var i=r("getErrorSafe")(a);return d().catching(i).MUSTFIX(e||(e=babelHelpers.taggedTemplateLiteralLoose(["validateMedia threw an exception: ",""])),i.message),n.addPoint("media_validation_fail",{string:{validationError:i.message}}),o("WAResultOrError").makeResult({skipValidation:!0,mimeType:null,validatedPlaintext:t,validationSetupFailed:!0})})}async function p(e){var t=await o("WAKaleidoscopeCheck").kaleidoscopeCheck({input:e,rawMimeType:"application/octet-stream",mediaType:"unknown"});if(!t.success)return d().MUSTFIX(s||(s=babelHelpers.taggedTemplateLiteralLoose(["kaleidoscopeCheck failed with error: ",""])),t.error),o("WAResultOrError").makeError("runtime-error");var n=t.value,r=n.mimetype,a=n.score;return a>=80?o("WAResultOrError").makeError("invalid-media"):o("WAResultOrError").makeResult({skipValidation:!1,mimeType:r,validatedPlaintext:e,validationSetupFailed:!1,isKaleidoscopeCheck:!0})}function _(e){var t=new Uint8Array(e);if(o("WAIsWebP").isWebP(t))return h(e);if(o("WAIsMp4").isMp4(t))return y(e);if(o("WAIsOgg").isOgg(t))return Promise.resolve(o("WAResultOrError").makeResult({skipValidation:!1,mimeType:"audio/ogg",validatedPlaintext:e,validationSetupFailed:!1,audioStreamReport:null}));var n=o("WAParseWav").validateWav(e);return n!=null?Promise.resolve(C(n)):Promise.resolve(o("WAResultOrError").makeResult({mimeType:null,skipValidation:!0,validatedPlaintext:e,validationSetupFailed:!1}))}var f=function(t){t!==""&&d().WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["",""])),t)},g=function(t){t!==""&&d().DEBUG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["",""])),t)};async function h(e){var t=o("WAWebPCheck").createWebPCheck({getWasmModule:o("WAWebPCheck").getWebpCheckWasm,logError:f,logMessage:g}),n=await t({input:e});return n.success?o("WAResultOrError").makeResult({skipValidation:!1,mimeType:"image/webp",validatedPlaintext:e,validationSetupFailed:!1}):n}async function y(e){var t=o("WAMp4Check").createMp4Check({getWasmModule:o("WAMp4Check").getMp4CheckWasm,logError:f,logMessage:g}),n=await t({input:e});if(!n.success)return o("WAResultOrError").makeError(n.error);var r=n.value,a=r.audioStreamReport,i=r.videoStreamReport;return i==null?a==null?o("WAResultOrError").makeError("invalid-media"):o("WAResultOrError").makeResult({skipValidation:!1,mimeType:"audio/mp4",validatedPlaintext:e,validationSetupFailed:!1,audioStreamReport:a}):o("WAResultOrError").makeResult({skipValidation:!1,mimeType:"video/mp4",validatedPlaintext:e,validationSetupFailed:!1,videoStreamReport:i,audioStreamReport:a})}function C(e){var t=o("WAParseWav").parseWav(e),n=t.numChannels,r=t.sampleRate;return o("WAResultOrError").makeResult({skipValidation:!1,mimeType:"audio/wav",validatedPlaintext:e,validationSetupFailed:!1,audioStreamReport:{streamType:"LPCM",samplingRate:r,numberOfChannels:n}})}l.validateMedia=m}),98);
__d("WADownloadFullSizeOnlyTask",["EncryptedBackupsResignCdnUrl","MAWCastToMsgrServerMediaType","MAWEBSwitch","WADownloadMedia","WAFindMostRecentMediaEntry","WAIsMediaExpiredError","WAMediaManagerPrepareMediaDownload","WAMediaUtils","WAResultOrError","WAValidateMedia","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;async function c(e){var t=e.abortSignal,n=e.dbCallbacks,r=e.fullSizePlaintextHash,a=e.logger,i=e.mediaDownloadFlow;i.addPoint("get_media_entries_start");var l=await n.getMediaEntries(r);if(!l.success)return i.addPoint("get_media_entries_fail"),{fullsizePromise:Promise.resolve(o("WAResultOrError").makeError("missing-media-entry"))};var s=l.value;i.addPoint("get_media_entries_end");var u=o("WAFindMostRecentMediaEntry").findMostRecentMediaEntry(s);if(!u.success)return{fullsizePromise:Promise.resolve(o("WAResultOrError").makeError("missing-media-entry"))};var c=u.value,m=c[0],p=c[1],_=o("WAMediaUtils").validateDecodedMediaEntryForDownload(p);if(!_.success)return{fullsizePromise:Promise.resolve(_)};var f=_.value,g=o("WAMediaManagerPrepareMediaDownload").mediaManagerPrepareMediaDownload({hash:r,logger:a,mediaDownloadFlow:i,mediaEntry:f}),h=g.logDownloadResult,y=d({abortSignal:t,dbCallbacks:n,logger:a,mediaDownloadFlow:i,mediaEntries:s,msgIdOfRecentMediaEntry:m,recentMediaEntry:f}).then(async function(e){if(!e.success)return e;var t=await o("WAValidateMedia").validateMedia(e.value.plaintext,i);return t.success?o("WAResultOrError").makeResult({msgIdAndMediaEntry:[m,f],serverMediaType:e.value.serverMediaType,unvalidatedMimeType:e.value.mimeType,validatedResult:t.value}):t});return{fullsizePromise:h(y)}}async function d(t){var n=t.abortSignal,a=t.dbCallbacks,i=t.logger,l=t.mediaDownloadFlow,c=t.mediaEntries,d=t.msgIdOfRecentMediaEntry,m=t.recentMediaEntry,p=r("MAWEBSwitch").isEnabled()&&r("gkx")("23960");p&&l.addPoint("forcing_eb_download");var _=p?o("WAResultOrError").makeError("signature-expired"):await o("WADownloadMedia").downloadFullMediaOnly({abortSignal:n,downloadMediaMetric:l,mediaEntry:m});if(_.success||!o("WAIsMediaExpiredError").isMediaExpiredError(_.error)||!r("MAWEBSwitch").isEnabled())return _;var f=await a.getProtocolMsgIdAndSortOrderMs(d);if(f==null)return o("WAResultOrError").makeError("missing-sort-order-ms-for-restore");var g=f.protocolMsgId,h=f.sortOrderMs,y=m,C=d,b=o("MAWCastToMsgrServerMediaType").castToMsgrServerMediaType(y.serverMediaType);if(b==null||y.objectId==null)return i.ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media and can not restore: ",""])),_.error),_;var v=await o("EncryptedBackupsResignCdnUrl").resignCdnUrl({deliveryObjectId:y.objectId,logger:i,mediaDownloadFlow:l,mediaKey:y.mediaKey,mediaType:b,msgId:C,protocolMsgId:g,sortOrderMs:h});if(!v.success)return i.ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media and restore failed: ",""])),v.error),v;var S=await o("WADownloadMedia").downloadFullMediaOnly({abortSignal:n,downloadMediaMetric:babelHelpers.extends({},l,{addPoint:function(t,n){l.addPoint("second_"+t,n)}}),mediaEntry:babelHelpers.extends({},y,{directPath:v.value})});return S.success?o("WAResultOrError").makeResult(S.value):(i.ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media after restore CDN URL: ",""])),S.error),S)}l.startDownloadFullSizeTask=c,l.downloadOrRestoreFullSize=d}),98);
__d("WADownloadMediaPreviewV2",["WADownloadMedia","WADownloadProgressiveJpegPreview","WAMediaCrypto","WAMediaUtils","WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";var e;async function s(t){var n=t.abortSignal,r=t.hash,a=t.logger,i=t.mediaDownloadFlow,l=t.mediaEntry,s=t.progressiveJpegDetails,u=l.serverMediaType,c=o("WAMediaUtils").getMimeTypeFromServerMediaType(u),d=s==null?o("WAResultOrError").makeError("jpeg-stream-not-supported"):await o("WADownloadProgressiveJpegPreview").maybeDownloadProgressiveJpegPreviewV2({abortSignal:n,hash:r,serverMediaType:u,mediaEntry:l,progressiveJpegDetails:s,mediaDownloadFlow:i});if(d.success===!0)return o("WAResultOrError").makeResult({plaintext:d.value,mimeType:c,serverMediaType:u});i.addPoint("fallback_to_downloadable_thumbnail");var m=l.downloadableThumbnail;if((m==null?void 0:m.directPath)==null)return o("WAResultOrError").makeError("media-not-found");var p=o("WAMediaUtils").validateDownloadableThumbnailForDownload(m);if(p.success===!1)return a.ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["preview mediaEntry is incomplete: ",""])),p.error),o("WAResultOrError").makeError(p.error[0]);var _=p.value,f=_.directPath,g=_.fileEncSha256,h=_.fileSha256,y=_.mediaKey,C=o("WAMediaCrypto").convertServerMediaTypeToPreviewMediaType(u);if(C==null)return o("WAResultOrError").makeError("request-error");var b=await o("WADownloadMedia").downloadMediaImpl({abortSignal:n,downloadFlow:i,mediaTypeDetails:{messageType:C,type:"preview"},directPath:f,fileEncSha256:g,fileSha256:h,mediaKey:y});return b.success===!1?b:o("WAResultOrError").makeResult({plaintext:b.value,mimeType:c,serverMediaType:u})}l.downloadMediaPreview=s}),98);
__d("WAIsPreviewSupported",["$InternalEnum","WAProgressiveJpegGetPJpegDetails"],(function(t,n,r,o,a,i,l){"use strict";var e=n("$InternalEnum").Mirrored(["NO","YES"]),s=n("$InternalEnum").Mirrored(["NO","YES","DuplicatedWithFullSize"]);function u(t){var n=t.serverMediaType;switch(n){case"image":{var r,a,i=(r=o("WAProgressiveJpegGetPJpegDetails").maybeGetProgressiveJpegDetailsUsingMediaEntry(t).value)!=null?r:null,l=i!=null?e.YES:e.NO;if(((a=t.downloadableThumbnail)==null?void 0:a.directPath)==null)return[l,s.NO];t.downloadableThumbnail.directPath;var u=t.downloadableThumbnail.directPath===t.directPath?s.DuplicatedWithFullSize:s.YES;return[l,u]}case"video":{var c;if(((c=t.downloadableThumbnail)==null?void 0:c.directPath)==null)return[e.NO,s.NO];t.downloadableThumbnail.directPath;var d=t.downloadableThumbnail.directPath===t.directPath?s.NO:s.YES;return[e.NO,d]}case"sticker":case"ptt":case"audio":case"document":case"gif":case"ppic":case"md-app-state":case"md-msg-hist":case"kyc-id":case"template":case"thumbnail-image":case"thumbnail-video":case"thumbnail-gif":case"thumbnail-document":case"thumbnail-link":case"novi-video":case"novi-image":case"payment-bg-image":case"xma-image":case"biz-cover-photo":case"preview":case"newsletter-audio":case"newsletter-document":case"newsletter-image":case"newsletter-gif":case"newsletter-music-artwork":case"newsletter-ptt":case"newsletter-sticker":case"newsletter-sticker-pack":case"newsletter-thumbnail-link":case"newsletter-video":case"newsletter-ptv":case"sticker-pack":case"thumbnail-sticker-pack":case"music-artwork":case"group-history":case"ads-image":case"ads-video":case"ptv":return[e.NO,s.NO];default:return[e.NO,s.NO]}}l.PjpegPreviewSupport=e,l.DownloadablePreviewSupport=s,l.checkPreviewSupport=u}),98);
__d("WADownloadPreviewOnlyTask",["EncryptedBackupsResignCdnUrl","MAWEBSwitch","WADownloadMediaPreviewV2","WAFindMostRecentMediaEntry","WAIsMediaExpiredError","WAIsPreviewSupported","WAMediaManagerPrepareMediaDownload","WAMediaUtils","WAProgressiveJpegGetPJpegDetails","WAResultOrError","WAValidateMedia","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e,s;async function u(e){var t=e.abortSignal,n=e.dbCallbacks,r=e.fullSizePlaintextHash,a=e.logger,i=e.mediaDownloadFlow;i.addPoint("get_media_entries_start");var l=await n.getMediaEntries(r);if(!l.success)return i.addPoint("get_media_entries_fail"),{previewPromise:Promise.resolve(o("WAResultOrError").makeError("missing-media-entry"))};i.addPoint("get_media_entries_end");var s=l.value,u=o("WAFindMostRecentMediaEntry").findMostRecentMediaEntry(s);if(!u.success)return{previewPromise:Promise.resolve(o("WAResultOrError").makeError("missing-media-entry"))};var d=u.value,m=d[0],p=d[1],_=o("WAMediaUtils").validateDecodedMediaEntryForDownload(p);if(!_.success)return{previewPromise:Promise.resolve(_)};var f=_.value,g=o("WAMediaManagerPrepareMediaDownload").mediaManagerPrepareMediaDownload({hash:r,logger:a,mediaDownloadFlow:i,mediaEntry:f}),h=g.logDownloadResult,y=c({abortSignal:t,dbCallbacks:n,fullSizePlaintextHash:r,logger:a,mediaDownloadFlow:i,mediaEntries:l.value,msgIdOfRecentMediaEntry:m,recentMediaEntry:f}).then(async function(e){if(!e.success)return e;var t=await o("WAValidateMedia").validateMedia(e.value.plaintext,i);return t.success?o("WAResultOrError").makeResult({msgIdAndMediaEntry:[m,f],serverMediaType:e.value.serverMediaType,unvalidatedMimeType:e.value.mimeType,validatedResult:t.value}):t});return{previewPromise:h(y)}}async function c(t){var n,a=t.abortSignal,i=t.dbCallbacks,l=t.fullSizePlaintextHash,u=t.logger,c=t.mediaDownloadFlow,d=t.mediaEntries,m=t.msgIdOfRecentMediaEntry,p=t.recentMediaEntry,_=r("MAWEBSwitch").isEnabled()&&r("gkx")("23960");_&&c.addPoint("forcing_eb_download");var f=o("WAIsPreviewSupported").checkPreviewSupport(p),g=f[0],h=f[1];if(g===o("WAIsPreviewSupported").PjpegPreviewSupport.NO&&h===o("WAIsPreviewSupported").DownloadablePreviewSupport.NO)return o("WAResultOrError").makeError("preview-not-supported");var y=o("WAProgressiveJpegGetPJpegDetails").maybeGetProgressiveJpegDetailsUsingMediaEntry(p),C=y.success===!0?y.value:null,b={abortSignal:a,hash:l,logger:u,mediaDownloadFlow:c,progressiveJpegDetails:C};c.addPoint("download_preview_start",{string:{preview_downloadable_support:h,preview_pjpeg_support:g}});var v=_?o("WAResultOrError").makeError("signature-expired"):await o("WADownloadMediaPreviewV2").downloadMediaPreview(babelHelpers.extends({},b,{mediaEntry:p}));if(v.success)return c.addPoint("download_preview_end"),o("WAResultOrError").makeResult({mimeType:v.value.mimeType,plaintext:v.value.plaintext,serverMediaType:v.value.serverMediaType});if(c.addPoint("download_preview_fail"),!o("WAIsMediaExpiredError").isMediaExpiredError(v.error)||!r("MAWEBSwitch").isEnabled()||r("gkx")("1327")!==!0)return v;var S=await i.getProtocolMsgIdAndSortOrderMs(m);if(S==null)return o("WAResultOrError").makeError("missing-sort-order-ms-for-restore");var R=S.protocolMsgId,L=S.sortOrderMs,E=p,k=m,I=h===o("WAIsPreviewSupported").DownloadablePreviewSupport.NO||((n=E.downloadableThumbnail)==null?void 0:n.objectId)==null?null:o("EncryptedBackupsResignCdnUrl").resignCdnUrl({deliveryObjectId:E.downloadableThumbnail.objectId,logger:u,mediaDownloadFlow:c,mediaKey:E.mediaKey,mediaType:"preview",msgId:k,protocolMsgId:R,sortOrderMs:L}),T=g===o("WAIsPreviewSupported").PjpegPreviewSupport.NO||E.objectId==null?null:o("EncryptedBackupsResignCdnUrl").resignCdnUrl({deliveryObjectId:E.objectId,logger:u,mediaDownloadFlow:c,mediaKey:E.mediaKey,mediaType:"image",msgId:k,protocolMsgId:R,sortOrderMs:L}),D=await Promise.all([I,T]),x=D[0],$=D[1];if((x==null?void 0:x.success)!==!0&&($==null?void 0:$.success)!==!0){var P;return u.ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media and restore failed. downloadableThumbnail error: ",". pjpegPreview error: ",""])),x==null?void 0:x.error,$==null?void 0:$.error),(P=$!=null?$:x)!=null?P:o("WAResultOrError").makeError("preview-not-supported")}c.addPoint("second_download_preview_start");var N=await o("WADownloadMediaPreviewV2").downloadMediaPreview(babelHelpers.extends({},b,{mediaDownloadFlow:babelHelpers.extends({},c,{addPoint:function(t,n){c.addPoint("second_"+t,n)}}),mediaEntry:babelHelpers.extends({},E,{directPath:($==null?void 0:$.success)===!0?$.value:E.directPath,downloadableThumbnail:E.downloadableThumbnail==null?null:babelHelpers.extends({},E.downloadableThumbnail,{directPath:(x==null?void 0:x.success)===!0?x.value:E.downloadableThumbnail.directPath})})}));return N.success?(c.addPoint("second_download_preview_end"),o("WAResultOrError").makeResult({mimeType:N.value.mimeType,plaintext:N.value.plaintext,serverMediaType:N.value.serverMediaType})):(u.ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media after restore CDN URL: ",""])),N.error),c.addPoint("second_download_preview_fail"),N)}l.startDownloadPreviewTask=u,l.downloadOrRestorePreviewOnly=c}),98);
__d("WADownloadProgressiveJpegUsingMediaStreaming",["WAByteArray","WACryptoSha256","WACryptoUtils","WADownloadProgressiveJpegPlaintextStreamer","WADownloadProgressiveJpegPreview","WAErrorMessage","WAMediaUtils","WAProgressiveJpegAddJPEGTrailingTag","WAResolvable","WAResultOrError","WAStreamAsyncIterator","WATypedArraysConcat"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_;async function f(t){var n=t.abortSignal,r=t.directPath,a=t.downloadFlow,i=t.fileEncSha256,l=t.fileSha256,m=t.logger,p=t.mediaKey,_=t.progressiveJpegDetails,f=t.serverMediaType,h=m.TAGS(["MediaStreaming"]);h.LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Using Media Streaming to download ProgressiveJpeg."]))),a.addPoint("create_pjpeg_stream_start");var y=await o("WADownloadProgressiveJpegPlaintextStreamer").downloadProgressiveJpegPlaintextUsingStreams({abortSignal:n,directPath:r,eventFlow:a,fileEncSha256:i,mediaKey:p,progressiveJpegDetails:_,serverMediaType:f}).catch(function(e){return h.ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["create DownloadAndDecryptPJpegStream unexpected runtime-error: ",""])),o("WAErrorMessage").maybeGetMessageFromError(e)),o("WAResultOrError").makeError("runtime-error")});if(y.success===!1)return a.addPoint("create_pjpeg_stream_fail"),y;a.addPoint("create_pjpeg_stream_end");var C=new(o("WAResolvable")).Resolvable,b=!1,v=g({downloadFlow:a,fileSha256:l,mediaStreamingLogger:h,previewResolvable:C,progressiveJpegDetails:_,progressiveJpegDownloadStream:y.value,serverMediaType:f}).then(function(e){return b=!0,h.DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["handleProgressiveJpegDownloadStream completed"]))),e}).catch(function(e){return b=!0,h.ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["handleProgressiveJpegDownloadStream unexpected runtime-error: ",""])),o("WAErrorMessage").maybeGetMessageFromError(e)),C.reject(e),o("WAResultOrError").makeError("runtime-error")}),S=o("WAMediaUtils").getMimeTypeFromServerMediaType(f);function R(e){return e.success===!1?e:o("WAResultOrError").makeResult({mimeType:S,plaintext:e.value,serverMediaType:f})}var L=v.then(R),E=C.promise.then(R),k=await C.promise;if(k.success===!0&&b===!0&&h.ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["fullsizeResolvable is settled before previewResolvable"]))),k.success===!0)return o("WAResultOrError").makeResult({fullsizePromise:L,previewPromise:E});var I=await v;return k.success,I.success===!0?o("WAResultOrError").makeResult({fullsizePromise:L,previewPromise:E}):(I.success,I)}async function g(e){var t=e.downloadFlow,n=e.fileSha256,r=e.mediaStreamingLogger,a=e.previewResolvable,i=e.progressiveJpegDetails,l=e.progressiveJpegDownloadStream;t.addPoint("download_pjpeg_preview_start");var s=0,u=o("WADownloadProgressiveJpegPreview").getPreviewTargetScan(i.scanLengths)-1;try{var c=[],d=!1,f=!1,g;try{for(var h=babelHelpers.asyncIterator(o("WAStreamAsyncIterator").streamAsyncIterator(l)),y;d=!(y=await h.next()).done;d=!1){var C=y.value;{if(C==null)continue;if(c.push(C),s===u){t.addPoint("media_streaming_preview_processed");var b=o("WAByteArray").uint8ArrayToBuffer(o("WATypedArraysConcat").concatTypedArrays(Uint8Array,[].concat(c,[o("WAProgressiveJpegAddJPEGTrailingTag").JPEG_TRAILING_TAG])));a.resolve(o("WAResultOrError").makeResult(b)),t.addPoint("download_pjpeg_preview_end")}s++}}}catch(e){f=!0,g=e}finally{try{d&&h.return!=null&&await h.return()}finally{if(f)throw g}}a.isSettled===!1&&(r.ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["pjpeg stream ended before reaching previewTargetScanIndex"]))),a.resolve(o("WAResultOrError").makeError("runtime-error")),t.addPoint("download_pjpeg_preview_fail"));var v=o("WAByteArray").uint8ArrayToBuffer(o("WATypedArraysConcat").concatTypedArrays(Uint8Array,[].concat(c))),S=await o("WACryptoSha256").sha256(v);return o("WACryptoUtils").arrayBuffersEqual(n,S)?o("WAResultOrError").makeResult(v):(r.WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Media streaming for ProgressiveJpeg download failed due to plaintext hash mismatch."]))),o("WAResultOrError").makeError("hash-mismatch"))}catch(e){return r.ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Exception occurred during Media Streaming: Reason: ",""])),e),a.isSettled===!1&&(a.resolve(o("WAResultOrError").makeError("runtime-error")),t.addPoint("download_pjpeg_preview_fail")),o("WAResultOrError").makeError("runtime-error")}}l.downloadProgresiveJpegUsingMediaStreaming=f}),98);
__d("WADownloadFullSizeAndPreviewTask",["EncryptedBackupsResignCdnUrl","MAWCastToMsgrServerMediaType","MAWEBSwitch","UserAgent","WADownloadFullSizeOnlyTask","WADownloadPreviewOnlyTask","WADownloadProgressiveJpegUsingMediaStreaming","WAErrorMessage","WAFindMostRecentMediaEntry","WAHashUtils","WAIsMediaExpiredError","WAIsPreviewSupported","WAMediaManagerPrepareMediaDownload","WAMediaUtils","WAProgressiveJpegGetPJpegDetails","WAResultOrError","WAStartMediaDownloadQplFlow","WAValidateMedia","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g,h;async function y(t){var n=t.abortSignal,r=t.dbCallbacks,a=t.fullSizePlaintextHash,i=t.logger,l=t.mediaDownloadFlow;l.addPoint("get_media_entries_start");var c=await r.getMediaEntries(a);if(!c.success)return l.addPoint("get_media_entries_fail"),{fullsizePromise:Promise.resolve(o("WAResultOrError").makeError("missing-media-entry")),previewPromise:Promise.resolve(o("WAResultOrError").makeError("missing-media-entry"))};l.addPoint("get_media_entries_end");var d=c.value,m=o("WAFindMostRecentMediaEntry").findMostRecentMediaEntry(d);if(!m.success)return{fullsizePromise:Promise.resolve(o("WAResultOrError").makeError("missing-media-entry")),previewPromise:Promise.resolve(o("WAResultOrError").makeError("missing-media-entry"))};var p=m.value,_=p[0],f=p[1],g=o("WAMediaUtils").validateDecodedMediaEntryForDownload(f);return g.success?b({abortSignal:n,dbCallbacks:r,fullSizePlaintextHash:a,logger:i,mediaDownloadFlow:l,mediaEntries:d,msgIdOfRecentMediaEntry:_,recentMediaEntry:g.value}).then(function(e){return i.DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["outter promise: ",""])),e.success===!0?"success":e.error),e.success?e.value:(i.ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["outter promise failed: ",""])),e.error),{fullsizePromise:Promise.resolve(e),previewPromise:Promise.resolve(e)})}):(i.ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["invalid mediaEntry for download: ",""])),g.error),{fullsizePromise:Promise.resolve(g),previewPromise:Promise.resolve(g)})}async function C(e,t,n){var r=await e;if(!r.success)return Promise.resolve(r);var a=await o("WAValidateMedia").validateMedia(r.value.plaintext,n);return a.success?o("WAResultOrError").makeResult({msgIdAndMediaEntry:t,serverMediaType:r.value.serverMediaType,unvalidatedMimeType:r.value.mimeType,validatedResult:a.value}):a}async function b(e){var t=e.abortSignal,n=e.dbCallbacks,r=e.fullSizePlaintextHash,a=e.logger,i=e.mediaDownloadFlow,l=e.mediaEntries,s=e.msgIdOfRecentMediaEntry,u=e.recentMediaEntry,d=o("WAMediaManagerPrepareMediaDownload").mediaManagerPrepareMediaDownload({hash:r,logger:a,mediaDownloadFlow:i,mediaEntry:u}),m=d.logDownloadResult,p={abortSignal:t,dbCallbacks:n,logger:a,mediaDownloadFlow:i,mediaEntries:l,msgIdOfRecentMediaEntry:s,recentMediaEntry:u},_=await v(babelHelpers.extends({},p,{fullSizePlaintextHash:r}));if(_.success){var f=_.value,g=f.fullsizePromise,h=f.previewPromise,y=g.then(function(e){return e.success?e:(i.addPoint("fallback_to_non_streaming_download",{string:{streaming_fallback_reason:e.error}}),o("WADownloadFullSizeOnlyTask").downloadOrRestoreFullSize(p))}),b=[s,u];return o("WAResultOrError").makeResult({fullsizePromise:m(C(y,b,i)),previewPromise:C(h,b,i)})}var R=L(_.error);if(!R.shouldFallback)return o("WAResultOrError").makeError(R.error);i.addPoint("fallback_to_non_streaming_download",{string:{streaming_fallback_reason:R.error}}),a.LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["fallback to non-streaming download"])));var E=C(o("WADownloadFullSizeOnlyTask").downloadOrRestoreFullSize(p),[s,u],i),k=S(babelHelpers.extends({},p,{fullSizePlaintextHash:r,fullsizePromise:E}));return o("WAResultOrError").makeResult({fullsizePromise:m(E),previewPromise:k})}async function v(e){var t,n=e.abortSignal,a=e.dbCallbacks,i=e.logger,l=e.mediaDownloadFlow,s=e.mediaEntries,u=e.msgIdOfRecentMediaEntry,c=e.recentMediaEntry,g=r("MAWEBSwitch").isEnabled()&&r("gkx")("23960");g&&l.addPoint("forcing_eb_download");var h=c.directPath,y=c.fileEncSha256,C=c.fileSha256,b=c.mediaKey,v=c.serverMediaType,S=(t=o("WAProgressiveJpegGetPJpegDetails").maybeGetProgressiveJpegDetailsUsingMediaEntry(c).value)!=null?t:null;if(S==null||c.serverMediaType!=="image"||!o("WAMediaUtils").isTransformStreamSupported()||r("UserAgent").isBrowser("Safari < 18")||r("UserAgent").isBrowser("Mobile Safari < 18"))return c.serverMediaType==="image"&&S==null&&(i.LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["skip pjpeg streaming because pjpeg metadata is null"]))),i.DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["media entry: ",""])),c)),o("WAResultOrError").makeError("jpeg-stream-not-supported");l.addPoint("media_streaming_start");var L=g?o("WAResultOrError").makeError("signature-expired"):await o("WADownloadProgressiveJpegUsingMediaStreaming").downloadProgresiveJpegUsingMediaStreaming({abortSignal:n,directPath:h,downloadFlow:l,fileEncSha256:y,fileSha256:C,logger:i,mediaKey:b,progressiveJpegDetails:S,serverMediaType:v}).catch(function(e){return i.ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["downloadProgresiveJpegUsingMediaStreaming unexpected runtime-error: ",""])),o("WAErrorMessage").maybeGetMessageFromError(e)),o("WAResultOrError").makeError("runtime-error")});if(L.success)return l.addPoint("media_streaming_end"),L;if(!o("WAIsMediaExpiredError").isMediaExpiredError(L.error)||!r("MAWEBSwitch").isEnabled())return R(l,L),L;var E=await a.getProtocolMsgIdAndSortOrderMs(u);if(E==null)return o("WAResultOrError").makeError("missing-sort-order-ms-for-restore");var k=E.protocolMsgId,I=E.sortOrderMs,T=c,D=u,x=T.fileEncSha256,$=T.fileSha256,P=T.mediaKey,N=T.serverMediaType,M=o("MAWCastToMsgrServerMediaType").castToMsgrServerMediaType(N);if(M==null||T.objectId==null)return i.ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media and can not restore: ",""])),L.error),L;var w=await o("EncryptedBackupsResignCdnUrl").resignCdnUrl({deliveryObjectId:T.objectId,logger:i,mediaDownloadFlow:l,mediaKey:T.mediaKey,mediaType:M,msgId:D,protocolMsgId:k,sortOrderMs:I});if(!w.success)return w;l.addPoint("second_media_streaming_start");var A=await o("WADownloadProgressiveJpegUsingMediaStreaming").downloadProgresiveJpegUsingMediaStreaming({abortSignal:n,directPath:w.value,downloadFlow:babelHelpers.extends({},l,{addPoint:function(t,n){l.addPoint("second_"+t,n)}}),fileEncSha256:x,fileSha256:$,logger:i,mediaKey:P,progressiveJpegDetails:S,serverMediaType:N}).catch(function(e){return i.ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["downloadProgresiveJpegUsingMediaStreaming unexpected runtime-error: ",""])),o("WAErrorMessage").maybeGetMessageFromError(e)),o("WAResultOrError").makeError("runtime-error")});return A.success?(l.addPoint("second_media_streaming_end"),A):(R(l,A),A)}function S(e){var t=e.abortSignal,n=e.dbCallbacks,r=e.fullSizePlaintextHash,a=e.fullsizePromise,i=e.logger,l=e.mediaDownloadFlow,s=e.mediaEntries,u=e.msgIdOfRecentMediaEntry,c=e.recentMediaEntry,d=c.serverMediaType,m=o("WAIsPreviewSupported").checkPreviewSupport(c),p=m[0],_=m[1];if(p===o("WAIsPreviewSupported").PjpegPreviewSupport.NO&&_===o("WAIsPreviewSupported").DownloadablePreviewSupport.NO)return i.LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["preview not supported"]))),Promise.resolve(o("WAResultOrError").makeError("preview-not-supported"));if(_===o("WAIsPreviewSupported").DownloadablePreviewSupport.DuplicatedWithFullSize)return i.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["preview duplicated with fullsize"]))),a;var f=o("WAStartMediaDownloadQplFlow").startMediaDownloadQplFlow({downloadEntry:l.downloadEntry,isPreview:!0,msgType:null,protocolMsgId:null,triggerUIView:null}),y=o("WAMediaManagerPrepareMediaDownload").mediaManagerPrepareMediaDownload({hash:r,logger:i,mediaDownloadFlow:f,mediaEntry:c}),b=y.logDownloadResult;f.addAnnotations({bool:{isMediaManager:!0},string:{downloadKind:"fullsizeAndPreview",fullSizeMediaType:d,mediaType:"preview",sanitisedMediaHash:o("WAHashUtils").sanitisePlaintextHash(r)}});var v=o("WADownloadPreviewOnlyTask").downloadOrRestorePreviewOnly({abortSignal:t,dbCallbacks:n,fullSizePlaintextHash:r,logger:i,mediaDownloadFlow:f,mediaEntries:s,msgIdOfRecentMediaEntry:u,recentMediaEntry:c});return b(C(v,[u,c],f)).then(function(e){return e.success?f.endSuccess():f.endFail(e.error,{string:{failReason:e.error}}),e}).catch(function(e){return f.endFail("runtime-error",{string:{failReason:o("WAErrorMessage").maybeGetMessageFromError(e)}}),o("WAResultOrError").makeError("runtime-error")})}function R(e,t){e.addPoint("media_streaming_fail",{string:{wa_media_download_streaming_fail_reason:o("WAErrorMessage").maybeGetMessageFromError(t.error)}})}function L(e){switch(e){case"runtime-error":case"jpeg-stream-not-supported":return{error:e,shouldFallback:!0};case"missing-expected-hmacs":case"hmac-chiphertext-array-mismatch":return{error:e,shouldFallback:!0};case"missing-media-entry":case"missing-media-entry-for-restore":case"missing-sort-order-ms-for-restore":case"preview-not-supported":return{error:e,shouldFallback:!1};case"derive-primary-key-secret-error":case"derive-access-token-secret-error":case"direct-path-undefined":case"direct-path-corrupted":case"direct-path-empty":case"create-payload-failed":case"resign-cdn-url-request-error":case"resign-cdn-url-runtime-error":case"resign-cdn-url-timeout":case"resign-cdn-url-gql-error":return{error:e,shouldFallback:!1};case"invalid-media":return{error:e,shouldFallback:!1};case"decryption-error":case"enc-hash-mismatch":case"hash-mismatch":case"ciphertext-hash-mismatch":return{error:e,shouldFallback:!0};case"access-expired":case"disconnected":case"backoff":case"body-network-error":case"http-fetch-exception":case"http-fetch-aborted":case"no-host":case"server-timeout":case"unspecified-http-error":case"media-not-found":case"download-throttled":case"request-error":case"max-attempts-exceeded":case"signature-expired":case"media-entry-invalid":return{error:e,shouldFallback:!1};case"media-entry-invalid-direct-path":case"media-entry-invalid-file-enc-sha256":case"media-entry-invalid-file-sha256":case"media-entry-invalid-media-key":case"media-entry-invalid-server-media-type":return{error:e,shouldFallback:!1}}}l.startDownloadFullSizeAndPreviewTask=y}),98);
__d("WAMediaManagerLogger",["WAHashUtils","WATagsLogger"],(function(t,n,r,o,a,i,l){"use strict";var e=o("WATagsLogger").TAGS(["MediaManager"]);function s(t){var n=t.downloadKind,r=t.fullSizePlaintextHash,a=e.TAGS(["download","hash:"+o("WAHashUtils").sanitisePlaintextHash(r),n]);return a}function u(t){var n=t.plaintextHash,r=t.uploadKind,a=e.TAGS(["upload","hash:"+o("WAHashUtils").sanitisePlaintextHash(n),r]);return a}l.baseLogger=e,l.createDownloadLogger=s,l.createUploadLogger=u}),98);
__d("WAMediaManagerTypes",["WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return e.success?o("WAResultOrError").makeResult({serverMediaType:e.value.serverMediaType,unvalidatedMimeType:e.value.unvalidatedMimeType,validatedResult:e.value.validatedResult}):e}l.transformInternalMediaDownloadResult=e}),98);
__d("WAMediaManagerWorkerScheduler",["WorkerScheduler"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){return e==null&&(e=o("WorkerScheduler").makeScheduler("MediaManager",{concurrency:16,maxTaskLimit:32,maxThrottleMs:3e4,timeoutMs:6e4})),e}l.mediaManagerWorkerScheduler=s}),98);
__d("WACreateRetrier",["WAComms","WAGetMediaRoute","WAMediaOperationsRetrier","WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";async function e(e,t){var n=await o("WAGetMediaRoute").getMediaRoute({operation:"upload",serverMediaType:e},t);if(!n.success)return n;var r=n.value,a=r.authToken,i=r.fallbackHost,l=r.selectedHost,s=new(o("WAMediaOperationsRetrier")).MediaOperationsRetrier("upload",{host:{domain:l.domain,class:l.class},fallbackHost:i&&{domain:i.domain,class:i.class},authToken:a,timeElapsed:null},o("WAComms").waitForConnection);return o("WAResultOrError").makeResult(s)}l.createUploadRetrier=e}),98);
__d("WAHttpRegularUploadMedia",["WADirectPath","WALogger","WAResultOrError","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;async function c(t,n){var a;try{a=await fetch(t,{method:"POST",mode:"cors",cache:"no-store",headers:{"Content-Type":"text/plain"},body:new Blob([n])})}catch(t){throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["HttpRegularUploadMedia: fail to initiate fetch ",""])),t),t}var i=a,l=i.status;switch(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Fetch Media HTTP status ",""])),l),l){case 200:return a.json().then(function(e){if(!Object.prototype.hasOwnProperty.call(e,"direct_path"))throw r("err")("direct_path not available in wa upload http response");if(typeof e.direct_path!="string")throw r("err")('directPath: "'+e.direct_path+'" is not a string');if(e.object_id&&typeof e.object_id!="string")throw r("err")('objectId: "'+e.object_id+'" is not a string');if(e.handle&&typeof e.handle!="string")throw r("err")('handle: "'+e.handle+'" is not a string');var t={directPath:o("WADirectPath").unsafeCastToDirectPath(e.direct_path),objectId:e.object_id,handle:e.handle};return o("WAResultOrError").makeResult(t)}).catch(function(e){return o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["HttpRegularUploadMedia: fail to parse request body ",""])),e),o("WAResultOrError").makeError("body-network-error")});case 408:return o("WAResultOrError").makeError("server-timeout");case 413:return o("WAResultOrError").makeError("payload-too-large");case 415:return o("WAResultOrError").makeError("invalid-media");case 429:case 507:return o("WAResultOrError").makeError("upload-throttled");default:return l>=400&&l<500?o("WAResultOrError").makeError("request-error"):o("WAResultOrError").makeError("unspecified-http-error")}}l.httpRegularUploadMedia=c}),98);
__d("WAHttpResumeCheck",["WADirectPath","WALogger","WAMediaUtils","WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m;async function p(t){var n;try{n=await fetch(t,{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"text/plain"}})}catch(t){throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: fail to initiate fetch ",""])),t),t}var r=n,a=r.status;switch(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: response status ",""])),a),a){case 200:return n.json().then(function(e){var t=e.direct_path,n=e.object_id,r=e.resume;if(r==="complete")return t==null?(o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: direct_path is missing"]))),o("WAResultOrError").makeResult({type:"media-not-found"})):n==null?(o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: object_id is missing"]))),o("WAResultOrError").makeResult({type:"media-not-found"})):o("WAResultOrError").makeResult({type:"media-found",directPath:o("WADirectPath").unsafeCastToDirectPath(t),objectId:o("WAMediaUtils").stringToDeliveryObjectId(n)});var a=parseInt(r,10);return a===0?o("WAResultOrError").makeResult({type:"media-not-found"}):Number.isNaN(a)?(o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: resume is NaN: ",""])),r),o("WAResultOrError").makeResult({type:"media-not-found"})):o("WAResultOrError").makeResult({type:"media-partial-found",resumeFromBytes:a})}).catch(function(e){return o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: fail to parse request body ",""])),e),o("WAResultOrError").makeError("body-network-error")});case 404:return o("WAResultOrError").makeResult({type:"media-not-found"});case 408:return o("WAResultOrError").makeError("server-timeout");case 429:case 507:return o("WAResultOrError").makeError("upload-throttled");default:return a>=400&&a<500?o("WAResultOrError").makeError("request-error"):o("WAResultOrError").makeError("unspecified-http-error")}}l.httpResumeCheck=p}),98);
__d("WAEncryptAndUploadPlaintext",["WABase64","WAErrorMessage","WAGlobals","WAHttpRegularUploadMedia","WAHttpResumeCheck","WALogger","WAMediaCrypto","WAMediaUrl","WAProgressiveJpegGetPJpegDetails","WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_;async function f(t){var n=t.fromOffset,r=n===void 0?0:n,a=t.mediaKey,i=t.mediaKeyTimestamp,l=t.mediaUploadFlow,f=t.plaintext,g=t.plaintextHash,h=t.serverMediaType,y=t.uploadRetrier,C=t.uploadToken;l.addPoint("encrypt_and_upload_plaintext_start"),l.addPoint("compute_media_keys_start");var b=h==="preview"?await o("WAMediaCrypto").computeMediaKeysForPreview(a):await o("WAMediaCrypto").computeMediaKeys(a,h),v=b.cipherKey,S=b.hmacKey,R=b.iv;l.addPoint("compute_media_keys_end"),l.addPoint("encrypt_and_hmac_start");var L=await o("WAMediaCrypto").encryptAndHmac(v,R,S,f,h),E=L.ciphertext,k=L.ciphertextHash,I=L.ivCiphertextHmac,T=L.sidecar;l.addPoint("encrypt_and_hmac_end");var D=null;if(h==="image"){l.addPoint("get_progressive_jpeg_details_start");var x=await o("WAProgressiveJpegGetPJpegDetails").getProgressiveJpegDetails(new Uint8Array(f),I,S),$=o("WAProgressiveJpegGetPJpegDetails").isValidProgressiveJpegDetails(x);$.success===!1?(o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: Created invalid progressiveJpeg details during encrypt and upload: ",""])),$.error),l.addPoint($.error)):$.value===!0&&o("WAGlobals").getConfig().isProgressiveJpegSendEnabled()&&(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: Found valid progressiveJpeg details. Adding to media entry."]))),D=x,l.addPoint("get_progressive_jpeg_details_end"))}var P={fileSha256:o("WABase64").decodeB64UrlSafe(g),fileEncSha256:k,mediaKey:a,mediaKeyTimestamp:i,serverMediaType:h,uploadToken:C,sidecar:T,progressiveJpegDetails:D,size:f.byteLength,filename:void 0,lastDownloadAttemptTimestamp:void 0,directPath:void 0},N,M=await y.run(async function(e,t,n){var a=e.domain,i=r;if(n>0){l.addPoint("network_retry",{int:{network_retry_attempt:n}});try{l.addPoint("resume_check_start");var s=o("WAMediaUrl").buildUploadUrl(h,C,k,a,t,!0),p=await o("WAHttpResumeCheck").httpResumeCheck(s);if(p.success){l.addPoint("resume_check_end");var _=p.value;if(_.type==="media-found")return l.addAnnotations({bool:{existingMediaFound:!0}}),o("WAResultOrError").makeResult(o("WAResultOrError").makeResult({directPath:_.directPath,objectId:null,handle:null}));_.type==="media-partial-found"&&(i=_.resumeFromBytes)}l.addPoint("resume_check_fail",{string:{resume_check_error:p.error}})}catch(e){l.addPoint("resume_check_fail",{string:{resume_check_error:o("WAErrorMessage").maybeGetMessageFromError(e)}}),o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: error during retrier ",""])),e)}}i>0&&i<E.byteLength?(l.addAnnotations({int:{fromOffset:i},bool:{continuedFromOffset:!0}}),N=E.subarray(i)):N=E;var f=o("WAMediaUrl").buildUploadUrl(h,C,k,a,t,!1,i);return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: start upload media to ",""])),f),l.addPoint("http_upload_start"),o("WAHttpRegularUploadMedia").httpRegularUploadMedia(f,N).then(function(e){if(e.success)return l.addPoint("http_upload_end",{int:{attempt:n}}),o("WAResultOrError").makeResult(e);var t=e.error;switch(l.addPoint("http_upload_fail",{string:{http_upload_error:t}}),o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext error: ",""])),t),t){case"server-timeout":case"unspecified-http-error":return o("WAResultOrError").makeError({progressMade:!0});default:return o("WAResultOrError").makeResult(o("WAResultOrError").makeError(t))}}).catch(function(e){var t=o("WAErrorMessage").maybeGetMessageFromError(e);return l.addPoint("http_upload_fail",{string:{http_upload_error:t}}),o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext error: ",""])),t),o("WAResultOrError").makeError({progressMade:!1})})});if(M==null)return o("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext given up"]))),o("WAResultOrError").makeError("max-attempts-exceeded");if(M.success===!1)return M;var w=M.value,A=w.directPath,F=w.handle,O=w.objectId,B=babelHelpers.extends({},P,{directPath:A,handle:F,objectId:O});o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: upload success "," ",""])),{directPath:A},{objectId:O});var W="undefined";return O!=null&&(W=O.length>60?"new":"old"),l.addPoint("encrypt_and_upload_plaintext_end",{string:{object_id_type:W}}),o("WAResultOrError").makeResult(B)}l.encryptAndUploadPlaintext=f}),98);
__d("WAUploadMediaQuick",["WACreateRetrier","WAEncryptAndUploadPlaintext","WAMediaUtils","WATimeUtils"],(function(t,n,r,o,a,i,l){"use strict";var e;async function s(t){var n=t.logger,r=t.mediaUploadFlow,a=t.plaintext,i=t.plaintextHash,l=t.serverMediaType;n.DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["start uploadMediaQuick"]))),r.addPoint("create_upload_retrier_start");var s=await o("WACreateRetrier").createUploadRetrier(l,r);if(!s.success)return r.addPoint("create_upload_retrier_fail"),s;r.addPoint("create_upload_retrier_end"),r.addPoint("create_media_key_start");var u=o("WAMediaUtils").createMediaKey(),c=o("WAMediaUtils").createUploadToken(),d=o("WATimeUtils").unixTime();r.addPoint("create_media_key_end");var m=await o("WAEncryptAndUploadPlaintext").encryptAndUploadPlaintext({mediaKey:u,mediaKeyTimestamp:d,serverMediaType:l,mediaUploadFlow:r,plaintext:a,plaintextHash:i,uploadRetrier:s.value,uploadToken:c});return m}l.uploadMediaQuick=s}),98);
__d("mapWorkerSchedulerTask",[],(function(t,n,r,o,a,i){"use strict";function e(e,t){return babelHelpers.extends({},e,{promise:e.promise.then(t),run:function(){return e.run().then(t)}})}i.mapWorkerSchedulerTask=e}),66);
__d("WAMediaManager",["$InternalEnum","WADownloadFullSizeAndPreviewTask","WADownloadFullSizeOnlyTask","WADownloadPreviewOnlyTask","WAErrorMessage","WAHashUtils","WAMediaManagerCache","WAMediaManagerLogger","WAMediaManagerTypes","WAMediaManagerWorkerScheduler","WAResultOrError","WAUploadMediaQuick","WorkerScheduler","gkx","mapWorkerSchedulerTask"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S=n("$InternalEnum").Mirrored(["HIGH","MEDIUM","LOW"]);function R(){return{fullsizeCache:new Map,previewCache:new Map,uploadCache:new Map}}function L(t){var n=t.createCacheState,a=t.dbCallbacks,i=o("WAMediaManagerWorkerScheduler").mediaManagerWorkerScheduler(),l=o("WAMediaManagerCache").createAttachmentCache(a.getProtocolMsgIdAndSortOrderMs,n),v=function(n){var t=o("WAMediaManagerLogger").createDownloadLogger({downloadKind:"fullsize",fullSizePlaintextHash:n.fullSizePlaintextHash}),r=l.getFullsize(n);if(t.DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["",""])),r.type),r.type==="cache-hit")return r.cache;var c=new AbortController,d=i.task({fn:function(){return o("WADownloadFullSizeOnlyTask").startDownloadFullSizeTask({abortSignal:c.signal,dbCallbacks:a,fullSizePlaintextHash:n.fullSizePlaintextHash,logger:t,mediaDownloadFlow:n.mediaDownloadFlow})},name:"media-manager-download-fullsize-only",priority:E(n.priority)}),m=d.run();return r.setDownloadCache({abortController:c,fullSizePlaintextHash:n.fullSizePlaintextHash,mediaDownloadFlow:n.mediaDownloadFlow,scheduledTask:o("mapWorkerSchedulerTask").mapWorkerSchedulerTask(d,function(e){return e.fullsizePromise})}),m.then(function(e){return e.fullsizePromise}).then(function(e){return x(n.fullSizePlaintextHash,e,r.setDownloadedAttachmentToUploadCache)}).catch(function(e){return t.ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["runtime-error: ",""])),o("WAErrorMessage").maybeGetMessageFromError(e)),o("WAResultOrError").makeError("runtime-error")}).finally(function(){t.DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["end"])))})},S=function(t){var e=o("WAMediaManagerLogger").createDownloadLogger({downloadKind:"preview",fullSizePlaintextHash:t.fullSizePlaintextHash}),n=l.getPreview(t);if(e.DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["",""])),n.type),n.type==="cache-hit")return n.cache;var r=new AbortController,s=i.task({fn:function(){return o("WADownloadPreviewOnlyTask").startDownloadPreviewTask({abortSignal:r.signal,dbCallbacks:a,fullSizePlaintextHash:t.fullSizePlaintextHash,logger:e,mediaDownloadFlow:t.mediaDownloadFlow})},name:"media-manager-download-preview-only",priority:E(t.priority)});n.setDownloadCache({abortController:r,fullSizePlaintextHash:t.fullSizePlaintextHash,mediaDownloadFlow:t.mediaDownloadFlow,scheduledTask:o("mapWorkerSchedulerTask").mapWorkerSchedulerTask(s,function(e){return e.previewPromise})});var u=s.run();return u.then(function(e){return e.previewPromise}).then(function(e){return $(e,n.setDownloadedAttachmentToUploadCache)}).catch(function(t){return e.ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["runtime-error: ",""])),o("WAErrorMessage").maybeGetMessageFromError(t)),o("WAResultOrError").makeError("runtime-error")}).finally(function(){e.DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["end"])))})},R=function(t){var e=o("WAMediaManagerLogger").createDownloadLogger({downloadKind:"fullsizeAndPreview",fullSizePlaintextHash:t.fullSizePlaintextHash}),n=l.getFullsizeAndPreview(t),r=n.fullsizeCacheResult,s=n.previewCacheResult;if(e.DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["fullsize: ",", preview: ",""])),r.type,s.type),r.type==="cache-hit"&&s.type==="cache-hit")return{fullsizePromise:r.cache,previewPromise:s.cache};if(s.type==="cache-hit"){var u=v(t);return{fullsizePromise:u,previewPromise:s.cache}}if(r.type==="cache-hit"){var c=S(t);return{fullsizePromise:r.cache,previewPromise:c}}r.type,s.type;var d=new AbortController,m=i.task({fn:function(){return o("WADownloadFullSizeAndPreviewTask").startDownloadFullSizeAndPreviewTask({abortSignal:d.signal,dbCallbacks:a,fullSizePlaintextHash:t.fullSizePlaintextHash,logger:e,mediaDownloadFlow:t.mediaDownloadFlow})},name:"media-manager-download-fullsize-and-preview",priority:E(t.priority)});r.setDownloadCache({abortController:d,fullSizePlaintextHash:t.fullSizePlaintextHash,mediaDownloadFlow:t.mediaDownloadFlow,scheduledTask:o("mapWorkerSchedulerTask").mapWorkerSchedulerTask(m,function(e){return e.fullsizePromise})}),s.setDownloadCache({abortController:d,fullSizePlaintextHash:t.fullSizePlaintextHash,mediaDownloadFlow:t.mediaDownloadFlow,scheduledTask:o("mapWorkerSchedulerTask").mapWorkerSchedulerTask(m,function(e){return e.previewPromise})});var y=m.run();return{fullsizePromise:y.then(function(e){return e.fullsizePromise}).then(function(e){return x(t.fullSizePlaintextHash,e,r.setDownloadedAttachmentToUploadCache)}).catch(function(t){return e.ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["fullsizePromise runtime-error: ",""])),o("WAErrorMessage").maybeGetMessageFromError(t)),o("WAResultOrError").makeError("runtime-error")}).finally(function(){e.DEV(f||(f=babelHelpers.taggedTemplateLiteralLoose(["fullsize end"])))}),previewPromise:y.then(function(e){return e.previewPromise}).then(function(e){return $(e,s.setDownloadedAttachmentToUploadCache)}).catch(function(t){return e.ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["previewPromise runtime-error: ",""])),o("WAErrorMessage").maybeGetMessageFromError(t)),o("WAResultOrError").makeError("runtime-error")}).finally(function(){e.DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["preview end"])))})}},L=function(t){var e=o("WAMediaManagerLogger").createUploadLogger({plaintextHash:t.plaintextHash,uploadKind:"fullsize"}),n;if(r("gkx")("19103")&&(n=l.getUploadedAttachment(t),e.DEV(y||(y=babelHelpers.taggedTemplateLiteralLoose(["cache result: ",""])),n.type),t.mediaUploadFlow.addAnnotations({string:{dedupe_result:n.type}}),n.type==="in-thread-cache-hit"))return n.cache;var a=o("WAUploadMediaQuick").uploadMediaQuick({logger:e,mediaUploadFlow:t.mediaUploadFlow,plaintext:t.plaintext,plaintextHash:t.plaintextHash,serverMediaType:t.serverMediaType}).catch(function(t){return e.ERROR(C||(C=babelHelpers.taggedTemplateLiteralLoose(["runtime-error: ",""])),o("WAErrorMessage").maybeGetMessageFromError(t)),o("WAResultOrError").makeError("runtime-error")}).finally(function(){e.DEV(b||(b=babelHelpers.taggedTemplateLiteralLoose(["upload end"])))});return n!=null&&r("gkx")("19103")&&n.setUploadCache({chatJid:t.chatJid,plaintextHash:t.plaintextHash,scheduledTask:a}),a};return{clearCache:l.clearCache,dequeueDownload:l.cancelTask,enqueueDownloadFullSize:T("fullsize",v),enqueueDownloadFullSizeAndPreview:T("fullsizeAndPreview",R),enqueueDownloadPreview:T("preview",S),enqueueUploadFullSize:D(L)}}function E(e){return e===S.HIGH?o("WorkerScheduler").BLOCKING_PRIORITY:e===S.MEDIUM?o("WorkerScheduler").REGULAR_PRIORITY:e===S.LOW?o("WorkerScheduler").BACKGROUND_PRIORITY:(function(){throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+e)})()}var k=typeof((v=navigator.storage)==null?void 0:v.getDirectory)=="function",I=typeof self.caches=="object";function T(e,t){return function(n){var r=n.fullSizePlaintextHash,a=n.mediaDownloadFlow;try{a.addPoint("enqueue_start",{bool:{isOPFSSupported:k,isWebCacheSupported:I},string:{downloadKind:e,sanitisedMediaHash:o("WAHashUtils").sanitisePlaintextHash(r)}});var i=t(n);return a.addPoint("enqueue_end"),i}catch(e){throw a.addPoint("enqueue_fail"),e}}}function D(e){return function(t){var n=t.mediaUploadFlow,r=t.plaintextHash;try{n.addPoint("enqueue_start",{string:{sanitisedMediaHash:o("WAHashUtils").sanitisePlaintextHash(r)}});var a=e(t);return n.addPoint("enqueue_end"),a}catch(e){throw n.addPoint("enqueue_fail"),e}}}function x(e,t,n){if(!t.success)return t;if(r("gkx")("19103")===!1)return o("WAMediaManagerTypes").transformInternalMediaDownloadResult(t);var a=t.value.msgIdAndMediaEntry,i=a[0],l=a[1];return n({mediaEntry:l,msgId:i,plaintextHash:e}),o("WAMediaManagerTypes").transformInternalMediaDownloadResult(t)}function $(e,t){if(!e.success)return e;if(r("gkx")("19103")===!1)return o("WAMediaManagerTypes").transformInternalMediaDownloadResult(e);var n=e.value.msgIdAndMediaEntry,a=n[0],i=n[1],l=i.downloadableThumbnail;return l==null||l.directPath==null||l.fileEncSha256==null||l.fileSha256==null||l.mediaKey==null||l.mediaKeyTimestamp==null||l.objectId==null||t({mediaEntry:babelHelpers.extends({},i,{directPath:l.directPath,downloadableThumbnail:null,fileSha256:l.fileSha256,mediaKey:l.mediaKey,mediaKeyTimestamp:l.mediaKeyTimestamp,objectId:l.objectId,serverMediaType:"preview",size:e.value.validatedResult.validatedPlaintext.byteLength}),msgId:a,plaintextHash:o("WAHashUtils").toPlaintextHash(l.fileSha256)}),o("WAMediaManagerTypes").transformInternalMediaDownloadResult(e)}l.MediaTaskPriority=S,l.createCacheState=R,l.createMediaManager=L,l.toWorkerSchedulerPriority=E}),98);
__d("WAMediaManagerCache",["Promise","WAErrorMessage","WAHashUtils","WAMediaManager","WAMediaManagerLogger","WAMediaManagerTypes","WAPromiseDelays","WAResultOrError","WATimeUtils"],(function(t,n,r,o,a,i,l){"use strict";var e=["mediaKeyTimestamp","objectId","size"],s,u,c,d,m,p,_,f=3e4,g=1e3*60*60*24*2;function h(e,t){t===void 0&&(t=o("WAMediaManager").createCacheState);var r=t(),a=r.fullsizeCache,i=r.previewCache,l=r.uploadCache,h=function(t){var e=t.abortController,n=t.fullSizePlaintextHash,r=t.mediaDownloadFlow,i=t.scheduledTask;a.set(n,{abortController:e,mediaDownloadFlow:r,task:i}),i.promise.then(function(e){var t=e.success;return t?o("WAPromiseDelays").delayMs(f):void 0}).finally(function(){a.delete(n)})},b=function(t){var e=t.abortController,n=t.fullSizePlaintextHash,r=t.mediaDownloadFlow,a=t.scheduledTask;i.set(n,{abortController:e,mediaDownloadFlow:r,task:a}),a.promise.then(function(e){var t=e.success;return t?o("WAPromiseDelays").delayMs(f):void 0}).finally(function(){i.delete(n)})},v=function(t){var e=t.chatJid,n=t.plaintextHash,r=t.scheduledTask,a=t.cacheTtlMs,i=a===void 0?g:a,s=l.get(n)||new Map;s.set(e,r),l.set(n,s),r.then(function(e){var t=e.success;return t?o("WAPromiseDelays").delayMs(i):void 0}).finally(function(){l.delete(n)})},S=function(r){var t=r.mediaEntry,a=r.msgId,i=r.plaintextHash;e(a).then(function(e){if(e==null){o("WAMediaManagerLogger").baseLogger.WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["missing chatJid, skip setDownloadedAttachmentToUploadCache"])));return}var r=e.protocolMsgId.chat,a=C(t);if(a==null){o("WAMediaManagerLogger").baseLogger.ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["can not covert mediaEntry from download to upload for cache"])));return}var l=o("WATimeUtils").timeoutFor(a.mediaKeyTimestamp,g/1e3);if(l!==0){var c=o("WATimeUtils").pastUnixTime(o("WATimeUtils").DAY_SECONDS,a.mediaKeyTimestamp);o("WATimeUtils").isInFuture(c)||v({cacheTtlMs:l,chatJid:r,plaintextHash:i,scheduledTask:(_||(_=n("Promise"))).resolve(o("WAResultOrError").makeResult(a))})}}).catch(function(e){o("WAMediaManagerLogger").baseLogger.WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["setDownloadedAttachmentToUploadCache getProtocolMsgIdAndSortOrderMs: ",""])),o("WAErrorMessage").maybeGetMessageFromError(e))})};return{cancelTask:function(t){var e=o("WAMediaManagerLogger").baseLogger.TAGS(["hash:"+o("WAHashUtils").sanitisePlaintextHash(t),"cancelTask"]);e.LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["start"])));var n=[a,i];for(var r of n){var l=r.get(t);if(l!=null){var s=l.task.cancel();l.mediaDownloadFlow.addPoint("cancel_download_triggered"),s===!1?(l.abortController.abort(),l.mediaDownloadFlow.addPoint("http_abort_cancel"),e.LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["http abort cancel"])))):(l.mediaDownloadFlow.addPoint("worker_task_cancel_cancel"),e.LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["worker task cancel"])))),r.delete(t)}}},clearCache:function(){i.clear(),a.clear(),l.clear()},getFullsize:function(t){var e=a.get(t.fullSizePlaintextHash);return e!=null?(y(t.mediaDownloadFlow,"hit","fullsize"),e.task.promote(o("WAMediaManager").toWorkerSchedulerPriority(t.priority)),{cache:e.task.promise.then(o("WAMediaManagerTypes").transformInternalMediaDownloadResult),type:"cache-hit"}):(y(t.mediaDownloadFlow,"miss","fullsize"),{setDownloadCache:h,setDownloadedAttachmentToUploadCache:S,type:"cache-miss"})},getFullsizeAndPreview:function(t){var e=o("WAMediaManager").toWorkerSchedulerPriority(t.priority),n=a.get(t.fullSizePlaintextHash),r=i.get(t.fullSizePlaintextHash);return n!=null&&r!=null?(y(t.mediaDownloadFlow,"hit","fullsize-and-preview"),n.task.promote(e),r.task.promote(e),{fullsizeCacheResult:{cache:n.task.promise.then(o("WAMediaManagerTypes").transformInternalMediaDownloadResult),type:"cache-hit"},previewCacheResult:{cache:r.task.promise.then(o("WAMediaManagerTypes").transformInternalMediaDownloadResult),type:"cache-hit"}}):n!=null?(y(t.mediaDownloadFlow,"hit","fullsize"),n.task.promote(e),{fullsizeCacheResult:{cache:n.task.promise.then(o("WAMediaManagerTypes").transformInternalMediaDownloadResult),type:"cache-hit"},previewCacheResult:{setDownloadCache:b,setDownloadedAttachmentToUploadCache:S,type:"cache-miss"}}):r!=null?(y(t.mediaDownloadFlow,"hit","preview"),r.task.promote(e),{fullsizeCacheResult:{setDownloadCache:h,setDownloadedAttachmentToUploadCache:S,type:"cache-miss"},previewCacheResult:{cache:r.task.promise.then(o("WAMediaManagerTypes").transformInternalMediaDownloadResult),type:"cache-hit"}}):(y(t.mediaDownloadFlow,"miss","fullsize-and-preview"),{fullsizeCacheResult:{setDownloadCache:h,setDownloadedAttachmentToUploadCache:S,type:"cache-miss"},previewCacheResult:{setDownloadCache:b,setDownloadedAttachmentToUploadCache:S,type:"cache-miss"}})},getPreview:function(t){var e=i.get(t.fullSizePlaintextHash);return e!=null?(y(t.mediaDownloadFlow,"hit","preview"),e.task.promote(o("WAMediaManager").toWorkerSchedulerPriority(t.priority)),{cache:e.task.promise.then(o("WAMediaManagerTypes").transformInternalMediaDownloadResult),type:"cache-hit"}):(y(t.mediaDownloadFlow,"miss","preview"),{setDownloadCache:b,setDownloadedAttachmentToUploadCache:S,type:"cache-miss"})},getUploadedAttachment:function(t){var e=l.get(t.plaintextHash);if(e==null)return{setUploadCache:v,type:"cache-miss-no-plaintext-hash"};var n=e.get(t.chatJid);return n==null?{setUploadCache:v,type:"cache-miss-no-thread"}:{cache:n,type:"in-thread-cache-hit"}}}}function y(e,t,n){e.addAnnotations({string:{media_manager_cache_result:t,media_manager_cache_type:n}})}function C(t){var n=t.mediaKeyTimestamp,r=t.objectId,o=t.size,a=babelHelpers.objectWithoutPropertiesLoose(t,e);return n==null||r==null||o==null?null:babelHelpers.extends({},a,{mediaKeyTimestamp:n,objectId:r,size:o})}l.DOWNLOAD_TASK_CACHE_TTL_MS=f,l.UPLOAD_TASK_CACHE_TTL_MS=g,l.createAttachmentCache=h}),98);
__d("blobToDataUri",["err"],(function(t,n,r,o,a,i,l){"use strict";async function e(e){var t=new FileReader,n=new Promise(function(e,n){t.onloadend=e,t.onerror=n});t.readAsDataURL(e),await n;var o=t.result;if(typeof o!="string")throw r("err")('Unexpected result type "%s" when reading Blob as DataURL.',o instanceof ArrayBuffer?"ArrayBuffer":typeof o);return o}l.default=e}),98);
__d("MAWGetThumbnailBlobDataUrlByMediaIdApi",["MAWCreateMaybeAddPointForMediaRender","MAWDbChunkTxns","MAWDbMedia","MAWDbMediaTxns","MAWIndexedDb","MAWMaybeWithTimeout","MAWMediaManager","MAWMediaPreviewDownloadManager","MAWTransactionMode","MWFBLogger","WAErrorMessage","WAHashUtils","WAMediaManager","WAResultOrError","WAStartMediaDownloadQplFlow","blobToDataUri"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v=o("MWFBLogger").MWMediaLogger().tags(["getThumbnailBlobDataUrlByMediaId"]),S=async function(n,a,i){v.DEBUG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Get thumbnail blob for "," from , from ",""])),n,a);var t=o("MAWCreateMaybeAddPointForMediaRender").createMaybeAddPointForMediaRender(i),l={string:{description:a,fetch_by:"mediaId"}};t("fetch_thumbnail_blob_api_start",l),t("get_media_from_db_start",l);var g=await k(n);if(t("get_media_from_db_finish",{bool:{db_media_found:g!=null}}),g==null)throw v.WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["No media found for ",""])),n),t("fetch_thumbnail_blob_api_fail_no_media_found_in_db",l),v.mustfixThrow("Failed to getThumbnailBlobDataUrlByMediaId because media is not in the media db. mediaId is %s, from %s",n,a);var h=T(g);if(h.success===!0){v.DEBUG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Found jpegThumbnail entry for ",""])),n),t("fetch_thumbnail_blob_api_success",l);var y=await r("blobToDataUri")(h.value);if(!y)throw v.MUSTFIX(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Failed to create thumbnail data uri from blob for ",""])),n),t("fetch_thumbnail_blob_api_fail_no_data_uri",l),v.mustfixThrow("Failed to getThumbnailBlobDataUrlByMediaId because data uri is null. mediaId is %s, from %s",n,a);return v.DEBUG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Returning data uri for ",""])),n),y}var C=h.error;switch(C){case"missing_jpeg_thumbnail":if(g.mediaType===o("MAWDbMedia").MEDIA_TYPE.IMAGE||g.mediaType===o("MAWDbMedia").MEDIA_TYPE.VIDEO){var b=await L(g,i);if(b!=null){t("fetch_thumbnail_blob_api_success",l);var S=await r("blobToDataUri")(b);if(!S)throw v.MUSTFIX(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Failed to create thumbnail data uri from blob for ",""])),n),t("fetch_thumbnail_blob_api_fail_no_data_uri",l),v.mustfixThrow("Failed to getThumbnailBlobDataUrlByMediaId because data uri is null. mediaId is %s, from %s",n,a);return v.DEBUG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Returning data uri for ",""])),n),S}if((g==null?void 0:g.mediaType)===o("MAWDbMedia").MEDIA_TYPE.VIDEO)throw t("fetch_thumbnail_blob_api_fail_not_able_to_generate_video_thumbnail_on_the_fly",l),v.mustfixThrow("Failed to getThumbnailBlobDataUrlByMediaId in time (for video). mediaId is %s, from %s",n,a);var R=await E(g,i);if(R==null)throw t("fetch_thumbnail_blob_api_fail_not_able_to_generate_image_thumbnail_on_the_fly",l),v.mustfixThrow("Failed to getThumbnailBlobDataUrlByMediaId in time or to generate thumnbail on the fly. mediaId is %s, from %s",n,a);t("fetch_thumbnail_blob_api_success",l);var I=await r("blobToDataUri")(R);if(!I)throw v.MUSTFIX(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Failed to create thumbnail data uri from blob for ",""])),n),t("fetch_thumbnail_blob_api_fail_no_data_uri",l),v.mustfixThrow("Failed to getThumbnailBlobDataUrlByMediaId because data uri is null. mediaId is %s, from %s",n,a);return v.DEBUG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["Returning data uri for ",""])),n),I}throw t("fetch_thumbnail_blob_api_fail_missing_thumbnail",l),v.mustfixThrow("Failed to getThumbnailBlobDataUrlByMediaId, invalid media (missing_jpeg_thumbnail). mediaId is %s, from %s",n,a);case"invalid_media":throw t("fetch_thumbnail_blob_api_fail_invalid_media",l),v.mustfixThrow("Failed to getThumbnailBlobDataUrlByMediaId, invalid media. mediaId is %s, from %s",n,a)}},R=async function(t,n,a){var e=o("MAWCreateMaybeAddPointForMediaRender").createMaybeAddPointForMediaRender(a),i={string:{description:n,fetch_by:"hashedPlaintextHash"}};e("fetch_thumbnail_blob_api_start",i),v.DEBUG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["Get thumbnail blob for "," from ",""])),o("WAHashUtils").sanitisePlaintextHash(t),n);var l=o("WAStartMediaDownloadQplFlow").startMediaDownloadQplFlow({downloadEntry:"UILayout",msgType:null,protocolMsgId:null,triggerUIView:null}),s=o("MAWMediaManager").getMawMediaManager(),u=s.enqueueDownloadFullSizeAndPreview({fullSizePlaintextHash:t,mediaDownloadFlow:l,priority:o("WAMediaManager").MediaTaskPriority.HIGH}),c=await u.previewPromise;if(c.success){var d;l.endSuccess();var m=c.value.validatedResult.validatedPlaintext,p=new Blob([m],{type:(d=c.value.validatedResult.mimeType)!=null?d:void 0}),_=await r("blobToDataUri")(p);return _}if(c.error!=="preview-not-supported")throw l.endFail(c.error,{string:{failReason:c.error}}),o("MWFBLogger").MPSLogger().mustfixThrow("Failed to getThumbnailBlobDataUrlByHashedPlaintextHash. plaintextHash is %s, from %s, error: %s",o("WAHashUtils").sanitisePlaintextHash(t),n,c.error);var f=await u.fullsizePromise;if(f.success){var h;l.endSuccess();var y=f.value.validatedResult.validatedPlaintext,C=new Blob([y],{type:(h=f.value.validatedResult.mimeType)!=null?h:void 0}),b=await r("blobToDataUri")(C);return b}throw l.endFail(f.error,{string:{failReason:f.error}}),o("MWFBLogger").MPSLogger().mustfixThrow("Failed to getThumbnailBlobDataUrlByHashedPlaintextHash. plaintextHash is %s, from %s, error: %s",o("WAHashUtils").sanitisePlaintextHash(t),n,f.error)},L=function(t,n){var e=o("MAWCreateMaybeAddPointForMediaRender").createMaybeAddPointForMediaRender(n);e("fetch_thumbnail_blob_api_thumbnail_download_start");var r=o("MAWMediaPreviewDownloadManager").getMediaPreviewDownloadingResolvable(t.plaintextHash);return r==null?(e("fetch_thumbnail_blob_api_thumbnail_download_fail_no_resolvable"),Promise.resolve(null)):o("MAWMaybeWithTimeout").maybeWithTimeout(r.promise,1e4,function(){throw v.mustfixThrow("timeout waiting for thumbnail to download")}).then(function(t){return e("fetch_thumbnail_blob_api_thumbnail_download_success"),t}).catch(function(t){var n=o("WAErrorMessage").maybeGetMessageFromError(t);return v.MUSTFIX(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Exception when waiting for thumbnail to download: ",""])),n),e("fetch_thumbnail_blob_api_thumbnail_download_fail_exception",{string:{wait_for_thumbnail_download_exception:n}}),null})},E=o("MAWIndexedDb").makeMsgrTransactor({chunk:(b=o("MAWTransactionMode")).READONLY,media:b.READONLY},"generateThumbnailFromMediaChunk",function(e){return function(t,n){var r=o("MAWCreateMaybeAddPointForMediaRender").createMaybeAddPointForMediaRender(n);return r("fetch_thumbnail_blob_api_thumbnail_generate_from_media_start"),o("MAWDbChunkTxns").maybeGetChunkFromHash(e,t.hashedPlaintextHash).then(function(e){if(e==null){v.MUSTFIX(y||(y=babelHelpers.taggedTemplateLiteralLoose(["getImageThumbnail: unable to get a thumbnail as the media chunk is missing"]))),r("fetch_thumbnail_blob_api_thumbnail_generate_from_media_fail_chunk_missing");return}return v.WARN(C||(C=babelHelpers.taggedTemplateLiteralLoose(["getImageThumbnail: using media chunk as the thumbnail"]))),r("fetch_thumbnail_blob_api_thumbnail_generate_from_media_success"),new Blob([e.blobData],{type:e.mimetype})})}}),k=o("MAWIndexedDb").makeMsgrTransactor({media:b.READONLY},"getFullMedia",function(e){return function(t){return o("MAWDbMediaTxns").maybeGetMediaFromMediaId(e,t)}}),I=o("MAWIndexedDb").makeMsgrTransactor({media:b.READONLY},"getFullMedia",function(e){return function(t){return o("MAWDbMediaTxns").maybeGetMediaFromPlaintextHash(e,t)}}),T=function(t){var e=D(t);if(e.success===!1)return e;var n=e.value.jpegThumbnail;return n!=null?o("WAResultOrError").makeResult(new Blob([n],{type:"image/jpeg"})):o("WAResultOrError").makeError("missing_jpeg_thumbnail")},D=function(t){var e,n;switch(t.mediaType){case o("MAWDbMedia").MEDIA_TYPE.IMAGE:return o("WAResultOrError").makeResult({jpegThumbnail:(e=t.validatedImageInfo)==null?void 0:e.jpegThumbnail});case o("MAWDbMedia").MEDIA_TYPE.VIDEO:return o("WAResultOrError").makeResult({jpegThumbnail:(n=t.validatedVideoInfo)==null?void 0:n.jpegThumbnail});case o("MAWDbMedia").MEDIA_TYPE.PTT:case o("MAWDbMedia").MEDIA_TYPE.STICKER:case o("MAWDbMedia").MEDIA_TYPE.GIF:case o("MAWDbMedia").MEDIA_TYPE.DOCUMENT_FILE:return o("WAResultOrError").makeError("invalid_media");default:return t.mediaType,o("WAResultOrError").makeError("invalid_media")}};l.getThumbnailBlobDataUrlByMediaId=S,l.getThumbnailBlobDataUrlByHashedPlaintextHash=R,l.getFullMediaWithPlaintextHash=I}),98);
__d("MAWMediaManager",["MpsMediaManager","WAMediaManager","memoize"],(function(t,n,r,o,a,i,l){"use strict";var e=r("memoize")(function(){return o("WAMediaManager").createCacheState()}),s=r("memoize")(function(){return o("MpsMediaManager").getMpsMediaManager(e)}),u=function(){return s()};l.getMawMediaManager=u}),98);
__d("WmiChunkApi",["CoalescingLoader","MAWDbChunkTxns","MAWDexieTable","MAWIndexedDb","MAWMediaUtils","MAWTransactionMode","emptyFunction","memoizeWithArgsLFUCache"],(function(t,n,r,o,a,i,l){"use strict";function e(){var e,t=o("MAWIndexedDb").makeMsgrTransactor({chunk:o("MAWTransactionMode").READONLY},"wms_getCachedChunkResult",function(e){return function(t){return o("MAWDbChunkTxns").maybeBulkGetChunksFromPlaintextHash(e,t)}}),n=o("MAWIndexedDb").makeMsgrTransactor({chunk:o("MAWTransactionMode").READWRITE},"wms_storeChunk",function(t){return function(n){return n.map(function(t){return e(t[0])}),o("MAWDexieTable").dexieAll(n.map(function(e){return o("MAWDbChunkTxns").getOrCreateMediaChunkWithPlaintextHash(t,e[0],e[1],e[2],e[3])})).then(r("emptyFunction"))}}),a=new(o("CoalescingLoader")).CoalescingLoader(async function(n){var r=await t(n);return n.map(function(t){var n=r.get(t);return n==null&&e(t),n})}),i=new(o("CoalescingLoader")).CoalescingLoader(async function(e){return await n(e),[]}),l=r("memoizeWithArgsLFUCache")(function(e){return a.gen(e)},function(e){return e},1,function(t){e=t}),s=o("MAWIndexedDb").makeMsgrTransactor({chunk:o("MAWTransactionMode").READWRITE},"wms_deleteChunk",function(t){return function(n){n.map(e);var r=n.map(o("MAWMediaUtils").genHMACPlaintextHash);return t.chunk.where("hashedPlaintextHash").anyOf(r).delete()}});return{delete:s,get:l,store:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.gen(t)}}}l.getChunkApi=e}),98);
__d("MediaServiceLogger",["FBLogger"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t){return r("FBLogger")("wmi_media_service",t)};l.MediaServiceLogger=e}),98);
__d("WmiMediaServiceSchema",["$InternalEnum","MAWWormOdsLogger","MediaServiceLogger","WAHex","Worm","WormEAR","WormIDbDriver","WormMemoryDriver"],(function(t,n,r,o,a,i,l){"use strict";var e=n("$InternalEnum").Mirrored(["XMA","Sticker"]),s={autoIncrement:!0,indexes:{"[plaintextHash+updatedAtMs]":{fields:["plaintextHash","updatedAtMs"],unique:!1},"[threadId+messageId+plaintextHash]":{fields:["threadId","messageId","plaintextHash"],unique:!0}},nonEncryptedFields:["updatedAtMs","messageId"],primaryKey:"pk",secure:!0},u={autoIncrement:!1,indexes:{},nonEncryptedFields:["refCount"],primaryKey:"mediaId",secure:!0},c={autoIncrement:!1,indexes:{receiverFetchType:{fields:["receiverFetchType"],unique:!1}},nonEncryptedFields:["receiverFetchType"],primaryKey:"receiverFetchId",secure:!0},d={mediaReferrenceCount:u,messageChunk:s,receiverFetchInfo:c};function m(e){var t=e.blockingErrorThreshold,n=e.dbName,r=e.onBlockingError,a=e.qplEvent,i=e.strEncKey,l=o("WAHex").parseHex(i),s="wmi_media_service",u=new(o("WormEAR")).WormEAR(d,s,l),c=new(o("Worm")).WormDatabase(new(o("WormIDbDriver")).WormIDbDriver(n,s,d,u,o("MAWWormOdsLogger").wormOdsWorkerLogger,{blockingErrorThreshold:t,onBlockingError:r,onTransactionError:function(t){if(t instanceof o("WormEAR").DecryptionError){if(o("MediaServiceLogger").MediaServiceLogger().mustfix("EAR decryption error in store: %s. Dropping corrupted entity %s",t.store,t.maybeHashedPk),t.store==="messageChunk"){var e=t.maybeHashedPk;c.runInTransaction(["messageChunk"],"readwrite",function(t){return e!=null?t.stores.messageChunk.delete(e):t.stores.messageChunk.clear()},"delete-corrupted-entity")}else if(t.store==="mediaReferrenceCount"){var n=t.maybeHashedPk;c.runInTransaction(["mediaReferrenceCount"],"readwrite",function(e){return n!=null?e.stores.mediaReferrenceCount.delete(n):e.stores.mediaReferrenceCount.clear()},"delete-corrupted-entity")}else if(t.store==="receiverFetchInfo"){var r=t.maybeHashedPk;c.runInTransaction(["receiverFetchInfo"],"readwrite",function(e){return r!=null?e.stores.receiverFetchInfo.delete(r):e.stores.receiverFetchInfo.clear()},"delete-corrupted-entity")}}}}),a);return c}function p(e){return new(o("Worm")).WormDatabase(new(o("WormMemoryDriver")).WormMemoryDriver("wmi_media_service_test",d,o("MAWWormOdsLogger").wormOdsWorkerLogger),e)}l.ReceiverFetchType=e,l.SCHEMA=d,l.makeSchema=m,l.makeInMemorySchema_TEST_ONLY=p}),98);
__d("WmiMediaServiceDb",["MediaServiceLogger","WAResolvable","WmiMediaServiceSchema","err","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e,s=new(o("WAResolvable")).Resolvable;async function u(t){try{var n=o("WmiMediaServiceSchema").makeSchema(t);return e=n,await n.init(),s.resolve(n),n}catch(e){throw o("MediaServiceLogger").MediaServiceLogger().catching(r("getErrorSafe")(e)).mustfix("Error performing Media Service init"),e}}function c(){if(e==null)throw r("err")("DB is not initialized");return e}l.makeMediaServiceDb=u,l.getDb=c}),98);
__d("WmiMediaServiceDownloadQueue",["WormPersistedQueue","WormPersistedQueueSchema"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return o("WormPersistedQueueSchema").toWormPersistedQueueId(e)}var s=null;function u(){return s==null&&(s=new(o("WormPersistedQueue")).WormPersistedQueue("mediaDownloadQueue")),s}l.generateDownloadQueueId=e,l.getDownloadQueue=u}),98);
__d("WmiMediaService",["MpsTypes","WmiChunkApi","WmiMediaServiceDb","WmiMediaServiceDownloadQueue","err","nullthrows"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.$1=e,this.$2=o("WmiChunkApi").getChunkApi()}var t=e.prototype;return t.enqueueMediaDownload=async function(t){await o("WmiMediaServiceDownloadQueue").getDownloadQueue().put(t.map(function(e){return{attemptCount:0,queueId:o("WmiMediaServiceDownloadQueue").generateDownloadQueueId(e)}}))},t.getChunk=async function(t){var e,n=await this.$2.get(t);return n==null?null:{blobData:n.blobData,isProgressivePreview:(e=n.isProgressivePreview)!=null?e:!1,mimetype:n.mimetype,plaintextHash:n.plaintextHash}},t.getMessageChunkForHash=function(t){return this.$1.runInTransaction(["messageChunk"],"readonly",async function(e){var n=await e.stores.messageChunk.readIndexRange("[plaintextHash+updatedAtMs]",{only:[t]},{limit:1,order:"desc"});return n.at(0)},"WmiGetMessagesForHash")},t.handleMessageDeletion=function(t,n){return this.$3(function(e){return e.stores.messageChunk.readIndexRange("[threadId+messageId+plaintextHash]",{only:[t,n]})})},t.handleThreadDeletion=function(t){return this.$3(function(e){return e.stores.messageChunk.readIndexRange("[threadId+messageId+plaintextHash]",{only:[t]})})},t.storeChunk=function(t){var e=t.blobData,n=t.isProgressivePreview,r=t.mimetype,o=t.plaintextHash;return this.$2.store(o,e,r,n)},t.storeMessageChunks=function(t){return this.$1.runInTransaction(["messageChunk"],"readwrite",async function(e){await e.stores.messageChunk.bulkUpsert("[threadId+messageId+plaintextHash]",t.map(function(e){return{item:{messageId:e.messageId,plaintextHash:e.plaintextHash,threadId:e.threadId,updatedAtMs:o("MpsTypes").toTimestamp(Date.now())},selector:[e.threadId,e.messageId,e.plaintextHash]}}))},"WmiMediaServiceStoreChunkMessage")},t.$3=async function(t){var e=await this.$1.runInTransaction(["messageChunk"],"readwrite",async function(e){var n=await t(e);await e.stores.messageChunk.bulkDelete(n.map(function(e){return e.pk}));var r=new Set(n.map(function(e){return e.plaintextHash})),o=await e.stores.messageChunk.readIndexAnyOf("[plaintextHash+updatedAtMs]",Array.from(r).map(function(e){return[e]}));return o.forEach(function(e){return r.delete(e.plaintextHash)}),Array.from(r)},"WmiMediaServiceDeleteMessageChunkEntries");e.length>0&&await this.$2.delete(Array.from(e))},e})(),s=null;async function u(t){if(s!=null)throw r("err")("Media Service already initialised");var n=await o("WmiMediaServiceDb").makeMediaServiceDb(t);s=new e(n)}function c(){return r("nullthrows")(s,"Media Service not initialised")}function d(){s=null}l.MediaService=e,l.wmiMediaServiceSetup=u,l.mediaService=c,l.wmiMediaServiceClear__TESTONLY=d}),98);
__d("MpsMediaManager",["MAWGetThumbnailBlobDataUrlByMediaIdApi","MpsMediaEntryCache","MpsMessageToBridgeWrapper","MpsToBridgeMessageId","WAIsPreviewSupported","WAJids","WAMediaManager","WAMediaManagerCache","WAMediaUtils","WAResultOrError","WAStanzaUtils","WAValidateMedia","WebMps","WmiMediaService","getErrorSafe","memoize","nullthrows"],(function(t,n,r,o,a,i,l){"use strict";var e=["kind"];function s(e){throw new TypeError('"'+e+'" is read-only')}async function u(e){var t=e.fullSizePlaintextHash,n=e.mediaDownloadFlow,r=o("MpsMediaEntryCache").getEntry(t);if(r!=null)return n.addPoint("media_entry_cache_hit"),r;var a=await o("WmiMediaService").mediaService().getMessageChunkForHash(t);if(a==null){n.addPoint("media_entry_cache_miss",{string:{media_entry_recache_result:"missing_message_chunk"}});return}var i=await o("WebMps").mps().loadMessage({config:{shouldFetchSupplementals:!1,shouldFetchTags:!1,strategy:"local-only"},debug:{purpose:"MpsMediaManager-getEntryWithFallback"},messageId:a.messageId,threadId:a.threadId}),l=i.value;if(l==null){n.addPoint("media_entry_cache_miss",{string:{media_entry_recache_result:"missing_reverb_message"}});return}o("MpsMediaEntryCache").hydrateCache(l.toplevelProtobuf);var s=o("MpsMediaEntryCache").getEntry(t);return s==null?(n.addPoint("media_entry_cache_miss",{string:{media_entry_recache_result:"unable_to_cache"}}),null):(n.addPoint("media_entry_cache_miss",{string:{media_entry_recache_result:"success"}}),s)}async function c(e){var t=o("MpsToBridgeMessageId").bridgeMsgIdToMps(e),n=t.messageId,r=t.threadId,a=await o("WebMps").mps().loadMessage({config:{shouldFetchSupplementals:!1,shouldFetchTags:!1,strategy:"local-first"},debug:{purpose:"mps_media_manager"},messageId:n,threadId:r});if(a.value){var i=o("MpsMessageToBridgeWrapper").MpsMessageToBridgeWrapper.fromTopLevel(a.value.toplevelProtobuf),l=i.getAuthor();if(!o("WAJids").isAuthorSystem(l))return{protocolMsgId:{author:l,chat:i.getChatJid(),externalId:o("WAStanzaUtils").toStanzaId(i.getExternalId())},sortOrderMs:i.message.timestampMs}}}var d=function(t){return o("WAMediaManager").createMediaManager({createCacheState:t,dbCallbacks:{getMediaEntries:function(t){var e=o("MpsMediaEntryCache").getEntry(t);if(e==null)return Promise.resolve(o("WAResultOrError").makeError("no-media-by-plaintext-hash"));var n=e.mediaEntry,r=e.message,a=o("MpsToBridgeMessageId").mpsToBridgeMsgId(r.threadId,r.messageId);return Promise.resolve(o("WAResultOrError").makeResult(new Map([[a,n]])))},getProtocolMsgIdAndSortOrderMs:c}})};function m(e){var t=o("WAIsPreviewSupported").checkPreviewSupport(e.decodedMediaEntry),n=t[0],r=t[1];return(function(t){if(Array.isArray(t)&&t.length===2&&t[0]===o("WAIsPreviewSupported").PjpegPreviewSupport.YES)return{kind:"progressive",thumbnailHash:e.plaintextHash};if(Array.isArray(t)&&t.length===2&&t[1]===o("WAIsPreviewSupported").DownloadablePreviewSupport.YES)return e.thumbnailHash!=null?{kind:"withThumbnail",thumbnailHash:e.thumbnailHash}:{kind:"noPreview"};if(Array.isArray(t)&&t.length===2&&t[1]===o("WAIsPreviewSupported").DownloadablePreviewSupport.DuplicatedWithFullSize)return{kind:"duplicatedWithFullSize",thumbnailHash:e.plaintextHash};if(Array.isArray(t)&&t.length===2&&t[1]===o("WAIsPreviewSupported").DownloadablePreviewSupport.NO)return{kind:"noPreview"};throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+t)})([n,r])}async function p(e,t,n){if(e!=null){var r=await o("WAValidateMedia").validateMedia(e,t);if(r.value!=null)return o("WAResultOrError").makeResult({serverMediaType:n,unvalidatedMimeType:o("WAMediaUtils").getMimeTypeFromServerMediaType(n),validatedResult:r.value})}}async function _(e,t,n){var r=await o("WmiMediaService").mediaService().getChunk(e),a=await p(r==null?void 0:r.blobData,t,n);if(!(r==null||a==null))return t.addAnnotations({bool:{from_chunk:!0}}),{chunk:r,result:a}}function f(e,t,n,a){if(n.success===!0){var i;o("WmiMediaService").mediaService().storeChunk({blobData:n.value.validatedResult.validatedPlaintext,isProgressivePreview:a,mimetype:(i=n.value.validatedResult.mimeType)!=null?i:n.value.unvalidatedMimeType,plaintextHash:e}).then(function(){return t.addAnnotations({string:{chunk_store_result:"success"}})}).catch(function(e){var n=r("getErrorSafe")(e).message;t.addAnnotations({string:{chunk_store_result:n}})})}}async function g(e,t,n){var r,a=n.fullSizePlaintextHash,i=n.mediaDownloadFlow;if(e.success||e.error!=="signature-expired")return e;var l=await o("MAWGetThumbnailBlobDataUrlByMediaIdApi").getFullMediaWithPlaintextHash(a);if(l==null)return i.addAnnotations({string:{signature_expired_fallback:"media not found"}}),e;var s=(r=l.validatedAudioInfo)!=null?r:l.validatedVideoInfo,u=s==null?void 0:s.jpegThumbnail;if(u==null)return i.addAnnotations({string:{signature_expired_fallback:"thumbnail not found"}}),e;var c=await o("WAValidateMedia").validateMedia(u,i);return c.value==null?(i.addAnnotations({string:{signature_expired_fallback:"validation failed"}}),e):(i.addAnnotations({string:{signature_expired_fallback:"success"}}),o("WAResultOrError").makeResult({serverMediaType:t.serverMediaType,unvalidatedMimeType:o("WAMediaUtils").getMimeTypeFromServerMediaType("image"),validatedResult:c.value}))}var h=function(n){var t=d(n),a=o("WAMediaManagerCache").createAttachmentCache(c,n),i={clearCache:t.clearCache,dequeueDownload:t.dequeueDownload,enqueueDownloadFullSize:async function(n){n.mediaDownloadFlow.addAnnotations({string:{downloadKind:"fullsize"}});var e=a.getFullsize(n);if(e.type==="cache-hit")return e.cache;var r=await u(n);if(!r)return o("WAResultOrError").makeError("missing-media-entry");var i=await _(n.fullSizePlaintextHash,n.mediaDownloadFlow,r.serverMediaType);if(i!=null&&!i.chunk.isProgressivePreview)return i.result;n.mediaDownloadFlow.addPoint("mps_actual_download");var l=await t.enqueueDownloadFullSize(n);return f(n.fullSizePlaintextHash,n.mediaDownloadFlow,l,!1),l},enqueueDownloadFullSizeAndPreview:function(i){i.mediaDownloadFlow.addAnnotations({string:{downloadKind:"fullsizeAndPreview"}});var n=a.getFullsizeAndPreview(i),l=n.fullsizeCacheResult,s=n.previewCacheResult;if(l.type==="cache-hit"&&s.type==="cache-hit")return{fullsizePromise:l.cache,previewPromise:s.cache};var c=r("memoize")(function(){return u(i)}),d=r("memoize")(async function(){var e=r("nullthrows")(await c()),t=_(i.fullSizePlaintextHash,i.mediaDownloadFlow,e.serverMediaType);return t});i.mediaDownloadFlow.addPoint("mps_actual_download");var p=r("memoize")(function(){return t.enqueueDownloadFullSizeAndPreview(i)});return{fullsizePromise:(async function(){var e=await c();if(e==null)return o("WAResultOrError").makeError("missing-media-entry");var t=await d();if(t!=null&&!t.chunk.isProgressivePreview)return t.result;var n=await p().fullsizePromise;return f(i.fullSizePlaintextHash,i.mediaDownloadFlow,n,!1),n})(),previewPromise:(async function(){var t=await c();if(t==null)return o("WAResultOrError").makeError("missing-media-entry");var n=m(t);if(n.kind==="noPreview")return o("WAResultOrError").makeError("preview-not-supported");var r=await(function(n){if((typeof n=="object"&&n!==null||typeof n=="function")&&n.kind==="duplicatedWithFullSize"||(typeof n=="object"&&n!==null||typeof n=="function")&&n.kind==="progressive")return d();if((typeof n=="object"&&n!==null||typeof n=="function")&&n.kind==="withThumbnail"){var r=n.kind,o=babelHelpers.objectWithoutPropertiesLoose(n,e);return _(o.thumbnailHash,i.mediaDownloadFlow,t.serverMediaType)}throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+n)})(n);if(r!=null)return r.result;var a=await p().previewPromise,l=await g(a,t,i);return n.kind==="withThumbnail"&&f(n.thumbnailHash,i.mediaDownloadFlow,l,!1),l})()}},enqueueDownloadPreview:async function(n){n.mediaDownloadFlow.addAnnotations({string:{downloadKind:"preview"}});var e=a.getPreview(n);if(e.type==="cache-hit")return e.cache;var r=await u(n);if(r==null)return o("WAResultOrError").makeError("missing-media-entry");var i=m(r),l=i.kind==="progressive";if(i.kind==="noPreview")return o("WAResultOrError").makeError("preview-not-supported");var s=i.thumbnailHash,c=await _(s,n.mediaDownloadFlow,r.serverMediaType);if(c!=null)return c.result;n.mediaDownloadFlow.addPoint("mps_actual_download");var d=await t.enqueueDownloadPreview(n),p=await g(d,r,n);return f(s,n.mediaDownloadFlow,p,l),p},enqueueUploadFullSize:function(){return t.enqueueUploadFullSize.apply(t,arguments)}};return i};l.getMpsMediaManager=h}),98);/*FB_PKG_DELIM*/
__d("TCompactProtocol",["StringToUtf8","ThriftTypes","Utf8ToString"],(function(t,n,r,o,a,i,l){var e,s=Object.freeze({CT_STOP:0,CT_BOOLEAN_TRUE:1,CT_BOOLEAN_FALSE:2,CT_BYTE:3,CT_I16:4,CT_I32:5,CT_I64:6,CT_DOUBLE:7,CT_BINARY:8,CT_LIST:9,CT_SET:10,CT_MAP:11,CT_STRUCT:12,CT_FLOAT:13}),u=Object.freeze({NONE:-1,CT_BOOLEAN_TRUE:s.CT_BOOLEAN_TRUE,CT_BOOLEAN_FALSE:s.CT_BOOLEAN_FALSE}),c=[s.CT_STOP,0,s.CT_BOOLEAN_TRUE,s.CT_BYTE,s.CT_DOUBLE,0,s.CT_I16,0,s.CT_I32,0,s.CT_I64,s.CT_BINARY,s.CT_STRUCT,s.CT_MAP,s.CT_SET,s.CT_LIST,0,0,0,s.CT_FLOAT],d=Math.pow(2,7)-1,m=-1*Math.pow(2,7),p=Math.pow(2,15)-1,_=-1*Math.pow(2,15),f=Math.pow(2,31)-1,g=-1*Math.pow(2,31),h=Math.pow(2,32)-1,y=BigInt("9223372036854775807"),C=BigInt("-9223372036854775808"),b=BigInt("18446744073709551615"),v=BigInt(63),S=BigInt(1),R=BigInt(7),L=BigInt("0x7f"),E=BigInt("0x80"),k=Math.pow(2,4),I=(function(){function t(e){this.$4=null,this.$5=null,this.$1=e,this.$2=[],this.$3=0,this.$6=new DataView(new ArrayBuffer(1))}var n=t.prototype;return n.readStructBegin=function(){this.$2.push(this.$3),this.$3=0},n.readStructEnd=function(){return this.$3=this.$2.pop(),0},n.writeStructBegin=function(t){return this.$2.push(this.$3),this.$3=0,0},n.writeStructEnd=function(){return this.$3=this.$2.pop(),0},n.writeFieldBegin=function(n){return n.ftype===(e||(e=r("ThriftTypes"))).BOOL?(this.$4={fid:n.fid,fname:n.fname,ftype:n.ftype},0):this.$7(n,u.NONE)},n.writeListBegin=function(t){return this.$8(t)},n.writeListEnd=function(){return 0},n.writeSetBegin=function(t){return this.$8(t)},n.writeSetEnd=function(){return 0},n.writeMapBegin=function(t){var e=0;if(t.size===0)e+=this.$1.writeByte(0);else if(e+=this.writeVarint32(t.size),t.ktype!=null&&t.vtype!=null)e+=this.$1.writeByte(this.$9(t.ktype)<<4|this.$9(t.vtype));else throw new Error("received invalid map info: "+JSON.stringify(t));return e},n.writeMapEnd=function(){return 0},n.$7=function(t,n){var e=0,r=n===u.NONE?this.$9(t.ftype):n;return t.fid>this.$3&&t.fid-this.$3<=k-1?e+=this.$1.writeByte(t.fid-this.$3<<4|r):(e+=this.$1.writeByte(r),e+=this.writeI16(t.fid)),this.$3=t.fid,e},n.$8=function(t){var e=0,n=this.$9(t.etype);return t.size<=k-2?e+=this.$1.writeByte(t.size<<4|n):(e+=this.$1.writeByte(240|n),e+=this.writeVarint32(t.size)),e},n.readFieldBegin=function(){var t=this.$1.readByte(),n=t&15;if(n===(e||(e=r("ThriftTypes"))).STOP)return{ftype:(e||(e=r("ThriftTypes"))).STOP,fid:0};var o=(t&240)>>>4,a;o===0?a=this.readI16():a=this.$3+o;var i=this.$10(n);return(n===s.CT_BOOLEAN_TRUE||n===s.CT_BOOLEAN_FALSE)&&(this.$5=n===s.CT_BOOLEAN_TRUE),this.$3=a,{ftype:i,fid:a}},n.readListBegin=function(){return this.$11()},n.readListEnd=function(){return 0},n.readSetBegin=function(){return this.$11()},n.readSetEnd=function(){return 0},n.readMapBegin=function(){var e=this.readVarint32();if(e>0){var t=this.$1.readByte(),n=this.$12(t>>4,"readMapBegin:key"),r=this.$12(t&15,"readMapBegin:value");return{ktype:this.$10(n),vtype:this.$10(r),size:e}}return{size:e}},n.readMapEnd=function(){return 0},n.$12=function(t,n){if(t<0||t>13)throw new Error(n+" read invalid compact type: "+t);return t},n.$11=function(){var e=this.$1.readByte(),t=this.$12(e&15,"_readListOrSetBegin"),n=this.$10(t),r=e>>4&15;return r===15&&(r=this.readVarint32()),{etype:n,size:r}},n.readFieldEnd=function(){return 0},n.readByte=function(){return this.$6.setUint8(0,this.$1.readByte()),this.$6.getInt8(0)},n.writeByte=function(t){if(t<m||t>d)throw new Error("byte to write is out of range: "+t);return this.$6.setInt8(0,t),this.$1.writeByte(this.$6.getUint8(0))},n.readFloat=function(){return this.$1.readFloatBE()},n.writeFloat=function(t){return this.$1.writeFloatBE(t)},n.readDouble=function(){return this.$1.readDoubleBE()},n.writeDouble=function(t){return this.$1.writeDoubleBE(t)},n.writeString=function(t){return this.writeBinary(o("StringToUtf8").StringToUtf8(t))},n.skip=function(n){switch(n){case(e||(e=r("ThriftTypes"))).STOP:return;case(e||(e=r("ThriftTypes"))).BOOL:this.readBool();break;case(e||(e=r("ThriftTypes"))).BYTE:this.readByte();break;case(e||(e=r("ThriftTypes"))).DOUBLE:this.readDouble();break;case(e||(e=r("ThriftTypes"))).I16:this.readI16();break;case(e||(e=r("ThriftTypes"))).I32:this.readI32();break;case(e||(e=r("ThriftTypes"))).I64:this.readI64();break;case(e||(e=r("ThriftTypes"))).STRING:this.readString();break;case(e||(e=r("ThriftTypes"))).STRUCT:{this.readStructBegin();for(var t;t=this.readFieldBegin(),t.ftype!==(e||(e=r("ThriftTypes"))).STOP;)this.skip(t.ftype);this.readStructEnd();break}case(e||(e=r("ThriftTypes"))).MAP:{var o=this.readMapBegin();if(o.size>0&&o.ktype!=null&&o.vtype!=null)for(var a=o.ktype,i=o.vtype,l=0;l<o.size;l++)this.skip(a),this.skip(i);break}case(e||(e=r("ThriftTypes"))).SET:case(e||(e=r("ThriftTypes"))).LIST:{for(var s=this.$11(),u=0;u<s.size;u++)this.skip(s.etype);break}case(e||(e=r("ThriftTypes"))).FLOAT:this.readFloat();break;default:throw new Error("encoutered unknow thrift type: "+n+" in skip")}},n.toByteArray=function(){return this.$1.toByteArray()},n.writeFieldEnd=function(){return 0},n.writeFieldStop=function(){return this.$1.writeByte((e||(e=r("ThriftTypes"))).STOP)},n.writeI16=function(t){if(t<_||t>p)throw new Error("trying to write i16 out of range: "+t);return this.writeVarint32(this.i32ToZigzag(t))},n.readI16=function(){var e=this.zigzagToI32(this.readVarint32());if(e<_||e>p)throw new Error("read invalid i16: "+e);return e},n.writeI32=function(t){if(t<g||t>f)throw new Error("i32 out of range: "+t);return this.writeVarint32(this.i32ToZigzag(t))},n.readI32=function(){return this.zigzagToI32(this.readVarint32())},n.writeI64=function(t){return this.writeVarint64(this.i64ToZigzag(t))},n.readI64=function(){return this.zigzagToI64(this.readVarint64())},n.readBool=function(){var e;return this.$5!=null?(e=this.$5,this.$5=null):e=this.$1.readByte()===s.CT_BOOLEAN_TRUE,e},n.writeBool=function(t){var e=0;return this.$4!=null?(e+=this.$7(this.$4,t?u.CT_BOOLEAN_TRUE:u.CT_BOOLEAN_FALSE),this.$4=null):e+=this.$1.writeByte(t?s.CT_BOOLEAN_TRUE:s.CT_BOOLEAN_FALSE),e},n.readBinary=function(){var e=this.readVarint32();return e===0?new Uint8Array(0):this.$1.readBytes(e)},n.writeBinary=function(t){var e=0;return e+=this.writeVarint32(t.length),e+=this.$1.write(t),e},n.i32ToZigzag=function(t){if(t<g||t>f)throw new Error("number: "+t+" is out of range of i32");return(t<<1^(t<0?4294967295:0))>>>0},n.zigzagToI32=function(t){if(t<0||t>h)throw new Error("number: "+t+" is out of range of uint32");return t>>>1^-1*(t&1)},n.i64ToZigzag=function(t){if(t>y||t<C)throw new Error("i64 out of range: "+t.toString());return t>>v^t<<S},n.zigzagToI64=function(t){if(t<0||t>b)throw new Error("invalid uint64: "+t.toString());return(t&S)===S?~(t>>S):t>>S},n.writeVarint32=function(t){if(t<0||t>h)throw new Error("writeVarint32 received out of range uint32: "+t);for(var e=t,n=0;;)if(e>>>7)this.$1.writeByte(e&127|128),n++,e>>>=7;else{this.$1.writeByte(e),n++;break}return n},n.readVarint32=function(){for(var e=0,t=0,n;;){if(n=this.$1.readByte(),e=(e|(n&127)<<t)>>>0,t+=7,(n&128)==0){if(t===35&&(n&240)!=0)throw new Error("result exceeded 32 bit limit");break}if(t>28)throw new Error("result exceeded 32 bit limit")}return e},n.writeVarint64=function(t){if(t<0||t>b)throw new Error("invalid uint64: "+t.toString());for(var e=t,n=0;;)if(e>>R==0){this.$1.writeByte(Number(e)),n++;break}else this.$1.writeByte(Number(e&L|E)),n++,e>>=R;return n},n.readVarint64=function(){for(var e=BigInt(0),t=BigInt(0),n;;){if(n=BigInt(this.$1.readByte()),e|=(n&L)<<t,t+=R,(n&E)==0){if(t==70&&n!==S)throw new Error("result exceeded 64 bit limit");break}if(t>63)throw new Error("result exceeded 64 bit limit")}return e},n.readString=function(){return o("Utf8ToString").Utf8ToString(this.readBinary())},n.getLastFieldId=function(){return this.$3},n.getLastField=function(){return this.$2},n.getBooleanFieldInfo=function(){return this.$4},n.getBooleanValue=function(){return this.$5},n.$9=function(t){return c[t]},n.$10=function(n){switch(n){case s.CT_STOP:return(e||(e=r("ThriftTypes"))).STOP;case s.CT_BOOLEAN_FALSE:case s.CT_BOOLEAN_TRUE:return(e||(e=r("ThriftTypes"))).BOOL;case s.CT_BYTE:return(e||(e=r("ThriftTypes"))).BYTE;case s.CT_I16:return(e||(e=r("ThriftTypes"))).I16;case s.CT_I32:return(e||(e=r("ThriftTypes"))).I32;case s.CT_I64:return(e||(e=r("ThriftTypes"))).I64;case s.CT_DOUBLE:return(e||(e=r("ThriftTypes"))).DOUBLE;case s.CT_FLOAT:return(e||(e=r("ThriftTypes"))).FLOAT;case s.CT_BINARY:return(e||(e=r("ThriftTypes"))).STRING;case s.CT_LIST:return(e||(e=r("ThriftTypes"))).LIST;case s.CT_SET:return(e||(e=r("ThriftTypes"))).SET;case s.CT_MAP:return(e||(e=r("ThriftTypes"))).MAP;case s.CT_STRUCT:return(e||(e=r("ThriftTypes"))).STRUCT;default:throw new Error("don't know what type")}},t})();l.default=I}),98);
__d("CompactSerializer",["TCompactProtocol","TNoOpWriteBuffer","TReadBuffer","TWriteBuffer"],(function(t,n,r,o,a,i,l){function e(e,t,n){try{return s(e,t)}catch(e){n!=null&&n(e)}return null}function s(e,t){var n=new(r("TReadBuffer"))(e),o=new(r("TCompactProtocol"))(n);return t(o)}function u(e,t,n,r){n===void 0&&(n=!1);try{return c(e,t,n)}catch(e){r!=null&&r(e)}return null}function c(e,t,n){n===void 0&&(n=!1);var o;if(n){var a=new(r("TNoOpWriteBuffer")),i=new(r("TCompactProtocol"))(a);t(e,i),o=new(r("TWriteBuffer"))(a.currentSize())}else o=new(r("TWriteBuffer"));var l=new(r("TCompactProtocol"))(o);return t(e,l),l.toByteArray()}l.deserializeNoThrow=e,l.deserialize=s,l.serializeNoThrow=u,l.serialize=c}),98);
__d("MultiwaySharedTypes",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e,l=(e=n("$InternalEnum"))({UNKNOWN:0,SFU:1,P2P:2}),s=e({UNKNOWN:0,IGVIDEOCALL:9,ROOM:15,CRUCIBLE:20,MBS_WA:21,BOT:22,HORIZON:23,ULLC:24}),u=e({OFFER:0,PRANSWER:1,ANSWER:2,PROFFER:3}),c=e({LOW:0,MEDIUM:1,HIGH:2,HD:3,NUM_QUALITIES:4}),d=e({E2EE_NOT_MANDATED:0,DEPRECATED_NO_REQUIREMENT:1,E2EE_MANDATED:2,E2EE_BYPASSED_USER_CONSENTED:3}),m=e({NOT_SET:0,CONTROL:1,TEST:2}),p=e({NOT_SET:0,CONTROL:1,TEST:2}),_=e({NotPaused:0,Paused:1}),f=e({AUDIO:0,VIDEO:1,DATA:2}),g=e({UNKNOWN:0,COMPOSITING_SERVICE:1,MEDIA_SERVER:2,CATHODE_AMBISONIC:3,CATHODE_CAPTIONS:4,CATHODE_MEETING_SUMMARIZER:5,CATHODE_REALTIME_SHARED_STATE:6,RP_GENAI_SERVICE:7,SMART_GLASSES_ASSISTANT:8}),h=e({CNAME:0,TRACK:1,DOMINANT_SPEAKER:2}),y=e({UNKNOWN:0,DEFAULT:1,SCREEN_SHARE:2}),C=e({UNSPECIFIED:0,FNA:1,FNA_PREFERRED:2}),b=e({NONE:0,EXTENSION_SELF_PARTICIPANT:1}),v=e({IntValue:"intValue",StringValue:"stringValue"});a.exports={ConferenceType:s,CustomMediaRoutingType:b,E2eeInfraMandatedExpStatus:m,E2eeMode:d,EdgerayType:C,EndpointServiceType:g,MediaPath:l,MediaPauseStatus:_,MediaType:f,P2PSFrameExpStatus:p,QuickExperimentValue$Types:v,RenderedStreamType:y,SdpType:u,SubscriptionType:h,VideoQuality:c}}),null);
__d("WebrtcSignalingCommonTypes",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e,l=(e=n("$InternalEnum"))({DEFAULT_AUDIO:0,DEFAULT_VIDEO:1,SCREEN_AUDIO:2,SCREEN_VIDEO:3,CUSTOM_VIDEO:4,CUSTOM_AUDIO:5}),s=e({OLD_CLIENT_PLATFORM_STACK:0,RSYS_X:1,IG_OLD_STACK:2,MLITE_OLD_STACK:3,SCOTCH:4,ZENON:5}),u=e({NONE:0,AVATAR:1,AUGMENTED_CALLING:2,SCENE_COMPOSITION:3,STEREO_VIDEO:4,SHARED_STATE:5,CODEC_AVATAR_2D:6,CODEC_AVATAR_2D_IMU:7}),c=e({NONE:0,AMBISONIC:1,CONVERSATION_BOT:2,MONOMIX:3,MONOSTREAM:4});a.exports={ClientStack:s,CustomAudioContentType:c,CustomVideoContentType:u,TrackLabel:l}}),null);
__d("MultiwaySharedSerializers",["MultiwaySharedTypes","ThriftTypes","WebrtcSignalingCommonTypes"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){return{cluster:"",nonce:""}}function u(){return{cluster:"",conferenceName:"",nonce:"",userId:"",clientSessionId:""}}function c(){return{userId:"",deviceId:"",appId:"",appVersion:"",appBuildNumber:""}}function d(){return{mode:o("MultiwaySharedTypes").E2eeMode.cast(0),preventSfuMode:!1,infraMandatedExpStatus:o("MultiwaySharedTypes").E2eeInfraMandatedExpStatus.cast(0),p2pSFrameExpStatus:o("MultiwaySharedTypes").P2PSFrameExpStatus.cast(0)}}function m(){return{semantics:"",ssrcs:[]}}function p(){return{type:o("MultiwaySharedTypes").MediaType.cast(0),id:"",ssrcs:[],enabled:!1,customVideoContentType:o("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(0),customAudioContentType:o("WebrtcSignalingCommonTypes").CustomAudioContentType.cast(0)}}function _(){return{parameters:{},conditionFbid:"0",exposureHasBeenLogged:!1,canExposureLog:!1,universeShortName:"",userFbid:"0",unitId:""}}function f(){return{experiments:{},userFbid:"0"}}function g(){return{conditionFbid:"0",userFbid:"0",universeName:"",unitId:""}}function h(){return{enabled:!1,customVideoContentType:o("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(0),customAudioContentType:o("WebrtcSignalingCommonTypes").CustomAudioContentType.cast(0)}}function y(){return{tracks:{}}}function C(){return{videoQuality:o("MultiwaySharedTypes").VideoQuality.cast(0)}}function b(){return{cname:"",type:o("MultiwaySharedTypes").SubscriptionType.cast(0)}}function v(){return{restrictiveLogging:!0,verboseLogging:!1}}function S(){return{userId:"",streamId:"",streamType:0,renderWidth:0,renderHeight:0}}function R(){return{}}function L(){return{}}function E(){return{}}function k(){return{host:Uint8Array.of(),port:0}}function I(){return{}}function T(t,n){if(n.writeStructBegin("ServerInfo"),n.writeFieldBegin({fname:"cluster",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.cluster!=null)n.writeString(t.cluster);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),t.conferenceName_deprecated!=null&&(n.writeFieldBegin({fname:"conferenceName_deprecated",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeString(t.conferenceName_deprecated),n.writeFieldEnd()),n.writeFieldBegin({fname:"nonce",ftype:e.STRING,fid:3}),t.nonce!=null)n.writeString(t.nonce);else{var a="";n.writeString(a)}n.writeFieldEnd(),t.conferenceId!=null&&(n.writeFieldBegin({fname:"conferenceId",ftype:(e||(e=r("ThriftTypes"))).I64,fid:4}),n.writeI64(BigInt(t.conferenceId)),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function D(t,n){if(n.writeStructBegin("ClientSessionInfo"),n.writeFieldBegin({fname:"cluster",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.cluster!=null)n.writeString(t.cluster);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"conferenceName",ftype:e.STRING,fid:2}),t.conferenceName!=null)n.writeString(t.conferenceName);else{var a="";n.writeString(a)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"nonce",ftype:e.STRING,fid:3}),t.nonce!=null)n.writeString(t.nonce);else{var i="";n.writeString(i)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"userId",ftype:e.STRING,fid:4}),t.userId!=null)n.writeString(t.userId);else{var l="";n.writeString(l)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"clientSessionId",ftype:e.STRING,fid:5}),t.clientSessionId!=null)n.writeString(t.clientSessionId);else{var s="";n.writeString(s)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function x(t,n){if(n.writeStructBegin("Endpoint"),n.writeFieldBegin({fname:"userId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.userId!=null)n.writeString(t.userId);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"deviceId",ftype:e.STRING,fid:2}),t.deviceId!=null)n.writeString(t.deviceId);else{var a="";n.writeString(a)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"appId",ftype:e.STRING,fid:3}),t.appId!=null)n.writeString(t.appId);else{var i="";n.writeString(i)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"appVersion",ftype:e.STRING,fid:4}),t.appVersion!=null)n.writeString(t.appVersion);else{var l="";n.writeString(l)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"appBuildNumber",ftype:e.STRING,fid:5}),t.appBuildNumber!=null)n.writeString(t.appBuildNumber);else{var s="";n.writeString(s)}n.writeFieldEnd(),t.clientStackInfo!=null&&(n.writeFieldBegin({fname:"clientStackInfo",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:6}),n.writeString(t.clientStackInfo),n.writeFieldEnd()),t.familyDeviceId!=null&&(n.writeFieldBegin({fname:"familyDeviceId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:7}),n.writeString(t.familyDeviceId),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function $(t,n){if(n.writeStructBegin("E2eeEnforcement"),n.writeFieldBegin({fname:"mode",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),t.mode!=null){var a;n.writeI32((a=t.mode)!=null?a:0)}else{var i=o("MultiwaySharedTypes").E2eeMode.cast(0);n.writeI32(i!=null?i:0)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"preventSfuMode",ftype:e.BOOL,fid:2}),t.preventSfuMode!=null)n.writeBool(t.preventSfuMode);else{var l=!1;n.writeBool(l)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"infraMandatedExpStatus",ftype:e.I32,fid:3}),t.infraMandatedExpStatus!=null){var s;n.writeI32((s=t.infraMandatedExpStatus)!=null?s:0)}else{var u=o("MultiwaySharedTypes").E2eeInfraMandatedExpStatus.cast(0);n.writeI32(u!=null?u:0)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"p2pSFrameExpStatus",ftype:e.I32,fid:4}),t.p2pSFrameExpStatus!=null){var c;n.writeI32((c=t.p2pSFrameExpStatus)!=null?c:0)}else{var d=o("MultiwaySharedTypes").P2PSFrameExpStatus.cast(0);n.writeI32(d!=null?d:0)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function P(t,n){if(n.writeStructBegin("SsrcGroup"),n.writeFieldBegin({fname:"semantics",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.semantics!=null)n.writeString(t.semantics);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"ssrcs",ftype:e.LIST,fid:2}),t.ssrcs!=null){n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).I64,size:t.ssrcs.length});for(var a of t.ssrcs)n.writeI64(BigInt(a));n.writeListEnd()}else{var i=[];n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).I64,size:i.length});for(var l of i)n.writeI64(BigInt(l));n.writeListEnd()}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function N(t,n){if(n.writeStructBegin("Media"),n.writeFieldBegin({fname:"type",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),t.type!=null){var a;n.writeI32((a=t.type)!=null?a:0)}else{var i=o("MultiwaySharedTypes").MediaType.cast(0);n.writeI32(i!=null?i:0)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"id",ftype:e.STRING,fid:2}),t.id!=null)n.writeString(t.id);else{var l="";n.writeString(l)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"ssrcs",ftype:e.LIST,fid:3}),t.ssrcs!=null){n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).I64,size:t.ssrcs.length});for(var s of t.ssrcs)n.writeI64(BigInt(s));n.writeListEnd()}else{var u=[];n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).I64,size:u.length});for(var c of u)n.writeI64(BigInt(c));n.writeListEnd()}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"enabled",ftype:e.BOOL,fid:4}),t.enabled!=null)n.writeBool(t.enabled);else{var d=!1;n.writeBool(d)}if(n.writeFieldEnd(),t.pausedDownlink!=null){var m;n.writeFieldBegin({fname:"pausedDownlink",ftype:(e||(e=r("ThriftTypes"))).I32,fid:5}),n.writeI32((m=t.pausedDownlink)!=null?m:0),n.writeFieldEnd()}if(t.pausedUplink!=null){var p;n.writeFieldBegin({fname:"pausedUplink",ftype:(e||(e=r("ThriftTypes"))).I32,fid:6}),n.writeI32((p=t.pausedUplink)!=null?p:0),n.writeFieldEnd()}if(t.owner!=null&&(n.writeFieldBegin({fname:"owner",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:7}),n.writeString(t.owner),n.writeFieldEnd()),t.label!=null){var _;n.writeFieldBegin({fname:"label",ftype:(e||(e=r("ThriftTypes"))).I32,fid:8}),n.writeI32((_=t.label)!=null?_:0),n.writeFieldEnd()}if(n.writeFieldBegin({fname:"customVideoContentType",ftype:e.I32,fid:9}),t.customVideoContentType!=null){var f;n.writeI32((f=t.customVideoContentType)!=null?f:0)}else{var g=o("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(0);n.writeI32(g!=null?g:0)}if(n.writeFieldEnd(),t.name!=null&&(n.writeFieldBegin({fname:"name",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:10}),n.writeString(t.name),n.writeFieldEnd()),n.writeFieldBegin({fname:"customAudioContentType",ftype:e.I32,fid:11}),t.customAudioContentType!=null){var h;n.writeI32((h=t.customAudioContentType)!=null?h:0)}else{var y=o("WebrtcSignalingCommonTypes").CustomAudioContentType.cast(0);n.writeI32(y!=null?y:0)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function M(t,n){if(n.writeStructBegin("QuickExperiment"),n.writeFieldBegin({fname:"parameters",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:1}),t.parameters!=null){n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).STRING,vtype:e.STRUCT,size:Object.keys(t.parameters).length});for(var o of Object.entries(t.parameters)){var a=o[0],i=o[1];n.writeString(a),j(i,n)}n.writeMapEnd()}else{var l={};n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).STRING,vtype:e.STRUCT,size:Object.keys(l).length});for(var s of Object.entries(l)){var u=s[0],c=s[1];n.writeString(u),j(c,n)}n.writeMapEnd()}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"conditionFbid",ftype:e.I64,fid:2}),t.conditionFbid!=null)n.writeI64(BigInt(t.conditionFbid));else{var d="0";n.writeI64(BigInt(d))}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"exposureHasBeenLogged",ftype:e.BOOL,fid:3}),t.exposureHasBeenLogged!=null)n.writeBool(t.exposureHasBeenLogged);else{var m=!1;n.writeBool(m)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"canExposureLog",ftype:e.BOOL,fid:4}),t.canExposureLog!=null)n.writeBool(t.canExposureLog);else{var p=!1;n.writeBool(p)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"universeShortName",ftype:e.STRING,fid:5}),t.universeShortName!=null)n.writeString(t.universeShortName);else{var _="";n.writeString(_)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"userFbid",ftype:e.I64,fid:6}),t.userFbid!=null)n.writeI64(BigInt(t.userFbid));else{var f="0";n.writeI64(BigInt(f))}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"unitId",ftype:e.STRING,fid:7}),t.unitId!=null)n.writeString(t.unitId);else{var g="";n.writeString(g)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function w(t,n){if(n.writeStructBegin("QuickExperimentResult"),n.writeFieldBegin({fname:"experiments",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:1}),t.experiments!=null){n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).STRING,vtype:e.STRUCT,size:Object.keys(t.experiments).length});for(var o of Object.entries(t.experiments)){var a=o[0],i=o[1];n.writeString(a),M(i,n)}n.writeMapEnd()}else{var l={};n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).STRING,vtype:e.STRUCT,size:Object.keys(l).length});for(var s of Object.entries(l)){var u=s[0],c=s[1];n.writeString(u),M(c,n)}n.writeMapEnd()}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"userFbid",ftype:e.I64,fid:2}),t.userFbid!=null)n.writeI64(BigInt(t.userFbid));else{var d="0";n.writeI64(BigInt(d))}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function A(t,n){if(n.writeStructBegin("QuickExperimentExposureLoggingEvent"),n.writeFieldBegin({fname:"conditionFbid",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),t.conditionFbid!=null)n.writeI64(BigInt(t.conditionFbid));else{var o="0";n.writeI64(BigInt(o))}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"userFbid",ftype:e.I64,fid:2}),t.userFbid!=null)n.writeI64(BigInt(t.userFbid));else{var a="0";n.writeI64(BigInt(a))}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"universeName",ftype:e.STRING,fid:3}),t.universeName!=null)n.writeString(t.universeName);else{var i="";n.writeString(i)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"unitId",ftype:e.STRING,fid:4}),t.unitId!=null)n.writeString(t.unitId);else{var l="";n.writeString(l)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function F(t,n){if(n.writeStructBegin("ClientTrackInfo"),n.writeFieldBegin({fname:"enabled",ftype:(e||(e=r("ThriftTypes"))).BOOL,fid:1}),t.enabled!=null)n.writeBool(t.enabled);else{var a=!1;n.writeBool(a)}if(n.writeFieldEnd(),t.pausedUplink!=null){var i;n.writeFieldBegin({fname:"pausedUplink",ftype:(e||(e=r("ThriftTypes"))).I32,fid:2}),n.writeI32((i=t.pausedUplink)!=null?i:0),n.writeFieldEnd()}if(t.pausedDownlink!=null){var l;n.writeFieldBegin({fname:"pausedDownlink",ftype:(e||(e=r("ThriftTypes"))).I32,fid:3}),n.writeI32((l=t.pausedDownlink)!=null?l:0),n.writeFieldEnd()}if(t.owner!=null&&(n.writeFieldBegin({fname:"owner",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:4}),n.writeString(t.owner),n.writeFieldEnd()),t.label!=null){var s;n.writeFieldBegin({fname:"label",ftype:(e||(e=r("ThriftTypes"))).I32,fid:5}),n.writeI32((s=t.label)!=null?s:0),n.writeFieldEnd()}if(n.writeFieldBegin({fname:"customVideoContentType",ftype:e.I32,fid:6}),t.customVideoContentType!=null){var u;n.writeI32((u=t.customVideoContentType)!=null?u:0)}else{var c=o("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(0);n.writeI32(c!=null?c:0)}if(n.writeFieldEnd(),t.name!=null&&(n.writeFieldBegin({fname:"name",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:7}),n.writeString(t.name),n.writeFieldEnd()),n.writeFieldBegin({fname:"customAudioContentType",ftype:e.I32,fid:8}),t.customAudioContentType!=null){var d;n.writeI32((d=t.customAudioContentType)!=null?d:0)}else{var m=o("WebrtcSignalingCommonTypes").CustomAudioContentType.cast(0);n.writeI32(m!=null?m:0)}n.writeFieldEnd(),t.nodeId!=null&&(n.writeFieldBegin({fname:"nodeId",ftype:(e||(e=r("ThriftTypes"))).I64,fid:9}),n.writeI64(BigInt(t.nodeId)),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function O(t,n){if(n.writeStructBegin("ClientMediaStatus"),n.writeFieldBegin({fname:"tracks",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:1}),t.tracks!=null){n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).STRING,vtype:e.STRUCT,size:Object.keys(t.tracks).length});for(var o of Object.entries(t.tracks)){var a=o[0],i=o[1];n.writeString(a),F(i,n)}n.writeMapEnd()}else{var l={};n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).STRING,vtype:e.STRUCT,size:Object.keys(l).length});for(var s of Object.entries(l)){var u=s[0],c=s[1];n.writeString(u),F(c,n)}n.writeMapEnd()}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function B(t,n){if(n.writeStructBegin("SubscriptionOptions"),n.writeFieldBegin({fname:"videoQuality",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),t.videoQuality!=null){var a;n.writeI32((a=t.videoQuality)!=null?a:0)}else{var i=o("MultiwaySharedTypes").VideoQuality.cast(0);n.writeI32(i!=null?i:0)}n.writeFieldEnd(),t.qualityIndex!=null&&(n.writeFieldBegin({fname:"qualityIndex",ftype:(e||(e=r("ThriftTypes"))).I32,fid:2}),n.writeI32(t.qualityIndex),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function W(t,n){if(n.writeStructBegin("Subscription"),n.writeFieldBegin({fname:"cname",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.cname!=null)n.writeString(t.cname);else{var a="";n.writeString(a)}if(n.writeFieldEnd(),t.options!=null&&(n.writeFieldBegin({fname:"options",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:2}),B(t.options,n),n.writeFieldEnd()),n.writeFieldBegin({fname:"type",ftype:e.I32,fid:3}),t.type!=null){var i;n.writeI32((i=t.type)!=null?i:0)}else{var l=o("MultiwaySharedTypes").SubscriptionType.cast(0);n.writeI32(l!=null?l:0)}n.writeFieldEnd(),t.trackId!=null&&(n.writeFieldBegin({fname:"trackId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:4}),n.writeString(t.trackId),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function q(t,n){if(n.writeStructBegin("LoggingOptions"),n.writeFieldBegin({fname:"restrictiveLogging",ftype:(e||(e=r("ThriftTypes"))).BOOL,fid:1}),t.restrictiveLogging!=null)n.writeBool(t.restrictiveLogging);else{var o=!0;n.writeBool(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"verboseLogging",ftype:e.BOOL,fid:2}),t.verboseLogging!=null)n.writeBool(t.verboseLogging);else{var a=!1;n.writeBool(a)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function U(t,n){if(n.writeStructBegin("ResolutionData"),n.writeFieldBegin({fname:"userId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.userId!=null)n.writeString(t.userId);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"streamId",ftype:e.STRING,fid:2}),t.streamId!=null)n.writeString(t.streamId);else{var a="";n.writeString(a)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"streamType",ftype:e.I32,fid:3}),t.streamType!=null)n.writeI32(t.streamType);else{var i=0;n.writeI32(i)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"renderWidth",ftype:e.I32,fid:4}),t.renderWidth!=null)n.writeI32(t.renderWidth);else{var l=0;n.writeI32(l)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"renderHeight",ftype:e.I32,fid:5}),t.renderHeight!=null)n.writeI32(t.renderHeight);else{var s=0;n.writeI32(s)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function V(t,n){n.writeStructBegin("TurnInfo"),t.ipv4!=null&&(n.writeFieldBegin({fname:"ipv4",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),n.writeBinary(t.ipv4),n.writeFieldEnd()),t.ipv6!=null&&(n.writeFieldBegin({fname:"ipv6",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeBinary(t.ipv6),n.writeFieldEnd()),t.udpPort!=null&&(n.writeFieldBegin({fname:"udpPort",ftype:(e||(e=r("ThriftTypes"))).I32,fid:3}),n.writeI32(t.udpPort),n.writeFieldEnd()),t.tcpPort!=null&&(n.writeFieldBegin({fname:"tcpPort",ftype:(e||(e=r("ThriftTypes"))).I32,fid:4}),n.writeI32(t.tcpPort),n.writeFieldEnd()),t.sslTcpPort!=null&&(n.writeFieldBegin({fname:"sslTcpPort",ftype:(e||(e=r("ThriftTypes"))).I32,fid:5}),n.writeI32(t.sslTcpPort),n.writeFieldEnd()),t.portInfoIdx!=null&&(n.writeFieldBegin({fname:"portInfoIdx",ftype:(e||(e=r("ThriftTypes"))).I32,fid:6}),n.writeI32(t.portInfoIdx),n.writeFieldEnd()),t.tlsPort!=null&&(n.writeFieldBegin({fname:"tlsPort",ftype:(e||(e=r("ThriftTypes"))).I32,fid:7}),n.writeI32(t.tlsPort),n.writeFieldEnd()),t.credentialIdx!=null&&(n.writeFieldBegin({fname:"credentialIdx",ftype:(e||(e=r("ThriftTypes"))).I32,fid:8}),n.writeI32(t.credentialIdx),n.writeFieldEnd()),t.turnUsername!=null&&(n.writeFieldBegin({fname:"turnUsername",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:9}),n.writeString(t.turnUsername),n.writeFieldEnd()),t.turnPassword!=null&&(n.writeFieldBegin({fname:"turnPassword",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:10}),n.writeString(t.turnPassword),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function H(t,n){if(n.writeStructBegin("EdgerayInfo"),t.edgerayType!=null){var o;n.writeFieldBegin({fname:"edgerayType",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),n.writeI32((o=t.edgerayType)!=null?o:0),n.writeFieldEnd()}t.ipv4!=null&&(n.writeFieldBegin({fname:"ipv4",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeBinary(t.ipv4),n.writeFieldEnd()),t.ipv6!=null&&(n.writeFieldBegin({fname:"ipv6",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:3}),n.writeBinary(t.ipv6),n.writeFieldEnd()),t.token!=null&&(n.writeFieldBegin({fname:"token",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:4}),n.writeBinary(t.token),n.writeFieldEnd()),t.tokenIdx!=null&&(n.writeFieldBegin({fname:"tokenIdx",ftype:(e||(e=r("ThriftTypes"))).I32,fid:5}),n.writeI32(t.tokenIdx),n.writeFieldEnd()),t.secret!=null&&(n.writeFieldBegin({fname:"secret",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:6}),n.writeBinary(t.secret),n.writeFieldEnd()),t.secretIdx!=null&&(n.writeFieldBegin({fname:"secretIdx",ftype:(e||(e=r("ThriftTypes"))).I32,fid:7}),n.writeI32(t.secretIdx),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function G(t,n){if(n.writeStructBegin("RelayInfo"),t.turns!=null){n.writeFieldBegin({fname:"turns",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:1}),n.writeListBegin({etype:e.STRUCT,size:t.turns.length});for(var o of t.turns)V(o,n);n.writeListEnd(),n.writeFieldEnd()}if(t.edgerays!=null){n.writeFieldBegin({fname:"edgerays",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:2}),n.writeListBegin({etype:e.STRUCT,size:t.edgerays.length});for(var a of t.edgerays)H(a,n);n.writeListEnd(),n.writeFieldEnd()}t.turnUsername!=null&&(n.writeFieldBegin({fname:"turnUsername",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:3}),n.writeString(t.turnUsername),n.writeFieldEnd()),t.turnPassword!=null&&(n.writeFieldBegin({fname:"turnPassword",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:4}),n.writeString(t.turnPassword),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function z(t,n){if(n.writeStructBegin("TSocketAddress"),n.writeFieldBegin({fname:"host",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.host!=null)n.writeBinary(t.host);else{var o=Uint8Array.of();n.writeBinary(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"port",ftype:e.I16,fid:2}),t.port!=null)n.writeI16(t.port);else{var a=0;n.writeI16(a)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function j(t,n){if(n.writeStructBegin("QuickExperimentValue"),t.intValue!=null){n.writeFieldBegin({fname:"intValue",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),n.writeI64(BigInt(t.intValue)),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.stringValue!=null){n.writeFieldBegin({fname:"stringValue",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeString(t.stringValue),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}n.writeFieldStop(),n.writeStructEnd()}function K(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.cluster=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.conferenceName_deprecated=t.readString():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).STRING?n.nonce=t.readString():t.skip(a);break;case 4:a===(e||(e=r("ThriftTypes"))).I64?n.conferenceId=t.readI64().toString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.cluster===void 0&&(n.cluster=""),n.nonce===void 0&&(n.nonce=""),n}function Q(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.cluster=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.conferenceName=t.readString():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).STRING?n.nonce=t.readString():t.skip(a);break;case 4:a===(e||(e=r("ThriftTypes"))).STRING?n.userId=t.readString():t.skip(a);break;case 5:a===(e||(e=r("ThriftTypes"))).STRING?n.clientSessionId=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.cluster===void 0&&(n.cluster=""),n.conferenceName===void 0&&(n.conferenceName=""),n.nonce===void 0&&(n.nonce=""),n.userId===void 0&&(n.userId=""),n.clientSessionId===void 0&&(n.clientSessionId=""),n}function X(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.userId=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.deviceId=t.readString():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).STRING?n.appId=t.readString():t.skip(a);break;case 4:a===(e||(e=r("ThriftTypes"))).STRING?n.appVersion=t.readString():t.skip(a);break;case 5:a===(e||(e=r("ThriftTypes"))).STRING?n.appBuildNumber=t.readString():t.skip(a);break;case 6:a===(e||(e=r("ThriftTypes"))).STRING?n.clientStackInfo=t.readString():t.skip(a);break;case 7:a===(e||(e=r("ThriftTypes"))).STRING?n.familyDeviceId=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.userId===void 0&&(n.userId=""),n.deviceId===void 0&&(n.deviceId=""),n.appId===void 0&&(n.appId=""),n.appVersion===void 0&&(n.appVersion=""),n.appBuildNumber===void 0&&(n.appBuildNumber=""),n}function Y(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I32?n.mode=o("MultiwaySharedTypes").E2eeMode.cast(t.readI32()):t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).BOOL?n.preventSfuMode=t.readBool():t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).I32?n.infraMandatedExpStatus=o("MultiwaySharedTypes").E2eeInfraMandatedExpStatus.cast(t.readI32()):t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).I32?n.p2pSFrameExpStatus=o("MultiwaySharedTypes").P2PSFrameExpStatus.cast(t.readI32()):t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.mode===void 0&&(n.mode=o("MultiwaySharedTypes").E2eeMode.cast(0)),n.preventSfuMode===void 0&&(n.preventSfuMode=!1),n.infraMandatedExpStatus===void 0&&(n.infraMandatedExpStatus=o("MultiwaySharedTypes").E2eeInfraMandatedExpStatus.cast(0)),n.p2pSFrameExpStatus===void 0&&(n.p2pSFrameExpStatus=o("MultiwaySharedTypes").P2PSFrameExpStatus.cast(0)),n}function J(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.semantics=t.readString():t.skip(a);break;case 2:if(a===(e||(e=r("ThriftTypes"))).LIST){n.ssrcs=[];for(var l=t.readListBegin(),s=0;s<l.size;s++){var u=t.readI64().toString();n.ssrcs.push(u)}}else t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.semantics===void 0&&(n.semantics=""),n.ssrcs===void 0&&(n.ssrcs=[]),n}function Z(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I32?n.type=o("MultiwaySharedTypes").MediaType.cast(t.readI32()):t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).STRING?n.id=t.readString():t.skip(i);break;case 3:if(i===(e||(e=r("ThriftTypes"))).LIST){n.ssrcs=[];for(var s=t.readListBegin(),u=0;u<s.size;u++){var c=t.readI64().toString();n.ssrcs.push(c)}}else t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).BOOL?n.enabled=t.readBool():t.skip(i);break;case 5:i===(e||(e=r("ThriftTypes"))).I32?n.pausedDownlink=o("MultiwaySharedTypes").MediaPauseStatus.cast(t.readI32()):t.skip(i);break;case 6:i===(e||(e=r("ThriftTypes"))).I32?n.pausedUplink=o("MultiwaySharedTypes").MediaPauseStatus.cast(t.readI32()):t.skip(i);break;case 7:i===(e||(e=r("ThriftTypes"))).STRING?n.owner=t.readString():t.skip(i);break;case 8:i===(e||(e=r("ThriftTypes"))).I32?n.label=o("WebrtcSignalingCommonTypes").TrackLabel.cast(t.readI32()):t.skip(i);break;case 9:i===(e||(e=r("ThriftTypes"))).I32?n.customVideoContentType=o("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(t.readI32()):t.skip(i);break;case 10:i===(e||(e=r("ThriftTypes"))).STRING?n.name=t.readString():t.skip(i);break;case 11:i===(e||(e=r("ThriftTypes"))).I32?n.customAudioContentType=o("WebrtcSignalingCommonTypes").CustomAudioContentType.cast(t.readI32()):t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.type===void 0&&(n.type=o("MultiwaySharedTypes").MediaType.cast(0)),n.id===void 0&&(n.id=""),n.ssrcs===void 0&&(n.ssrcs=[]),n.enabled===void 0&&(n.enabled=!1),n.customVideoContentType===void 0&&(n.customVideoContentType=o("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(0)),n.customAudioContentType===void 0&&(n.customAudioContentType=o("WebrtcSignalingCommonTypes").CustomAudioContentType.cast(0)),n}function ee(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:if(a===(e||(e=r("ThriftTypes"))).MAP){n.parameters={};for(var l=t.readMapBegin(),s=0;s<l.size;s++){var u=t.readString(),c=pe(t);n.parameters[u]=c}}else t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).I64?n.conditionFbid=t.readI64().toString():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).BOOL?n.exposureHasBeenLogged=t.readBool():t.skip(a);break;case 4:a===(e||(e=r("ThriftTypes"))).BOOL?n.canExposureLog=t.readBool():t.skip(a);break;case 5:a===(e||(e=r("ThriftTypes"))).STRING?n.universeShortName=t.readString():t.skip(a);break;case 6:a===(e||(e=r("ThriftTypes"))).I64?n.userFbid=t.readI64().toString():t.skip(a);break;case 7:a===(e||(e=r("ThriftTypes"))).STRING?n.unitId=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.parameters===void 0&&(n.parameters={}),n.conditionFbid===void 0&&(n.conditionFbid="0"),n.exposureHasBeenLogged===void 0&&(n.exposureHasBeenLogged=!1),n.canExposureLog===void 0&&(n.canExposureLog=!1),n.universeShortName===void 0&&(n.universeShortName=""),n.userFbid===void 0&&(n.userFbid="0"),n.unitId===void 0&&(n.unitId=""),n}function te(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:if(a===(e||(e=r("ThriftTypes"))).MAP){n.experiments={};for(var l=t.readMapBegin(),s=0;s<l.size;s++){var u=t.readString(),c=ee(t);n.experiments[u]=c}}else t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).I64?n.userFbid=t.readI64().toString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.experiments===void 0&&(n.experiments={}),n.userFbid===void 0&&(n.userFbid="0"),n}function ne(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).I64?n.conditionFbid=t.readI64().toString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).I64?n.userFbid=t.readI64().toString():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).STRING?n.universeName=t.readString():t.skip(a);break;case 4:a===(e||(e=r("ThriftTypes"))).STRING?n.unitId=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.conditionFbid===void 0&&(n.conditionFbid="0"),n.userFbid===void 0&&(n.userFbid="0"),n.universeName===void 0&&(n.universeName=""),n.unitId===void 0&&(n.unitId=""),n}function re(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).BOOL?n.enabled=t.readBool():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).I32?n.pausedUplink=o("MultiwaySharedTypes").MediaPauseStatus.cast(t.readI32()):t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).I32?n.pausedDownlink=o("MultiwaySharedTypes").MediaPauseStatus.cast(t.readI32()):t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).STRING?n.owner=t.readString():t.skip(i);break;case 5:i===(e||(e=r("ThriftTypes"))).I32?n.label=o("WebrtcSignalingCommonTypes").TrackLabel.cast(t.readI32()):t.skip(i);break;case 6:i===(e||(e=r("ThriftTypes"))).I32?n.customVideoContentType=o("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(t.readI32()):t.skip(i);break;case 7:i===(e||(e=r("ThriftTypes"))).STRING?n.name=t.readString():t.skip(i);break;case 8:i===(e||(e=r("ThriftTypes"))).I32?n.customAudioContentType=o("WebrtcSignalingCommonTypes").CustomAudioContentType.cast(t.readI32()):t.skip(i);break;case 9:i===(e||(e=r("ThriftTypes"))).I64?n.nodeId=t.readI64().toString():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.enabled===void 0&&(n.enabled=!1),n.customVideoContentType===void 0&&(n.customVideoContentType=o("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(0)),n.customAudioContentType===void 0&&(n.customAudioContentType=o("WebrtcSignalingCommonTypes").CustomAudioContentType.cast(0)),n}function oe(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:if(a===(e||(e=r("ThriftTypes"))).MAP){n.tracks={};for(var l=t.readMapBegin(),s=0;s<l.size;s++){var u=t.readString(),c=re(t);n.tracks[u]=c}}else t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.tracks===void 0&&(n.tracks={}),n}function ae(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I32?n.videoQuality=o("MultiwaySharedTypes").VideoQuality.cast(t.readI32()):t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).I32?n.qualityIndex=t.readI32():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.videoQuality===void 0&&(n.videoQuality=o("MultiwaySharedTypes").VideoQuality.cast(0)),n}function ie(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).STRING?n.cname=t.readString():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).STRUCT?n.options=ae(t):t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).I32?n.type=o("MultiwaySharedTypes").SubscriptionType.cast(t.readI32()):t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).STRING?n.trackId=t.readString():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.cname===void 0&&(n.cname=""),n.type===void 0&&(n.type=o("MultiwaySharedTypes").SubscriptionType.cast(0)),n}function le(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).BOOL?n.restrictiveLogging=t.readBool():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).BOOL?n.verboseLogging=t.readBool():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.restrictiveLogging===void 0&&(n.restrictiveLogging=!0),n.verboseLogging===void 0&&(n.verboseLogging=!1),n}function se(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.userId=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.streamId=t.readString():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).I32?n.streamType=t.readI32():t.skip(a);break;case 4:a===(e||(e=r("ThriftTypes"))).I32?n.renderWidth=t.readI32():t.skip(a);break;case 5:a===(e||(e=r("ThriftTypes"))).I32?n.renderHeight=t.readI32():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.userId===void 0&&(n.userId=""),n.streamId===void 0&&(n.streamId=""),n.streamType===void 0&&(n.streamType=0),n.renderWidth===void 0&&(n.renderWidth=0),n.renderHeight===void 0&&(n.renderHeight=0),n}function ue(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.ipv4=t.readBinary():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.ipv6=t.readBinary():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).I32?n.udpPort=t.readI32():t.skip(a);break;case 4:a===(e||(e=r("ThriftTypes"))).I32?n.tcpPort=t.readI32():t.skip(a);break;case 5:a===(e||(e=r("ThriftTypes"))).I32?n.sslTcpPort=t.readI32():t.skip(a);break;case 6:a===(e||(e=r("ThriftTypes"))).I32?n.portInfoIdx=t.readI32():t.skip(a);break;case 7:a===(e||(e=r("ThriftTypes"))).I32?n.tlsPort=t.readI32():t.skip(a);break;case 8:a===(e||(e=r("ThriftTypes"))).I32?n.credentialIdx=t.readI32():t.skip(a);break;case 9:a===(e||(e=r("ThriftTypes"))).STRING?n.turnUsername=t.readString():t.skip(a);break;case 10:a===(e||(e=r("ThriftTypes"))).STRING?n.turnPassword=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n}function ce(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I32?n.edgerayType=o("MultiwaySharedTypes").EdgerayType.cast(t.readI32()):t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).STRING?n.ipv4=t.readBinary():t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).STRING?n.ipv6=t.readBinary():t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).STRING?n.token=t.readBinary():t.skip(i);break;case 5:i===(e||(e=r("ThriftTypes"))).I32?n.tokenIdx=t.readI32():t.skip(i);break;case 6:i===(e||(e=r("ThriftTypes"))).STRING?n.secret=t.readBinary():t.skip(i);break;case 7:i===(e||(e=r("ThriftTypes"))).I32?n.secretIdx=t.readI32():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n}function de(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:if(a===(e||(e=r("ThriftTypes"))).LIST){n.turns=[];for(var l=t.readListBegin(),s=0;s<l.size;s++){var u=ue(t);n.turns.push(u)}}else t.skip(a);break;case 2:if(a===(e||(e=r("ThriftTypes"))).LIST){n.edgerays=[];for(var c=t.readListBegin(),d=0;d<c.size;d++){var m=ce(t);n.edgerays.push(m)}}else t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).STRING?n.turnUsername=t.readString():t.skip(a);break;case 4:a===(e||(e=r("ThriftTypes"))).STRING?n.turnPassword=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n}function me(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.host=t.readBinary():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).I16?n.port=t.readI16():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.host===void 0&&(n.host=Uint8Array.of()),n.port===void 0&&(n.port=0),n}function pe(t){var n,o={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:if(i===(e||(e=r("ThriftTypes"))).I64)if(n==null)o.intValue=t.readI64().toString(),n="intValue";else throw new Error("more than one field have been deserialized in union type: QuickExperimentValue; current field: intValue, previous deserialized field: "+n);else t.skip(i);break;case 2:if(i===(e||(e=r("ThriftTypes"))).STRING)if(n==null)o.stringValue=t.readString(),n="stringValue";else throw new Error("more than one field have been deserialized in union type: QuickExperimentValue; current field: stringValue, previous deserialized field: "+n);else t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),o}l.ServerInfo$DefaultConstructor=s,l.ClientSessionInfo$DefaultConstructor=u,l.Endpoint$DefaultConstructor=c,l.E2eeEnforcement$DefaultConstructor=d,l.SsrcGroup$DefaultConstructor=m,l.Media$DefaultConstructor=p,l.QuickExperiment$DefaultConstructor=_,l.QuickExperimentResult$DefaultConstructor=f,l.QuickExperimentExposureLoggingEvent$DefaultConstructor=g,l.ClientTrackInfo$DefaultConstructor=h,l.ClientMediaStatus$DefaultConstructor=y,l.SubscriptionOptions$DefaultConstructor=C,l.Subscription$DefaultConstructor=b,l.LoggingOptions$DefaultConstructor=v,l.ResolutionData$DefaultConstructor=S,l.TurnInfo$DefaultConstructor=R,l.EdgerayInfo$DefaultConstructor=L,l.RelayInfo$DefaultConstructor=E,l.TSocketAddress$DefaultConstructor=k,l.QuickExperimentValue$DefaultConstructor=I,l.serializeServerInfo=T,l.serializeClientSessionInfo=D,l.serializeEndpoint=x,l.serializeE2eeEnforcement=$,l.serializeSsrcGroup=P,l.serializeMedia=N,l.serializeQuickExperiment=M,l.serializeQuickExperimentResult=w,l.serializeQuickExperimentExposureLoggingEvent=A,l.serializeClientTrackInfo=F,l.serializeClientMediaStatus=O,l.serializeSubscriptionOptions=B,l.serializeSubscription=W,l.serializeLoggingOptions=q,l.serializeResolutionData=U,l.serializeTurnInfo=V,l.serializeEdgerayInfo=H,l.serializeRelayInfo=G,l.serializeTSocketAddress=z,l.serializeQuickExperimentValue=j,l.deserializeServerInfo=K,l.deserializeClientSessionInfo=Q,l.deserializeEndpoint=X,l.deserializeE2eeEnforcement=Y,l.deserializeSsrcGroup=J,l.deserializeMedia=Z,l.deserializeQuickExperiment=ee,l.deserializeQuickExperimentResult=te,l.deserializeQuickExperimentExposureLoggingEvent=ne,l.deserializeClientTrackInfo=re,l.deserializeClientMediaStatus=oe,l.deserializeSubscriptionOptions=ae,l.deserializeSubscription=ie,l.deserializeLoggingOptions=le,l.deserializeResolutionData=se,l.deserializeTurnInfo=ue,l.deserializeEdgerayInfo=ce,l.deserializeRelayInfo=de,l.deserializeTSocketAddress=me,l.deserializeQuickExperimentValue=pe}),98);
__d("WebrtcSignalingCommonSerializers",["ThriftTypes"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){return{topic:"",data:Uint8Array.of()}}function u(t,n){if(n.writeStructBegin("GenericDataMessage"),n.writeFieldBegin({fname:"topic",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.topic!=null)n.writeString(t.topic);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"data",ftype:e.STRING,fid:2}),t.data!=null)n.writeBinary(t.data);else{var a=Uint8Array.of();n.writeBinary(a)}n.writeFieldEnd(),t.e2eEncryptedData!=null&&(n.writeFieldBegin({fname:"e2eEncryptedData",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:3}),n.writeBinary(t.e2eEncryptedData),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function c(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.topic=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.data=t.readBinary():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).STRING?n.e2eEncryptedData=t.readBinary():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.topic===void 0&&(n.topic=""),n.data===void 0&&(n.data=Uint8Array.of()),n}l.GenericDataMessage$DefaultConstructor=s,l.serializeGenericDataMessage=u,l.deserializeGenericDataMessage=c}),98);
__d("DataMessageSerializers",["MultiwaySharedSerializers","MultiwaySharedTypes","ThriftTypes","WebrtcSignalingCommonSerializers"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){return{topic_DEPRECATED:""}}function u(){return{userId:""}}function c(){return{userId:"",cname:"",trackIds:[],transactionId:"0"}}function d(){return{cname:"",quality_DEPRECATED:o("MultiwaySharedTypes").VideoQuality.cast(0)}}function m(){return{userId:"",bottleneckBps:0}}function p(){return{bottleneckUplinksByLayer:{}}}function _(){return{duplicationAmount:0,delayMs:0}}function f(){return{}}function g(){return{}}function h(){return{primarySpeakerUserId:"",transactionId:"0"}}function y(){return{}}function C(){return{signalingMessagePayload:Uint8Array.of()}}function b(){return{signalingMessagePayload:Uint8Array.of()}}function v(){return{subscriptionMessagePayload:[]}}function S(){return{}}function R(){return{}}function L(){return{nodeIdToUserIdMap:{},nodeIdToServiceTypeMap:{}}}function E(){return{}}function k(){return{header:s()}}function I(t,n){if(n.writeStructBegin("DataHeader"),t.sender!=null&&(n.writeFieldBegin({fname:"sender",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),n.writeString(t.sender),n.writeFieldEnd()),n.writeFieldBegin({fname:"topic_DEPRECATED",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),t.topic_DEPRECATED!=null)n.writeString(t.topic_DEPRECATED);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),t.recipients!=null){n.writeFieldBegin({fname:"recipients",ftype:(e||(e=r("ThriftTypes"))).SET,fid:3}),n.writeSetBegin({etype:e.STRING,size:t.recipients.size});for(var a of t.recipients)n.writeString(a);n.writeSetEnd(),n.writeFieldEnd()}if(t.serviceSender!=null){var i;n.writeFieldBegin({fname:"serviceSender",ftype:(e||(e=r("ThriftTypes"))).I32,fid:4}),n.writeI32((i=t.serviceSender)!=null?i:0),n.writeFieldEnd()}if(t.serviceRecipients!=null){n.writeFieldBegin({fname:"serviceRecipients",ftype:(e||(e=r("ThriftTypes"))).SET,fid:5}),n.writeSetBegin({etype:e.I32,size:t.serviceRecipients.size});for(var l of t.serviceRecipients)n.writeI32(l!=null?l:0);n.writeSetEnd(),n.writeFieldEnd()}t.shouldSendToAllUsers!=null&&(n.writeFieldBegin({fname:"shouldSendToAllUsers",ftype:(e||(e=r("ThriftTypes"))).BOOL,fid:6}),n.writeBool(t.shouldSendToAllUsers),n.writeFieldEnd()),t.senderE2eeId!=null&&(n.writeFieldBegin({fname:"senderE2eeId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:7}),n.writeBinary(t.senderE2eeId),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function T(t,n){if(n.writeStructBegin("SpeakerDetail"),n.writeFieldBegin({fname:"userId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.userId!=null)n.writeString(t.userId);else{var o="";n.writeString(o)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function D(t,n){if(n.writeStructBegin("DominantSpeakerNotification"),n.writeFieldBegin({fname:"userId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.userId!=null)n.writeString(t.userId);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"cname",ftype:e.STRING,fid:2}),t.cname!=null)n.writeString(t.cname);else{var a="";n.writeString(a)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"trackIds",ftype:e.LIST,fid:4}),t.trackIds!=null){n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRING,size:t.trackIds.length});for(var i of t.trackIds)n.writeString(i);n.writeListEnd()}else{var l=[];n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRING,size:l.length});for(var s of l)n.writeString(s);n.writeListEnd()}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"transactionId",ftype:e.I64,fid:5}),t.transactionId!=null)n.writeI64(BigInt(t.transactionId));else{var u="0";n.writeI64(BigInt(u))}if(n.writeFieldEnd(),t.dominantSpeakers!=null){n.writeFieldBegin({fname:"dominantSpeakers",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:6}),n.writeListBegin({etype:e.STRUCT,size:t.dominantSpeakers.length});for(var c of t.dominantSpeakers)T(c,n);n.writeListEnd(),n.writeFieldEnd()}n.writeFieldStop(),n.writeStructEnd()}function x(t,n){if(n.writeStructBegin("VideoUploadRequest"),n.writeFieldBegin({fname:"cname",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.cname!=null)n.writeString(t.cname);else{var a="";n.writeString(a)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"quality_DEPRECATED",ftype:e.I32,fid:2}),t.quality_DEPRECATED!=null){var i;n.writeI32((i=t.quality_DEPRECATED)!=null?i:0)}else{var l=o("MultiwaySharedTypes").VideoQuality.cast(0);n.writeI32(l!=null?l:0)}if(n.writeFieldEnd(),t.qualityMask!=null&&(n.writeFieldBegin({fname:"qualityMask",ftype:(e||(e=r("ThriftTypes"))).I32,fid:3}),n.writeI32(t.qualityMask),n.writeFieldEnd()),t.perSsrcTargetBitrateBpsMap!=null){n.writeFieldBegin({fname:"perSsrcTargetBitrateBpsMap",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:4}),n.writeMapBegin({ktype:e.I64,vtype:e.I64,size:Object.keys(t.perSsrcTargetBitrateBpsMap).length});for(var s of Object.entries(t.perSsrcTargetBitrateBpsMap)){var u=s[0],c=s[1];n.writeI64(BigInt(u)),n.writeI64(BigInt(c))}n.writeMapEnd(),n.writeFieldEnd()}n.writeFieldStop(),n.writeStructEnd()}function $(t,n){if(n.writeStructBegin("ReceiverBottleneck"),n.writeFieldBegin({fname:"userId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.userId!=null)n.writeString(t.userId);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"bottleneckBps",ftype:e.I32,fid:2}),t.bottleneckBps!=null)n.writeI32(t.bottleneckBps);else{var a=0;n.writeI32(a)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function P(t,n){if(n.writeStructBegin("BweDebugInfo"),n.writeFieldBegin({fname:"bottleneckUplinksByLayer",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:1}),t.bottleneckUplinksByLayer!=null){n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).I32,vtype:e.STRUCT,size:Object.keys(t.bottleneckUplinksByLayer).length});for(var o of Object.entries(t.bottleneckUplinksByLayer)){var a=o[0],i=o[1];n.writeI32(Number(a)),$(i,n)}n.writeMapEnd()}else{var l={};n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).I32,vtype:e.STRUCT,size:Object.keys(l).length});for(var s of Object.entries(l)){var u=s[0],c=s[1];n.writeI32(Number(u)),$(c,n)}n.writeMapEnd()}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function N(t,n){if(n.writeStructBegin("AudioDuplicationDebugInfo"),n.writeFieldBegin({fname:"duplicationAmount",ftype:(e||(e=r("ThriftTypes"))).I16,fid:1}),t.duplicationAmount!=null)n.writeI16(t.duplicationAmount);else{var o=0;n.writeI16(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"delayMs",ftype:e.I16,fid:2}),t.delayMs!=null)n.writeI16(t.delayMs);else{var a=0;n.writeI16(a)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function M(t,n){n.writeStructBegin("ReceiveTrackDebugInfo"),t.trackId!=null&&(n.writeFieldBegin({fname:"trackId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),n.writeString(t.trackId),n.writeFieldEnd()),t.numSimulcastLayersSupported!=null&&(n.writeFieldBegin({fname:"numSimulcastLayersSupported",ftype:(e||(e=r("ThriftTypes"))).I32,fid:2}),n.writeI32(t.numSimulcastLayersSupported),n.writeFieldEnd()),t.numSimulcastLayersAllocated!=null&&(n.writeFieldBegin({fname:"numSimulcastLayersAllocated",ftype:(e||(e=r("ThriftTypes"))).I32,fid:3}),n.writeI32(t.numSimulcastLayersAllocated),n.writeFieldEnd()),t.spatialLayerIndex!=null&&(n.writeFieldBegin({fname:"spatialLayerIndex",ftype:(e||(e=r("ThriftTypes"))).I32,fid:4}),n.writeI32(t.spatialLayerIndex),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function w(t,n){if(n.writeStructBegin("DebugInfo"),t.audioDuplicationDebugInfo!=null&&(n.writeFieldBegin({fname:"audioDuplicationDebugInfo",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:1}),N(t.audioDuplicationDebugInfo,n),n.writeFieldEnd()),t.receiveTrackDebugInfo!=null){n.writeFieldBegin({fname:"receiveTrackDebugInfo",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:2}),n.writeListBegin({etype:e.STRUCT,size:t.receiveTrackDebugInfo.length});for(var o of t.receiveTrackDebugInfo)M(o,n);n.writeListEnd(),n.writeFieldEnd()}n.writeFieldStop(),n.writeStructEnd()}function A(t,n){if(n.writeStructBegin("DominantSpeakerInfo"),n.writeFieldBegin({fname:"primarySpeakerUserId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.primarySpeakerUserId!=null)n.writeString(t.primarySpeakerUserId);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"transactionId",ftype:e.I64,fid:2}),t.transactionId!=null)n.writeI64(BigInt(t.transactionId));else{var a="0";n.writeI64(BigInt(a))}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function F(t,n){if(n.writeStructBegin("VideoUploadInfo"),t.qualityMask!=null&&(n.writeFieldBegin({fname:"qualityMask",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),n.writeI32(t.qualityMask),n.writeFieldEnd()),t.perSsrcTargetBitrateBpsMap!=null){n.writeFieldBegin({fname:"perSsrcTargetBitrateBpsMap",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:2}),n.writeMapBegin({ktype:e.I64,vtype:e.I64,size:Object.keys(t.perSsrcTargetBitrateBpsMap).length});for(var o of Object.entries(t.perSsrcTargetBitrateBpsMap)){var a=o[0],i=o[1];n.writeI64(BigInt(a)),n.writeI64(BigInt(i))}n.writeMapEnd(),n.writeFieldEnd()}n.writeFieldStop(),n.writeStructEnd()}function O(t,n){if(n.writeStructBegin("SignalingMessageToClient"),n.writeFieldBegin({fname:"signalingMessagePayload",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.signalingMessagePayload!=null)n.writeBinary(t.signalingMessagePayload);else{var o=Uint8Array.of();n.writeBinary(o)}n.writeFieldEnd(),t.version!=null&&(n.writeFieldBegin({fname:"version",ftype:(e||(e=r("ThriftTypes"))).I64,fid:2}),n.writeI64(BigInt(t.version)),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function B(t,n){if(n.writeStructBegin("SignalingMessageFromClient"),n.writeFieldBegin({fname:"signalingMessagePayload",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.signalingMessagePayload!=null)n.writeBinary(t.signalingMessagePayload);else{var o=Uint8Array.of();n.writeBinary(o)}n.writeFieldEnd(),t.version!=null&&(n.writeFieldBegin({fname:"version",ftype:(e||(e=r("ThriftTypes"))).I64,fid:2}),n.writeI64(BigInt(t.version)),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function W(t,n){if(n.writeStructBegin("SubscriptionMessageFromClient"),n.writeFieldBegin({fname:"subscriptionMessagePayload",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:1}),t.subscriptionMessagePayload!=null){n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:t.subscriptionMessagePayload.length});for(var a of t.subscriptionMessagePayload)o("MultiwaySharedSerializers").serializeSubscription(a,n);n.writeListEnd()}else{var i=[];n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:i.length});for(var l of i)o("MultiwaySharedSerializers").serializeSubscription(l,n);n.writeListEnd()}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function q(t,n){if(n.writeStructBegin("RenderResolutionMessageFromClient"),t.renderResolutionMap!=null){n.writeFieldBegin({fname:"renderResolutionMap",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:1}),n.writeMapBegin({ktype:e.STRING,vtype:e.MAP,size:Object.keys(t.renderResolutionMap).length});for(var a of Object.entries(t.renderResolutionMap)){var i=a[0],l=a[1];n.writeString(i),n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).I32,vtype:e.STRUCT,size:Object.keys(l).length});for(var s of Object.entries(l)){var u,c=s[0],d=s[1];n.writeI32((u=Number(c))!=null?u:0),o("MultiwaySharedSerializers").serializeResolutionData(d,n)}n.writeMapEnd()}n.writeMapEnd(),n.writeFieldEnd()}n.writeFieldStop(),n.writeStructEnd()}function U(t,n){if(n.writeStructBegin("RenderResolutionMessageToClient"),t.renderResolutionMap!=null){n.writeFieldBegin({fname:"renderResolutionMap",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:1}),n.writeMapBegin({ktype:e.STRING,vtype:e.MAP,size:Object.keys(t.renderResolutionMap).length});for(var a of Object.entries(t.renderResolutionMap)){var i=a[0],l=a[1];n.writeString(i),n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).I32,vtype:e.STRUCT,size:Object.keys(l).length});for(var s of Object.entries(l)){var u,c=s[0],d=s[1];n.writeI32((u=Number(c))!=null?u:0),o("MultiwaySharedSerializers").serializeResolutionData(d,n)}n.writeMapEnd()}n.writeMapEnd(),n.writeFieldEnd()}n.writeFieldStop(),n.writeStructEnd()}function V(t,n){if(n.writeStructBegin("NodeIdNotification"),n.writeFieldBegin({fname:"nodeIdToUserIdMap",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:1}),t.nodeIdToUserIdMap!=null){n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).I64,vtype:e.I64,size:Object.keys(t.nodeIdToUserIdMap).length});for(var o of Object.entries(t.nodeIdToUserIdMap)){var a=o[0],i=o[1];n.writeI64(BigInt(a)),n.writeI64(BigInt(i))}n.writeMapEnd()}else{var l={};n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).I64,vtype:e.I64,size:Object.keys(l).length});for(var s of Object.entries(l)){var u=s[0],c=s[1];n.writeI64(BigInt(u)),n.writeI64(BigInt(c))}n.writeMapEnd()}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"nodeIdToServiceTypeMap",ftype:e.MAP,fid:2}),t.nodeIdToServiceTypeMap!=null){n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).I64,vtype:e.I32,size:Object.keys(t.nodeIdToServiceTypeMap).length});for(var d of Object.entries(t.nodeIdToServiceTypeMap)){var m=d[0],p=d[1];n.writeI64(BigInt(m)),n.writeI32(p!=null?p:0)}n.writeMapEnd()}else{var _={};n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).I64,vtype:e.I32,size:Object.keys(_).length});for(var f of Object.entries(_)){var g=f[0],h=f[1];n.writeI64(BigInt(g)),n.writeI32(h!=null?h:0)}n.writeMapEnd()}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function H(t,n){n.writeStructBegin("DataMessageBody"),t.genericMessage!=null&&(n.writeFieldBegin({fname:"genericMessage",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:1}),o("WebrtcSignalingCommonSerializers").serializeGenericDataMessage(t.genericMessage,n),n.writeFieldEnd()),t.dominantSpeakerNotification!=null&&(n.writeFieldBegin({fname:"dominantSpeakerNotification",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:2}),D(t.dominantSpeakerNotification,n),n.writeFieldEnd()),t.videoUploadRequest!=null&&(n.writeFieldBegin({fname:"videoUploadRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:3}),x(t.videoUploadRequest,n),n.writeFieldEnd()),t.dominantSpeakerSignalingInfo!=null&&(n.writeFieldBegin({fname:"dominantSpeakerSignalingInfo",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:4}),A(t.dominantSpeakerSignalingInfo,n),n.writeFieldEnd()),t.bweDebugInfo!=null&&(n.writeFieldBegin({fname:"bweDebugInfo",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:5}),P(t.bweDebugInfo,n),n.writeFieldEnd()),t.debugInfo!=null&&(n.writeFieldBegin({fname:"debugInfo",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:6}),w(t.debugInfo,n),n.writeFieldEnd()),t.videoUploadSignalingInfo!=null&&(n.writeFieldBegin({fname:"videoUploadSignalingInfo",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:7}),F(t.videoUploadSignalingInfo,n),n.writeFieldEnd()),t.signalingMessageToClient!=null&&(n.writeFieldBegin({fname:"signalingMessageToClient",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:8}),O(t.signalingMessageToClient,n),n.writeFieldEnd()),t.signalingMessageFromClient!=null&&(n.writeFieldBegin({fname:"signalingMessageFromClient",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:9}),B(t.signalingMessageFromClient,n),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function G(t,n){if(n.writeStructBegin("DataMessage"),n.writeFieldBegin({fname:"header",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:1}),t.header!=null)I(t.header,n);else{var o=s();I(o,n)}n.writeFieldEnd(),t.data_DEPRECATED!=null&&(n.writeFieldBegin({fname:"data_DEPRECATED",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeBinary(t.data_DEPRECATED),n.writeFieldEnd()),t.body!=null&&(n.writeFieldBegin({fname:"body",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:3}),H(t.body,n),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function z(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).STRING?n.sender=t.readString():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).STRING?n.topic_DEPRECATED=t.readString():t.skip(i);break;case 3:if(i===(e||(e=r("ThriftTypes"))).SET){n.recipients=new Set;for(var s=t.readSetBegin(),u=0;u<s.size;u++){var c=t.readString();n.recipients.add(c)}}else t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).I32?n.serviceSender=o("MultiwaySharedTypes").EndpointServiceType.cast(t.readI32()):t.skip(i);break;case 5:if(i===(e||(e=r("ThriftTypes"))).SET){n.serviceRecipients=new Set;for(var d=t.readSetBegin(),m=0;m<d.size;m++){var p=o("MultiwaySharedTypes").EndpointServiceType.cast(t.readI32());n.serviceRecipients.add(p)}}else t.skip(i);break;case 6:i===(e||(e=r("ThriftTypes"))).BOOL?n.shouldSendToAllUsers=t.readBool():t.skip(i);break;case 7:i===(e||(e=r("ThriftTypes"))).STRING?n.senderE2eeId=t.readBinary():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.topic_DEPRECATED===void 0&&(n.topic_DEPRECATED=""),n}function j(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.userId=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.userId===void 0&&(n.userId=""),n}function K(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.userId=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.cname=t.readString():t.skip(a);break;case 4:if(a===(e||(e=r("ThriftTypes"))).LIST){n.trackIds=[];for(var l=t.readListBegin(),s=0;s<l.size;s++){var u=t.readString();n.trackIds.push(u)}}else t.skip(a);break;case 5:a===(e||(e=r("ThriftTypes"))).I64?n.transactionId=t.readI64().toString():t.skip(a);break;case 6:if(a===(e||(e=r("ThriftTypes"))).LIST){n.dominantSpeakers=[];for(var c=t.readListBegin(),d=0;d<c.size;d++){var m=j(t);n.dominantSpeakers.push(m)}}else t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.userId===void 0&&(n.userId=""),n.cname===void 0&&(n.cname=""),n.trackIds===void 0&&(n.trackIds=[]),n.transactionId===void 0&&(n.transactionId="0"),n}function Q(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).STRING?n.cname=t.readString():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).I32?n.quality_DEPRECATED=o("MultiwaySharedTypes").VideoQuality.cast(t.readI32()):t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).I32?n.qualityMask=t.readI32():t.skip(i);break;case 4:if(i===(e||(e=r("ThriftTypes"))).MAP){n.perSsrcTargetBitrateBpsMap={};for(var s=t.readMapBegin(),u=0;u<s.size;u++){var c=t.readI64().toString(),d=t.readI64().toString();n.perSsrcTargetBitrateBpsMap[c]=d}}else t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.cname===void 0&&(n.cname=""),n.quality_DEPRECATED===void 0&&(n.quality_DEPRECATED=o("MultiwaySharedTypes").VideoQuality.cast(0)),n}function X(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.userId=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).I32?n.bottleneckBps=t.readI32():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.userId===void 0&&(n.userId=""),n.bottleneckBps===void 0&&(n.bottleneckBps=0),n}function Y(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:if(a===(e||(e=r("ThriftTypes"))).MAP){n.bottleneckUplinksByLayer={};for(var l=t.readMapBegin(),s=0;s<l.size;s++){var u=t.readI32(),c=X(t);n.bottleneckUplinksByLayer[u]=c}}else t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.bottleneckUplinksByLayer===void 0&&(n.bottleneckUplinksByLayer={}),n}function J(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).I16?n.duplicationAmount=t.readI16():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).I16?n.delayMs=t.readI16():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.duplicationAmount===void 0&&(n.duplicationAmount=0),n.delayMs===void 0&&(n.delayMs=0),n}function Z(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.trackId=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).I32?n.numSimulcastLayersSupported=t.readI32():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).I32?n.numSimulcastLayersAllocated=t.readI32():t.skip(a);break;case 4:a===(e||(e=r("ThriftTypes"))).I32?n.spatialLayerIndex=t.readI32():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n}function ee(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRUCT?n.audioDuplicationDebugInfo=J(t):t.skip(a);break;case 2:if(a===(e||(e=r("ThriftTypes"))).LIST){n.receiveTrackDebugInfo=[];for(var l=t.readListBegin(),s=0;s<l.size;s++){var u=Z(t);n.receiveTrackDebugInfo.push(u)}}else t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n}function te(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.primarySpeakerUserId=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).I64?n.transactionId=t.readI64().toString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.primarySpeakerUserId===void 0&&(n.primarySpeakerUserId=""),n.transactionId===void 0&&(n.transactionId="0"),n}function ne(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).I32?n.qualityMask=t.readI32():t.skip(a);break;case 2:if(a===(e||(e=r("ThriftTypes"))).MAP){n.perSsrcTargetBitrateBpsMap={};for(var l=t.readMapBegin(),s=0;s<l.size;s++){var u=t.readI64().toString(),c=t.readI64().toString();n.perSsrcTargetBitrateBpsMap[u]=c}}else t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n}function re(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.signalingMessagePayload=t.readBinary():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).I64?n.version=t.readI64().toString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.signalingMessagePayload===void 0&&(n.signalingMessagePayload=Uint8Array.of()),n}function oe(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.signalingMessagePayload=t.readBinary():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).I64?n.version=t.readI64().toString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.signalingMessagePayload===void 0&&(n.signalingMessagePayload=Uint8Array.of()),n}function ae(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:if(i===(e||(e=r("ThriftTypes"))).LIST){n.subscriptionMessagePayload=[];for(var s=t.readListBegin(),u=0;u<s.size;u++){var c=o("MultiwaySharedSerializers").deserializeSubscription(t);n.subscriptionMessagePayload.push(c)}}else t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.subscriptionMessagePayload===void 0&&(n.subscriptionMessagePayload=[]),n}function ie(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:if(i===(e||(e=r("ThriftTypes"))).MAP){n.renderResolutionMap={};for(var s=t.readMapBegin(),u=0;u<s.size;u++){for(var c=t.readString(),d={},m=t.readMapBegin(),p=0;p<m.size;p++){var _=o("MultiwaySharedTypes").RenderedStreamType.cast(t.readI32()),f=o("MultiwaySharedSerializers").deserializeResolutionData(t);_!=null&&(d[_]=f)}n.renderResolutionMap[c]=d}}else t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n}function le(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:if(i===(e||(e=r("ThriftTypes"))).MAP){n.renderResolutionMap={};for(var s=t.readMapBegin(),u=0;u<s.size;u++){for(var c=t.readString(),d={},m=t.readMapBegin(),p=0;p<m.size;p++){var _=o("MultiwaySharedTypes").RenderedStreamType.cast(t.readI32()),f=o("MultiwaySharedSerializers").deserializeResolutionData(t);_!=null&&(d[_]=f)}n.renderResolutionMap[c]=d}}else t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n}function se(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:if(i===(e||(e=r("ThriftTypes"))).MAP){n.nodeIdToUserIdMap={};for(var s=t.readMapBegin(),u=0;u<s.size;u++){var c=t.readI64().toString(),d=t.readI64().toString();n.nodeIdToUserIdMap[c]=d}}else t.skip(i);break;case 2:if(i===(e||(e=r("ThriftTypes"))).MAP){n.nodeIdToServiceTypeMap={};for(var m=t.readMapBegin(),p=0;p<m.size;p++){var _=t.readI64().toString(),f=o("MultiwaySharedTypes").EndpointServiceType.cast(t.readI32());n.nodeIdToServiceTypeMap[_]=f}}else t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.nodeIdToUserIdMap===void 0&&(n.nodeIdToUserIdMap={}),n.nodeIdToServiceTypeMap===void 0&&(n.nodeIdToServiceTypeMap={}),n}function ue(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).STRUCT?n.genericMessage=o("WebrtcSignalingCommonSerializers").deserializeGenericDataMessage(t):t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).STRUCT?n.dominantSpeakerNotification=K(t):t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).STRUCT?n.videoUploadRequest=Q(t):t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).STRUCT?n.dominantSpeakerSignalingInfo=te(t):t.skip(i);break;case 5:i===(e||(e=r("ThriftTypes"))).STRUCT?n.bweDebugInfo=Y(t):t.skip(i);break;case 6:i===(e||(e=r("ThriftTypes"))).STRUCT?n.debugInfo=ee(t):t.skip(i);break;case 7:i===(e||(e=r("ThriftTypes"))).STRUCT?n.videoUploadSignalingInfo=ne(t):t.skip(i);break;case 8:i===(e||(e=r("ThriftTypes"))).STRUCT?n.signalingMessageToClient=re(t):t.skip(i);break;case 9:i===(e||(e=r("ThriftTypes"))).STRUCT?n.signalingMessageFromClient=oe(t):t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n}function ce(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRUCT?n.header=z(t):t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.data_DEPRECATED=t.readBinary():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).STRUCT?n.body=ue(t):t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.header===void 0&&(n.header=s()),n}l.DataHeader$DefaultConstructor=s,l.SpeakerDetail$DefaultConstructor=u,l.DominantSpeakerNotification$DefaultConstructor=c,l.VideoUploadRequest$DefaultConstructor=d,l.ReceiverBottleneck$DefaultConstructor=m,l.BweDebugInfo$DefaultConstructor=p,l.AudioDuplicationDebugInfo$DefaultConstructor=_,l.ReceiveTrackDebugInfo$DefaultConstructor=f,l.DebugInfo$DefaultConstructor=g,l.DominantSpeakerInfo$DefaultConstructor=h,l.VideoUploadInfo$DefaultConstructor=y,l.SignalingMessageToClient$DefaultConstructor=C,l.SignalingMessageFromClient$DefaultConstructor=b,l.SubscriptionMessageFromClient$DefaultConstructor=v,l.RenderResolutionMessageFromClient$DefaultConstructor=S,l.RenderResolutionMessageToClient$DefaultConstructor=R,l.NodeIdNotification$DefaultConstructor=L,l.DataMessageBody$DefaultConstructor=E,l.DataMessage$DefaultConstructor=k,l.serializeDataHeader=I,l.serializeSpeakerDetail=T,l.serializeDominantSpeakerNotification=D,l.serializeVideoUploadRequest=x,l.serializeReceiverBottleneck=$,l.serializeBweDebugInfo=P,l.serializeAudioDuplicationDebugInfo=N,l.serializeReceiveTrackDebugInfo=M,l.serializeDebugInfo=w,l.serializeDominantSpeakerInfo=A,l.serializeVideoUploadInfo=F,l.serializeSignalingMessageToClient=O,l.serializeSignalingMessageFromClient=B,l.serializeSubscriptionMessageFromClient=W,l.serializeRenderResolutionMessageFromClient=q,l.serializeRenderResolutionMessageToClient=U,l.serializeNodeIdNotification=V,l.serializeDataMessageBody=H,l.serializeDataMessage=G,l.deserializeDataHeader=z,l.deserializeSpeakerDetail=j,l.deserializeDominantSpeakerNotification=K,l.deserializeVideoUploadRequest=Q,l.deserializeReceiverBottleneck=X,l.deserializeBweDebugInfo=Y,l.deserializeAudioDuplicationDebugInfo=J,l.deserializeReceiveTrackDebugInfo=Z,l.deserializeDebugInfo=ee,l.deserializeDominantSpeakerInfo=te,l.deserializeVideoUploadInfo=ne,l.deserializeSignalingMessageToClient=re,l.deserializeSignalingMessageFromClient=oe,l.deserializeSubscriptionMessageFromClient=ae,l.deserializeRenderResolutionMessageFromClient=ie,l.deserializeRenderResolutionMessageToClient=le,l.deserializeNodeIdNotification=se,l.deserializeDataMessageBody=ue,l.deserializeDataMessage=ce}),98);
__d("DataMessageTypes",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum")({OK:200,NOT_FOUND:404});a.exports={DataMessageStatusCode:e}}),null);
__d("HorizonWebMqttChannel",["CurrentUser","MqttChannel","MqttEnv","MqttEnvInitializer","MqttWebConfig"],(function(t,n,r,o,a,i,l){"use strict";r("MqttEnvInitializer").initialize();function e(){var e;return o("MqttEnv").setIsUserLoggedInNow(r("CurrentUser").isLoggedIn),new(r("MqttChannel"))({appId:(e=r("MqttWebConfig")).appID,capabilities:e.capabilities,chatVisibility:!0,clientCapabilities:e.clientCapabilities,endpoint:e.endpoint,initialSubscribedTopics:e.subscribedTopics,pageId:null,phpOverride:e.hostNameOverride,pollingEndpoint:e.pollingEndpoint,userFbid:e.fbid})}var s=null;function u(){return s==null&&(s=e()),s}function c(){s!=null&&(s.shutdown(),s=null)}l.getHorizonWebMqttChannelInstance=u,l.shutdownAndClear=c}),98);
__d("IGDOverLSMqttChannel",["CurrentUser","Env","MqttChannel","MqttEnv","MqttEnvInitializer","MqttWebConfig","Promise"],(function(t,n,r,o,a,i,l){"use strict";var e,s;r("MqttEnvInitializer").initialize();function u(e){o("MqttEnv").setIsUserLoggedInNow(r("CurrentUser").isLoggedIn);var t=r("CurrentUser").getAppID()==null?936619743392459:Number(r("CurrentUser").getAppID());return new(r("MqttChannel"))({appId:t,capabilities:r("MqttWebConfig").capabilities,chatVisibility:!0,clientCapabilities:r("MqttWebConfig").clientCapabilities,clientType:"cookie_auth",deviceId:e,endpoint:(s||(s=r("Env"))).ig_mqtt_wss_endpoint||"wss://edge-chat.instagram.com/chat",initialSubscribedTopics:r("MqttWebConfig").subscribedTopics,phpOverride:r("MqttWebConfig").hostNameOverride,pollingEndpoint:(s||(s=r("Env"))).ig_mqtt_polling_endpoint||"https://edge-chat.instagram.com/mqtt/pull",userFbid:r("CurrentUser").getPossiblyNonFacebookUserID()})}var c=null,d;function m(e){c==null&&(c=u(e));var t=c;return d==null||d(t),t}function p(){return new(e||(e=n("Promise")))(function(e){c?e(m()):d=function(n){e(n)}})}function _(){c!=null&&(c.shutdown(),c=null)}l.getInstance=m,l.waitAndGetInstance=p,l.shutdownAndClear=_}),98);
__d("LiveChatWidgetMqttChannel",["MqttChannel","MqttEnv","MqttEnvInitializer","MqttWebConfig"],(function(t,n,r,o,a,i,l){"use strict";r("MqttEnvInitializer").initialize();function e(){var e;return o("MqttEnv").setIsUserLoggedInNow(function(){return!0}),new(r("MqttChannel"))({appId:0x70127cc7da0a0,capabilities:(e=r("MqttWebConfig")).capabilities,chatVisibility:!1,clientCapabilities:e.clientCapabilities,endpoint:e.endpoint,initialSubscribedTopics:e.subscribedTopics,pageId:null,phpOverride:e.hostNameOverride,pollingEndpoint:e.pollingEndpoint,userFbid:e.fbid})}var s=null;function u(){return s==null&&(s=e()),s}function c(){s!=null&&(s.shutdown(),s=null)}l.getLiveChatWidgetMqttChannelInstance=u,l.shutdownAndClear=c}),98);
__d("MDCMqttChannel",["CurrentUser","MqttChannel","MqttEnv","MqttEnvInitializer","MqttWebConfig","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";r("MqttEnvInitializer").initialize();function e(e){o("MqttEnv").setIsUserLoggedInNow(r("CurrentUser").isLoggedIn);var t=r("CurrentUser").getAppID()==null?0xc7269b363f3c:Number(r("CurrentUser").getAppID());return new(r("MqttChannel"))({appId:t,capabilities:r("MqttWebConfig").capabilities,chatVisibility:!0,clientCapabilities:r("MqttWebConfig").clientCapabilities,clientType:"websocket",deviceId:r("uuidv4")(),endpoint:r("MqttWebConfig").endpoint,initialSubscribedTopics:r("MqttWebConfig").subscribedTopics,phpOverride:r("MqttWebConfig").hostNameOverride,pollingEndpoint:r("MqttWebConfig").pollingEndpoint,userFbid:r("CurrentUser").getPossiblyNonFacebookUserID()})}var s=null;function u(t){return s==null&&(s=e(t)),s}function c(){return s}function d(){s!=null&&(s.shutdown(),s=null)}l.getMDCMqttChannelInstance=u,l.getMDCMqttChannelInstanceDoNotCreate=c,l.shutdownAndClear=d}),98);
__d("MqttThriftHeaderSerializers",["ThriftTypes"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){return{}}function u(t,n){n.writeStructBegin("MqttThriftHeader"),t.traceInfo!=null&&(n.writeFieldBegin({fname:"traceInfo",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),n.writeString(t.traceInfo),n.writeFieldEnd()),t.coreContextRequestId!=null&&(n.writeFieldBegin({fname:"coreContextRequestId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeString(t.coreContextRequestId),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function c(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.traceInfo=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.coreContextRequestId=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n}l.MqttThriftHeader$DefaultConstructor=s,l.serializeMqttThriftHeader=u,l.deserializeMqttThriftHeader=c}),98);
__d("MultiwayCommonTypes",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e,l=(e=n("$InternalEnum"))({STRING:0,THRIFT:1,BOTH:2}),s=e({OK:200,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,METHOD_NOT_ALLOWED:406,CONFLICT:409,CONDITIONAL_REQUEST_FAILED:412,SERVER_INTERNAL_ERROR:500,SERVICE_UNAVAILABLE:503}),u=e({UNKNOWN:1e3,EXCEEDED_MAX_ALLOWED_PARTICIPANTS:1001,MEMBERSHIP_CHECK_FAIL:1002,CONFERENCE_THROTTLED:1003,ENDPOINT_THROTTLED:1004,MWS_MESSAGE_SENT_TO_INCORRECT_REGION:1005,UNSUPPORTED_REQUEST_TYPE:2e3,CLIENT_REQUEST_UNACCEPTABLE:2001,CLIENT_RESPONSE_UNACCEPTABLE:2002,RING_RESPONSE_BODY_NOT_SET:2004,SERVER_MEDIA_UPDATE_RESPONSE_BODY_NOT_SET:2005,INVALID_SDP:2006,INVALID_CONFERENCE_NAME:2007,SERVER_INFO_CONFERENCE_NAME_MISMATCH:2008,INVALID_USER_ID:2009,INCORRECT_VERSION_RANGE:2010,SENDER_ID_MISMATCH:2011,RECIPIENT_NOT_SPECIFIED:2012,FIELD_NOT_ALLOWED:2013,USERS_NOT_SPECIFIED:2015,REQUEST_UNACCEPTABLE_FOR_ENDPOINT_STATE:2016,INVALID_CALL_ID:2017,SESSION_DESCRIPTION_ID_MISMATCH:2018,EMPTY_CLIENT_MEDIA_UPDATES:2019,INVALID_SERVER_INFO_DATA:2020,INCORRECT_STATE_VERSION:2021,MISMATCHED_STATE_FOR_VERSION:2022,INVALID_STATE_VERSION:2023,NO_RESOLVER_FOUND:2024,MISSING_APPROVERLIST:2025,FULL_SDP_REQUIRED_IN_APPROVED_STATE:2026,INVALID_BROADCAST_ID:2027,INVALID_ENDPOINT_CONFIG:2028,INVALID_E2EE_STATE:2029,SFU_MODE_PREVENTED:2030,INVALID_CONFERENCE_STATE:2031,JOIN_REQUEST_DENIED:2032,EMPTY_USER_IDS:2033,MISSING_SDP_CONNECT_REQUEST:2034,CALLER_HAS_APPEALABLE_CALLING_RESTRICTION:2035,MISSING_BODY_ENDPOINT:2101,MISSING_BODY_HEADER:2102,MISSING_BODY_BODY:2103,MISSING_BODY_PARAMS:2104,MISSING_BODY_REMOVE_PARTICIPANTS_REQUEST:2105,MISSING_BODY_DATA_MESSAGE_REQUEST:2106,MISSING_BODY_CLIENT_MEDIA_UPDATE_REQUEST:2107,MISSING_BODY_ADD_PARTICIPANTS_REQUEST:2108,MISSING_BODY_SUBSCRIPTION_REQUEST:2110,MISSING_BODY_JOIN_REQUEST:2111,MISSING_BODY_HANGUP_REQUEST:2112,MISSING_BODY_ICE_CANDIDATE_REQUEST:2113,MISSING_BODY_P2P_MESSAGE_REQUEST:2114,MISSING_BODY_UPDATE_REQUEST:2115,MISSING_BODY_CLIENT_EVENT_REQUEST:2116,MISSING_BODY_CONNECT_REQUEST:2117,MISSING_BODY_UNSUBSCRIBE_REQUEST:2118,MISSING_BODY_APPROVAL_REQUEST:2119,MISSING_ENDPOINT_USER_ID:2120,EMPTY_ENDPOINT_USER_ID:2121,MISSING_BODY_TRANSFER_REQUEST:2122,MISSING_BODY_GENERIC:2199,REQUESTOR_NOT_MEMBER_CONFERENCE:3002,NOT_BROADCAST_OWNER:3003,GUEST_NOT_INVITED:3004,GUEST_DISCONNECTED:3005,GUEST_INVITATION_EXPIRED:3006,PARTICIPANT_IN_PENDING_APPROVAL_STATE:3008,INVALID_MULTIWAY_PARAMS:3009,BROADCAST_ALREADY_STOPPED:4002,FAILED_TO_GENERATE_SDP_ANSWER:4003,FAILED_GENERATE_SESSION_DESCRIPTION:4004,SDP_SESSION_ID_MISMATCH:4005,MEDIA_ENDPOINT_GONE:4007,MEDIA_ENDPOINT_ALREADY_EXISTS:4008,MEDIA_ENDPOINT_EXISTS_DIFFERENT_SESSION_ID:4009,LEGACY_MESSENGER_SENDER_UNSET:4010,FAILED_TO_SET_TRANSPORT_INFO:4011,NON_PRIMARY_MULTIWAY_SERVER:4012,FAILED_TO_GET_REMOTE_DESCRIPTION:4013,LOCAL_DESCRIPTION_NOT_SET:4014,INVALID_SDP_TYPE:4015,CLIENT_MEDIA_UPDATE_WITHOUT_REMOTE_SDP_INFO:4016,SDP_UNSET_ON_P2P_ANSWER:4017,MISSING_ICE_CANDIDATE_PAYLOAD:4018,P2P_PROTOCOL_UNSET:4019,CREATE_ACK_FOR_INVALID_MESSAGE_TYPE:4020,LEGACY_CLIENT_CANNOT_JOIN_SFU_MODE:4021,CONNECT_UNSUPPORTED_IN_SFU_MODE:4022,CONNECT_UNSUPPORTED_FOR_JOINED_ENDPOINTS:4023,RESOLVE_STATE_API_ERROR:4024,EXTERNAL_RESOLUTION_ERROR:4025,INTERNAL_RESOLUTION_ERROR:4026,RESOLUTION_DISABLED:4027,BROADCAST_ID_MISSING:4028,SDP_UNSET_ON_P2P_OFFER:4029,LEGACY_OFFER_MISSING_REQUIRED_VALUE:4031,MEDIA_SERVER_STATE_SYNC_DESERIALIZATION_ERROR:4032,CONNECT_UNSUPPORTED_FOR_PRECONNECTED_USERS:4033,OTHER_USER_ANSWERED_THE_CALL:4034,MEDIA_SERVER_DESERIALIZATION_ERROR:4035,REMOTE_SDP_TRACKID_MISMATCH:4036,SIGNALING_MESSAGE_TO_CLIENT_DROPPED:4037,DATA_CHANNEL_ENDPOINT_GONE:4038,DATA_CHANNEL_ENDPOINT_ALREADY_EXISTS:4039,CONNECT_UNSUPPORTED_DURING_P2P_TO_SFU_ESCALATION:4040,P2P_CONNECT_UNSUPPORTED_AFTER_SFU_ESCALATION:4041,CONNECT_EXCEEDED_MAX_ALLOWED_ENDPOINTS_PER_CONFERENCE:4042,CONNECT_EXCEEDED_MAX_ALLOWED_ENDPOINTS_PER_USER:4043,REQUEST_TIMEOUT:4044,TOO_MANY_MEDIA_TRACKS_IN_SDP:4045,CONFERENCE_NOT_FOUND:5001,CONFERENCE_IS_TERMINATING:5002,CONFERENCE_IS_TERMINATED:5003,CONFERENCE_NAME_EMPTY:5004,NONCE_EMPTY:5005,NONCE_MISMATCH:5006,CONFERENCE_HAS_GONE:5007,PARTICIPANT_HAS_GONE:5008,MEDIA_SERVER_NOT_FOUND:5009,CLIENT_TERMINATED:5010,JOIN_SESSION_RESULT_MISSING:5012,LOGGING_POLICY_RESULT_MISSING:5013,INVITE_USERS_RESULT_MISSING:5014,STATE_SYNC_RESULT_MISSING:5015,ENDPOINT_INFO_RESULT_MISSING:5016,CONFERENCE_NAME_MISMATCH:5017,UNEXPECTED_TRANSPORT_PARAMS_CONFERENCE_NAME:5018,SESSION_CONFIGURATION_RESULT_MISSING:5019,REMOVE_USERS_RESULT_MISSING:5020,MEDIA_CODECS_UNSUPPORTED_BY_CONFERENCE:6001,CONFERENCE_INCAPABLE_RENEGOTIATION:6002,REJECTING_CMU_WHEN_SMU_PENDING:6003,PARTICIPANT_NOT_SUBSCRIBED_TO_TOPIC:6004,PARTICIPANT_ALREADY_IN_WAITING_ROOM:6005,PARTICIPANT_NOT_IN_PENDING_APPROVAL:6006,USER_NOT_APPROVER_FOR_TARGET_USER:6007,UNSUPPORTED_CAPABILITIES:6008,PRODUCT_SERVER_DEFINED_END_REASON:6009,WWW_KILLSWITCHED_REQUEST:6010,CONFLICTING_MEDIA_PATH:6011,CONFLICTING_MEDIA_STATUS:6012,CONFLICTING_SESSION_DESCRIPTION:6013,OK:9e3}),c=e({NONE:0,INFO:1,ERROR:2}),d=e({SUCCESS:0,ERROR:1,SESSION_NOT_FOUND:10,SESSION_MISMATCH:11,SESSION_TERMINATING:12,CONNECTION_ALREADY_EXIST:20,CONNECTION_OLD_EXIST:21,CONNECTION_NOT_FOUND:23,CONNECTION_MISMATCH:24,SDP_INVALID:30,SDP_NEGOTIATION_FAILED:31,EXCEEDED_MAX_PARTICIPANT_COUNT:40,UNAUTHORIZED:50}),m=e({JOIN:0,SERVER_MEDIA_UPDATE:1,HANGUP:2,ICE_CANDIDATE:3,RING:4,DISMISS:5,CONFERENCE_STATE:6,ADD_PARTICIPANTS:7,SUBSCRIPTION:8,CLIENT_MEDIA_UPDATE:9,DATA_MESSAGE:10,REMOVE_PARTICIPANTS:11,PING:18,UPDATE:20,NOTIFY:21,CONNECT:22,CLIENT_EVENT:23,UNSUBSCRIBE:25,APPROVAL:26,TRANSFER:27,WAKEUP:28}),p=e({IGNORE_CALL:0,HANGUP_CALL:1,NO_ANSWER_TIMEOUT:2,CLIENT_ERROR:3,IN_ANOTHER_CALL:4,CLIENT_INTERRUPTED:5,SESSION_MIGRATED:6,E2EE_MANDATED_BUT_OFFER_DID_NOT_CONTAIN_E2EE:7,E2EE_MANDATED_BUT_ANSWER_DID_NOT_NEGOTIATE_E2EE:8,WEBRTC_ERROR:9,CONNECTION_DROPPED:10}),_=e({CALL_ENDED:0,ANSWERED_ON_ANOTHER_DEVICE:1,IN_ANOTHER_CALL:2,CONNECTION_DROPPED:3,REJECTED_ON_ANOTHER_DEVICE:4,REMOVED_BY_PARTICIPANT:5,REJECTED_BY_CALLEE:6,INTERNAL_ERROR:7,CALL_ENDED_BY_PRODUCT:9,JOIN_APPROVAL_DENIED:10,JOIN_APPROVAL_TIMEDOUT:11,UNSUPPORTED_VERSION:12,LIVE_NOT_ACKED:13,TX_ACK_TIMEDOUT:14,ANSWERED_BY_OTHER_USER:15,PARTICIPANT_SELF_TERMINATION:16,PARTICIPANT_REJOIN:17,LONG_LASTING_AUDIO_ISSUE:18,PRIMARY_ENDPOINT_HANGUP:19,RECONNECT_FAILED:20,E2EE_HARDENING_ERROR:21,CALL_ENDED_BY_EXTENSION:22,CALL_ENDED_BY_OVER_CAPACITY:23}),f=e({SUPPORT_AUDIO_DEPRECATED:0,SUPPORT_VIDEO_DEPRECATED:1,SUPPORT_EXPERIMENTS_IN_JOIN_RESPONSE:2,SUPPORT_NEW_PARTICIPANT_STATES:3,SUPPORT_SDP_RENEGOTIATION:4,SUPPORT_MWPP:5,REQUIRE_FULL_SDP_IN_SMU:6,SUPPORT_PRECONNECT:7,SUPPORT_MWPP_DEESCALATION:8,SUPPORT_PARTICIPANT_STATE_UNCALLABLE:9,SUPPORT_MULTIPLE_VIDEO_STREAMS:10,REQUIRE_FULL_SDP_IN_SMU_OPTIMIZED:11,SUPPORT_MULTISTREAM_FEC:12,SUPPORT_DELTA_SMU:13,REQUIRE_DEFAULT_CHANNEL_SCREENSHARE:14,SUPPORT_SCREENSHARE_FLAG_IN_JOIN_RESPONSE_AND_SMU:15,SUPPORT_TEMPORAL_LAYER_JBE:16,REQUIRES_P2P_RELAY_INFO_VIA_SIGNALING:17,SUPPORT_NUMERIC_TOPICS:18,SUPPORT_PSEUDO_QUIC_CONNECTION:19,SUPPORT_SDP_SENDRECV:20}),g=e({GROUP_AUDIO_CALL:0,PEER_VIDEO_CALL:1,PEER_AUDIO_CALL:2,GROUP_VIDEO_CALL:3,LIVE_STREAM:4,PEER_ESCALATED_VIDEO_CALL:5,PEER_ESCALATED_AUDIO_CALL:6,LIVE_AUDIO_ROOM:7,LIVE_WITH_ROOM:8}),h=e({OK:0,NOT_SUPPORTED:1,IN_ANOTHER_CALL:10}),y=e({ACTIVE:0,TERMINATED:1}),C=e({UNKNOWN:0,ACTIVE:1,TERMINATED:2}),b=e({DENIED:0,APPROVED:1}),v=e({UNKNOWN:0,SIGNALING_DATA_MESSAGE:1,STATE_SYNC_UPDATE:2,STATE_SYNC_SNAPSHOT:3}),S=e({UNKNOWN:0,DISCONNECTED:1,NO_ANSWER:2,REJECTED:3,UNREACHABLE:4,CONNECTION_DROPPED:5,CONTACTING:6,RINGING:7,CONNECTING:8,CONNECTED:9,PARTICIPANT_LIMIT_REACHED:10,IN_ANOTHER_CALL:11,RING_TYPE_UNSUPPORTED:12,PENDING_APPROVAL:13,APPROVED:14,FAILED_APPROVAL:15,HANGUP_IN_WAITING_ROOM:16,UNCALLABLE:17,UNCALLABLE_DELAYED:18}),R=e({PRANSWER:1001,INITIAL_ANSWER_TO_P2P_CALLER:1002,DEESCALATE_OFFER_TO_P2P_CALLEE:1003,DEESCALATE_ANSWER_TO_P2P_CALLER:1004,REQUEST_DEESCALATE_TO_P2P_CALLER:1005,REQUEST_ESCALATE:1006,REQUEST_CLIENT_FULL_RENEGOTIATION_TO_ADMIT_FROM_WAITINGROOM:1007,REQUEST_CLIENT_FULL_RENEGOTIATION_AGAINST_MWS:1008,PARTICIPANT_ADDED:1009,PARTICIPANT_REMOVED:1010,FIRST_REMOTE_ALERTED_FOR_INITIATOR:2001,FIRST_REMOTE_ANSWERED_FOR_INITIATOR:2002,CONTAIN_PENDING_APPROVAL_PARTICIPANTS:2003,KEEP_ALIVE_PING:3001,IS_INITIATOR:4001,PREGEN_SDP:4002}),L=e({PRIMARY:0,SECONDARY:1}),E=e({UNKNOWN:0,MEDIA_CONNECTED:1}),k=e({JoinRequest:"joinRequest",JoinResponse:"joinResponse",ServerMediaUpdateRequest:"serverMediaUpdateRequest",ServerMediaUpdateResponse:"serverMediaUpdateResponse",HangupRequest:"hangupRequest",IceCandidateRequest:"iceCandidateRequest",RingRequest:"ringRequest",RingResponse:"ringResponse",DismissRequest:"dismissRequest",ConferenceStateRequest:"conferenceStateRequest",ConferenceStateResponse:"conferenceStateResponse",AddParticipantsRequest:"addParticipantsRequest",SubscriptionRequest:"subscriptionRequest",ClientMediaUpdateRequest:"clientMediaUpdateRequest",ClientMediaUpdateResponse:"clientMediaUpdateResponse",DataMessageRequest:"dataMessageRequest",RemoveParticipantsRequest:"removeParticipantsRequest",DataMessageResponse:"dataMessageResponse",UpdateRequest:"updateRequest",UpdateResponse:"updateResponse",NotifyRequest:"notifyRequest",NotifyResponse:"notifyResponse",ConnectRequest:"connectRequest",ConnectResponse:"connectResponse",ClientEventRequest:"clientEventRequest",ClientEventResponse:"clientEventResponse",UnsubscribeRequest:"unsubscribeRequest",UnsubscribeResponse:"unsubscribeResponse",ApprovalRequest:"approvalRequest",TransferRequest:"transferRequest"});a.exports={ApprovalStatus:b,Capability:f,ClientEventType:E,DeviceStatus:h,DismissReason:_,E2eeDataMessageType:v,ExtensionSessionStatus:C,HangupReason:p,JoinMode:L,MediaConnectionStatus:y,MessageTag:R,MessageType:m,ParticipantCallState:S,RingType:g,RtcApiStatusCode:d,RtcLogSeverity:c,RtcMessageBodyVariant$Types:k,RtcResponseStatusCode:s,RtcResponseSubCode:u,SdpPayloadType:l}}),null);
__d("StateSyncSerializers",["ThriftTypes"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){return{version:0}}function u(){return{stateStore:{}}}function c(t,n){if(n.writeStructBegin("State"),n.writeFieldBegin({fname:"version",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),t.version!=null)n.writeI32(t.version);else{var o=0;n.writeI32(o)}n.writeFieldEnd(),t.data!=null&&(n.writeFieldBegin({fname:"data",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeBinary(t.data),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function d(t,n){if(n.writeStructBegin("Snapshot"),n.writeFieldBegin({fname:"stateStore",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:1}),t.stateStore!=null){n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).STRING,vtype:e.STRUCT,size:Object.keys(t.stateStore).length});for(var o of Object.entries(t.stateStore)){var a=o[0],i=o[1];n.writeString(a),c(i,n)}n.writeMapEnd()}else{var l={};n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).STRING,vtype:e.STRUCT,size:Object.keys(l).length});for(var s of Object.entries(l)){var u=s[0],d=s[1];n.writeString(u),c(d,n)}n.writeMapEnd()}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function m(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).I32?n.version=t.readI32():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.data=t.readBinary():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.version===void 0&&(n.version=0),n}function p(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:if(a===(e||(e=r("ThriftTypes"))).MAP){n.stateStore={};for(var l=t.readMapBegin(),s=0;s<l.size;s++){var u=t.readString(),c=m(t);n.stateStore[u]=c}}else t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.stateStore===void 0&&(n.stateStore={}),n}l.State$DefaultConstructor=s,l.Snapshot$DefaultConstructor=u,l.serializeState=c,l.serializeSnapshot=d,l.deserializeState=m,l.deserializeSnapshot=p}),98);
__d("StateSyncTopicsConfigTypes",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e,l=(e=n("$InternalEnum"))({UNKNOWN:0,INTERNAL:1,EXTERNAL:2}),s=e({UNKNOWN:0,PARTICIPANT_JOIN:100,PARTICIPANT_UPDATE:101,PARTICIPANT_LEAVE:102,PARTICIPANT_NEGOTIATED:103,PARTICIPANT_SDP_CHANGED:104,EXTENSION_CREATION:201,EXTENSION_JOIN:202,EXTENSION_UPDATE:203,EXTENSION_LEAVE:204,EXTENSION_REQUEST:205,CONFERENCE_UPDATE:501,DOMINANT_SPEAKER_UPDATE:1001,MEDIA_ASPECT_RATIO_UPDATE:1002,TIMER_FIRED:1003,MEDIA_PATH_CHANGED:1004,PARTICIPANTS_ACKED_MEDIA:1005}),u=e({UNKNOWN:0,ANY_PARTICIPANT_SUBSCRIBED:1,ALWAYS_RESOLVE:2}),c=e({CACHIUS:1,IRIS:2}),d=e({Config_engine:1,E2eeState:2,Media_information:3,Breakout:4,Countdown_timer:5,Effect_match:6,Emoji_reactions:7,Entered_avatars_mode:8,Moderator_controls:9,Polls:10,Raised_hands_queue:11,Xac_calling:12,Action_items:13,Can_you_see_my_screen:14,Collage:15,Companion:16,Coplay:17,Coview:18,Custom_video_capabilities:19,Dropin:20,Dtmf:21,E2ee_v2_msg:22,Effect_sync:23,Et_pluto_activity:24,Et_pluto_session:25,Et_test_activity:26,Et_test_session:27,Et_tubi_activity:28,Et_tubi_session:29,External_resolution_enabled:30,Hyperspace_copresence_state:31,Hyperspace_mic_state:32,Intenticons:33,Live_stream:34,Live_stream_app_message:35,Max_video_subscriptions:36,Media_sync:37,Media_sync_autoplay:38,Meeting_assistant:39,Meeting_transcription:40,Morpheo_grid:41,Multipeer_ar:42,Number_of_people:43,Opaque_blob:44,Photo_booth:45,Qna:46,Quizzes:47,Reactions:48,Role_assignments:49,Room_features_availability:50,Rooms_notes:51,Screenshare_floor_control:52,Screenshare_single_floor_control:53,Sctp_negotiation:54,Sideband:55,Simple:56,Simple_external:57,Simple_pass_through:58,Simple_passthrough:59,Snippets:60,Sound_effects:61,Whiteboard:62,Whiteboard_messenger:63,Workroom:64,Workrooms_ask_everyone_to_open:65,Workrooms_vr:66,Avatar_transport_state:67,Ambisonic:68,Cathode_extension:69,Biz_calling:70,Work_costreaming:71,Conversation_bot:72,Voip_zone:73,Admin_initiated_casting:74,Smart_glasses_assistant:75,Codec_avatar_2d:76,Custom_media_routing:77,Generic_floor_control:78});a.exports={CryptoAuthVerifierIdentity:c,DataSource:s,DataSourceCondition:u,ResolutionPath:l,TopicId:d}}),null);
__d("WebrtcEnumsTypes",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e,l=(e=n("$InternalEnum"))({OFFER:0,ANSWER:1,ICE_CANDIDATE:2,OK:3,HANG_UP:4,OTHER_DISMISS:5,PRANSWER:7,PING:8,PING_ACK:9,ICE_RESTART_OFFER:10,ICE_RESTART_ANSWER:11,OFFER_ACK:12,ANSWER_ACK:13,NOTIFY_MEDIA_STATE:14,ACK:15,INVALID:16,OFFER_NACK:17,NACK:18,VIDEO_REQUEST:19,SDP_UPDATE:20,SWITCH_TO_MULTIWAY:28,NEGOTIATE:30,PR_OFFER_ACK:32,CLIENT_REPORTED_EVENT:33}),s=e({OFFER:0,ANSWER:1}),u=e({LL_NIL:0,LL_BASIC:1,LL_DEBUG:2,LL_WARNING:3,LL_INFO:4,LL_VERBOSE:5}),c=e({IGNORE_CALL:0,HANGUP_CALL:1,IN_ANOTHER_CALL:2,ACCEPT_AFTER_HANGUP:3,NO_ANSWER_TIMEOUT:4,INCOMING_TIMEOUT:5,OTHER_INSTANCE_HANDLED:6,SIGNALING_MESSAGE_FAILED:7,CONNECTION_DROPPED:8,CLIENT_INTERRUPTED:9,WEBRTC_ERROR:10,CLIENT_ERROR:11,NO_PERMISSION:12,OTHER_NOT_CAPABLE:13,NO_UI_ERROR:14,UNSUPPORTED_VERSION:15,CALLER_NOT_VISIBLE:16,CARRIER_BLOCKED:17,OTHER_CARRIER_BLOCKED:18,CLIENT_ENCRYPTION_ERROR:19,MICROPHONE_PERMISSION_DENIED:20,CAMERA_PERMISSION_DENIED:21,SESSION_MIGRATED:22,RING_MUTED:23,MAX_ALLOWED_PARTICIPANTS_REACHED:24,CALLEE_REQUIRES_MULTIWAY:25,LIVE_NOT_ACKED:26,TX_ACK_TIMEDOUT:27,E2EE_MANDATED_BUT_OFFER_DID_NOT_CONTAIN_E2EE:28,E2EE_MANDATED_BUT_ANSWER_DID_NOT_NEGOTIATE_E2EE:29,ANSWERED_BY_OTHER_USER:30,LONG_LASTING_AUDIO_ISSUE:31,ADMIN_CALLING_OWN_PAGE:32,PAGE_CALLS_BLOCKED:33}),d=e({UDP:0,TCP:1,SSLTCP:2}),m=e({HOST:0,SERVER_REFLEXIVE:1,PEER_REFLEXIVE:2,RELAY:3}),p=e({TCPTYPE_NONE:0,TCPTYPE_PASSIVE:1,TCPTYPE_ACTIVE:2,TCPTYPE_SIMOPEN:3}),_=e({SENDONLY:0,SENDRECV:1,RECVONLY:2,INACTIVE:3}),f=e({AUDIO:0,VIDEO:1,DATA:2}),g=e({AUDIO:0,VIDEO:1,SCREEN:2}),h=e({AES_CM_128_HMAC_SHA1_80:0,AES_CM_128_HMAC_SHA1_32:1,F8_128_HMAC_SHA1_80:2,AEAD_AES_256_GCM:8}),y=e({RTP_SAVPF:0,DTLS_SCTP:1,SCTP:2}),C=e({URN_IETF_PARAMS_RTP_HDREXT_SSRC_AUDIO_LEVEL:0,URN_IETF_PARAMS_RTP_HDREXT_TOFFSET:1,IETF_DRAFT_HOLMER_RMCAT_TRANSPORT_WIDE_CC_01:2,URN_3GPP_VIDEO_ORIENTATION:3,ABS_SEND_TIME:4,PLAYOUT_DELAY:5,VIDEO_CONTENT_TYPE:6,VIDEO_TIMING:7,RTP_MID:8,RTP_STREAM_ID:9,RTP_REPAIRED_STREAM_ID:10,ENCRYPT_EXTENSIONS:11,FRAME_MARKING:12,GENERIC_FRAME_DESCRIPTOR:13,RTP_LOSS_INFO:14,RTP_CONGESTION_INFO:15,RTP_AUDIO_DROP_INFO:16,FRAME_ENCRYPTION_INFO:17,GENERIC_FRAME_DESCRIPTOR_01:18,DEPENDENCY_DESCRIPTOR:19,COLOR_SPACE:20,ABS_CAPTURE_TIME:21,VIDEO_FRAME_TRACKING_ID:22,VIDEO_FRAME_INFO:23}),b=e({ISAC:0,SPEEX_ISAC_OBSOLETE:1,SPEEX:2,OPUS:3,PCMU_OBSOLETE:4,PCMA_OBSOLETE:5,CN:6,TELEPHONE_EVENT:7,VP8:8,RED:9,ULPFEC:10,H264:17,ISPX_WB_2:32,GOOGLE_DATA:33,AAC:36,AAC_LD:37,VP9:96,GOOGLE_SCTP_DATA:97,H265:98,RTX:99,FLEXFEC:100,MULTIPLEX:101,VIDEO_DATA:102,AV1:103,MLOW:104,MLOW_RED:105,RSFEC:106}),v=e({SILENCEBIT_OBSOLETE:0,SPEEXUSEJITTERBIT_OBSOLETE:1,USEINBANDFEC:2,USEADAPTIVEFEC_OBSOLETE:3,EXTERNALBWE_OBSOLETE:4,FEC_BEI_OBSOLETE:5,ISPX_ADAPTIVE_FEC:6,CBR:7,USEDTX:8}),S=e({MINPTIME:0,MAXAVERAGEBITRATE:1,SPROP_STEREO:2,STEREO:3,MAXPTIME:4,PTIME:5,FEC_BEI_OBSOLETE:6,PORT:7,H264PROFILELEVELID:8,PACKETIZATION_MODE:9,LEVEL_ASYMMETRY_ALLOWED:10,APT:11,MAXPLAYBACKRATE:12,REPAIR_WINDOW:13,EMPTY_KEY:14}),R=e({CR_NONE:0,CR_ACTIVE:1,CR_PASSIVE:2,CR_ACTPASS:3,CR_HOLDCONN:4}),L=e({EVENT_NONE:0,EVENT_MEDIA_CONNECTED:1});a.exports={CallEndReason:c,ClientReportedEventType:L,CodecName:b,CodecOption:S,CodecOptionBoolean:v,ConnectionRole:R,CryptoSuite:h,ExtmapUris:C,IceCandidateProtocolType:m,IceCandidateTcpType:p,IceCandidateTransport:d,MediaProtocol:y,MediaType:f,PayloadType:l,SdpNegotiateType:s,SendRecvMode:_,StreamType:g,UploadLogLevel:u}}),null);
__d("WebrtcSdpSerializers",["ThriftTypes","WebrtcEnumsTypes"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){return{}}function u(){return{msid:"stream_label"}}function c(){return{id:""}}function d(){return{bwtype:"",bw:0}}function m(){return{numAudioChannels:1}}function p(){return{id:1,extensionAttributes:[]}}function _(){return{}}function f(){return{componentId:1,transport:o("WebrtcEnumsTypes").IceCandidateTransport.cast(0),generation:0}}function g(){return{port:1,protocol:o("WebrtcEnumsTypes").MediaProtocol.cast(0),sendRecvMode:o("WebrtcEnumsTypes").SendRecvMode.cast(1),hasRtcpMux:!0}}function h(){return{supportsMsid:!0}}function y(){return{}}function C(t,n){if(n.writeStructBegin("SsrcGroup"),t.semantics!=null&&(n.writeFieldBegin({fname:"semantics",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),n.writeString(t.semantics),n.writeFieldEnd()),t.ssrcIds!=null){n.writeFieldBegin({fname:"ssrcIds",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:2}),n.writeListBegin({etype:e.I32,size:t.ssrcIds.length});for(var o of t.ssrcIds)n.writeI32(o);n.writeListEnd(),n.writeFieldEnd()}n.writeFieldStop(),n.writeStructEnd()}function b(t,n){if(n.writeStructBegin("SsrcObject"),t.ssrcId!=null&&(n.writeFieldBegin({fname:"ssrcId",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),n.writeI32(t.ssrcId),n.writeFieldEnd()),t.cname!=null&&(n.writeFieldBegin({fname:"cname",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeString(t.cname),n.writeFieldEnd()),n.writeFieldBegin({fname:"msid",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:3}),t.msid!=null)n.writeString(t.msid);else{var o="stream_label";n.writeString(o)}n.writeFieldEnd(),t.msidAppData!=null&&(n.writeFieldBegin({fname:"msidAppData",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:4}),n.writeString(t.msidAppData),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function v(t,n){if(n.writeStructBegin("RtcpFbVal"),n.writeFieldBegin({fname:"id",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.id!=null)n.writeString(t.id);else{var o="";n.writeString(o)}n.writeFieldEnd(),t.param!=null&&(n.writeFieldBegin({fname:"param",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeString(t.param),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function S(t,n){if(n.writeStructBegin("Bandwidth"),n.writeFieldBegin({fname:"bwtype",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.bwtype!=null)n.writeString(t.bwtype);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"bw",ftype:e.I32,fid:2}),t.bw!=null)n.writeI32(t.bw);else{var a=0;n.writeI32(a)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function R(t,n){if(n.writeStructBegin("CodecDescription"),t.payloadType!=null&&(n.writeFieldBegin({fname:"payloadType",ftype:(e||(e=r("ThriftTypes"))).BYTE,fid:1}),n.writeByte(t.payloadType),n.writeFieldEnd()),t.encodingName!=null){var o;n.writeFieldBegin({fname:"encodingName",ftype:(e||(e=r("ThriftTypes"))).I32,fid:2}),n.writeI32((o=t.encodingName)!=null?o:0),n.writeFieldEnd()}if(t.clockRateKhz!=null&&(n.writeFieldBegin({fname:"clockRateKhz",ftype:(e||(e=r("ThriftTypes"))).BYTE,fid:3}),n.writeByte(t.clockRateKhz),n.writeFieldEnd()),n.writeFieldBegin({fname:"numAudioChannels",ftype:(e||(e=r("ThriftTypes"))).BYTE,fid:4}),t.numAudioChannels!=null)n.writeByte(t.numAudioChannels);else{var a=1;n.writeByte(a)}if(n.writeFieldEnd(),t.fmtParameters!=null){n.writeFieldBegin({fname:"fmtParameters",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:5}),n.writeMapBegin({ktype:e.I32,vtype:e.STRING,size:Object.keys(t.fmtParameters).length});for(var i of Object.entries(t.fmtParameters)){var l,s=i[0],u=i[1];n.writeI32((l=Number(s))!=null?l:0),n.writeString(u)}n.writeMapEnd(),n.writeFieldEnd()}if(t.enabledOptions!=null){n.writeFieldBegin({fname:"enabledOptions",ftype:(e||(e=r("ThriftTypes"))).SET,fid:6}),n.writeSetBegin({etype:e.I32,size:t.enabledOptions.size});for(var c of t.enabledOptions)n.writeI32(c!=null?c:0);n.writeSetEnd(),n.writeFieldEnd()}if(t.rtcpFbParameters!=null){n.writeFieldBegin({fname:"rtcpFbParameters",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:7}),n.writeMapBegin({ktype:e.STRING,vtype:e.STRING,size:Object.keys(t.rtcpFbParameters).length});for(var d of Object.entries(t.rtcpFbParameters)){var m=d[0],p=d[1];n.writeString(m),n.writeString(p)}n.writeMapEnd(),n.writeFieldEnd()}if(t.rtcpFbParamList!=null){n.writeFieldBegin({fname:"rtcpFbParamList",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:10}),n.writeListBegin({etype:e.STRUCT,size:t.rtcpFbParamList.length});for(var _ of t.rtcpFbParamList)v(_,n);n.writeListEnd(),n.writeFieldEnd()}t.videoWidth!=null&&(n.writeFieldBegin({fname:"videoWidth",ftype:(e||(e=r("ThriftTypes"))).I32,fid:8}),n.writeI32(t.videoWidth),n.writeFieldEnd()),t.videoHeight!=null&&(n.writeFieldBegin({fname:"videoHeight",ftype:(e||(e=r("ThriftTypes"))).I32,fid:9}),n.writeI32(t.videoHeight),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function L(t,n){if(n.writeStructBegin("Extmap"),n.writeFieldBegin({fname:"id",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),t.id!=null)n.writeI32(t.id);else{var o=1;n.writeI32(o)}if(n.writeFieldEnd(),t.uri!=null){var a;n.writeFieldBegin({fname:"uri",ftype:(e||(e=r("ThriftTypes"))).I32,fid:2}),n.writeI32((a=t.uri)!=null?a:0),n.writeFieldEnd()}if(n.writeFieldBegin({fname:"extensionAttributes",ftype:e.LIST,fid:3}),t.extensionAttributes!=null){n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).I32,size:t.extensionAttributes.length});for(var i of t.extensionAttributes)n.writeI32(i!=null?i:0);n.writeListEnd()}else{var l=[];n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).I32,size:l.length});for(var s of l)n.writeI32(s!=null?s:0);n.writeListEnd()}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function E(t,n){if(n.writeStructBegin("CryptoParam"),t.tag!=null&&(n.writeFieldBegin({fname:"tag",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),n.writeI32(t.tag),n.writeFieldEnd()),t.suite!=null){var o;n.writeFieldBegin({fname:"suite",ftype:(e||(e=r("ThriftTypes"))).I32,fid:2}),n.writeI32((o=t.suite)!=null?o:0),n.writeFieldEnd()}t.keyParams!=null&&(n.writeFieldBegin({fname:"keyParams",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:3}),n.writeString(t.keyParams),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function k(t,n){if(n.writeStructBegin("IceCandidateSdp"),t.foundation!=null&&(n.writeFieldBegin({fname:"foundation",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),n.writeString(t.foundation),n.writeFieldEnd()),n.writeFieldBegin({fname:"componentId",ftype:(e||(e=r("ThriftTypes"))).BYTE,fid:2}),t.componentId!=null)n.writeByte(t.componentId);else{var a=1;n.writeByte(a)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"transport",ftype:e.I32,fid:3}),t.transport!=null){var i;n.writeI32((i=t.transport)!=null?i:0)}else{var l=o("WebrtcEnumsTypes").IceCandidateTransport.cast(0);n.writeI32(l!=null?l:0)}if(n.writeFieldEnd(),t.priority!=null&&(n.writeFieldBegin({fname:"priority",ftype:(e||(e=r("ThriftTypes"))).I32,fid:4}),n.writeI32(t.priority),n.writeFieldEnd()),t.address!=null&&(n.writeFieldBegin({fname:"address",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:5}),n.writeString(t.address),n.writeFieldEnd()),t.port!=null&&(n.writeFieldBegin({fname:"port",ftype:(e||(e=r("ThriftTypes"))).I32,fid:6}),n.writeI32(t.port),n.writeFieldEnd()),t.protocolType!=null){var s;n.writeFieldBegin({fname:"protocolType",ftype:(e||(e=r("ThriftTypes"))).I32,fid:7}),n.writeI32((s=t.protocolType)!=null?s:0),n.writeFieldEnd()}if(t.relatedAddress!=null&&(n.writeFieldBegin({fname:"relatedAddress",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:8}),n.writeString(t.relatedAddress),n.writeFieldEnd()),t.relatedPort!=null&&(n.writeFieldBegin({fname:"relatedPort",ftype:(e||(e=r("ThriftTypes"))).I32,fid:9}),n.writeI32(t.relatedPort),n.writeFieldEnd()),t.username!=null&&(n.writeFieldBegin({fname:"username",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:10}),n.writeString(t.username),n.writeFieldEnd()),t.password!=null&&(n.writeFieldBegin({fname:"password",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:11}),n.writeString(t.password),n.writeFieldEnd()),n.writeFieldBegin({fname:"generation",ftype:e.I32,fid:12}),t.generation!=null)n.writeI32(t.generation);else{var u=0;n.writeI32(u)}if(n.writeFieldEnd(),t.tcptype!=null){var c;n.writeFieldBegin({fname:"tcptype",ftype:(e||(e=r("ThriftTypes"))).I32,fid:13}),n.writeI32((c=t.tcptype)!=null?c:0),n.writeFieldEnd()}t.networkId!=null&&(n.writeFieldBegin({fname:"networkId",ftype:(e||(e=r("ThriftTypes"))).I16,fid:14}),n.writeI16(t.networkId),n.writeFieldEnd()),t.networkCost!=null&&(n.writeFieldBegin({fname:"networkCost",ftype:(e||(e=r("ThriftTypes"))).I16,fid:15}),n.writeI16(t.networkCost),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function I(t,n){if(n.writeStructBegin("MediaDescription"),t.mediaType!=null){var a;n.writeFieldBegin({fname:"mediaType",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),n.writeI32((a=t.mediaType)!=null?a:0),n.writeFieldEnd()}if(n.writeFieldBegin({fname:"port",ftype:(e||(e=r("ThriftTypes"))).I32,fid:2}),t.port!=null)n.writeI32(t.port);else{var i=1;n.writeI32(i)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"protocol",ftype:e.I32,fid:3}),t.protocol!=null){var l;n.writeI32((l=t.protocol)!=null?l:0)}else{var s=o("WebrtcEnumsTypes").MediaProtocol.cast(0);n.writeI32(s!=null?s:0)}if(n.writeFieldEnd(),t.fmt!=null&&(n.writeFieldBegin({fname:"fmt",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:22}),n.writeString(t.fmt),n.writeFieldEnd()),t.mediaIceUserFrag!=null&&(n.writeFieldBegin({fname:"mediaIceUserFrag",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:4}),n.writeString(t.mediaIceUserFrag),n.writeFieldEnd()),t.mediaIcePassword!=null&&(n.writeFieldBegin({fname:"mediaIcePassword",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:5}),n.writeString(t.mediaIcePassword),n.writeFieldEnd()),t.mediaIceOptions!=null){n.writeFieldBegin({fname:"mediaIceOptions",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:6}),n.writeListBegin({etype:e.STRING,size:t.mediaIceOptions.length});for(var u of t.mediaIceOptions)n.writeString(u);n.writeListEnd(),n.writeFieldEnd()}if(t.mediaSslFingerprintHash!=null&&(n.writeFieldBegin({fname:"mediaSslFingerprintHash",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:7}),n.writeString(t.mediaSslFingerprintHash),n.writeFieldEnd()),t.mediaSslFingerprintDigest!=null&&(n.writeFieldBegin({fname:"mediaSslFingerprintDigest",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:8}),n.writeString(t.mediaSslFingerprintDigest),n.writeFieldEnd()),t.extmaps!=null){n.writeFieldBegin({fname:"extmaps",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:9}),n.writeListBegin({etype:e.STRUCT,size:t.extmaps.length});for(var c of t.extmaps)L(c,n);n.writeListEnd(),n.writeFieldEnd()}if(n.writeFieldBegin({fname:"sendRecvMode",ftype:e.I32,fid:10}),t.sendRecvMode!=null){var d;n.writeI32((d=t.sendRecvMode)!=null?d:0)}else{var m=o("WebrtcEnumsTypes").SendRecvMode.cast(1);n.writeI32(m!=null?m:0)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"hasRtcpMux",ftype:e.BOOL,fid:11}),t.hasRtcpMux!=null)n.writeBool(t.hasRtcpMux);else{var p=!0;n.writeBool(p)}if(n.writeFieldEnd(),t.rtcpReducedSize!=null&&(n.writeFieldBegin({fname:"rtcpReducedSize",ftype:(e||(e=r("ThriftTypes"))).BOOL,fid:25}),n.writeBool(t.rtcpReducedSize),n.writeFieldEnd()),t.cryptoParams!=null){n.writeFieldBegin({fname:"cryptoParams",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:12}),n.writeListBegin({etype:e.STRUCT,size:t.cryptoParams.length});for(var _ of t.cryptoParams)E(_,n);n.writeListEnd(),n.writeFieldEnd()}if(t.codecs!=null){n.writeFieldBegin({fname:"codecs",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:13}),n.writeListBegin({etype:e.STRUCT,size:t.codecs.length});for(var f of t.codecs)R(f,n);n.writeListEnd(),n.writeFieldEnd()}if(t.maxPTime!=null&&(n.writeFieldBegin({fname:"maxPTime",ftype:(e||(e=r("ThriftTypes"))).I32,fid:14}),n.writeI32(t.maxPTime),n.writeFieldEnd()),t.pTime!=null&&(n.writeFieldBegin({fname:"pTime",ftype:(e||(e=r("ThriftTypes"))).I32,fid:15}),n.writeI32(t.pTime),n.writeFieldEnd()),t.ssrcObjects!=null){n.writeFieldBegin({fname:"ssrcObjects",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:16}),n.writeListBegin({etype:e.STRUCT,size:t.ssrcObjects.length});for(var g of t.ssrcObjects)b(g,n);n.writeListEnd(),n.writeFieldEnd()}if(t.candidates!=null){n.writeFieldBegin({fname:"candidates",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:17}),n.writeListBegin({etype:e.STRUCT,size:t.candidates.length});for(var h of t.candidates)k(h,n);n.writeListEnd(),n.writeFieldEnd()}if(t.conferenceMode!=null&&(n.writeFieldBegin({fname:"conferenceMode",ftype:(e||(e=r("ThriftTypes"))).BOOL,fid:18}),n.writeBool(t.conferenceMode),n.writeFieldEnd()),t.ssrcGroups!=null){n.writeFieldBegin({fname:"ssrcGroups",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:19}),n.writeListBegin({etype:e.STRUCT,size:t.ssrcGroups.length});for(var y of t.ssrcGroups)C(y,n);n.writeListEnd(),n.writeFieldEnd()}if(t.connectionRole!=null){var v;n.writeFieldBegin({fname:"connectionRole",ftype:(e||(e=r("ThriftTypes"))).I32,fid:20}),n.writeI32((v=t.connectionRole)!=null?v:0),n.writeFieldEnd()}t.mid!=null&&(n.writeFieldBegin({fname:"mid",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:21}),n.writeString(t.mid),n.writeFieldEnd()),t.bandwidth!=null&&(n.writeFieldBegin({fname:"bandwidth",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:23}),S(t.bandwidth,n),n.writeFieldEnd()),t.sctpPort!=null&&(n.writeFieldBegin({fname:"sctpPort",ftype:(e||(e=r("ThriftTypes"))).I32,fid:24}),n.writeI32(t.sctpPort),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function T(t,n){if(n.writeStructBegin("SessionDescription"),t.sessionId!=null&&(n.writeFieldBegin({fname:"sessionId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),n.writeString(t.sessionId),n.writeFieldEnd()),t.sessionVersion!=null&&(n.writeFieldBegin({fname:"sessionVersion",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeString(t.sessionVersion),n.writeFieldEnd()),n.writeFieldBegin({fname:"supportsMsid",ftype:(e||(e=r("ThriftTypes"))).BOOL,fid:3}),t.supportsMsid!=null)n.writeBool(t.supportsMsid);else{var o=!0;n.writeBool(o)}if(n.writeFieldEnd(),t.useIceLite!=null&&(n.writeFieldBegin({fname:"useIceLite",ftype:(e||(e=r("ThriftTypes"))).BOOL,fid:4}),n.writeBool(t.useIceLite),n.writeFieldEnd()),t.features!=null){n.writeFieldBegin({fname:"features",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:5}),n.writeListBegin({etype:e.STRING,size:t.features.length});for(var a of t.features)n.writeString(a);n.writeListEnd(),n.writeFieldEnd()}if(t.connectionRole!=null){var i;n.writeFieldBegin({fname:"connectionRole",ftype:(e||(e=r("ThriftTypes"))).I32,fid:6}),n.writeI32((i=t.connectionRole)!=null?i:0),n.writeFieldEnd()}if(t.bandwidth!=null&&(n.writeFieldBegin({fname:"bandwidth",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:7}),S(t.bandwidth,n),n.writeFieldEnd()),t.transportBundle!=null){n.writeFieldBegin({fname:"transportBundle",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:8}),n.writeListBegin({etype:e.STRING,size:t.transportBundle.length});for(var l of t.transportBundle)n.writeString(l);n.writeListEnd(),n.writeFieldEnd()}if(t.commonCryptos!=null){n.writeFieldBegin({fname:"commonCryptos",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:9}),n.writeListBegin({etype:e.STRUCT,size:t.commonCryptos.length});for(var s of t.commonCryptos)E(s,n);n.writeListEnd(),n.writeFieldEnd()}n.writeFieldStop(),n.writeStructEnd()}function D(t,n){if(n.writeStructBegin("Sdp"),t.sessionDescription!=null&&(n.writeFieldBegin({fname:"sessionDescription",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:1}),T(t.sessionDescription,n),n.writeFieldEnd()),t.mediaDescriptions!=null){n.writeFieldBegin({fname:"mediaDescriptions",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:2}),n.writeListBegin({etype:e.STRUCT,size:t.mediaDescriptions.length});for(var o of t.mediaDescriptions)I(o,n);n.writeListEnd(),n.writeFieldEnd()}n.writeFieldStop(),n.writeStructEnd()}function x(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.semantics=t.readString():t.skip(a);break;case 2:if(a===(e||(e=r("ThriftTypes"))).LIST){n.ssrcIds=[];for(var l=t.readListBegin(),s=0;s<l.size;s++){var u=t.readI32();n.ssrcIds.push(u)}}else t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n}function $(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).I32?n.ssrcId=t.readI32():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.cname=t.readString():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).STRING?n.msid=t.readString():t.skip(a);break;case 4:a===(e||(e=r("ThriftTypes"))).STRING?n.msidAppData=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.msid===void 0&&(n.msid="stream_label"),n}function P(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.id=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.param=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.id===void 0&&(n.id=""),n}function N(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.bwtype=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).I32?n.bw=t.readI32():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.bwtype===void 0&&(n.bwtype=""),n.bw===void 0&&(n.bw=0),n}function M(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).BYTE?n.payloadType=t.readByte():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).I32?n.encodingName=o("WebrtcEnumsTypes").CodecName.cast(t.readI32()):t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).BYTE?n.clockRateKhz=t.readByte():t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).BYTE?n.numAudioChannels=t.readByte():t.skip(i);break;case 5:if(i===(e||(e=r("ThriftTypes"))).MAP){n.fmtParameters={};for(var s=t.readMapBegin(),u=0;u<s.size;u++){var c=o("WebrtcEnumsTypes").CodecOption.cast(t.readI32()),d=t.readString();c!=null&&(n.fmtParameters[c]=d)}}else t.skip(i);break;case 6:if(i===(e||(e=r("ThriftTypes"))).SET){n.enabledOptions=new Set;for(var m=t.readSetBegin(),p=0;p<m.size;p++){var _=o("WebrtcEnumsTypes").CodecOptionBoolean.cast(t.readI32());n.enabledOptions.add(_)}}else t.skip(i);break;case 7:if(i===(e||(e=r("ThriftTypes"))).MAP){n.rtcpFbParameters={};for(var f=t.readMapBegin(),g=0;g<f.size;g++){var h=t.readString(),y=t.readString();n.rtcpFbParameters[h]=y}}else t.skip(i);break;case 10:if(i===(e||(e=r("ThriftTypes"))).LIST){n.rtcpFbParamList=[];for(var C=t.readListBegin(),b=0;b<C.size;b++){var v=P(t);n.rtcpFbParamList.push(v)}}else t.skip(i);break;case 8:i===(e||(e=r("ThriftTypes"))).I32?n.videoWidth=t.readI32():t.skip(i);break;case 9:i===(e||(e=r("ThriftTypes"))).I32?n.videoHeight=t.readI32():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.numAudioChannels===void 0&&(n.numAudioChannels=1),n}function w(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I32?n.id=t.readI32():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).I32?n.uri=o("WebrtcEnumsTypes").ExtmapUris.cast(t.readI32()):t.skip(i);break;case 3:if(i===(e||(e=r("ThriftTypes"))).LIST){n.extensionAttributes=[];for(var s=t.readListBegin(),u=0;u<s.size;u++){var c=o("WebrtcEnumsTypes").ExtmapUris.cast(t.readI32());n.extensionAttributes.push(c)}}else t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.id===void 0&&(n.id=1),n.extensionAttributes===void 0&&(n.extensionAttributes=[]),n}function A(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I32?n.tag=t.readI32():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).I32?n.suite=o("WebrtcEnumsTypes").CryptoSuite.cast(t.readI32()):t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).STRING?n.keyParams=t.readString():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n}function F(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).STRING?n.foundation=t.readString():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).BYTE?n.componentId=t.readByte():t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).I32?n.transport=o("WebrtcEnumsTypes").IceCandidateTransport.cast(t.readI32()):t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).I32?n.priority=t.readI32():t.skip(i);break;case 5:i===(e||(e=r("ThriftTypes"))).STRING?n.address=t.readString():t.skip(i);break;case 6:i===(e||(e=r("ThriftTypes"))).I32?n.port=t.readI32():t.skip(i);break;case 7:i===(e||(e=r("ThriftTypes"))).I32?n.protocolType=o("WebrtcEnumsTypes").IceCandidateProtocolType.cast(t.readI32()):t.skip(i);break;case 8:i===(e||(e=r("ThriftTypes"))).STRING?n.relatedAddress=t.readString():t.skip(i);break;case 9:i===(e||(e=r("ThriftTypes"))).I32?n.relatedPort=t.readI32():t.skip(i);break;case 10:i===(e||(e=r("ThriftTypes"))).STRING?n.username=t.readString():t.skip(i);break;case 11:i===(e||(e=r("ThriftTypes"))).STRING?n.password=t.readString():t.skip(i);break;case 12:i===(e||(e=r("ThriftTypes"))).I32?n.generation=t.readI32():t.skip(i);break;case 13:i===(e||(e=r("ThriftTypes"))).I32?n.tcptype=o("WebrtcEnumsTypes").IceCandidateTcpType.cast(t.readI32()):t.skip(i);break;case 14:i===(e||(e=r("ThriftTypes"))).I16?n.networkId=t.readI16():t.skip(i);break;case 15:i===(e||(e=r("ThriftTypes"))).I16?n.networkCost=t.readI16():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.componentId===void 0&&(n.componentId=1),n.transport===void 0&&(n.transport=o("WebrtcEnumsTypes").IceCandidateTransport.cast(0)),n.generation===void 0&&(n.generation=0),n}function O(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I32?n.mediaType=o("WebrtcEnumsTypes").MediaType.cast(t.readI32()):t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).I32?n.port=t.readI32():t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).I32?n.protocol=o("WebrtcEnumsTypes").MediaProtocol.cast(t.readI32()):t.skip(i);break;case 22:i===(e||(e=r("ThriftTypes"))).STRING?n.fmt=t.readString():t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).STRING?n.mediaIceUserFrag=t.readString():t.skip(i);break;case 5:i===(e||(e=r("ThriftTypes"))).STRING?n.mediaIcePassword=t.readString():t.skip(i);break;case 6:if(i===(e||(e=r("ThriftTypes"))).LIST){n.mediaIceOptions=[];for(var s=t.readListBegin(),u=0;u<s.size;u++){var c=t.readString();n.mediaIceOptions.push(c)}}else t.skip(i);break;case 7:i===(e||(e=r("ThriftTypes"))).STRING?n.mediaSslFingerprintHash=t.readString():t.skip(i);break;case 8:i===(e||(e=r("ThriftTypes"))).STRING?n.mediaSslFingerprintDigest=t.readString():t.skip(i);break;case 9:if(i===(e||(e=r("ThriftTypes"))).LIST){n.extmaps=[];for(var d=t.readListBegin(),m=0;m<d.size;m++){var p=w(t);n.extmaps.push(p)}}else t.skip(i);break;case 10:i===(e||(e=r("ThriftTypes"))).I32?n.sendRecvMode=o("WebrtcEnumsTypes").SendRecvMode.cast(t.readI32()):t.skip(i);break;case 11:i===(e||(e=r("ThriftTypes"))).BOOL?n.hasRtcpMux=t.readBool():t.skip(i);break;case 25:i===(e||(e=r("ThriftTypes"))).BOOL?n.rtcpReducedSize=t.readBool():t.skip(i);break;case 12:if(i===(e||(e=r("ThriftTypes"))).LIST){n.cryptoParams=[];for(var _=t.readListBegin(),f=0;f<_.size;f++){var g=A(t);n.cryptoParams.push(g)}}else t.skip(i);break;case 13:if(i===(e||(e=r("ThriftTypes"))).LIST){n.codecs=[];for(var h=t.readListBegin(),y=0;y<h.size;y++){var C=M(t);n.codecs.push(C)}}else t.skip(i);break;case 14:i===(e||(e=r("ThriftTypes"))).I32?n.maxPTime=t.readI32():t.skip(i);break;case 15:i===(e||(e=r("ThriftTypes"))).I32?n.pTime=t.readI32():t.skip(i);break;case 16:if(i===(e||(e=r("ThriftTypes"))).LIST){n.ssrcObjects=[];for(var b=t.readListBegin(),v=0;v<b.size;v++){var S=$(t);n.ssrcObjects.push(S)}}else t.skip(i);break;case 17:if(i===(e||(e=r("ThriftTypes"))).LIST){n.candidates=[];for(var R=t.readListBegin(),L=0;L<R.size;L++){var E=F(t);n.candidates.push(E)}}else t.skip(i);break;case 18:i===(e||(e=r("ThriftTypes"))).BOOL?n.conferenceMode=t.readBool():t.skip(i);break;case 19:if(i===(e||(e=r("ThriftTypes"))).LIST){n.ssrcGroups=[];for(var k=t.readListBegin(),I=0;I<k.size;I++){var T=x(t);n.ssrcGroups.push(T)}}else t.skip(i);break;case 20:i===(e||(e=r("ThriftTypes"))).I32?n.connectionRole=o("WebrtcEnumsTypes").ConnectionRole.cast(t.readI32()):t.skip(i);break;case 21:i===(e||(e=r("ThriftTypes"))).STRING?n.mid=t.readString():t.skip(i);break;case 23:i===(e||(e=r("ThriftTypes"))).STRUCT?n.bandwidth=N(t):t.skip(i);break;case 24:i===(e||(e=r("ThriftTypes"))).I32?n.sctpPort=t.readI32():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.port===void 0&&(n.port=1),n.protocol===void 0&&(n.protocol=o("WebrtcEnumsTypes").MediaProtocol.cast(0)),n.sendRecvMode===void 0&&(n.sendRecvMode=o("WebrtcEnumsTypes").SendRecvMode.cast(1)),n.hasRtcpMux===void 0&&(n.hasRtcpMux=!0),n}function B(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).STRING?n.sessionId=t.readString():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).STRING?n.sessionVersion=t.readString():t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).BOOL?n.supportsMsid=t.readBool():t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).BOOL?n.useIceLite=t.readBool():t.skip(i);break;case 5:if(i===(e||(e=r("ThriftTypes"))).LIST){n.features=[];for(var s=t.readListBegin(),u=0;u<s.size;u++){var c=t.readString();n.features.push(c)}}else t.skip(i);break;case 6:i===(e||(e=r("ThriftTypes"))).I32?n.connectionRole=o("WebrtcEnumsTypes").ConnectionRole.cast(t.readI32()):t.skip(i);break;case 7:i===(e||(e=r("ThriftTypes"))).STRUCT?n.bandwidth=N(t):t.skip(i);break;case 8:if(i===(e||(e=r("ThriftTypes"))).LIST){n.transportBundle=[];for(var d=t.readListBegin(),m=0;m<d.size;m++){var p=t.readString();n.transportBundle.push(p)}}else t.skip(i);break;case 9:if(i===(e||(e=r("ThriftTypes"))).LIST){n.commonCryptos=[];for(var _=t.readListBegin(),f=0;f<_.size;f++){var g=A(t);n.commonCryptos.push(g)}}else t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.supportsMsid===void 0&&(n.supportsMsid=!0),n}function W(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRUCT?n.sessionDescription=B(t):t.skip(a);break;case 2:if(a===(e||(e=r("ThriftTypes"))).LIST){n.mediaDescriptions=[];for(var l=t.readListBegin(),s=0;s<l.size;s++){var u=O(t);n.mediaDescriptions.push(u)}}else t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n}l.SsrcGroup$DefaultConstructor=s,l.SsrcObject$DefaultConstructor=u,l.RtcpFbVal$DefaultConstructor=c,l.Bandwidth$DefaultConstructor=d,l.CodecDescription$DefaultConstructor=m,l.Extmap$DefaultConstructor=p,l.CryptoParam$DefaultConstructor=_,l.IceCandidateSdp$DefaultConstructor=f,l.MediaDescription$DefaultConstructor=g,l.SessionDescription$DefaultConstructor=h,l.Sdp$DefaultConstructor=y,l.serializeSsrcGroup=C,l.serializeSsrcObject=b,l.serializeRtcpFbVal=v,l.serializeBandwidth=S,l.serializeCodecDescription=R,l.serializeExtmap=L,l.serializeCryptoParam=E,l.serializeIceCandidateSdp=k,l.serializeMediaDescription=I,l.serializeSessionDescription=T,l.serializeSdp=D,l.deserializeSsrcGroup=x,l.deserializeSsrcObject=$,l.deserializeRtcpFbVal=P,l.deserializeBandwidth=N,l.deserializeCodecDescription=M,l.deserializeExtmap=w,l.deserializeCryptoParam=A,l.deserializeIceCandidateSdp=F,l.deserializeMediaDescription=O,l.deserializeSessionDescription=B,l.deserializeSdp=W}),98);
__d("MultiwayCommonSerializers",["DataMessageSerializers","DataMessageTypes","MultiwayCommonTypes","MultiwaySharedSerializers","MultiwaySharedTypes","StateSyncSerializers","StateSyncTopicsConfigTypes","ThriftTypes","Utf8ToString","WebrtcSdpSerializers","WebrtcSignalingCommonTypes"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){var e;return{message:"",responseStatusCode:(e=o("MultiwayCommonTypes")).RtcResponseStatusCode.cast(0),responseSubCode:e.RtcResponseSubCode.cast(0),apiStatusCode:e.RtcApiStatusCode.cast(0),rtcLogSeverity:e.RtcLogSeverity.cast(0)}}function u(){return{}}function c(){return{media:{}}}function d(){return{body:"",msid:"",mid:""}}function m(){return{sourceKey:"",media:[],ssrcGroups:[]}}function p(){return{mediaStatus:{}}}function _(){return{sdpMLineIndex:"0",sdpMid:""}}function f(){return{stateStore:{},stateStoreV2:{}}}function g(){return{version:0}}function h(){return{encryptedTopic:"",encryptedData:Uint8Array.of(),senderId:Uint8Array.of(),messageType:o("MultiwayCommonTypes").E2eeDataMessageType.cast(0)}}function y(){return{fromVersion:"0",toVersion:"0",mediaUpdates:[]}}function C(){return{currentVersion:"0",mediaPath:o("MultiwaySharedTypes").MediaPath.cast(0)}}function b(){return{callerUserId:"",calleeUserId:"",sessionId:""}}function v(){return{fromVersion:"0",toVersion:"0",mediaUpdates:[],renegotiationRequested:!1,multipleVideoStreamsAllowed:!1,mediaPath:o("MultiwaySharedTypes").MediaPath.cast(0),screenShareStreamAllowed:!1}}function S(){return{currentVersion:"0"}}function R(){return{}}function L(){return{reason:o("MultiwayCommonTypes").HangupReason.cast(0),detailedReasonString:""}}function E(){return{iceCandidateSdps:[]}}function k(){return{reason:o("MultiwayCommonTypes").DismissReason.cast(0),detailedReasonString:""}}function I(){return{joinMode:o("MultiwayCommonTypes").JoinMode.cast(0)}}function T(){return{state:o("MultiwayCommonTypes").ParticipantCallState.cast(0)}}function D(){return{}}function x(){return{}}function $(){return{}}function P(){return{version:"0",participantStates:{},groupsOfUsers:[]}}function N(){return{currentVersion:"0"}}function M(){return{subscriptions:[]}}function w(){return{message:o("DataMessageSerializers").DataMessage$DefaultConstructor()}}function A(){return{deliveryResult:{}}}function F(){return{usersToInvite:new Set}}function O(){return{smcTier:"",region:"",isUsfu:!1,isEdge:!1}}function B(){return{offer:u(),deviceCapabilities:new Set}}function W(){return{answer:u(),mediaStatus:{},initiator:"",isPendingApproval:!1,multipleVideoStreamsAllowed:!1,mediaPath:o("MultiwaySharedTypes").MediaPath.cast(0),groupsOfUsers:[],screenShareStreamAllowed:!1}}function q(){return{deviceCapabilities:new Set}}function U(){return{}}function V(){return{type:o("MultiwayCommonTypes").ClientEventType.cast(0)}}function H(){return{clientEvents:[]}}function G(){return{}}function z(){return{}}function j(){return{caller:"",otherParticipants:new Set,ringType:o("MultiwayCommonTypes").RingType.cast(0),mediaPath:o("MultiwaySharedTypes").MediaPath.cast(0),isTransferCall:!1}}function K(){return{deviceStatus:o("MultiwayCommonTypes").DeviceStatus.cast(0)}}function Q(){return{usersToRemove:new Set}}function X(){return{topic:"",version:0,topicId:o("StateSyncTopicsConfigTypes").TopicId.cast(0)}}function Y(){return{topic:"",version:0}}function J(){return{syncPayload:f(),topic:"",version:0,topicId:o("StateSyncTopicsConfigTypes").TopicId.cast(0)}}function Z(){return{topic:"",version:0}}function ee(){return{topic:"",version:0,data:Uint8Array.of()}}function te(){return{topic:"",version:0}}function ne(){return{approvalStatus:o("MultiwayCommonTypes").ApprovalStatus.cast(0),targetUsers:new Set}}function re(){return{id:""}}function oe(){return{actorId:"",baseId:""}}function ae(){return{type:o("MultiwayCommonTypes").MessageType.cast(0),conferenceName:"",transactionId:"",retryCount:0}}function ie(){return{}}function le(){return{messageHeader:ae(),messageBody:ie()}}function se(){return{users:new Set,allowMultipleJoins:!1,dismissOthersOnFirstJoin:!1,aliasId:""}}function ue(){return{}}function ce(t,n){if(n.writeStructBegin("RtcException"),n.writeFieldBegin({fname:"message",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.message!=null)n.writeString(t.message);else{var a="";n.writeString(a)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"responseStatusCode",ftype:e.I32,fid:2}),t.responseStatusCode!=null){var i;n.writeI32((i=t.responseStatusCode)!=null?i:0)}else{var l=o("MultiwayCommonTypes").RtcResponseStatusCode.cast(0);n.writeI32(l!=null?l:0)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"responseSubCode",ftype:e.I32,fid:3}),t.responseSubCode!=null){var s;n.writeI32((s=t.responseSubCode)!=null?s:0)}else{var u=o("MultiwayCommonTypes").RtcResponseSubCode.cast(0);n.writeI32(u!=null?u:0)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"apiStatusCode",ftype:e.I32,fid:4}),t.apiStatusCode!=null){var c;n.writeI32((c=t.apiStatusCode)!=null?c:0)}else{var d=o("MultiwayCommonTypes").RtcApiStatusCode.cast(0);n.writeI32(d!=null?d:0)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"rtcLogSeverity",ftype:e.I32,fid:5}),t.rtcLogSeverity!=null){var m;n.writeI32((m=t.rtcLogSeverity)!=null?m:0)}else{var p=o("MultiwayCommonTypes").RtcLogSeverity.cast(0);n.writeI32(p!=null?p:0)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function de(t,n){n.writeStructBegin("SessionDescription"),t.sdpString!=null&&(n.writeFieldBegin({fname:"sdpString",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),n.writeString(t.sdpString),n.writeFieldEnd()),t.sdpThrift!=null&&(n.writeFieldBegin({fname:"sdpThrift",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:2}),o("WebrtcSdpSerializers").serializeSdp(t.sdpThrift,n),n.writeFieldEnd()),t.sdpCompressionVersion!=null&&(n.writeFieldBegin({fname:"sdpCompressionVersion",ftype:(e||(e=r("ThriftTypes"))).I64,fid:3}),n.writeI64(BigInt(t.sdpCompressionVersion)),n.writeFieldEnd()),t.sdpCompressedData!=null&&(n.writeFieldBegin({fname:"sdpCompressedData",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:4}),n.writeBinary(t.sdpCompressedData),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function me(t,n){if(n.writeStructBegin("SessionDescriptionUpdate"),n.writeFieldBegin({fname:"media",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:1}),t.media!=null){n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).I32,vtype:e.STRUCT,size:Object.keys(t.media).length});for(var o of Object.entries(t.media)){var a=o[0],i=o[1];n.writeI32(Number(a)),pe(i,n)}n.writeMapEnd()}else{var l={};n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).I32,vtype:e.STRUCT,size:Object.keys(l).length});for(var s of Object.entries(l)){var u=s[0],c=s[1];n.writeI32(Number(u)),pe(c,n)}n.writeMapEnd()}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function pe(t,n){if(n.writeStructBegin("MediaDescriptionUpdate"),n.writeFieldBegin({fname:"body",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.body!=null)n.writeString(t.body);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"msid",ftype:e.STRING,fid:2}),t.msid!=null)n.writeString(t.msid);else{var a="";n.writeString(a)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"mid",ftype:e.STRING,fid:3}),t.mid!=null)n.writeString(t.mid);else{var i="";n.writeString(i)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function _e(t,n){if(n.writeStructBegin("ServerMediaUpdate"),n.writeFieldBegin({fname:"sourceKey",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.sourceKey!=null)n.writeString(t.sourceKey);else{var a="";n.writeString(a)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"media",ftype:e.LIST,fid:2}),t.media!=null){n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:t.media.length});for(var i of t.media)o("MultiwaySharedSerializers").serializeMedia(i,n);n.writeListEnd()}else{var l=[];n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:l.length});for(var s of l)o("MultiwaySharedSerializers").serializeMedia(s,n);n.writeListEnd()}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"ssrcGroups",ftype:e.LIST,fid:3}),t.ssrcGroups!=null){n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:t.ssrcGroups.length});for(var u of t.ssrcGroups)o("MultiwaySharedSerializers").serializeSsrcGroup(u,n);n.writeListEnd()}else{var c=[];n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:c.length});for(var d of c)o("MultiwaySharedSerializers").serializeSsrcGroup(d,n);n.writeListEnd()}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function fe(t,n){if(n.writeStructBegin("ClientMediaUpdate"),n.writeFieldBegin({fname:"mediaStatus",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:1}),t.mediaStatus!=null){n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).STRING,vtype:e.BOOL,size:Object.keys(t.mediaStatus).length});for(var a of Object.entries(t.mediaStatus)){var i=a[0],l=a[1];n.writeString(i),n.writeBool(l)}n.writeMapEnd()}else{var s={};n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).STRING,vtype:e.BOOL,size:Object.keys(s).length});for(var u of Object.entries(s)){var c=u[0],d=u[1];n.writeString(c),n.writeBool(d)}n.writeMapEnd()}n.writeFieldEnd(),t.mediaStatusEx!=null&&(n.writeFieldBegin({fname:"mediaStatusEx",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:2}),o("MultiwaySharedSerializers").serializeClientMediaStatus(t.mediaStatusEx,n),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function ge(t,n){if(n.writeStructBegin("IceCandidate"),t.candidateSdpString!=null&&(n.writeFieldBegin({fname:"candidateSdpString",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),n.writeString(t.candidateSdpString),n.writeFieldEnd()),n.writeFieldBegin({fname:"sdpMLineIndex",ftype:(e||(e=r("ThriftTypes"))).I64,fid:2}),t.sdpMLineIndex!=null)n.writeI64(BigInt(t.sdpMLineIndex));else{var a="0";n.writeI64(BigInt(a))}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"sdpMid",ftype:e.STRING,fid:3}),t.sdpMid!=null)n.writeString(t.sdpMid);else{var i="";n.writeString(i)}n.writeFieldEnd(),t.candidateSdpThrift!=null&&(n.writeFieldBegin({fname:"candidateSdpThrift",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:4}),o("WebrtcSdpSerializers").serializeIceCandidateSdp(t.candidateSdpThrift,n),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function he(t,n){if(n.writeStructBegin("SyncPayload"),n.writeFieldBegin({fname:"stateStore",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:1}),t.stateStore!=null){n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).STRING,vtype:e.STRUCT,size:Object.keys(t.stateStore).length});for(var a of Object.entries(t.stateStore)){var i=a[0],l=a[1];n.writeString(i),o("StateSyncSerializers").serializeState(l,n)}n.writeMapEnd()}else{var s={};n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).STRING,vtype:e.STRUCT,size:Object.keys(s).length});for(var u of Object.entries(s)){var c=u[0],d=u[1];n.writeString(c),o("StateSyncSerializers").serializeState(d,n)}n.writeMapEnd()}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"stateStoreV2",ftype:e.MAP,fid:4}),t.stateStoreV2!=null){n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).I32,vtype:e.STRUCT,size:Object.keys(t.stateStoreV2).length});for(var m of Object.entries(t.stateStoreV2)){var p,_=m[0],f=m[1];n.writeI32((p=Number(_))!=null?p:0),o("StateSyncSerializers").serializeState(f,n)}n.writeMapEnd()}else{var g={};n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).I32,vtype:e.STRUCT,size:Object.keys(g).length});for(var h of Object.entries(g)){var y,C=h[0],b=h[1];n.writeI32((y=Number(C))!=null?y:0),o("StateSyncSerializers").serializeState(b,n)}n.writeMapEnd()}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function ye(t,n){if(n.writeStructBegin("SyncAck"),n.writeFieldBegin({fname:"version",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),t.version!=null)n.writeI32(t.version);else{var o=0;n.writeI32(o)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function Ce(t,n){if(n.writeStructBegin("E2eeData"),n.writeFieldBegin({fname:"encryptedTopic",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.encryptedTopic!=null)n.writeString(t.encryptedTopic);else{var a="";n.writeString(a)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"encryptedData",ftype:e.STRING,fid:2}),t.encryptedData!=null)n.writeBinary(t.encryptedData);else{var i=Uint8Array.of();n.writeBinary(i)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"senderId",ftype:e.STRING,fid:3}),t.senderId!=null)n.writeBinary(t.senderId);else{var l=Uint8Array.of();n.writeBinary(l)}if(n.writeFieldEnd(),t.targetIds!=null){n.writeFieldBegin({fname:"targetIds",ftype:(e||(e=r("ThriftTypes"))).SET,fid:4}),n.writeSetBegin({etype:e.STRING,size:t.targetIds.size});for(var s of t.targetIds)n.writeBinary(s);n.writeSetEnd(),n.writeFieldEnd()}if(n.writeFieldBegin({fname:"messageType",ftype:e.I32,fid:5}),t.messageType!=null){var u;n.writeI32((u=t.messageType)!=null?u:0)}else{var c=o("MultiwayCommonTypes").E2eeDataMessageType.cast(0);n.writeI32(c!=null?c:0)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function be(t,n){if(n.writeStructBegin("ClientMediaUpdateRequest"),n.writeFieldBegin({fname:"fromVersion",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),t.fromVersion!=null)n.writeI64(BigInt(t.fromVersion));else{var o="0";n.writeI64(BigInt(o))}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"toVersion",ftype:e.I64,fid:2}),t.toVersion!=null)n.writeI64(BigInt(t.toVersion));else{var a="0";n.writeI64(BigInt(a))}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"mediaUpdates",ftype:e.LIST,fid:3}),t.mediaUpdates!=null){n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:t.mediaUpdates.length});for(var i of t.mediaUpdates)fe(i,n);n.writeListEnd()}else{var l=[];n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:l.length});for(var s of l)fe(s,n);n.writeListEnd()}n.writeFieldEnd(),t.offer!=null&&(n.writeFieldBegin({fname:"offer",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:4}),de(t.offer,n),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function ve(t,n){if(n.writeStructBegin("ClientMediaUpdateResponse"),n.writeFieldBegin({fname:"currentVersion",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),t.currentVersion!=null)n.writeI64(BigInt(t.currentVersion));else{var a="0";n.writeI64(BigInt(a))}if(n.writeFieldEnd(),t.answer!=null&&(n.writeFieldBegin({fname:"answer",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:2}),de(t.answer,n),n.writeFieldEnd()),t.mediaStatus!=null&&(n.writeFieldBegin({fname:"mediaStatus",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:3}),o("MultiwaySharedSerializers").serializeClientMediaStatus(t.mediaStatus,n),n.writeFieldEnd()),t.sdpOriginLocalId!=null&&(n.writeFieldBegin({fname:"sdpOriginLocalId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:4}),n.writeString(t.sdpOriginLocalId),n.writeFieldEnd()),t.renegotiationOffer!=null&&(n.writeFieldBegin({fname:"renegotiationOffer",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:5}),de(t.renegotiationOffer,n),n.writeFieldEnd()),n.writeFieldBegin({fname:"mediaPath",ftype:e.I32,fid:6}),t.mediaPath!=null){var i;n.writeI32((i=t.mediaPath)!=null?i:0)}else{var l=o("MultiwaySharedTypes").MediaPath.cast(0);n.writeI32(l!=null?l:0)}if(n.writeFieldEnd(),t.stateStore!=null){n.writeFieldBegin({fname:"stateStore",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:7}),n.writeMapBegin({ktype:e.STRING,vtype:e.STRUCT,size:Object.keys(t.stateStore).length});for(var s of Object.entries(t.stateStore)){var u=s[0],c=s[1];n.writeString(u),o("StateSyncSerializers").serializeState(c,n)}n.writeMapEnd(),n.writeFieldEnd()}if(t.stateStoreV2!=null){n.writeFieldBegin({fname:"stateStoreV2",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:8}),n.writeMapBegin({ktype:e.I32,vtype:e.STRUCT,size:Object.keys(t.stateStoreV2).length});for(var d of Object.entries(t.stateStoreV2)){var m,p=d[0],_=d[1];n.writeI32((m=Number(p))!=null?m:0),o("StateSyncSerializers").serializeState(_,n)}n.writeMapEnd(),n.writeFieldEnd()}n.writeFieldStop(),n.writeStructEnd()}function Se(t,n){if(n.writeStructBegin("MultipleRelaysAllocationParameters"),n.writeFieldBegin({fname:"callerUserId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.callerUserId!=null)n.writeString(t.callerUserId);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"calleeUserId",ftype:e.STRING,fid:2}),t.calleeUserId!=null)n.writeString(t.calleeUserId);else{var a="";n.writeString(a)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"sessionId",ftype:e.STRING,fid:3}),t.sessionId!=null)n.writeString(t.sessionId);else{var i="";n.writeString(i)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function Re(t,n){if(n.writeStructBegin("ServerMediaUpdateRequest"),n.writeFieldBegin({fname:"fromVersion",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),t.fromVersion!=null)n.writeI64(BigInt(t.fromVersion));else{var a="0";n.writeI64(BigInt(a))}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"toVersion",ftype:e.I64,fid:2}),t.toVersion!=null)n.writeI64(BigInt(t.toVersion));else{var i="0";n.writeI64(BigInt(i))}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"mediaUpdates",ftype:e.LIST,fid:3}),t.mediaUpdates!=null){n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:t.mediaUpdates.length});for(var l of t.mediaUpdates)_e(l,n);n.writeListEnd()}else{var s=[];n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:s.length});for(var u of s)_e(u,n);n.writeListEnd()}if(n.writeFieldEnd(),t.offer!=null&&(n.writeFieldBegin({fname:"offer",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:4}),de(t.offer,n),n.writeFieldEnd()),t.answer!=null&&(n.writeFieldBegin({fname:"answer",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:6}),de(t.answer,n),n.writeFieldEnd()),t.mediaStatus!=null&&(n.writeFieldBegin({fname:"mediaStatus",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:7}),o("MultiwaySharedSerializers").serializeClientMediaStatus(t.mediaStatus,n),n.writeFieldEnd()),n.writeFieldBegin({fname:"renegotiationRequested",ftype:e.BOOL,fid:8}),t.renegotiationRequested!=null)n.writeBool(t.renegotiationRequested);else{var c=!1;n.writeBool(c)}if(n.writeFieldEnd(),t.prAnswer!=null&&(n.writeFieldBegin({fname:"prAnswer",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:9}),de(t.prAnswer,n),n.writeFieldEnd()),t.stateStore!=null){n.writeFieldBegin({fname:"stateStore",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:10}),n.writeMapBegin({ktype:e.STRING,vtype:e.STRUCT,size:Object.keys(t.stateStore).length});for(var d of Object.entries(t.stateStore)){var m=d[0],p=d[1];n.writeString(m),o("StateSyncSerializers").serializeState(p,n)}n.writeMapEnd(),n.writeFieldEnd()}if(t.sdpOriginLocalId!=null&&(n.writeFieldBegin({fname:"sdpOriginLocalId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:11}),n.writeString(t.sdpOriginLocalId),n.writeFieldEnd()),t.multipleRelaysParameters!=null&&(n.writeFieldBegin({fname:"multipleRelaysParameters",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:12}),Se(t.multipleRelaysParameters,n),n.writeFieldEnd()),n.writeFieldBegin({fname:"multipleVideoStreamsAllowed",ftype:e.BOOL,fid:13}),t.multipleVideoStreamsAllowed!=null)n.writeBool(t.multipleVideoStreamsAllowed);else{var _=!1;n.writeBool(_)}if(n.writeFieldEnd(),t.renegotiationOffer!=null&&(n.writeFieldBegin({fname:"renegotiationOffer",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:14}),de(t.renegotiationOffer,n),n.writeFieldEnd()),n.writeFieldBegin({fname:"mediaPath",ftype:e.I32,fid:15}),t.mediaPath!=null){var f;n.writeI32((f=t.mediaPath)!=null?f:0)}else{var g=o("MultiwaySharedTypes").MediaPath.cast(0);n.writeI32(g!=null?g:0)}if(n.writeFieldEnd(),t.update!=null&&(n.writeFieldBegin({fname:"update",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:16}),me(t.update,n),n.writeFieldEnd()),n.writeFieldBegin({fname:"screenShareStreamAllowed",ftype:e.BOOL,fid:17}),t.screenShareStreamAllowed!=null)n.writeBool(t.screenShareStreamAllowed);else{var h=!1;n.writeBool(h)}if(n.writeFieldEnd(),t.stateStoreV2!=null){n.writeFieldBegin({fname:"stateStoreV2",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:18}),n.writeMapBegin({ktype:e.I32,vtype:e.STRUCT,size:Object.keys(t.stateStoreV2).length});for(var y of Object.entries(t.stateStoreV2)){var C,b=y[0],v=y[1];n.writeI32((C=Number(b))!=null?C:0),o("StateSyncSerializers").serializeState(v,n)}n.writeMapEnd(),n.writeFieldEnd()}if(t.allowedCustomVideoContentTypes!=null){n.writeFieldBegin({fname:"allowedCustomVideoContentTypes",ftype:(e||(e=r("ThriftTypes"))).SET,fid:19}),n.writeSetBegin({etype:e.I32,size:t.allowedCustomVideoContentTypes.size});for(var S of t.allowedCustomVideoContentTypes)n.writeI32(S!=null?S:0);n.writeSetEnd(),n.writeFieldEnd()}t.relayInfo!=null&&(n.writeFieldBegin({fname:"relayInfo",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:20}),o("MultiwaySharedSerializers").serializeRelayInfo(t.relayInfo,n),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function Le(t,n){if(n.writeStructBegin("ServerMediaUpdateResponse"),n.writeFieldBegin({fname:"currentVersion",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),t.currentVersion!=null)n.writeI64(BigInt(t.currentVersion));else{var a="0";n.writeI64(BigInt(a))}n.writeFieldEnd(),t.answer!=null&&(n.writeFieldBegin({fname:"answer",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:2}),de(t.answer,n),n.writeFieldEnd()),t.mediaStatus!=null&&(n.writeFieldBegin({fname:"mediaStatus",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:3}),o("MultiwaySharedSerializers").serializeClientMediaStatus(t.mediaStatus,n),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function Ee(e,t){t.writeStructBegin("TransferRequest"),t.writeFieldStop(),t.writeStructEnd()}function ke(t,n){if(n.writeStructBegin("HangupRequest"),n.writeFieldBegin({fname:"reason",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),t.reason!=null){var a;n.writeI32((a=t.reason)!=null?a:0)}else{var i=o("MultiwayCommonTypes").HangupReason.cast(0);n.writeI32(i!=null?i:0)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"detailedReasonString",ftype:e.STRING,fid:2}),t.detailedReasonString!=null)n.writeString(t.detailedReasonString);else{var l="";n.writeString(l)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function Ie(t,n){if(n.writeStructBegin("IceCandidateRequest"),n.writeFieldBegin({fname:"iceCandidateSdps",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:1}),t.iceCandidateSdps!=null){n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:t.iceCandidateSdps.length});for(var o of t.iceCandidateSdps)ge(o,n);n.writeListEnd()}else{var a=[];n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:a.length});for(var i of a)ge(i,n);n.writeListEnd()}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function Te(t,n){if(n.writeStructBegin("DismissRequest"),n.writeFieldBegin({fname:"reason",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),t.reason!=null){var a;n.writeI32((a=t.reason)!=null?a:0)}else{var i=o("MultiwayCommonTypes").DismissReason.cast(0);n.writeI32(i!=null?i:0)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"detailedReasonString",ftype:e.STRING,fid:2}),t.detailedReasonString!=null)n.writeString(t.detailedReasonString);else{var l="";n.writeString(l)}n.writeFieldEnd(),t.callabilityResultErrorCode!=null&&(n.writeFieldBegin({fname:"callabilityResultErrorCode",ftype:(e||(e=r("ThriftTypes"))).I64,fid:3}),n.writeI64(BigInt(t.callabilityResultErrorCode)),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function De(t,n){if(n.writeStructBegin("EndpointSettings"),n.writeFieldBegin({fname:"joinMode",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),t.joinMode!=null){var a;n.writeI32((a=t.joinMode)!=null?a:0)}else{var i=o("MultiwayCommonTypes").JoinMode.cast(0);n.writeI32(i!=null?i:0)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function xe(t,n){if(n.writeStructBegin("ParticipantState"),n.writeFieldBegin({fname:"state",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),t.state!=null){var a;n.writeI32((a=t.state)!=null?a:0)}else{var i=o("MultiwayCommonTypes").ParticipantCallState.cast(0);n.writeI32(i!=null?i:0)}n.writeFieldEnd(),t.userCapabilities!=null&&(n.writeFieldBegin({fname:"userCapabilities",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeBinary(t.userCapabilities),n.writeFieldEnd()),t.sctpNodeId!=null&&(n.writeFieldBegin({fname:"sctpNodeId",ftype:(e||(e=r("ThriftTypes"))).I64,fid:3}),n.writeI64(BigInt(t.sctpNodeId)),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function $e(t,n){n.writeStructBegin("ServerOnlyParticipantState"),t.userCountry!=null&&(n.writeFieldBegin({fname:"userCountry",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),n.writeString(t.userCountry),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function Pe(t,n){n.writeStructBegin("UserProfile"),t.name!=null&&(n.writeFieldBegin({fname:"name",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),n.writeString(t.name),n.writeFieldEnd()),t.profilePictureUri!=null&&(n.writeFieldBegin({fname:"profilePictureUri",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeString(t.profilePictureUri),n.writeFieldEnd()),t.aliasId!=null&&(n.writeFieldBegin({fname:"aliasId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:3}),n.writeString(t.aliasId),n.writeFieldEnd()),t.thirdPartyId!=null&&(n.writeFieldBegin({fname:"thirdPartyId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:4}),n.writeString(t.thirdPartyId),n.writeFieldEnd()),t.groupId!=null&&(n.writeFieldBegin({fname:"groupId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:5}),n.writeString(t.groupId),n.writeFieldEnd()),t.avatarImageUri!=null&&(n.writeFieldBegin({fname:"avatarImageUri",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:6}),n.writeString(t.avatarImageUri),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function Ne(t,n){n.writeStructBegin("ProductMetadata"),t.callerInfo!=null&&(n.writeFieldBegin({fname:"callerInfo",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:1}),Pe(t.callerInfo,n),n.writeFieldEnd()),t.liveBroadcastId!=null&&(n.writeFieldBegin({fname:"liveBroadcastId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeString(t.liveBroadcastId),n.writeFieldEnd()),t.callingTags!=null&&(n.writeFieldBegin({fname:"callingTags",ftype:(e||(e=r("ThriftTypes"))).I32,fid:3}),n.writeI32(t.callingTags),n.writeFieldEnd()),t.backingIdentifier!=null&&(n.writeFieldBegin({fname:"backingIdentifier",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:4}),n.writeString(t.backingIdentifier),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function Me(t,n){if(n.writeStructBegin("ConferenceStateRequest"),n.writeFieldBegin({fname:"version",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),t.version!=null)n.writeI64(BigInt(t.version));else{var a="0";n.writeI64(BigInt(a))}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"participantStates",ftype:e.MAP,fid:2}),t.participantStates!=null){n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).STRING,vtype:e.STRUCT,size:Object.keys(t.participantStates).length});for(var i of Object.entries(t.participantStates)){var l=i[0],s=i[1];n.writeString(l),xe(s,n)}n.writeMapEnd()}else{var u={};n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).STRING,vtype:e.STRUCT,size:Object.keys(u).length});for(var c of Object.entries(u)){var d=c[0],m=c[1];n.writeString(d),xe(m,n)}n.writeMapEnd()}if(n.writeFieldEnd(),t.userProfiles!=null){n.writeFieldBegin({fname:"userProfiles",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:3}),n.writeMapBegin({ktype:e.STRING,vtype:e.STRUCT,size:Object.keys(t.userProfiles).length});for(var p of Object.entries(t.userProfiles)){var _=p[0],f=p[1];n.writeString(_),Pe(f,n)}n.writeMapEnd(),n.writeFieldEnd()}if(t.appMessages!=null){n.writeFieldBegin({fname:"appMessages",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:4}),n.writeListBegin({etype:e.STRUCT,size:t.appMessages.length});for(var g of t.appMessages)o("DataMessageSerializers").serializeDataMessage(g,n);n.writeListEnd(),n.writeFieldEnd()}if(n.writeFieldBegin({fname:"groupsOfUsers",ftype:e.LIST,fid:5}),t.groupsOfUsers!=null){n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:t.groupsOfUsers.length});for(var h of t.groupsOfUsers)ct(h,n);n.writeListEnd()}else{var y=[];n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:y.length});for(var C of y)ct(C,n);n.writeListEnd()}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function we(t,n){if(n.writeStructBegin("ConferenceStateResponse"),n.writeFieldBegin({fname:"currentVersion",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),t.currentVersion!=null)n.writeI64(BigInt(t.currentVersion));else{var o="0";n.writeI64(BigInt(o))}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function Ae(t,n){if(n.writeStructBegin("SubscriptionRequest"),n.writeFieldBegin({fname:"subscriptions",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:1}),t.subscriptions!=null){n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:t.subscriptions.length});for(var a of t.subscriptions)o("MultiwaySharedSerializers").serializeSubscription(a,n);n.writeListEnd()}else{var i=[];n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:i.length});for(var l of i)o("MultiwaySharedSerializers").serializeSubscription(l,n);n.writeListEnd()}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function Fe(t,n){if(n.writeStructBegin("DataMessageRequest"),n.writeFieldBegin({fname:"message",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:1}),t.message!=null)o("DataMessageSerializers").serializeDataMessage(t.message,n);else{var a=o("DataMessageSerializers").DataMessage$DefaultConstructor();o("DataMessageSerializers").serializeDataMessage(a,n)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function Oe(t,n){if(n.writeStructBegin("DataMessageResponse"),n.writeFieldBegin({fname:"deliveryResult",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:1}),t.deliveryResult!=null){n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).STRING,vtype:e.I32,size:Object.keys(t.deliveryResult).length});for(var o of Object.entries(t.deliveryResult)){var a=o[0],i=o[1];n.writeString(a),n.writeI32(i!=null?i:0)}n.writeMapEnd()}else{var l={};n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).STRING,vtype:e.I32,size:Object.keys(l).length});for(var s of Object.entries(l)){var u=s[0],c=s[1];n.writeString(u),n.writeI32(c!=null?c:0)}n.writeMapEnd()}if(n.writeFieldEnd(),t.serviceTypeDeliveryResult!=null){n.writeFieldBegin({fname:"serviceTypeDeliveryResult",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:2}),n.writeMapBegin({ktype:e.I32,vtype:e.I32,size:Object.keys(t.serviceTypeDeliveryResult).length});for(var d of Object.entries(t.serviceTypeDeliveryResult)){var m,p=d[0],_=d[1];n.writeI32((m=Number(p))!=null?m:0),n.writeI32(_!=null?_:0)}n.writeMapEnd(),n.writeFieldEnd()}n.writeFieldStop(),n.writeStructEnd()}function Be(t,n){if(n.writeStructBegin("AddParticipantsRequest"),n.writeFieldBegin({fname:"usersToInvite",ftype:(e||(e=r("ThriftTypes"))).SET,fid:1}),t.usersToInvite!=null){n.writeSetBegin({etype:(e||(e=r("ThriftTypes"))).STRING,size:t.usersToInvite.size});for(var a of t.usersToInvite)n.writeString(a);n.writeSetEnd()}else{var i=new Set;n.writeSetBegin({etype:(e||(e=r("ThriftTypes"))).STRING,size:i.size});for(var l of i)n.writeString(l);n.writeSetEnd()}if(n.writeFieldEnd(),t.appMessages!=null){n.writeFieldBegin({fname:"appMessages",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:2}),n.writeListBegin({etype:e.STRUCT,size:t.appMessages.length});for(var s of t.appMessages)o("DataMessageSerializers").serializeDataMessage(s,n);n.writeListEnd(),n.writeFieldEnd()}n.writeFieldStop(),n.writeStructEnd()}function We(t,n){if(n.writeStructBegin("SfuAllocation"),n.writeFieldBegin({fname:"smcTier",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.smcTier!=null)n.writeString(t.smcTier);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"region",ftype:e.STRING,fid:2}),t.region!=null)n.writeString(t.region);else{var a="";n.writeString(a)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"isUsfu",ftype:e.BOOL,fid:3}),t.isUsfu!=null)n.writeBool(t.isUsfu);else{var i=!1;n.writeBool(i)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"isEdge",ftype:e.BOOL,fid:4}),t.isEdge!=null)n.writeBool(t.isEdge);else{var l=!1;n.writeBool(l)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function qe(t,n){if(n.writeStructBegin("JoinRequest"),n.writeFieldBegin({fname:"offer",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:1}),t.offer!=null)de(t.offer,n);else{var a=u();de(a,n)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"deviceCapabilities",ftype:e.SET,fid:2}),t.deviceCapabilities!=null){n.writeSetBegin({etype:(e||(e=r("ThriftTypes"))).I32,size:t.deviceCapabilities.size});for(var i of t.deviceCapabilities)n.writeI32(i!=null?i:0);n.writeSetEnd()}else{var l=new Set;n.writeSetBegin({etype:(e||(e=r("ThriftTypes"))).I32,size:l.size});for(var s of l)n.writeI32(s!=null?s:0);n.writeSetEnd()}if(n.writeFieldEnd(),t.usersToCall!=null){n.writeFieldBegin({fname:"usersToCall",ftype:(e||(e=r("ThriftTypes"))).SET,fid:3}),n.writeSetBegin({etype:e.STRING,size:t.usersToCall.size});for(var c of t.usersToCall)n.writeString(c);n.writeSetEnd(),n.writeFieldEnd()}if(t.mediaStatus!=null){n.writeFieldBegin({fname:"mediaStatus",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:4}),n.writeMapBegin({ktype:e.STRING,vtype:e.BOOL,size:Object.keys(t.mediaStatus).length});for(var d of Object.entries(t.mediaStatus)){var m=d[0],p=d[1];n.writeString(m),n.writeBool(p)}n.writeMapEnd(),n.writeFieldEnd()}if(t.userCapabilities!=null&&(n.writeFieldBegin({fname:"userCapabilities",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:5}),n.writeBinary(t.userCapabilities),n.writeFieldEnd()),t.supportedExperiments!=null&&(n.writeFieldBegin({fname:"supportedExperiments",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:6}),n.writeString(t.supportedExperiments),n.writeFieldEnd()),t.appMessages!=null){n.writeFieldBegin({fname:"appMessages",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:9}),n.writeListBegin({etype:e.STRUCT,size:t.appMessages.length});for(var _ of t.appMessages)o("DataMessageSerializers").serializeDataMessage(_,n);n.writeListEnd(),n.writeFieldEnd()}if(t.userToEscalate!=null&&(n.writeFieldBegin({fname:"userToEscalate",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:10}),n.writeString(t.userToEscalate),n.writeFieldEnd()),t.escalatingCallId!=null&&(n.writeFieldBegin({fname:"escalatingCallId",ftype:(e||(e=r("ThriftTypes"))).I64,fid:11}),n.writeI64(BigInt(t.escalatingCallId)),n.writeFieldEnd()),t.conferenceType!=null){var f;n.writeFieldBegin({fname:"conferenceType",ftype:(e||(e=r("ThriftTypes"))).I32,fid:12}),n.writeI32((f=t.conferenceType)!=null?f:0),n.writeFieldEnd()}if(t.mediaStatusEx!=null&&(n.writeFieldBegin({fname:"mediaStatusEx",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:13}),o("MultiwaySharedSerializers").serializeClientMediaStatus(t.mediaStatusEx,n),n.writeFieldEnd()),t.answer!=null&&(n.writeFieldBegin({fname:"answer",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:14}),de(t.answer,n),n.writeFieldEnd()),t.syncPayload!=null&&(n.writeFieldBegin({fname:"syncPayload",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:15}),he(t.syncPayload,n),n.writeFieldEnd()),t.usersToApproveFromWaitingRoom!=null){n.writeFieldBegin({fname:"usersToApproveFromWaitingRoom",ftype:(e||(e=r("ThriftTypes"))).SET,fid:16}),n.writeSetBegin({etype:e.STRING,size:t.usersToApproveFromWaitingRoom.size});for(var g of t.usersToApproveFromWaitingRoom)n.writeString(g);n.writeSetEnd(),n.writeFieldEnd()}if(t.e2eeEnforcement!=null&&(n.writeFieldBegin({fname:"e2eeEnforcement",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:17}),o("MultiwaySharedSerializers").serializeE2eeEnforcement(t.e2eeEnforcement,n),n.writeFieldEnd()),t.sfuAllocation!=null&&(n.writeFieldBegin({fname:"sfuAllocation",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:18}),We(t.sfuAllocation,n),n.writeFieldEnd()),t.clientMediaMode!=null){var h;n.writeFieldBegin({fname:"clientMediaMode",ftype:(e||(e=r("ThriftTypes"))).I32,fid:19}),n.writeI32((h=t.clientMediaMode)!=null?h:0),n.writeFieldEnd()}if(t.endpointSettings!=null&&(n.writeFieldBegin({fname:"endpointSettings",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:20}),De(t.endpointSettings,n),n.writeFieldEnd()),t.backupSfuAllocation!=null&&(n.writeFieldBegin({fname:"backupSfuAllocation",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:21}),We(t.backupSfuAllocation,n),n.writeFieldEnd()),t.supportedCustomVideoContentTypes!=null){n.writeFieldBegin({fname:"supportedCustomVideoContentTypes",ftype:(e||(e=r("ThriftTypes"))).SET,fid:22}),n.writeSetBegin({etype:e.I32,size:t.supportedCustomVideoContentTypes.size});for(var y of t.supportedCustomVideoContentTypes)n.writeI32(y!=null?y:0);n.writeSetEnd(),n.writeFieldEnd()}t.configIntegrityOpaqueToken!=null&&(n.writeFieldBegin({fname:"configIntegrityOpaqueToken",ftype:(e||(e=r("ThriftTypes"))).I32,fid:23}),n.writeI32(t.configIntegrityOpaqueToken),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function Ue(t,n){if(n.writeStructBegin("JoinResponse"),n.writeFieldBegin({fname:"answer",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:1}),t.answer!=null)de(t.answer,n);else{var a=u();de(a,n)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"mediaStatus",ftype:e.MAP,fid:2}),t.mediaStatus!=null){n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).STRING,vtype:e.BOOL,size:Object.keys(t.mediaStatus).length});for(var i of Object.entries(t.mediaStatus)){var l=i[0],s=i[1];n.writeString(l),n.writeBool(s)}n.writeMapEnd()}else{var c={};n.writeMapBegin({ktype:(e||(e=r("ThriftTypes"))).STRING,vtype:e.BOOL,size:Object.keys(c).length});for(var d of Object.entries(c)){var m=d[0],p=d[1];n.writeString(m),n.writeBool(p)}n.writeMapEnd()}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"initiator",ftype:e.STRING,fid:3}),t.initiator!=null)n.writeString(t.initiator);else{var _="";n.writeString(_)}if(n.writeFieldEnd(),t.negotiatedExperiments!=null&&(n.writeFieldBegin({fname:"negotiatedExperiments",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:4}),n.writeString(t.negotiatedExperiments),n.writeFieldEnd()),t.mediaStatusEx!=null&&(n.writeFieldBegin({fname:"mediaStatusEx",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:6}),o("MultiwaySharedSerializers").serializeClientMediaStatus(t.mediaStatusEx,n),n.writeFieldEnd()),t.appMessages!=null){n.writeFieldBegin({fname:"appMessages",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:7}),n.writeListBegin({etype:e.STRUCT,size:t.appMessages.length});for(var f of t.appMessages)o("DataMessageSerializers").serializeDataMessage(f,n);n.writeListEnd(),n.writeFieldEnd()}if(t.stateStore!=null){n.writeFieldBegin({fname:"stateStore",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:8}),n.writeMapBegin({ktype:e.STRING,vtype:e.STRUCT,size:Object.keys(t.stateStore).length});for(var g of Object.entries(t.stateStore)){var h=g[0],y=g[1];n.writeString(h),o("StateSyncSerializers").serializeState(y,n)}n.writeMapEnd(),n.writeFieldEnd()}if(t.sdpOriginLocalId!=null&&(n.writeFieldBegin({fname:"sdpOriginLocalId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:9}),n.writeString(t.sdpOriginLocalId),n.writeFieldEnd()),n.writeFieldBegin({fname:"isPendingApproval",ftype:e.BOOL,fid:10}),t.isPendingApproval!=null)n.writeBool(t.isPendingApproval);else{var C=!1;n.writeBool(C)}if(n.writeFieldEnd(),t.renegotiationOffer!=null&&(n.writeFieldBegin({fname:"renegotiationOffer",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:11}),de(t.renegotiationOffer,n),n.writeFieldEnd()),n.writeFieldBegin({fname:"multipleVideoStreamsAllowed",ftype:e.BOOL,fid:12}),t.multipleVideoStreamsAllowed!=null)n.writeBool(t.multipleVideoStreamsAllowed);else{var b=!1;n.writeBool(b)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"mediaPath",ftype:e.I32,fid:13}),t.mediaPath!=null){var v;n.writeI32((v=t.mediaPath)!=null?v:0)}else{var S=o("MultiwaySharedTypes").MediaPath.cast(0);n.writeI32(S!=null?S:0)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"groupsOfUsers",ftype:e.LIST,fid:14}),t.groupsOfUsers!=null){n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:t.groupsOfUsers.length});for(var R of t.groupsOfUsers)ct(R,n);n.writeListEnd()}else{var L=[];n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:L.length});for(var E of L)ct(E,n);n.writeListEnd()}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"screenShareStreamAllowed",ftype:e.BOOL,fid:15}),t.screenShareStreamAllowed!=null)n.writeBool(t.screenShareStreamAllowed);else{var k=!1;n.writeBool(k)}if(n.writeFieldEnd(),t.relayInfo!=null&&(n.writeFieldBegin({fname:"relayInfo",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:16}),o("MultiwaySharedSerializers").serializeRelayInfo(t.relayInfo,n),n.writeFieldEnd()),t.selfSctpNodeId!=null&&(n.writeFieldBegin({fname:"selfSctpNodeId",ftype:(e||(e=r("ThriftTypes"))).I64,fid:17}),n.writeI64(BigInt(t.selfSctpNodeId)),n.writeFieldEnd()),t.stateStoreV2!=null){n.writeFieldBegin({fname:"stateStoreV2",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:18}),n.writeMapBegin({ktype:e.I32,vtype:e.STRUCT,size:Object.keys(t.stateStoreV2).length});for(var I of Object.entries(t.stateStoreV2)){var T,D=I[0],x=I[1];n.writeI32((T=Number(D))!=null?T:0),o("StateSyncSerializers").serializeState(x,n)}n.writeMapEnd(),n.writeFieldEnd()}if(t.allowedCustomVideoContentTypes!=null){n.writeFieldBegin({fname:"allowedCustomVideoContentTypes",ftype:(e||(e=r("ThriftTypes"))).SET,fid:19}),n.writeSetBegin({etype:e.I32,size:t.allowedCustomVideoContentTypes.size});for(var $ of t.allowedCustomVideoContentTypes)n.writeI32($!=null?$:0);n.writeSetEnd(),n.writeFieldEnd()}n.writeFieldStop(),n.writeStructEnd()}function Ve(t,n){if(n.writeStructBegin("ConnectRequest"),t.sdp!=null&&(n.writeFieldBegin({fname:"sdp",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:1}),de(t.sdp,n),n.writeFieldEnd()),n.writeFieldBegin({fname:"deviceCapabilities",ftype:(e||(e=r("ThriftTypes"))).SET,fid:3}),t.deviceCapabilities!=null){n.writeSetBegin({etype:(e||(e=r("ThriftTypes"))).I32,size:t.deviceCapabilities.size});for(var a of t.deviceCapabilities)n.writeI32(a!=null?a:0);n.writeSetEnd()}else{var i=new Set;n.writeSetBegin({etype:(e||(e=r("ThriftTypes"))).I32,size:i.size});for(var l of i)n.writeI32(l!=null?l:0);n.writeSetEnd()}if(n.writeFieldEnd(),t.supportedCustomVideoContentTypes!=null){n.writeFieldBegin({fname:"supportedCustomVideoContentTypes",ftype:(e||(e=r("ThriftTypes"))).SET,fid:5}),n.writeSetBegin({etype:e.I32,size:t.supportedCustomVideoContentTypes.size});for(var s of t.supportedCustomVideoContentTypes)n.writeI32(s!=null?s:0);n.writeSetEnd(),n.writeFieldEnd()}t.prOffer!=null&&(n.writeFieldBegin({fname:"prOffer",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:6}),de(t.prOffer,n),n.writeFieldEnd()),t.e2eeEnforcement!=null&&(n.writeFieldBegin({fname:"e2eeEnforcement",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:7}),o("MultiwaySharedSerializers").serializeE2eeEnforcement(t.e2eeEnforcement,n),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function He(t,n){n.writeStructBegin("ConnectResponse"),t.sdp!=null&&(n.writeFieldBegin({fname:"sdp",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:1}),de(t.sdp,n),n.writeFieldEnd()),t.sdpOriginLocalId!=null&&(n.writeFieldBegin({fname:"sdpOriginLocalId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeString(t.sdpOriginLocalId),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function Ge(t,n){if(n.writeStructBegin("ClientEvent"),n.writeFieldBegin({fname:"type",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),t.type!=null){var a;n.writeI32((a=t.type)!=null?a:0)}else{var i=o("MultiwayCommonTypes").ClientEventType.cast(0);n.writeI32(i!=null?i:0)}n.writeFieldEnd(),t.time!=null&&(n.writeFieldBegin({fname:"time",ftype:(e||(e=r("ThriftTypes"))).I64,fid:2}),n.writeI64(BigInt(t.time)),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function ze(t,n){if(n.writeStructBegin("ClientEventRequest"),n.writeFieldBegin({fname:"clientEvents",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:1}),t.clientEvents!=null){n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:t.clientEvents.length});for(var o of t.clientEvents)Ge(o,n);n.writeListEnd()}else{var a=[];n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:a.length});for(var i of a)Ge(i,n);n.writeListEnd()}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function je(t,n){n.writeStructBegin("ThreadIdInfo"),t.groupThreadId!=null&&(n.writeFieldBegin({fname:"groupThreadId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),n.writeString(t.groupThreadId),n.writeFieldEnd()),t.peerId!=null&&(n.writeFieldBegin({fname:"peerId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeString(t.peerId),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function Ke(e,t){t.writeStructBegin("ClientEventResponse"),t.writeFieldStop(),t.writeStructEnd()}function Qe(t,n){if(n.writeStructBegin("RingRequest"),n.writeFieldBegin({fname:"caller",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.caller!=null)n.writeString(t.caller);else{var a="";n.writeString(a)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"otherParticipants",ftype:e.SET,fid:2}),t.otherParticipants!=null){n.writeSetBegin({etype:(e||(e=r("ThriftTypes"))).STRING,size:t.otherParticipants.size});for(var i of t.otherParticipants)n.writeString(i);n.writeSetEnd()}else{var l=new Set;n.writeSetBegin({etype:(e||(e=r("ThriftTypes"))).STRING,size:l.size});for(var s of l)n.writeString(s);n.writeSetEnd()}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"ringType",ftype:e.I32,fid:4}),t.ringType!=null){var u;n.writeI32((u=t.ringType)!=null?u:0)}else{var c=o("MultiwayCommonTypes").RingType.cast(0);n.writeI32(c!=null?c:0)}if(n.writeFieldEnd(),t.offeredExperiments!=null&&(n.writeFieldBegin({fname:"offeredExperiments",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:5}),n.writeString(t.offeredExperiments),n.writeFieldEnd()),t.isScheduledCall!=null&&(n.writeFieldBegin({fname:"isScheduledCall",ftype:(e||(e=r("ThriftTypes"))).BOOL,fid:6}),n.writeBool(t.isScheduledCall),n.writeFieldEnd()),t.appMessages!=null){n.writeFieldBegin({fname:"appMessages",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:8}),n.writeListBegin({etype:e.STRUCT,size:t.appMessages.length});for(var d of t.appMessages)o("DataMessageSerializers").serializeDataMessage(d,n);n.writeListEnd(),n.writeFieldEnd()}if(t.offer!=null&&(n.writeFieldBegin({fname:"offer",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:10}),de(t.offer,n),n.writeFieldEnd()),t.mediaStatusEx!=null&&(n.writeFieldBegin({fname:"mediaStatusEx",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:11}),o("MultiwaySharedSerializers").serializeClientMediaStatus(t.mediaStatusEx,n),n.writeFieldEnd()),t.isPreconnectSupported!=null&&(n.writeFieldBegin({fname:"isPreconnectSupported",ftype:(e||(e=r("ThriftTypes"))).BOOL,fid:12}),n.writeBool(t.isPreconnectSupported),n.writeFieldEnd()),t.sdpOriginLocalId!=null&&(n.writeFieldBegin({fname:"sdpOriginLocalId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:13}),n.writeString(t.sdpOriginLocalId),n.writeFieldEnd()),t.unifiedOffer!=null&&(n.writeFieldBegin({fname:"unifiedOffer",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:14}),de(t.unifiedOffer,n),n.writeFieldEnd()),n.writeFieldBegin({fname:"mediaPath",ftype:e.I32,fid:15}),t.mediaPath!=null){var m;n.writeI32((m=t.mediaPath)!=null?m:0)}else{var p=o("MultiwaySharedTypes").MediaPath.cast(0);n.writeI32(p!=null?p:0)}if(n.writeFieldEnd(),t.e2eeEnforcement!=null&&(n.writeFieldBegin({fname:"e2eeEnforcement",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:16}),o("MultiwaySharedSerializers").serializeE2eeEnforcement(t.e2eeEnforcement,n),n.writeFieldEnd()),t.isLegacyCall!=null&&(n.writeFieldBegin({fname:"isLegacyCall",ftype:(e||(e=r("ThriftTypes"))).BOOL,fid:17}),n.writeBool(t.isLegacyCall),n.writeFieldEnd()),n.writeFieldBegin({fname:"isTransferCall",ftype:e.BOOL,fid:18}),t.isTransferCall!=null)n.writeBool(t.isTransferCall);else{var _=!1;n.writeBool(_)}if(n.writeFieldEnd(),t.relayInfo!=null&&(n.writeFieldBegin({fname:"relayInfo",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:20}),o("MultiwaySharedSerializers").serializeRelayInfo(t.relayInfo,n),n.writeFieldEnd()),t.overlayConfigs!=null){n.writeFieldBegin({fname:"overlayConfigs",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:21}),n.writeMapBegin({ktype:e.I32,vtype:e.I32,size:Object.keys(t.overlayConfigs).length});for(var f of Object.entries(t.overlayConfigs)){var g=f[0],h=f[1];n.writeI32(Number(g)),n.writeI32(h)}n.writeMapEnd(),n.writeFieldEnd()}t.productMetadata!=null&&(n.writeFieldBegin({fname:"productMetadata",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:22}),Ne(t.productMetadata,n),n.writeFieldEnd()),t.callerClientSessionId!=null&&(n.writeFieldBegin({fname:"callerClientSessionId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:23}),n.writeString(t.callerClientSessionId),n.writeFieldEnd()),t.threadIdInfo!=null&&(n.writeFieldBegin({fname:"threadIdInfo",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:24}),je(t.threadIdInfo,n),n.writeFieldEnd()),t.linkUrl!=null&&(n.writeFieldBegin({fname:"linkUrl",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:25}),n.writeString(t.linkUrl),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function Xe(t,n){if(n.writeStructBegin("RingResponse"),n.writeFieldBegin({fname:"deviceStatus",ftype:(e||(e=r("ThriftTypes"))).I32,fid:2}),t.deviceStatus!=null){var a;n.writeI32((a=t.deviceStatus)!=null?a:0)}else{var i=o("MultiwayCommonTypes").DeviceStatus.cast(0);n.writeI32(i!=null?i:0)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function Ye(t,n){if(n.writeStructBegin("RemoveParticipantsRequest"),n.writeFieldBegin({fname:"usersToRemove",ftype:(e||(e=r("ThriftTypes"))).SET,fid:1}),t.usersToRemove!=null){n.writeSetBegin({etype:(e||(e=r("ThriftTypes"))).STRING,size:t.usersToRemove.size});for(var o of t.usersToRemove)n.writeString(o);n.writeSetEnd()}else{var a=new Set;n.writeSetBegin({etype:(e||(e=r("ThriftTypes"))).STRING,size:a.size});for(var i of a)n.writeString(i);n.writeSetEnd()}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function Je(t,n){if(n.writeStructBegin("UnsubscribeRequest"),n.writeFieldBegin({fname:"topic",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.topic!=null)n.writeString(t.topic);else{var a="";n.writeString(a)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"version",ftype:e.I32,fid:2}),t.version!=null)n.writeI32(t.version);else{var i=0;n.writeI32(i)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"topicId",ftype:e.I32,fid:3}),t.topicId!=null){var l;n.writeI32((l=t.topicId)!=null?l:0)}else{var s=o("StateSyncTopicsConfigTypes").TopicId.cast(0);n.writeI32(s!=null?s:0)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function Ze(t,n){if(n.writeStructBegin("UnsubscribeResponse"),n.writeFieldBegin({fname:"topic",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.topic!=null)n.writeString(t.topic);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"version",ftype:e.I32,fid:2}),t.version!=null)n.writeI32(t.version);else{var a=0;n.writeI32(a)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function et(t,n){if(n.writeStructBegin("UpdateRequest"),n.writeFieldBegin({fname:"syncPayload",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:1}),t.syncPayload!=null)he(t.syncPayload,n);else{var a=f();he(a,n)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"topic",ftype:e.STRING,fid:2}),t.topic!=null)n.writeString(t.topic);else{var i="";n.writeString(i)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"version",ftype:e.I32,fid:3}),t.version!=null)n.writeI32(t.version);else{var l=0;n.writeI32(l)}if(n.writeFieldEnd(),t.data!=null&&(n.writeFieldBegin({fname:"data",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:4}),n.writeBinary(t.data),n.writeFieldEnd()),n.writeFieldBegin({fname:"topicId",ftype:e.I32,fid:5}),t.topicId!=null){var s;n.writeI32((s=t.topicId)!=null?s:0)}else{var u=o("StateSyncTopicsConfigTypes").TopicId.cast(0);n.writeI32(u!=null?u:0)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function tt(t,n){if(n.writeStructBegin("UpdateResponse"),n.writeFieldBegin({fname:"topic",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),t.topic!=null)n.writeString(t.topic);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"version",ftype:e.I32,fid:3}),t.version!=null)n.writeI32(t.version);else{var a=0;n.writeI32(a)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function nt(t,n){if(n.writeStructBegin("NotifyRequest"),n.writeFieldBegin({fname:"topic",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),t.topic!=null)n.writeString(t.topic);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"version",ftype:e.I32,fid:3}),t.version!=null)n.writeI32(t.version);else{var a=0;n.writeI32(a)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"data",ftype:e.STRING,fid:4}),t.data!=null)n.writeBinary(t.data);else{var i=Uint8Array.of();n.writeBinary(i)}if(n.writeFieldEnd(),t.syncPayload!=null&&(n.writeFieldBegin({fname:"syncPayload",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:5}),he(t.syncPayload,n),n.writeFieldEnd()),t.topicId!=null){var l;n.writeFieldBegin({fname:"topicId",ftype:(e||(e=r("ThriftTypes"))).I32,fid:6}),n.writeI32((l=t.topicId)!=null?l:0),n.writeFieldEnd()}n.writeFieldStop(),n.writeStructEnd()}function rt(t,n){if(n.writeStructBegin("NotifyResponse"),n.writeFieldBegin({fname:"topic",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),t.topic!=null)n.writeString(t.topic);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"version",ftype:e.I32,fid:3}),t.version!=null)n.writeI32(t.version);else{var a=0;n.writeI32(a)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function ot(t,n){if(n.writeStructBegin("ApprovalRequest"),n.writeFieldBegin({fname:"approvalStatus",ftype:(e||(e=r("ThriftTypes"))).I32,fid:2}),t.approvalStatus!=null){var a;n.writeI32((a=t.approvalStatus)!=null?a:0)}else{var i=o("MultiwayCommonTypes").ApprovalStatus.cast(0);n.writeI32(i!=null?i:0)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"targetUsers",ftype:e.SET,fid:3}),t.targetUsers!=null){n.writeSetBegin({etype:(e||(e=r("ThriftTypes"))).STRING,size:t.targetUsers.size});for(var l of t.targetUsers)n.writeString(l);n.writeSetEnd()}else{var s=new Set;n.writeSetBegin({etype:(e||(e=r("ThriftTypes"))).STRING,size:s.size});for(var u of s)n.writeString(u);n.writeSetEnd()}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function at(t,n){if(n.writeStructBegin("RtcSender"),n.writeFieldBegin({fname:"id",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.id!=null)n.writeString(t.id);else{var o="";n.writeString(o)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function it(t,n){if(n.writeStructBegin("RtcReceiver"),n.writeFieldBegin({fname:"actorId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.actorId!=null)n.writeString(t.actorId);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"baseId",ftype:e.STRING,fid:2}),t.baseId!=null)n.writeString(t.baseId);else{var a="";n.writeString(a)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function lt(t,n){if(n.writeStructBegin("RtcMessageHeader"),n.writeFieldBegin({fname:"type",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),t.type!=null){var a;n.writeI32((a=t.type)!=null?a:0)}else{var i=o("MultiwayCommonTypes").MessageType.cast(0);n.writeI32(i!=null?i:0)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"conferenceName",ftype:e.STRING,fid:2}),t.conferenceName!=null)n.writeString(t.conferenceName);else{var l="";n.writeString(l)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"transactionId",ftype:e.STRING,fid:3}),t.transactionId!=null)n.writeString(t.transactionId);else{var s="";n.writeString(s)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"retryCount",ftype:e.I16,fid:4}),t.retryCount!=null)n.writeI16(t.retryCount);else{var u=0;n.writeI16(u)}if(n.writeFieldEnd(),t.serverInfoData!=null&&(n.writeFieldBegin({fname:"serverInfoData",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:5}),n.writeString(t.serverInfoData),n.writeFieldEnd()),t.responseStatusCode!=null){var c;n.writeFieldBegin({fname:"responseStatusCode",ftype:(e||(e=r("ThriftTypes"))).I32,fid:6}),n.writeI32((c=t.responseStatusCode)!=null?c:0),n.writeFieldEnd()}if(t.extensions!=null){n.writeFieldBegin({fname:"extensions",ftype:(e||(e=r("ThriftTypes"))).MAP,fid:7}),n.writeMapBegin({ktype:e.STRING,vtype:e.STRING,size:Object.keys(t.extensions).length});for(var d of Object.entries(t.extensions)){var m=d[0],p=d[1];n.writeString(m),n.writeString(p)}n.writeMapEnd(),n.writeFieldEnd()}if(t.sequenceNumber!=null&&(n.writeFieldBegin({fname:"sequenceNumber",ftype:(e||(e=r("ThriftTypes"))).I64,fid:8}),n.writeI64(BigInt(t.sequenceNumber)),n.writeFieldEnd()),t.clientSessionId!=null&&(n.writeFieldBegin({fname:"clientSessionId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:9}),n.writeString(t.clientSessionId),n.writeFieldEnd()),t.responseStatusMessage!=null&&(n.writeFieldBegin({fname:"responseStatusMessage",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:10}),n.writeString(t.responseStatusMessage),n.writeFieldEnd()),t.responseSubCode!=null){var _;n.writeFieldBegin({fname:"responseSubCode",ftype:(e||(e=r("ThriftTypes"))).I32,fid:11}),n.writeI32((_=t.responseSubCode)!=null?_:0),n.writeFieldEnd()}if(t.collisionKey!=null&&(n.writeFieldBegin({fname:"collisionKey",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:12}),n.writeString(t.collisionKey),n.writeFieldEnd()),t.conferenceType!=null){var f;n.writeFieldBegin({fname:"conferenceType",ftype:(e||(e=r("ThriftTypes"))).I32,fid:13}),n.writeI32((f=t.conferenceType)!=null?f:0),n.writeFieldEnd()}if(t.serverSessionId!=null&&(n.writeFieldBegin({fname:"serverSessionId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:14}),n.writeString(t.serverSessionId),n.writeFieldEnd()),t.rtcHandle!=null&&(n.writeFieldBegin({fname:"rtcHandle",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:15}),n.writeString(t.rtcHandle),n.writeFieldEnd()),t.retryAfterMsec!=null&&(n.writeFieldBegin({fname:"retryAfterMsec",ftype:(e||(e=r("ThriftTypes"))).I32,fid:16}),n.writeI32(t.retryAfterMsec),n.writeFieldEnd()),t.receiverUserId!=null&&(n.writeFieldBegin({fname:"receiverUserId",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:17}),n.writeString(t.receiverUserId),n.writeFieldEnd()),t.clientStack!=null){var g;n.writeFieldBegin({fname:"clientStack",ftype:(e||(e=r("ThriftTypes"))).I32,fid:18}),n.writeI32((g=t.clientStack)!=null?g:0),n.writeFieldEnd()}if(t.serverMsgTime!=null&&(n.writeFieldBegin({fname:"serverMsgTime",ftype:(e||(e=r("ThriftTypes"))).I64,fid:19}),n.writeI64(BigInt(t.serverMsgTime)),n.writeFieldEnd()),t.sender!=null&&(n.writeFieldBegin({fname:"sender",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:20}),at(t.sender,n),n.writeFieldEnd()),t.receiver!=null&&(n.writeFieldBegin({fname:"receiver",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:21}),it(t.receiver,n),n.writeFieldEnd()),t.messageTags!=null){n.writeFieldBegin({fname:"messageTags",ftype:(e||(e=r("ThriftTypes"))).SET,fid:22}),n.writeSetBegin({etype:e.I32,size:t.messageTags.size});for(var h of t.messageTags)n.writeI32(h!=null?h:0);n.writeSetEnd(),n.writeFieldEnd()}t.conferenceId!=null&&(n.writeFieldBegin({fname:"conferenceId",ftype:(e||(e=r("ThriftTypes"))).I64,fid:23}),n.writeI64(BigInt(t.conferenceId)),n.writeFieldEnd()),t.protocolVersion!=null&&(n.writeFieldBegin({fname:"protocolVersion",ftype:(e||(e=r("ThriftTypes"))).I32,fid:24}),n.writeI32(t.protocolVersion),n.writeFieldEnd()),t.bodyCompressionVersion!=null&&(n.writeFieldBegin({fname:"bodyCompressionVersion",ftype:(e||(e=r("ThriftTypes"))).I64,fid:25}),n.writeI64(BigInt(t.bodyCompressionVersion)),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function st(t,n){n.writeStructBegin("RtcMessageBody"),t.joinRequest!=null&&(n.writeFieldBegin({fname:"joinRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:1}),qe(t.joinRequest,n),n.writeFieldEnd()),t.joinResponse!=null&&(n.writeFieldBegin({fname:"joinResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:2}),Ue(t.joinResponse,n),n.writeFieldEnd()),t.serverMediaUpdateRequest!=null&&(n.writeFieldBegin({fname:"serverMediaUpdateRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:3}),Re(t.serverMediaUpdateRequest,n),n.writeFieldEnd()),t.serverMediaUpdateResponse!=null&&(n.writeFieldBegin({fname:"serverMediaUpdateResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:4}),Le(t.serverMediaUpdateResponse,n),n.writeFieldEnd()),t.hangupRequest!=null&&(n.writeFieldBegin({fname:"hangupRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:5}),ke(t.hangupRequest,n),n.writeFieldEnd()),t.iceCandidateRequest!=null&&(n.writeFieldBegin({fname:"iceCandidateRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:6}),Ie(t.iceCandidateRequest,n),n.writeFieldEnd()),t.ringRequest!=null&&(n.writeFieldBegin({fname:"ringRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:8}),Qe(t.ringRequest,n),n.writeFieldEnd()),t.ringResponse!=null&&(n.writeFieldBegin({fname:"ringResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:9}),Xe(t.ringResponse,n),n.writeFieldEnd()),t.dismissRequest!=null&&(n.writeFieldBegin({fname:"dismissRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:10}),Te(t.dismissRequest,n),n.writeFieldEnd()),t.conferenceStateRequest!=null&&(n.writeFieldBegin({fname:"conferenceStateRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:11}),Me(t.conferenceStateRequest,n),n.writeFieldEnd()),t.conferenceStateResponse!=null&&(n.writeFieldBegin({fname:"conferenceStateResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:12}),we(t.conferenceStateResponse,n),n.writeFieldEnd()),t.addParticipantsRequest!=null&&(n.writeFieldBegin({fname:"addParticipantsRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:13}),Be(t.addParticipantsRequest,n),n.writeFieldEnd()),t.subscriptionRequest!=null&&(n.writeFieldBegin({fname:"subscriptionRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:14}),Ae(t.subscriptionRequest,n),n.writeFieldEnd()),t.clientMediaUpdateRequest!=null&&(n.writeFieldBegin({fname:"clientMediaUpdateRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:15}),be(t.clientMediaUpdateRequest,n),n.writeFieldEnd()),t.clientMediaUpdateResponse!=null&&(n.writeFieldBegin({fname:"clientMediaUpdateResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:16}),ve(t.clientMediaUpdateResponse,n),n.writeFieldEnd()),t.dataMessageRequest!=null&&(n.writeFieldBegin({fname:"dataMessageRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:17}),Fe(t.dataMessageRequest,n),n.writeFieldEnd()),t.removeParticipantsRequest!=null&&(n.writeFieldBegin({fname:"removeParticipantsRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:18}),Ye(t.removeParticipantsRequest,n),n.writeFieldEnd()),t.dataMessageResponse!=null&&(n.writeFieldBegin({fname:"dataMessageResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:19}),Oe(t.dataMessageResponse,n),n.writeFieldEnd()),t.updateRequest!=null&&(n.writeFieldBegin({fname:"updateRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:30}),et(t.updateRequest,n),n.writeFieldEnd()),t.updateResponse!=null&&(n.writeFieldBegin({fname:"updateResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:31}),tt(t.updateResponse,n),n.writeFieldEnd()),t.notifyRequest!=null&&(n.writeFieldBegin({fname:"notifyRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:32}),nt(t.notifyRequest,n),n.writeFieldEnd()),t.notifyResponse!=null&&(n.writeFieldBegin({fname:"notifyResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:33}),rt(t.notifyResponse,n),n.writeFieldEnd()),t.connectRequest!=null&&(n.writeFieldBegin({fname:"connectRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:34}),Ve(t.connectRequest,n),n.writeFieldEnd()),t.connectResponse!=null&&(n.writeFieldBegin({fname:"connectResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:35}),He(t.connectResponse,n),n.writeFieldEnd()),t.clientEventRequest!=null&&(n.writeFieldBegin({fname:"clientEventRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:36}),ze(t.clientEventRequest,n),n.writeFieldEnd()),t.clientEventResponse!=null&&(n.writeFieldBegin({fname:"clientEventResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:37}),Ke(t.clientEventResponse,n),n.writeFieldEnd()),t.unsubscribeRequest!=null&&(n.writeFieldBegin({fname:"unsubscribeRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:40}),Je(t.unsubscribeRequest,n),n.writeFieldEnd()),t.unsubscribeResponse!=null&&(n.writeFieldBegin({fname:"unsubscribeResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:41}),Ze(t.unsubscribeResponse,n),n.writeFieldEnd()),t.approvalRequest!=null&&(n.writeFieldBegin({fname:"approvalRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:42}),ot(t.approvalRequest,n),n.writeFieldEnd()),t.transferRequest!=null&&(n.writeFieldBegin({fname:"transferRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:43}),Ee(t.transferRequest,n),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function ut(t,n){if(n.writeStructBegin("RtcMultiwayMessage"),n.writeFieldBegin({fname:"messageHeader",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:1}),t.messageHeader!=null)lt(t.messageHeader,n);else{var o=ae();lt(o,n)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"messageBody",ftype:e.STRUCT,fid:2}),t.messageBody!=null)st(t.messageBody,n);else{var a=ie();st(a,n)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function ct(t,n){if(n.writeStructBegin("GroupOfUsers"),n.writeFieldBegin({fname:"users",ftype:(e||(e=r("ThriftTypes"))).SET,fid:1}),t.users!=null){n.writeSetBegin({etype:(e||(e=r("ThriftTypes"))).STRING,size:t.users.size});for(var o of t.users)n.writeString(o);n.writeSetEnd()}else{var a=new Set;n.writeSetBegin({etype:(e||(e=r("ThriftTypes"))).STRING,size:a.size});for(var i of a)n.writeString(i);n.writeSetEnd()}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"allowMultipleJoins",ftype:e.BOOL,fid:2}),t.allowMultipleJoins!=null)n.writeBool(t.allowMultipleJoins);else{var l=!1;n.writeBool(l)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"dismissOthersOnFirstJoin",ftype:e.BOOL,fid:3}),t.dismissOthersOnFirstJoin!=null)n.writeBool(t.dismissOthersOnFirstJoin);else{var s=!1;n.writeBool(s)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"aliasId",ftype:e.STRING,fid:4}),t.aliasId!=null)n.writeString(t.aliasId);else{var u="";n.writeString(u)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function dt(t,n){if(n.writeStructBegin("RtcMessageBodyVariant"),t.joinRequest!=null){n.writeFieldBegin({fname:"joinRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:1}),qe(t.joinRequest,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.joinResponse!=null){n.writeFieldBegin({fname:"joinResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:2}),Ue(t.joinResponse,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.serverMediaUpdateRequest!=null){n.writeFieldBegin({fname:"serverMediaUpdateRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:3}),Re(t.serverMediaUpdateRequest,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.serverMediaUpdateResponse!=null){n.writeFieldBegin({fname:"serverMediaUpdateResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:4}),Le(t.serverMediaUpdateResponse,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.hangupRequest!=null){n.writeFieldBegin({fname:"hangupRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:5}),ke(t.hangupRequest,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.iceCandidateRequest!=null){n.writeFieldBegin({fname:"iceCandidateRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:6}),Ie(t.iceCandidateRequest,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.ringRequest!=null){n.writeFieldBegin({fname:"ringRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:8}),Qe(t.ringRequest,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.ringResponse!=null){n.writeFieldBegin({fname:"ringResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:9}),Xe(t.ringResponse,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.dismissRequest!=null){n.writeFieldBegin({fname:"dismissRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:10}),Te(t.dismissRequest,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.conferenceStateRequest!=null){n.writeFieldBegin({fname:"conferenceStateRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:11}),Me(t.conferenceStateRequest,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.conferenceStateResponse!=null){n.writeFieldBegin({fname:"conferenceStateResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:12}),we(t.conferenceStateResponse,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.addParticipantsRequest!=null){n.writeFieldBegin({fname:"addParticipantsRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:13}),Be(t.addParticipantsRequest,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.subscriptionRequest!=null){n.writeFieldBegin({fname:"subscriptionRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:14}),Ae(t.subscriptionRequest,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.clientMediaUpdateRequest!=null){n.writeFieldBegin({fname:"clientMediaUpdateRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:15}),be(t.clientMediaUpdateRequest,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.clientMediaUpdateResponse!=null){n.writeFieldBegin({fname:"clientMediaUpdateResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:16}),ve(t.clientMediaUpdateResponse,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.dataMessageRequest!=null){n.writeFieldBegin({fname:"dataMessageRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:17}),Fe(t.dataMessageRequest,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.removeParticipantsRequest!=null){n.writeFieldBegin({fname:"removeParticipantsRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:18}),Ye(t.removeParticipantsRequest,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.dataMessageResponse!=null){n.writeFieldBegin({fname:"dataMessageResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:19}),Oe(t.dataMessageResponse,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.updateRequest!=null){n.writeFieldBegin({fname:"updateRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:30}),et(t.updateRequest,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.updateResponse!=null){n.writeFieldBegin({fname:"updateResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:31}),tt(t.updateResponse,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.notifyRequest!=null){n.writeFieldBegin({fname:"notifyRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:32}),nt(t.notifyRequest,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.notifyResponse!=null){n.writeFieldBegin({fname:"notifyResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:33}),rt(t.notifyResponse,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.connectRequest!=null){n.writeFieldBegin({fname:"connectRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:34}),Ve(t.connectRequest,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.connectResponse!=null){n.writeFieldBegin({fname:"connectResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:35}),He(t.connectResponse,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.clientEventRequest!=null){n.writeFieldBegin({fname:"clientEventRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:36}),ze(t.clientEventRequest,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.clientEventResponse!=null){n.writeFieldBegin({fname:"clientEventResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:37}),Ke(t.clientEventResponse,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.unsubscribeRequest!=null){n.writeFieldBegin({fname:"unsubscribeRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:40}),Je(t.unsubscribeRequest,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.unsubscribeResponse!=null){n.writeFieldBegin({fname:"unsubscribeResponse",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:41}),Ze(t.unsubscribeResponse,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.approvalRequest!=null){n.writeFieldBegin({fname:"approvalRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:42}),ot(t.approvalRequest,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.transferRequest!=null){n.writeFieldBegin({fname:"transferRequest",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:43}),Ee(t.transferRequest,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}n.writeFieldStop(),n.writeStructEnd()}function mt(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).STRING?n.message=t.readString():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).I32?n.responseStatusCode=o("MultiwayCommonTypes").RtcResponseStatusCode.cast(t.readI32()):t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).I32?n.responseSubCode=o("MultiwayCommonTypes").RtcResponseSubCode.cast(t.readI32()):t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).I32?n.apiStatusCode=o("MultiwayCommonTypes").RtcApiStatusCode.cast(t.readI32()):t.skip(i);break;case 5:i===(e||(e=r("ThriftTypes"))).I32?n.rtcLogSeverity=o("MultiwayCommonTypes").RtcLogSeverity.cast(t.readI32()):t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.message===void 0&&(n.message=""),n.responseStatusCode===void 0&&(n.responseStatusCode=o("MultiwayCommonTypes").RtcResponseStatusCode.cast(0)),n.responseSubCode===void 0&&(n.responseSubCode=o("MultiwayCommonTypes").RtcResponseSubCode.cast(0)),n.apiStatusCode===void 0&&(n.apiStatusCode=o("MultiwayCommonTypes").RtcApiStatusCode.cast(0)),n.rtcLogSeverity===void 0&&(n.rtcLogSeverity=o("MultiwayCommonTypes").RtcLogSeverity.cast(0)),n}function pt(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).STRING?n.sdpString=t.readString():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).STRUCT?n.sdpThrift=o("WebrtcSdpSerializers").deserializeSdp(t):t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).I64?n.sdpCompressionVersion=t.readI64().toString():t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).STRING?n.sdpCompressedData=t.readBinary():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n}function _t(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:if(a===(e||(e=r("ThriftTypes"))).MAP){n.media={};for(var l=t.readMapBegin(),s=0;s<l.size;s++){var u=t.readI32(),c=ft(t);n.media[u]=c}}else t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.media===void 0&&(n.media={}),n}function ft(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.body=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.msid=t.readString():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).STRING?n.mid=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.body===void 0&&(n.body=""),n.msid===void 0&&(n.msid=""),n.mid===void 0&&(n.mid=""),n}function gt(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).STRING?n.sourceKey=t.readString():t.skip(i);break;case 2:if(i===(e||(e=r("ThriftTypes"))).LIST){n.media=[];for(var s=t.readListBegin(),u=0;u<s.size;u++){var c=o("MultiwaySharedSerializers").deserializeMedia(t);n.media.push(c)}}else t.skip(i);break;case 3:if(i===(e||(e=r("ThriftTypes"))).LIST){n.ssrcGroups=[];for(var d=t.readListBegin(),m=0;m<d.size;m++){var p=o("MultiwaySharedSerializers").deserializeSsrcGroup(t);n.ssrcGroups.push(p)}}else t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.sourceKey===void 0&&(n.sourceKey=""),n.media===void 0&&(n.media=[]),n.ssrcGroups===void 0&&(n.ssrcGroups=[]),n}function ht(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:if(i===(e||(e=r("ThriftTypes"))).MAP){n.mediaStatus={};for(var s=t.readMapBegin(),u=0;u<s.size;u++){var c=t.readString(),d=t.readBool();n.mediaStatus[c]=d}}else t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).STRUCT?n.mediaStatusEx=o("MultiwaySharedSerializers").deserializeClientMediaStatus(t):t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.mediaStatus===void 0&&(n.mediaStatus={}),n}function yt(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).STRING?n.candidateSdpString=t.readString():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).I64?n.sdpMLineIndex=t.readI64().toString():t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).STRING?n.sdpMid=t.readString():t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).STRUCT?n.candidateSdpThrift=o("WebrtcSdpSerializers").deserializeIceCandidateSdp(t):t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.sdpMLineIndex===void 0&&(n.sdpMLineIndex="0"),n.sdpMid===void 0&&(n.sdpMid=""),n}function Ct(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:if(i===(e||(e=r("ThriftTypes"))).MAP){n.stateStore={};for(var s=t.readMapBegin(),u=0;u<s.size;u++){var c=t.readString(),d=o("StateSyncSerializers").deserializeState(t);n.stateStore[c]=d}}else t.skip(i);break;case 4:if(i===(e||(e=r("ThriftTypes"))).MAP){n.stateStoreV2={};for(var m=t.readMapBegin(),p=0;p<m.size;p++){var _=o("StateSyncTopicsConfigTypes").TopicId.cast(t.readI32()),f=o("StateSyncSerializers").deserializeState(t);_!=null&&(n.stateStoreV2[_]=f)}}else t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.stateStore===void 0&&(n.stateStore={}),n.stateStoreV2===void 0&&(n.stateStoreV2={}),n}function bt(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).I32?n.version=t.readI32():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.version===void 0&&(n.version=0),n}function vt(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).STRING?n.encryptedTopic=t.readString():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).STRING?n.encryptedData=t.readBinary():t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).STRING?n.senderId=t.readBinary():t.skip(i);break;case 4:if(i===(e||(e=r("ThriftTypes"))).SET){n.targetIds=new Set;for(var s=t.readSetBegin(),u=0;u<s.size;u++){var c=o("Utf8ToString").Utf8ToString(t.readBinary());n.targetIds.add(c)}}else t.skip(i);break;case 5:i===(e||(e=r("ThriftTypes"))).I32?n.messageType=o("MultiwayCommonTypes").E2eeDataMessageType.cast(t.readI32()):t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.encryptedTopic===void 0&&(n.encryptedTopic=""),n.encryptedData===void 0&&(n.encryptedData=Uint8Array.of()),n.senderId===void 0&&(n.senderId=Uint8Array.of()),n.messageType===void 0&&(n.messageType=o("MultiwayCommonTypes").E2eeDataMessageType.cast(0)),n}function St(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).I64?n.fromVersion=t.readI64().toString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).I64?n.toVersion=t.readI64().toString():t.skip(a);break;case 3:if(a===(e||(e=r("ThriftTypes"))).LIST){n.mediaUpdates=[];for(var l=t.readListBegin(),s=0;s<l.size;s++){var u=ht(t);n.mediaUpdates.push(u)}}else t.skip(a);break;case 4:a===(e||(e=r("ThriftTypes"))).STRUCT?n.offer=pt(t):t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.fromVersion===void 0&&(n.fromVersion="0"),n.toVersion===void 0&&(n.toVersion="0"),n.mediaUpdates===void 0&&(n.mediaUpdates=[]),n}function Rt(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I64?n.currentVersion=t.readI64().toString():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).STRUCT?n.answer=pt(t):t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).STRUCT?n.mediaStatus=o("MultiwaySharedSerializers").deserializeClientMediaStatus(t):t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).STRING?n.sdpOriginLocalId=t.readString():t.skip(i);break;case 5:i===(e||(e=r("ThriftTypes"))).STRUCT?n.renegotiationOffer=pt(t):t.skip(i);break;case 6:i===(e||(e=r("ThriftTypes"))).I32?n.mediaPath=o("MultiwaySharedTypes").MediaPath.cast(t.readI32()):t.skip(i);break;case 7:if(i===(e||(e=r("ThriftTypes"))).MAP){n.stateStore={};for(var s=t.readMapBegin(),u=0;u<s.size;u++){var c=t.readString(),d=o("StateSyncSerializers").deserializeState(t);n.stateStore[c]=d}}else t.skip(i);break;case 8:if(i===(e||(e=r("ThriftTypes"))).MAP){n.stateStoreV2={};for(var m=t.readMapBegin(),p=0;p<m.size;p++){var _=o("StateSyncTopicsConfigTypes").TopicId.cast(t.readI32()),f=o("StateSyncSerializers").deserializeState(t);_!=null&&(n.stateStoreV2[_]=f)}}else t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.currentVersion===void 0&&(n.currentVersion="0"),n.mediaPath===void 0&&(n.mediaPath=o("MultiwaySharedTypes").MediaPath.cast(0)),n}function Lt(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.callerUserId=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.calleeUserId=t.readString():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).STRING?n.sessionId=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.callerUserId===void 0&&(n.callerUserId=""),n.calleeUserId===void 0&&(n.calleeUserId=""),n.sessionId===void 0&&(n.sessionId=""),n}function Et(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I64?n.fromVersion=t.readI64().toString():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).I64?n.toVersion=t.readI64().toString():t.skip(i);break;case 3:if(i===(e||(e=r("ThriftTypes"))).LIST){n.mediaUpdates=[];for(var s=t.readListBegin(),u=0;u<s.size;u++){var c=gt(t);n.mediaUpdates.push(c)}}else t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).STRUCT?n.offer=pt(t):t.skip(i);break;case 6:i===(e||(e=r("ThriftTypes"))).STRUCT?n.answer=pt(t):t.skip(i);break;case 7:i===(e||(e=r("ThriftTypes"))).STRUCT?n.mediaStatus=o("MultiwaySharedSerializers").deserializeClientMediaStatus(t):t.skip(i);break;case 8:i===(e||(e=r("ThriftTypes"))).BOOL?n.renegotiationRequested=t.readBool():t.skip(i);break;case 9:i===(e||(e=r("ThriftTypes"))).STRUCT?n.prAnswer=pt(t):t.skip(i);break;case 10:if(i===(e||(e=r("ThriftTypes"))).MAP){n.stateStore={};for(var d=t.readMapBegin(),m=0;m<d.size;m++){var p=t.readString(),_=o("StateSyncSerializers").deserializeState(t);n.stateStore[p]=_}}else t.skip(i);break;case 11:i===(e||(e=r("ThriftTypes"))).STRING?n.sdpOriginLocalId=t.readString():t.skip(i);break;case 12:i===(e||(e=r("ThriftTypes"))).STRUCT?n.multipleRelaysParameters=Lt(t):t.skip(i);break;case 13:i===(e||(e=r("ThriftTypes"))).BOOL?n.multipleVideoStreamsAllowed=t.readBool():t.skip(i);break;case 14:i===(e||(e=r("ThriftTypes"))).STRUCT?n.renegotiationOffer=pt(t):t.skip(i);break;case 15:i===(e||(e=r("ThriftTypes"))).I32?n.mediaPath=o("MultiwaySharedTypes").MediaPath.cast(t.readI32()):t.skip(i);break;case 16:i===(e||(e=r("ThriftTypes"))).STRUCT?n.update=_t(t):t.skip(i);break;case 17:i===(e||(e=r("ThriftTypes"))).BOOL?n.screenShareStreamAllowed=t.readBool():t.skip(i);break;case 18:if(i===(e||(e=r("ThriftTypes"))).MAP){n.stateStoreV2={};for(var f=t.readMapBegin(),g=0;g<f.size;g++){var h=o("StateSyncTopicsConfigTypes").TopicId.cast(t.readI32()),y=o("StateSyncSerializers").deserializeState(t);h!=null&&(n.stateStoreV2[h]=y)}}else t.skip(i);break;case 19:if(i===(e||(e=r("ThriftTypes"))).SET){n.allowedCustomVideoContentTypes=new Set;for(var C=t.readSetBegin(),b=0;b<C.size;b++){var v=o("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(t.readI32());n.allowedCustomVideoContentTypes.add(v)}}else t.skip(i);break;case 20:i===(e||(e=r("ThriftTypes"))).STRUCT?n.relayInfo=o("MultiwaySharedSerializers").deserializeRelayInfo(t):t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.fromVersion===void 0&&(n.fromVersion="0"),n.toVersion===void 0&&(n.toVersion="0"),n.mediaUpdates===void 0&&(n.mediaUpdates=[]),n.renegotiationRequested===void 0&&(n.renegotiationRequested=!1),n.multipleVideoStreamsAllowed===void 0&&(n.multipleVideoStreamsAllowed=!1),n.mediaPath===void 0&&(n.mediaPath=o("MultiwaySharedTypes").MediaPath.cast(0)),n.screenShareStreamAllowed===void 0&&(n.screenShareStreamAllowed=!1),n}function kt(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I64?n.currentVersion=t.readI64().toString():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).STRUCT?n.answer=pt(t):t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).STRUCT?n.mediaStatus=o("MultiwaySharedSerializers").deserializeClientMediaStatus(t):t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.currentVersion===void 0&&(n.currentVersion="0"),n}function It(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;t.skip(a),t.readFieldEnd()}return t.readStructEnd(),n}function Tt(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I32?n.reason=o("MultiwayCommonTypes").HangupReason.cast(t.readI32()):t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).STRING?n.detailedReasonString=t.readString():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.reason===void 0&&(n.reason=o("MultiwayCommonTypes").HangupReason.cast(0)),n.detailedReasonString===void 0&&(n.detailedReasonString=""),n}function Dt(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:if(a===(e||(e=r("ThriftTypes"))).LIST){n.iceCandidateSdps=[];for(var l=t.readListBegin(),s=0;s<l.size;s++){var u=yt(t);n.iceCandidateSdps.push(u)}}else t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.iceCandidateSdps===void 0&&(n.iceCandidateSdps=[]),n}function xt(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I32?n.reason=o("MultiwayCommonTypes").DismissReason.cast(t.readI32()):t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).STRING?n.detailedReasonString=t.readString():t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).I64?n.callabilityResultErrorCode=t.readI64().toString():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.reason===void 0&&(n.reason=o("MultiwayCommonTypes").DismissReason.cast(0)),n.detailedReasonString===void 0&&(n.detailedReasonString=""),n}function $t(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I32?n.joinMode=o("MultiwayCommonTypes").JoinMode.cast(t.readI32()):t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.joinMode===void 0&&(n.joinMode=o("MultiwayCommonTypes").JoinMode.cast(0)),n}function Pt(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I32?n.state=o("MultiwayCommonTypes").ParticipantCallState.cast(t.readI32()):t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).STRING?n.userCapabilities=t.readBinary():t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).I64?n.sctpNodeId=t.readI64().toString():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.state===void 0&&(n.state=o("MultiwayCommonTypes").ParticipantCallState.cast(0)),n}function Nt(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.userCountry=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n}function Mt(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.name=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.profilePictureUri=t.readString():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).STRING?n.aliasId=t.readString():t.skip(a);break;case 4:a===(e||(e=r("ThriftTypes"))).STRING?n.thirdPartyId=t.readString():t.skip(a);break;case 5:a===(e||(e=r("ThriftTypes"))).STRING?n.groupId=t.readString():t.skip(a);break;case 6:a===(e||(e=r("ThriftTypes"))).STRING?n.avatarImageUri=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n}function wt(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRUCT?n.callerInfo=Mt(t):t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.liveBroadcastId=t.readString():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).I32?n.callingTags=t.readI32():t.skip(a);break;case 4:a===(e||(e=r("ThriftTypes"))).STRING?n.backingIdentifier=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n}function At(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I64?n.version=t.readI64().toString():t.skip(i);break;case 2:if(i===(e||(e=r("ThriftTypes"))).MAP){n.participantStates={};for(var s=t.readMapBegin(),u=0;u<s.size;u++){var c=t.readString(),d=Pt(t);n.participantStates[c]=d}}else t.skip(i);break;case 3:if(i===(e||(e=r("ThriftTypes"))).MAP){n.userProfiles={};for(var m=t.readMapBegin(),p=0;p<m.size;p++){var _=t.readString(),f=Mt(t);n.userProfiles[_]=f}}else t.skip(i);break;case 4:if(i===(e||(e=r("ThriftTypes"))).LIST){n.appMessages=[];for(var g=t.readListBegin(),h=0;h<g.size;h++){var y=o("DataMessageSerializers").deserializeDataMessage(t);n.appMessages.push(y)}}else t.skip(i);break;case 5:if(i===(e||(e=r("ThriftTypes"))).LIST){n.groupsOfUsers=[];for(var C=t.readListBegin(),b=0;b<C.size;b++){var v=pn(t);n.groupsOfUsers.push(v)}}else t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.version===void 0&&(n.version="0"),n.participantStates===void 0&&(n.participantStates={}),n.groupsOfUsers===void 0&&(n.groupsOfUsers=[]),n}function Ft(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).I64?n.currentVersion=t.readI64().toString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.currentVersion===void 0&&(n.currentVersion="0"),n}function Ot(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:if(i===(e||(e=r("ThriftTypes"))).LIST){n.subscriptions=[];for(var s=t.readListBegin(),u=0;u<s.size;u++){var c=o("MultiwaySharedSerializers").deserializeSubscription(t);n.subscriptions.push(c)}}else t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.subscriptions===void 0&&(n.subscriptions=[]),n}function Bt(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).STRUCT?n.message=o("DataMessageSerializers").deserializeDataMessage(t):t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.message===void 0&&(n.message=o("DataMessageSerializers").DataMessage$DefaultConstructor()),n}function Wt(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:if(i===(e||(e=r("ThriftTypes"))).MAP){n.deliveryResult={};for(var s=t.readMapBegin(),u=0;u<s.size;u++){var c=t.readString(),d=o("DataMessageTypes").DataMessageStatusCode.cast(t.readI32());n.deliveryResult[c]=d}}else t.skip(i);break;case 2:if(i===(e||(e=r("ThriftTypes"))).MAP){n.serviceTypeDeliveryResult={};for(var m=t.readMapBegin(),p=0;p<m.size;p++){var _=o("MultiwaySharedTypes").EndpointServiceType.cast(t.readI32()),f=o("DataMessageTypes").DataMessageStatusCode.cast(t.readI32());_!=null&&(n.serviceTypeDeliveryResult[_]=f)}}else t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.deliveryResult===void 0&&(n.deliveryResult={}),n}function qt(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:if(i===(e||(e=r("ThriftTypes"))).SET){n.usersToInvite=new Set;for(var s=t.readSetBegin(),u=0;u<s.size;u++){var c=t.readString();n.usersToInvite.add(c)}}else t.skip(i);break;case 2:if(i===(e||(e=r("ThriftTypes"))).LIST){n.appMessages=[];for(var d=t.readListBegin(),m=0;m<d.size;m++){var p=o("DataMessageSerializers").deserializeDataMessage(t);n.appMessages.push(p)}}else t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.usersToInvite===void 0&&(n.usersToInvite=new Set),n}function Ut(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.smcTier=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.region=t.readString():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).BOOL?n.isUsfu=t.readBool():t.skip(a);break;case 4:a===(e||(e=r("ThriftTypes"))).BOOL?n.isEdge=t.readBool():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.smcTier===void 0&&(n.smcTier=""),n.region===void 0&&(n.region=""),n.isUsfu===void 0&&(n.isUsfu=!1),n.isEdge===void 0&&(n.isEdge=!1),n}function Vt(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).STRUCT?n.offer=pt(t):t.skip(i);break;case 2:if(i===(e||(e=r("ThriftTypes"))).SET){n.deviceCapabilities=new Set;for(var s=t.readSetBegin(),c=0;c<s.size;c++){var d=o("MultiwayCommonTypes").Capability.cast(t.readI32());n.deviceCapabilities.add(d)}}else t.skip(i);break;case 3:if(i===(e||(e=r("ThriftTypes"))).SET){n.usersToCall=new Set;for(var m=t.readSetBegin(),p=0;p<m.size;p++){var _=t.readString();n.usersToCall.add(_)}}else t.skip(i);break;case 4:if(i===(e||(e=r("ThriftTypes"))).MAP){n.mediaStatus={};for(var f=t.readMapBegin(),g=0;g<f.size;g++){var h=t.readString(),y=t.readBool();n.mediaStatus[h]=y}}else t.skip(i);break;case 5:i===(e||(e=r("ThriftTypes"))).STRING?n.userCapabilities=t.readBinary():t.skip(i);break;case 6:i===(e||(e=r("ThriftTypes"))).STRING?n.supportedExperiments=t.readString():t.skip(i);break;case 9:if(i===(e||(e=r("ThriftTypes"))).LIST){n.appMessages=[];for(var C=t.readListBegin(),b=0;b<C.size;b++){var v=o("DataMessageSerializers").deserializeDataMessage(t);n.appMessages.push(v)}}else t.skip(i);break;case 10:i===(e||(e=r("ThriftTypes"))).STRING?n.userToEscalate=t.readString():t.skip(i);break;case 11:i===(e||(e=r("ThriftTypes"))).I64?n.escalatingCallId=t.readI64().toString():t.skip(i);break;case 12:i===(e||(e=r("ThriftTypes"))).I32?n.conferenceType=o("MultiwaySharedTypes").ConferenceType.cast(t.readI32()):t.skip(i);break;case 13:i===(e||(e=r("ThriftTypes"))).STRUCT?n.mediaStatusEx=o("MultiwaySharedSerializers").deserializeClientMediaStatus(t):t.skip(i);break;case 14:i===(e||(e=r("ThriftTypes"))).STRUCT?n.answer=pt(t):t.skip(i);break;case 15:i===(e||(e=r("ThriftTypes"))).STRUCT?n.syncPayload=Ct(t):t.skip(i);break;case 16:if(i===(e||(e=r("ThriftTypes"))).SET){n.usersToApproveFromWaitingRoom=new Set;for(var S=t.readSetBegin(),R=0;R<S.size;R++){var L=t.readString();n.usersToApproveFromWaitingRoom.add(L)}}else t.skip(i);break;case 17:i===(e||(e=r("ThriftTypes"))).STRUCT?n.e2eeEnforcement=o("MultiwaySharedSerializers").deserializeE2eeEnforcement(t):t.skip(i);break;case 18:i===(e||(e=r("ThriftTypes"))).STRUCT?n.sfuAllocation=Ut(t):t.skip(i);break;case 19:i===(e||(e=r("ThriftTypes"))).I32?n.clientMediaMode=o("MultiwaySharedTypes").MediaPath.cast(t.readI32()):t.skip(i);break;case 20:i===(e||(e=r("ThriftTypes"))).STRUCT?n.endpointSettings=$t(t):t.skip(i);break;case 21:i===(e||(e=r("ThriftTypes"))).STRUCT?n.backupSfuAllocation=Ut(t):t.skip(i);break;case 22:if(i===(e||(e=r("ThriftTypes"))).SET){n.supportedCustomVideoContentTypes=new Set;for(var E=t.readSetBegin(),k=0;k<E.size;k++){var I=o("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(t.readI32());n.supportedCustomVideoContentTypes.add(I)}}else t.skip(i);break;case 23:i===(e||(e=r("ThriftTypes"))).I32?n.configIntegrityOpaqueToken=t.readI32():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.offer===void 0&&(n.offer=u()),n.deviceCapabilities===void 0&&(n.deviceCapabilities=new Set),n}function Ht(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).STRUCT?n.answer=pt(t):t.skip(i);break;case 2:if(i===(e||(e=r("ThriftTypes"))).MAP){n.mediaStatus={};for(var s=t.readMapBegin(),c=0;c<s.size;c++){var d=t.readString(),m=t.readBool();n.mediaStatus[d]=m}}else t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).STRING?n.initiator=t.readString():t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).STRING?n.negotiatedExperiments=t.readString():t.skip(i);break;case 6:i===(e||(e=r("ThriftTypes"))).STRUCT?n.mediaStatusEx=o("MultiwaySharedSerializers").deserializeClientMediaStatus(t):t.skip(i);break;case 7:if(i===(e||(e=r("ThriftTypes"))).LIST){n.appMessages=[];for(var p=t.readListBegin(),_=0;_<p.size;_++){var f=o("DataMessageSerializers").deserializeDataMessage(t);n.appMessages.push(f)}}else t.skip(i);break;case 8:if(i===(e||(e=r("ThriftTypes"))).MAP){n.stateStore={};for(var g=t.readMapBegin(),h=0;h<g.size;h++){var y=t.readString(),C=o("StateSyncSerializers").deserializeState(t);n.stateStore[y]=C}}else t.skip(i);break;case 9:i===(e||(e=r("ThriftTypes"))).STRING?n.sdpOriginLocalId=t.readString():t.skip(i);break;case 10:i===(e||(e=r("ThriftTypes"))).BOOL?n.isPendingApproval=t.readBool():t.skip(i);break;case 11:i===(e||(e=r("ThriftTypes"))).STRUCT?n.renegotiationOffer=pt(t):t.skip(i);break;case 12:i===(e||(e=r("ThriftTypes"))).BOOL?n.multipleVideoStreamsAllowed=t.readBool():t.skip(i);break;case 13:i===(e||(e=r("ThriftTypes"))).I32?n.mediaPath=o("MultiwaySharedTypes").MediaPath.cast(t.readI32()):t.skip(i);break;case 14:if(i===(e||(e=r("ThriftTypes"))).LIST){n.groupsOfUsers=[];for(var b=t.readListBegin(),v=0;v<b.size;v++){var S=pn(t);n.groupsOfUsers.push(S)}}else t.skip(i);break;case 15:i===(e||(e=r("ThriftTypes"))).BOOL?n.screenShareStreamAllowed=t.readBool():t.skip(i);break;case 16:i===(e||(e=r("ThriftTypes"))).STRUCT?n.relayInfo=o("MultiwaySharedSerializers").deserializeRelayInfo(t):t.skip(i);break;case 17:i===(e||(e=r("ThriftTypes"))).I64?n.selfSctpNodeId=t.readI64().toString():t.skip(i);break;case 18:if(i===(e||(e=r("ThriftTypes"))).MAP){n.stateStoreV2={};for(var R=t.readMapBegin(),L=0;L<R.size;L++){var E=o("StateSyncTopicsConfigTypes").TopicId.cast(t.readI32()),k=o("StateSyncSerializers").deserializeState(t);E!=null&&(n.stateStoreV2[E]=k)}}else t.skip(i);break;case 19:if(i===(e||(e=r("ThriftTypes"))).SET){n.allowedCustomVideoContentTypes=new Set;for(var I=t.readSetBegin(),T=0;T<I.size;T++){var D=o("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(t.readI32());n.allowedCustomVideoContentTypes.add(D)}}else t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.answer===void 0&&(n.answer=u()),n.mediaStatus===void 0&&(n.mediaStatus={}),n.initiator===void 0&&(n.initiator=""),n.isPendingApproval===void 0&&(n.isPendingApproval=!1),n.multipleVideoStreamsAllowed===void 0&&(n.multipleVideoStreamsAllowed=!1),n.mediaPath===void 0&&(n.mediaPath=o("MultiwaySharedTypes").MediaPath.cast(0)),n.groupsOfUsers===void 0&&(n.groupsOfUsers=[]),n.screenShareStreamAllowed===void 0&&(n.screenShareStreamAllowed=!1),n}function Gt(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).STRUCT?n.sdp=pt(t):t.skip(i);break;case 3:if(i===(e||(e=r("ThriftTypes"))).SET){n.deviceCapabilities=new Set;for(var s=t.readSetBegin(),u=0;u<s.size;u++){var c=o("MultiwayCommonTypes").Capability.cast(t.readI32());n.deviceCapabilities.add(c)}}else t.skip(i);break;case 5:if(i===(e||(e=r("ThriftTypes"))).SET){n.supportedCustomVideoContentTypes=new Set;for(var d=t.readSetBegin(),m=0;m<d.size;m++){var p=o("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(t.readI32());n.supportedCustomVideoContentTypes.add(p)}}else t.skip(i);break;case 6:i===(e||(e=r("ThriftTypes"))).STRUCT?n.prOffer=pt(t):t.skip(i);break;case 7:i===(e||(e=r("ThriftTypes"))).STRUCT?n.e2eeEnforcement=o("MultiwaySharedSerializers").deserializeE2eeEnforcement(t):t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.deviceCapabilities===void 0&&(n.deviceCapabilities=new Set),n}function zt(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRUCT?n.sdp=pt(t):t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.sdpOriginLocalId=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n}function jt(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I32?n.type=o("MultiwayCommonTypes").ClientEventType.cast(t.readI32()):t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).I64?n.time=t.readI64().toString():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.type===void 0&&(n.type=o("MultiwayCommonTypes").ClientEventType.cast(0)),n}function Kt(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:if(a===(e||(e=r("ThriftTypes"))).LIST){n.clientEvents=[];for(var l=t.readListBegin(),s=0;s<l.size;s++){var u=jt(t);n.clientEvents.push(u)}}else t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.clientEvents===void 0&&(n.clientEvents=[]),n}function Qt(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.groupThreadId=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.peerId=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n}function Xt(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;t.skip(a),t.readFieldEnd()}return t.readStructEnd(),n}function Yt(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).STRING?n.caller=t.readString():t.skip(i);break;case 2:if(i===(e||(e=r("ThriftTypes"))).SET){n.otherParticipants=new Set;for(var s=t.readSetBegin(),u=0;u<s.size;u++){var c=t.readString();n.otherParticipants.add(c)}}else t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).I32?n.ringType=o("MultiwayCommonTypes").RingType.cast(t.readI32()):t.skip(i);break;case 5:i===(e||(e=r("ThriftTypes"))).STRING?n.offeredExperiments=t.readString():t.skip(i);break;case 6:i===(e||(e=r("ThriftTypes"))).BOOL?n.isScheduledCall=t.readBool():t.skip(i);break;case 8:if(i===(e||(e=r("ThriftTypes"))).LIST){n.appMessages=[];for(var d=t.readListBegin(),m=0;m<d.size;m++){var p=o("DataMessageSerializers").deserializeDataMessage(t);n.appMessages.push(p)}}else t.skip(i);break;case 10:i===(e||(e=r("ThriftTypes"))).STRUCT?n.offer=pt(t):t.skip(i);break;case 11:i===(e||(e=r("ThriftTypes"))).STRUCT?n.mediaStatusEx=o("MultiwaySharedSerializers").deserializeClientMediaStatus(t):t.skip(i);break;case 12:i===(e||(e=r("ThriftTypes"))).BOOL?n.isPreconnectSupported=t.readBool():t.skip(i);break;case 13:i===(e||(e=r("ThriftTypes"))).STRING?n.sdpOriginLocalId=t.readString():t.skip(i);break;case 14:i===(e||(e=r("ThriftTypes"))).STRUCT?n.unifiedOffer=pt(t):t.skip(i);break;case 15:i===(e||(e=r("ThriftTypes"))).I32?n.mediaPath=o("MultiwaySharedTypes").MediaPath.cast(t.readI32()):t.skip(i);break;case 16:i===(e||(e=r("ThriftTypes"))).STRUCT?n.e2eeEnforcement=o("MultiwaySharedSerializers").deserializeE2eeEnforcement(t):t.skip(i);break;case 17:i===(e||(e=r("ThriftTypes"))).BOOL?n.isLegacyCall=t.readBool():t.skip(i);break;case 18:i===(e||(e=r("ThriftTypes"))).BOOL?n.isTransferCall=t.readBool():t.skip(i);break;case 20:i===(e||(e=r("ThriftTypes"))).STRUCT?n.relayInfo=o("MultiwaySharedSerializers").deserializeRelayInfo(t):t.skip(i);break;case 21:if(i===(e||(e=r("ThriftTypes"))).MAP){n.overlayConfigs={};for(var _=t.readMapBegin(),f=0;f<_.size;f++){var g=t.readI32(),h=t.readI32();n.overlayConfigs[g]=h}}else t.skip(i);break;case 22:i===(e||(e=r("ThriftTypes"))).STRUCT?n.productMetadata=wt(t):t.skip(i);break;case 23:i===(e||(e=r("ThriftTypes"))).STRING?n.callerClientSessionId=t.readString():t.skip(i);break;case 24:i===(e||(e=r("ThriftTypes"))).STRUCT?n.threadIdInfo=Qt(t):t.skip(i);break;case 25:i===(e||(e=r("ThriftTypes"))).STRING?n.linkUrl=t.readString():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.caller===void 0&&(n.caller=""),n.otherParticipants===void 0&&(n.otherParticipants=new Set),n.ringType===void 0&&(n.ringType=o("MultiwayCommonTypes").RingType.cast(0)),n.mediaPath===void 0&&(n.mediaPath=o("MultiwaySharedTypes").MediaPath.cast(0)),n.isTransferCall===void 0&&(n.isTransferCall=!1),n}function Jt(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 2:i===(e||(e=r("ThriftTypes"))).I32?n.deviceStatus=o("MultiwayCommonTypes").DeviceStatus.cast(t.readI32()):t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.deviceStatus===void 0&&(n.deviceStatus=o("MultiwayCommonTypes").DeviceStatus.cast(0)),n}function Zt(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:if(a===(e||(e=r("ThriftTypes"))).SET){n.usersToRemove=new Set;for(var l=t.readSetBegin(),s=0;s<l.size;s++){var u=t.readString();n.usersToRemove.add(u)}}else t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.usersToRemove===void 0&&(n.usersToRemove=new Set),n}function en(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).STRING?n.topic=t.readString():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).I32?n.version=t.readI32():t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).I32?n.topicId=o("StateSyncTopicsConfigTypes").TopicId.cast(t.readI32()):t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.topic===void 0&&(n.topic=""),n.version===void 0&&(n.version=0),n.topicId===void 0&&(n.topicId=o("StateSyncTopicsConfigTypes").TopicId.cast(0)),n}function tn(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.topic=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).I32?n.version=t.readI32():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.topic===void 0&&(n.topic=""),n.version===void 0&&(n.version=0),n}function nn(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).STRUCT?n.syncPayload=Ct(t):t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).STRING?n.topic=t.readString():t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).I32?n.version=t.readI32():t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).STRING?n.data=t.readBinary():t.skip(i);break;case 5:i===(e||(e=r("ThriftTypes"))).I32?n.topicId=o("StateSyncTopicsConfigTypes").TopicId.cast(t.readI32()):t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.syncPayload===void 0&&(n.syncPayload=f()),n.topic===void 0&&(n.topic=""),n.version===void 0&&(n.version=0),n.topicId===void 0&&(n.topicId=o("StateSyncTopicsConfigTypes").TopicId.cast(0)),n}function rn(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.topic=t.readString():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).I32?n.version=t.readI32():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.topic===void 0&&(n.topic=""),n.version===void 0&&(n.version=0),n}function on(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 2:i===(e||(e=r("ThriftTypes"))).STRING?n.topic=t.readString():t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).I32?n.version=t.readI32():t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).STRING?n.data=t.readBinary():t.skip(i);break;case 5:i===(e||(e=r("ThriftTypes"))).STRUCT?n.syncPayload=Ct(t):t.skip(i);break;case 6:i===(e||(e=r("ThriftTypes"))).I32?n.topicId=o("StateSyncTopicsConfigTypes").TopicId.cast(t.readI32()):t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.topic===void 0&&(n.topic=""),n.version===void 0&&(n.version=0),n.data===void 0&&(n.data=Uint8Array.of()),n}function an(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.topic=t.readString():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).I32?n.version=t.readI32():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.topic===void 0&&(n.topic=""),n.version===void 0&&(n.version=0),n}function ln(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 2:i===(e||(e=r("ThriftTypes"))).I32?n.approvalStatus=o("MultiwayCommonTypes").ApprovalStatus.cast(t.readI32()):t.skip(i);break;case 3:if(i===(e||(e=r("ThriftTypes"))).SET){n.targetUsers=new Set;for(var s=t.readSetBegin(),u=0;u<s.size;u++){var c=t.readString();n.targetUsers.add(c)}}else t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.approvalStatus===void 0&&(n.approvalStatus=o("MultiwayCommonTypes").ApprovalStatus.cast(0)),n.targetUsers===void 0&&(n.targetUsers=new Set),n}function sn(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.id=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.id===void 0&&(n.id=""),n}function un(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.actorId=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.baseId=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.actorId===void 0&&(n.actorId=""),n.baseId===void 0&&(n.baseId=""),n}function cn(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I32?n.type=o("MultiwayCommonTypes").MessageType.cast(t.readI32()):t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).STRING?n.conferenceName=t.readString():t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).STRING?n.transactionId=t.readString():t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).I16?n.retryCount=t.readI16():t.skip(i);break;case 5:i===(e||(e=r("ThriftTypes"))).STRING?n.serverInfoData=t.readString():t.skip(i);break;case 6:i===(e||(e=r("ThriftTypes"))).I32?n.responseStatusCode=o("MultiwayCommonTypes").RtcResponseStatusCode.cast(t.readI32()):t.skip(i);break;case 7:if(i===(e||(e=r("ThriftTypes"))).MAP){n.extensions={};for(var s=t.readMapBegin(),u=0;u<s.size;u++){var c=t.readString(),d=t.readString();n.extensions[c]=d}}else t.skip(i);break;case 8:i===(e||(e=r("ThriftTypes"))).I64?n.sequenceNumber=t.readI64().toString():t.skip(i);break;case 9:i===(e||(e=r("ThriftTypes"))).STRING?n.clientSessionId=t.readString():t.skip(i);break;case 10:i===(e||(e=r("ThriftTypes"))).STRING?n.responseStatusMessage=t.readString():t.skip(i);break;case 11:i===(e||(e=r("ThriftTypes"))).I32?n.responseSubCode=o("MultiwayCommonTypes").RtcResponseSubCode.cast(t.readI32()):t.skip(i);break;case 12:i===(e||(e=r("ThriftTypes"))).STRING?n.collisionKey=t.readString():t.skip(i);break;case 13:i===(e||(e=r("ThriftTypes"))).I32?n.conferenceType=o("MultiwaySharedTypes").ConferenceType.cast(t.readI32()):t.skip(i);break;case 14:i===(e||(e=r("ThriftTypes"))).STRING?n.serverSessionId=t.readString():t.skip(i);break;case 15:i===(e||(e=r("ThriftTypes"))).STRING?n.rtcHandle=t.readString():t.skip(i);break;case 16:i===(e||(e=r("ThriftTypes"))).I32?n.retryAfterMsec=t.readI32():t.skip(i);break;case 17:i===(e||(e=r("ThriftTypes"))).STRING?n.receiverUserId=t.readString():t.skip(i);break;case 18:i===(e||(e=r("ThriftTypes"))).I32?n.clientStack=o("WebrtcSignalingCommonTypes").ClientStack.cast(t.readI32()):t.skip(i);break;case 19:i===(e||(e=r("ThriftTypes"))).I64?n.serverMsgTime=t.readI64().toString():t.skip(i);break;case 20:i===(e||(e=r("ThriftTypes"))).STRUCT?n.sender=sn(t):t.skip(i);break;case 21:i===(e||(e=r("ThriftTypes"))).STRUCT?n.receiver=un(t):t.skip(i);break;case 22:if(i===(e||(e=r("ThriftTypes"))).SET){n.messageTags=new Set;for(var m=t.readSetBegin(),p=0;p<m.size;p++){var _=o("MultiwayCommonTypes").MessageTag.cast(t.readI32());n.messageTags.add(_)}}else t.skip(i);break;case 23:i===(e||(e=r("ThriftTypes"))).I64?n.conferenceId=t.readI64().toString():t.skip(i);break;case 24:i===(e||(e=r("ThriftTypes"))).I32?n.protocolVersion=t.readI32():t.skip(i);break;case 25:i===(e||(e=r("ThriftTypes"))).I64?n.bodyCompressionVersion=t.readI64().toString():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.type===void 0&&(n.type=o("MultiwayCommonTypes").MessageType.cast(0)),n.conferenceName===void 0&&(n.conferenceName=""),n.transactionId===void 0&&(n.transactionId=""),n.retryCount===void 0&&(n.retryCount=0),n}function dn(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRUCT?n.joinRequest=Vt(t):t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRUCT?n.joinResponse=Ht(t):t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).STRUCT?n.serverMediaUpdateRequest=Et(t):t.skip(a);break;case 4:a===(e||(e=r("ThriftTypes"))).STRUCT?n.serverMediaUpdateResponse=kt(t):t.skip(a);break;case 5:a===(e||(e=r("ThriftTypes"))).STRUCT?n.hangupRequest=Tt(t):t.skip(a);break;case 6:a===(e||(e=r("ThriftTypes"))).STRUCT?n.iceCandidateRequest=Dt(t):t.skip(a);break;case 8:a===(e||(e=r("ThriftTypes"))).STRUCT?n.ringRequest=Yt(t):t.skip(a);break;case 9:a===(e||(e=r("ThriftTypes"))).STRUCT?n.ringResponse=Jt(t):t.skip(a);break;case 10:a===(e||(e=r("ThriftTypes"))).STRUCT?n.dismissRequest=xt(t):t.skip(a);break;case 11:a===(e||(e=r("ThriftTypes"))).STRUCT?n.conferenceStateRequest=At(t):t.skip(a);break;case 12:a===(e||(e=r("ThriftTypes"))).STRUCT?n.conferenceStateResponse=Ft(t):t.skip(a);break;case 13:a===(e||(e=r("ThriftTypes"))).STRUCT?n.addParticipantsRequest=qt(t):t.skip(a);break;case 14:a===(e||(e=r("ThriftTypes"))).STRUCT?n.subscriptionRequest=Ot(t):t.skip(a);break;case 15:a===(e||(e=r("ThriftTypes"))).STRUCT?n.clientMediaUpdateRequest=St(t):t.skip(a);break;case 16:a===(e||(e=r("ThriftTypes"))).STRUCT?n.clientMediaUpdateResponse=Rt(t):t.skip(a);break;case 17:a===(e||(e=r("ThriftTypes"))).STRUCT?n.dataMessageRequest=Bt(t):t.skip(a);break;case 18:a===(e||(e=r("ThriftTypes"))).STRUCT?n.removeParticipantsRequest=Zt(t):t.skip(a);break;case 19:a===(e||(e=r("ThriftTypes"))).STRUCT?n.dataMessageResponse=Wt(t):t.skip(a);break;case 30:a===(e||(e=r("ThriftTypes"))).STRUCT?n.updateRequest=nn(t):t.skip(a);break;case 31:a===(e||(e=r("ThriftTypes"))).STRUCT?n.updateResponse=rn(t):t.skip(a);break;case 32:a===(e||(e=r("ThriftTypes"))).STRUCT?n.notifyRequest=on(t):t.skip(a);break;case 33:a===(e||(e=r("ThriftTypes"))).STRUCT?n.notifyResponse=an(t):t.skip(a);break;case 34:a===(e||(e=r("ThriftTypes"))).STRUCT?n.connectRequest=Gt(t):t.skip(a);break;case 35:a===(e||(e=r("ThriftTypes"))).STRUCT?n.connectResponse=zt(t):t.skip(a);break;case 36:a===(e||(e=r("ThriftTypes"))).STRUCT?n.clientEventRequest=Kt(t):t.skip(a);break;case 37:a===(e||(e=r("ThriftTypes"))).STRUCT?n.clientEventResponse=Xt(t):t.skip(a);break;case 40:a===(e||(e=r("ThriftTypes"))).STRUCT?n.unsubscribeRequest=en(t):t.skip(a);break;case 41:a===(e||(e=r("ThriftTypes"))).STRUCT?n.unsubscribeResponse=tn(t):t.skip(a);break;case 42:a===(e||(e=r("ThriftTypes"))).STRUCT?n.approvalRequest=ln(t):t.skip(a);break;case 43:a===(e||(e=r("ThriftTypes"))).STRUCT?n.transferRequest=It(t):t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n}function mn(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRUCT?n.messageHeader=cn(t):t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRUCT?n.messageBody=dn(t):t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.messageHeader===void 0&&(n.messageHeader=ae()),n.messageBody===void 0&&(n.messageBody=ie()),n}function pn(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:if(a===(e||(e=r("ThriftTypes"))).SET){n.users=new Set;for(var l=t.readSetBegin(),s=0;s<l.size;s++){var u=t.readString();n.users.add(u)}}else t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).BOOL?n.allowMultipleJoins=t.readBool():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).BOOL?n.dismissOthersOnFirstJoin=t.readBool():t.skip(a);break;case 4:a===(e||(e=r("ThriftTypes"))).STRING?n.aliasId=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.users===void 0&&(n.users=new Set),n.allowMultipleJoins===void 0&&(n.allowMultipleJoins=!1),n.dismissOthersOnFirstJoin===void 0&&(n.dismissOthersOnFirstJoin=!1),n.aliasId===void 0&&(n.aliasId=""),n}function _n(t){var n,o={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.joinRequest=Vt(t),n="joinRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: joinRequest, previous deserialized field: "+n);else t.skip(i);break;case 2:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.joinResponse=Ht(t),n="joinResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: joinResponse, previous deserialized field: "+n);else t.skip(i);break;case 3:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.serverMediaUpdateRequest=Et(t),n="serverMediaUpdateRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: serverMediaUpdateRequest, previous deserialized field: "+n);else t.skip(i);break;case 4:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.serverMediaUpdateResponse=kt(t),n="serverMediaUpdateResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: serverMediaUpdateResponse, previous deserialized field: "+n);else t.skip(i);break;case 5:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.hangupRequest=Tt(t),n="hangupRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: hangupRequest, previous deserialized field: "+n);else t.skip(i);break;case 6:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.iceCandidateRequest=Dt(t),n="iceCandidateRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: iceCandidateRequest, previous deserialized field: "+n);else t.skip(i);break;case 8:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.ringRequest=Yt(t),n="ringRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: ringRequest, previous deserialized field: "+n);else t.skip(i);break;case 9:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.ringResponse=Jt(t),n="ringResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: ringResponse, previous deserialized field: "+n);else t.skip(i);break;case 10:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.dismissRequest=xt(t),n="dismissRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: dismissRequest, previous deserialized field: "+n);else t.skip(i);break;case 11:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.conferenceStateRequest=At(t),n="conferenceStateRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: conferenceStateRequest, previous deserialized field: "+n);else t.skip(i);break;case 12:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.conferenceStateResponse=Ft(t),n="conferenceStateResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: conferenceStateResponse, previous deserialized field: "+n);else t.skip(i);break;case 13:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.addParticipantsRequest=qt(t),n="addParticipantsRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: addParticipantsRequest, previous deserialized field: "+n);else t.skip(i);break;case 14:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.subscriptionRequest=Ot(t),n="subscriptionRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: subscriptionRequest, previous deserialized field: "+n);else t.skip(i);break;case 15:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.clientMediaUpdateRequest=St(t),n="clientMediaUpdateRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: clientMediaUpdateRequest, previous deserialized field: "+n);else t.skip(i);break;case 16:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.clientMediaUpdateResponse=Rt(t),n="clientMediaUpdateResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: clientMediaUpdateResponse, previous deserialized field: "+n);else t.skip(i);break;case 17:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.dataMessageRequest=Bt(t),n="dataMessageRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: dataMessageRequest, previous deserialized field: "+n);else t.skip(i);break;case 18:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.removeParticipantsRequest=Zt(t),n="removeParticipantsRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: removeParticipantsRequest, previous deserialized field: "+n);else t.skip(i);break;case 19:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.dataMessageResponse=Wt(t),n="dataMessageResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: dataMessageResponse, previous deserialized field: "+n);else t.skip(i);break;case 30:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.updateRequest=nn(t),n="updateRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: updateRequest, previous deserialized field: "+n);else t.skip(i);break;case 31:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.updateResponse=rn(t),n="updateResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: updateResponse, previous deserialized field: "+n);else t.skip(i);break;case 32:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.notifyRequest=on(t),n="notifyRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: notifyRequest, previous deserialized field: "+n);else t.skip(i);break;case 33:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.notifyResponse=an(t),n="notifyResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: notifyResponse, previous deserialized field: "+n);else t.skip(i);break;case 34:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.connectRequest=Gt(t),n="connectRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: connectRequest, previous deserialized field: "+n);else t.skip(i);break;case 35:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.connectResponse=zt(t),n="connectResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: connectResponse, previous deserialized field: "+n);else t.skip(i);break;case 36:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.clientEventRequest=Kt(t),n="clientEventRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: clientEventRequest, previous deserialized field: "+n);else t.skip(i);break;case 37:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.clientEventResponse=Xt(t),n="clientEventResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: clientEventResponse, previous deserialized field: "+n);else t.skip(i);break;case 40:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.unsubscribeRequest=en(t),n="unsubscribeRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: unsubscribeRequest, previous deserialized field: "+n);else t.skip(i);break;case 41:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.unsubscribeResponse=tn(t),n="unsubscribeResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: unsubscribeResponse, previous deserialized field: "+n);else t.skip(i);break;case 42:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.approvalRequest=ln(t),n="approvalRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: approvalRequest, previous deserialized field: "+n);else t.skip(i);break;case 43:if(i===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)o.transferRequest=It(t),n="transferRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: transferRequest, previous deserialized field: "+n);else t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),o}l.RtcException$DefaultConstructor=s,l.SessionDescription$DefaultConstructor=u,l.SessionDescriptionUpdate$DefaultConstructor=c,l.MediaDescriptionUpdate$DefaultConstructor=d,l.ServerMediaUpdate$DefaultConstructor=m,l.ClientMediaUpdate$DefaultConstructor=p,l.IceCandidate$DefaultConstructor=_,l.SyncPayload$DefaultConstructor=f,l.SyncAck$DefaultConstructor=g,l.E2eeData$DefaultConstructor=h,l.ClientMediaUpdateRequest$DefaultConstructor=y,l.ClientMediaUpdateResponse$DefaultConstructor=C,l.MultipleRelaysAllocationParameters$DefaultConstructor=b,l.ServerMediaUpdateRequest$DefaultConstructor=v,l.ServerMediaUpdateResponse$DefaultConstructor=S,l.TransferRequest$DefaultConstructor=R,l.HangupRequest$DefaultConstructor=L,l.IceCandidateRequest$DefaultConstructor=E,l.DismissRequest$DefaultConstructor=k,l.EndpointSettings$DefaultConstructor=I,l.ParticipantState$DefaultConstructor=T,l.ServerOnlyParticipantState$DefaultConstructor=D,l.UserProfile$DefaultConstructor=x,l.ProductMetadata$DefaultConstructor=$,l.ConferenceStateRequest$DefaultConstructor=P,l.ConferenceStateResponse$DefaultConstructor=N,l.SubscriptionRequest$DefaultConstructor=M,l.DataMessageRequest$DefaultConstructor=w,l.DataMessageResponse$DefaultConstructor=A,l.AddParticipantsRequest$DefaultConstructor=F,l.SfuAllocation$DefaultConstructor=O,l.JoinRequest$DefaultConstructor=B,l.JoinResponse$DefaultConstructor=W,l.ConnectRequest$DefaultConstructor=q,l.ConnectResponse$DefaultConstructor=U,l.ClientEvent$DefaultConstructor=V,l.ClientEventRequest$DefaultConstructor=H,l.ThreadIdInfo$DefaultConstructor=G,l.ClientEventResponse$DefaultConstructor=z,l.RingRequest$DefaultConstructor=j,l.RingResponse$DefaultConstructor=K,l.RemoveParticipantsRequest$DefaultConstructor=Q,l.UnsubscribeRequest$DefaultConstructor=X,l.UnsubscribeResponse$DefaultConstructor=Y,l.UpdateRequest$DefaultConstructor=J,l.UpdateResponse$DefaultConstructor=Z,l.NotifyRequest$DefaultConstructor=ee,l.NotifyResponse$DefaultConstructor=te,l.ApprovalRequest$DefaultConstructor=ne,l.RtcSender$DefaultConstructor=re,l.RtcReceiver$DefaultConstructor=oe,l.RtcMessageHeader$DefaultConstructor=ae,l.RtcMessageBody$DefaultConstructor=ie,l.RtcMultiwayMessage$DefaultConstructor=le,l.GroupOfUsers$DefaultConstructor=se,l.RtcMessageBodyVariant$DefaultConstructor=ue,l.serializeRtcException=ce,l.serializeSessionDescription=de,l.serializeSessionDescriptionUpdate=me,l.serializeMediaDescriptionUpdate=pe,l.serializeServerMediaUpdate=_e,l.serializeClientMediaUpdate=fe,l.serializeIceCandidate=ge,l.serializeSyncPayload=he,l.serializeSyncAck=ye,l.serializeE2eeData=Ce,l.serializeClientMediaUpdateRequest=be,l.serializeClientMediaUpdateResponse=ve,l.serializeMultipleRelaysAllocationParameters=Se,l.serializeServerMediaUpdateRequest=Re,l.serializeServerMediaUpdateResponse=Le,l.serializeTransferRequest=Ee,l.serializeHangupRequest=ke,l.serializeIceCandidateRequest=Ie,l.serializeDismissRequest=Te,l.serializeEndpointSettings=De,l.serializeParticipantState=xe,l.serializeServerOnlyParticipantState=$e,l.serializeUserProfile=Pe,l.serializeProductMetadata=Ne,l.serializeConferenceStateRequest=Me,l.serializeConferenceStateResponse=we,l.serializeSubscriptionRequest=Ae,l.serializeDataMessageRequest=Fe,l.serializeDataMessageResponse=Oe,l.serializeAddParticipantsRequest=Be,l.serializeSfuAllocation=We,l.serializeJoinRequest=qe,l.serializeJoinResponse=Ue,l.serializeConnectRequest=Ve,l.serializeConnectResponse=He,l.serializeClientEvent=Ge,l.serializeClientEventRequest=ze,l.serializeThreadIdInfo=je,l.serializeClientEventResponse=Ke,l.serializeRingRequest=Qe,l.serializeRingResponse=Xe,l.serializeRemoveParticipantsRequest=Ye,l.serializeUnsubscribeRequest=Je,l.serializeUnsubscribeResponse=Ze,l.serializeUpdateRequest=et,l.serializeUpdateResponse=tt,l.serializeNotifyRequest=nt,l.serializeNotifyResponse=rt,l.serializeApprovalRequest=ot,l.serializeRtcSender=at,l.serializeRtcReceiver=it,l.serializeRtcMessageHeader=lt,l.serializeRtcMessageBody=st,l.serializeRtcMultiwayMessage=ut,l.serializeGroupOfUsers=ct,l.serializeRtcMessageBodyVariant=dt,l.deserializeRtcException=mt,l.deserializeSessionDescription=pt,l.deserializeSessionDescriptionUpdate=_t,l.deserializeMediaDescriptionUpdate=ft,l.deserializeServerMediaUpdate=gt,l.deserializeClientMediaUpdate=ht,l.deserializeIceCandidate=yt,l.deserializeSyncPayload=Ct,l.deserializeSyncAck=bt,l.deserializeE2eeData=vt,l.deserializeClientMediaUpdateRequest=St,l.deserializeClientMediaUpdateResponse=Rt,l.deserializeMultipleRelaysAllocationParameters=Lt,l.deserializeServerMediaUpdateRequest=Et,l.deserializeServerMediaUpdateResponse=kt,l.deserializeTransferRequest=It,l.deserializeHangupRequest=Tt,l.deserializeIceCandidateRequest=Dt,l.deserializeDismissRequest=xt,l.deserializeEndpointSettings=$t,l.deserializeParticipantState=Pt,l.deserializeServerOnlyParticipantState=Nt,l.deserializeUserProfile=Mt,l.deserializeProductMetadata=wt,l.deserializeConferenceStateRequest=At,l.deserializeConferenceStateResponse=Ft,l.deserializeSubscriptionRequest=Ot,l.deserializeDataMessageRequest=Bt,l.deserializeDataMessageResponse=Wt,l.deserializeAddParticipantsRequest=qt,l.deserializeSfuAllocation=Ut,l.deserializeJoinRequest=Vt,l.deserializeJoinResponse=Ht,l.deserializeConnectRequest=Gt,l.deserializeConnectResponse=zt,l.deserializeClientEvent=jt,l.deserializeClientEventRequest=Kt,l.deserializeThreadIdInfo=Qt,l.deserializeClientEventResponse=Xt,l.deserializeRingRequest=Yt,l.deserializeRingResponse=Jt,l.deserializeRemoveParticipantsRequest=Zt,l.deserializeUnsubscribeRequest=en,l.deserializeUnsubscribeResponse=tn,l.deserializeUpdateRequest=nn,l.deserializeUpdateResponse=rn,l.deserializeNotifyRequest=on,l.deserializeNotifyResponse=an,l.deserializeApprovalRequest=ln,l.deserializeRtcSender=sn,l.deserializeRtcReceiver=un,l.deserializeRtcMessageHeader=cn,l.deserializeRtcMessageBody=dn,l.deserializeRtcMultiwayMessage=mn,l.deserializeGroupOfUsers=pn,l.deserializeRtcMessageBodyVariant=_n}),98);
__d("OculusMqttChannel",["CurrentUser","HorizonMetaIsCastingRoute","MqttChannel","MqttEnv","MqttEnvInitializer","MqttWebConfig","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";r("HorizonMetaIsCastingRoute").getIsCastingRoute()?r("MqttEnvInitializer").initialize(function(e){return new WebSocket(e,"horizon_webcasting")}):r("MqttEnvInitializer").initialize();function e(e){o("MqttEnv").setIsUserLoggedInNow(r("CurrentUser").isLoggedIn);var t=r("CurrentUser").getAppID()==null?0x9d143786e51a6:Number(r("CurrentUser").getAppID());return new(r("MqttChannel"))({appId:t,capabilities:r("MqttWebConfig").capabilities,chatVisibility:!0,clientCapabilities:r("MqttWebConfig").clientCapabilities,clientType:"websocket",deviceId:r("uuidv4")(),endpoint:r("MqttWebConfig").endpoint,initialSubscribedTopics:r("MqttWebConfig").subscribedTopics,phpOverride:r("MqttWebConfig").hostNameOverride,pollingEndpoint:r("MqttWebConfig").pollingEndpoint,userFbid:r("CurrentUser").getPossiblyNonFacebookUserID()})}var s=null;function u(t){return s==null&&(s=e(t)),s}function c(){return s}function d(){s!=null&&(s.shutdown(),s=null)}l.getOculusMqttChannelInstance=u,l.getOculusMqttChannelInstanceDoNotCreate=c,l.shutdownAndClear=d}),98);
__d("OverlayConfigConstants",[],(function(t,n,r,o,a,i){"use strict";var e={OverlayConfigNumParameters:5544,OverlayConfigNotPresentFlagValue:-1},l=e;i.default=l}),66);
__d("OverlayConfigLayerSource",[],(function(t,n,r,o,a,i){"use strict";var e=Object.freeze({UNKNOWN:0,DEFAULT:1,MOBILECONFIG:2,APP_CRUCIBLE:3,APP_JNI:4,UNITTEST_CONFIG:5,SERVER:6,PLACEHOLDER:7,LS_MOBILECONFIG:8,APP_LS:9,APP_JS:10,BROWSER:11,APP_OVRRTC:12,APP_IG:13,MLITE4A_LEGACY_QE:14,APP_MLITE4A:15,APP_PORTAL:16,IG_LAUNCHER:17,APP_ARCHON:18,APP_WS:19,APP_NOX:20,APP_WEARABLE_MSNGR:21,APP_WEARABLE_IG:22,APP_ORCA_RSYS:23,APP_WILDE:24,APP_MKIOS:25,APP_MK4A:26,DYNAMIC:27,SDK_DEFAULT:28,APP_FB4A:29,APP_RSYS_SDK_SAMPLE:30,APP_BIZAPP:31,APP_WORKCHAT:32,APP_ARCHON_LOCAL_OVERRIDES:33,APP_CATHODE:34,APP_WR4I:35,APP_WR4A:36,APP_METACAM:37,HORIZON_EMERGENCY:38,APP_SOCIALPLATFORM:39,APP_TWILIGHT:40,APP_AR_CALLING_LOCAL_OVERRIDES:41,APP_TWILIGHT_CASTING:42,TWILIGHT_EMERGENCY:43,METACAM_EMERGENCY:44,CALL_SCOPED:45,APP_CASE50:46,APP_GENERIC:47,HORIZON_EXPERIMENTAL:48}),l=e;i.default=l}),66);
__d("OverlayConfigServerLayer",["OverlayConfigConstants","OverlayConfigLayerSource"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.$1=e}e.createFromHeader=function(n){try{var t,r=n==null||(t=n.extensions)==null?void 0:t.oc1_json;if(r==null)return null;var o=JSON.parse(r),a=o==null?void 0:o.values;return a==null?null:new e(a)}catch(e){return null}};var t=e.prototype;return t.getLayerSource=function(){return r("OverlayConfigLayerSource").SERVER},t.getValue=function(t){var e=this.$1[String(t)];return e!=null?e:r("OverlayConfigConstants").OverlayConfigNotPresentFlagValue},t.logExposure=function(t){},e})();l.default=e}),98);
__d("QPLMsgTypesSitevarConfig.experimental",["cr:4475"],(function(t,n,r,o,a,i,l){"use strict";l.default=n("cr:4475")}),98);
__d("QPLMsgTypesSitevarConfigJSModuleWrapper",["QPLMsgTypesSitevarConfig"],(function(t,n,r,o,a,i,l){"use strict";l.default=r("QPLMsgTypesSitevarConfig")}),98);
__d("RequestStreamBodyUtils",[],(function(t,n,r,o,a,i){"use strict";var e=function(t){return u(atob(t))},l=function(t){return btoa(c(t))},s=function(t){var e=btoa(t),n=e.indexOf("=");return n===-1?e:e.substring(0,n)},u=function(t){for(var e=t,n=e.length,r=new Uint8Array(n),o=0;o<n;o++)r[o]=e.charCodeAt(o);return r},c=function(t){for(var e="",n=t.byteLength,r=0;r<n;r++)e+=String.fromCharCode(t[r]);return e};i.base64ToUint8Array=e,i.uint8ArrayToBase64=l,i.stringToBase64WithoutPadding=s,i.stringToUint8Array=u,i.uint8ArrayToString=c}),66);
__d("ZenonDGWLogger",["$InternalEnum","DGWStreamGroupCallbacks","QuickPerformanceLogger","ZenonAuditedCheckpointLogId","ZenonDebugLogger","ZenonInfraActionsLogger","ZenonLoggingUtils","ZenonODSLogger","qpl"],(function(t,n,r,o,a,i,l){"use strict";var e,s=n("$InternalEnum").Mirrored(["LOGGED_NONE","LOGGED_RETRY","LOGGED_FAILURE"]),u=r("qpl")._(398986999,"3052"),c=r("ZenonDebugLogger").getInstance(),d=!1,m=null;function p(e){d=!0,m=e}function _(t,n){if(o("ZenonLoggingUtils").shouldAllowLogging())switch(t.name){case"dgwStreamCreationInitiated":f(n,t.headers,t.dgwInfo);break;case"dgwStreamCreationSuccess":(e||(e=r("QuickPerformanceLogger"))).markerEnd(u,2,n);break;case"dgwStreamCreationError":c.logConsole("[DGW] Stream creation error: "+t.error),(e||(e=r("QuickPerformanceLogger"))).markerAnnotate(u,{string:{error:t.error}},{instanceKey:n}),(e||(e=r("QuickPerformanceLogger"))).markerEnd(u,87,n);break;case"dgwStreamClosed":c.logConsole("[DGW] Stream closed"+(t.reason!=null?" - Reason: "+t.reason:"")+"}");break;case"dgwStreamError":c.logConsole("[DGW] Stream error: "+t.error);break;default:break}}function f(t,n,o){(e||(e=r("QuickPerformanceLogger"))).markerStart(u,t),e.markerAnnotate(u,{bool:{hasAuthToken:o.hasAuthToken},string:babelHelpers.extends({},n,{deviceId:o.deviceId,loggingId:o.loggingId,serviceId:o.serviceId,windowContext:o.windowContext})},{instanceKey:t}),e.markerPoint(u,"initStreamCreation",{instanceKey:t})}function g(e,t){var n="DGW_STREAM_ERROR_"+t+"_"+e;E(n),r("ZenonODSLogger").logCounter(n)}function h(){E("DGW_SERVER_HAS_FINISHED_SENDING_DATA"),r("ZenonODSLogger").logCounter("DGW_SERVER_HAS_FINISHED_SENDING_DATA")}function y(e){var t="DGW_STREAM_MUST_DRAIN_"+e;E(t),r("ZenonODSLogger").logCounter(t)}function C(){E("DGW_STREAM_RETRY"),r("ZenonODSLogger").logCounter("DGW_STREAM_RETRY")}function b(e){var t=e?"_"+e:"";E("DGW_STREAM_RETRY_SUCCEEDED"+t),r("ZenonODSLogger").logCounter("DGW_STREAM_RETRY_SUCCEEDED"+t)}function v(e){var t=e?"_"+e:"";E("DGW_STREAM_RETRY_FAILED"+t),r("ZenonODSLogger").logCounter("DGW_STREAM_RETRY_FAILED"+t)}function S(e,t){E("["+e+"] Stream closed - Reason: "+(t!=null?t:""))}function R(e){var t="DGW_STREAM_GROUP_ERROR_"+o("DGWStreamGroupCallbacks").dgwStreamGroupErrorToString(e);E(t),r("ZenonODSLogger").logCounter(t)}function L(e){var t="DGW_STREAM_GROUP_MUST_DRAIN_"+e;E(t),r("ZenonODSLogger").logCounter(t)}function E(e){d&&m!=null?m("[SW][ZP] [DGW] "+e):r("ZenonInfraActionsLogger").logCheckpoint({auditId:r("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"[ZP] [DGW] "+e})}l.RetryLogState=s,l.setSharedWorkerContext=p,l.logEvent=_,l.logDGWErrorToODS=g,l.logDGWServerHasFinishedToODS=h,l.logDGWStreamMustDrainToODS=y,l.logDGWRetryToODS=C,l.logDGWSucceededRetry=b,l.logDGWFailedRetry=v,l.logDGWStreamClose=S,l.logDGWStreamGroupError=R,l.logDGWStreamGroupMustDrain=L,l.logDGWCheckpoint=E}),98);
__d("ZenonDGWMessageQueue",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(){this.$1=new Map}var t=e.prototype;return t.enqueue=function(t){this.$1.has(t.messageId)||this.$1.set(t.messageId,t)},t.dequeue=function(t){this.$1.delete(t)},t.sendAllWith=async function(t){this.$2(),await Promise.allSettled(this.$1.values().map(async function(e){e.succeeded=await t.send(e.data,e.timeoutInMs)}))},t.$2=function(){var e=this,t=Array.from(this.$1.values()).filter(function(t){return!e.$3(t)}).map(function(e){return e.messageId});t.forEach(function(t){return e.$1.delete(t)})},t.$3=function(t){var e=Date.now(),n=t.expiryTime,r=n!=null&&e>n;return!r&&!t.succeeded},e})();i.default=e}),66);
__d("ZenonDGWStreamGroupCoordinator",["DGWAuth","DGWClient","DGWConstants","DGWStreamGroupHandler","FBLogger","RawDGWClient","ZenonDGWLogger","err","justknobx"],(function(t,n,r,o,a,i,l){"use strict";var e=r("justknobx")._("5209"),s=r("justknobx")._("5210"),u=(function(){function t(e){this.$1=null,this.$3=e}var n=t.prototype;return n.$5=function(){var e=this;return new(r("DGWStreamGroupHandler"))(function(t){e.killStreamGroup(),o("ZenonDGWLogger").logDGWStreamGroupError(t),e.$3()},function(t){e.killStreamGroup(),o("ZenonDGWLogger").logDGWStreamGroupMustDrain(t),e.$3()},function(){e.killStreamGroup(),e.$3()})},n.setDGWConfig=function(t){this.$4=t,this.$1=this.getOrCreateRawDGWClientInstance()},n.establishStream=function(n,o,a){if(this.$2==null){var t,i={authToken:a.authToken,authType:a.authType,connectTimeoutMs:s,deviceId:a.deviceId,disableFalcoLogging:a.disableFalcoLogging,keepAliveMs:e,loggingId:a.loggingId,serviceId:(t=a.serviceId)!=null?t:"rpsignaling",streamGroupAppHeaders:{"stream-group":"group1"}};a.overrideUrl!=null&&(i.overrideUrl=a.overrideUrl);var l=this.$1?this.$1:r("DGWClient")();this.$2=l.createStreamGroup(this.$5(),i)}return this.$2.establishStream({disableFalcoLogging:a.disableFalcoLogging,groupedStreamHeaders:n,loggingId:a.loggingId},o)},n.getOrCreateRawDGWClientInstance=function(){if(this.$1!=null)return this.$1;if(this.$4==null){var e=r("err")("dgwConfig is required but was not provided");throw r("FBLogger")("zenon").catching(e).mustfix("Failed to create RawDGWClient: missing dgwConfig"),e}var t=this.$4;return new(o("RawDGWClient")).RawDGWClient({appId:t.appId,appVersion:t.appVersion,authToken:t.authToken,authType:o("DGWAuth").fromStringToDGWAuth(t.authType),dgwVersion:o("DGWConstants").DgwVersion.DGWVER_BIG_IDS,endpoint:t.endpoint,fbId:t.fbId,isUserLoggedIn:function(){return t.isUserLoggedIn}})},n.killStreamGroup=function(){var e;(e=this.$2)==null||e.close(),this.$2=null},t})();l.default=u}),98);
__d("ZenonDeviceId",["ChannelClientID","WebStorage"],(function(t,n,r,o,a,i,l){"use strict";var e,s="chatd-deviceid";function u(){return o("ChannelClientID").getID()}function c(t){(e||(e=r("WebStorage"))).setAllowlistedKeyToLocalStorage(e.getLocalStorage(),s,t)}function d(){return(e||(e=r("WebStorage"))).getAllowlistedKeyFromLocalStorage(s)}function m(){var e;return(e=d())!=null?e:u()}l.getZenonDeviceId=u,l.setZenonLocalStorageDeviceId=c,l.getZenonLocalStorageDeviceId=d,l.getZenonLocalStorageDeviceIdWithFallback=m}),98);
__d("ZenonDGWStreamController",["DGWStream","EventEmitter","Random","Run","ZenonDGWLogger","ZenonDGWMessageQueue","ZenonDGWStreamGroupCoordinator","ZenonDeviceId","justknobx","promiseDone","qex","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("justknobx")._("1942"),u=r("justknobx")._("5207"),c=r("justknobx")._("5208"),d=(e=r("qex")._("3872"))!=null?e:!1,m=null,p=(function(e){function t(){var t;return t=e.call(this)||this,t.$ZenonDGWStreamController$p_6=o("Random").uint32(),t.$ZenonDGWStreamController$p_7="UNKNOWN",t.$ZenonDGWStreamController$p_8=o("ZenonDGWLogger").RetryLogState.LOGGED_NONE,t.$ZenonDGWStreamController$p_9="Disconnected",t.$ZenonDGWStreamController$p_10=s,t.$ZenonDGWStreamController$p_11=!1,t.$ZenonDGWStreamController$p_5={deviceId:o("ZenonDeviceId").getZenonDeviceId(),loggingId:r("uuidv4")(),serviceId:"rpsignaling"},t.$ZenonDGWStreamController$p_1=new(r("ZenonDGWStreamGroupCoordinator"))(function(){r("promiseDone")(t.$ZenonDGWStreamController$p_19())}),o("Run").onBeforeUnload(function(){t.$ZenonDGWStreamController$p_8===o("ZenonDGWLogger").RetryLogState.LOGGED_RETRY&&o("ZenonDGWLogger").logDGWFailedRetry()}),d&&(t.$ZenonDGWStreamController$p_2=new(r("ZenonDGWMessageQueue"))),t.$ZenonDGWStreamController$p_4={},t}babelHelpers.inheritsLoose(t,e),t.getControllerInstance=function(){return m||(m=new t),m};var n=t.prototype;return n.setHeaders=function(t){this.$ZenonDGWStreamController$p_4=t},n.setStreamOptions=function(t){this.$ZenonDGWStreamController$p_5=t},n.setDGWConfig=function(t){this.$ZenonDGWStreamController$p_18=t,this.$ZenonDGWStreamController$p_1.setDGWConfig(t)},n.setWindowContext=function(t){this.$ZenonDGWStreamController$p_7=t},n.getWindowContext=function(){return this.$ZenonDGWStreamController$p_7},n.getStream=function(){return this.$ZenonDGWStreamController$p_3},n.closeStream=function(t){this.$ZenonDGWStreamController$p_3!=null&&(this.$ZenonDGWStreamController$p_3.close(),this.$ZenonDGWStreamController$p_3=null,o("ZenonDGWLogger").logDGWStreamClose(this.$ZenonDGWStreamController$p_7,t))},n.$ZenonDGWStreamController$p_20=function(t){this.$ZenonDGWStreamController$p_9=t,this.emit("connectionStateEvent",t)},n.$ZenonDGWStreamController$p_21=function(){var e=this,t={onClose:function(n){e.$ZenonDGWStreamController$p_13==null||e.$ZenonDGWStreamController$p_13(n),e.$ZenonDGWStreamController$p_3=null},onDataReceived:function(n){e.$ZenonDGWStreamController$p_14==null||e.$ZenonDGWStreamController$p_14(n)},onError:function(n){e.$ZenonDGWStreamController$p_15==null||e.$ZenonDGWStreamController$p_15(n),o("ZenonDGWLogger").logDGWErrorToODS(n,e.$ZenonDGWStreamController$p_7),e.$ZenonDGWStreamController$p_19(n)},onServerHasFinishedSendingData:function(n){e.$ZenonDGWStreamController$p_17==null||e.$ZenonDGWStreamController$p_17(n),o("ZenonDGWLogger").logDGWServerHasFinishedToODS(),e.$ZenonDGWStreamController$p_19()},onStreamMustDrain:function(n,r){e.$ZenonDGWStreamController$p_16==null||e.$ZenonDGWStreamController$p_16(n,r),o("ZenonDGWLogger").logDGWStreamMustDrainToODS(r),e.$ZenonDGWStreamController$p_19()}};return t},n.$ZenonDGWStreamController$p_19=function(t){return t!=null&&!o("DGWStream").isRetryableError(t)||this.$ZenonDGWStreamController$p_10<=0?(o("ZenonDGWLogger").logEvent({error:String(t!=null?t:"drain"),name:"dgwStreamCreationError"},this.$ZenonDGWStreamController$p_6),this.$ZenonDGWStreamController$p_20("Disconnected"),this.$ZenonDGWStreamController$p_10<=0&&this.$ZenonDGWStreamController$p_8===o("ZenonDGWLogger").RetryLogState.LOGGED_RETRY&&(this.$ZenonDGWStreamController$p_8=o("ZenonDGWLogger").RetryLogState.LOGGED_FAILURE,o("ZenonDGWLogger").logDGWFailedRetry(t)),Promise.resolve()):(this.$ZenonDGWStreamController$p_8===o("ZenonDGWLogger").RetryLogState.LOGGED_NONE&&(this.$ZenonDGWStreamController$p_8=o("ZenonDGWLogger").RetryLogState.LOGGED_RETRY,o("ZenonDGWLogger").logDGWRetryToODS()),this.$ZenonDGWStreamController$p_12==null&&(this.closeStream("reestablishing stream"),this.$ZenonDGWStreamController$p_1.killStreamGroup(),this.$ZenonDGWStreamController$p_10--),this.establishAndGetStream())},n.restartStreamWithNewOptions=function(t){return this.closeStream("restarting with new options"),this.$ZenonDGWStreamController$p_1.killStreamGroup(),this.$ZenonDGWStreamController$p_5=t,this.establishAndGetStream()},n.setOnCloseCallback=function(t){this.$ZenonDGWStreamController$p_13=t},n.setOnDataReceivedCallback=function(t){this.$ZenonDGWStreamController$p_14=t},n.setOnErrorCallback=function(t){this.$ZenonDGWStreamController$p_15=t},n.setOnStreamMustDrainCallback=function(t){this.$ZenonDGWStreamController$p_16=t},n.setOnServerHasFinishedSendingDataCallback=function(t){this.$ZenonDGWStreamController$p_17=t},n.getConnectionState=function(){return this.$ZenonDGWStreamController$p_9},n.send=async function(t,n,r){var e,a,i,l={data:n,expiryTime:Date.now()+u,messageId:t,succeeded:!1,timeoutInMs:r!=null?r:c};(e=this.$ZenonDGWStreamController$p_2)==null||e.enqueue(l);var s=(a=await((i=this.$ZenonDGWStreamController$p_3)==null?void 0:i.send(l.data,l.timeoutInMs)))!=null?a:!1;if(!s)this.$ZenonDGWStreamController$p_19(o("DGWStream").StreamError.ACK_TIMEOUT);else{var d;l.succeeded=!0,(d=this.$ZenonDGWStreamController$p_2)==null||d.dequeue(l.messageId)}return s},n.establishAndGetStream=async function(){var e=this;if(this.$ZenonDGWStreamController$p_3)return this.$ZenonDGWStreamController$p_3;if(this.$ZenonDGWStreamController$p_12!=null)return await this.$ZenonDGWStreamController$p_12;var t=(async function(){try{var t;o("ZenonDGWLogger").logEvent({dgwInfo:{deviceId:e.$ZenonDGWStreamController$p_5.deviceId,hasAuthToken:e.$ZenonDGWStreamController$p_5.authToken!=null,loggingId:e.$ZenonDGWStreamController$p_5.loggingId,serviceId:e.$ZenonDGWStreamController$p_5.serviceId,windowContext:e.$ZenonDGWStreamController$p_7},headers:e.$ZenonDGWStreamController$p_4,name:"dgwStreamCreationInitiated"},e.$ZenonDGWStreamController$p_6),e.$ZenonDGWStreamController$p_20("Connecting");var n=await e.$ZenonDGWStreamController$p_1.establishStream(e.$ZenonDGWStreamController$p_4,e.$ZenonDGWStreamController$p_21(),e.$ZenonDGWStreamController$p_5);return o("ZenonDGWLogger").logEvent({name:"dgwStreamCreationSuccess"},e.$ZenonDGWStreamController$p_6),e.$ZenonDGWStreamController$p_8===o("ZenonDGWLogger").RetryLogState.LOGGED_RETRY&&o("ZenonDGWLogger").logDGWSucceededRetry(),e.$ZenonDGWStreamController$p_12=null,e.$ZenonDGWStreamController$p_10=s,e.$ZenonDGWStreamController$p_8=o("ZenonDGWLogger").RetryLogState.LOGGED_NONE,e.$ZenonDGWStreamController$p_20("Connected"),await((t=e.$ZenonDGWStreamController$p_2)==null?void 0:t.sendAllWith(n)),e.$ZenonDGWStreamController$p_3=n,n}catch(t){e.$ZenonDGWStreamController$p_12=null;var r=await e.$ZenonDGWStreamController$p_19(o("DGWStream").StreamError.isValid(t)?t:null);if(r)return r;throw t}})();return this.$ZenonDGWStreamController$p_12=t,t},t})(r("EventEmitter"));l.default=p}),98);
__d("ZenonIceStatsParser",[],(function(t,n,r,o,a,i){"use strict";function e(e){var t=[],n=e.split("\r\n");return n.forEach(function(e){l(e)&&t.push({gen:s(e),type:u(e)})}),t}function l(e){return e.indexOf("candidate:")>-1}function s(e){var t=0,n=e.match(/generation (\d+)/);return n&&(t=parseInt(n[1],10)),t}function u(e){var t=e.match(/typ (host|relay|srflx|prflx)/);return t?t[1]:"unknown"}i.extractIceInfo=e}),66);
__d("ZenonMWThriftMessageMap",["MultiwayCommonTypes"],(function(t,n,r,o,a,i,l){"use strict";function e(e){if(e==null)return"UNKNOWN";switch(e){case o("MultiwayCommonTypes").MessageType.JOIN:return"JOIN";case o("MultiwayCommonTypes").MessageType.SERVER_MEDIA_UPDATE:return"SERVER_MEDIA_UPDATE";case o("MultiwayCommonTypes").MessageType.ICE_CANDIDATE:return"ICE_CANDIDATE";case o("MultiwayCommonTypes").MessageType.HANGUP:return"HANGUP";case o("MultiwayCommonTypes").MessageType.RING:return"RING";case o("MultiwayCommonTypes").MessageType.DISMISS:return"DISMISS";case o("MultiwayCommonTypes").MessageType.CONFERENCE_STATE:return"CONFERENCE_STATE";case o("MultiwayCommonTypes").MessageType.ADD_PARTICIPANTS:return"ADD_PARTICIPANTS";case o("MultiwayCommonTypes").MessageType.SUBSCRIPTION:return"SUBSCRIPTION";case o("MultiwayCommonTypes").MessageType.CLIENT_MEDIA_UPDATE:return"CLIENT_MEDIA_UPDATE";case o("MultiwayCommonTypes").MessageType.DATA_MESSAGE:return"DATA_MESSAGE";case o("MultiwayCommonTypes").MessageType.REMOVE_PARTICIPANTS:return"REMOVE_PARTICIPANTS";case o("MultiwayCommonTypes").MessageType.PING:return"PING";case o("MultiwayCommonTypes").MessageType.NOTIFY:return"NOTIFY";case o("MultiwayCommonTypes").MessageType.CONNECT:return"CONNECT";case o("MultiwayCommonTypes").MessageType.CLIENT_EVENT:return"CLIENT_EVENT";case o("MultiwayCommonTypes").MessageType.UNSUBSCRIBE:return"UNSUBSCRIBE";case o("MultiwayCommonTypes").MessageType.UPDATE:return"UPDATE";case o("MultiwayCommonTypes").MessageType.APPROVAL:return"APPROVAL";case o("MultiwayCommonTypes").MessageType.WAKEUP:return"WAKEUP";default:return"UNKNOWN"}}function s(e){switch(e.toLowerCase()){case"join":return o("MultiwayCommonTypes").MessageType.JOIN;case"server_media_update":return o("MultiwayCommonTypes").MessageType.SERVER_MEDIA_UPDATE;case"ice_candidate":return o("MultiwayCommonTypes").MessageType.ICE_CANDIDATE;case"hangup":return o("MultiwayCommonTypes").MessageType.HANGUP;case"ring":return o("MultiwayCommonTypes").MessageType.RING;case"dismiss":return o("MultiwayCommonTypes").MessageType.DISMISS;case"conference_state":return o("MultiwayCommonTypes").MessageType.CONFERENCE_STATE;case"add_participants":return o("MultiwayCommonTypes").MessageType.ADD_PARTICIPANTS;case"subscription":return o("MultiwayCommonTypes").MessageType.SUBSCRIPTION;case"client_media_update":return o("MultiwayCommonTypes").MessageType.CLIENT_MEDIA_UPDATE;case"data_message":return o("MultiwayCommonTypes").MessageType.DATA_MESSAGE;case"remove_participants":return o("MultiwayCommonTypes").MessageType.REMOVE_PARTICIPANTS;case"ping":return o("MultiwayCommonTypes").MessageType.PING;case"notify":return o("MultiwayCommonTypes").MessageType.NOTIFY;case"connect":return o("MultiwayCommonTypes").MessageType.CONNECT;case"client_event":return o("MultiwayCommonTypes").MessageType.CLIENT_EVENT;case"unsubscribe":return o("MultiwayCommonTypes").MessageType.UNSUBSCRIBE;case"update":return o("MultiwayCommonTypes").MessageType.UPDATE;case"approval":return o("MultiwayCommonTypes").MessageType.APPROVAL;case"wakeup":return o("MultiwayCommonTypes").MessageType.WAKEUP;default:return null}}l.messageTypeToString=e,l.messageTypeFromString=s}),98);
__d("ZenonEndCallReason",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum")({BREAKOUT_SESSION_SWITCH_ROOM:"BreakoutSessionSwitchRoom",CALL_END_ACCEPT_AFTER_HANG_UP:"CallEndAcceptAfterHangUp",CALLER_HAS_APPEALABLE_CALLING_RESTRICTION:"CallerHasAppealableCallingRestriction",CALLER_NOT_VISIBLE:"CallerNotVisible",CAMERA_PERMISSION_DENIED:"CameraPermissionDenied",CARRIER_BLOCKED:"CarrierBlocked",CLIENT_ENCRYPTION_ERROR:"ClientEncryptionError",CLIENT_ERROR:"ClientError",CLIENT_INTERRUPTED:"ClientInterrupted",CONNECTION_DROPPED:"ConnectionDropped",END_TO_END_ENCRYPTION_INVARIANT_VIOLATED:"EndToEndEncryptionInvariantViolated",HANGUP_CALL:"HangupCall",IGNORE_CALL:"IgnoreCall",IN_ANOTHER_CALL:"InAnotherCall",INACTIVE_TIMEOUT:"InactiveTimeout",INCOMING_TIMEOUT:"IncomingTimeout",MAX_ALLOWED_PARTICIPANTS_REACHED:"MaxAllowedParticipantsReached",MICROPHONE_PERMISSION_DENIED:"MicrophonePermissionDenied",NO_ANSWER_TIMEOUT:"NoAnswerTimeout",NO_PERMISSION:"NoPermission",NO_UI_SHOWN:"NoUIShown",OTHER_CARRIER_BLOCKED:"OtherCarrierBlocked",OTHER_INSTANCE_HANDLED:"OtherInstanceHandled",OTHER_NOT_CAPABLE:"OtherNotCapable",PRODUCT_SERVER_DEFINED_END_REASON:"ProductServerDefinedEndReason",REMOVED_BY_PARTICIPANT:"RemovedByParticipant",RING_MUTED:"RingMuted",SESSION_MIGRATED:"SessionMigrated",SIGNALING_MESSAGE_FAILED:"SignalingMessageFailed",TX_ACK_TIMEOUT:"TxAckTimeout",UNEXPECTED_END_OF_CALL:"UnexpectedEndOfCall",UNKNOWN:"Unknown",VERSION_UNSUPPORTED:"VersionUnsupported",WEBRTC_ERROR:"WebRTCError"}),l=e;i.default=l}),66);
__d("ZenonIncomingRingSDKTypes",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["Hangup","OtherDismiss"]);i.ZenonCancelReason=e}),66);
__d("fbwebrtc_ClientStack",[],(function(t,n,r,o,a,i){var e=Object.freeze({OLD_CLIENT_PLATFORM_STACK:0,RSYS_X:1,IG_OLD_STACK:2,MLITE_OLD_STACK:3,SCOTCH:4,ZENON:5});i.default=e}),66);
__d("multiway_ApprovalStatus",[],(function(t,n,r,o,a,i){var e=Object.freeze({DENIED:0,APPROVED:1});i.default=e}),66);
__d("multiway_Capability",[],(function(t,n,r,o,a,i){var e=Object.freeze({SUPPORT_AUDIO_DEPRECATED:0,SUPPORT_VIDEO_DEPRECATED:1,SUPPORT_EXPERIMENTS_IN_JOIN_RESPONSE:2,SUPPORT_NEW_PARTICIPANT_STATES:3,SUPPORT_SDP_RENEGOTIATION:4,SUPPORT_MWPP:5,REQUIRE_FULL_SDP_IN_SMU:6,SUPPORT_PRECONNECT:7,SUPPORT_MWPP_DEESCALATION:8,SUPPORT_PARTICIPANT_STATE_UNCALLABLE:9,SUPPORT_MULTIPLE_VIDEO_STREAMS:10,REQUIRE_FULL_SDP_IN_SMU_OPTIMIZED:11,SUPPORT_MULTISTREAM_FEC:12,SUPPORT_DELTA_SMU:13,REQUIRE_DEFAULT_CHANNEL_SCREENSHARE:14,SUPPORT_SCREENSHARE_FLAG_IN_JOIN_RESPONSE_AND_SMU:15,SUPPORT_TEMPORAL_LAYER_JBE:16,REQUIRES_P2P_RELAY_INFO_VIA_SIGNALING:17,SUPPORT_NUMERIC_TOPICS:18,SUPPORT_PSEUDO_QUIC_CONNECTION:19,SUPPORT_SDP_SENDRECV:20});i.default=e}),66);
__d("multiway_ClientEventType",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNKNOWN:0,MEDIA_CONNECTED:1});i.default=e}),66);
__d("multiway_ConferenceType",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNKNOWN:0,IGVIDEOCALL:9,ROOM:15,CRUCIBLE:20,MBS_WA:21,BOT:22,HORIZON:23,ULLC:24});i.default=e}),66);
__d("multiway_DeviceStatus",[],(function(t,n,r,o,a,i){var e=Object.freeze({OK:0,NOT_SUPPORTED:1,IN_ANOTHER_CALL:10});i.default=e}),66);
__d("multiway_DismissReason",[],(function(t,n,r,o,a,i){var e=Object.freeze({CALL_ENDED:0,ANSWERED_ON_ANOTHER_DEVICE:1,IN_ANOTHER_CALL:2,CONNECTION_DROPPED:3,REJECTED_ON_ANOTHER_DEVICE:4,REMOVED_BY_PARTICIPANT:5,REJECTED_BY_CALLEE:6,INTERNAL_ERROR:7,CALL_ENDED_BY_PRODUCT:9,JOIN_APPROVAL_DENIED:10,JOIN_APPROVAL_TIMEDOUT:11,UNSUPPORTED_VERSION:12,LIVE_NOT_ACKED:13,TX_ACK_TIMEDOUT:14,ANSWERED_BY_OTHER_USER:15,PARTICIPANT_SELF_TERMINATION:16,PARTICIPANT_REJOIN:17,LONG_LASTING_AUDIO_ISSUE:18,PRIMARY_ENDPOINT_HANGUP:19,RECONNECT_FAILED:20,E2EE_HARDENING_ERROR:21,CALL_ENDED_BY_EXTENSION:22,CALL_ENDED_BY_OVER_CAPACITY:23});i.default=e}),66);
__d("multiway_E2eeMode",[],(function(t,n,r,o,a,i){var e=Object.freeze({E2EE_NOT_MANDATED:0,DEPRECATED_NO_REQUIREMENT:1,E2EE_MANDATED:2,E2EE_BYPASSED_USER_CONSENTED:3});i.default=e}),66);
__d("multiway_EndpointServiceType",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNKNOWN:0,COMPOSITING_SERVICE:1,MEDIA_SERVER:2,CATHODE_AMBISONIC:3,CATHODE_CAPTIONS:4,CATHODE_MEETING_SUMMARIZER:5,CATHODE_REALTIME_SHARED_STATE:6,RP_GENAI_SERVICE:7,SMART_GLASSES_ASSISTANT:8});i.default=e}),66);
__d("multiway_HangupReason",[],(function(t,n,r,o,a,i){var e=Object.freeze({IGNORE_CALL:0,HANGUP_CALL:1,NO_ANSWER_TIMEOUT:2,CLIENT_ERROR:3,IN_ANOTHER_CALL:4,CLIENT_INTERRUPTED:5,SESSION_MIGRATED:6,E2EE_MANDATED_BUT_OFFER_DID_NOT_CONTAIN_E2EE:7,E2EE_MANDATED_BUT_ANSWER_DID_NOT_NEGOTIATE_E2EE:8,WEBRTC_ERROR:9,CONNECTION_DROPPED:10});i.default=e}),66);
__d("multiway_JoinMode",[],(function(t,n,r,o,a,i){var e=Object.freeze({PRIMARY:0,SECONDARY:1});i.default=e}),66);
__d("multiway_MediaPath",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNKNOWN:0,SFU:1,P2P:2});i.default=e}),66);
__d("multiway_MediaPauseStatus",[],(function(t,n,r,o,a,i){var e=Object.freeze({NotPaused:0,Paused:1});i.default=e}),66);
__d("multiway_MessageTag",[],(function(t,n,r,o,a,i){var e=Object.freeze({PRANSWER:1001,INITIAL_ANSWER_TO_P2P_CALLER:1002,DEESCALATE_OFFER_TO_P2P_CALLEE:1003,DEESCALATE_ANSWER_TO_P2P_CALLER:1004,REQUEST_DEESCALATE_TO_P2P_CALLER:1005,REQUEST_ESCALATE:1006,REQUEST_CLIENT_FULL_RENEGOTIATION_TO_ADMIT_FROM_WAITINGROOM:1007,REQUEST_CLIENT_FULL_RENEGOTIATION_AGAINST_MWS:1008,PARTICIPANT_ADDED:1009,PARTICIPANT_REMOVED:1010,FIRST_REMOTE_ALERTED_FOR_INITIATOR:2001,FIRST_REMOTE_ANSWERED_FOR_INITIATOR:2002,CONTAIN_PENDING_APPROVAL_PARTICIPANTS:2003,KEEP_ALIVE_PING:3001,IS_INITIATOR:4001,PREGEN_SDP:4002});i.default=e}),66);
__d("multiway_MessageType",[],(function(t,n,r,o,a,i){var e=Object.freeze({JOIN:0,SERVER_MEDIA_UPDATE:1,HANGUP:2,ICE_CANDIDATE:3,RING:4,DISMISS:5,CONFERENCE_STATE:6,ADD_PARTICIPANTS:7,SUBSCRIPTION:8,CLIENT_MEDIA_UPDATE:9,DATA_MESSAGE:10,REMOVE_PARTICIPANTS:11,PING:18,UPDATE:20,NOTIFY:21,CONNECT:22,CLIENT_EVENT:23,UNSUBSCRIBE:25,APPROVAL:26,TRANSFER:27,WAKEUP:28});i.default=e}),66);
__d("multiway_ParticipantCallState",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNKNOWN:0,DISCONNECTED:1,NO_ANSWER:2,REJECTED:3,UNREACHABLE:4,CONNECTION_DROPPED:5,CONTACTING:6,RINGING:7,CONNECTING:8,CONNECTED:9,PARTICIPANT_LIMIT_REACHED:10,IN_ANOTHER_CALL:11,RING_TYPE_UNSUPPORTED:12,PENDING_APPROVAL:13,APPROVED:14,FAILED_APPROVAL:15,HANGUP_IN_WAITING_ROOM:16,UNCALLABLE:17,UNCALLABLE_DELAYED:18});i.default=e}),66);
__d("multiway_RingType",[],(function(t,n,r,o,a,i){var e=Object.freeze({GROUP_AUDIO_CALL:0,PEER_VIDEO_CALL:1,PEER_AUDIO_CALL:2,GROUP_VIDEO_CALL:3,LIVE_STREAM:4,PEER_ESCALATED_VIDEO_CALL:5,PEER_ESCALATED_AUDIO_CALL:6,LIVE_AUDIO_ROOM:7,LIVE_WITH_ROOM:8});i.default=e}),66);
__d("multiway_RtcResponseStatusCode",[],(function(t,n,r,o,a,i){var e=Object.freeze({OK:200,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,METHOD_NOT_ALLOWED:406,CONFLICT:409,CONDITIONAL_REQUEST_FAILED:412,SERVER_INTERNAL_ERROR:500,SERVICE_UNAVAILABLE:503});i.default=e}),66);
__d("multiway_RtcResponseSubCode",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNKNOWN:1e3,EXCEEDED_MAX_ALLOWED_PARTICIPANTS:1001,MEMBERSHIP_CHECK_FAIL:1002,CONFERENCE_THROTTLED:1003,ENDPOINT_THROTTLED:1004,MWS_MESSAGE_SENT_TO_INCORRECT_REGION:1005,UNSUPPORTED_REQUEST_TYPE:2e3,CLIENT_REQUEST_UNACCEPTABLE:2001,CLIENT_RESPONSE_UNACCEPTABLE:2002,RING_RESPONSE_BODY_NOT_SET:2004,SERVER_MEDIA_UPDATE_RESPONSE_BODY_NOT_SET:2005,INVALID_SDP:2006,INVALID_CONFERENCE_NAME:2007,SERVER_INFO_CONFERENCE_NAME_MISMATCH:2008,INVALID_USER_ID:2009,INCORRECT_VERSION_RANGE:2010,SENDER_ID_MISMATCH:2011,RECIPIENT_NOT_SPECIFIED:2012,FIELD_NOT_ALLOWED:2013,USERS_NOT_SPECIFIED:2015,REQUEST_UNACCEPTABLE_FOR_ENDPOINT_STATE:2016,INVALID_CALL_ID:2017,SESSION_DESCRIPTION_ID_MISMATCH:2018,EMPTY_CLIENT_MEDIA_UPDATES:2019,INVALID_SERVER_INFO_DATA:2020,INCORRECT_STATE_VERSION:2021,MISMATCHED_STATE_FOR_VERSION:2022,INVALID_STATE_VERSION:2023,NO_RESOLVER_FOUND:2024,MISSING_APPROVERLIST:2025,FULL_SDP_REQUIRED_IN_APPROVED_STATE:2026,INVALID_BROADCAST_ID:2027,INVALID_ENDPOINT_CONFIG:2028,INVALID_E2EE_STATE:2029,SFU_MODE_PREVENTED:2030,INVALID_CONFERENCE_STATE:2031,JOIN_REQUEST_DENIED:2032,EMPTY_USER_IDS:2033,MISSING_SDP_CONNECT_REQUEST:2034,CALLER_HAS_APPEALABLE_CALLING_RESTRICTION:2035,MISSING_BODY_ENDPOINT:2101,MISSING_BODY_HEADER:2102,MISSING_BODY_BODY:2103,MISSING_BODY_PARAMS:2104,MISSING_BODY_REMOVE_PARTICIPANTS_REQUEST:2105,MISSING_BODY_DATA_MESSAGE_REQUEST:2106,MISSING_BODY_CLIENT_MEDIA_UPDATE_REQUEST:2107,MISSING_BODY_ADD_PARTICIPANTS_REQUEST:2108,MISSING_BODY_SUBSCRIPTION_REQUEST:2110,MISSING_BODY_JOIN_REQUEST:2111,MISSING_BODY_HANGUP_REQUEST:2112,MISSING_BODY_ICE_CANDIDATE_REQUEST:2113,MISSING_BODY_P2P_MESSAGE_REQUEST:2114,MISSING_BODY_UPDATE_REQUEST:2115,MISSING_BODY_CLIENT_EVENT_REQUEST:2116,MISSING_BODY_CONNECT_REQUEST:2117,MISSING_BODY_UNSUBSCRIBE_REQUEST:2118,MISSING_BODY_APPROVAL_REQUEST:2119,MISSING_ENDPOINT_USER_ID:2120,EMPTY_ENDPOINT_USER_ID:2121,MISSING_BODY_TRANSFER_REQUEST:2122,MISSING_BODY_GENERIC:2199,REQUESTOR_NOT_MEMBER_CONFERENCE:3002,NOT_BROADCAST_OWNER:3003,GUEST_NOT_INVITED:3004,GUEST_DISCONNECTED:3005,GUEST_INVITATION_EXPIRED:3006,PARTICIPANT_IN_PENDING_APPROVAL_STATE:3008,INVALID_MULTIWAY_PARAMS:3009,BROADCAST_ALREADY_STOPPED:4002,FAILED_TO_GENERATE_SDP_ANSWER:4003,FAILED_GENERATE_SESSION_DESCRIPTION:4004,SDP_SESSION_ID_MISMATCH:4005,MEDIA_ENDPOINT_GONE:4007,MEDIA_ENDPOINT_ALREADY_EXISTS:4008,MEDIA_ENDPOINT_EXISTS_DIFFERENT_SESSION_ID:4009,LEGACY_MESSENGER_SENDER_UNSET:4010,FAILED_TO_SET_TRANSPORT_INFO:4011,NON_PRIMARY_MULTIWAY_SERVER:4012,FAILED_TO_GET_REMOTE_DESCRIPTION:4013,LOCAL_DESCRIPTION_NOT_SET:4014,INVALID_SDP_TYPE:4015,CLIENT_MEDIA_UPDATE_WITHOUT_REMOTE_SDP_INFO:4016,SDP_UNSET_ON_P2P_ANSWER:4017,MISSING_ICE_CANDIDATE_PAYLOAD:4018,P2P_PROTOCOL_UNSET:4019,CREATE_ACK_FOR_INVALID_MESSAGE_TYPE:4020,LEGACY_CLIENT_CANNOT_JOIN_SFU_MODE:4021,CONNECT_UNSUPPORTED_IN_SFU_MODE:4022,CONNECT_UNSUPPORTED_FOR_JOINED_ENDPOINTS:4023,RESOLVE_STATE_API_ERROR:4024,EXTERNAL_RESOLUTION_ERROR:4025,INTERNAL_RESOLUTION_ERROR:4026,RESOLUTION_DISABLED:4027,BROADCAST_ID_MISSING:4028,SDP_UNSET_ON_P2P_OFFER:4029,LEGACY_OFFER_MISSING_REQUIRED_VALUE:4031,MEDIA_SERVER_STATE_SYNC_DESERIALIZATION_ERROR:4032,CONNECT_UNSUPPORTED_FOR_PRECONNECTED_USERS:4033,OTHER_USER_ANSWERED_THE_CALL:4034,MEDIA_SERVER_DESERIALIZATION_ERROR:4035,REMOTE_SDP_TRACKID_MISMATCH:4036,SIGNALING_MESSAGE_TO_CLIENT_DROPPED:4037,DATA_CHANNEL_ENDPOINT_GONE:4038,DATA_CHANNEL_ENDPOINT_ALREADY_EXISTS:4039,CONNECT_UNSUPPORTED_DURING_P2P_TO_SFU_ESCALATION:4040,P2P_CONNECT_UNSUPPORTED_AFTER_SFU_ESCALATION:4041,CONNECT_EXCEEDED_MAX_ALLOWED_ENDPOINTS_PER_CONFERENCE:4042,CONNECT_EXCEEDED_MAX_ALLOWED_ENDPOINTS_PER_USER:4043,REQUEST_TIMEOUT:4044,TOO_MANY_MEDIA_TRACKS_IN_SDP:4045,CONFERENCE_NOT_FOUND:5001,CONFERENCE_IS_TERMINATING:5002,CONFERENCE_IS_TERMINATED:5003,CONFERENCE_NAME_EMPTY:5004,NONCE_EMPTY:5005,NONCE_MISMATCH:5006,CONFERENCE_HAS_GONE:5007,PARTICIPANT_HAS_GONE:5008,MEDIA_SERVER_NOT_FOUND:5009,CLIENT_TERMINATED:5010,JOIN_SESSION_RESULT_MISSING:5012,LOGGING_POLICY_RESULT_MISSING:5013,INVITE_USERS_RESULT_MISSING:5014,STATE_SYNC_RESULT_MISSING:5015,ENDPOINT_INFO_RESULT_MISSING:5016,CONFERENCE_NAME_MISMATCH:5017,UNEXPECTED_TRANSPORT_PARAMS_CONFERENCE_NAME:5018,SESSION_CONFIGURATION_RESULT_MISSING:5019,REMOVE_USERS_RESULT_MISSING:5020,MEDIA_CODECS_UNSUPPORTED_BY_CONFERENCE:6001,CONFERENCE_INCAPABLE_RENEGOTIATION:6002,REJECTING_CMU_WHEN_SMU_PENDING:6003,PARTICIPANT_NOT_SUBSCRIBED_TO_TOPIC:6004,PARTICIPANT_ALREADY_IN_WAITING_ROOM:6005,PARTICIPANT_NOT_IN_PENDING_APPROVAL:6006,USER_NOT_APPROVER_FOR_TARGET_USER:6007,UNSUPPORTED_CAPABILITIES:6008,PRODUCT_SERVER_DEFINED_END_REASON:6009,WWW_KILLSWITCHED_REQUEST:6010,CONFLICTING_MEDIA_PATH:6011,CONFLICTING_MEDIA_STATUS:6012,CONFLICTING_SESSION_DESCRIPTION:6013,OK:9e3});i.default=e}),66);
__d("multiway_SubscriptionType",[],(function(t,n,r,o,a,i){var e=Object.freeze({CNAME:0,TRACK:1,DOMINANT_SPEAKER:2});i.default=e}),66);
__d("multiway_VideoQuality",[],(function(t,n,r,o,a,i){var e=Object.freeze({LOW:0,MEDIUM:1,HIGH:2,HD:3,NUM_QUALITIES:4});i.default=e}),66);
__d("ZenonMWMessageTypes",["$InternalEnum","fbwebrtc_ClientStack","multiway_ApprovalStatus","multiway_Capability","multiway_ClientEventType","multiway_ConferenceType","multiway_DeviceStatus","multiway_DismissReason","multiway_E2eeMode","multiway_EndpointServiceType","multiway_HangupReason","multiway_JoinMode","multiway_MediaPath","multiway_MediaPauseStatus","multiway_MessageTag","multiway_MessageType","multiway_ParticipantCallState","multiway_RingType","multiway_RtcResponseStatusCode","multiway_RtcResponseSubCode","multiway_SubscriptionType","multiway_VideoQuality"],(function(t,n,r,o,a,i,l){"use strict";var e=n("$InternalEnum")({DEFAULT_AUDIO:0,DEFAULT_VIDEO:1,SCREEN_AUDIO:2,SCREEN_VIDEO:3});l.ZenonMWClientStack=r("fbwebrtc_ClientStack"),l.ZenonMWApprovalStatus=r("multiway_ApprovalStatus"),l.ZenonMWCapability=r("multiway_Capability"),l.ZenonMWClientEventType=r("multiway_ClientEventType"),l.ZenonMWConferenceType=r("multiway_ConferenceType"),l.ZenonMWDeviceStatus=r("multiway_DeviceStatus"),l.ZenonMWDismissReason=r("multiway_DismissReason"),l.ZenonMWE2eeMode=r("multiway_E2eeMode"),l.ZenonMWEndpointServiceType=r("multiway_EndpointServiceType"),l.ZenonMWHangupReason=r("multiway_HangupReason"),l.ZenonMWMediaPath=r("multiway_MediaPath"),l.ZenonMWJoinMode=r("multiway_JoinMode"),l.ZenonMWMediaPauseStatus=r("multiway_MediaPauseStatus"),l.ZenonMWMessageTag=r("multiway_MessageTag"),l.ZenonMWSignalingPayloadType=r("multiway_MessageType"),l.ZenonMWParticipantCallState=r("multiway_ParticipantCallState"),l.ZenonMWRingType=r("multiway_RingType"),l.ZenonMWResponseStatusCode=r("multiway_RtcResponseStatusCode"),l.ZenonMWResponseSubCode=r("multiway_RtcResponseSubCode"),l.ZenonMWSubscriptionType=r("multiway_SubscriptionType"),l.ZenonMWVideoQuality=r("multiway_VideoQuality"),l.ZenonMWTrackLabel=e}),98);
__d("ZenonMediaError",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["ConnectionClosed","IceDisconnected","IceFailure","SetLocalSdpFailed","SetRemoteSdpFailed","RollbackSdpFailed","UnknownError"]);i.ZenonMediaError=e}),66);
__d("ZenonDismissReason",["$InternalEnum","FBLogger","ZenonIncomingRingSDKTypes","ZenonMWMessageTypes","ZenonMediaError"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=n("$InternalEnum")({IgnoreCall:0,HangupCall:1,InAnotherCall:2,AcceptAfterHangUp:3,NoAnswerTimeout:4,IncomingTimeout:5,OtherInstanceHandled:6,SignalingMessageFailed:7,ConnectionDropped:8,ClientInterrupted:9,WebRTCError:10,ClientError:11,NoPermission:12,OtherNotCapable:13,NoUIShown:14,VersionUnsupported:15,CallerNotVisible:16,CarrierBlocked:17,OtherCarrierBlocked:18,ClientEncryptionError:19,MicrophonePermissionDenied:20,CameraPermissionDenied:21,SessionMigrated:22,RingMuted:23,JoinApprovalDenied:24,RejectedByCallee:25,CallEndedByProduct:26,CallEnded:27,AnsweredOnAnotherDevice:28,RejectedOnAnotherDevice:29,CallCollision:30,MaxAllowedParticipantsReached:31,UnexpectedEndOfCall:32,TxAckTimeout:33,EndToEndEncryptionInvariantViolated:34,ProductServerDefinedEndReason:35,RemovedByParticipant:39,AnsweredByOtherUser:40,CallerHasAppealableCallingRestriction:41});function c(e){switch(e){case"BreakoutSessionSwitchRoom":return u.HangupCall;case"CallEndAcceptAfterHangUp":return u.AcceptAfterHangUp;case"CallerNotVisible":return u.CallerNotVisible;case"CarrierBlocked":return u.CarrierBlocked;case"ClientEncryptionError":return u.ClientEncryptionError;case"ClientError":return u.ClientError;case"ClientInterrupted":return u.ClientInterrupted;case"ConnectionDropped":return u.ConnectionDropped;case"HangupCall":return u.HangupCall;case"IgnoreCall":return u.IgnoreCall;case"InAnotherCall":return u.InAnotherCall;case"EndToEndEncryptionInvariantViolated":return u.EndToEndEncryptionInvariantViolated;case"InactiveTimeout":return u.CallEnded;case"IncomingTimeout":return u.IncomingTimeout;case"MaxAllowedParticipantsReached":return u.MaxAllowedParticipantsReached;case"NoAnswerTimeout":return u.NoAnswerTimeout;case"NoPermission":return u.NoPermission;case"NoUIShown":return u.NoUIShown;case"OtherCarrierBlocked":return u.OtherCarrierBlocked;case"OtherInstanceHandled":return u.OtherInstanceHandled;case"OtherNotCapable":return u.OtherNotCapable;case"SignalingMessageFailed":return u.SignalingMessageFailed;case"UnexpectedEndOfCall":return u.UnexpectedEndOfCall;case"Unknown":return u.CallEnded;case"VersionUnsupported":return u.VersionUnsupported;case"WebRTCError":return u.WebRTCError;case"MicrophonePermissionDenied":return u.MicrophonePermissionDenied;case"CameraPermissionDenied":return u.CameraPermissionDenied;case"SessionMigrated":return u.SessionMigrated;case"RingMuted":return u.RingMuted;case"TxAckTimeout":return u.TxAckTimeout;case"ProductServerDefinedEndReason":return u.ProductServerDefinedEndReason;case"RemovedByParticipant":return u.RemovedByParticipant;case"CallerHasAppealableCallingRestriction":return u.CallerHasAppealableCallingRestriction}}function d(e){switch(e){case u.CallEnded:case u.CallEndedByProduct:case u.HangupCall:return"HangupCall";case u.IgnoreCall:case u.JoinApprovalDenied:case u.RejectedByCallee:return"IgnoreCall";case u.InAnotherCall:return"InAnotherCall";case u.AcceptAfterHangUp:return"CallEndAcceptAfterHangUp";case u.NoAnswerTimeout:return"NoAnswerTimeout";case u.IncomingTimeout:return"IncomingTimeout";case u.AnsweredOnAnotherDevice:case u.CallCollision:case u.RejectedOnAnotherDevice:case u.OtherInstanceHandled:case u.AnsweredByOtherUser:return"OtherInstanceHandled";case u.SignalingMessageFailed:return"SignalingMessageFailed";case u.ConnectionDropped:return"ConnectionDropped";case u.ClientInterrupted:return"ClientInterrupted";case u.WebRTCError:return"WebRTCError";case u.ClientError:return"ClientError";case u.NoPermission:return"NoPermission";case u.OtherNotCapable:return"OtherNotCapable";case u.NoUIShown:return"NoUIShown";case u.VersionUnsupported:return"VersionUnsupported";case u.CallerNotVisible:return"CallerNotVisible";case u.CarrierBlocked:return"CarrierBlocked";case u.OtherCarrierBlocked:return"OtherCarrierBlocked";case u.ClientEncryptionError:return"ClientEncryptionError";case u.UnexpectedEndOfCall:return"UnexpectedEndOfCall";case u.MaxAllowedParticipantsReached:return"MaxAllowedParticipantsReached";case u.MicrophonePermissionDenied:return"MicrophonePermissionDenied";case u.CameraPermissionDenied:return"CameraPermissionDenied";case u.SessionMigrated:return"SessionMigrated";case u.RingMuted:return"RingMuted";case u.TxAckTimeout:return"TxAckTimeout";case u.EndToEndEncryptionInvariantViolated:return"EndToEndEncryptionInvariantViolated";case u.ProductServerDefinedEndReason:return"ProductServerDefinedEndReason";case u.RemovedByParticipant:return"RemovedByParticipant";case u.CallerHasAppealableCallingRestriction:return"CallerHasAppealableCallingRestriction"}return r("FBLogger")("rtc_www").mustfix("Unknown dismiss reason: %s",e),"Unknown"}function m(e){switch(e){case u.OtherInstanceHandled:case u.AnsweredOnAnotherDevice:case u.AnsweredByOtherUser:case u.RejectedOnAnotherDevice:return o("ZenonIncomingRingSDKTypes").ZenonCancelReason.OtherDismiss;default:return o("ZenonIncomingRingSDKTypes").ZenonCancelReason.Hangup}}function p(e){switch(e){case o("ZenonMediaError").ZenonMediaError.IceDisconnected:return u.ConnectionDropped;case o("ZenonMediaError").ZenonMediaError.ConnectionClosed:return u.HangupCall;case o("ZenonMediaError").ZenonMediaError.IceFailure:case o("ZenonMediaError").ZenonMediaError.SetLocalSdpFailed:case o("ZenonMediaError").ZenonMediaError.SetRemoteSdpFailed:case o("ZenonMediaError").ZenonMediaError.RollbackSdpFailed:return u.WebRTCError;case o("ZenonMediaError").ZenonMediaError.UnknownError:return u.UnexpectedEndOfCall}}function _(e){return f[e]}var f=Object.freeze((e={},e[(s=o("ZenonMWMessageTypes")).ZenonMWDismissReason.CALL_ENDED]=u.CallEnded,e[s.ZenonMWDismissReason.ANSWERED_ON_ANOTHER_DEVICE]=u.AnsweredOnAnotherDevice,e[s.ZenonMWDismissReason.ANSWERED_BY_OTHER_USER]=u.AnsweredByOtherUser,e[s.ZenonMWDismissReason.IN_ANOTHER_CALL]=u.InAnotherCall,e[s.ZenonMWDismissReason.CONNECTION_DROPPED]=u.ConnectionDropped,e[s.ZenonMWDismissReason.REJECTED_ON_ANOTHER_DEVICE]=u.RejectedOnAnotherDevice,e[s.ZenonMWDismissReason.REJECTED_BY_CALLEE]=u.RejectedByCallee,e[s.ZenonMWDismissReason.CALL_ENDED_BY_PRODUCT]=u.CallEndedByProduct,e[s.ZenonMWDismissReason.INTERNAL_ERROR]=u.SignalingMessageFailed,e[s.ZenonMWDismissReason.REMOVED_BY_PARTICIPANT]=u.RemovedByParticipant,e[s.ZenonMWDismissReason.TX_ACK_TIMEDOUT]=u.TxAckTimeout,e));l.ZenonDismissReason=u,l.endCallToDismissReason=c,l.dismissToEndCallReason=d,l.dismissReasonToCancelReason=m,l.mediaErrorToDismissReason=p,l.mwDismissToDmissReason=_}),98);
__d("ZenonMWThriftMessageTagUtils",["MultiwayCommonTypes"],(function(t,n,r,o,a,i,l){"use strict";function e(e){switch(e){case o("MultiwayCommonTypes").MessageTag.PRANSWER:return 1001;case o("MultiwayCommonTypes").MessageTag.INITIAL_ANSWER_TO_P2P_CALLER:return 1002;case o("MultiwayCommonTypes").MessageTag.DEESCALATE_OFFER_TO_P2P_CALLEE:return 1003;case o("MultiwayCommonTypes").MessageTag.DEESCALATE_ANSWER_TO_P2P_CALLER:return 1004;case o("MultiwayCommonTypes").MessageTag.REQUEST_DEESCALATE_TO_P2P_CALLER:return 1005;case o("MultiwayCommonTypes").MessageTag.REQUEST_ESCALATE:return 1006;case o("MultiwayCommonTypes").MessageTag.REQUEST_CLIENT_FULL_RENEGOTIATION_TO_ADMIT_FROM_WAITINGROOM:return 1007;case o("MultiwayCommonTypes").MessageTag.REQUEST_CLIENT_FULL_RENEGOTIATION_AGAINST_MWS:return 1008;case o("MultiwayCommonTypes").MessageTag.PARTICIPANT_ADDED:return 1009;case o("MultiwayCommonTypes").MessageTag.PARTICIPANT_REMOVED:return 1010;case o("MultiwayCommonTypes").MessageTag.FIRST_REMOTE_ALERTED_FOR_INITIATOR:return 2001;case o("MultiwayCommonTypes").MessageTag.FIRST_REMOTE_ANSWERED_FOR_INITIATOR:return 2002;case o("MultiwayCommonTypes").MessageTag.CONTAIN_PENDING_APPROVAL_PARTICIPANTS:return 2003;case o("MultiwayCommonTypes").MessageTag.KEEP_ALIVE_PING:return 3001;case o("MultiwayCommonTypes").MessageTag.IS_INITIATOR:return 4001;case o("MultiwayCommonTypes").MessageTag.PREGEN_SDP:return 4002}}function s(e){switch(e){case 1001:return o("MultiwayCommonTypes").MessageTag.PRANSWER;case 1002:return o("MultiwayCommonTypes").MessageTag.INITIAL_ANSWER_TO_P2P_CALLER;case 1003:return o("MultiwayCommonTypes").MessageTag.DEESCALATE_OFFER_TO_P2P_CALLEE;case 1004:return o("MultiwayCommonTypes").MessageTag.DEESCALATE_ANSWER_TO_P2P_CALLER;case 1005:return o("MultiwayCommonTypes").MessageTag.REQUEST_DEESCALATE_TO_P2P_CALLER;case 1006:return o("MultiwayCommonTypes").MessageTag.REQUEST_ESCALATE;case 1007:return o("MultiwayCommonTypes").MessageTag.REQUEST_CLIENT_FULL_RENEGOTIATION_TO_ADMIT_FROM_WAITINGROOM;case 1008:return o("MultiwayCommonTypes").MessageTag.REQUEST_CLIENT_FULL_RENEGOTIATION_AGAINST_MWS;case 1009:return o("MultiwayCommonTypes").MessageTag.PARTICIPANT_ADDED;case 1010:return o("MultiwayCommonTypes").MessageTag.PARTICIPANT_REMOVED;case 2001:return o("MultiwayCommonTypes").MessageTag.FIRST_REMOTE_ALERTED_FOR_INITIATOR;case 2002:return o("MultiwayCommonTypes").MessageTag.FIRST_REMOTE_ANSWERED_FOR_INITIATOR;case 2003:return o("MultiwayCommonTypes").MessageTag.CONTAIN_PENDING_APPROVAL_PARTICIPANTS;case 3001:return o("MultiwayCommonTypes").MessageTag.KEEP_ALIVE_PING;case 4001:return o("MultiwayCommonTypes").MessageTag.IS_INITIATOR;case 4002:return o("MultiwayCommonTypes").MessageTag.PREGEN_SDP}}function u(t){var n=[];return t==null||t.forEach(function(t){t&&n.push(e(t))}),n}l.toThriftMessageTag=s,l.fromThriftMessageTags=u}),98);
__d("ZenonCallsModelTypes",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e,l=(e=n("$InternalEnum")).Mirrored(["Disconnected","Precontacting","Contacting","Ringing","PendingApproval","Approved","FailedApproval","Connecting","Connected","Reconnecting","ProvisionalRinging"]),s=e.Mirrored(["Facebook","Instagram","Messenger","Guest","WhatsApp","Workplace"]),u=e.Mirrored(["New","Connecting","PendingApproval","Connected","Terminating","Terminated"]),c=e.Mirrored(["Unknown","CallsBlocked","PageAdminPressedDecline"]),d=e.Mirrored(["None","PendingPeerFeedback","Declined","RemoteDeclined","LocalDeclined","Cancelled","TimedOut","Accepted","InitiatedFromPeer"]);i.ZenonCallParticipantState=l,i.ZenonCallParticipantType=s,i.ZenonCallState=u,i.ZenonEndCallSubreason=c,i.ZenonVideoEscalationStatus=d}),66);
__d("ZenonParticipantState",["$InternalEnum","ZenonCallsModelTypes"],(function(t,n,r,o,a,i,l){"use strict";var e=n("$InternalEnum")({UNKNOWN:0,ADDING:1,CONTACTING:2,RINGING:3,ACCEPTING:4,PRECONNECTING:5,CONNECTING:6,CONNECTED:7,REMOVING:8,DISCONNECTED:9,NO_ANSWER:10,REJECTED:11,UNREACHABLE:12,CONNECTION_DROPPED:13,PARTICIPANT_LIMIT_REACHED:14,IN_ANOTHER_CALL:15,RING_TYPE_UNSUPPORTED:16,PENDING_APPROVAL:17,APPROVING:18,DENYING:19,APPROVED:20,FAILED_APPROVAL:21,HANGUP_IN_WAITING_ROOM:22,RECONNECTING:23});function s(t){if(t==null)return o("ZenonCallsModelTypes").ZenonCallParticipantState.Disconnected;switch(t){case e.CONTACTING:case e.PRECONNECTING:return o("ZenonCallsModelTypes").ZenonCallParticipantState.Contacting;case e.RINGING:return o("ZenonCallsModelTypes").ZenonCallParticipantState.Ringing;case e.CONNECTING:case e.RECONNECTING:return o("ZenonCallsModelTypes").ZenonCallParticipantState.Connecting;case e.CONNECTED:return o("ZenonCallsModelTypes").ZenonCallParticipantState.Connected;case e.PENDING_APPROVAL:case e.APPROVING:case e.DENYING:case e.ACCEPTING:case e.ADDING:case e.REMOVING:return o("ZenonCallsModelTypes").ZenonCallParticipantState.PendingApproval;case e.APPROVED:return o("ZenonCallsModelTypes").ZenonCallParticipantState.Approved;case e.FAILED_APPROVAL:return o("ZenonCallsModelTypes").ZenonCallParticipantState.FailedApproval;case e.HANGUP_IN_WAITING_ROOM:case e.UNKNOWN:case e.DISCONNECTED:case e.NO_ANSWER:case e.REJECTED:case e.UNREACHABLE:case e.CONNECTION_DROPPED:case e.PARTICIPANT_LIMIT_REACHED:case e.IN_ANOTHER_CALL:case e.RING_TYPE_UNSUPPORTED:return o("ZenonCallsModelTypes").ZenonCallParticipantState.Disconnected}return o("ZenonCallsModelTypes").ZenonCallParticipantState.Disconnected}l.ZenonParticipantState=e,l.toCallParticipantState=s}),98);
__d("ZenonScreenShare",["UserAgent","ZenonAppProvider"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t;return e.length===1&&((t=e[0])==null?void 0:t.contentType)==="screen"}function s(){return!r("UserAgent").isBrowser("Safari")}function u(){return!o("ZenonAppProvider").isOculusCastingSite()}function c(){return!s()||!u()}l.isScreenSharingTrack=e,l.screenShareWithReplaceTrack=c}),98);
__d("ZenonSignalingTypes",[],(function(t,n,r,o,a,i){"use strict";var e={OK:0,REJECTED_FROM_VERSION_DOES_NOT_MATCH:1,METHOD_NOT_ALLOWED:2},l={CLIENT_TERMINATED:0};i.ZenonSignalingStatusCode=e,i.ZenonSignalingStatusSubCode=l}),66);
__d("addDevTierOverridesToHeaderExtensions",["gkx"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t={multiwayCoreTier:"",multiwayWwwTier:""};return r("gkx")("25224")&&(t.multiwayWwwTier=s(e,"multiway_www_tier"),t.multiwayCoreTier=s(e,"multiway_core_tier")),t}function s(e,t){var n=t+"=",r=e.split(n);return r[1]?r.pop().split("&").shift():""}l.default=e}),98);
__d("ZenonMWThriftTranslatorUtils",["FBLogger","MultiwayCommonTypes","MultiwaySharedTypes","OverlayConfigServerLayer","RequestStreamBodyUtils","WebrtcSignalingCommonTypes","ZenonDismissReason","ZenonMWMessageTypes","ZenonMWThriftMessageTagUtils","ZenonParticipantState","ZenonScreenShare","ZenonSignalingProtocol","ZenonSignalingTypes","addDevTierOverridesToHeaderExtensions"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d="signalingDominantSpeakerUpdate",m="signalingVideoUploadUpdate",p="E2eeState",_=new Map(Array.from(o("MultiwaySharedTypes").ConferenceType.members(),function(e){return[o("MultiwaySharedTypes").ConferenceType.getName(e),e]}));function f(e,t,n,r){n===void 0&&(n=!1),e&&Object.keys(e).forEach(function(o){if(!(o===p&&r)){var a=e[o],i=a.data,l=a.version;if(i!=null){var s={data:i,eventName:"stateSyncNotifyRequest",responseRequired:n,topic:o,version:l};t.push(s)}}})}function g(e){if(e){var t=e[p];return t==null?void 0:t.data}}function h(e){if(e==null)return o("ZenonMWMessageTypes").ZenonMWMediaPath.UNKNOWN;switch(e){case o("MultiwaySharedTypes").MediaPath.SFU:return o("ZenonMWMessageTypes").ZenonMWMediaPath.SFU;case o("MultiwaySharedTypes").MediaPath.P2P:return o("ZenonMWMessageTypes").ZenonMWMediaPath.P2P;default:return o("ZenonMWMessageTypes").ZenonMWMediaPath.UNKNOWN}}function y(e){if(e==null)return o("ZenonParticipantState").ZenonParticipantState.UNKNOWN;switch(e){case o("MultiwayCommonTypes").ParticipantCallState.DISCONNECTED:return o("ZenonParticipantState").ZenonParticipantState.DISCONNECTED;case o("MultiwayCommonTypes").ParticipantCallState.NO_ANSWER:return o("ZenonParticipantState").ZenonParticipantState.NO_ANSWER;case o("MultiwayCommonTypes").ParticipantCallState.REJECTED:return o("ZenonParticipantState").ZenonParticipantState.REJECTED;case o("MultiwayCommonTypes").ParticipantCallState.UNREACHABLE:case o("MultiwayCommonTypes").ParticipantCallState.UNCALLABLE:return o("ZenonParticipantState").ZenonParticipantState.UNREACHABLE;case o("MultiwayCommonTypes").ParticipantCallState.CONNECTION_DROPPED:return o("ZenonParticipantState").ZenonParticipantState.CONNECTION_DROPPED;case o("MultiwayCommonTypes").ParticipantCallState.CONTACTING:return o("ZenonParticipantState").ZenonParticipantState.CONTACTING;case o("MultiwayCommonTypes").ParticipantCallState.RINGING:return o("ZenonParticipantState").ZenonParticipantState.RINGING;case o("MultiwayCommonTypes").ParticipantCallState.CONNECTING:return o("ZenonParticipantState").ZenonParticipantState.CONNECTING;case o("MultiwayCommonTypes").ParticipantCallState.CONNECTED:return o("ZenonParticipantState").ZenonParticipantState.CONNECTED;case o("MultiwayCommonTypes").ParticipantCallState.PARTICIPANT_LIMIT_REACHED:return o("ZenonParticipantState").ZenonParticipantState.PARTICIPANT_LIMIT_REACHED;case o("MultiwayCommonTypes").ParticipantCallState.IN_ANOTHER_CALL:return o("ZenonParticipantState").ZenonParticipantState.IN_ANOTHER_CALL;case o("MultiwayCommonTypes").ParticipantCallState.RING_TYPE_UNSUPPORTED:return o("ZenonParticipantState").ZenonParticipantState.RING_TYPE_UNSUPPORTED;case o("MultiwayCommonTypes").ParticipantCallState.PENDING_APPROVAL:return o("ZenonParticipantState").ZenonParticipantState.PENDING_APPROVAL;case o("MultiwayCommonTypes").ParticipantCallState.APPROVED:return o("ZenonParticipantState").ZenonParticipantState.APPROVED;case o("MultiwayCommonTypes").ParticipantCallState.FAILED_APPROVAL:return o("ZenonParticipantState").ZenonParticipantState.FAILED_APPROVAL;case o("MultiwayCommonTypes").ParticipantCallState.HANGUP_IN_WAITING_ROOM:return o("ZenonParticipantState").ZenonParticipantState.HANGUP_IN_WAITING_ROOM;default:return o("ZenonParticipantState").ZenonParticipantState.UNKNOWN}}function C(e){var t=null;return e!=null&&e.forEach(function(e){var n,r=(n=e.body)==null?void 0:n.genericMessage;if(r!=null&&r.topic==="collision_context_payload"){var a=r.data;if(a!=null){var i,l,s,u=JSON.parse(o("RequestStreamBodyUtils").uint8ArrayToString(a));t={groupThreadID:(i=u.group_thread_id)!=null?i:null,peerID:(l=u.peer_id)!=null?l:null,serverInfoData:(s=u.server_info_data)!=null?s:null}}}}),t}function b(e){var t=e&&e.length>0?e.find(function(e){var t;return((t=e.body)==null||(t=t.genericMessage)==null?void 0:t.topic)==="room_metadata"}):null;if(t){var n,r=(n=t.body)==null||(n=n.genericMessage)==null?void 0:n.data;if(r!=null){var a,i=JSON.parse(o("RequestStreamBodyUtils").uint8ArrayToString(r)),l=(a=t.header)==null?void 0:a.sender;if(i.link_hash!=null&&i.room_name!=null&&l!=null)return{linkHash:i.link_hash,profileURL:i.profile_url,ringSubtitle:i.ring_subtitle,roomName:i.room_name,sender:l}}}return null}function v(e){return e.reduce(function(e,t){var n,r,a=(n=t.body)==null||(n=n.genericMessage)==null?void 0:n.topic,i=(r=t.body)==null||(r=r.genericMessage)==null?void 0:r.data;return a!=null&&i!=null&&(e[a]=o("RequestStreamBodyUtils").uint8ArrayToString(i)),e},{})}function S(e){switch(e){case o("ZenonMWMessageTypes").ZenonMWMediaPath.SFU:return o("MultiwaySharedTypes").MediaPath.SFU;case o("ZenonMWMessageTypes").ZenonMWMediaPath.P2P:return o("MultiwaySharedTypes").MediaPath.P2P;default:return o("MultiwaySharedTypes").MediaPath.UNKNOWN}}function R(e,t,n){n===void 0&&(n=0);var r={fromVersion:t,tracks:[],version:n};return e!=null&&Object.keys(e.tracks).forEach(function(t){var n,o,a=e.tracks[t],i={enabled:a.enabled,name:(n=a.name)!=null?n:"",participantID:(o=a.owner)!=null?o:"0",trackID:t,type:L(a.label)};r.tracks.push(i)}),r}function L(e){if(e==null)return null;switch(e){case o("WebrtcSignalingCommonTypes").TrackLabel.DEFAULT_AUDIO:return"audio";case o("WebrtcSignalingCommonTypes").TrackLabel.DEFAULT_VIDEO:return"video";case o("WebrtcSignalingCommonTypes").TrackLabel.SCREEN_AUDIO:return"screen_audio";case o("WebrtcSignalingCommonTypes").TrackLabel.SCREEN_VIDEO:return"screen";default:return null}}function E(e,t){var n=r("OverlayConfigServerLayer").createFromHeader(t);if(n){var o={eventName:"overlayConfigServerUpdateRequest",serverLayer:n};e.push(o)}}function k(e){var t=e.header,n=e.rtcMessageBody,r=e.type,o=$(t,r),a={messageBody:n,messageHeader:o};return a}function I(e){var t=e.header,n=e.rtcMessageBody,r=e.statusCode,o=e.subCode,a=e.type,i=O(t,a,r,o),l={messageBody:n,messageHeader:i};return l}var T={IN_ANOTHER_CALL:(u=o("MultiwayCommonTypes")).DeviceStatus.IN_ANOTHER_CALL,NO_OP:null,NOT_SUPPORTED:u.DeviceStatus.NOT_SUPPORTED,OK:u.DeviceStatus.OK};function D(e,t){return Object.keys(e).map(function(n){var r=e[n];return{body:{genericMessage:{data:o("RequestStreamBodyUtils").stringToUint8Array(r),topic:n}},header:{recipients:new Set(t),topic_DEPRECATED:n}}})}function x(e){var t,n=e.clientSessionId,a=e.conferenceName,i=e.receiver,l=e.receiverUserId,s=e.sequenceNumber,u=e.serverInfoData,c=e.transactionId,d=e.type;if(l==null){var m=d!=null?o("MultiwayCommonTypes").MessageType.getName(d):"UNKNOWN";r("FBLogger")("rpweb").info("Allowing null receiverUserId for MessageType: %s",m)}var p=n,_={userID:"2"},f={actorID:(t=i==null?void 0:i.actorId)!=null?t:null,messageID:c,messageTags:o("ZenonMWThriftMessageTagUtils").fromThriftMessageTags(e.messageTags),protocol:r("ZenonSignalingProtocol").MW,remoteInfo:_,retryCount:e.retryCount,roomInfo:{name:a},sequenceNumber:Number(s),signalingID:p,userInfo:{userID:l!=null?l:"1"}};return u!=null&&(f.remoteSignalingID=u),f}function $(e,t){var n,a,i,l=e.messageID,s=e.messageTags,u=e.remoteSignalingID,c=e.roomInfo,d=e.signalingID,m=r("addDevTierOverridesToHeaderExtensions")(window.location.href),p={clientStack:o("WebrtcSignalingCommonTypes").ClientStack.ZENON,conferenceName:(n=c.name)!=null?n:"",conferenceType:B((a=c.name)!=null?a:""),messageTags:new Set(s==null?void 0:s.map(function(e){return o("ZenonMWThriftMessageTagUtils").toThriftMessageTag(e)})),retryCount:e.retryCount,sequenceNumber:(i=e.sequenceNumber)==null?void 0:i.toString(),transactionId:l,type:t};return(m.multiwayCoreTier!==""||m.multiwayWwwTier!=="")&&(p.extensions=m),d!=null&&(p.clientSessionId=d),u!=null&&(p.serverInfoData=u),e.actorID!=null&&(p.sender={id:e.actorID}),p}function P(e){switch(e){case o("ZenonDismissReason").ZenonDismissReason.IgnoreCall:return o("MultiwayCommonTypes").HangupReason.IGNORE_CALL;case o("ZenonDismissReason").ZenonDismissReason.HangupCall:return o("MultiwayCommonTypes").HangupReason.HANGUP_CALL;case o("ZenonDismissReason").ZenonDismissReason.NoAnswerTimeout:return o("MultiwayCommonTypes").HangupReason.NO_ANSWER_TIMEOUT;case o("ZenonDismissReason").ZenonDismissReason.ClientError:return o("MultiwayCommonTypes").HangupReason.CLIENT_ERROR;case o("ZenonDismissReason").ZenonDismissReason.InAnotherCall:return o("MultiwayCommonTypes").HangupReason.IN_ANOTHER_CALL;case o("ZenonDismissReason").ZenonDismissReason.ClientInterrupted:return o("MultiwayCommonTypes").HangupReason.CLIENT_INTERRUPTED;case o("ZenonDismissReason").ZenonDismissReason.SessionMigrated:return o("MultiwayCommonTypes").HangupReason.SESSION_MIGRATED;default:return o("MultiwayCommonTypes").HangupReason.HANGUP_CALL}}function N(e){var t,n=(t=e.message.body)!=null?t:{},r=n.dominantSpeakerSignalingInfo,a=n.genericMessage,i=n.videoUploadSignalingInfo;return a?o("RequestStreamBodyUtils").uint8ArrayToString(a.data):r?JSON.stringify(r):i?JSON.stringify(i):null}function M(e){var t,n=(t=e.message.body)!=null?t:{},r=n.dominantSpeakerSignalingInfo,o=n.genericMessage,a=n.videoUploadSignalingInfo;return o?o.topic:r?d:a?m:null}function w(e){return e==null?null:e===1?o("MultiwaySharedTypes").EndpointServiceType.COMPOSITING_SERVICE:o("MultiwaySharedTypes").EndpointServiceType.UNKNOWN}function A(e){var t=F(e);return t!=null?t:o("ZenonDismissReason").ZenonDismissReason.CallEnded}function F(e){if(e==null)return null;switch(e){case o("MultiwayCommonTypes").DismissReason.CALL_ENDED:return o("ZenonDismissReason").ZenonDismissReason.CallEnded;case o("MultiwayCommonTypes").DismissReason.ANSWERED_ON_ANOTHER_DEVICE:return o("ZenonDismissReason").ZenonDismissReason.AnsweredOnAnotherDevice;case o("MultiwayCommonTypes").DismissReason.ANSWERED_BY_OTHER_USER:return o("ZenonDismissReason").ZenonDismissReason.AnsweredByOtherUser;case o("MultiwayCommonTypes").DismissReason.IN_ANOTHER_CALL:return o("ZenonDismissReason").ZenonDismissReason.InAnotherCall;case o("MultiwayCommonTypes").DismissReason.CONNECTION_DROPPED:return o("ZenonDismissReason").ZenonDismissReason.ConnectionDropped;case o("MultiwayCommonTypes").DismissReason.PRIMARY_ENDPOINT_HANGUP:return o("ZenonDismissReason").ZenonDismissReason.HangupCall;case o("MultiwayCommonTypes").DismissReason.REJECTED_ON_ANOTHER_DEVICE:return o("ZenonDismissReason").ZenonDismissReason.RejectedOnAnotherDevice;case o("MultiwayCommonTypes").DismissReason.REMOVED_BY_PARTICIPANT:return o("ZenonDismissReason").ZenonDismissReason.RemovedByParticipant;case o("MultiwayCommonTypes").DismissReason.REJECTED_BY_CALLEE:return o("ZenonDismissReason").ZenonDismissReason.RejectedByCallee;case o("MultiwayCommonTypes").DismissReason.INTERNAL_ERROR:return o("ZenonDismissReason").ZenonDismissReason.SignalingMessageFailed;case o("MultiwayCommonTypes").DismissReason.CALL_ENDED_BY_PRODUCT:return o("ZenonDismissReason").ZenonDismissReason.CallEndedByProduct;case o("MultiwayCommonTypes").DismissReason.TX_ACK_TIMEDOUT:return o("ZenonDismissReason").ZenonDismissReason.TxAckTimeout;default:return null}}function O(e,t,n,r){var a=$(e,t);return a.responseStatusCode=n!=null?n:o("MultiwayCommonTypes").RtcResponseStatusCode.OK,a.responseSubCode=r,a}function B(e){var t,n=e.indexOf(":");if(n===-1)return null;var r=e.slice(0,n);return(t=_.get(r))!=null?t:null}function W(e){var t={},n=!o("ZenonScreenShare").screenShareWithReplaceTrack();return e.tracks.forEach(function(e){var r={customAudioContentType:o("WebrtcSignalingCommonTypes").CustomAudioContentType.NONE,customVideoContentType:o("WebrtcSignalingCommonTypes").CustomVideoContentType.NONE,enabled:e.enabled},a=n?z(e.type):null;a!=null&&(r.label=a),t[e.trackID]=r}),{tracks:t}}function q(e){var t=T[e];return t!=null?t:o("MultiwayCommonTypes").DeviceStatus.OK}function U(e){var t={};return e.tracks.forEach(function(e){t[e.trackID]=e.enabled}),t}function V(e){return K[e]}function H(e){return e==null?null:Q[e]}function G(e){var t={};return e.forEach(function(e,n){t[n]={data:e.data,version:e.version}}),t}function z(e){switch(e){case"audio":return o("WebrtcSignalingCommonTypes").TrackLabel.DEFAULT_AUDIO;case"video":return o("WebrtcSignalingCommonTypes").TrackLabel.DEFAULT_VIDEO;case"screen":return o("WebrtcSignalingCommonTypes").TrackLabel.SCREEN_VIDEO;case"screen_audio":return o("WebrtcSignalingCommonTypes").TrackLabel.SCREEN_AUDIO;default:return null}}function j(e){return e===o("MultiwaySharedTypes").EndpointServiceType.COMPOSITING_SERVICE?1:0}var K=Object.freeze((e={},e[(c=o("ZenonSignalingTypes")).ZenonSignalingStatusCode.OK]=u.RtcResponseStatusCode.OK,e[c.ZenonSignalingStatusCode.REJECTED_FROM_VERSION_DOES_NOT_MATCH]=u.RtcResponseStatusCode.CONDITIONAL_REQUEST_FAILED,e[c.ZenonSignalingStatusCode.METHOD_NOT_ALLOWED]=u.RtcResponseStatusCode.METHOD_NOT_ALLOWED,e)),Q=Object.freeze((s={},s[c.ZenonSignalingStatusSubCode.CLIENT_TERMINATED]=u.RtcResponseSubCode.CLIENT_TERMINATED,s));l.addThriftStateStoreSignalingEvents=f,l.fetchE2eeServerState=g,l.fromThriftMediaPath=h,l.fromThriftParticipantState=y,l.getCollisionContextFromThriftAppMessages=C,l.getRoomMetadataFromThriftAppMessages=b,l.mwThriftAppMessagesToSignalingAppMessages=v,l.toThriftMediaPath=S,l.toZenonMediaStatesFromThrift=R,l.toMWClientTrackContentTypeFromThrift=L,l.maybeAddOverlayConfigServerUpdateRequestFromThrift=E,l.createMWThriftRequest=k,l.createMWThriftResponse=I,l.signalingMessageAppMessagesToThriftMWAppMessages=D,l.mwThriftMessageHeaderToSignalingMessageHeader=x,l.toMWThriftHangupReason=P,l.getGenericMWThriftDataMessageData=N,l.getGenericMWThriftDataMessageTopic=M,l.toThriftServiceRecipient=w,l.fromMWThriftDismissReason=A,l.getConferenceTypeFromName=B,l.toThriftMWMediaStatusEx=W,l.toMWThriftDeviceStatus=q,l.toMWThriftMediaStatus=U,l.toMWThriftResponseStatusCode=V,l.toMWThriftResponseStatusSubCode=H,l.toThriftMWSyncStateStore=G,l.toMWThriftTrackLabel=z,l.toServiceRecipientType=j}),98);
__d("ZenonMWThriftMessageDebugLogger",["Log","LogHistory","MultiwayCommonTypes","ODS","RequestStreamBodyUtils","RpWebStateMachineLoggingBlocklist.experimental","ZenonAuditedCheckpointLogId","ZenonIceStatsParser","ZenonInfraActionsLogger","ZenonMWThriftMessageMap","ZenonMWThriftTranslatorUtils","formatDate","isEmployeeTestUserZenonLogging"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(function(){function t(){this.$1=o("LogHistory").getInstance("webrtc"),this.$2=new Set(r("RpWebStateMachineLoggingBlocklist.experimental").MESSAGE_TYPES)}var n=t.prototype;return n.$3=function(t,n,o){n===void 0&&(n=!0);var e=r("formatDate")(new Date,"[H:i:s:X]",{skipPatternLocalization:!0});this.$1.log("Console",e+" "+t),n&&r("ZenonInfraActionsLogger").logCheckpoint({auditId:r("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"[ZP] "+t,messageID:o})},n.$4=function(t){var e=t.messageHeader.responseStatusCode;return e!=null},n.logMWThriftMessage=function(t,n,a){if(this.$5(t,n,a),!!r("isEmployeeTestUserZenonLogging")()){var e=a.messageHeader,i=o("ZenonMWThriftMessageMap").messageTypeToString(a.messageHeader.type),l=this.$4(a)?"RESPONSE":"REQUEST",s=this.$6(a),u="[ms] "+t+" ["+n+"] "+i+" "+l+" [retryCount: "+e.retryCount+(s!=null?" details: "+s:"")+"]";this.$2.has(i)||this.$3(u,!0,e.transactionId)}},n.$5=function(n,r,a){var t=this.$7(n,r,a);t!==null&&(e||(e=o("ODS"))).bumpEntityKey(4083,"zenon_signaling",t)},n.$7=function(t,n,r){var e=r.messageBody,a=r.messageHeader,i="";if(a.type!=null)switch(a.type){case o("MultiwayCommonTypes").MessageType.DATA_MESSAGE:if(e.dataMessageRequest){var l;i=(l=o("ZenonMWThriftTranslatorUtils").getGenericMWThriftDataMessageTopic(e.dataMessageRequest))!=null?l:"undefined"}break;default:break}var s=this.$4(r)?"RESPONSE":"REQUEST",u=o("ZenonMWThriftMessageMap").messageTypeToString(a.type);return i===""?t+"-"+n+"-"+u+"-"+s:t+"-"+n+"-"+u+"-"+s+"-"+i},n.$6=function(t){var e=t.messageHeader;if(o("MultiwayCommonTypes").MessageType==null||e.type==null)return null;switch(e.type){case o("MultiwayCommonTypes").MessageType.JOIN:return this.$8(t);case o("MultiwayCommonTypes").MessageType.SERVER_MEDIA_UPDATE:return this.$9(t);case o("MultiwayCommonTypes").MessageType.CLIENT_MEDIA_UPDATE:return this.$10(t);case o("MultiwayCommonTypes").MessageType.SUBSCRIPTION:return this.$11(t);case o("MultiwayCommonTypes").MessageType.ICE_CANDIDATE:return this.$12(t);default:return null}},n.$8=function(t){var e,n,r,a,i=t.messageBody,l=t.messageHeader;if(this.$4(t)){var s,u,c,d;return JSON.stringify({hasAnswer:((s=i.joinResponse)==null?void 0:s.answer)!=null,hasRenegotiationOffer:((u=i.joinResponse)==null?void 0:u.renegotiationOffer)!=null,isPendingApproval:(c=i.joinResponse)==null?void 0:c.isPendingApproval,multipleVideoStreamsAllowed:(d=i.joinResponse)==null?void 0:d.multipleVideoStreamsAllowed,statusCode:l.responseStatusCode,subCode:l.responseSubCode})}return JSON.stringify({deviceCapabilities:(e=i.joinRequest)==null?void 0:e.deviceCapabilities,sdpType:((n=i.joinRequest)==null?void 0:n.offer)!=null?"offer":((r=i.joinRequest)==null?void 0:r.answer)!=null?"answer":"null",userCapabilities:(a=i.joinRequest)!=null&&a.userCapabilities?o("RequestStreamBodyUtils").uint8ArrayToString(i.joinRequest.userCapabilities):""})},n.$9=function(t){var e,n,r,o,a,i,l,s,u=t.messageBody,c=t.messageHeader;if(this.$4(t)){var d,m;return JSON.stringify({currentVersion:(d=u.serverMediaUpdateResponse)==null?void 0:d.currentVersion,hasAnswer:((m=u.serverMediaUpdateResponse)==null?void 0:m.answer)!=null,statusCode:c.responseStatusCode,subCode:c.responseSubCode})}return JSON.stringify({fromVersion:(e=u.serverMediaUpdateRequest)==null?void 0:e.fromVersion,messageTags:c.messageTags,renegotiationRequested:(n=(r=u.serverMediaUpdateRequest)==null?void 0:r.renegotiationRequested)!=null?n:!1,sdpType:(o=u.serverMediaUpdateRequest)!=null&&o.offer?"offer":(a=u.serverMediaUpdateRequest)!=null&&a.answer?"answer":(i=u.serverMediaUpdateRequest)!=null&&i.update?"delta":"empty",toVersion:(l=(s=u.serverMediaUpdateRequest)==null?void 0:s.toVersion)!=null?l:""})},n.$10=function(t){var e,n,r,o,a=t.messageBody,i=t.messageHeader;if(this.$4(t)){var l,s;return JSON.stringify({currentVersion:(l=(s=a.clientMediaUpdateResponse)==null?void 0:s.currentVersion)!=null?l:"",statusCode:i.responseStatusCode,subCode:i.responseSubCode})}return JSON.stringify({fromVersion:(e=(n=a.clientMediaUpdateRequest)==null?void 0:n.fromVersion)!=null?e:"",toVersion:(r=(o=a.clientMediaUpdateRequest)==null?void 0:o.toVersion)!=null?r:""})},n.$11=function(t){var e,n,r=t.messageBody;return this.$4(t)?null:JSON.stringify({subscriptions:(e=(n=r.subscriptionRequest)==null?void 0:n.subscriptions)!=null?e:""})},n.$12=function(t){var e,n=t.messageBody;if(this.$4(t))return null;var r=(e=n.iceCandidateRequest)==null?void 0:e.iceCandidateSdps.map(function(e){var t=e.candidateSdpString;if(t!=null)return o("ZenonIceStatsParser").extractIceInfo(t)});return JSON.stringify({iceCandidates:r})},n.logSendMultiwayThriftMessageFailure=function(n,a,i){(e||(e=o("ODS"))).bumpEntityKey(4083,"zenon_multiway","send_message_failure"),e.flush();var t=i?"Stack Trace: "+i.stack+".":"Error msg: "+n;r("ZenonInfraActionsLogger").logCheckpoint({auditId:r("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"Failed to send MW Thrift message of type "+a+". "+t})},t})(),u=new s;l.default=u}),98);
__d("ZenonMWMessageReliabilityLogTypes",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["RECEIVED_REQUEST","RECEIVED_RESPONSE","PROCESSING_REQUEST","START_PROCESSING_RESPONSE","PROCESSING_RESPONSE","PROCESSED_REQUEST","PROCESSED_RESPONSE","SENDING_REQUEST","SENDING_RESPONSE","SENT_REQUEST","SENT_REQUEST_FROM_HANDLER","SENT_RESPONSE","SEND_REQUEST_FAILED","SEND_REQUEST_FAILED_FROM_HANDLER","SEND_RESPONSE_FAILED","SENT_SM_EVENT","PROCESSED_SM_EVENT","REQUEST_AFTER_NULL_CHECK","REQUEST_AFTER_TRANSLATION"]);i.ZenonMWMessageReliabilityEvent=e}),66);
__d("ZenonMWThriftResponseStatusCodeUtils",["MultiwayCommonTypes","ZenonMWMessageTypes"],(function(t,n,r,o,a,i,l){"use strict";function e(e){switch(e){case o("MultiwayCommonTypes").RtcResponseStatusCode.OK:return o("ZenonMWMessageTypes").ZenonMWResponseStatusCode.OK;case o("MultiwayCommonTypes").RtcResponseStatusCode.BAD_REQUEST:return o("ZenonMWMessageTypes").ZenonMWResponseStatusCode.BAD_REQUEST;case o("MultiwayCommonTypes").RtcResponseStatusCode.UNAUTHORIZED:return o("ZenonMWMessageTypes").ZenonMWResponseStatusCode.UNAUTHORIZED;case o("MultiwayCommonTypes").RtcResponseStatusCode.NOT_FOUND:return o("ZenonMWMessageTypes").ZenonMWResponseStatusCode.NOT_FOUND;case o("MultiwayCommonTypes").RtcResponseStatusCode.METHOD_NOT_ALLOWED:return o("ZenonMWMessageTypes").ZenonMWResponseStatusCode.METHOD_NOT_ALLOWED;case o("MultiwayCommonTypes").RtcResponseStatusCode.CONFLICT:return o("ZenonMWMessageTypes").ZenonMWResponseStatusCode.CONFLICT;case o("MultiwayCommonTypes").RtcResponseStatusCode.CONDITIONAL_REQUEST_FAILED:return o("ZenonMWMessageTypes").ZenonMWResponseStatusCode.CONDITIONAL_REQUEST_FAILED;case o("MultiwayCommonTypes").RtcResponseStatusCode.SERVER_INTERNAL_ERROR:return o("ZenonMWMessageTypes").ZenonMWResponseStatusCode.SERVER_INTERNAL_ERROR;case o("MultiwayCommonTypes").RtcResponseStatusCode.SERVICE_UNAVAILABLE:return o("ZenonMWMessageTypes").ZenonMWResponseStatusCode.SERVICE_UNAVAILABLE}}function s(e){switch(e){case o("MultiwayCommonTypes").RtcResponseSubCode.UNKNOWN:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.UNKNOWN;case o("MultiwayCommonTypes").RtcResponseSubCode.EXCEEDED_MAX_ALLOWED_PARTICIPANTS:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.EXCEEDED_MAX_ALLOWED_PARTICIPANTS;case o("MultiwayCommonTypes").RtcResponseSubCode.MEMBERSHIP_CHECK_FAIL:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MEMBERSHIP_CHECK_FAIL;case o("MultiwayCommonTypes").RtcResponseSubCode.CONFERENCE_THROTTLED:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFERENCE_THROTTLED;case o("MultiwayCommonTypes").RtcResponseSubCode.ENDPOINT_THROTTLED:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.ENDPOINT_THROTTLED;case o("MultiwayCommonTypes").RtcResponseSubCode.MWS_MESSAGE_SENT_TO_INCORRECT_REGION:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MWS_MESSAGE_SENT_TO_INCORRECT_REGION;case o("MultiwayCommonTypes").RtcResponseSubCode.UNSUPPORTED_REQUEST_TYPE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.UNSUPPORTED_REQUEST_TYPE;case o("MultiwayCommonTypes").RtcResponseSubCode.CLIENT_REQUEST_UNACCEPTABLE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CLIENT_REQUEST_UNACCEPTABLE;case o("MultiwayCommonTypes").RtcResponseSubCode.CLIENT_RESPONSE_UNACCEPTABLE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CLIENT_RESPONSE_UNACCEPTABLE;case o("MultiwayCommonTypes").RtcResponseSubCode.RING_RESPONSE_BODY_NOT_SET:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.RING_RESPONSE_BODY_NOT_SET;case o("MultiwayCommonTypes").RtcResponseSubCode.SERVER_MEDIA_UPDATE_RESPONSE_BODY_NOT_SET:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.SERVER_MEDIA_UPDATE_RESPONSE_BODY_NOT_SET;case o("MultiwayCommonTypes").RtcResponseSubCode.INVALID_SDP:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_SDP;case o("MultiwayCommonTypes").RtcResponseSubCode.INVALID_CONFERENCE_NAME:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_CONFERENCE_NAME;case o("MultiwayCommonTypes").RtcResponseSubCode.SERVER_INFO_CONFERENCE_NAME_MISMATCH:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.SERVER_INFO_CONFERENCE_NAME_MISMATCH;case o("MultiwayCommonTypes").RtcResponseSubCode.INVALID_USER_ID:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_USER_ID;case o("MultiwayCommonTypes").RtcResponseSubCode.INCORRECT_VERSION_RANGE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.INCORRECT_VERSION_RANGE;case o("MultiwayCommonTypes").RtcResponseSubCode.SENDER_ID_MISMATCH:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.SENDER_ID_MISMATCH;case o("MultiwayCommonTypes").RtcResponseSubCode.RECIPIENT_NOT_SPECIFIED:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.RECIPIENT_NOT_SPECIFIED;case o("MultiwayCommonTypes").RtcResponseSubCode.FIELD_NOT_ALLOWED:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.FIELD_NOT_ALLOWED;case o("MultiwayCommonTypes").RtcResponseSubCode.USERS_NOT_SPECIFIED:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.USERS_NOT_SPECIFIED;case o("MultiwayCommonTypes").RtcResponseSubCode.REQUEST_UNACCEPTABLE_FOR_ENDPOINT_STATE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.REQUEST_UNACCEPTABLE_FOR_ENDPOINT_STATE;case o("MultiwayCommonTypes").RtcResponseSubCode.INVALID_CALL_ID:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_CALL_ID;case o("MultiwayCommonTypes").RtcResponseSubCode.SESSION_DESCRIPTION_ID_MISMATCH:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.SESSION_DESCRIPTION_ID_MISMATCH;case o("MultiwayCommonTypes").RtcResponseSubCode.EMPTY_CLIENT_MEDIA_UPDATES:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.EMPTY_CLIENT_MEDIA_UPDATES;case o("MultiwayCommonTypes").RtcResponseSubCode.INVALID_SERVER_INFO_DATA:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_SERVER_INFO_DATA;case o("MultiwayCommonTypes").RtcResponseSubCode.INCORRECT_STATE_VERSION:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.INCORRECT_STATE_VERSION;case o("MultiwayCommonTypes").RtcResponseSubCode.MISMATCHED_STATE_FOR_VERSION:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISMATCHED_STATE_FOR_VERSION;case o("MultiwayCommonTypes").RtcResponseSubCode.INVALID_STATE_VERSION:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_STATE_VERSION;case o("MultiwayCommonTypes").RtcResponseSubCode.NO_RESOLVER_FOUND:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.NO_RESOLVER_FOUND;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_APPROVERLIST:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_APPROVERLIST;case o("MultiwayCommonTypes").RtcResponseSubCode.FULL_SDP_REQUIRED_IN_APPROVED_STATE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.FULL_SDP_REQUIRED_IN_APPROVED_STATE;case o("MultiwayCommonTypes").RtcResponseSubCode.INVALID_BROADCAST_ID:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_BROADCAST_ID;case o("MultiwayCommonTypes").RtcResponseSubCode.INVALID_ENDPOINT_CONFIG:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_ENDPOINT_CONFIG;case o("MultiwayCommonTypes").RtcResponseSubCode.INVALID_E2EE_STATE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_E2EE_STATE;case o("MultiwayCommonTypes").RtcResponseSubCode.SFU_MODE_PREVENTED:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.SFU_MODE_PREVENTED;case o("MultiwayCommonTypes").RtcResponseSubCode.INVALID_CONFERENCE_STATE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_CONFERENCE_STATE;case o("MultiwayCommonTypes").RtcResponseSubCode.JOIN_REQUEST_DENIED:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.JOIN_REQUEST_DENIED;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_ENDPOINT:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_ENDPOINT;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_HEADER:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_HEADER;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_BODY:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_BODY;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_PARAMS:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_PARAMS;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_REMOVE_PARTICIPANTS_REQUEST:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_REMOVE_PARTICIPANTS_REQUEST;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_DATA_MESSAGE_REQUEST:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_DATA_MESSAGE_REQUEST;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_CLIENT_MEDIA_UPDATE_REQUEST:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_CLIENT_MEDIA_UPDATE_REQUEST;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_ADD_PARTICIPANTS_REQUEST:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_ADD_PARTICIPANTS_REQUEST;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_SUBSCRIPTION_REQUEST:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_SUBSCRIPTION_REQUEST;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_JOIN_REQUEST:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_JOIN_REQUEST;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_HANGUP_REQUEST:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_HANGUP_REQUEST;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_ICE_CANDIDATE_REQUEST:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_ICE_CANDIDATE_REQUEST;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_P2P_MESSAGE_REQUEST:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_P2P_MESSAGE_REQUEST;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_UPDATE_REQUEST:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_UPDATE_REQUEST;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_CLIENT_EVENT_REQUEST:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_CLIENT_EVENT_REQUEST;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_CONNECT_REQUEST:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_CONNECT_REQUEST;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_UNSUBSCRIBE_REQUEST:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_UNSUBSCRIBE_REQUEST;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_APPROVAL_REQUEST:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_APPROVAL_REQUEST;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_ENDPOINT_USER_ID:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_ENDPOINT_USER_ID;case o("MultiwayCommonTypes").RtcResponseSubCode.EMPTY_ENDPOINT_USER_ID:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.EMPTY_ENDPOINT_USER_ID;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_TRANSFER_REQUEST:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_TRANSFER_REQUEST;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_GENERIC:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_GENERIC;case o("MultiwayCommonTypes").RtcResponseSubCode.REQUESTOR_NOT_MEMBER_CONFERENCE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.REQUESTOR_NOT_MEMBER_CONFERENCE;case o("MultiwayCommonTypes").RtcResponseSubCode.NOT_BROADCAST_OWNER:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.NOT_BROADCAST_OWNER;case o("MultiwayCommonTypes").RtcResponseSubCode.GUEST_NOT_INVITED:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.GUEST_NOT_INVITED;case o("MultiwayCommonTypes").RtcResponseSubCode.GUEST_DISCONNECTED:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.GUEST_DISCONNECTED;case o("MultiwayCommonTypes").RtcResponseSubCode.GUEST_INVITATION_EXPIRED:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.GUEST_INVITATION_EXPIRED;case o("MultiwayCommonTypes").RtcResponseSubCode.PARTICIPANT_IN_PENDING_APPROVAL_STATE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.PARTICIPANT_IN_PENDING_APPROVAL_STATE;case o("MultiwayCommonTypes").RtcResponseSubCode.INVALID_MULTIWAY_PARAMS:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_MULTIWAY_PARAMS;case o("MultiwayCommonTypes").RtcResponseSubCode.BROADCAST_ALREADY_STOPPED:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.BROADCAST_ALREADY_STOPPED;case o("MultiwayCommonTypes").RtcResponseSubCode.FAILED_TO_GENERATE_SDP_ANSWER:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.FAILED_TO_GENERATE_SDP_ANSWER;case o("MultiwayCommonTypes").RtcResponseSubCode.FAILED_GENERATE_SESSION_DESCRIPTION:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.FAILED_GENERATE_SESSION_DESCRIPTION;case o("MultiwayCommonTypes").RtcResponseSubCode.SDP_SESSION_ID_MISMATCH:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.SDP_SESSION_ID_MISMATCH;case o("MultiwayCommonTypes").RtcResponseSubCode.MEDIA_ENDPOINT_GONE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MEDIA_ENDPOINT_GONE;case o("MultiwayCommonTypes").RtcResponseSubCode.MEDIA_ENDPOINT_ALREADY_EXISTS:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MEDIA_ENDPOINT_ALREADY_EXISTS;case o("MultiwayCommonTypes").RtcResponseSubCode.MEDIA_ENDPOINT_EXISTS_DIFFERENT_SESSION_ID:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MEDIA_ENDPOINT_EXISTS_DIFFERENT_SESSION_ID;case o("MultiwayCommonTypes").RtcResponseSubCode.LEGACY_MESSENGER_SENDER_UNSET:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.LEGACY_MESSENGER_SENDER_UNSET;case o("MultiwayCommonTypes").RtcResponseSubCode.FAILED_TO_SET_TRANSPORT_INFO:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.FAILED_TO_SET_TRANSPORT_INFO;case o("MultiwayCommonTypes").RtcResponseSubCode.NON_PRIMARY_MULTIWAY_SERVER:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.NON_PRIMARY_MULTIWAY_SERVER;case o("MultiwayCommonTypes").RtcResponseSubCode.FAILED_TO_GET_REMOTE_DESCRIPTION:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.FAILED_TO_GET_REMOTE_DESCRIPTION;case o("MultiwayCommonTypes").RtcResponseSubCode.LOCAL_DESCRIPTION_NOT_SET:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.LOCAL_DESCRIPTION_NOT_SET;case o("MultiwayCommonTypes").RtcResponseSubCode.INVALID_SDP_TYPE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_SDP_TYPE;case o("MultiwayCommonTypes").RtcResponseSubCode.CLIENT_MEDIA_UPDATE_WITHOUT_REMOTE_SDP_INFO:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CLIENT_MEDIA_UPDATE_WITHOUT_REMOTE_SDP_INFO;case o("MultiwayCommonTypes").RtcResponseSubCode.SDP_UNSET_ON_P2P_ANSWER:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.SDP_UNSET_ON_P2P_ANSWER;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_ICE_CANDIDATE_PAYLOAD:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_ICE_CANDIDATE_PAYLOAD;case o("MultiwayCommonTypes").RtcResponseSubCode.P2P_PROTOCOL_UNSET:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.P2P_PROTOCOL_UNSET;case o("MultiwayCommonTypes").RtcResponseSubCode.CREATE_ACK_FOR_INVALID_MESSAGE_TYPE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CREATE_ACK_FOR_INVALID_MESSAGE_TYPE;case o("MultiwayCommonTypes").RtcResponseSubCode.LEGACY_CLIENT_CANNOT_JOIN_SFU_MODE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.LEGACY_CLIENT_CANNOT_JOIN_SFU_MODE;case o("MultiwayCommonTypes").RtcResponseSubCode.CONNECT_UNSUPPORTED_IN_SFU_MODE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONNECT_UNSUPPORTED_IN_SFU_MODE;case o("MultiwayCommonTypes").RtcResponseSubCode.CONNECT_UNSUPPORTED_DURING_P2P_TO_SFU_ESCALATION:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONNECT_UNSUPPORTED_DURING_P2P_TO_SFU_ESCALATION;case o("MultiwayCommonTypes").RtcResponseSubCode.CONNECT_UNSUPPORTED_FOR_JOINED_ENDPOINTS:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONNECT_UNSUPPORTED_FOR_JOINED_ENDPOINTS;case o("MultiwayCommonTypes").RtcResponseSubCode.RESOLVE_STATE_API_ERROR:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.RESOLVE_STATE_API_ERROR;case o("MultiwayCommonTypes").RtcResponseSubCode.EXTERNAL_RESOLUTION_ERROR:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.EXTERNAL_RESOLUTION_ERROR;case o("MultiwayCommonTypes").RtcResponseSubCode.INTERNAL_RESOLUTION_ERROR:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.INTERNAL_RESOLUTION_ERROR;case o("MultiwayCommonTypes").RtcResponseSubCode.RESOLUTION_DISABLED:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.RESOLUTION_DISABLED;case o("MultiwayCommonTypes").RtcResponseSubCode.BROADCAST_ID_MISSING:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.BROADCAST_ID_MISSING;case o("MultiwayCommonTypes").RtcResponseSubCode.SDP_UNSET_ON_P2P_OFFER:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.SDP_UNSET_ON_P2P_OFFER;case o("MultiwayCommonTypes").RtcResponseSubCode.LEGACY_OFFER_MISSING_REQUIRED_VALUE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.LEGACY_OFFER_MISSING_REQUIRED_VALUE;case o("MultiwayCommonTypes").RtcResponseSubCode.MEDIA_SERVER_STATE_SYNC_DESERIALIZATION_ERROR:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MEDIA_SERVER_STATE_SYNC_DESERIALIZATION_ERROR;case o("MultiwayCommonTypes").RtcResponseSubCode.CONNECT_UNSUPPORTED_FOR_PRECONNECTED_USERS:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONNECT_UNSUPPORTED_FOR_PRECONNECTED_USERS;case o("MultiwayCommonTypes").RtcResponseSubCode.OTHER_USER_ANSWERED_THE_CALL:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.OTHER_USER_ANSWERED_THE_CALL;case o("MultiwayCommonTypes").RtcResponseSubCode.MEDIA_SERVER_DESERIALIZATION_ERROR:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MEDIA_SERVER_DESERIALIZATION_ERROR;case o("MultiwayCommonTypes").RtcResponseSubCode.REMOTE_SDP_TRACKID_MISMATCH:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.REMOTE_SDP_TRACKID_MISMATCH;case o("MultiwayCommonTypes").RtcResponseSubCode.SIGNALING_MESSAGE_TO_CLIENT_DROPPED:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.SIGNALING_MESSAGE_TO_CLIENT_DROPPED;case o("MultiwayCommonTypes").RtcResponseSubCode.DATA_CHANNEL_ENDPOINT_GONE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.DATA_CHANNEL_ENDPOINT_GONE;case o("MultiwayCommonTypes").RtcResponseSubCode.DATA_CHANNEL_ENDPOINT_ALREADY_EXISTS:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.DATA_CHANNEL_ENDPOINT_ALREADY_EXISTS;case o("MultiwayCommonTypes").RtcResponseSubCode.CONFERENCE_NOT_FOUND:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFERENCE_NOT_FOUND;case o("MultiwayCommonTypes").RtcResponseSubCode.CONFERENCE_IS_TERMINATING:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFERENCE_IS_TERMINATING;case o("MultiwayCommonTypes").RtcResponseSubCode.CONFERENCE_IS_TERMINATED:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFERENCE_IS_TERMINATED;case o("MultiwayCommonTypes").RtcResponseSubCode.CONFERENCE_NAME_EMPTY:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFERENCE_NAME_EMPTY;case o("MultiwayCommonTypes").RtcResponseSubCode.NONCE_EMPTY:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.NONCE_EMPTY;case o("MultiwayCommonTypes").RtcResponseSubCode.NONCE_MISMATCH:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.NONCE_MISMATCH;case o("MultiwayCommonTypes").RtcResponseSubCode.CONFERENCE_HAS_GONE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFERENCE_HAS_GONE;case o("MultiwayCommonTypes").RtcResponseSubCode.PARTICIPANT_HAS_GONE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.PARTICIPANT_HAS_GONE;case o("MultiwayCommonTypes").RtcResponseSubCode.MEDIA_SERVER_NOT_FOUND:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MEDIA_SERVER_NOT_FOUND;case o("MultiwayCommonTypes").RtcResponseSubCode.CLIENT_TERMINATED:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CLIENT_TERMINATED;case o("MultiwayCommonTypes").RtcResponseSubCode.MEDIA_CODECS_UNSUPPORTED_BY_CONFERENCE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MEDIA_CODECS_UNSUPPORTED_BY_CONFERENCE;case o("MultiwayCommonTypes").RtcResponseSubCode.CONFERENCE_INCAPABLE_RENEGOTIATION:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFERENCE_INCAPABLE_RENEGOTIATION;case o("MultiwayCommonTypes").RtcResponseSubCode.REJECTING_CMU_WHEN_SMU_PENDING:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.REJECTING_CMU_WHEN_SMU_PENDING;case o("MultiwayCommonTypes").RtcResponseSubCode.PARTICIPANT_NOT_SUBSCRIBED_TO_TOPIC:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.PARTICIPANT_NOT_SUBSCRIBED_TO_TOPIC;case o("MultiwayCommonTypes").RtcResponseSubCode.PARTICIPANT_ALREADY_IN_WAITING_ROOM:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.PARTICIPANT_ALREADY_IN_WAITING_ROOM;case o("MultiwayCommonTypes").RtcResponseSubCode.PARTICIPANT_NOT_IN_PENDING_APPROVAL:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.PARTICIPANT_NOT_IN_PENDING_APPROVAL;case o("MultiwayCommonTypes").RtcResponseSubCode.USER_NOT_APPROVER_FOR_TARGET_USER:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.USER_NOT_APPROVER_FOR_TARGET_USER;case o("MultiwayCommonTypes").RtcResponseSubCode.UNSUPPORTED_CAPABILITIES:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.UNSUPPORTED_CAPABILITIES;case o("MultiwayCommonTypes").RtcResponseSubCode.PRODUCT_SERVER_DEFINED_END_REASON:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.PRODUCT_SERVER_DEFINED_END_REASON;case o("MultiwayCommonTypes").RtcResponseSubCode.WWW_KILLSWITCHED_REQUEST:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.WWW_KILLSWITCHED_REQUEST;case o("MultiwayCommonTypes").RtcResponseSubCode.CONFLICTING_MEDIA_PATH:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFLICTING_MEDIA_PATH;case o("MultiwayCommonTypes").RtcResponseSubCode.CONFLICTING_MEDIA_STATUS:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFLICTING_MEDIA_STATUS;case o("MultiwayCommonTypes").RtcResponseSubCode.CONFLICTING_SESSION_DESCRIPTION:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFLICTING_SESSION_DESCRIPTION;case o("MultiwayCommonTypes").RtcResponseSubCode.EMPTY_USER_IDS:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.EMPTY_USER_IDS;case o("MultiwayCommonTypes").RtcResponseSubCode.MISSING_SDP_CONNECT_REQUEST:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_SDP_CONNECT_REQUEST;case o("MultiwayCommonTypes").RtcResponseSubCode.CALLER_HAS_APPEALABLE_CALLING_RESTRICTION:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CALLER_HAS_APPEALABLE_CALLING_RESTRICTION;case o("MultiwayCommonTypes").RtcResponseSubCode.P2P_CONNECT_UNSUPPORTED_AFTER_SFU_ESCALATION:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.P2P_CONNECT_UNSUPPORTED_AFTER_SFU_ESCALATION;case o("MultiwayCommonTypes").RtcResponseSubCode.CONNECT_EXCEEDED_MAX_ALLOWED_ENDPOINTS_PER_CONFERENCE:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONNECT_EXCEEDED_MAX_ALLOWED_ENDPOINTS_PER_CONFERENCE;case o("MultiwayCommonTypes").RtcResponseSubCode.CONNECT_EXCEEDED_MAX_ALLOWED_ENDPOINTS_PER_USER:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONNECT_EXCEEDED_MAX_ALLOWED_ENDPOINTS_PER_USER;case o("MultiwayCommonTypes").RtcResponseSubCode.REQUEST_TIMEOUT:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.REQUEST_TIMEOUT;case o("MultiwayCommonTypes").RtcResponseSubCode.TOO_MANY_MEDIA_TRACKS_IN_SDP:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.TOO_MANY_MEDIA_TRACKS_IN_SDP;case o("MultiwayCommonTypes").RtcResponseSubCode.OK:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.OK;case o("MultiwayCommonTypes").RtcResponseSubCode.ENDPOINT_INFO_RESULT_MISSING:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.ENDPOINT_INFO_RESULT_MISSING;case o("MultiwayCommonTypes").RtcResponseSubCode.INVITE_USERS_RESULT_MISSING:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVITE_USERS_RESULT_MISSING;case o("MultiwayCommonTypes").RtcResponseSubCode.JOIN_SESSION_RESULT_MISSING:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.JOIN_SESSION_RESULT_MISSING;case o("MultiwayCommonTypes").RtcResponseSubCode.LOGGING_POLICY_RESULT_MISSING:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.LOGGING_POLICY_RESULT_MISSING;case o("MultiwayCommonTypes").RtcResponseSubCode.STATE_SYNC_RESULT_MISSING:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.STATE_SYNC_RESULT_MISSING;case o("MultiwayCommonTypes").RtcResponseSubCode.CONFERENCE_NAME_MISMATCH:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFERENCE_NAME_MISMATCH;case o("MultiwayCommonTypes").RtcResponseSubCode.SESSION_CONFIGURATION_RESULT_MISSING:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.SESSION_CONFIGURATION_RESULT_MISSING;case o("MultiwayCommonTypes").RtcResponseSubCode.REMOVE_USERS_RESULT_MISSING:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.REMOVE_USERS_RESULT_MISSING;case o("MultiwayCommonTypes").RtcResponseSubCode.UNEXPECTED_TRANSPORT_PARAMS_CONFERENCE_NAME:return o("ZenonMWMessageTypes").ZenonMWResponseSubCode.UNEXPECTED_TRANSPORT_PARAMS_CONFERENCE_NAME}}l.getResponseStatusCodeFromThrift=e,l.getResponseSubCodeFromThrift=s}),98);
__d("ZenonTransportChannelStatus",["cr:17347"],(function(t,n,r,o,a,i,l){"use strict";l.default=n("cr:17347")}),98);
__d("ZenonMWThriftMessageQPLLogger",["DateConsts","QPLMsgTypesSitevarConfig.experimental","QPLUserFlow","ZenonLoggingUtils","ZenonMWMessageReliabilityLogTypes","ZenonMWThriftMessageMap","ZenonMWThriftMessageTagUtils","ZenonMWThriftResponseStatusCodeUtils","ZenonTransportChannelStatus","qpl"],(function(t,n,r,o,a,i,l){"use strict";var e=30*o("DateConsts").MS_PER_SEC,s=new Map,u=new(r("ZenonTransportChannelStatus"));function c(e,t,n){var a,i,l,s,u,c;if(o("ZenonLoggingUtils").shouldAllowLogging()){var d=e.messageHeader,L=o("ZenonMWThriftMessageMap").messageTypeToString(e.messageHeader.type).toLowerCase();if(r("QPLMsgTypesSitevarConfig.experimental").QPL_MSG_TYPES.includes(L)){var E=m(d.transactionId);switch(t){case o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.RECEIVED_REQUEST:p(E,L,{connectionState:(a=n==null?void 0:n.connectionState)!=null?a:"",peerConnectionState:(i=n==null?void 0:n.peerConnectionState)!=null?i:"",signalingState:(l=n==null?void 0:n.signalingState)!=null?l:""},e);return;case o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_REQUEST:_(E);return;case o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENDING_RESPONSE:f(E,e);return;case o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_RESPONSE:g(E,e);return;case o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SEND_RESPONSE_FAILED:h(E,e,n==null?void 0:n.errorMessage);return;case o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_REQUEST:y(E,L,{connectionState:(s=n==null?void 0:n.connectionState)!=null?s:"",peerConnectionState:(u=n==null?void 0:n.peerConnectionState)!=null?u:"",signalingState:(c=n==null?void 0:n.signalingState)!=null?c:""},e);return;case o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENDING_REQUEST:C(E);return;case o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SEND_REQUEST_FAILED:b(E,n==null?void 0:n.errorMessage);return;case o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.RECEIVED_RESPONSE:v(E,e);return;case o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_SM_EVENT:S(E,n==null?void 0:n.smEvent);return;case o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_SM_EVENT:R(E,n==null?void 0:n.smEvent);return;default:return}}}}function d(e,t){o("ZenonLoggingUtils").shouldAllowLogging()&&r("QPLUserFlow").addAnnotations(r("qpl")._(398988976,"737"),{string:babelHelpers.extends({},t)},{instanceKey:+e})}function m(e){var t=isNaN(+e)?0:+e,n=9223372036854776e3;return Math.round(t%n)}function p(t,n,a,i){var l=u.getTransportName()+"State",c=babelHelpers.extends({},a,{messageType:n});if(c[l]=u.getConnectionState(),r("QPLUserFlow").start(r("qpl")._(398988976,"737"),{annotations:{int:{retryCount:i.messageHeader.retryCount},int_array:{messageTags:o("ZenonMWThriftMessageTagUtils").fromThriftMessageTags(i.messageHeader.messageTags)},string:c},instanceKey:t,timeoutInMs:e}),i.messageBody.serverMediaUpdateRequest){var d=i.messageBody.serverMediaUpdateRequest,m=d.answer,p=d.offer,_=d.update;r("QPLUserFlow").addAnnotations(r("qpl")._(398988976,"737"),{string:{sdpType:p?"offer":m?"answer":_?"delta":"empty"}},{instanceKey:t})}var f=function(n){r("QPLUserFlow").addPoint(r("qpl")._(398988976,"737"),u.getTransportName()+"_"+n,{instanceKey:t})},g=u.addListener("connectionStateEvent",f);s.set(t,g)}function _(e){r("QPLUserFlow").addPoint(r("qpl")._(398988976,"737"),"processed_request",{instanceKey:e})}function f(e,t){var n=t.messageHeader,a=n.responseStatusCode,i=n.responseSubCode;r("QPLUserFlow").addPoint(r("qpl")._(398988976,"737"),"sending_response",{instanceKey:e}),r("QPLUserFlow").addAnnotations(r("qpl")._(398988976,"737"),{int:{responseStatusCode:a?o("ZenonMWThriftResponseStatusCodeUtils").getResponseStatusCodeFromThrift(a):200,responseSubCode:i?o("ZenonMWThriftResponseStatusCodeUtils").getResponseSubCodeFromThrift(i):9e3}},{instanceKey:e})}function g(e,t){var n=t.messageHeader,a=n.responseStatusCode,i=n.responseSubCode;r("QPLUserFlow").endSuccess(r("qpl")._(398988976,"737"),{annotations:{int:{responseStatusCode:a?o("ZenonMWThriftResponseStatusCodeUtils").getResponseStatusCodeFromThrift(a):200,responseSubCode:i?o("ZenonMWThriftResponseStatusCodeUtils").getResponseSubCodeFromThrift(i):9e3}},instanceKey:e});var l=s.get(e);l&&(u.removeListener(l),s.delete(e))}function h(e,t,n){var a=t.messageHeader,i=a.responseStatusCode,l=a.responseSubCode;r("QPLUserFlow").endFailure(r("qpl")._(398988976,"737"),"send_response_failed",{annotations:{int:{responseStatusCode:i?o("ZenonMWThriftResponseStatusCodeUtils").getResponseStatusCodeFromThrift(i):200,responseSubCode:l?o("ZenonMWThriftResponseStatusCodeUtils").getResponseSubCodeFromThrift(l):9e3},string:{errorMessage:n}},instanceKey:e});var c=s.get(e);c&&(u.removeListener(c),s.delete(e))}function y(t,n,a,i){var l=u.getTransportName()+"State",s=babelHelpers.extends({},a,{messageType:n});s[l]=u.getConnectionState(),r("QPLUserFlow").start(r("qpl")._(398988976,"737"),{annotations:{int:{retryCount:i.messageHeader.retryCount},int_array:{messageTags:o("ZenonMWThriftMessageTagUtils").fromThriftMessageTags(i.messageHeader.messageTags)},string:s},instanceKey:t,timeoutInMs:e})}function C(e){r("QPLUserFlow").addPoint(r("qpl")._(398988976,"737"),"sending_request",{instanceKey:e})}function b(e,t){r("QPLUserFlow").endFailure(r("qpl")._(398988976,"737"),"send_request_failed",{annotations:{string:{errorMessage:t}},instanceKey:e})}function v(e,t){var n=t.messageHeader,a=n.responseStatusCode,i=n.responseSubCode;r("QPLUserFlow").endSuccess(r("qpl")._(398988976,"737"),{annotations:{int:{responseStatusCode:a?o("ZenonMWThriftResponseStatusCodeUtils").getResponseStatusCodeFromThrift(a):200,responseSubCode:i?o("ZenonMWThriftResponseStatusCodeUtils").getResponseSubCodeFromThrift(i):9e3}},instanceKey:e})}function S(e,t){t!=null&&r("QPLUserFlow").addPoint(r("qpl")._(398988976,"737"),"sent_sm_event:"+t,{instanceKey:e})}function R(e,t){t!=null&&r("QPLUserFlow").addPoint(r("qpl")._(398988976,"737"),"processed_sm_event:"+t,{instanceKey:e})}l.log=c,l.updateState=d}),98);
__d("ZenonMWThriftMessageReliabilityLogger",["ODS","ZenonMWMessageReliabilityLogTypes","ZenonMWThriftMessageMap","ZenonMWThriftMessageQPLLogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s=new Map,u=new Map,c=new Map;function d(e){c.set(e,!0)}function m(e,t,n){var r=u.get(e);r&&k(r,t,n)}function p(e){v(e)?k(e,o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.RECEIVED_RESPONSE):k(e,o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.RECEIVED_REQUEST)}function _(e){v(e)?k(e,o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSING_RESPONSE):k(e,o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSING_REQUEST)}function f(e){v(e)||k(e,o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.REQUEST_AFTER_NULL_CHECK)}function g(e){v(e)||k(e,o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.REQUEST_AFTER_TRANSLATION)}function h(e){v(e)?k(e,o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_RESPONSE):k(e,o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_REQUEST)}function y(e){v(e)?k(e,o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENDING_RESPONSE):k(e,o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENDING_REQUEST)}function C(e){v(e)?k(e,o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_RESPONSE):k(e,o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_REQUEST)}function b(e,t){var n=v(e)?o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SEND_RESPONSE_FAILED:o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SEND_REQUEST_FAILED;k(e,n,{errorMessage:t})}function v(e){var t=e.messageHeader.responseStatusCode;return t!=null}function S(e){var t=isNaN(+e)?0:+e,n=9223372036854776e3;return Math.round(t%n)}function R(t,n){var r=o("ZenonMWThriftMessageMap").messageTypeToString(t.messageHeader.type).toLowerCase(),a=v(t)?"response":"request";switch(n){case o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.RECEIVED_REQUEST:case o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.RECEIVED_RESPONSE:(e||(e=o("ODS"))).bumpEntityKey(4083,"zenon_multiway","receive_"+a+"_"+r),(e||(e=o("ODS"))).flush();return;case o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSING_REQUEST:(e||(e=o("ODS"))).bumpEntityKey(4083,"zenon_multiway","processing_"+a+"_"+r),(e||(e=o("ODS"))).flush();return;case o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_REQUEST:(e||(e=o("ODS"))).bumpEntityKey(4083,"zenon_multiway","processed_"+a+"_"+r),(e||(e=o("ODS"))).flush();return;case o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENDING_RESPONSE:(e||(e=o("ODS"))).bumpEntityKey(4083,"zenon_multiway","sending_"+a+"_"+r),(e||(e=o("ODS"))).flush();return;case o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.REQUEST_AFTER_TRANSLATION:(e||(e=o("ODS"))).bumpEntityKey(4083,"zenon_multiway","after_translation_"+a+"_"+r),(e||(e=o("ODS"))).flush();return;case o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.REQUEST_AFTER_NULL_CHECK:(e||(e=o("ODS"))).bumpEntityKey(4083,"zenon_multiway","after_null_check_"+a+"_"+r),(e||(e=o("ODS"))).flush();return;case o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_RESPONSE:case o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_REQUEST:(e||(e=o("ODS"))).bumpEntityKey(4083,"zenon_multiway","sent_"+a+"_"+r),(e||(e=o("ODS"))).flush();return;default:return}}var L={connectionState:"",peerConnectionState:"",signalingState:""};function E(e){var t=babelHelpers.extends({},L,e);if(L.connectionState!==t.connectionState||L.peerConnectionState!==t.peerConnectionState||L.signalingState!==t.signalingState){L=t;for(var n of s.keys())o("ZenonMWThriftMessageQPLLogger").updateState(n,e)}}function k(e,t,n){var r,a=e.messageHeader,i=(r=s.get(a.transactionId))!=null?r:new Set;s.set(a.transactionId,i),!(t!==o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_SM_EVENT&&t!==o("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_SM_EVENT&&i.has(t))&&(i.add(t),u.set(a.transactionId,e),R(e,t),o("ZenonMWThriftMessageQPLLogger").log(e,t,babelHelpers.extends({},n,L)))}l.setE2eeIsMandatedForCall=d,l.logEventForTxid=m,l.logReceivedMessage=p,l.logProcessingMessage=_,l.logMessageAfterNullCheck=f,l.logMessageAfterTranslation=g,l.logProcessedMessage=h,l.logSendingMessage=y,l.logSentMessage=C,l.logSendMessageFailed=b,l.updateState=E}),98);
__d("ZenonMWThriftMessageSerializer",["CompactSerializer","MqttThriftHeaderSerializers","MultiwayCommonSerializers","TCompactProtocol","TReadBuffer"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){t===void 0&&(t=!1);var n=o("CompactSerializer").serialize(e.messageHeader,o("MultiwayCommonSerializers").serializeRtcMessageHeader),r=o("CompactSerializer").serialize(e.messageBody,o("MultiwayCommonSerializers").serializeRtcMessageBody);if(t){var a=new Uint8Array(n.length+r.length);return a.set(n),a.set(r,n.length),a}var i={},l=o("CompactSerializer").serialize(i,o("MqttThriftHeaderSerializers").serializeMqttThriftHeader),s=new Uint8Array(l.length+n.length+r.length);return s.set(l),s.set(n,l.length),s.set(r,l.length+n.length),s}function s(e,t){t===void 0&&(t=!1);var n=new(r("TReadBuffer"))(e),a=new(r("TCompactProtocol"))(n);t||o("MqttThriftHeaderSerializers").deserializeMqttThriftHeader(a);var i=o("MultiwayCommonSerializers").deserializeRtcMessageHeader(a),l=o("MultiwayCommonSerializers").deserializeRtcMessageBody(a);return{messageBody:l,messageHeader:i}}l.serializeMWThriftMessage=e,l.deserializeMWThriftMessage=s}),98);
__d("SharedWorkerDGWSignalingListener",["FBLogger","ZenonDGWLogger","ZenonDGWStreamController","ZenonMWThriftMessageDebugLogger","ZenonMWThriftMessageReliabilityLogger","ZenonMWThriftMessageSerializer","getErrorSafe","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(){this.$1=r("ZenonDGWStreamController").getControllerInstance(),r("promiseDone")(this.$1.establishAndGetStream())}var t=e.prototype;return t.setLoggingEventHandler=function(t){this.$2=t},t.subscribe=function(t,n){var e=this;this.$1.setOnDataReceivedCallback(function(a){try{var i=o("ZenonMWThriftMessageSerializer").deserializeMWThriftMessage(a,!0);r("ZenonMWThriftMessageDebugLogger").logMWThriftMessage("RECEIVED","DGW Thrift",i),o("ZenonMWThriftMessageReliabilityLogger").logReceivedMessage(i),e.$2&&e.$2({mwThriftMessage:i,name:"mwThriftMessageRecv"}),n&&e.$3(i,n),t(i),o("ZenonMWThriftMessageReliabilityLogger").logProcessingMessage(i)}catch(e){o("ZenonDGWLogger").logDGWCheckpoint("RECV_ERROR_LISTENER: "+String(e)),r("FBLogger")("rpweb").catching(r("getErrorSafe")(e)).warn("Error receiving DGW message in Shared Worker")}})},t.unsubscribe=function(){this.$1.closeStream()},t.$3=function(t,n){try{n(t)}catch(e){o("ZenonDGWLogger").logDGWCheckpoint("RAW_MSG_ERROR_LISTENER: "+String(e)),r("FBLogger")("rtweb").catching(r("getErrorSafe")(e)).mustfix("Signaling messages should be json parsable")}},e})();l.default=e}),98);
__d("ZenonDGWTransportChannelStatus",["EventEmitter","ZenonDGWStreamController"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){var t;return t=e.call(this)||this,t.$ZenonDGWTransportChannelStatus$p_1=r("ZenonDGWStreamController").getControllerInstance(),t.$ZenonDGWTransportChannelStatus$p_1.addListener("connectionStateEvent",function(e){t.emit("connectionStateEvent",e)}),t}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getConnectionState=function(){return this.$ZenonDGWTransportChannelStatus$p_1.getConnectionState()},n.getTransportName=function(){return"dgw"},t})(r("EventEmitter"));l.default=e}),98);
__d("ZenonLoggingEventTypes",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["Send","Receive"]),l=n("$InternalEnum")({Primary:"primary",Secondary:"secondary"}),s="rtc_www";i.ZenonUpdateIceInfoDirection=e,i.ZenonJoinMode=l,i.tslogSource=s}),66);
__d("ZenonMqttChannel",["CurrentUser","FBLogger","MqttChannel","MqttEnv","MqttEnvInitializer","MqttWebConfig","getErrorSafe","gkx"],(function(t,n,r,o,a,i,l){"use strict";function e(){var e=-1;try{if(r("MqttEnvInitializer").initialize(),o("MqttEnv").setIsUserLoggedInNow(r("CurrentUser").isLoggedIn),r("gkx")("11152")&&r("CurrentUser").getAppID()===String(0x4d31ba8e7e89d))e=949958857019662;else{var t;e=Number((t=r("CurrentUser").getAppID())!=null?t:r("MqttWebConfig").appID)}return new(r("MqttChannel"))({appId:e,capabilities:r("MqttWebConfig").capabilities,chatVisibility:!1,clientCapabilities:r("MqttWebConfig").clientCapabilities,endpoint:r("MqttWebConfig").endpoint,initialSubscribedTopics:r("MqttWebConfig").subscribedTopics,phpOverride:r("MqttWebConfig").hostNameOverride,pollingEndpoint:r("MqttWebConfig").pollingEndpoint,userFbid:r("MqttWebConfig").fbid})}catch(t){var n=r("getErrorSafe")(t);throw r("FBLogger")("rtc_www").catching(n).warn("[ZenonMqttChannel][%d] failed to create MqttChannel",e),n}}var s=e(),u=s;l.default=u}),98);
__d("getZenonMqttChannel",["CurrentUser","FBMqttChannel","HorizonWebMqttChannel","IGDOverLSMqttChannel","LiveChatWidgetMqttChannel","MDCMqttChannel","OculusMqttChannel","RpWebMqttEnabledAppIds.experimental","ZenonAppProvider","ZenonMqttChannel"],(function(t,n,r,o,a,i,l){"use strict";var e=new Set(r("RpWebMqttEnabledAppIds.experimental").APP_IDS);function s(){return o("ZenonAppProvider").isInstagramApp()?o("IGDOverLSMqttChannel").getInstance():o("ZenonAppProvider").isOculusCastingSite()?o("OculusMqttChannel").getOculusMqttChannelInstance():o("ZenonAppProvider").isHorizonApp()?o("HorizonWebMqttChannel").getHorizonWebMqttChannelInstance():o("ZenonAppProvider").isMDCApp()?o("MDCMqttChannel").getMDCMqttChannelInstance():o("ZenonAppProvider").isWidgetLiveChatApp()?o("LiveChatWidgetMqttChannel").getLiveChatWidgetMqttChannelInstance():e.has(Number(r("CurrentUser").getAppID()))?r("ZenonMqttChannel"):r("FBMqttChannel")}l.default=s}),98);
__d("ZenonMQTTTransportChannelStatus",["EventEmitter","getZenonMqttChannel"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){var t;t=e.call(this)||this,t.$ZenonMQTTTransportChannelStatus$p_1=r("getZenonMqttChannel")();var n={onMQTTStateChanged:function(n){t.emit("connectionStateEvent",n)}};return t.$ZenonMQTTTransportChannelStatus$p_1.subscribeChannelEvents(n),t}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getConnectionState=function(){return this.$ZenonMQTTTransportChannelStatus$p_1.getConnectionState()},n.getTransportName=function(){return"mqtt"},t})(r("EventEmitter"));l.default=e}),98);
__d("ZenonMWThriftMessageLogger",["MultiwayCommonTypes","ZenonLoggingEventTypes"],(function(t,n,r,o,a,i,l){"use strict";var e=new Set,s=new Set;function u(t,n){var r=t.messageHeader,a=t.messageBody;if(!(e.has(r.transactionId)||r.type==null)){switch(r.type){case o("MultiwayCommonTypes").MessageType.JOIN:a.joinRequest&&d(a.joinRequest,n);break;case o("MultiwayCommonTypes").MessageType.ICE_CANDIDATE:a.iceCandidateRequest&&p(a.iceCandidateRequest,n,o("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send);break;case o("MultiwayCommonTypes").MessageType.CLIENT_MEDIA_UPDATE:a.clientMediaUpdateRequest&&_(a.clientMediaUpdateRequest,n);break;case o("MultiwayCommonTypes").MessageType.SERVER_MEDIA_UPDATE:a.serverMediaUpdateResponse&&h(a.serverMediaUpdateResponse,n);break;default:break}e.add(r.transactionId)}}function c(e,t){var n=e.messageHeader,r=e.messageBody;if(!(s.has(n.transactionId)||n.type==null)){switch(n.type){case o("MultiwayCommonTypes").MessageType.JOIN:r.joinResponse&&m(r.joinResponse,t);break;case o("MultiwayCommonTypes").MessageType.ICE_CANDIDATE:r.iceCandidateRequest&&p(r.iceCandidateRequest,t,o("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive);break;case o("MultiwayCommonTypes").MessageType.CLIENT_MEDIA_UPDATE:r.clientMediaUpdateResponse&&f(r.clientMediaUpdateResponse,t);break;case o("MultiwayCommonTypes").MessageType.SERVER_MEDIA_UPDATE:r.serverMediaUpdateRequest&&g(r.serverMediaUpdateRequest,t);break;default:break}s.add(n.transactionId)}}function d(e,t){var n=e.answer,r=e.offer;t({name:"inviteSent"}),y(r,t,o("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send),n&&y(n,t,o("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send)}function m(e,t){var n=e.answer;n&&y(n,t,o("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive)}function p(e,t,n){var r=e.iceCandidateSdps;r.forEach(function(e){e.candidateSdpString!=null&&t({direction:n,name:"updateIceInfo",sdpString:e.candidateSdpString})})}function _(e,t){var n=e.offer;n&&y(n,t,o("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send)}function f(e,t){var n=e.answer;n&&y(n,t,o("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive)}function g(e,t){var n=e.answer,r=e.offer;r&&y(r,t,o("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive),n&&y(n,t,o("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive)}function h(e,t){var n=e.answer;n&&y(n,t,o("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send)}function y(e,t,n){e.sdpString!=null&&t({direction:n,name:"updateIceInfo",sdpString:e.sdpString})}l.logSentMessage=u,l.logReceivedMessage=c}),98);
__d("ZenonSharedWorkerConstants",["MultiwayCommonTypes"],(function(t,n,r,o,a,i,l){"use strict";var e,s="CALL_HANDLED_IN_OTHER_TAB",u="connection-ack",c="LOGGING_EVENT",d="RAW_MW_THRIFT_MESSAGE",m="SIGNALING_MESSAGE",p="SIGNALING_MESSAGE_SENT",_="INIT_DGW_CONFIG",f="register",g="SEND_SIGNALING_MESSAGE",h=(e={},e[o("MultiwayCommonTypes").MessageType.DISMISS]="DISMISS",e[o("MultiwayCommonTypes").MessageType.HANGUP]="HANGUP",e[o("MultiwayCommonTypes").MessageType.JOIN]="JOIN",e);function y(e){var t;return(t=h[e])!=null?t:"UNKNOWN"}l.CALL_HANDLED_IN_OTHER_TAB=s,l.CONNECTION_ACK=u,l.LOGGING_EVENT=c,l.RAW_MW_THRIFT_MESSAGE=d,l.SIGNALING_MESSAGE=m,l.SIGNALING_MESSAGE_SENT=p,l.INIT_DGW_CONFIG=_,l.REGISTER=f,l.SEND_SIGNALING_MESSAGE=g,l.MESSAGE_TYPE_TO_STRING=h,l.messageTypeToString=y}),98);
__d("ZenonValidateMWThriftMessage",["FBLogger","MultiwayCommonTypes","ZenonInfraActionsLogger","ZenonMWThriftMessageMap"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.messageHeader.type,n=o("ZenonMWThriftMessageMap").messageTypeToString(t);return e.messageHeader.serverInfoData==null&&t!=null&&t!==o("MultiwayCommonTypes").MessageType.JOIN?(r("ZenonInfraActionsLogger").logCheckpoint({checkpoint:"[ZP][DROP] No remoteSignalingID in message: "+n}),r("FBLogger")("rtc_www").warn("[ZP][DROP] No remoteSignalingID in message: "+n),!1):!0}l.default=e}),98);
__d("ZenonSharedWorkerMWThriftMessageSender",["ZenonDGWLogger","ZenonDGWStreamController","ZenonMWThriftMessageDebugLogger","ZenonMWThriftMessageLogger","ZenonMWThriftMessageMap","ZenonMWThriftMessageReliabilityLogger","ZenonMWThriftMessageSerializer","ZenonValidateMWThriftMessage","err"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(){this.$3=r("ZenonDGWStreamController").getControllerInstance()}var t=e.prototype;return t.$4=async function(t){try{await this.$3.establishAndGetStream()}catch(n){var e=o("ZenonMWThriftMessageMap").messageTypeToString(t.messageHeader.type);o("ZenonDGWLogger").logDGWCheckpoint("SEND_STREAM_ERROR: type="+e+" err="+String(n)),this.$5(t,"Failed to establish stream")}o("ZenonMWThriftMessageReliabilityLogger").logSendingMessage(t),r("ZenonMWThriftMessageDebugLogger").logMWThriftMessage("SENDING","DGW Thrift",t),this.$2&&o("ZenonMWThriftMessageLogger").logSentMessage(t,this.$2);var n=o("ZenonMWThriftMessageSerializer").serializeMWThriftMessage(t,!0),a=await this.$3.send(t.messageHeader.transactionId,n);if(a&&this.$2)this.$2({mwThriftMessage:t,name:"mwThriftMessageSent"});else if(!a){var i=o("ZenonMWThriftMessageMap").messageTypeToString(t.messageHeader.type);o("ZenonDGWLogger").logDGWCheckpoint("SEND_FAIL: type="+i),this.$5(t,"Failed to send data")}},t.$5=function(t,n){var e=n!=null?n:"DGW Thrift Message Send Error";o("ZenonMWThriftMessageReliabilityLogger").logSendMessageFailed(t,"[DGW Thrift] "+e),r("ZenonMWThriftMessageDebugLogger").logSendMultiwayThriftMessageFailure(e,o("ZenonMWThriftMessageMap").messageTypeToString(t.messageHeader.type))},t.sendMessage=function(t){return!t||!r("ZenonValidateMWThriftMessage")(t)?(o("ZenonDGWLogger").logDGWCheckpoint("SEND_INVALID_MSG"),Promise.reject(r("err")("Invalid MW Thrift message"))):this.$4(t)},t.setMessageReceiver=function(t){this.$1=t},t.setLoggingEventHandler=function(t){this.$2=t},e})();l.default=e}),98);
__d("ZenonSignalingSharedWorker",["CurrentWorkerMessagePort","FBLogger","MultiwayCommonTypes","SharedWorkerDGWSignalingListener","ZenonDGWLogger","ZenonDGWStreamController","ZenonMWThriftMessageMap","ZenonSharedWorkerConstants","ZenonSharedWorkerMWThriftMessageSender","getErrorSafe","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e=new Map,s=0,u=null,c=!1,d=!1,m=null,p=null;function _(){var e=o("CurrentWorkerMessagePort").getMessagePort();p=e,o("ZenonDGWLogger").setSharedWorkerContext(function(e){v({event:{checkpoint:e,name:"sharedWorkerCheckpoint"},type:o("ZenonSharedWorkerConstants").LOGGING_EVENT})}),e.addEventListener("message",function(t){C(t.data,e)})}function f(e){if(!c)try{e!=null&&(u=new(r("SharedWorkerDGWSignalingListener")));var t=u;t!=null&&(t.subscribe(function(e){return y(e)},function(e){return h(e)}),t.setLoggingEventHandler(function(e){g(e)}),c=!0,g({name:"dgwConnectionState",pending:!1}))}catch(e){o("ZenonDGWLogger").logDGWCheckpoint("SUBSCRIBE_ERROR: Failed to initialize signaling subscription from Shared Worker"+String(e)),r("FBLogger")("rpweb").catching(r("getErrorSafe")(e)).warn("Failed to initialize signaling subscription from Shared Worker")}}function g(e){v({event:e,type:o("ZenonSharedWorkerConstants").LOGGING_EVENT})}function h(e){v({rawMessage:e,type:o("ZenonSharedWorkerConstants").RAW_MW_THRIFT_MESSAGE})}function y(t){var n=e.size;if(n===0){var r=o("ZenonMWThriftMessageMap").messageTypeToString(t.messageHeader.type);o("ZenonDGWLogger").logDGWCheckpoint("MESSAGE_DROPPED: 0_connections type="+r)}v({message:t,type:o("ZenonSharedWorkerConstants").SIGNALING_MESSAGE})}function C(e,t){if(!(typeof e!="object"||e==null||!("type"in e)||typeof e.type!="string")){if(e.type===o("ZenonSharedWorkerConstants").INIT_DGW_CONFIG&&"config"in e){var n=e.config;if(!d){var a;try{a=r("ZenonDGWStreamController").getControllerInstance()}catch(e){o("ZenonDGWLogger").logDGWCheckpoint("INIT_ERROR_STREAM_CONTROLLER: "+String(e)),r("FBLogger")("rpweb").catching(r("getErrorSafe")(e)).mustfix("Failed to initialize ZenonDGWStreamController from Shared Worker");return}a.setWindowContext("SHARED_WORKER"),a.setStreamOptions({deviceId:n.deviceId,loggingId:r("uuidv4")(),serviceId:"rpsignaling"}),a.setDGWConfig(n),d=!0}f(n);return}else if(e.type===o("ZenonSharedWorkerConstants").REGISTER&&"windowType"in e&&(e.windowType==="CHILD"||e.windowType==="PARENT")){b(e.windowType,t);return}else if(e.type===o("ZenonSharedWorkerConstants").SEND_SIGNALING_MESSAGE&&"message"in e){S(e.message,t);return}}}function b(t,n){var r=s++;e.set(r,{connectionId:r,port:n,windowType:t}),n.postMessage({response:{from:"zenon_signaling_shared_worker",workerID:"zenon_signaling_worker_1"},type:o("ZenonSharedWorkerConstants").CONNECTION_ACK})}function v(t){if(p==null){o("ZenonDGWLogger").logDGWCheckpoint("BROADCAST_FAIL: broadcastPort not initialized, connections="+String(e.size));return}try{p.postMessage(t)}catch(e){o("ZenonDGWLogger").logDGWCheckpoint("BROADCAST_FAIL: Error="+String(e)),r("FBLogger")("rpweb").catching(r("getErrorSafe")(e)).warn("Failed to broadcast message from Shared Worker to windows")}}function S(e,t){try{var n,a,i;m==null&&(m=new(r("ZenonSharedWorkerMWThriftMessageSender")),m.setLoggingEventHandler(function(e){g(e)}));var l=e,s=l==null||(n=l.messageHeader)==null?void 0:n.type,u=l==null||(a=l.messageHeader)==null?void 0:a.serverInfoData,c=l==null||(i=l.messageHeader)==null?void 0:i.clientSessionId;c!=null&&u!=null&&(s===o("MultiwayCommonTypes").MessageType.JOIN||s===o("MultiwayCommonTypes").MessageType.DISMISS||s===o("MultiwayCommonTypes").MessageType.HANGUP)&&v({clientSessionId:c,messageType:o("ZenonSharedWorkerConstants").messageTypeToString(s),serverInfoData:u,type:o("ZenonSharedWorkerConstants").CALL_HANDLED_IN_OTHER_TAB}),m!=null&&m.sendMessage(e).then(function(){t.postMessage({type:o("ZenonSharedWorkerConstants").SIGNALING_MESSAGE_SENT})}).catch(function(e){o("ZenonDGWLogger").logDGWCheckpoint("SEND_ERROR: "+String(e)),r("FBLogger")("rpweb").catching(r("getErrorSafe")(e)).mustfix("Failed to send outgoing message to DGW from Shared Worker")})}catch(e){o("ZenonDGWLogger").logDGWCheckpoint("OUTGOING_SENDER_ERROR: "+String(e)),r("FBLogger")("rpweb").catching(r("getErrorSafe")(e)).mustfix("Error processing outgoing message from Shared Worker")}}l.default=_}),98);
__d("ZenonSignalingSharedWorkerV2",["ZenonSignalingSharedWorker"],(function(t,n,r,o,a,i,l){"use strict";l.default=r("ZenonSignalingSharedWorker")}),98);/*FB_PKG_DELIM*/
__d("EBAddDeviceGraphQLEBFetchVirtualDeviceInfoQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="25483983211276282"}),null);
__d("EBAddDeviceGraphQLEBFetchVirtualDeviceInfoQuery.graphql",["EBAddDeviceGraphQLEBFetchVirtualDeviceInfoQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={defaultValue:null,kind:"LocalArgument",name:"request_uuid"},t={defaultValue:null,kind:"LocalArgument",name:"virtual_device_id"},r={alias:null,args:null,kind:"ScalarField",name:"epoch_id",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"epoch_anon_id",storageKey:null},a={alias:null,args:null,concreteType:"FetchVirtualDeviceInfoMinosEpochSerializablePayload",kind:"LinkedField",name:"minos_epoch",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"epoch_head",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"self_epoch_signature",storageKey:null}],storageKey:null},i=[{alias:null,args:[{fields:[{kind:"Variable",name:"request_uuid",variableName:"request_uuid"},{kind:"Variable",name:"virtual_device_id",variableName:"virtual_device_id"}],kind:"ObjectValue",name:"request"}],concreteType:"FetchVirtualDeviceInfoResponseWrapper",kind:"LinkedField",name:"fetch_virtual_device_info_for_device_addition_v2",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,concreteType:"FetchVirtualDeviceInfoError",kind:"LinkedField",name:"error",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"code",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"FetchVirtualDeviceInfoResponse",kind:"LinkedField",name:"data",plural:!1,selections:[{alias:null,args:null,concreteType:"FetchVirtualDeviceInfoEncryptedSecretValues",kind:"LinkedField",name:"encrypted_secret_values",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"encrypted_epoch_anon_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"encrypted_epoch_root_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"encrypted_epoch_storage_private_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"encrypted_mailbox_root_key_blob",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"encrypted_oblivious_validation_token_blob",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"encrypted_ocmf_client_state",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"encrypted_orf_client_state_v2",storageKey:null}],storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"epoch_storage_public_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"last_epoch_id",storageKey:null},{alias:null,args:null,concreteType:"FetchVirtualDeviceInfoSyncEpochsPayload",kind:"LinkedField",name:"sync_epochs",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"encrypted_epoch_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"backup_id",storageKey:null},o,{alias:null,args:null,kind:"ScalarField",name:"epoch_auth_public_key",storageKey:null},{alias:null,args:null,concreteType:"FetchVirtualDeviceInfoEpochDataSerializablePayload",kind:"LinkedField",name:"epoch_data_v2",plural:!1,selections:[o,{alias:null,args:null,kind:"ScalarField",name:"epoch_root_key",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_active_epoch",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"next_epoch_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"prev_epoch_id",storageKey:null},a],storageKey:null},a],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,t],kind:"Fragment",metadata:null,name:"EBAddDeviceGraphQLEBFetchVirtualDeviceInfoQuery",selections:i,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,e],kind:"Operation",name:"EBAddDeviceGraphQLEBFetchVirtualDeviceInfoQuery",selections:i},params:{id:n("EBAddDeviceGraphQLEBFetchVirtualDeviceInfoQuery_facebookRelayOperation"),metadata:{},name:"EBAddDeviceGraphQLEBFetchVirtualDeviceInfoQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("EBGetLSVirtualDevices",["ReQL"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return o("ReQL").toArrayAsync(o("ReQL").fromTableAscending(e.tables.encrypted_backups_virtual_devices))}l.getLSVirtualDevices=e}),98);
__d("LSCreateAuthKeyPair.nop",["CryptoLogger","Promise","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("requireDeferred")("X25519").__setRef("LSCreateAuthKeyPair.nop"),u=function(r,a){return s.load().then(function(t){var r=t.generateKeys(t.KeyPurpose.Encryption),o=r.pk,a=r.sk;return(e||(e=n("Promise"))).resolve([a.buffer,o.buffer])}).catch(function(e){throw o("CryptoLogger").captureError(o("CryptoLogger").CryptoLogger("create_auth_key_pair"),e).mustfix("failed to generate an auth key pair"),e})};u.__nop_name__="LSCreateAuthKeyPair",l.default=u}),98);
__d("LSHandleWrongRecoveryCode",["LSAppendDataTraceAddon","LSIsMobileClient","LSLogMebClientEvent.nop","LSQplAnnotateString.nop","LSQplMarkPoint.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsHandleWrongRecoveryCodeStoredProcedure] Beginning execution."),e[0]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[0],"dasm_handle_wrong_recovery_code_sproc_start"):t.resolve()},function(r){return e[0]!==void 0&&e[1]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,1021646192]),e[0],"dasm_handle_wrong_recovery_code_error_message",e[1]):t.resolve()},function(o){return t.sequence([function(r){return e[0]!==void 0?t.storedProcedure(n("LSAppendDataTraceAddon"),e[0],t.i64.cast([0,1415]),t.i64.cast([0,2]),e[1],void 0):t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,r[7]=t[0],t})},function(e){return r[7]?r[8]=!0:r[8]=!1,r[8]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),r[10]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",r[10]].join("")),r[9]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",r[10],r[9],t.i64.cast([0,3]))):t.resolve()}])},function(e){return t.db.table(178).put({pk:t.i64.cast([0,1]),recoveryCodeStatus:t.i64.cast([0,3])})},function(o){return e[2]?t.resolve(0):e[1]!==void 0?((function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsHandleWrongRecoveryCodeStoredProcedure] ","",e[1]].join("")),r[7]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsHandleWrongRecoveryCodeStoredProcedure",e[1],r[7],t.i64.cast([0,3]))):t.resolve()},function(r){return e[0]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[0],"dasm_handle_wrong_recovery_code_sproc_end"):t.resolve()},function(e){return r[1]=t.i64.of_float(Date.now()),r[2]=t.i64.random(),r[4]="Finishing execution. Execution time: ",r[5]=t.i64.to_string(t.i64.sub(r[1],r[0])),r[6]=" ms",r[3]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][LSEncryptedBackupsHandleWrongRecoveryCodeStoredProcedure] ",r[3],r[4],r[3],r[5],r[3],r[6]].join("")),t.i64.eq(t.i64.mod_(r[2],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[7]=",",r[8]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsHandleWrongRecoveryCodeStoredProcedure",[r[4],r[7],r[5],r[7],r[6]].join(""),r[8],t.i64.cast([0,4]))):t.resolve()}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsHandleWrongRecoveryCodeStoredProcedure",e.__tables__=["secure_encrypted_backups_recovery_code_status"],a.exports=e}),null);
__d("LSIsValidEpochAnonIdFlow",[],(function(t,n,r,o,a,i){"use strict";var e=11;function l(t){if(t.byteLength>e)return!1;for(var n=new Int8Array(t),r=0,o=0;o<n.length;o++)r|=+(n[o]<48),r|=+(n[o]>57);return r===0}i.call=l}),66);
__d("LSIsValidEpochAnonId.nop",["LSIsValidEpochAnonIdFlow","LSResult","Promise"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(a,i,l){return(e||(e=n("Promise"))).resolve(r("LSResult")(o("LSIsValidEpochAnonIdFlow").call(l)))};s.__nop_name__="LSIsValidEpochAnonId",l.default=s}),98);
__d("LSAddDeviceWithVirtualDeviceAndDecryptionKey",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSBase64Decode.nop","LSBase64Encode.nop","LSCreateAuthKeyPair.nop","LSCreateDebugToken.nop","LSCreateDerivedKeys.nop","LSCreateEncryptionKeyPair.nop","LSCreateSignatureKeyPair.nop","LSCreateSignatureWithArmadilloKey.nop","LSCreateSignature_v2.nop","LSDeleteBackupOnClient","LSGetArmadilloPublicKey.nop","LSGetBlobFromString.nop","LSHandleWrongRecoveryCode","LSHmac_v2.nop","LSIsEncryptionVersionSecure","LSIsMobileClient","LSIsValidEpochAnonId.nop","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop","LSOcmfClientEvolve_v2.nop","LSPublicEncryptionCreateDecryptedData.nop","LSQplAnnotateInt.nop","LSQplAnnotateString.nop","LSQplMarkPoint.nop","LSSymmetricEncryptionCreateDecryptedString.nop","justknobx"],(function(t,n,r,o,a,i,l){function e(){var e=arguments,t=e[e.length-1],o=[],a=[];return t.sequence([function(a){return t.sequence([function(r){return o[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] Beginning execution."),e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_sproc_start"):t.resolve()},function(a){return t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))}).next().then(function(a,i){var l=a.done,s=a.value;return l?t.sequence([function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_delete_client_state_start"):t.resolve()},function(e){return t.db.table(168).fetch().next().then(function(e,r){var o=e.done,a=e.value;return o?0:(r=a.item,t.storedProcedure(n("LSDeleteBackupOnClient"),r.backupId,void 0,!1,void 0,"null",!0))})},function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_delete_client_state_end"):t.resolve()},function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_decrypt_virtual_device_secrets_start"):t.resolve()},function(r){return o[8]=e[3].get("encrypted_ocmf_client_state"),t.nativeOperation(n("LSSymmetricEncryptionCreateDecryptedString.nop"),e[9],t.blob("dmlydHVhbF9kZXZpY2U6b2NtZl9jbGllbnRfc3RhdGU="),o[8]).then(function(e){var t;return t=e,o[9]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Decode.nop"),o[9]).then(function(e){var t;return t=e,o[10]=t[0],t})},function(r){return t.blobs.neq(o[10],void 0)?t.resolve(o[11]=o[10]):t.sequence([function(r){return t.nativeOperation(n("LSSymmetricEncryptionCreateDecryptedString.nop"),e[9],t.blob("c2VjcmV0X3ZhbHVlc19tZXRhZGF0YQ=="),o[8]).then(function(e){var t;return t=e,o[40]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Decode.nop"),o[40]).then(function(e){var t;return t=e,o[41]=t[0],t})},function(e){return o[11]=o[41]}])},function(r){return o[12]=e[3].get("encrypted_oblivious_validation_token_blob"),t.nativeOperation(n("LSSymmetricEncryptionCreateDecryptedString.nop"),e[9],t.blob("dmlydHVhbF9kZXZpY2U6b2JsaXZpb3VzX3ZhbGlkYXRpb25fdG9rZW4="),o[12]).then(function(e){var t;return t=e,o[13]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Decode.nop"),o[13]).then(function(e){var t;return t=e,o[14]=t[0],t})},function(r){return t.blobs.neq(o[14],void 0)?t.resolve(o[15]=o[14]):t.sequence([function(r){return t.nativeOperation(n("LSSymmetricEncryptionCreateDecryptedString.nop"),e[9],t.blob("c2VjcmV0X3ZhbHVlc19tZXRhZGF0YQ=="),o[12]).then(function(e){var t;return t=e,o[40]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Decode.nop"),o[40]).then(function(e){var t;return t=e,o[41]=t[0],t})},function(e){return o[15]=o[41]}])},function(r){return o[16]=e[3].get("encrypted_epoch_anon_id"),t.nativeOperation(n("LSSymmetricEncryptionCreateDecryptedString.nop"),e[9],t.blob("dmlydHVhbF9kZXZpY2U6ZXBvY2hfYW5vbl9pZA=="),o[16]).then(function(e){var t;return t=e,o[17]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Decode.nop"),o[17]).then(function(e){var t;return t=e,o[18]=t[0],t})},function(r){return t.blobs.neq(o[18],void 0)?t.resolve(o[19]=o[18]):t.sequence([function(r){return t.nativeOperation(n("LSSymmetricEncryptionCreateDecryptedString.nop"),e[9],t.blob("c2VjcmV0X3ZhbHVlc19tZXRhZGF0YQ=="),o[16]).then(function(e){var t;return t=e,o[40]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Decode.nop"),o[40]).then(function(e){var t;return t=e,o[41]=t[0],t})},function(e){return o[19]=o[41]}])},function(e){return t.blobs.neq(o[19],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSIsValidEpochAnonId.nop"),o[19]).then(function(e){var t;return t=e,o[40]=t[0],t})},function(e){return o[20]=o[40]}]):t.resolve(o[20]=!1)},function(r){return o[20]?o[21]=o[19]:o[21]=void 0,o[22]=e[3].get("encrypted_epoch_root_key"),t.nativeOperation(n("LSSymmetricEncryptionCreateDecryptedString.nop"),e[9],t.blob("dmlydHVhbF9kZXZpY2U6ZXBvY2hfcm9vdF9rZXk="),o[22]).then(function(e){var t;return t=e,o[23]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Decode.nop"),o[23]).then(function(e){var t;return t=e,o[24]=t[0],t})},function(r){return t.blobs.neq(o[24],void 0)?t.resolve(o[25]=o[24]):t.sequence([function(r){return t.nativeOperation(n("LSSymmetricEncryptionCreateDecryptedString.nop"),e[9],t.blob("c2VjcmV0X3ZhbHVlc19tZXRhZGF0YQ=="),o[22]).then(function(e){var t;return t=e,o[40]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Decode.nop"),o[40]).then(function(e){var t;return t=e,o[41]=t[0],t})},function(e){return o[25]=o[41]}])},function(r){return o[26]=e[3].get("encrypted_mailbox_root_key_blob"),t.nativeOperation(n("LSSymmetricEncryptionCreateDecryptedString.nop"),e[9],t.blob("dmlydHVhbF9kZXZpY2U6bWFpbGJveF9yb290X2tleQ=="),o[26]).then(function(e){var t;return t=e,o[27]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Decode.nop"),o[27]).then(function(e){var t;return t=e,o[28]=t[0],t})},function(r){return t.blobs.neq(o[28],void 0)?t.resolve(o[29]=o[28]):t.sequence([function(r){return t.nativeOperation(n("LSSymmetricEncryptionCreateDecryptedString.nop"),e[9],t.blob("c2VjcmV0X3ZhbHVlc19tZXRhZGF0YQ=="),o[26]).then(function(e){var t;return t=e,o[40]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Decode.nop"),o[40]).then(function(e){var t;return t=e,o[41]=t[0],t})},function(e){return o[29]=o[41]}])},function(r){return o[30]=e[3].get("encrypted_epoch_storage_private_key"),o[30]!==void 0?t.sequence([function(r){return t.nativeOperation(n("LSSymmetricEncryptionCreateDecryptedString.nop"),e[9],t.blob("dmlydHVhbF9kZXZpY2U6ZXBvY2hfc3RvcmFnZV9wcml2YXRlX2tleQ=="),o[30]).then(function(e){var t;return t=e,o[40]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Decode.nop"),o[40]).then(function(e){var t;return t=e,o[41]=t[0],t})},function(r){return t.blobs.neq(o[41],void 0)?t.resolve(o[42]=o[41]):t.sequence([function(r){return t.nativeOperation(n("LSSymmetricEncryptionCreateDecryptedString.nop"),e[9],t.blob("c2VjcmV0X3ZhbHVlc19tZXRhZGF0YQ=="),o[30]).then(function(e){var t;return t=e,o[43]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Decode.nop"),o[43]).then(function(e){var t;return t=e,o[44]=t[0],t})},function(e){return o[42]=o[44]}])},function(e){return o[31]=o[42]}]):t.resolve(o[31]=void 0)},function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_decrypt_virtual_device_secrets_end"):t.resolve()},function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_generate_keys_start"):t.resolve()},function(e){return t.nativeOperation(n("LSCreateSignatureKeyPair.nop")).then(function(e){var t;return t=e,o[32]=t[0],o[33]=t[1],t})},function(e){return t.nativeOperation(n("LSCreateEncryptionKeyPair.nop")).then(function(e){var t;return t=e,o[34]=t[0],o[35]=t[1],t})},function(e){return t.nativeOperation(n("LSCreateSignature_v2.nop"),o[32],t.blob("MA=="),o[35]).then(function(e){var t;return t=e,o[36]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateAuthKeyPair.nop")).then(function(e){var t;return t=e,o[37]=t[0],o[38]=t[1],t})},function(e){return t.nativeOperation(n("LSCreateSignature_v2.nop"),o[32],t.blob("MQ=="),o[38]).then(function(e){var t;return t=e,o[39]=t[0],t})},function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_generate_keys_end"):t.resolve()},function(a){return t.blobs.neq(o[11],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSOcmfClientEvolve_v2.nop"),o[11]).then(function(e){var t;return t=e,o[40]=t[0],o[41]=t[1],t})},function(e){var r;return t.blobs.neq(void 0,void 0)?t.sequence([function(e){return t.nativeOperation(n("LSOcmfClientEvolve_v2.nop"),void 0).then(function(e){var t;return t=e,o[46]=t[0],o[47]=t[1],t})},function(e){var t;return t=[o[40],o[41],o[46],o[47]],o[42]=t[0],o[43]=t[1],o[44]=t[2],o[45]=t[3],t}]):t.resolve((r=[o[40],o[41],void 0,void 0],o[42]=r[0],o[43]=r[1],o[44]=r[2],o[45]=r[3],r))},function(a){return t.blobs.neq(o[21],void 0)?t.blobs.neq(o[25],void 0)?t.blobs.neq(o[15],void 0)?t.blobs.neq(o[29],void 0)?t.sequence([function(r){return e[12]!==void 0?(o[61]=e[12].get("epoch_head"),o[46]=o[61]):o[46]=void 0,o[47]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,o[48]=t[0],t})},function(e){return o[48]&&(o[61]=(o[47].push(t.i64.cast([0,0])),o[47])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,o[49]=t[0],t})},function(e){return o[49]&&(o[61]=(o[47].push(t.i64.cast([0,2])),o[47])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,o[50]=t[0],t})},function(e){return o[50]&&(o[61]=(o[47].push(t.i64.cast([0,3])),o[47])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,o[51]=t[0],t})},function(e){return o[51]&&(o[61]=(o[47].push(t.i64.cast([0,4])),o[47])),o[52]="",o[53]=t.i64.of_int32(o[47].length),t.i64.gt(o[53],t.i64.cast([0,0]))?t.loopAsync(o[53],function(e){return o[61]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[47],o[61]).then(function(e){var t;return t=e,o[62]=t[0],o[63]=t[1],t})},function(e){return o[52]=[o[52],"_",t.i64.to_string(o[62])].join("")}])}):t.resolve()},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),["supported_versions_",o[52],"revision_version_",t.i64.to_string(t.i64.cast([0,1]))].join("")).then(function(e){var t;return t=e,o[54]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateSignature_v2.nop"),o[32],t.blob("Mg=="),o[54]).then(function(e){var t;return t=e,o[55]=t[0],t})},function(e){return t.blobs.neq(o[55],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[55]).then(function(e){var t;return t=e,o[61]=t[0],t})},function(e){return o[56]=o[61]}]):t.resolve(o[56]=void 0)},function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_cleanup_state_start"):t.resolve()},function(e){return t.forEach(t.db.table(168).fetch(),function(e){return e.delete()})},function(e){return t.forEach(t.db.table(169).fetch(),function(e){return e.delete()})},function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_cleanup_state_end"):t.resolve()},function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_insert_optimisitc_client_state_start"):t.resolve()},function(n){return t.forEach(t.filter(t.db.table(168).fetch([[[e[1]]]]),function(n){return t.i64.eq(n.backupId,e[1])&&t.i64.lt(n.authorityLevel,t.i64.cast([0,20]))}),function(e){return e.delete()})},function(n){return t.db.table(168).add({backupId:e[1],devicePublicKeyBlob:o[33],devicePrivateKeyBlob:o[32],epochStoragePublicKeyBlob:o[35],epochStoragePrivateKeyBlob:o[34],epochAuthPublicKeyBlob:o[38],epochAuthPrivateKeyBlob:o[37],mailboxRootKeyBlob:o[29],ocmfClientStateBlob:o[42],obliviousValidationTokenBlob:o[15],encryptionVersion:t.i64.cast([0,0]),revisionVersion:t.i64.cast([0,1]),authorityLevel:t.i64.cast([0,20]),backupTenancy:e[7]})},function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_insert_optimisitc_client_state_end"):t.resolve()},function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_insert_epoch_data_start"):t.resolve()},function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_populate_epochs_table_start"):t.resolve()},function(n){return t.forEach(t.filter(t.db.table(169).fetch([[[e[2]]]]),function(n){return t.i64.eq(n.epochId,e[2])&&t.i64.lt(n.authorityLevel,t.i64.cast([0,80]))}),function(e){return e.delete()})},function(n){return t.db.table(169).add({epochId:e[2],authorityLevel:t.i64.cast([0,80]),backupId:e[1],epochAnonIdBlob:o[21],epochRootKeyBlob:o[25],epochStatus:t.i64.cast([0,1]),epochHead:o[46]})},function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_populate_epochs_table_end"):t.resolve()},function(r){return o[57]=e[5].keys(),o[58]=t.i64.of_int32(o[57].length),e[8]!==void 0?t.nativeOperation(n("LSQplAnnotateInt.nop"),t.i64.cast([0,1021646192]),e[8],"num_epochs",o[58]):t.resolve()},function(a){return t.i64.eq(o[58],t.i64.cast([0,1]))?t.sequence([function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_epoch_derivation_skipped"):t.resolve()},function(r){return o[61]=e[5].has(t.i64.to_string(e[2])),o[61]?t.resolve(0):((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] sync_epochs does not contain base epoch"),o[63]="sync_epochs does not contain base epoch",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] ","",o[63]].join("")),o[62]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure",o[63],o[62],t.i64.cast([0,3])))}]):t.sequence([function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_epoch_derivation_start"):t.resolve()},function(e){return(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] Triggering epoch derivation."),o[61]=r("justknobx")._("1310"),t.resolve()},function(r){return o[61]===!1&&(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] Epoch rotation is disabled for the user but received more than one epoch."),t.blobs.neq(o[31],void 0)?t.sequence([function(e){return o[65]="Starting epoch derivation at base epoch of anon id (base64) = ",t.nativeOperation(n("LSBase64Encode.nop"),o[21]).then(function(e){var t;return t=e,o[62]=t[0],t})},function(e){return o[66]=o[62]==null?"":o[62],o[63]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][MEBEpochDerivationUtils] ",o[63],o[65],o[63],o[66]].join("")),t.resolve()},function(r){return o[64]=e[5].get(t.i64.to_string(e[2])),o[64]!==void 0?t.sequence([function(n){return o[67]=o[64].get("minos_epoch"),o[67]!==void 0?(o[79]=o[67].get("epoch_head"),o[68]=o[79]):o[68]=void 0,o[69]=o[64].get("is_active_epoch"),o[69]?o[70]=t.i64.cast([0,1]):o[70]=t.i64.cast([0,2]),t.forEach(t.db.table(169).fetch([[[e[2]]]]),function(e){var n=e.update,r=e.item;return n({authorityLevel:t.i64.cast([0,80]),epochStatus:o[70],epochHead:o[68]})})},function(r){return o[71]=new t.Map,o[71].set("epoch_id",e[2]),o[71].set("authority_level",t.i64.cast([0,80])),o[71].set("backup_id",e[1]),o[71].set("epoch_anon_id_blob",o[21]),o[71].set("epoch_root_key_blob",o[25]),o[71].set("epoch_status",t.i64.cast([0,1])),o[71].set("epoch_head",o[46]),o[72]=o[71],o[73]=e[5].keys(),o[74]=t.i64.of_int32(o[73].length),t.i64.gt(o[74],t.i64.cast([0,0]))?t.loopAsync(o[74],function(r){return o[79]=r,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[73],o[79]).then(function(e){var t;return t=e,o[80]=t[0],o[81]=t[1],t})},function(r){return o[82]=o[72].get("epoch_id"),o[83]=o[72].get("backup_id"),o[84]=o[72].get("epoch_anon_id_blob"),o[85]=o[72].get("epoch_root_key_blob"),o[86]=o[72].get("epoch_status"),o[87]=o[72].get("authority_level"),o[88]=o[72].get("epoch_head"),o[89]=e[5].get(t.i64.to_string(o[82])),o[89]!==void 0?t.sequence([function(r){return o[98]=o[89].get("next_epoch_id"),t.i64.neq(o[98],void 0)?t.sequence([function(r){return o[106]=e[5].get(t.i64.to_string(o[98])),o[106]!==void 0?t.sequence([function(e){return o[114]=o[106].get("backup_id"),o[115]=o[106].get("is_active_epoch"),o[115]?o[116]=t.i64.cast([0,1]):o[116]=t.i64.cast([0,2]),o[117]=o[106].get("epoch_anon_id"),o[118]=o[106].get("minos_epoch"),o[118]!==void 0?(o[137]=o[118].get("epoch_head"),o[119]=o[137]):o[119]=void 0,o[120]=t.createArray(),o[137]=(o[120].push(t.i64.cast([0,32])),o[120]),o[137]=(o[120].push(t.i64.cast([0,32])),o[120]),o[121]="_",t.nativeOperation(n("LSGetBlobFromString.nop"),["epoch_chaining",o[121],t.blobs.to_string(o[84]),o[121],t.i64.to_string(o[82])].join("")).then(function(e){var t;return t=e,o[122]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),o[122],void 0,o[85],o[120]).then(function(e){var t;return t=e,o[123]=t[0],t})},function(e){return o[123]?o[124]=!1:o[124]=!0,o[124]?t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoEpochUtils] Failed to generate epoch_chaining_key and epoch_distribution_pre_shared_key."),o[138]="Failed to generate epoch_chaining_key and epoch_distribution_pre_shared_key.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoEpochUtils] ","",o[138]].join("")),o[137]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils",o[138],o[137],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,o[139]=t[0],t})},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,o[140]=t[0],t})},function(e){var t;return t=[o[139],o[140]],o[125]=t[0],o[126]=t[1],t}]):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[123],t.i64.cast([0,0])).then(function(e){var t;return t=e,o[137]=t[0],o[138]=t[1],t})},function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[123],t.i64.cast([0,1])).then(function(e){var t;return t=e,o[139]=t[0],o[140]=t[1],t})},function(e){var t;return t=[o[137],o[139]],o[125]=t[0],o[126]=t[1],t}])},function(r){return o[127]=o[106].get("encrypted_epoch_key"),t.blobs.neq(o[127],void 0)?t.sequence([function(r){return o[137]=o[106].get("epoch_auth_public_key"),o[138]=o[106].get("epoch_anon_id"),t.nativeOperation(n("LSPublicEncryptionCreateDecryptedData.nop"),e[6],o[31],o[137],o[126],t.blobs.of_string(["epoch_","_",t.blobs.to_string(o[138])].join("")),o[127]).then(function(e){var t;return t=e,o[139]=t[0],t})},function(e){return t.blobs.neq(o[139],void 0)?t.resolve(o[140]=o[139]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoEpochUtils] Couldn't decrypt epoch key. Returning null entropy"),o[142]="Couldn't decrypt epoch key. Returning null entropy",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoEpochUtils] ","",o[142]].join("")),o[141]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils",o[142],o[141],t.i64.cast([0,3]))},function(e){return o[140]=void 0}])},function(e){return o[128]=o[140]}]):t.sequence([function(e){return o[140]="encrypted_epoch_key is null. Can't generate epoch entropy. epoch_anon_id(base64) = ",o[137]=o[106].get("epoch_anon_id"),t.nativeOperation(n("LSBase64Encode.nop"),o[137]).then(function(e){var t;return t=e,o[138]=t[0],t})},function(e){return o[141]=o[138]==null?"":o[138],o[139]="",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBEpochDerivationUtils] ",o[139],o[140],o[139],o[141]].join("")),o[142]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBEpochDerivationUtils",[o[140],",",o[141]].join(""),o[142],t.i64.cast([0,3]))},function(e){return o[128]=void 0}])},function(e){return t.blobs.neq(o[128],void 0)?t.sequence([function(e){return o[137]=t.createArray(),o[142]=(o[137].push(t.i64.cast([0,32])),o[137]),t.nativeOperation(n("LSGetBlobFromString.nop"),"epoch_root_key").then(function(e){var t;return t=e,o[138]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),o[138],o[125],o[128],o[137]).then(function(e){var t;return t=e,o[139]=t[0],t})},function(e){return o[139]?o[140]=!1:o[140]=!0,o[140]?t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoEpochUtils] Unable to generate epoch root key."),o[143]="Unable to generate epoch root key.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoEpochUtils] ","",o[143]].join("")),o[142]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils",o[143],o[142],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,o[144]=t[0],t})},function(e){return o[141]=o[144]}]):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[139],t.i64.cast([0,0])).then(function(e){var t;return t=e,o[142]=t[0],o[143]=t[1],t})},function(e){return o[141]=o[142]}])},function(e){return o[129]=o[141]}]):t.sequence([function(e){return o[140]="epoch entropy is null. Can't generate epoch root key. epoch_anon_id(base64) = ",o[137]=o[106].get("epoch_anon_id"),t.nativeOperation(n("LSBase64Encode.nop"),o[137]).then(function(e){var t;return t=e,o[138]=t[0],t})},function(e){return o[141]=o[138]==null?"":o[138],o[139]="",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBEpochDerivationUtils] ",o[139],o[140],o[139],o[141]].join("")),o[142]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBEpochDerivationUtils",[o[140],",",o[141]].join(""),o[142],t.i64.cast([0,3]))},function(e){return o[129]=void 0}])},function(e){return t.blobs.neq(o[129],void 0)?t.sequence([function(e){return t.filter(t.db.table(169).fetch([[[o[98]]]]),function(e){return t.i64.eq(e.epochId,o[98])&&t.i64.gt(e.authorityLevel,t.i64.cast([0,80]))}).next().then(function(e){var n=e.done,r=e.value;return n?t.db.table(169).put({epochId:o[98],backupId:o[114],epochAnonIdBlob:o[117],epochRootKeyBlob:o[129],epochStatus:o[116],authorityLevel:t.i64.cast([0,80]),epochHead:o[119]}):0})},function(e){var n;return n=[o[98],o[114],o[117],o[129],o[116],o[119],t.i64.cast([0,80])],o[130]=n[0],o[131]=n[1],o[132]=n[2],o[133]=n[3],o[134]=n[4],o[135]=n[5],o[136]=n[6],n}]):t.sequence([function(e){return o[140]="Epoch root key is null. Can't write the epoch to the table. epoch_anon_id(base64) = ",o[137]=o[106].get("epoch_anon_id"),t.nativeOperation(n("LSBase64Encode.nop"),o[137]).then(function(e){var t;return t=e,o[138]=t[0],t})},function(e){return o[141]=o[138]==null?"":o[138],o[139]="",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBEpochDerivationUtils] ",o[139],o[140],o[139],o[141]].join("")),o[142]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBEpochDerivationUtils",[o[140],",",o[141]].join(""),o[142],t.i64.cast([0,3]))},function(e){var t;return t=[o[82],o[83],o[84],o[85],o[86],o[88],o[87]],o[130]=t[0],o[131]=t[1],o[132]=t[2],o[133]=t[3],o[134]=t[4],o[135]=t[5],o[136]=t[6],t}])},function(e){var t;return t=[o[130],o[131],o[132],o[133],o[134],o[135],o[136]],o[107]=t[0],o[108]=t[1],o[109]=t[2],o[110]=t[3],o[111]=t[4],o[112]=t[5],o[113]=t[6],t}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBEpochDerivationUtils] Unexpected error! New epoch is null even though we have a new_epoch_id value"),o[115]="Unexpected error! New epoch is null even though we have a new_epoch_id value",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBEpochDerivationUtils] ","",o[115]].join("")),o[114]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBEpochDerivationUtils",o[115],o[114],t.i64.cast([0,3]))},function(e){var t;return t=[o[82],o[83],o[84],o[85],o[86],o[88],o[87]],o[107]=t[0],o[108]=t[1],o[109]=t[2],o[110]=t[3],o[111]=t[4],o[112]=t[5],o[113]=t[6],t}])},function(e){var t;return t=[o[107],o[108],o[109],o[110],o[111],o[112],o[113]],o[99]=t[0],o[100]=t[1],o[101]=t[2],o[102]=t[3],o[103]=t[4],o[104]=t[5],o[105]=t[6],t}]):t.sequence([function(e){return o[108]="New epoch is null. This is expected if epoch_id is the root or last epoch. epoch_anon_id(base64) = ",t.nativeOperation(n("LSBase64Encode.nop"),o[84]).then(function(e){var t;return t=e,o[106]=t[0],t})},function(e){return o[109]=o[106]==null?"":o[106],o[110]=" , is_forward = ",o[111]="1",o[107]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][MEBEpochDerivationUtils] ",o[107],o[108],o[107],o[109],o[107],o[110],o[107],o[111]].join("")),t.resolve()},function(e){var t;return t=[o[82],o[83],o[84],o[85],o[86],o[88],o[87]],o[99]=t[0],o[100]=t[1],o[101]=t[2],o[102]=t[3],o[103]=t[4],o[104]=t[5],o[105]=t[6],t}])},function(e){var t;return t=[o[99],o[100],o[101],o[102],o[103],o[104],o[105]],o[90]=t[0],o[91]=t[1],o[92]=t[2],o[93]=t[3],o[94]=t[4],o[95]=t[5],o[96]=t[6],t}]):t.sequence([function(e){return o[100]="Unexpected error! server epoch is null even though we have epoch_id. epoch_anon_id(base64) = ",t.nativeOperation(n("LSBase64Encode.nop"),o[84]).then(function(e){var t;return t=e,o[98]=t[0],t})},function(e){return o[101]=o[98]==null?"":o[98],o[99]="",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBEpochDerivationUtils] ",o[99],o[100],o[99],o[101]].join("")),o[102]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBEpochDerivationUtils",[o[100],",",o[101]].join(""),o[102],t.i64.cast([0,3]))},function(e){var t;return t=[o[82],o[83],o[84],o[85],o[86],o[88],o[87]],o[90]=t[0],o[91]=t[1],o[92]=t[2],o[93]=t[3],o[94]=t[4],o[95]=t[5],o[96]=t[6],t}])},function(e){return o[97]=new t.Map,o[97].set("epoch_id",o[90]),o[97].set("backup_id",o[91]),o[97].set("epoch_anon_id_blob",o[92]),o[97].set("epoch_root_key_blob",o[93]),o[97].set("epoch_status",o[94]),o[97].set("epoch_head",o[95]),o[97].set("authority_level",o[96]),o[72]=o[97]}])}):t.resolve()},function(e){return t.sequence([function(e){return t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,o[79]=t[0],t})},function(e){return o[79]?o[80]=!0:o[80]=!1,o[80]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),o[82]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",o[82]].join("")),o[81]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",o[82],o[81],t.i64.cast([0,3]))):t.resolve()}])},function(r){return o[75]=new t.Map,o[75].set("epoch_id",e[2]),o[75].set("authority_level",t.i64.cast([0,80])),o[75].set("backup_id",e[1]),o[75].set("epoch_anon_id_blob",o[21]),o[75].set("epoch_root_key_blob",o[25]),o[75].set("epoch_status",t.i64.cast([0,1])),o[75].set("epoch_head",o[46]),o[76]=o[75],o[77]=e[5].keys(),o[78]=t.i64.of_int32(o[77].length),t.i64.gt(o[78],t.i64.cast([0,0]))?t.loopAsync(o[78],function(r){return o[79]=r,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[77],o[79]).then(function(e){var t;return t=e,o[80]=t[0],o[81]=t[1],t})},function(r){return o[82]=o[76].get("epoch_id"),o[83]=o[76].get("backup_id"),o[84]=o[76].get("epoch_anon_id_blob"),o[85]=o[76].get("epoch_root_key_blob"),o[86]=o[76].get("epoch_status"),o[87]=o[76].get("authority_level"),o[88]=o[76].get("epoch_head"),o[89]=e[5].get(t.i64.to_string(o[82])),o[89]!==void 0?t.sequence([function(r){return o[98]=o[89].get("prev_epoch_id"),t.i64.neq(o[98],void 0)?t.sequence([function(r){return o[106]=e[5].get(t.i64.to_string(o[98])),o[106]!==void 0?t.sequence([function(e){return o[114]=o[106].get("backup_id"),o[115]=o[106].get("is_active_epoch"),o[115]?o[116]=t.i64.cast([0,1]):o[116]=t.i64.cast([0,2]),o[117]=o[89].get("epoch_data_v2"),o[117]!==void 0?t.sequence([function(e){return o[125]=t.createArray(),o[144]=(o[125].push(t.i64.cast([0,32])),o[125]),t.nativeOperation(n("LSBase64Encode.nop"),o[84]).then(function(e){var t;return t=e,o[126]=t[0],t})},function(e){return o[126]!==void 0?t.sequence([function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blobs.of_string(["epoch_data_storage","_",o[126]].join("")),void 0,o[85],o[125]).then(function(e){var t;return t=e,o[144]=t[0],t})},function(e){return o[144]?o[145]=!1:o[145]=!0,o[145]?t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish"),o[148]="THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoEpochUtils] ","",o[148]].join("")),o[147]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils",o[148],o[147],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,o[149]=t[0],t})},function(e){return o[146]=o[149]}]):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[144],t.i64.cast([0,0])).then(function(e){var t;return t=e,o[147]=t[0],o[148]=t[1],t})},function(e){return o[146]=o[147]}])},function(e){return o[127]=o[146]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish"),o[145]="THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoEpochUtils] ","",o[145]].join("")),o[144]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils",o[145],o[144],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,o[146]=t[0],t})},function(e){return o[127]=o[146]}])},function(e){return o[128]=o[117].get("epoch_anon_id"),t.nativeOperation(n("LSSymmetricEncryptionCreateDecryptedString.nop"),o[127],t.blob("ZXBvY2hfZGF0YV9tZXRhZGF0YQ=="),o[128]).then(function(e){var t;return t=e,o[129]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Decode.nop"),o[129]).then(function(e){var t;return t=e,o[130]=t[0],t})},function(e){return t.blobs.neq(o[130],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSIsValidEpochAnonId.nop"),o[130]).then(function(e){var t;return t=e,o[144]=t[0],t})},function(e){return o[131]=o[144]}]):t.resolve(o[131]=!1)},function(e){return o[131]?o[132]=o[130]:o[132]=void 0,o[133]=o[117].get("epoch_root_key"),t.nativeOperation(n("LSSymmetricEncryptionCreateDecryptedString.nop"),o[127],t.blob("ZXBvY2hfZGF0YV9tZXRhZGF0YQ=="),o[133]).then(function(e){var t;return t=e,o[134]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Decode.nop"),o[134]).then(function(e){var t;return t=e,o[135]=t[0],t})},function(e){return t.blobs.neq(o[132],void 0)?t.sequence([function(e){return t.blobs.neq(o[135],void 0)?t.resolve((o[145]=new t.Map,o[145].set("epoch_anon_id",o[132]),o[145].set("epoch_root_key",o[135]),o[144]=o[145])):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBEpochDerivationUtils] Error while decrypting epoch_root_key. Returning null"),o[146]="Error while decrypting epoch_root_key. Returning null",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBEpochDerivationUtils] ","",o[146]].join("")),o[145]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBEpochDerivationUtils",o[146],o[145],t.i64.cast([0,3]))},function(e){return o[144]=void 0}])},function(e){return o[136]=o[144]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBEpochDerivationUtils] Error while decrypting epoch_anon_id. Returning null"),o[145]="Error while decrypting epoch_anon_id. Returning null",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBEpochDerivationUtils] ","",o[145]].join("")),o[144]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBEpochDerivationUtils",o[145],o[144],t.i64.cast([0,3]))},function(e){return o[136]=void 0}])},function(e){return o[136]!==void 0?t.sequence([function(e){return o[144]=o[136].get("epoch_anon_id"),o[145]=o[136].get("epoch_root_key"),o[146]=o[106].get("minos_epoch"),o[146]!==void 0?(o[148]=o[146].get("epoch_head"),o[147]=o[148]):o[147]=void 0,t.filter(t.db.table(169).fetch([[[o[98]]]]),function(e){return t.i64.eq(e.epochId,o[98])&&t.i64.gt(e.authorityLevel,t.i64.cast([0,80]))}).next().then(function(e){var n=e.done,r=e.value;return n?t.db.table(169).put({epochId:o[98],backupId:o[114],epochAnonIdBlob:o[144],epochRootKeyBlob:o[145],epochStatus:o[116],authorityLevel:t.i64.cast([0,80]),epochHead:o[147]}):0})},function(e){var n;return n=[o[98],o[114],o[144],o[145],o[116],o[147],t.i64.cast([0,80])],o[137]=n[0],o[138]=n[1],o[139]=n[2],o[140]=n[3],o[141]=n[4],o[142]=n[5],o[143]=n[6],n}]):t.sequence([function(e){return o[146]="Error while decrypting epoch data of epoch_anon_id(base64) = ",t.nativeOperation(n("LSBase64Encode.nop"),o[84]).then(function(e){var t;return t=e,o[144]=t[0],t})},function(e){return o[147]=o[144]==null?"":o[144],o[145]="",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBEpochDerivationUtils] ",o[145],o[146],o[145],o[147]].join("")),o[148]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBEpochDerivationUtils",[o[146],",",o[147]].join(""),o[148],t.i64.cast([0,3]))},function(e){var t;return t=[o[82],o[83],o[84],o[85],o[86],o[88],o[87]],o[137]=t[0],o[138]=t[1],o[139]=t[2],o[140]=t[3],o[141]=t[4],o[142]=t[5],o[143]=t[6],t}])},function(e){var t;return t=[o[137],o[138],o[139],o[140],o[141],o[142],o[143]],o[118]=t[0],o[119]=t[1],o[120]=t[2],o[121]=t[3],o[122]=t[4],o[123]=t[5],o[124]=t[6],t}]):t.sequence([function(e){return o[127]="Error while reading epoch_data_v2. This is expected if this is the root epoch. epoch_anon_id(base64) = ",t.nativeOperation(n("LSBase64Encode.nop"),o[84]).then(function(e){var t;return t=e,o[125]=t[0],t})},function(e){return o[128]=o[125]==null?"":o[125],o[126]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][MEBEpochDerivationUtils] ",o[126],o[127],o[126],o[128]].join("")),t.resolve()},function(e){var t;return t=[o[82],o[83],o[84],o[85],o[86],o[88],o[87]],o[118]=t[0],o[119]=t[1],o[120]=t[2],o[121]=t[3],o[122]=t[4],o[123]=t[5],o[124]=t[6],t}])},function(e){var t;return t=[o[118],o[119],o[120],o[121],o[122],o[123],o[124]],o[107]=t[0],o[108]=t[1],o[109]=t[2],o[110]=t[3],o[111]=t[4],o[112]=t[5],o[113]=t[6],t}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBEpochDerivationUtils] Unexpected error! New epoch is null even though we have a new_epoch_id value"),o[115]="Unexpected error! New epoch is null even though we have a new_epoch_id value",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBEpochDerivationUtils] ","",o[115]].join("")),o[114]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBEpochDerivationUtils",o[115],o[114],t.i64.cast([0,3]))},function(e){var t;return t=[o[82],o[83],o[84],o[85],o[86],o[88],o[87]],o[107]=t[0],o[108]=t[1],o[109]=t[2],o[110]=t[3],o[111]=t[4],o[112]=t[5],o[113]=t[6],t}])},function(e){var t;return t=[o[107],o[108],o[109],o[110],o[111],o[112],o[113]],o[99]=t[0],o[100]=t[1],o[101]=t[2],o[102]=t[3],o[103]=t[4],o[104]=t[5],o[105]=t[6],t}]):t.sequence([function(e){return o[108]="New epoch is null. This is expected if epoch_id is the root or last epoch. epoch_anon_id(base64) = ",t.nativeOperation(n("LSBase64Encode.nop"),o[84]).then(function(e){var t;return t=e,o[106]=t[0],t})},function(e){return o[109]=o[106]==null?"":o[106],o[110]=" , is_forward = ",o[111]="0",o[107]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][MEBEpochDerivationUtils] ",o[107],o[108],o[107],o[109],o[107],o[110],o[107],o[111]].join("")),t.resolve()},function(e){var t;return t=[o[82],o[83],o[84],o[85],o[86],o[88],o[87]],o[99]=t[0],o[100]=t[1],o[101]=t[2],o[102]=t[3],o[103]=t[4],o[104]=t[5],o[105]=t[6],t}])},function(e){var t;return t=[o[99],o[100],o[101],o[102],o[103],o[104],o[105]],o[90]=t[0],o[91]=t[1],o[92]=t[2],o[93]=t[3],o[94]=t[4],o[95]=t[5],o[96]=t[6],t}]):t.sequence([function(e){return o[100]="Unexpected error! server epoch is null even though we have epoch_id. epoch_anon_id(base64) = ",t.nativeOperation(n("LSBase64Encode.nop"),o[84]).then(function(e){var t;return t=e,o[98]=t[0],t})},function(e){return o[101]=o[98]==null?"":o[98],o[99]="",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBEpochDerivationUtils] ",o[99],o[100],o[99],o[101]].join("")),o[102]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBEpochDerivationUtils",[o[100],",",o[101]].join(""),o[102],t.i64.cast([0,3]))},function(e){var t;return t=[o[82],o[83],o[84],o[85],o[86],o[88],o[87]],o[90]=t[0],o[91]=t[1],o[92]=t[2],o[93]=t[3],o[94]=t[4],o[95]=t[5],o[96]=t[6],t}])},function(e){return o[97]=new t.Map,o[97].set("epoch_id",o[90]),o[97].set("backup_id",o[91]),o[97].set("epoch_anon_id_blob",o[92]),o[97].set("epoch_root_key_blob",o[93]),o[97].set("epoch_status",o[94]),o[97].set("epoch_head",o[95]),o[97].set("authority_level",o[96]),o[76]=o[97]}])}):t.resolve()},function(e){return t.sequence([function(e){return t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,o[79]=t[0],t})},function(e){return o[79]?o[80]=!0:o[80]=!1,o[80]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),o[82]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",o[82]].join("")),o[81]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",o[82],o[81],t.i64.cast([0,3]))):t.resolve()}])}]):((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBEpochDerivationUtils] Unexpected Error. A base epoch exists on client but not found on server"),o[67]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBEpochDerivationUtils","Unexpected Error. A base epoch exists on client but not found on server",o[67],t.i64.cast([0,3])))}]):t.sequence([function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_error","LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure: epoch storage private key is null"):t.resolve()},function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] epoch storage private key is null"),o[63]="epoch storage private key is null",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] ","",o[63]].join("")),o[62]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure",o[63],o[62],t.i64.cast([0,3]))}])},function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_epoch_derivation_end"):t.resolve()}])},function(r){return t.db.table(169).fetch([[[e[4]]]]).next().then(function(r,a){var i=r.done,l=r.value;return i?t.sequence([function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_error","LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure: No epochs keys found."):t.resolve()},function(e){return(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] No epochs keys found."),o[59]=void 0}]):(a=l.item,o[61]=new t.Map,o[61].set("epoch_root_key",a.epochRootKeyBlob),o[61].set("epoch_anon_id",a.epochAnonIdBlob),o[61].set("epoch_id",e[4]),o[61].set("epoch_head",a.epochHead),o[59]=o[61])})},function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_insert_epoch_data_end"):t.resolve()},function(r){return o[59]!==void 0?t.sequence([function(e){return o[61]=o[59].get("epoch_anon_id"),o[62]=o[59].get("epoch_root_key"),o[63]=t.createArray(),o[69]=(o[63].push(t.i64.cast([0,32])),o[63]),t.nativeOperation(n("LSBase64Encode.nop"),o[61]).then(function(e){var t;return t=e,o[64]=t[0],t})},function(e){return o[64]!==void 0?t.sequence([function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blobs.of_string(["epoch_devices","_",o[64]].join("")),void 0,o[62],o[63]).then(function(e){var t;return t=e,o[69]=t[0],t})},function(e){return o[69]?o[70]=!1:o[70]=!0,o[70]?t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish"),o[73]="THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoEpochUtils] ","",o[73]].join("")),o[72]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils",o[73],o[72],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,o[74]=t[0],t})},function(e){return o[71]=o[74]}]):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[69],t.i64.cast([0,0])).then(function(e){var t;return t=e,o[72]=t[0],o[73]=t[1],t})},function(e){return o[71]=o[72]}])},function(e){return o[65]=o[71]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish"),o[70]="THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoEpochUtils] ","",o[70]].join("")),o[69]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils",o[70],o[69],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,o[71]=t[0],t})},function(e){return o[65]=o[71]}])},function(e){return t.nativeOperation(n("LSHmac_v2.nop"),o[65],o[33]).then(function(e){var t;return t=e,o[66]=t[0],t})},function(e){return o[67]=o[59].get("epoch_root_key"),t.blobs.neq(o[67],void 0)?t.sequence([function(e){return o[69]=t.createArray(),o[75]=(o[69].push(t.i64.cast([0,18])),o[69]),t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,o[67],o[69]).then(function(e){var t;return t=e,o[70]=t[0],t})},function(e){return o[70]!==void 0?t.sequence([function(e){return o[75]=t.i64.of_int32(o[70].length),t.i64.ge(o[75],t.i64.cast([0,1]))?t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[70],t.i64.cast([0,0])).then(function(e){var t;return t=e,o[77]=t[0],o[78]=t[1],t})},function(e){return o[76]=o[77]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),o[78]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBFingerprint] ","",o[78]].join("")),o[77]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBFingerprint",o[78],o[77],t.i64.cast([0,3]))},function(e){return o[76]=void 0}])},function(e){return o[71]=o[76]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),o[76]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBFingerprint] ","",o[76]].join("")),o[75]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBFingerprint",o[76],o[75],t.i64.cast([0,3]))},function(e){return o[71]=void 0}])},function(e){return t.blobs.neq(o[71],void 0)?o[72]=!0:o[72]=!1,o[72]||((function(e){t.logger(e).mustfix(e)})("LS::assert is failed. Attempting to coerce a null value to nonnull."),t.throw("LS::assert is failed. Attempting to coerce a null value to nonnull.")),t.nativeOperation(n("LSBase64Encode.nop"),o[71]).then(function(e){var t;return t=e,o[73]=t[0],t})},function(e){return o[73]!==void 0?o[74]=o[73]:o[74]="encodingfailed",o[68]=o[74]}]):t.resolve(o[68]="null")},function(r){return t.blobs.neq(o[66],void 0)?t.sequence([function(e){return o[69]=o[59].get("epoch_id"),t.nativeOperation(n("LSBase64Encode.nop"),o[33]).then(function(e){var t;return t=e,o[70]=t[0],t})},function(e){return o[88]=o[70]==null?"":o[70],t.nativeOperation(n("LSBase64Encode.nop"),o[66]).then(function(e){var t;return t=e,o[71]=t[0],t})},function(e){return o[87]=o[71]==null?"":o[71],t.nativeOperation(n("LSBase64Encode.nop"),o[35]).then(function(e){var t;return t=e,o[72]=t[0],t})},function(e){return o[89]=o[72]==null?"":o[72],t.nativeOperation(n("LSBase64Encode.nop"),o[36]==null?t.blob("bnVsbA=="):o[36]).then(function(e){var t;return t=e,o[73]=t[0],t})},function(e){return o[90]=o[73]==null?"":o[73],t.nativeOperation(n("LSBase64Encode.nop"),o[38]).then(function(e){var t;return t=e,o[74]=t[0],t})},function(e){return o[91]=o[74]==null?"":o[74],t.nativeOperation(n("LSBase64Encode.nop"),o[39]==null?t.blob("bnVsbA=="):o[39]).then(function(e){var t;return t=e,o[75]=t[0],t})},function(e){return o[92]=o[75]==null?"":o[75],t.nativeOperation(n("LSBase64Encode.nop"),o[43]).then(function(e){var t;return t=e,o[76]=t[0],t})},function(r){return o[93]=o[76]==null?"":o[76],t.nativeOperation(n("LSBase64Encode.nop"),e[10]).then(function(e){var t;return t=e,o[77]=t[0],t})},function(e){return o[94]=o[77]==null?"":o[77],t.blobs.neq(o[29],void 0)?t.sequence([function(e){return o[95]=new t.Map,t.nativeOperation(n("LSCreateDebugToken.nop"),o[29],"private_key",o[32],t.i64.cast([0,1]),o[95]).then(function(e){var t;return t=e,o[96]=t[0],t})},function(e){return t.blobs.neq(o[96],void 0)?o[97]=o[96]:o[97]=void 0,o[78]=o[97]}]):t.resolve(o[78]=void 0)},function(e){return t.blobs.neq(o[78],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[78]).then(function(e){var t;return t=e,o[95]=t[0],t})},function(e){return o[79]=o[95]}]):t.resolve(o[79]=void 0)},function(e){return t.blobs.neq(o[29],void 0)?t.sequence([function(e){return o[95]=new t.Map,t.nativeOperation(n("LSCreateDebugToken.nop"),o[29],"ocmf_client_state",o[42],t.i64.cast([0,1]),o[95]).then(function(e){var t;return t=e,o[96]=t[0],t})},function(e){return t.blobs.neq(o[96],void 0)?o[97]=o[96]:o[97]=void 0,o[80]=o[97]}]):t.resolve(o[80]=void 0)},function(e){return t.blobs.neq(o[80],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[80]).then(function(e){var t;return t=e,o[95]=t[0],t})},function(e){return o[81]=o[95]}]):t.resolve(o[81]=void 0)},function(e){return t.blobs.neq(o[29],void 0)?t.sequence([function(e){return o[95]=new t.Map,t.nativeOperation(n("LSCreateDebugToken.nop"),o[29],"epoch_storage_private_key",o[34],t.i64.cast([0,1]),o[95]).then(function(e){var t;return t=e,o[96]=t[0],t})},function(e){return t.blobs.neq(o[96],void 0)?o[97]=o[96]:o[97]=void 0,o[82]=o[97]}]):t.resolve(o[82]=void 0)},function(e){return t.blobs.neq(o[82],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[82]).then(function(e){var t;return t=e,o[95]=t[0],t})},function(e){return o[83]=o[95]}]):t.resolve(o[83]=void 0)},function(r){return o[84]=new t.Map,o[84].set("supported_encryption_versions",o[47]),o[84].set("client_version",t.i64.cast([0,1])),o[84].set("version_sig",o[56]==null?"":o[56]),e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_issue_add_device_task_start"):t.resolve()},function(r){return t.i64.eq(e[7],t.i64.cast([0,2]))?t.resolve(o[85]=void 0):t.sequence([function(e){return t.nativeOperation(n("LSGetArmadilloPublicKey.nop")).then(function(e){var t;return t=e,o[95]=t[0],t})},function(e){return o[85]=o[95]}])},function(e){return t.blobs.neq(o[85],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSCreateSignatureWithArmadilloKey.nop"),o[33]).then(function(e){var t;return t=e,o[95]=t[0],t})},function(e){return t.blobs.neq(o[95],void 0)?t.resolve(o[96]=o[95]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoKeySigningUtils] Failed to create labyrinth signature"),o[101]="Failed to create labyrinth signature",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoKeySigningUtils] ","",o[101]].join("")),o[100]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoKeySigningUtils",o[101],o[100],t.i64.cast([0,3]))},function(e){return o[96]=void 0}])},function(e){return t.nativeOperation(n("LSCreateSignature_v2.nop"),o[32],t.blob("Mw=="),o[85]).then(function(e){var t;return t=e,o[97]=t[0],t})},function(e){return t.blobs.neq(o[97],void 0)?t.resolve(o[98]=o[97]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoKeySigningUtils] Failed to create armadillo signature"),o[101]="Failed to create armadillo signature",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoKeySigningUtils] ","",o[101]].join("")),o[100]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoKeySigningUtils",o[101],o[100],t.i64.cast([0,3]))},function(e){return o[98]=void 0}])},function(e){return t.blobs.neq(o[98],void 0)?(t.blobs.neq(o[96],void 0)?(o[101]=new t.Map,o[101].set("armadillo_public_key",o[85]),o[101].set("armadillo_key_signature",o[98]),o[101].set("labyrinth_key_signature",o[96]),o[100]=o[101]):o[100]=void 0,o[99]=o[100]):o[99]=void 0,o[86]=o[99]}]):t.resolve(o[86]=void 0)},function(r){return o[86]!==void 0?t.sequence([function(e){return o[95]=o[86].get("armadillo_public_key"),t.nativeOperation(n("LSBase64Encode.nop"),o[95]).then(function(e){var t;return t=e,o[96]=t[0],t})},function(e){return o[97]=o[86].get("armadillo_key_signature"),t.nativeOperation(n("LSBase64Encode.nop"),o[97]).then(function(e){var t;return t=e,o[98]=t[0],t})},function(e){return o[99]=o[86].get("labyrinth_key_signature"),t.nativeOperation(n("LSBase64Encode.nop"),o[99]).then(function(e){var t;return t=e,o[100]=t[0],t})},function(r){return o[105]=t.i64.cast([0,1e3]),o[101]=o[105],o[102]=new t.Map,o[102].set("backup_id",e[1]),o[102].set("device_epoch_hmac",o[87]),o[102].set("epoch_root_key_fingerprint",o[68]),o[102].set("device_public_key",o[88]),o[102].set("epoch_storage_pubkey",o[89]),o[102].set("epoch_storage_pubkey_sig",o[90]),o[102].set("epoch_auth_pubkey",o[91]),o[102].set("epoch_auth_pubkey_sig",o[92]),o[102].set("ocmf_rotation_token",o[93]),o[102].set("virtual_device_id",o[94]),o[102].set("device_registration_id",e[11]),o[102].set("base_epoch_id",o[69]),o[102].set("encryption_version_data",o[84]),o[102].set("private_key_debug_token",o[79]),o[102].set("ocmf_client_state_debug_token",o[81]),o[102].set("epoch_storage_pvtkey_debug_token",o[83]),o[102].set("trace_id",e[8]),o[102].set("occam_only_eligible",!0),o[102].set("armadillo_public_key",o[96]==null?"":o[96]),o[102].set("armadillo_key_signature",o[98]==null?"":o[98]),o[102].set("labyrinth_key_signature",o[100]==null?"":o[100]),o[103]=t.toJSON(o[102]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",t.i64.cast([0,50006]),o[103],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,o[101]).then(function(e){var t;return t=e,o[104]=t[0],t})}]):((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] failed to get armadillo key and device signatures"),o[99]=t.i64.cast([0,1e3]),o[95]=o[99],o[96]=new t.Map,o[96].set("backup_id",e[1]),o[96].set("device_epoch_hmac",o[87]),o[96].set("epoch_root_key_fingerprint",o[68]),o[96].set("device_public_key",o[88]),o[96].set("epoch_storage_pubkey",o[89]),o[96].set("epoch_storage_pubkey_sig",o[90]),o[96].set("epoch_auth_pubkey",o[91]),o[96].set("epoch_auth_pubkey_sig",o[92]),o[96].set("ocmf_rotation_token",o[93]),o[96].set("virtual_device_id",o[94]),o[96].set("device_registration_id",e[11]),o[96].set("base_epoch_id",o[69]),o[96].set("encryption_version_data",o[84]),o[96].set("private_key_debug_token",o[79]),o[96].set("ocmf_client_state_debug_token",o[81]),o[96].set("epoch_storage_pvtkey_debug_token",o[83]),o[96].set("trace_id",e[8]),o[96].set("occam_only_eligible",!0),o[97]=t.toJSON(o[96]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",t.i64.cast([0,50006]),o[97],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,o[95]).then(function(e){var t;return t=e,o[98]=t[0],t}))},function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_issue_add_device_task_end"):t.resolve()}]):t.sequence([function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_error","LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure: $device_epoch_hmac found to be null"):t.resolve()},function(e){return t.db.table(178).put({pk:t.i64.cast([0,1]),recoveryCodeStatus:t.i64.cast([0,4])})},function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] $device_epoch_hmac found to be null"),o[70]="$device_epoch_hmac found to be null",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] ","",o[70]].join("")),o[69]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure",o[70],o[69],t.i64.cast([0,3]))}])}]):t.sequence([function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_error","LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure: $latest_epoch_data is null."):t.resolve()},function(e){return t.db.table(178).put({pk:t.i64.cast([0,1]),recoveryCodeStatus:t.i64.cast([0,4])})},function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] $latest_epoch_data is null."),o[62]="$latest_epoch_data is null.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] ","",o[62]].join("")),o[61]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure",o[62],o[61],t.i64.cast([0,3]))}])}]):t.sequence([function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_error","LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure: $mailbox root key is null"):t.resolve()},function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] $mailbox root key is null"),o[47]="$mailbox root key is null",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] ","",o[47]].join("")),o[46]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure",o[47],o[46],t.i64.cast([0,3]))},function(e){return t.storedProcedure(n("LSHandleWrongRecoveryCode"),void 0,"[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] $mailbox root key is null",!1)}]):t.sequence([function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_error","LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure: oblivious validation token is null"):t.resolve()},function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] oblivious validation token is null"),o[47]="oblivious validation token is null",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] ","",o[47]].join("")),o[46]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure",o[47],o[46],t.i64.cast([0,3]))},function(e){return t.storedProcedure(n("LSHandleWrongRecoveryCode"),void 0,"[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] oblivious validation token is null",!1)}]):t.sequence([function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_error","LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure: epoch root key is null"):t.resolve()},function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] epoch root key is null"),o[47]="epoch root key is null",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] ","",o[47]].join("")),o[46]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure",o[47],o[46],t.i64.cast([0,3]))},function(e){return t.storedProcedure(n("LSHandleWrongRecoveryCode"),void 0,"[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] epoch root key is null",!1)}]):t.sequence([function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_error","LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure: epoch anon id is null"):t.resolve()},function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] epoch anon id is null"),o[47]="epoch anon id is null",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] ","",o[47]].join("")),o[46]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure",o[47],o[46],t.i64.cast([0,3]))},function(e){return t.storedProcedure(n("LSHandleWrongRecoveryCode"),void 0,"[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] epoch anon id is null",!1)}])}]):t.sequence([function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_error","LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure: orf client state v1 is null"):t.resolve()},function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] orf client state v1 is null"),o[41]="orf client state v1 is null",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] ","",o[41]].join("")),o[40]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure",o[41],o[40],t.i64.cast([0,3]))},function(e){return t.storedProcedure(n("LSHandleWrongRecoveryCode"),void 0,"[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] orf client state v1 is null",!1)}])},function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_sproc_end"):t.resolve()}]):(i=s.item,t.sequence([function(e){return(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] An authoritative row already exists, aborting execution of addDeviceFromVirtualDevice"),t.db.table(178).put({pk:t.i64.cast([0,1]),recoveryCodeStatus:t.i64.cast([0,2])})},function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_device_already_added"):t.resolve()},function(r){return e[8]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[8],"dasm_add_device_with_virtual_device_and_decryption_key_sproc_end"):t.resolve()}]))})},function(e){return o[2]=t.i64.of_float(Date.now()),o[3]=t.i64.random(),o[5]="Finishing execution. Execution time: ",o[6]=t.i64.to_string(t.i64.sub(o[2],o[0])),o[7]=" ms",o[4]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure] ",o[4],o[5],o[4],o[6],o[4],o[7]].join("")),t.i64.eq(t.i64.mod_(o[3],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(o[8]=",",o[9]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure",[o[5],o[8],o[6],o[8],o[7]].join(""),o[9],t.i64.cast([0,4]))):t.resolve()}])},function(e){return t.resolve(a)}])}e.__sproc_name__="LSEncryptedBackupsAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure",e.__tables__=["secure_encrypted_backups_client_state","secure_encrypted_backups_recovery_code_status","secure_encrypted_backups_epochs"];var s=e;l.default=s}),98);
__d("LSAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure",["LSAddDeviceWithVirtualDeviceAndDecryptionKey","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSAddDeviceWithVirtualDeviceAndDecryptionKey"),a.taskId,a.backupId,a.epochId,a.encryptedSecretValues,a.lastEpochId,a.syncEpochs,a.epochStoragePublicKey,a.backupTenancy,a.traceId,a.blobDecryptionKey,a.virtualDeviceId,a.deviceRegistrationId,a.minosEpoch);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("EBAddDeviceGraphQL",["CometRelay","EBAPIQPLPoints","EBAddDeviceGraphQLEBFetchVirtualDeviceInfoQuery.graphql","EBGetLSVirtualDevices","EBMinosCheckWasmFeatureSupport","FBLogger","I64","LSAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure","LSDict","LSEncryptedBackupsBackupTenancy","LSFactory","LSParseRecoveryCode_v2.nop","LSShape","LSVec","MWEncryptedBackupsDeviceRegistrationId","ReQL","WAArrayBufferUtils","WABase64","WAResultOrError","WorkerRelay","WorkerRelayNetwork","getErrorSafe","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=e!==void 0?e:e=n("EBAddDeviceGraphQLEBFetchVirtualDeviceInfoQuery.graphql");function c(e){var t=e.backupId,n=e.qplFlow,r=e.recoveryCode,a=e.storage,i=e.userId;return o("WorkerRelayNetwork").getWorkerNetworkExecute().then(function(){return m({backupId:t,fetchQueryGraphQLFn:function(t,n){return o("WorkerRelay").createWorkerQuery(t,n)},qplFlow:n,recoveryCode:r,storage:a,userId:i})}).catch(function(){return o("WAResultOrError").makeError("worker-environment-error")})}function d(e){var t=e.backupId,n=e.environment,r=e.qplFlow,a=e.recoveryCode,i=e.storage,l=e.userId;return m({backupId:t,fetchQueryGraphQLFn:function(t,r){return o("CometRelay").fetchQuery(n,t,r,{fetchPolicy:"network-only"}).toPromise()},qplFlow:r,recoveryCode:a,storage:i,userId:l})}async function m(e){var t=e.backupId,n=e.fetchQueryGraphQLFn,a=e.qplFlow,l=e.recoveryCode,c=e.storage,d=e.userId,m=await o("EBMinosCheckWasmFeatureSupport").checkWasmFeatureSupportAndGK();try{return g(c).then(function(e){var t=e!=null?e:d;return a.addPoint(o("EBAPIQPLPoints").EBAddDeviceGraphqlQPLPoints.ADD_DEVICE_PARSE_RECOVERY_CODE_START),Promise.all([c.runInTransaction(function(e){return r("LSParseRecoveryCode_v2.nop")(e,0,l,t,r("LSVec").ofArray([]))},"readwrite","ui",void 0,i.id+":209"),Promise.resolve(t)])}).then(function(e){a.addPoint(o("EBAPIQPLPoints").EBAddDeviceGraphqlQPLPoints.ADD_DEVICE_PARSE_RECOVERY_CODE_END);var l=e[0][0],d=e[0][1],g=e[1];if(l==null||d==null)return o("WAResultOrError").makeError("missing-mandatory-field");var h=o("WABase64").encodeB64(l);return a.addPoint(o("EBAPIQPLPoints").EBAddDeviceGraphqlQPLPoints.ADD_DEVICE_FETCH_VD_GRAPHQL_START),n(u,{request_uuid:g,virtual_device_id:h}).then(function(e){var n,u,g,h;if((e==null||(n=e.fetch_virtual_device_info_for_device_addition_v2)==null?void 0:n.ok)===!1){var y,C,b;return a.addAnnotations({string:{fetch_vd_info_error_code:(y=e==null||(C=e.fetch_virtual_device_info_for_device_addition_v2)==null||(C=C.error)==null?void 0:C.code)!=null?y:""}}),a.addPoint(o("EBAPIQPLPoints").EBAddDeviceGraphqlQPLPoints.ADD_DEVICE_FETCH_VD_GRAPHQL_END),(e==null||(b=e.fetch_virtual_device_info_for_device_addition_v2)==null||(b=b.error)==null?void 0:b.code)==="NO_VIRTUAL_DEVICE_FOUND"?o("EBGetLSVirtualDevices").getLSVirtualDevices(c).then(function(e){return e.length>0&&a.addPoint(o("EBAPIQPLPoints").EBAddDeviceGraphqlQPLPoints.ADD_DEVICE_VIRTUAL_DEVICE_EXISTS),o("WAResultOrError").makeError("graphql-fetch-vd-error")}):o("WAResultOrError").makeError("graphql-fetch-vd-error")}a.addPoint(o("EBAPIQPLPoints").EBAddDeviceGraphqlQPLPoints.ADD_DEVICE_FETCH_VD_GRAPHQL_END);var v=e==null||(u=e.fetch_virtual_device_info_for_device_addition_v2)==null?void 0:u.data,S=o("MWEncryptedBackupsDeviceRegistrationId").getDeviceRegistrationId(),R=(v==null?void 0:v.encrypted_secret_values)!=null?f(v==null?void 0:v.encrypted_secret_values):null,L=v==null?void 0:v.epoch_storage_public_key,E=v==null?void 0:v.epoch_id,k=v==null?void 0:v.last_epoch_id;if(v==null||S===""||R==null||E==null||L==null||k==null){var I=[];return v==null&&I.push("payload"),S===""&&I.push("deviceRegistrationId"),R==null&&I.push("validated_encrypted_secret_values"),E==null&&I.push("epoch_id"),L==null&&I.push("epoch_storage_public_key"),k==null&&I.push("last_epoch_id"),a.addPoint(o("EBAPIQPLPoints").EBAddDeviceGraphqlQPLPoints.ADD_DEVICE_MISSING_GRAPHQL_FIELDS,{string_array:{missing_mandatory_field:I}}),o("WAResultOrError").makeError("missing-mandatory-field")}var T=new(r("LSDict"));v.sync_epochs.forEach(function(e){var t=p(e);t!=null&&e.epoch_id!=null&&T.set(e.epoch_id,o("LSShape").ofRecord(t))});var D=_({epoch_head:(g=v.minos_epoch)==null?void 0:g.epoch_head,self_epoch_signature:(h=v.minos_epoch)==null?void 0:h.self_epoch_signature});a.addPoint(o("EBAPIQPLPoints").EBAddDeviceGraphqlQPLPoints.ADD_DEVICE_VIRTUAL_DEVICE_KEY_SPROC_START);var x={backupId:t,backupTenancy:(s||(s=o("I64"))).of_int32(r("LSEncryptedBackupsBackupTenancy").PRODUCTION),blobDecryptionKey:d,deviceRegistrationId:S,encryptedSecretValues:o("LSShape").ofRecord(R),epochId:s.of_string(E),epochStoragePublicKey:o("WABase64").decodeB64(L),lastEpochId:s.of_string(k),syncEpochs:T,taskId:s.of_int32(0),traceId:a.getQPLAttrs().instanceKey.toString(),virtualDeviceId:l};return(m||r("gkx")("17219"))&&(x=babelHelpers.extends({},x,{minosEpoch:D})),c.runInTransaction(function(e){return r("LSAddDeviceWithVirtualDeviceAndDecryptionKeyStoredProcedure")(r("LSFactory")(e),x)},"readwrite",void 0,void 0,i.id+":382").then(function(){return a.addPoint(o("EBAPIQPLPoints").EBAddDeviceGraphqlQPLPoints.ADD_DEVICE_VIRTUAL_DEVICE_KEY_SPROC_END),o("WAResultOrError").makeResult()}).catch(function(e){var t=r("getErrorSafe")(e);return a.addPoint(o("EBAPIQPLPoints").EBAddDeviceGraphqlQPLPoints.ADD_DEVICE_VIRTUAL_DEVICE_KEY_SPROC_FAIL,{string:{error_message:t.message}}),o("WAResultOrError").makeError("vd-and-decryption-key-sproc-error")})}).catch(function(e){var t=r("getErrorSafe")(e);return a.addPoint(o("EBAPIQPLPoints").EBAddDeviceGraphqlQPLPoints.ADD_DEVICE_FETCH_VD_GRAPHQL_FAIL,{string:{error_message:t.message}}),o("WAResultOrError").makeError("graphql-fetch-vd-error")})}).catch(function(e){var t=r("getErrorSafe")(e);return a.addPoint(o("EBAPIQPLPoints").EBAddDeviceGraphqlQPLPoints.ADD_DEVICE_PARSE_RECOVERY_CODE_FAIL,{string:{error_message:t.message}}),o("WAResultOrError").makeError("parse-recovery-code-error")})}catch(e){var h=r("getErrorSafe")(e);return r("FBLogger")("wmi_eb").catching(h).mustfix("Runtime error performing EBAddDeviceGraphQL: %s",h.message),a.addPoint(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_RUNTIME_ERROR,{string:{error_message:h.message}}),Promise.resolve(o("WAResultOrError").makeError("runtime-error"))}}function p(e){var t=e.backup_id,n=e.encrypted_epoch_key,a=e.epoch_anon_id,i=e.epoch_auth_public_key,l=e.epoch_data_v2,u=e.epoch_id,c=e.is_active_epoch,d=e.minos_epoch,m=e.next_epoch_id,p=e.prev_epoch_id;if(t==null||a==null||i==null||u==null||c==null)return null;var _=d==null?void 0:d.epoch_head,f=d==null?void 0:d.self_epoch_signature,g=_!=null&&f!=null?o("LSShape").ofRecord({epoch_head:o("WABase64").decodeB64(_),self_epoch_signature:o("WABase64").decodeB64(f)}):void 0,h=l==null?void 0:l.epoch_anon_id,y=l==null?void 0:l.epoch_root_key,C=h!=null&&y!=null?{epoch_anon_id:h,epoch_root_key:y}:null,b={backup_id:(s||(s=o("I64"))).of_string(t),encrypted_epoch_key:n!=null?o("WABase64").decodeB64(n):null,epoch_anon_id:o("WAArrayBufferUtils").stringToArrayBuffer(a),epoch_auth_public_key:o("WABase64").decodeB64(i),epoch_data_v2:C?o("LSShape").ofRecord(C):null,epoch_id:s.of_string(u),is_active_epoch:c,next_epoch_id:m!=null?(s||(s=o("I64"))).of_string(m):null,prev_epoch_id:p!=null?(s||(s=o("I64"))).of_string(p):null};return(r("gkx")("20911")||r("gkx")("17219"))&&(b=babelHelpers.extends({},b,{minos_epoch:g})),b}function _(e){var t=e.epoch_head,n=e.self_epoch_signature;return t==null||n==null?void 0:o("LSShape").ofRecord({epoch_head:o("WABase64").decodeB64(t),self_epoch_signature:o("WABase64").decodeB64(n)})}function f(e){var t=e.encrypted_epoch_anon_id,n=e.encrypted_epoch_root_key,r=e.encrypted_epoch_storage_private_key,o=e.encrypted_mailbox_root_key_blob,a=e.encrypted_oblivious_validation_token_blob,i=e.encrypted_ocmf_client_state,l=e.encrypted_orf_client_state_v2;return t==null||n==null||o==null||a==null||i==null?null:{encrypted_epoch_anon_id:t,encrypted_epoch_root_key:n,encrypted_epoch_storage_private_key:r,encrypted_mailbox_root_key_blob:o,encrypted_oblivious_validation_token_blob:a,encrypted_ocmf_client_state:i,encrypted_orf_client_state_v2:l}}function g(e){return o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.tables.encrypted_backups)).then(function(e){var t=e==null?void 0:e.encryptionManagementDelegatorId;return t!=null?(s||(s=o("I64"))).to_string(t):null})}l.addDeviceGraphQLWorker=c,l.addDeviceGraphQL=d}),98);
__d("LSOnboardFromExistingDeviceStart",["LSGetLatestEpochKeys","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(e){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][onboardFromExistingDeviceStart] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.db.table(282).add({stateKey:"auto_restored",stateValue:"true"})},function(n){return t.db.table(185).add({pk:t.i64.cast([0,1]),backupId:e[0],deviceRegistrationId:e[2],taskId:t.i64.cast([0,1])})},function(e){return t.storedProcedure(n("LSGetLatestEpochKeys"),!1).then(function(e){var t;return t=e,r[2]=t[0],r[3]=t[1],t})},function(o){return r[2]!==void 0?t.sequence([function(o){return r[11]=r[2].get("epoch_keys"),r[12]=r[11].get("epoch_id"),r[13]=new t.Map,r[13].set("existing_device_id",e[1]),r[13].set("base_epoch_id",r[12]),r[14]=new t.Map,r[14].set("success",r[13]),r[15]=t.toJSON(r[14]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"meb_onboard_from_existing_device",t.i64.cast([0,50036]),r[15],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,r[16]=t[0],t})},function(e){return r[4]=void 0}]):t.sequence([function(e){return r[3]!==void 0?t.sequence([function(e){return r[12]=r[3].get("error_message"),r[13]=r[3].get("error_code"),r[14]=new t.Map,r[14].set("error_code",r[13]),r[14].set("stored_procedure","onboardFromExistingDeviceStart"),r[14].set("error_message",r[12]),r[15]=new t.Map,r[15].set("failure",r[14]),r[16]=t.toJSON(r[15]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"meb_onboard_from_existing_device",t.i64.cast([0,50036]),r[16],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,r[17]=t[0],t})},function(e){return r[18]=new t.Map,r[18].set("error_code",r[13]),r[18].set("stored_procedure","LSEncryptedBackupsOnboardFromExistingDeviceStartStoredProcedure"),r[18].set("error_message",""),r[11]=r[18]}]):t.sequence([function(e){return r[12]=new t.Map,r[12].set("error_code",t.i64.cast([0,603])),r[12].set("stored_procedure","onboardFromExistingDeviceStart"),r[12].set("error_message","Unknown error encountered"),r[13]=new t.Map,r[13].set("failure",r[12]),r[14]=t.toJSON(r[13]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"meb_onboard_from_existing_device",t.i64.cast([0,50036]),r[14],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,r[15]=t[0],t})},function(e){return r[16]=new t.Map,r[16].set("error_code",t.i64.cast([0,603])),r[16].set("stored_procedure","LSEncryptedBackupsOnboardFromExistingDeviceStartStoredProcedure"),r[16].set("error_message",""),r[11]=r[16]}])},function(e){return r[4]=r[11]}])},function(e){return r[5]=t.i64.of_float(Date.now()),r[6]=t.i64.random(),r[8]="Finishing execution. Execution time: ",r[9]=t.i64.to_string(t.i64.sub(r[5],r[0])),r[10]=" ms",r[7]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][onboardFromExistingDeviceStart] ",r[7],r[8],r[7],r[9],r[7],r[10]].join("")),t.i64.eq(t.i64.mod_(r[6],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[11]=",",r[12]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"onboardFromExistingDeviceStart",[r[8],r[11],r[9],r[11],r[10]].join(""),r[12],t.i64.cast([0,4]))):t.resolve()},function(e){return o[0]=r[4]}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsOnboardFromExistingDeviceStartStoredProcedure",e.__tables__=["experiences_shared_state","device_metadata"],a.exports=e}),null);
__d("LSOnboardFromExistingDeviceStartStoredProcedure",["LSOnboardFromExistingDeviceStart","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSOnboardFromExistingDeviceStart"),a.backupId,a.previousDeviceId,a.newDeviceRegistrationId);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("EBAddDeviceWithKeys",["ClientConsistencyEventEmitter","CurrentAppID","EBAPIQPLPoints","EBDB","EBSMAPI","EBSMGatingUI","I64","LSAuthorityLevel","LSFactory","LSIntEnum","LSOnboardFromExistingDeviceStartStoredProcedure","LSShape","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWEBODSEntityName.enum","MWEncryptedBackupsInitializeRestoreDeferred","MWEncryptedBackupsLocalStorageEntryEnum","MWEncryptedBackupsSharedState","ODS","Promise","QPLFlow","QPLUserFlow","ReQL","WAHashStringToNumber","WALogger","err","getErrorSafe","justknobx","promiseDone","qpl","requireDeferred","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g,h,y,C=r("requireDeferred")("MWEBUseLocalStorage").__setRef("EBAddDeviceWithKeys");function b(t){var a=t.backupId,l=t.db,_=t.newDeviceRegistrationId,b=t.previousDeviceId,S=t.source,R=t.trackAddingDevice;return new(y||(y=n("Promise")))(function(t,n){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[wmi][ebsm] EBAPI addDeviceWithEBKeys start"]))),r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,"START_LS_ADD_DEVICE_WITH_EB_KEYS_SPROC");var y=o("WAHashStringToNumber").hashStringToNumber(r("uuidv4")()),L=r("qpl")._(521473756,"2768"),E=S,k=o("QPLFlow").startQPLFlow(L,{annotations:{bool:{isEBAddDeviceWithKeys:!0,isInWorker:!1},string:{restore_type:E}},instanceKey:y,timeoutInMs:r("justknobx")._("2444")});k.addPoint(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_SPROC_START),(f||(f=o("ODS"))).bumpEntityKey(7319,E,"start"),o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[wmi][ebsm] EBAPI addDeviceWithEBKeys caling LSOnboardFromExistingDeviceStartStoredProcedure"]))),l.runInTransaction(function(e){return r("LSOnboardFromExistingDeviceStartStoredProcedure")(r("LSFactory")(e),{backupId:a,newDeviceRegistrationId:_,previousDeviceId:b})},"readwrite",void 0,void 0,i.id+":103").then(function(e){var a=e[0];if(r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,"END_LS_ADD_DEVICE_WITH_EB_KEYS_SPROC"),k.addPoint(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_SPROC_END),a!=null){var i,s=o("LSShape").toRecord(a).error_message;switch(r("QPLUserFlow").addPoint((i=o("MWChatEncryptedBackupsQPLEvents")).restoreDeviceAuthQplEvent,"FAIL_LS_ADD_DEVICE_WITH_EB_KEYS_SPROC_WIPE_EBSM"),r("QPLUserFlow").addPoint(i.restoreQplEvent,"FAIL_LS_ADD_DEVICE_WITH_EB_KEYS_SPROC_WIPE_EBSM"),o("MWChatEncryptedBackupsLogging").endFailure({errorName:s,event:i.restoreQplEvent}),o("MWChatEncryptedBackupsLogging").endFailure({errorName:s,event:i.restoreDeviceAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_AUTO_RESTORE_AUTH}),k.endFail(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_SPROC_FAILURE,{string:{error_code:(g||(g=o("I64"))).to_string(o("LSShape").toRecord(a).error_code),error_message:s}}),(f||(f=o("ODS"))).bumpEntityKey(7319,E,"fail"),o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[wmi][ebsm] EBAPI addDeviceWithKeys sproc failed, isInWorker: false, error: ",""])),s),r("promiseDone")(o("EBDB").clearEbStores()),o("CurrentAppID").getAppID()){case 772021112871879 .toString():r("ClientConsistencyEventEmitter").emit("hardRefresh","eb_autorestore_error");break;default:r("ClientConsistencyEventEmitter").emit("softRefresh","eb_autorestore_error")}n(r("err")(s))}k.addPoint(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_SUBSCRIPTION_START);var _=o("ReQL").fromTableAscending(l.tables.secure_encrypted_backups_client_state).subscribe(function(e,a){if(a.operation==="delete"){_();var i="[wmi][ebsm] EBAPI addDeviceWithKeys subscription failed, isInWorker: false, error: client state deleted";v(i,k,E),n(r("err")(i))}else if(a.operation==="add"||a.operation==="put"){var s=a.value,u=s.authorityLevel,y=s.deviceId;(g||(g=o("I64"))).equal(u,(h||(h=o("LSIntEnum"))).ofNumber(r("LSAuthorityLevel").AUTHORITATIVE))&&(r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,"END_LS_ADD_DEVICE_WITH_EB_KEYS_TASK"),k.addPoint(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_SUBSCRIPTION_END),_(),r("promiseDone")(o("MWEncryptedBackupsSharedState").upsertEBSharedStateEntry({db:l,stateKey:r("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_RESTORED_SUCCESSFULLY})),o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[wmi][ebsm] EBAPI addDeviceWithEBKeys client state row added"]))),R(y),C.onReady(function(e){var t=e.mwEBCreateLocalStorageEntry,n=e.mwEBDeleteLocalStorageEntry;t(r("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION),t(r("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION_2),n(r("MWEncryptedBackupsLocalStorageEntryEnum").EBSM_CORRUPTION_WIPE)}),o("MWEncryptedBackupsInitializeRestoreDeferred").encryptedBackupsInitializeRestoreDeferred({db:l,onFailure:function(){o("MWChatEncryptedBackupsLogging").endFailure({annotations:{bool:{is_backend_setup:o("EBSMGatingUI").isBackendSetupSuccessfulForEBSM()}},errorName:"FAILED_TO_RESTORE_ENCRYPTED_BACKUP",event:o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent}),o("MWChatEncryptedBackupsLogging").endFailure({annotations:{bool:{is_backend_setup:o("EBSMGatingUI").isBackendSetupSuccessfulForEBSM()}},errorName:"FAILED_TO_RESTORE_ENCRYPTED_BACKUP",event:o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_AUTO_RESTORE_AUTH}),o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[wmi][ebsm] EBAPI addDeviceWithEBKeys initialize restore failed"])))},onSuccess:function(){r("QPLUserFlow").addAnnotations(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,{string:{restore_type:"auto_restore"}}),o("MWChatEncryptedBackupsLogging").endSuccess({annotations:{bool:{is_backend_setup:o("EBSMGatingUI").isBackendSetupSuccessfulForEBSM()}},event:o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent}),o("MWChatEncryptedBackupsLogging").endSuccess({event:o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_AUTO_RESTORE_AUTH}),o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[wmi][ebsm] EBAPI addDeviceWithEBKeys initialize restore success"])))}}),r("EBSMAPI").fetchBackupIds("EBAddDeviceWithKeys").catch(function(e){o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["",""])),r("getErrorSafe")(e).message)}),k.endSuccess(),(f||(f=o("ODS"))).bumpEntityKey(7319,E,"success"),t())}})}).catch(function(e){var t="[wmi][ebsm] EBAPI addDeviceWithKeys sproc error, isInWorker: false, error: "+r("getErrorSafe")(e).message;v(t,k,E),n(r("err")(t))})})}function v(e,t,n){o("MWChatEncryptedBackupsLogging").endFailure({annotations:{bool:{isBackendSetupOnFail:o("EBSMGatingUI").isBackendSetupSuccessfulForEBSM()}},errorName:e,event:o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent}),o("MWChatEncryptedBackupsLogging").endFailure({errorName:e,event:o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_AUTO_RESTORE_AUTH}),t.endFail(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_SPROC_FAILURE,{string:{error_message:e}}),(f||(f=o("ODS"))).bumpEntityKey(7319,n,"fail"),o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["",""])),e)}l.addDeviceWithEBKeys=b}),98);
__d("LSAddDevice",["LSArrayGetObjectAt","LSBase64Encode.nop","LSGetViewerFBID","LSHandleWrongRecoveryCode","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop","LSParseRecoveryCode_v2.nop","LSQplAnnotateString.nop","LSQplMarkPoint.nop","justknobx"],(function(t,n,r,o,a,i,l){function e(){var e=arguments,t=e[e.length-1],o=[],a=[];return t.sequence([function(i){return t.sequence([function(r){return o[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsAddDeviceStoredProcedure] Beginning execution."),e[4]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[4],"dasm_add_device_sproc_start"):t.resolve()},function(a){return r("justknobx")._("946")?t.sequence([function(e){return o[8]=t.createArray(),t.forEach(t.db.table(179).fetch(),function(e){var n=e.item;return t.sequence([function(e){return o[15]=n.taskId,t.db.table(2).fetch([[[o[15]]]]).next().then(function(e,t){var n=e.done,r=e.value;return n?o[13]=!1:(t=r.item,o[13]=!0)})},function(e){return o[13]?0:o[16]=(o[8].push(o[15]),o[8])}])})},function(e){return o[9]=t.i64.of_int32(o[8].length),t.i64.gt(o[9],t.i64.cast([0,0]))?t.loopAsync(o[9],function(e){return o[13]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[8],o[13]).then(function(e){var t;return t=e,o[14]=t[0],o[15]=t[1],t})},function(e){return t.forEach(t.db.table(179).fetch([[[o[14]]]]),function(e){return e.delete()})}])}):t.resolve()},function(e){return t.db.table(179).fetch().next().then(function(e,t){var n=e.done,r=e.value;return n?o[10]=!1:(t=r.item,o[10]=!0)})},function(r){return o[10]?t.sequence([function(r){return e[4]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,1021646192]),e[4],"dasm_error","LSEncryptedBackupsAddDeviceStoredProcedure: add device task already pending"):t.resolve()},function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsAddDeviceStoredProcedure] add device task already pending"),o[14]="add device task already pending",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsAddDeviceStoredProcedure] ","",o[14]].join("")),o[13]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsAddDeviceStoredProcedure",o[14],o[13],t.i64.cast([0,3]))},function(e){return o[12]=t.i64.cast([0,1])}]):t.sequence([function(r){return e[4]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[4],"dasm_add_device_vd_error_correction_start"):t.resolve()},function(n){return o[13]=t.createArray(),t.forEach(t.filter(t.db.table(184).fetch(),function(n){return t.i64.eq(n.backupId,e[0])}),function(e){var n=e.item;return o[19]=new t.Map,o[19].set("virtual_device_id",n.virtualDeviceId),o[20]=(o[13].push(o[19]),o[13])})},function(r){return e[4]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[4],"dasm_add_device_vd_error_correction_end"):t.resolve()},function(r){return e[4]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[4],"dasm_add_device_parse_recovery_code_start"):t.resolve()},function(e){return t.db.table(172).fetch().next().then(function(e,n){var r=e.done,a=e.value;return r?o[14]=void 0:(n=a.item,o[20]=n.encryptionManagementDelegatorId,t.i64.neq(o[20],void 0)?(t.i64.neq(o[20],t.i64.cast([0,0]))?o[21]=t.i64.to_string(o[20]):o[21]=void 0,o[19]=o[21]):o[19]=void 0,o[14]=o[19])})},function(e){return t.storedProcedure(n("LSGetViewerFBID")).then(function(e){var t;return t=e,o[16]=t[0],t})},function(r){return t.nativeOperation(n("LSParseRecoveryCode_v2.nop"),e[1],o[14]==null?t.i64.to_string(o[16]):o[14],o[13]).then(function(e){var t;return t=e,o[17]=t[0],o[18]=t[1],t})},function(r){return e[4]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[4],"dasm_add_device_parse_recovery_code_end"):t.resolve()},function(r){return t.blobs.neq(o[17],void 0)?t.blobs.neq(o[18],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[17]).then(function(e){var t;return t=e,o[19]=t[0],t})},function(e){return t.db.table(178).put({pk:t.i64.cast([0,1]),recoveryCodeStatus:t.i64.cast([0,1])})},function(r){return e[4]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[4],"dasm_add_device_issue_fetch_virtual_device_task_start"):t.resolve()},function(r){return o[24]=t.i64.cast([0,1e3]),o[20]=o[24],o[21]=new t.Map,o[21].set("backup_id",e[0]),o[21].set("virtual_device_id",o[19]==null?"":o[19]),o[21].set("trace_id",void 0),o[22]=t.toJSON(o[21]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",t.i64.cast([0,50007]),o[22],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,o[20]).then(function(e){var t;return t=e,o[23]=t[0],t})},function(r){return e[4]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[4],"dasm_add_device_issue_fetch_virtual_device_task_end"):t.resolve()},function(r){return e[4]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[4],"dasm_add_device_insert_device_registration_id_start"):t.resolve()},function(n){return t.db.table(185).add({pk:t.i64.cast([0,1]),backupId:e[0],deviceRegistrationId:e[2],taskId:o[23]})},function(r){return e[4]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[4],"dasm_add_device_insert_device_registration_id_end"):t.resolve()},function(r){return e[4]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[4],"dasm_add_device_insert_recovery_code_data_start"):t.resolve()},function(e){return t.db.table(179).add({taskId:o[23],virtualDeviceId:o[17],blobDecryptionKey:o[18]})},function(r){return e[4]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[4],"dasm_add_device_insert_recovery_code_data_end"):t.resolve()}]):t.sequence([function(r){return e[4]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,1021646192]),e[4],"dasm_error","LSEncryptedBackupsAddDeviceStoredProcedure: Invalid recovery code. blob_decryption_key is null"):t.resolve()},function(e){return t.storedProcedure(n("LSHandleWrongRecoveryCode"),void 0,"[EncryptedBackups][LSEncryptedBackupsAddDeviceStoredProcedure] Invalid recovery code. blob_decryption_key is null",!0)}]):t.sequence([function(r){return e[4]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,1021646192]),e[4],"dasm_error","LSEncryptedBackupsAddDeviceStoredProcedure: Invalid recovery code. virtual_device_id is null"):t.resolve()},function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsAddDeviceStoredProcedure] Invalid recovery code. virtual_device_id is null"),o[20]="Invalid recovery code. virtual_device_id is null",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsAddDeviceStoredProcedure] ","",o[20]].join("")),o[19]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsAddDeviceStoredProcedure",o[20],o[19],t.i64.cast([0,3]))},function(e){return t.storedProcedure(n("LSHandleWrongRecoveryCode"),void 0,"[EncryptedBackups][LSEncryptedBackupsAddDeviceStoredProcedure] Invalid recovery code. virtual_device_id is null",!0)}])},function(e){return o[12]=t.i64.cast([0,0])}])},function(r){return e[4]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[4],"dasm_add_device_sproc_end"):t.resolve()},function(e){return o[1]=o[12]}]):t.sequence([function(r){return(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsAddDeviceStoredProcedure] addDeviceFlow is not enabled"),e[4]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,1021646192]),e[4],"dasm_error","LSEncryptedBackupsAddDeviceStoredProcedure: add device flow is disabled"):t.resolve()},function(r){return e[4]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,1021646192]),e[4],"dasm_add_device_sproc_end"):t.resolve()},function(e){return o[1]=t.i64.cast([0,1])}])},function(e){return o[2]=t.i64.of_float(Date.now()),o[3]=t.i64.random(),o[5]="Finishing execution. Execution time: ",o[6]=t.i64.to_string(t.i64.sub(o[2],o[0])),o[7]=" ms",o[4]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][LSEncryptedBackupsAddDeviceStoredProcedure] ",o[4],o[5],o[4],o[6],o[4],o[7]].join("")),t.i64.eq(t.i64.mod_(o[3],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(o[8]=",",o[9]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsAddDeviceStoredProcedure",[o[5],o[8],o[6],o[8],o[7]].join(""),o[9],t.i64.cast([0,4]))):t.resolve()},function(e){return a[0]=o[1]}])},function(e){return t.resolve(a)}])}e.__sproc_name__="LSEncryptedBackupsAddDeviceStoredProcedure",e.__tables__=["secure_recovery_code_data","pending_tasks","encrypted_backups_virtual_devices","encrypted_backups","secure_encrypted_backups_recovery_code_status","device_metadata"];var s=e;l.default=s}),98);
__d("LSAddDeviceStoredProcedure",["LSAddDevice","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSAddDevice"),a.backupId,a.recoveryCode,a.deviceRegistrationId,a.backupTenancy,a.traceId);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSEncryptedBackupsRecoveryCodeStatus",[],(function(t,n,r,o,a,i){var e=Object.freeze({OPTIMISTIC:1,VALID:2,INVALID:3,SYSTEM_ERROR:4});i.default=e}),66);
__d("MWEncryptedBackupsRecoveryCodeStatus",["FBLogger","I64","LSEncryptedBackupsRecoveryCodeStatus"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){var n=t.onFailure,a=t.onInvalidRecoveryCode,i=t.onSuccess,l=t.recoveryCodeStatusData;if((l==null?void 0:l.length)===1){var s=l[0].recoveryCodeStatus;switch((e||(e=o("I64"))).to_int32(s)){case r("LSEncryptedBackupsRecoveryCodeStatus").OPTIMISTIC:return r("LSEncryptedBackupsRecoveryCodeStatus").OPTIMISTIC;case r("LSEncryptedBackupsRecoveryCodeStatus").INVALID:return a==null||a(),r("LSEncryptedBackupsRecoveryCodeStatus").INVALID;case r("LSEncryptedBackupsRecoveryCodeStatus").VALID:return i==null||i(),r("LSEncryptedBackupsRecoveryCodeStatus").VALID;case r("LSEncryptedBackupsRecoveryCodeStatus").SYSTEM_ERROR:return n==null||n(),r("LSEncryptedBackupsRecoveryCodeStatus").SYSTEM_ERROR;default:n==null||n(),r("FBLogger")("wmi_eb").mustfix("Invalid Recovery Code Status type")}}}l.encryptedBackupsGetRecoveryCodeStatus=s}),98);
__d("EBAddDeviceWithRecoveryCode",["EBAPIQPLPoints","EBAddDeviceGraphQL","EBDeps","FBLogger","I64","LSAddDeviceStoredProcedure","LSEncryptedBackupsBackupTenancy","LSEncryptedBackupsOpStatus","LSFactory","LSIntEnum","MAWWaitForBackendSetup","MWEncryptedBackupsDeviceRegistrationId","MWEncryptedBackupsRecoveryCodeStatus","ReQL","WALogger","WAResultOrError","isInstamadilloEB","justknobx","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p=10;function _(e){var t=e.count,n=e.storage;return new Promise(function(e,a){if(t===p)return e();r("promiseDone")(o("ReQL").firstAsync(o("ReQL").fromTableAscending(n.tables.encrypted_backups)),function(r){var o=r==null?void 0:r.backupId;if(o!=null)return e(o);window.setTimeout(function(){e(_({count:t+1,storage:n}))},1e3)},function(e){return a(e)})})}function f(t){var n=t.environment,a=t.qplFlow,l=t.recoveryCode,p=t.userId,f=function(){},y=!1,C=new Promise(function(e,t){window.setTimeout(function(){y||(r("FBLogger")("wmi_eb").warn("Add device failed by timeout 90 sec"),h(a,o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_TIMEOUT),e("ADD_DEVICE_TIMEOUT"))},r("justknobx")._("4226"))}),b=new Promise(async function(t,g){a.addPoint(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_WAIT_FOR_EBLS_START);var y=await o("EBDeps").getDeps().getLSDB();a.addPoint(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_WAIT_FOR_EBLS_END),f=y.tables.secure_encrypted_backups_recovery_code_status.subscribe(function(e,n){if(n.operation!=="delete"){var i=[n.value];a.addPoint(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_CHECK_RC_STATUS),o("MWEncryptedBackupsRecoveryCodeStatus").encryptedBackupsGetRecoveryCodeStatus({onFailure:function(){h(a,o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_FAILED_TO_GET_RC_STATUS),f(),t("ADD_DEVICE_FAILED_TO_GET_RC_STATUS")},onInvalidRecoveryCode:function(){h(a,o("EBAPIQPLPoints").EBAddDeviceQPLPoints.INVALID_RECOVERY_CODE),f(),t("INVALID_RECOVERY_CODE")},onSuccess:function(){a.addPoint(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_TASK_END),a.endSuccess({bool:{isBackendSetupOnSuccess:o("EBDeps").getDeps().isBackendSetupSuccessful()}}),f(),r("promiseDone")(o("EBDeps").getDeps().trackAddingNewDevice()),t("SUCCESS")},recoveryCodeStatusData:i})}}),r("promiseDone")(_({count:0,storage:y}),function(_){if(_!=null)if(r("isInstamadilloEB")()){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[wmi][ebsm] EBAPI add device sproc start"])));var b=o("MWEncryptedBackupsDeviceRegistrationId").getDeviceRegistrationId();return b===""?(h(a,o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_FAILED_DEVICE_REGISTRATION_ID_NULL),f(),g("deviceRegistrationId is not defined")):(a.addPoint(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_SPROC_START),y.runInTransaction(function(e){return r("LSAddDeviceStoredProcedure")(r("LSFactory")(e),{backupId:_,backupTenancy:(d||(d=o("I64"))).of_int32(r("LSEncryptedBackupsBackupTenancy").PRODUCTION),deviceRegistrationId:b,recoveryCode:l})},"readwrite",void 0,void 0,i.id+":232").then(function(e){var t=e[0];if(!(d||(d=o("I64"))).equal(t,(m||(m=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsOpStatus").SUCCESS)))return h(a,o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_SPROC_FAILURE,{bool:{is_backend_setup:o("MAWWaitForBackendSetup").isBackendSetupSuccessful()}}),f(),g("Add device sproc failed");a.addPoint(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_SPROC_END),a.addPoint(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_TASK_START),o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[wmi][ebsm] EBAPI add device sproc success"])))}).catch(function(e){throw a.addAnnotations({string:{error_message:e.message}}),e}))}else{o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[wmi][ebsm] EBAPI add device gql start"]))),a.addPoint(o("EBAPIQPLPoints").EBAddDeviceGraphqlQPLPoints.ADD_DEVICE_GQL_START);var C=n!=null?o("EBAddDeviceGraphQL").addDeviceGraphQL({backupId:_,environment:n,qplFlow:a,recoveryCode:l,storage:y,userId:p}):o("EBAddDeviceGraphQL").addDeviceGraphQLWorker({backupId:_,qplFlow:a,recoveryCode:l,storage:y,userId:p});return C.then(function(e){if(e.success)a.addPoint(o("EBAPIQPLPoints").EBAddDeviceGraphqlQPLPoints.ADD_DEVICE_GQL_END),a.addPoint(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_TASK_START),o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[wmi][ebsm] EBAPI add device gql success"])));else return h(a,o("EBAPIQPLPoints").EBAddDeviceGraphqlQPLPoints.ADD_DEVICE_GQL_FAIL,{string:{fail_result:e.error}}),a.addPoint(o("EBAPIQPLPoints").EBAddDeviceGraphqlQPLPoints.ADD_DEVICE_GQL_FAIL),f(),t("ADD_DEVICE_GRAPHQL_ERROR")})}else return h(a,o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_FAILURE_BACKUP_NOT_FOUND),f(),t("ADD_DEVICE_ERROR_BACKUP_ID_NOT_DEFINED")},function(e){return r("FBLogger")("wmi_eb").catching(e).mustfix("Add device failed. Could not find backup."),h(a,o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_COULD_NOT_FIND_BACKUP,{string:{error_message:e.message}}),f(),t("ADD_DEVICE_ERROR_COULD_NOT_READ_BACKUP_TABLE")})});return Promise.race([b,C]).then(function(e){return y=!0,g(e)})}function g(e){return e==="SUCCESS"?o("WAResultOrError").makeResult():o("WAResultOrError").makeError(e)}var h=function(t,n,r){t.endFail(n,babelHelpers.extends({},r!=null?r:{},{bool:{isBackendSetupOnFail:o("EBDeps").getDeps().isBackendSetupSuccessful()}}))};l.addDeviceWithRecoveryCode=f}),98);
__d("EBAddVirtualDevice",["EBDeps","EBLogger","I64","LSEncryptedBackupsOpStatus","LSEncryptedBackupsRecoveryCodeStatus","LSIntEnum","ReQL","WAResultOrError","promiseDone","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=r("requireDeferred")("MWEncryptedBackupsCreateExtraVirtualDeviceWithRecoveryCodeData").__setRef("EBAddVirtualDevice");async function c(t){var n=t.actionType,a=t.qplFlow,i=t.recoveryCodeData;a.addPoint("add_virtual_device_get_db_start");var l=await o("EBDeps").getDeps().getLSDB();return a.addPoint("add_virtual_device_get_db_end"),a.addPoint("add_virtual_device_sproc_start"),new Promise(function(t,c){return u.onReady(function(u){var c=l.tables.secure_encrypted_backups_recovery_code_status.subscribe(function(){r("promiseDone")(o("ReQL").toArrayAsync(o("ReQL").fromTableAscending(l.tables.secure_encrypted_backups_recovery_code_status)),function(n){if(n!=null&&n.length===1){var a=n[0].recoveryCodeStatus;return(e||(e=o("I64"))).equal(a,(s||(s=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsRecoveryCodeStatus").VALID))?(c(),t(o("WAResultOrError").makeResult())):(e||(e=o("I64"))).equal(a,(s||(s=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsRecoveryCodeStatus").INVALID))?(c(),t(o("WAResultOrError").makeError("ADD_VIRTUAL_DEVICE_STATUS_INVALID"))):void 0}})});r("promiseDone")(u.initializeCreateExtraVirtualDeviceStoredProcedure(l,(e||(e=o("I64"))).of_int32(n),i),function(n){a.addPoint("add_virtual_device_sproc_end");var i=n[0];if(!(e||(e=o("I64"))).equal(i,(s||(s=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsOpStatus").SUCCESS)))return(e||(e=o("I64"))).equal(i,(s||(s=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsOpStatus").FAILURE))?(a.endFail("add_virtual_device_sproc_failure"),o("EBLogger").EBLogger().mustfix("Error while creating extra virtual device - failure"),t(o("WAResultOrError").makeError("ADD_VIRTUAL_DEVICE_STATUS_FAILURE"))):(a.addPoint("add_virtual_device_sproc_fail_unknown"),o("EBLogger").EBLogger().mustfix("Error while creating extra virtual device - unknown"),t(o("WAResultOrError").makeError("ADD_VIRTUAL_DEVICE_STATUS_UNKNOWN")))},function(){return o("EBLogger").EBLogger().mustfix("Error while creating extra virtual device."),t(o("WAResultOrError").makeError("ADD_VIRTUAL_DEVICE_ERROR"))})})})}l.addVirtualDevice=c}),98);
__d("EBDeleteBackupsOnClient",["EBAPIQPLPoints","EBDeps","EBSMAPI","QPLFlow","Random","ReQL","getErrorSafe","qpl"],(function(t,n,r,o,a,i,l){"use strict";async function e(e){var t=e.reason,n=o("Random").uint32(),a=o("QPLFlow").startQPLFlow(r("qpl")._(521485243,"1081"),{annotations:{string:{reason:t}},instanceKey:n});try{var i;a.addPoint((i=o("EBAPIQPLPoints")).EBDeleteBackupsOnClientQPLPoints.GET_DB_START);var l=await o("EBDeps").getDeps().getLSDB();a.addPoint(i.EBDeleteBackupsOnClientQPLPoints.GET_DB_END),a.addPoint(i.EBDeleteBackupsOnClientQPLPoints.TRANSACTION_START),await l.runInTransaction(async function(e){var t,n;a.addPoint((t=o("EBAPIQPLPoints")).EBDeleteBackupsOnClientQPLPoints.CLEAR_CLIENT_STATE_START);var r=await(n=o("ReQL")).toArrayAsync(n.fromTableAscending(e.secure_encrypted_backups_client_state));await Promise.all(r.map(function(t){return e.secure_encrypted_backups_client_state.delete(t.backupId)})),a.addPoint(t.EBDeleteBackupsOnClientQPLPoints.CLEAR_CLIENT_STATE_END),a.addPoint(t.EBDeleteBackupsOnClientQPLPoints.CLEAR_EPOCHS_START);var i=await n.toArrayAsync(n.fromTableAscending(e.secure_encrypted_backups_epochs));await Promise.all(i.map(function(t){return e.secure_encrypted_backups_epochs.delete(t.epochId)})),a.addPoint(t.EBDeleteBackupsOnClientQPLPoints.CLEAR_EPOCHS_END),a.addPoint(t.EBDeleteBackupsOnClientQPLPoints.CLEAR_RECOVERY_CODE_START);var l=await n.toArrayAsync(n.fromTableAscending(e.secure_encrypted_backups_generated_recovery_code));await Promise.all(l.map(function(t){return e.secure_encrypted_backups_generated_recovery_code.delete(t.pk)})),a.addPoint(t.EBDeleteBackupsOnClientQPLPoints.CLEAR_RECOVERY_CODE_END),a.addPoint(t.EBDeleteBackupsOnClientQPLPoints.CLEAR_ENCRYPTED_BACKUPS_START);var s=await n.toArrayAsync(n.fromTableAscending(e.encrypted_backups));await Promise.all(s.map(function(t){return e.encrypted_backups.put(babelHelpers.extends({},t,{backupId:void 0}))})),a.addPoint(t.EBDeleteBackupsOnClientQPLPoints.CLEAR_ENCRYPTED_BACKUPS_END),a.addPoint(t.EBDeleteBackupsOnClientQPLPoints.CLEAR_METADATA_START);var u=await n.toArrayAsync(n.fromTableAscending(e.encrypted_backups_metadata));await Promise.all(u.map(function(t){return e.encrypted_backups_metadata.delete(t.backupId)})),a.addPoint(t.EBDeleteBackupsOnClientQPLPoints.CLEAR_METADATA_END),a.addPoint(t.EBDeleteBackupsOnClientQPLPoints.CLEAR_VIRTUAL_DEVICES_START);var c=await n.toArrayAsync(n.fromTableAscending(e.encrypted_backups_virtual_devices));await Promise.all(c.map(function(t){return e.encrypted_backups_virtual_devices.delete(t.pk)})),a.addPoint(t.EBDeleteBackupsOnClientQPLPoints.CLEAR_VIRTUAL_DEVICES_END),a.addPoint(t.EBDeleteBackupsOnClientQPLPoints.CLEAR_RECOVERY_CODE_STATUS_START);var d=await n.toArrayAsync(n.fromTableAscending(e.secure_encrypted_backups_recovery_code_status));await Promise.all(d.map(function(t){return e.secure_encrypted_backups_recovery_code_status.delete(t.pk)})),a.addPoint(t.EBDeleteBackupsOnClientQPLPoints.CLEAR_RECOVERY_CODE_STATUS_END),a.addPoint(t.EBDeleteBackupsOnClientQPLPoints.CLEAR_PENDING_BACKUPS_START);var m=await n.toArrayAsync(n.fromTableAscending(e.pending_backups_context_v2));await Promise.all(m.map(async function(t){var n=t.pendingBackupTaskId;n!=null&&await e.pending_tasks.delete(n)})),a.addPoint(t.EBDeleteBackupsOnClientQPLPoints.CLEAR_PENDING_BACKUPS_END)},"readwrite"),a.addPoint(i.EBDeleteBackupsOnClientQPLPoints.TRANSACTION_END),a.addPoint(i.EBDeleteBackupsOnClientQPLPoints.FETCH_BACKUP_IDS_START),await r("EBSMAPI").fetchBackupIds("deleteBackupsOnClient"),a.addPoint(i.EBDeleteBackupsOnClientQPLPoints.FETCH_BACKUP_IDS_END),a.endSuccess()}catch(e){var s=r("getErrorSafe")(e);throw a.endFail("runtime_error",{string:{error_message:s.message}}),e}}l.deleteBackupsOnClient=e}),98);
__d("LSDeleteBackups",["LSBase64Encode.nop","LSGetBlobFromString.nop","LSHmac_v2.nop","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop","LSOcmfClientMap.nop","justknobx"],(function(t,n,r,o,a,i,l){function e(){var e=arguments,t=e[e.length-1],o=[],a=[];return t.sequence([function(i){return t.sequence([function(a){return o[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsDeleteBackupsStoredProcedure] Beginning execution."),r("justknobx")._("803")?t.sequence([function(r){return t.db.table(168).fetch([[[e[0]]]]).next().then(function(r,a){var i=r.done,l=r.value;return i?((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsDeleteBackupsStoredProcedure] Row not found in client state table for the backupidDeleting the backup without deleting mailbox"),o[9]=new t.Map,o[9].set("backup_id",e[0]),o[9].set("trace_id",e[1]),o[9].set("backup_deletion_source",e[2]),o[10]=t.toJSON(o[9]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",t.i64.cast([0,50011]),o[10],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),e[1],t.i64.cast([0,0])).then(function(e){var t;return t=e,o[11]=t[0],t})):(a=l.item,t.sequence([function(r){return o[13]=a.deviceId,t.nativeOperation(n("LSGetBlobFromString.nop"),t.i64.to_string(e[0])).then(function(e){var t;return t=e,o[9]=t[0],t})},function(e){return t.nativeOperation(n("LSHmac_v2.nop"),t.blob("bWFpbGJveF9pZF9zY29wZQ=="),o[9]).then(function(e){var t;return t=e,o[10]=t[0],t})},function(e){return t.nativeOperation(n("LSOcmfClientMap.nop"),a.ocmfClientStateBlob,o[10]).then(function(e){var t;return t=e,o[11]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[11]).then(function(e){var t;return t=e,o[12]=t[0],t})},function(r){return t.i64.neq(o[13],void 0)?(o[14]=new t.Map,o[14].set("device_id",o[13]),o[14].set("mailbox_partial_id",o[12]==null?"":o[12]),o[14].set("trace_id",e[1]),o[14].set("backup_deletion_source",e[2]),o[15]=t.toJSON(o[14]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"messenger_encrypted_backups",t.i64.cast([0,50014]),o[15],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),e[1],t.i64.cast([0,0])).then(function(e){var t;return t=e,o[16]=t[0],t})):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsDeleteBackupsStoredProcedure] device_id is null"),o[15]="device_id is null",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsDeleteBackupsStoredProcedure] ","",o[15]].join("")),o[14]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeleteBackupsStoredProcedure",o[15],o[14],t.i64.cast([0,3]))},function(r){return o[16]=new t.Map,o[16].set("backup_id",e[0]),o[16].set("trace_id",e[1]),o[16].set("backup_deletion_source",e[2]),o[17]=t.toJSON(o[16]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",t.i64.cast([0,50011]),o[17],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),e[1],t.i64.cast([0,0])).then(function(e){var t;return t=e,o[18]=t[0],t})}])}]))})},function(e){return o[1]=t.i64.cast([0,0])}]):t.resolve(((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsDeleteBackupsStoredProcedure] backup deletion flow is not enabled"),o[1]=t.i64.cast([0,1])))},function(e){return o[2]=t.i64.of_float(Date.now()),o[3]=t.i64.random(),o[5]="Finishing execution. Execution time: ",o[6]=t.i64.to_string(t.i64.sub(o[2],o[0])),o[7]=" ms",o[4]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][LSEncryptedBackupsDeleteBackupsStoredProcedure] ",o[4],o[5],o[4],o[6],o[4],o[7]].join("")),t.i64.eq(t.i64.mod_(o[3],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(o[8]=",",o[9]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeleteBackupsStoredProcedure",[o[5],o[8],o[6],o[8],o[7]].join(""),o[9],t.i64.cast([0,4]))):t.resolve()},function(e){return a[0]=o[1]}])},function(e){return t.resolve(a)}])}e.__sproc_name__="LSEncryptedBackupsDeleteBackupsStoredProcedure",e.__tables__=["secure_encrypted_backups_client_state"];var s=e;l.default=s}),98);
__d("LSDeleteBackupsStoredProcedure",["LSDeleteBackups","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSDeleteBackups"),a.backupId,a.traceId,a.backupDeletionSource);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("encryptedBackupsDeleteBackupsStoredProcedure",["LSDeleteBackupsStoredProcedure","LSEncryptedBackupsOpStatus","LSFactory","LSIntEnum","LSResult","ReQL"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,n,a){return o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.tables.encrypted_backups)).then(async function(l){var s=r("LSResult")((e||(e=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsOpStatus").FAILURE));if(l!=null){var u=l.backupId;u!=null&&(s=await t.runInTransaction(function(t){return r("LSDeleteBackupsStoredProcedure")(r("LSFactory")(t),{backupDeletionSource:(e||(e=o("LSIntEnum"))).ofNumber(n),backupId:u,traceId:a})},"readwrite",void 0,void 0,i.id+":37"))}return s})}l.default=s}),98);
__d("EBDeleteEncryptedBackup",["EBAPIQPLPoints","EBDeps","EBSMAPI","LSEncryptedBackupsOpStatus","LSIntEnum","WAResultOrError","WATagsLogger","encryptedBackupsDeleteBackupsStoredProcedure","getSafeQplErrorMessage","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=o("WATagsLogger").TAGS(["EB","EBAPIDeleteEncryptedBackup"]);async function c(t){var n=t.qplFlow,a=t.reason;n.addPoint(o("EBAPIQPLPoints").EBDeleteEBQPLPoints.DELETE_EB_GET_DB_START);var i=await o("EBDeps").getDeps().getLSDB();return n.addPoint(o("EBAPIQPLPoints").EBDeleteEBQPLPoints.DELETE_EB_GET_DB_END),n.addPoint(o("EBAPIQPLPoints").EBDeleteEBQPLPoints.DELETE_EB_SPROC_START),new Promise(function(t,l){r("encryptedBackupsDeleteBackupsStoredProcedure")(i,a,n.getQPLAttrs().instanceKey.toString()).then(function(e){var a=e[0];if(a===(s||(s=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsOpStatus").FAILURE)){n.addPoint(o("EBAPIQPLPoints").EBDeleteEBQPLPoints.DELETE_EB_SPROC_FAIL),n.endFail("delete_eb_sproc_fail"),t(o("WAResultOrError").makeError("DELETE_EB_SPROC_FAIL"));return}n.addPoint(o("EBAPIQPLPoints").EBDeleteEBQPLPoints.DELETE_EB_SPROC_SUCCESS);var l=i.tables.encrypted_backups.subscribe(function(e,a){if(a.operation==="put"){if(a.value.backupId==null)return n.addPoint(o("EBAPIQPLPoints").EBDeleteEBQPLPoints.DELETE_EB_TASK_SUCCESS),n.addPoint(o("EBAPIQPLPoints").EBDeleteEBQPLPoints.FETCH_BACKUP_IDS_START),r("promiseDone")(r("EBSMAPI").fetchBackupIds("EBDeleteEncryptedBackup"),function(){n.addPoint(o("EBAPIQPLPoints").EBDeleteEBQPLPoints.FETCH_BACKUP_IDS_END),n.endSuccess()},function(){n.addPoint(o("EBAPIQPLPoints").EBDeleteEBQPLPoints.FETCH_BACKUP_IDS_END),n.endFail("fetch_backup_ids_fail")}),t(o("WAResultOrError").makeResult()),l();n.addPoint(o("EBAPIQPLPoints").EBDeleteEBQPLPoints.DELETE_EB_NON_DELETE_OPERATION)}else n.addPoint(o("EBAPIQPLPoints").EBDeleteEBQPLPoints.DELETE_EB_NON_PUT_OPERATION)},void 0,["backupId"])}).catch(function(r){u.ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Exception while calling deleteBackups stored procedure: ",""])),r),n.addPoint(o("EBAPIQPLPoints").EBDeleteEBQPLPoints.DELETE_EB_SPROC_ERROR,{string:{error:o("getSafeQplErrorMessage").getSafeQPLErrorMessage(r)}}),n.endFail("delete_eb_sproc_error"),t(o("WAResultOrError").makeError("DELETE_EB_SPROC_ERROR"))})})}l.deleteEncryptedBackup=c}),98);
__d("EBFetchBackupIds",["EBDeps","I64","LSAuthorityLevel","LSEncryptedBackupsBackupTenancy","LSFactory","LSFetchBackupIdsStoredProcedure","LSIntEnum","MWEBODSEntityName.enum","ODS","err","justknobx","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;async function c(t,n){(e||(e=o("ODS"))).bumpEntityKey(7319,r("MWEBODSEntityName.enum").MW_EBSM_FETCH_BACKUP_IDS,t+".sproc"),n.addPoint("eb_fetch_backup_ids_get_storage_start");var a=await o("EBDeps").getDeps().getLSDB();return n.addPoint("eb_fetch_backup_ids_get_storage_ended"),new Promise(function(e,t){var i,l=a.tables.encrypted_backups.subscribe(function(t,a){if(a.operation==="delete"||!(s||(s=o("I64"))).equal(a.value.authorityLevel,(u||(u=o("LSIntEnum"))).ofNumber(r("LSAuthorityLevel").AUTHORITATIVE))){a.operation==="delete"?n.addPoint("eb_fetch_backup_ids_delete_detected"):n.addPoint("eb_fetch_backup_ids_authority_level_not_auth");return}l(),window.clearTimeout(i),n.addPoint("eb_fetch_backup_ids_success"),n.endSuccess(),e()});n.addPoint("eb_fetch_backup_ids_sproc_start"),r("promiseDone")(a.runInTransaction(function(e){return r("LSFetchBackupIdsStoredProcedure")(r("LSFactory")(e),{backupTenancy:(u||(u=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsBackupTenancy").PRODUCTION),isUiBlocking:!1}).then(function(){n.addPoint("eb_fetch_backup_ids_sproc_ended"),i=window.setTimeout(function(){n.endFail("eb_fetch_backup_ids_timeout"),t(r("err")("[wmi][ebapi] Timeout fetching backup ids"))},r("justknobx")._("3868"))})},"readwrite"))})}function d(e,t){return c(e,t)}l.fetchBackupIds=d}),98);
__d("EBGenerateRecoveryCode",["Base64Utils","EBDeps","LSEncryptedBackupsOpStatus","LSFactory","LSGenerateRecoveryCodeStoredProcedure","LSIntEnum","WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";var e;async function s(t){var n=await o("EBDeps").getDeps().getLSDB(),a=t.virtualDeviceType;return n.runInTransaction(function(e){return r("LSGenerateRecoveryCodeStoredProcedure")(r("LSFactory")(e),{virtualDeviceType:a})},"readwrite",void 0,void 0,i.id+":35").then(function(t){var n=t[0],a=t[1],i=t[2];return(e||(e=o("LSIntEnum"))).toNumber(a)!==r("LSEncryptedBackupsOpStatus").SUCCESS?o("WAResultOrError").makeError("sproc_failure"):o("WAResultOrError").makeResult({recoveryCode:n,virtualDeviceId:i!=null?o("Base64Utils").fromArrayBuffer(i):void 0})})}l.generateRecoveryCode=s}),98);
__d("EBGetEBStateQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="23909871918604871"}),null);
__d("EBGetEBStateQuery.graphql",["EBGetEBStateQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[{alias:null,args:[{kind:"Literal",name:"family_device_id",value:""}],kind:"ScalarField",name:"has_otc_eligible_devices",storageKey:'has_otc_eligible_devices(family_device_id:"")'},{alias:null,args:null,kind:"ScalarField",name:"has_seen_eb_auto_restore_notice",storageKey:null},e,{alias:null,args:null,kind:"ScalarField",name:"is_user_opted_out",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"backup_creation_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"backup_tenancy",storageKey:null},{alias:null,args:null,concreteType:"XFBEBVirtualDevice",kind:"LinkedField",name:"virtual_devices",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"device_created_on",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"device_type",storageKey:null},e,{alias:null,args:null,kind:"ScalarField",name:"migration_status",storageKey:null}],storageKey:null}],storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"backup_state",storageKey:null}]}],storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"EBGetEBStateQuery",selections:[{kind:"RequiredField",field:t,action:"LOG",path:"viewer"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"EBGetEBStateQuery",selections:[t]},params:{id:n("EBGetEBStateQuery_facebookRelayOperation"),metadata:{},name:"EBGetEBStateQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("EBGetEBState",["EBGetEBStateQuery.graphql","FBLogger","MAWOneTimeCodeGating","RelayHooks","WAResultOrError","XPlatRelayEnvironment","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e!==void 0?e:e=n("EBGetEBStateQuery.graphql");async function u(){try{var e,t,n,a,i,l,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k=await o("RelayHooks").fetchQuery(o("XPlatRelayEnvironment").getRelayEnvironment(),s,{}).toPromise().then(function(e){return e}),I=k==null||(e=k.viewer)==null?void 0:e.backup_state;if(I===1||I===0)return o("WAResultOrError").makeResult({backupStatus:I});var T=(t=k==null||(n=k.viewer)==null||(n=n.encrypted_backup)==null?void 0:n.virtual_devices)!=null?t:[],D=T.filter(function(e){return e.device_type==="HSM"}),x=T.filter(function(e){return e.device_type==="OFFLINE"});return o("WAResultOrError").makeResult({backupStatus:(k==null||(a=k.viewer)==null?void 0:a.backup_state)!=null?k.viewer.backup_state:0,ebState:{backupMetadata:{backupId:(i=k==null||(l=k.viewer)==null||(l=l.encrypted_backup)==null?void 0:l.id)!=null?i:"",creationTime:(u=k==null||(c=k.viewer)==null||(c=c.encrypted_backup)==null?void 0:c.backup_creation_time)!=null?u:0,deviceCreatedOn:(d=D[0].device_created_on)!=null?d:"",removalStatus:"",requiresHsmMigration:D[0].migration_status!=="DOES_NOT_REQUIRE_MIGRATION",virtualDeviceCreationTime:(m=(p=D[0])==null?void 0:p.creation_time)!=null?m:0,virtualDeviceId:(_=(f=D[0])==null?void 0:f.id)!=null?_:"",virtualDeviceType:(g=(h=D[0])==null?void 0:h.device_type)!=null?g:""},backupTenancy:(y=k==null||(C=k.viewer)==null||(C=C.encrypted_backup)==null?void 0:C.backup_tenancy)!=null?y:"PRODUCTION",hasOtcEligibleDevices:!!(o("MAWOneTimeCodeGating").isOneTimeCodeEnabled()&&(k==null||(b=k.viewer)==null||(b=b.encrypted_backup)==null?void 0:b.has_otc_eligible_devices)!==!1),hasSeenEbAutoRestoreNotice:(v=k==null||(S=k.viewer)==null||(S=S.encrypted_backup)==null?void 0:S.has_seen_eb_auto_restore_notice)!=null?v:!1,isPINCodeRegistered:((R=D[0])==null?void 0:R.id)!=null,isUserOptedOut:(L=k==null||(E=k.viewer)==null||(E=E.encrypted_backup)==null?void 0:E.is_user_opted_out)!=null?L:!1,offlineDevicesCount:x.length}})}catch(e){return r("FBLogger")("wmi_eb").catching(r("getErrorSafe")(e)).mustfix("Failed to check EB enabled"),o("WAResultOrError").makeResult({backupStatus:0})}}l.GetEbState=u}),98);
__d("LSOcmfClientInit_v2.nop",["CryptoLogger","LSResult","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e=r("requireDeferred")("ristretto255").__setRef("LSOcmfClientInit_v2.nop"),s=function(n,a){return e.load().then(function(e){return r("LSResult")(e.scalar.getRandom().buffer)}).catch(function(e){throw o("CryptoLogger").captureError(o("CryptoLogger").CryptoLogger("ocmf_client_init_v2"),e).mustfix("Failed to init OCMF client."),e})};s.__nop_name__="LSOcmfClientInit_v2",l.default=s}),98);
__d("LSRandom.nop",["CryptoLogger","I64","LSMaxInt32","LSResult","Promise","XPlatReactCrypto"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=function(a,i,l){var t=o("CryptoLogger").CryptoLogger("ope_encrypt");if((s||(s=o("I64"))).gt(l,r("LSMaxInt32")))return t.mustfix("numBytes '"+String(l)+"' too large. Returning an empty array"),(e||(e=n("Promise"))).resolve(r("LSResult")(new Uint8Array(0).buffer));for(var u=(s||(s=o("I64"))).to_int32(l),c=new Uint8Array(u),d=65536,m=0;m<u;m+=d){var p=c.subarray(m,m+Math.min(u-m,d));o("XPlatReactCrypto").getRandomValues(p)}return(e||(e=n("Promise"))).resolve(r("LSResult")(c.buffer))};u.__nop_name__="LSRandom",l.default=u}),98);
__d("LSGenerateInitialDeviceSetupPayload",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateAuthKeyPair.nop","LSCreateEncryptionKeyPair.nop","LSCreateSignatureKeyPair.nop","LSCreateSignature_v2.nop","LSGetBlobFromString.nop","LSHmac_v2.nop","LSIsEncryptionVersionSecure","LSLogMebClientEvent.nop","LSOcmfClientInit_v2.nop","LSOcmfClientMap.nop","LSRandom.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(e){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][generateInitialDeviceSetupPayload] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.islc(t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))||!0}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,n){var o,a,i=e.done,l=e.value;return i?(r[33]=new t.Map,r[33].set("error_msg","Expected a nonempty query result"),r[33].set("code",t.i64.cast([0,3])),r[33].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),r[34]=t.createArray(),r[35]=(r[34].push(r[33]),r[34]),o=[void 0,r[34]],r[2]=o[0],r[3]=o[1]):(n=l.item,r[33]=new t.Map,r[33].set("backup_id",n.backupId),r[33].set("device_public_key_blob",n.devicePublicKeyBlob),r[33].set("device_private_key_blob",n.devicePrivateKeyBlob),r[33].set("epoch_storage_public_key_blob",n.epochStoragePublicKeyBlob),r[33].set("epoch_storage_private_key_blob",n.epochStoragePrivateKeyBlob),r[33].set("epoch_auth_public_key_blob",n.epochAuthPublicKeyBlob),r[33].set("epoch_auth_private_key_blob",n.epochAuthPrivateKeyBlob),r[33].set("mailbox_root_key_blob",n.mailboxRootKeyBlob),r[33].set("ocmf_client_state_blob",n.ocmfClientStateBlob),r[33].set("orf_client_state_v2_blob",void 0),r[33].set("orf_v2_authority_level",void 0),r[33].set("oblivious_validation_token_blob",n.obliviousValidationTokenBlob),r[33].set("device_id",n.deviceId),r[33].set("backup_tenancy",n.backupTenancy),r[33].set("encryption_version",n.encryptionVersion),r[33].set("revision_version",n.revisionVersion),r[33].set("initialize_restore_result",void 0),r[33].set("device_creation_timestamp_sec",void 0),r[33].set("authority_level",n.authorityLevel),a=[r[33],void 0],r[2]=a[0],r[3]=a[1])})},function(e){return r[5]=new t.Map,r[5].set("value",r[2]),r[5].set("errors",r[3]),r[6]=r[5].get("value"),r[6]!==void 0?t.sequence([function(e){return r[33]=r[6].get("backup_id"),r[34]=r[6].get("device_public_key_blob"),r[35]=r[6].get("device_private_key_blob"),r[36]=r[6].get("epoch_storage_public_key_blob"),r[37]=r[6].get("epoch_storage_private_key_blob"),r[38]=r[6].get("epoch_auth_public_key_blob"),r[39]=r[6].get("epoch_auth_private_key_blob"),r[40]=r[6].get("mailbox_root_key_blob"),r[41]=r[6].get("ocmf_client_state_blob"),r[42]=r[6].get("orf_client_state_v2_blob"),r[43]=r[6].get("orf_v2_authority_level"),r[44]=r[6].get("oblivious_validation_token_blob"),r[45]=r[6].get("device_id"),r[46]=r[6].get("backup_tenancy"),r[47]=r[6].get("encryption_version"),r[48]=r[6].get("revision_version"),r[49]=r[6].get("initialize_restore_result"),r[50]=r[6].get("device_creation_timestamp_sec"),r[51]=r[6].get("authority_level"),t.i64.neq(r[45],void 0)?t.sequence([function(e){return r[70]=void 0,t.i64.neq(r[70],void 0)?t.resolve(r[71]=r[70]):t.sequence([function(e){return r[74]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,r[75]=t[0],t})},function(e){return r[75]&&(r[84]=(r[74].push(t.i64.cast([0,0])),r[74])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,r[76]=t[0],t})},function(e){return r[76]&&(r[84]=(r[74].push(t.i64.cast([0,2])),r[74])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,r[77]=t[0],t})},function(e){return r[77]&&(r[84]=(r[74].push(t.i64.cast([0,3])),r[74])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,r[78]=t[0],t})},function(e){return r[78]&&(r[84]=(r[74].push(t.i64.cast([0,4])),r[74])),r[79]=t.createArray(),r[80]=t.i64.of_int32(r[74].length),t.i64.gt(r[80],t.i64.cast([0,0]))?t.loopAsync(r[80],function(e){return r[84]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[74],r[84]).then(function(e){var t;return t=e,r[85]=t[0],r[86]=t[1],t})},function(e){return r[87]=(r[79].push(r[85]),r[79])}])}):t.resolve()},function(e){return t.sequence([function(e){return r[84]=t.createArray(),r[85]=t.i64.of_int32(r[79].length),t.i64.gt(r[85],t.i64.cast([0,0]))?t.loopAsync(r[85],function(e){return r[87]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[79],r[87]).then(function(e){var t;return t=e,r[88]=t[0],r[89]=t[1],t})},function(e){return r[90]=(r[84].push(t.i64.to_string(r[88])),r[84])}])}):t.resolve()},function(e){return r[86]=r[84].join(","),r[81]=r[86]}])},function(e){return r[79].some(function(e){return t.i64.eq(r[47],e)})?r[82]=r[47]:r[82]=void 0,t.i64.neq(r[82],void 0)?r[83]=r[82]:r[83]=void 0,r[71]=r[83]}])},function(e){var n;return t.i64.neq(r[71],void 0)?r[72]=r[71]:r[72]=t.i64.cast([0,0]),t.i64.neq(r[46],void 0)?r[73]=r[46]:r[73]=t.i64.cast([0,1]),n=[r[33],r[45],r[40],r[41],void 0,void 0,r[72],r[73],r[38],r[39],r[34],r[35],r[36],r[37],r[44],r[51],void 0,void 0],r[52]=n[0],r[53]=n[1],r[54]=n[2],r[55]=n[3],r[56]=n[4],r[57]=n[5],r[58]=n[6],r[59]=n[7],r[60]=n[8],r[61]=n[9],r[62]=n[10],r[63]=n[11],r[64]=n[12],r[65]=n[13],r[66]=n[14],r[67]=n[15],r[68]=n[16],r[69]=n[17]}]):t.sequence([function(e){return t.forEach(t.db.table(169).fetch(),function(e){return e.delete()})},function(e){return r[70]=t.i64.random(),r[71]=t.i64.random(),t.nativeOperation(n("LSCreateSignatureKeyPair.nop")).then(function(e){var t;return t=e,r[72]=t[0],r[73]=t[1],t})},function(e){return t.nativeOperation(n("LSCreateEncryptionKeyPair.nop")).then(function(e){var t;return t=e,r[74]=t[0],r[75]=t[1],t})},function(e){return t.nativeOperation(n("LSCreateAuthKeyPair.nop")).then(function(e){var t;return t=e,r[76]=t[0],r[77]=t[1],t})},function(e){return t.nativeOperation(n("LSRandom.nop"),t.i64.cast([0,32])).then(function(e){var t;return t=e,r[78]=t[0],t})},function(e){return t.nativeOperation(n("LSOcmfClientInit_v2.nop")).then(function(e){var t;return t=e,r[79]=t[0],t})},function(e){return t.nativeOperation(n("LSOcmfClientInit_v2.nop")).then(function(e){var t;return t=e,r[80]=t[0],t})},function(e){return t.nativeOperation(n("LSRandom.nop"),t.i64.cast([0,32])).then(function(e){var t;return t=e,r[81]=t[0],t})},function(e){return r[82]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,r[83]=t[0],t})},function(e){return r[83]&&(r[109]=(r[82].push(t.i64.cast([0,0])),r[82])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,r[84]=t[0],t})},function(e){return r[84]&&(r[109]=(r[82].push(t.i64.cast([0,2])),r[82])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,r[85]=t[0],t})},function(e){return r[85]&&(r[109]=(r[82].push(t.i64.cast([0,3])),r[82])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,r[86]=t[0],t})},function(e){return r[86]&&(r[109]=(r[82].push(t.i64.cast([0,4])),r[82])),r[87]=t.i64.of_int32(r[82].length),t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[82],t.i64.sub(r[87],t.i64.cast([0,1]))).then(function(e){var t;return t=e,r[88]=t[0],r[89]=t[1],t})},function(e){return t.forEach(t.filter(t.db.table(168).fetch([[[r[70]]]]),function(e){return t.i64.eq(e.backupId,r[70])&&t.i64.lt(e.authorityLevel,t.i64.cast([0,20]))}),function(e){return e.delete()})},function(e){return t.db.table(168).add({backupId:r[70],deviceId:r[71],devicePublicKeyBlob:r[73],devicePrivateKeyBlob:r[72],epochStoragePublicKeyBlob:r[75],epochStoragePrivateKeyBlob:r[74],epochAuthPublicKeyBlob:r[77],epochAuthPrivateKeyBlob:r[76],mailboxRootKeyBlob:r[78],ocmfClientStateBlob:r[79],obliviousValidationTokenBlob:r[81],authorityLevel:t.i64.cast([0,20]),encryptionVersion:r[88],revisionVersion:t.i64.cast([0,1]),backupTenancy:t.i64.cast([0,1])})},function(e){return t.islc(t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,20]))}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,o){var a,i=e.done,l=e.value;return i?(a=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,t.i64.cast([0,1]),void 0,void 0,void 0,void 0,void 0,void 0,void 0,t.i64.cast([0,20]),void 0,void 0],r[90]=a[0],r[91]=a[1],r[92]=a[2],r[93]=a[3],r[94]=a[4],r[95]=a[5],r[96]=a[6],r[97]=a[7],r[98]=a[8],r[99]=a[9],r[100]=a[10],r[101]=a[11],r[102]=a[12],r[103]=a[13],r[104]=a[14],r[105]=a[15],r[106]=a[16],r[107]=a[17],a):(o=l.item,t.sequence([function(e){return r[114]=o.backupTenancy,r[113]=o.encryptionVersion,r[109]=void 0,t.i64.neq(r[109],void 0)?t.resolve(r[110]=r[109]):t.sequence([function(e){return r[115]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,r[116]=t[0],t})},function(e){return r[116]&&(r[125]=(r[115].push(t.i64.cast([0,0])),r[115])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,r[117]=t[0],t})},function(e){return r[117]&&(r[125]=(r[115].push(t.i64.cast([0,2])),r[115])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,r[118]=t[0],t})},function(e){return r[118]&&(r[125]=(r[115].push(t.i64.cast([0,3])),r[115])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,r[119]=t[0],t})},function(e){return r[119]&&(r[125]=(r[115].push(t.i64.cast([0,4])),r[115])),r[120]=t.createArray(),r[121]=t.i64.of_int32(r[115].length),t.i64.gt(r[121],t.i64.cast([0,0]))?t.loopAsync(r[121],function(e){return r[125]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[115],r[125]).then(function(e){var t;return t=e,r[126]=t[0],r[127]=t[1],t})},function(e){return r[128]=(r[120].push(r[126]),r[120])}])}):t.resolve()},function(e){return t.sequence([function(e){return r[125]=t.createArray(),r[126]=t.i64.of_int32(r[120].length),t.i64.gt(r[126],t.i64.cast([0,0]))?t.loopAsync(r[126],function(e){return r[128]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[120],r[128]).then(function(e){var t;return t=e,r[129]=t[0],r[130]=t[1],t})},function(e){return r[131]=(r[125].push(t.i64.to_string(r[129])),r[125])}])}):t.resolve()},function(e){return r[127]=r[125].join(","),r[122]=r[127]}])},function(e){return r[120].some(function(e){return t.i64.eq(r[113],e)})?r[123]=r[113]:r[123]=void 0,t.i64.neq(r[123],void 0)?r[124]=r[123]:r[124]=void 0,r[110]=r[124]}])},function(e){var n;return t.i64.neq(r[110],void 0)?r[111]=r[110]:r[111]=t.i64.cast([0,0]),t.i64.neq(r[114],void 0)?r[112]=r[114]:r[112]=t.i64.cast([0,1]),n=[o.backupId,o.deviceId,o.mailboxRootKeyBlob,o.ocmfClientStateBlob,void 0,void 0,r[111],r[112],o.epochAuthPublicKeyBlob,o.epochAuthPrivateKeyBlob,o.devicePublicKeyBlob,o.devicePrivateKeyBlob,o.epochStoragePublicKeyBlob,o.epochStoragePrivateKeyBlob,o.obliviousValidationTokenBlob,o.authorityLevel,void 0,void 0],r[90]=n[0],r[91]=n[1],r[92]=n[2],r[93]=n[3],r[94]=n[4],r[95]=n[5],r[96]=n[6],r[97]=n[7],r[98]=n[8],r[99]=n[9],r[100]=n[10],r[101]=n[11],r[102]=n[12],r[103]=n[13],r[104]=n[14],r[105]=n[15],r[106]=n[16],r[107]=n[17]}]))})},function(e){var t;return t=[r[90],r[91],r[92],r[93],r[94],r[95],r[96],r[97],r[98],r[99],r[100],r[101],r[102],r[103],r[104],r[105],r[106],r[107]],r[52]=t[0],r[53]=t[1],r[54]=t[2],r[55]=t[3],r[56]=t[4],r[57]=t[5],r[58]=t[6],r[59]=t[7],r[60]=t[8],r[61]=t[9],r[62]=t[10],r[63]=t[11],r[64]=t[12],r[65]=t[13],r[66]=t[14],r[67]=t[15],r[68]=t[16],r[69]=t[17],t}])},function(e){var t;return t=[r[52],r[53],r[54],r[55],r[56],r[57],r[58],r[59],r[60],r[61],r[62],r[63],r[64],r[65],r[66],r[67],r[68],r[69]],r[7]=t[0],r[8]=t[1],r[9]=t[2],r[10]=t[3],r[11]=t[4],r[12]=t[5],r[13]=t[6],r[14]=t[7],r[15]=t[8],r[16]=t[9],r[17]=t[10],r[18]=t[11],r[19]=t[12],r[20]=t[13],r[21]=t[14],r[22]=t[15],r[23]=t[16],r[24]=t[17],t}]):t.sequence([function(e){return r[33]=r[5].get("errors"),r[34]=r[5].get("errors"),t.forEach(t.db.table(169).fetch(),function(e){return e.delete()})},function(e){return r[35]=t.i64.random(),r[36]=t.i64.random(),t.nativeOperation(n("LSCreateSignatureKeyPair.nop")).then(function(e){var t;return t=e,r[37]=t[0],r[38]=t[1],t})},function(e){return t.nativeOperation(n("LSCreateEncryptionKeyPair.nop")).then(function(e){var t;return t=e,r[39]=t[0],r[40]=t[1],t})},function(e){return t.nativeOperation(n("LSCreateAuthKeyPair.nop")).then(function(e){var t;return t=e,r[41]=t[0],r[42]=t[1],t})},function(e){return t.nativeOperation(n("LSRandom.nop"),t.i64.cast([0,32])).then(function(e){var t;return t=e,r[43]=t[0],t})},function(e){return t.nativeOperation(n("LSOcmfClientInit_v2.nop")).then(function(e){var t;return t=e,r[44]=t[0],t})},function(e){return t.nativeOperation(n("LSOcmfClientInit_v2.nop")).then(function(e){var t;return t=e,r[45]=t[0],t})},function(e){return t.nativeOperation(n("LSRandom.nop"),t.i64.cast([0,32])).then(function(e){var t;return t=e,r[46]=t[0],t})},function(e){return r[47]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,r[48]=t[0],t})},function(e){return r[48]&&(r[74]=(r[47].push(t.i64.cast([0,0])),r[47])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,r[49]=t[0],t})},function(e){return r[49]&&(r[74]=(r[47].push(t.i64.cast([0,2])),r[47])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,r[50]=t[0],t})},function(e){return r[50]&&(r[74]=(r[47].push(t.i64.cast([0,3])),r[47])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,r[51]=t[0],t})},function(e){return r[51]&&(r[74]=(r[47].push(t.i64.cast([0,4])),r[47])),r[52]=t.i64.of_int32(r[47].length),t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[47],t.i64.sub(r[52],t.i64.cast([0,1]))).then(function(e){var t;return t=e,r[53]=t[0],r[54]=t[1],t})},function(e){return t.forEach(t.filter(t.db.table(168).fetch([[[r[35]]]]),function(e){return t.i64.eq(e.backupId,r[35])&&t.i64.lt(e.authorityLevel,t.i64.cast([0,20]))}),function(e){return e.delete()})},function(e){return t.db.table(168).add({backupId:r[35],deviceId:r[36],devicePublicKeyBlob:r[38],devicePrivateKeyBlob:r[37],epochStoragePublicKeyBlob:r[40],epochStoragePrivateKeyBlob:r[39],epochAuthPublicKeyBlob:r[42],epochAuthPrivateKeyBlob:r[41],mailboxRootKeyBlob:r[43],ocmfClientStateBlob:r[44],obliviousValidationTokenBlob:r[46],authorityLevel:t.i64.cast([0,20]),encryptionVersion:r[53],revisionVersion:t.i64.cast([0,1]),backupTenancy:t.i64.cast([0,1])})},function(e){return t.islc(t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,20]))}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,o){var a,i=e.done,l=e.value;return i?(a=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,t.i64.cast([0,1]),void 0,void 0,void 0,void 0,void 0,void 0,void 0,t.i64.cast([0,20]),void 0,void 0],r[55]=a[0],r[56]=a[1],r[57]=a[2],r[58]=a[3],r[59]=a[4],r[60]=a[5],r[61]=a[6],r[62]=a[7],r[63]=a[8],r[64]=a[9],r[65]=a[10],r[66]=a[11],r[67]=a[12],r[68]=a[13],r[69]=a[14],r[70]=a[15],r[71]=a[16],r[72]=a[17],a):(o=l.item,t.sequence([function(e){return r[79]=o.backupTenancy,r[78]=o.encryptionVersion,r[74]=void 0,t.i64.neq(r[74],void 0)?t.resolve(r[75]=r[74]):t.sequence([function(e){return r[80]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,r[81]=t[0],t})},function(e){return r[81]&&(r[90]=(r[80].push(t.i64.cast([0,0])),r[80])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,r[82]=t[0],t})},function(e){return r[82]&&(r[90]=(r[80].push(t.i64.cast([0,2])),r[80])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,r[83]=t[0],t})},function(e){return r[83]&&(r[90]=(r[80].push(t.i64.cast([0,3])),r[80])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,r[84]=t[0],t})},function(e){return r[84]&&(r[90]=(r[80].push(t.i64.cast([0,4])),r[80])),r[85]=t.createArray(),r[86]=t.i64.of_int32(r[80].length),t.i64.gt(r[86],t.i64.cast([0,0]))?t.loopAsync(r[86],function(e){return r[90]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[80],r[90]).then(function(e){var t;return t=e,r[91]=t[0],r[92]=t[1],t})},function(e){return r[93]=(r[85].push(r[91]),r[85])}])}):t.resolve()},function(e){return t.sequence([function(e){return r[90]=t.createArray(),r[91]=t.i64.of_int32(r[85].length),t.i64.gt(r[91],t.i64.cast([0,0]))?t.loopAsync(r[91],function(e){return r[93]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[85],r[93]).then(function(e){var t;return t=e,r[94]=t[0],r[95]=t[1],t})},function(e){return r[96]=(r[90].push(t.i64.to_string(r[94])),r[90])}])}):t.resolve()},function(e){return r[92]=r[90].join(","),r[87]=r[92]}])},function(e){return r[85].some(function(e){return t.i64.eq(r[78],e)})?r[88]=r[78]:r[88]=void 0,t.i64.neq(r[88],void 0)?r[89]=r[88]:r[89]=void 0,r[75]=r[89]}])},function(e){var n;return t.i64.neq(r[75],void 0)?r[76]=r[75]:r[76]=t.i64.cast([0,0]),t.i64.neq(r[79],void 0)?r[77]=r[79]:r[77]=t.i64.cast([0,1]),n=[o.backupId,o.deviceId,o.mailboxRootKeyBlob,o.ocmfClientStateBlob,void 0,void 0,r[76],r[77],o.epochAuthPublicKeyBlob,o.epochAuthPrivateKeyBlob,o.devicePublicKeyBlob,o.devicePrivateKeyBlob,o.epochStoragePublicKeyBlob,o.epochStoragePrivateKeyBlob,o.obliviousValidationTokenBlob,o.authorityLevel,void 0,void 0],r[55]=n[0],r[56]=n[1],r[57]=n[2],r[58]=n[3],r[59]=n[4],r[60]=n[5],r[61]=n[6],r[62]=n[7],r[63]=n[8],r[64]=n[9],r[65]=n[10],r[66]=n[11],r[67]=n[12],r[68]=n[13],r[69]=n[14],r[70]=n[15],r[71]=n[16],r[72]=n[17]}]))})},function(e){var t;return t=[r[55],r[56],r[57],r[58],r[59],r[60],r[61],r[62],r[63],r[64],r[65],r[66],r[67],r[68],r[69],r[70],r[71],r[72]],r[7]=t[0],r[8]=t[1],r[9]=t[2],r[10]=t[3],r[11]=t[4],r[12]=t[5],r[13]=t[6],r[14]=t[7],r[15]=t[8],r[16]=t[9],r[17]=t[10],r[18]=t[11],r[19]=t[12],r[20]=t[13],r[21]=t[14],r[22]=t[15],r[23]=t[16],r[24]=t[17],t}])},function(o){var a;return t.i64.neq(r[7],void 0)?t.sequence([function(o){var a;return t.blobs.neq(r[18],void 0)?t.sequence([function(o){var a;return t.blobs.neq(r[17],void 0)?t.sequence([function(o){var a;return t.blobs.neq(r[19],void 0)?t.sequence([function(o){var a;return t.blobs.neq(r[15],void 0)?t.sequence([function(o){var a;return t.blobs.neq(r[10],void 0)?t.sequence([function(o){var a;return t.blobs.neq(r[9],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSCreateSignature_v2.nop"),r[18],t.blob("MA=="),r[19]).then(function(e){var t;return t=e,r[45]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateSignature_v2.nop"),r[18],t.blob("MQ=="),r[15]).then(function(e){var t;return t=e,r[46]=t[0],t})},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),t.i64.to_string(r[7])).then(function(e){var t;return t=e,r[47]=t[0],t})},function(e){return t.nativeOperation(n("LSHmac_v2.nop"),t.blob("bWFpbGJveF9pZF9zY29wZQ=="),r[47]).then(function(e){var t;return t=e,r[48]=t[0],t})},function(e){return t.nativeOperation(n("LSOcmfClientMap.nop"),r[10],r[48]).then(function(e){var t;return t=e,r[49]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[49]).then(function(e){var t;return t=e,r[50]=t[0],t})},function(n){var o;return r[51]=new t.Map,r[51].set("optimistic_backup_id",r[7]),r[51].set("device_private_key",r[18]),r[51].set("device_public_key",r[17]),r[51].set("epoch_storage_public_key",r[19]),r[51].set("epoch_storage_public_key_sig",r[45]==null?t.blob("bnVsbA=="):r[45]),r[51].set("epoch_auth_public_key",r[15]),r[51].set("epoch_auth_public_key_sig",r[46]==null?t.blob("bnVsbA=="):r[46]),r[51].set("ocmf_client_state",r[10]),r[51].set("mailbox_partial_id",r[50]==null?"":r[50]),r[51].set("mailbox_root_key",r[9]),r[51].set("device_registration_id",e[0]),r[51].set("orf_client_state_v2",void 0),o=[r[51],void 0],r[43]=o[0],r[44]=o[1]}]):t.resolve((r[45]=new t.Map,r[45].set("error_code",t.i64.cast([0,9])),r[45].set("stored_procedure","LSEncryptedBackupsGenerateInitialDeviceSetupPayloadStoredProcedure"),r[45].set("error_message",""),a=[void 0,r[45]],r[43]=a[0],r[44]=a[1]))},function(e){var t;return t=[r[43],r[44]],r[41]=t[0],r[42]=t[1],t}]):t.resolve((r[43]=new t.Map,r[43].set("error_code",t.i64.cast([0,9])),r[43].set("stored_procedure","LSEncryptedBackupsGenerateInitialDeviceSetupPayloadStoredProcedure"),r[43].set("error_message",""),a=[void 0,r[43]],r[41]=a[0],r[42]=a[1]))},function(e){var t;return t=[r[41],r[42]],r[39]=t[0],r[40]=t[1],t}]):t.resolve((r[41]=new t.Map,r[41].set("error_code",t.i64.cast([0,9])),r[41].set("stored_procedure","LSEncryptedBackupsGenerateInitialDeviceSetupPayloadStoredProcedure"),r[41].set("error_message",""),a=[void 0,r[41]],r[39]=a[0],r[40]=a[1]))},function(e){var t;return t=[r[39],r[40]],r[37]=t[0],r[38]=t[1],t}]):t.resolve((r[39]=new t.Map,r[39].set("error_code",t.i64.cast([0,9])),r[39].set("stored_procedure","LSEncryptedBackupsGenerateInitialDeviceSetupPayloadStoredProcedure"),r[39].set("error_message",""),a=[void 0,r[39]],r[37]=a[0],r[38]=a[1]))},function(e){var t;return t=[r[37],r[38]],r[35]=t[0],r[36]=t[1],t}]):t.resolve((r[37]=new t.Map,r[37].set("error_code",t.i64.cast([0,9])),r[37].set("stored_procedure","LSEncryptedBackupsGenerateInitialDeviceSetupPayloadStoredProcedure"),r[37].set("error_message",""),a=[void 0,r[37]],r[35]=a[0],r[36]=a[1]))},function(e){var t;return t=[r[35],r[36]],r[33]=t[0],r[34]=t[1],t}]):t.resolve((r[35]=new t.Map,r[35].set("error_code",t.i64.cast([0,9])),r[35].set("stored_procedure","LSEncryptedBackupsGenerateInitialDeviceSetupPayloadStoredProcedure"),r[35].set("error_message",""),a=[void 0,r[35]],r[33]=a[0],r[34]=a[1]))},function(e){var t;return t=[r[33],r[34]],r[25]=t[0],r[26]=t[1],t}]):t.resolve((r[33]=new t.Map,r[33].set("error_code",t.i64.cast([0,9])),r[33].set("stored_procedure","LSEncryptedBackupsGenerateInitialDeviceSetupPayloadStoredProcedure"),r[33].set("error_message",""),a=[void 0,r[33]],r[25]=a[0],r[26]=a[1]))},function(e){return r[27]=t.i64.of_float(Date.now()),r[28]=t.i64.random(),r[30]="Finishing execution. Execution time: ",r[31]=t.i64.to_string(t.i64.sub(r[27],r[0])),r[32]=" ms",r[29]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][generateInitialDeviceSetupPayload] ",r[29],r[30],r[29],r[31],r[29],r[32]].join("")),t.i64.eq(t.i64.mod_(r[28],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[33]=",",r[34]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"generateInitialDeviceSetupPayload",[r[30],r[33],r[31],r[33],r[32]].join(""),r[34],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[r[25],r[26]],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsGenerateInitialDeviceSetupPayloadStoredProcedure",e.__tables__=["secure_encrypted_backups_client_state","secure_encrypted_backups_epochs"],a.exports=e}),null);
__d("LSGenerateInitialEpochSetupPayload",["LSCreateMinosEpochParams.nop","LSCreateSymmetricEncryptionSecretKey.nop","LSGetNextEpochAnonId.nop","LSLogMebClientEvent.nop","LSStoreEpoch","gkx"],(function(t,n,r,o,a,i,l){function e(){var e=arguments,t=e[e.length-1],o=[],a=[];return t.sequence([function(i){return t.sequence([function(a){return o[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][generateInitialEpochSetupPayload] Beginning execution."),o[1]=t.i64.of_float(Date.now()),t.filter(t.db.table(169).fetch(),function(e){return t.i64.eq(e.epochStatus,t.i64.cast([0,1]))&&t.i64.eq(e.authorityLevel,t.i64.cast([0,20]))}).next().then(function(a,i){var l,s=a.done,u=a.value;return s?t.sequence([function(e){return(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialEpochSetupPayloadStoredProcedure] Generating new initial epoch."),t.nativeOperation(n("LSGetNextEpochAnonId.nop"),void 0).then(function(e){var t;return t=e,o[16]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateSymmetricEncryptionSecretKey.nop")).then(function(e){var t;return t=e,o[17]=t[0],t})},function(e){return r("gkx")("11690")&&r("gkx")("16269")?t.sequence([function(e){return t.nativeOperation(n("LSCreateMinosEpochParams.nop"),o[17],o[16],void 0,void 0,void 0).then(function(e){var t;return t=e,o[20]=t[0],o[21]=t[1],o[22]=t[2],o[23]=t[3],o[24]=t[4],o[25]=t[5],t})},function(e){return o[18]=o[23]}]):t.resolve(o[18]=void 0)},function(r){return o[19]=t.i64.random(),t.storedProcedure(n("LSStoreEpoch"),o[19],e[0],o[16],o[17],t.i64.cast([0,1]),t.i64.cast([0,20]),!1,o[18])},function(e){var t;return t=[o[19],o[16],o[17],void 0,void 0,o[18]],o[2]=t[0],o[3]=t[1],o[4]=t[2],o[5]=t[3],o[6]=t[4],o[7]=t[5],t}]):(i=u.item,(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialEpochSetupPayloadStoredProcedure] Using local optimistic initial epoch."),l=[i.epochId,i.epochAnonIdBlob,i.epochRootKeyBlob,void 0,void 0,i.epochHead],o[2]=l[0],o[3]=l[1],o[4]=l[2],o[5]=l[3],o[6]=l[4],o[7]=l[5])})},function(e){return o[9]=new t.Map,o[9].set("optimistic_epoch_id",o[2]),o[9].set("epoch_anon_id",o[3]),o[9].set("epoch_root_key",o[4]),o[10]=t.i64.of_float(Date.now()),o[11]=t.i64.random(),o[13]="Finishing execution. Execution time: ",o[14]=t.i64.to_string(t.i64.sub(o[10],o[0])),o[15]=" ms",o[12]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][generateInitialEpochSetupPayload] ",o[12],o[13],o[12],o[14],o[12],o[15]].join("")),t.i64.eq(t.i64.mod_(o[11],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(o[16]=",",o[17]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"generateInitialEpochSetupPayload",[o[13],o[16],o[14],o[16],o[15]].join(""),o[17],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[o[9],void 0],a[0]=t[0],a[1]=t[1],t}])},function(e){return t.resolve(a)}])}e.__sproc_name__="LSEncryptedBackupsGenerateInitialEpochSetupPayloadStoredProcedure",e.__tables__=["secure_encrypted_backups_epochs"];var s=e;l.default=s}),98);
__d("LSGenerateInitialVirtualDeviceSetupPayload",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSCreateEncryptionKeyPair.nop","LSCreateSignatureKeyPair.nop","LSCreateSignature_v2.nop","LSGetBlobFromString.nop","LSGetOpenEpochKeys","LSGetViewerFBID","LSHandleCreateVirtualDeviceFailure","LSHmac_v2.nop","LSIsEncryptionVersionSecure","LSLogMebClientEvent.nop","LSOcmfClientEvolve_v2.nop","LSParseRecoveryCode_v2.nop","LSSymmetricEncryptionCreateEncryptedString.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][generateInitialVirtualDeviceSetupPayload] Beginning execution."),r[1]=t.i64.of_float(Date.now()),e[1]!==void 0?t.sequence([function(o){return r[10]=e[1].get("recovery_code"),r[11]=e[1].get("virtual_device_type"),r[12]=e[1].get("cloud_service_account"),r[13]=e[1].get("hsm_pin_normalization_status"),r[14]=e[1].get("security_question_type"),r[15]=e[1].get("trusted_contact_id"),r[16]=t.createArray(),t.storedProcedure(n("LSGetViewerFBID")).then(function(e){var t;return t=e,r[17]=t[0],t})},function(e){return t.nativeOperation(n("LSParseRecoveryCode_v2.nop"),r[10],t.i64.to_string(r[17]),r[16]).then(function(e){var t;return t=e,r[18]=t[0],r[19]=t[1],t})},function(o){return t.blobs.neq(r[19],void 0)?t.sequence([function(o){return t.blobs.neq(r[18],void 0)?t.sequence([function(e){return t.storedProcedure(n("LSGetOpenEpochKeys"),!0).then(function(e){var t;return t=e,r[24]=t[0],t})},function(o){return r[24]!==void 0?t.sequence([function(e){return t.islc(t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))||!0}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,n){var o,a,i=e.done,l=e.value;return i?(r[34]=new t.Map,r[34].set("error_msg","Expected a nonempty query result"),r[34].set("code",t.i64.cast([0,3])),r[34].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),r[35]=t.createArray(),r[36]=(r[35].push(r[34]),r[35]),o=[void 0,r[35]],r[27]=o[0],r[28]=o[1]):(n=l.item,r[34]=new t.Map,r[34].set("backup_id",n.backupId),r[34].set("device_public_key_blob",n.devicePublicKeyBlob),r[34].set("device_private_key_blob",n.devicePrivateKeyBlob),r[34].set("epoch_storage_public_key_blob",n.epochStoragePublicKeyBlob),r[34].set("epoch_storage_private_key_blob",n.epochStoragePrivateKeyBlob),r[34].set("epoch_auth_public_key_blob",n.epochAuthPublicKeyBlob),r[34].set("epoch_auth_private_key_blob",n.epochAuthPrivateKeyBlob),r[34].set("mailbox_root_key_blob",n.mailboxRootKeyBlob),r[34].set("ocmf_client_state_blob",n.ocmfClientStateBlob),r[34].set("orf_client_state_v2_blob",void 0),r[34].set("orf_v2_authority_level",void 0),r[34].set("oblivious_validation_token_blob",n.obliviousValidationTokenBlob),r[34].set("device_id",n.deviceId),r[34].set("backup_tenancy",n.backupTenancy),r[34].set("encryption_version",n.encryptionVersion),r[34].set("revision_version",n.revisionVersion),r[34].set("initialize_restore_result",void 0),r[34].set("device_creation_timestamp_sec",void 0),r[34].set("authority_level",n.authorityLevel),a=[r[34],void 0],r[27]=a[0],r[28]=a[1])})},function(e){var o;return r[30]=new t.Map,r[30].set("value",r[27]),r[30].set("errors",r[28]),r[31]=r[30].get("value"),r[31]!==void 0?t.sequence([function(e){var o;return r[34]=r[31].get("backup_id"),r[35]=r[31].get("device_public_key_blob"),r[36]=r[31].get("device_private_key_blob"),r[37]=r[31].get("epoch_storage_public_key_blob"),r[38]=r[31].get("epoch_storage_private_key_blob"),r[39]=r[31].get("epoch_auth_public_key_blob"),r[40]=r[31].get("epoch_auth_private_key_blob"),r[41]=r[31].get("mailbox_root_key_blob"),r[42]=r[31].get("ocmf_client_state_blob"),r[43]=r[31].get("orf_client_state_v2_blob"),r[44]=r[31].get("orf_v2_authority_level"),r[45]=r[31].get("oblivious_validation_token_blob"),r[46]=r[31].get("device_id"),r[47]=r[31].get("backup_tenancy"),r[48]=r[31].get("encryption_version"),r[49]=r[31].get("revision_version"),r[50]=r[31].get("initialize_restore_result"),r[51]=r[31].get("device_creation_timestamp_sec"),r[52]=r[31].get("authority_level"),t.i64.neq(r[46],void 0)?t.sequence([function(e){return r[55]=void 0,t.i64.neq(r[55],void 0)?t.resolve(r[56]=r[55]):t.sequence([function(e){return r[107]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,r[108]=t[0],t})},function(e){return r[108]&&(r[117]=(r[107].push(t.i64.cast([0,0])),r[107])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,r[109]=t[0],t})},function(e){return r[109]&&(r[117]=(r[107].push(t.i64.cast([0,2])),r[107])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,r[110]=t[0],t})},function(e){return r[110]&&(r[117]=(r[107].push(t.i64.cast([0,3])),r[107])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,r[111]=t[0],t})},function(e){return r[111]&&(r[117]=(r[107].push(t.i64.cast([0,4])),r[107])),r[112]=t.createArray(),r[113]=t.i64.of_int32(r[107].length),t.i64.gt(r[113],t.i64.cast([0,0]))?t.loopAsync(r[113],function(e){return r[117]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[107],r[117]).then(function(e){var t;return t=e,r[118]=t[0],r[119]=t[1],t})},function(e){return r[120]=(r[112].push(r[118]),r[112])}])}):t.resolve()},function(e){return t.sequence([function(e){return r[117]=t.createArray(),r[118]=t.i64.of_int32(r[112].length),t.i64.gt(r[118],t.i64.cast([0,0]))?t.loopAsync(r[118],function(e){return r[120]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[112],r[120]).then(function(e){var t;return t=e,r[121]=t[0],r[122]=t[1],t})},function(e){return r[123]=(r[117].push(t.i64.to_string(r[121])),r[117])}])}):t.resolve()},function(e){return r[119]=r[117].join(","),r[114]=r[119]}])},function(e){return r[112].some(function(e){return t.i64.eq(r[48],e)})?r[115]=r[48]:r[115]=void 0,t.i64.neq(r[115],void 0)?r[116]=r[115]:r[116]=void 0,r[56]=r[116]}])},function(e){return t.i64.neq(r[56],void 0)?r[57]=r[56]:r[57]=t.i64.cast([0,0]),t.i64.neq(r[47],void 0)?r[58]=r[47]:r[58]=t.i64.cast([0,1]),t.nativeOperation(n("LSCreateSignatureKeyPair.nop")).then(function(e){var t;return t=e,r[59]=t[0],r[60]=t[1],t})},function(e){return t.nativeOperation(n("LSCreateEncryptionKeyPair.nop")).then(function(e){var t;return t=e,r[61]=t[0],r[62]=t[1],t})},function(e){return t.nativeOperation(n("LSCreateSignature_v2.nop"),r[59],t.blob("MA=="),r[62]).then(function(e){var t;return t=e,r[63]=t[0],t})},function(e){return r[64]=r[24].get("epoch_anon_id"),r[65]=r[24].get("epoch_root_key"),r[66]=t.createArray(),r[107]=(r[66].push(t.i64.cast([0,32])),r[66]),t.nativeOperation(n("LSBase64Encode.nop"),r[64]).then(function(e){var t;return t=e,r[67]=t[0],t})},function(e){return r[67]!==void 0?t.sequence([function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blobs.of_string(["epoch_devices","_",r[67]].join("")),void 0,r[65],r[66]).then(function(e){var t;return t=e,r[107]=t[0],t})},function(e){return r[107]?r[108]=!1:r[108]=!0,r[108]?t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish"),r[111]="THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoEpochUtils] ","",r[111]].join("")),r[110]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils",r[111],r[110],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,r[112]=t[0],t})},function(e){return r[109]=r[112]}]):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[107],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[110]=t[0],r[111]=t[1],t})},function(e){return r[109]=r[110]}])},function(e){return r[68]=r[109]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish"),r[108]="THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoEpochUtils] ","",r[108]].join("")),r[107]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils",r[108],r[107],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,r[109]=t[0],t})},function(e){return r[68]=r[109]}])},function(e){return t.nativeOperation(n("LSHmac_v2.nop"),r[68],r[60]).then(function(e){var t;return t=e,r[69]=t[0],t})},function(e){return t.blobs.neq(r[69],void 0)?t.resolve(r[70]=r[69]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] device_epoch_hmac is null!"),r[108]="device_epoch_hmac is null!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[108]].join("")),r[107]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[108],r[107],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,r[109]=t[0],t})},function(e){return r[70]=r[109]}])},function(e){return r[71]=r[24].get("epoch_root_key"),r[72]=t.createArray(),r[107]=(r[72].push(t.i64.cast([0,18])),r[72]),t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,r[71],r[72]).then(function(e){var t;return t=e,r[73]=t[0],t})},function(e){return r[73]!==void 0?t.sequence([function(e){return r[107]=t.i64.of_int32(r[73].length),t.i64.ge(r[107],t.i64.cast([0,1]))?t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[73],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[109]=t[0],r[110]=t[1],t})},function(e){return r[108]=r[109]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),r[110]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBFingerprint] ","",r[110]].join("")),r[109]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBFingerprint",r[110],r[109],t.i64.cast([0,3]))},function(e){return r[108]=void 0}])},function(e){return r[74]=r[108]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),r[108]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBFingerprint] ","",r[108]].join("")),r[107]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBFingerprint",r[108],r[107],t.i64.cast([0,3]))},function(e){return r[74]=void 0}])},function(e){return t.blobs.neq(r[74],void 0)?r[75]=!0:r[75]=!1,r[75]||((function(e){t.logger(e).mustfix(e)})("LS::assert is failed. Attempting to coerce a null value to nonnull."),t.throw("LS::assert is failed. Attempting to coerce a null value to nonnull.")),t.nativeOperation(n("LSOcmfClientEvolve_v2.nop"),r[42]).then(function(e){var t;return t=e,r[76]=t[0],r[77]=t[1],t})},function(e){var o;return t.blobs.neq(void 0,void 0)?t.sequence([function(e){return t.nativeOperation(n("LSOcmfClientEvolve_v2.nop"),void 0).then(function(e){var t;return t=e,r[107]=t[0],r[108]=t[1],t})},function(e){var t;return t=[r[76],r[77],r[107],r[108]],r[78]=t[0],r[79]=t[1],r[80]=t[2],r[81]=t[3],t}]):t.resolve((o=[r[76],r[77],void 0,void 0],r[78]=o[0],r[79]=o[1],r[80]=o[2],r[81]=o[3],o))},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[59]).then(function(e){var t;return t=e,r[82]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),r[19],t.blob("dmlydHVhbF9kZXZpY2U6dmlydHVhbF9kZXZpY2VfcHJpdmF0ZV9rZXk="),r[82]==null?"":r[82]).then(function(e){var t;return t=e,r[83]=t[0],t})},function(e){return r[83]!==void 0?r[84]=r[83]:r[84]="",r[84]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] encrypted_device_private_key is empty!"),r[108]="encrypted_device_private_key is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[108]].join("")),r[107]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[108],r[107],t.i64.cast([0,3]))):t.resolve()},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[61]).then(function(e){var t;return t=e,r[85]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),r[19],t.blob("dmlydHVhbF9kZXZpY2U6ZXBvY2hfc3RvcmFnZV9wcml2YXRlX2tleQ=="),r[85]==null?"":r[85]).then(function(e){var t;return t=e,r[86]=t[0],t})},function(e){return r[86]!==void 0?r[87]=r[86]:r[87]="",r[87]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] encrypted_epoch_storage_private_key is empty!"),r[108]="encrypted_epoch_storage_private_key is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[108]].join("")),r[107]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[108],r[107],t.i64.cast([0,3]))):t.resolve()},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[78]).then(function(e){var t;return t=e,r[88]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),r[19],t.blob("dmlydHVhbF9kZXZpY2U6b2NtZl9jbGllbnRfc3RhdGU="),r[88]==null?"":r[88]).then(function(e){var t;return t=e,r[89]=t[0],t})},function(e){return r[89]!==void 0?r[90]=r[89]:r[90]="",r[90]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] encrypted_orf_client_state_v1_shape is empty!"),r[108]="encrypted_orf_client_state_v1_shape is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[108]].join("")),r[107]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[108],r[107],t.i64.cast([0,3]))):t.resolve()},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[45]).then(function(e){var t;return t=e,r[91]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),r[19],t.blob("dmlydHVhbF9kZXZpY2U6b2JsaXZpb3VzX3ZhbGlkYXRpb25fdG9rZW4="),r[91]==null?"":r[91]).then(function(e){var t;return t=e,r[92]=t[0],t})},function(e){return r[92]!==void 0?r[93]=r[92]:r[93]="",r[93]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] encrypted_oblivious_validation_token is empty!"),r[108]="encrypted_oblivious_validation_token is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[108]].join("")),r[107]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[108],r[107],t.i64.cast([0,3]))):t.resolve()},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[41]).then(function(e){var t;return t=e,r[94]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),r[19],t.blob("dmlydHVhbF9kZXZpY2U6bWFpbGJveF9yb290X2tleQ=="),r[94]==null?"":r[94]).then(function(e){var t;return t=e,r[95]=t[0],t})},function(e){return r[95]!==void 0?r[96]=r[95]:r[96]="",r[96]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] encrypted_mailbox_root_key is empty!"),r[108]="encrypted_mailbox_root_key is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[108]].join("")),r[107]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[108],r[107],t.i64.cast([0,3]))):t.resolve()},function(e){return r[97]=r[24].get("epoch_anon_id"),t.nativeOperation(n("LSBase64Encode.nop"),r[97]).then(function(e){var t;return t=e,r[98]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),r[19],t.blob("dmlydHVhbF9kZXZpY2U6ZXBvY2hfYW5vbl9pZA=="),r[98]==null?"":r[98]).then(function(e){var t;return t=e,r[99]=t[0],t})},function(e){return r[99]!==void 0?r[100]=r[99]:r[100]="",r[100]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] encrypted_epoch_anon_id is empty!"),r[108]="encrypted_epoch_anon_id is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[108]].join("")),r[107]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[108],r[107],t.i64.cast([0,3]))):t.resolve()},function(e){return r[101]=r[24].get("epoch_root_key"),t.nativeOperation(n("LSBase64Encode.nop"),r[101]).then(function(e){var t;return t=e,r[102]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),r[19],t.blob("dmlydHVhbF9kZXZpY2U6ZXBvY2hfcm9vdF9rZXk="),r[102]==null?"":r[102]).then(function(e){var t;return t=e,r[103]=t[0],t})},function(e){return r[103]!==void 0?r[104]=r[103]:r[104]="",r[104]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] encrypted_epoch_root_key is empty!"),r[108]="encrypted_epoch_root_key is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[108]].join("")),r[107]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[108],r[107],t.i64.cast([0,3]))):t.resolve()},function(e){var n;return r[105]=new t.Map,r[105].set("encrypted_device_private_key",r[84]),r[105].set("encrypted_epoch_storage_private_key",r[87]),r[105].set("encrypted_ocmf_client_state",r[90]),r[105].set("encrypted_orf_client_state_v2",void 0),r[105].set("encrypted_oblivious_validation_token_blob",r[93]),r[105].set("encrypted_mailbox_root_key_blob",r[96]),r[105].set("encrypted_epoch_anon_id",r[100]),r[105].set("encrypted_epoch_root_key",r[104]),r[106]=new t.Map,r[106].set("virtual_device_public_key",r[60]),r[106].set("virtual_device_id",r[18]),r[106].set("virtual_device_epoch_storage_public_key",r[62]),r[106].set("virtual_device_epoch_storage_public_key_sig",r[63]==null?t.blob("bnVsbA=="):r[63]),r[106].set("device_epoch_hmac",r[70]),r[106].set("epoch_root_key_fingerprint",r[74]),r[106].set("virtual_device_type",r[11]),r[106].set("action_type",t.i64.cast([0,1])),r[106].set("ocmf_rotation_token",r[79]),r[106].set("encrypted_secret_values_payload",r[105]),r[106].set("cloud_service_account",r[12]),r[106].set("hsm_pin_normalization_status",r[13]),r[106].set("security_question_type",r[14]),r[106].set("trusted_contact_id",r[15]),n=[r[106],void 0],r[53]=n[0],r[54]=n[1]}]):t.resolve((r[55]=new t.Map,r[55].set("error_code",t.i64.cast([0,9])),r[55].set("stored_procedure","LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure"),r[55].set("error_message",""),o=[void 0,r[55]],r[53]=o[0],r[54]=o[1]))},function(e){var t;return t=[r[53],r[54]],r[32]=t[0],r[33]=t[1],t}]):t.resolve((r[34]=r[30].get("errors"),r[35]=r[30].get("errors"),r[36]=new t.Map,r[36].set("error_code",t.i64.cast([0,9])),r[36].set("stored_procedure","LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure"),r[36].set("error_message",""),o=[void 0,r[36]],r[32]=o[0],r[33]=o[1]))},function(e){var t;return t=[r[32],r[33]],r[25]=t[0],r[26]=t[1],t}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] Epoch keys are unavailable."),r[28]="Epoch keys are unavailable.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[28]].join("")),r[27]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[28],r[27],t.i64.cast([0,3]))},function(r){return t.storedProcedure(n("LSHandleCreateVirtualDeviceFailure"),e[0],!0,void 0)},function(e){var n;return r[29]=new t.Map,r[29].set("error_code",t.i64.cast([0,11])),r[29].set("stored_procedure","LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure"),r[29].set("error_message",""),n=[void 0,r[29]],r[25]=n[0],r[26]=n[1]}])},function(e){var t;return t=[r[25],r[26]],r[22]=t[0],r[23]=t[1],t}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] Invalid Recovery Code Provided"),r[25]="Invalid Recovery Code Provided",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[25]].join("")),r[24]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[25],r[24],t.i64.cast([0,3]))},function(r){return t.storedProcedure(n("LSHandleCreateVirtualDeviceFailure"),e[0],!0,void 0)},function(e){var n;return r[26]=new t.Map,r[26].set("error_code",t.i64.cast([0,10])),r[26].set("stored_procedure","LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure"),r[26].set("error_message",""),n=[void 0,r[26]],r[22]=n[0],r[23]=n[1]}])},function(e){var t;return t=[r[22],r[23]],r[20]=t[0],r[21]=t[1],t}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] Invalid Recovery Code Provided"),r[23]="Invalid Recovery Code Provided",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[23]].join("")),r[22]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[23],r[22],t.i64.cast([0,3]))},function(r){return t.storedProcedure(n("LSHandleCreateVirtualDeviceFailure"),e[0],!0,void 0)},function(e){var n;return r[24]=new t.Map,r[24].set("error_code",t.i64.cast([0,10])),r[24].set("stored_procedure","LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure"),r[24].set("error_message",""),n=[void 0,r[24]],r[20]=n[0],r[21]=n[1]}])},function(e){var t;return t=[r[20],r[21]],r[2]=t[0],r[3]=t[1],t}]):t.sequence([function(o){return t.db.table(174).fetch([[[t.i64.cast([0,1])]]]).next().then(function(o,a){var i=o.done,l=o.value;return i?t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] No recovery code found in recovery code table"),r[14]="No recovery code found in recovery code table",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[14]].join("")),r[13]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[14],r[13],t.i64.cast([0,3]))},function(r){return t.storedProcedure(n("LSHandleCreateVirtualDeviceFailure"),e[0],!0,void 0)},function(e){var n;return r[15]=new t.Map,r[15].set("error_code",t.i64.cast([0,501])),r[15].set("stored_procedure","LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure"),r[15].set("error_message",""),n=[void 0,r[15]],r[10]=n[0],r[11]=n[1]}]):(a=l.item,t.sequence([function(e){return r[13]=t.createArray(),t.storedProcedure(n("LSGetViewerFBID")).then(function(e){var t;return t=e,r[14]=t[0],t})},function(e){return t.nativeOperation(n("LSParseRecoveryCode_v2.nop"),a.recoveryCode,t.i64.to_string(r[14]),r[13]).then(function(e){var t;return t=e,r[15]=t[0],r[16]=t[1],t})},function(o){return t.blobs.neq(r[16],void 0)?t.sequence([function(o){return t.blobs.neq(r[15],void 0)?t.sequence([function(e){return t.storedProcedure(n("LSGetOpenEpochKeys"),!0).then(function(e){var t;return t=e,r[21]=t[0],t})},function(o){return r[21]!==void 0?t.sequence([function(e){return t.islc(t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))||!0}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,n){var o,a,i=e.done,l=e.value;return i?(r[31]=new t.Map,r[31].set("error_msg","Expected a nonempty query result"),r[31].set("code",t.i64.cast([0,3])),r[31].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),r[32]=t.createArray(),r[33]=(r[32].push(r[31]),r[32]),o=[void 0,r[32]],r[24]=o[0],r[25]=o[1]):(n=l.item,r[31]=new t.Map,r[31].set("backup_id",n.backupId),r[31].set("device_public_key_blob",n.devicePublicKeyBlob),r[31].set("device_private_key_blob",n.devicePrivateKeyBlob),r[31].set("epoch_storage_public_key_blob",n.epochStoragePublicKeyBlob),r[31].set("epoch_storage_private_key_blob",n.epochStoragePrivateKeyBlob),r[31].set("epoch_auth_public_key_blob",n.epochAuthPublicKeyBlob),r[31].set("epoch_auth_private_key_blob",n.epochAuthPrivateKeyBlob),r[31].set("mailbox_root_key_blob",n.mailboxRootKeyBlob),r[31].set("ocmf_client_state_blob",n.ocmfClientStateBlob),r[31].set("orf_client_state_v2_blob",void 0),r[31].set("orf_v2_authority_level",void 0),r[31].set("oblivious_validation_token_blob",n.obliviousValidationTokenBlob),r[31].set("device_id",n.deviceId),r[31].set("backup_tenancy",n.backupTenancy),r[31].set("encryption_version",n.encryptionVersion),r[31].set("revision_version",n.revisionVersion),r[31].set("initialize_restore_result",void 0),r[31].set("device_creation_timestamp_sec",void 0),r[31].set("authority_level",n.authorityLevel),a=[r[31],void 0],r[24]=a[0],r[25]=a[1])})},function(e){var o;return r[27]=new t.Map,r[27].set("value",r[24]),r[27].set("errors",r[25]),r[28]=r[27].get("value"),r[28]!==void 0?t.sequence([function(e){var o;return r[31]=r[28].get("backup_id"),r[32]=r[28].get("device_public_key_blob"),r[33]=r[28].get("device_private_key_blob"),r[34]=r[28].get("epoch_storage_public_key_blob"),r[35]=r[28].get("epoch_storage_private_key_blob"),r[36]=r[28].get("epoch_auth_public_key_blob"),r[37]=r[28].get("epoch_auth_private_key_blob"),r[38]=r[28].get("mailbox_root_key_blob"),r[39]=r[28].get("ocmf_client_state_blob"),r[40]=r[28].get("orf_client_state_v2_blob"),r[41]=r[28].get("orf_v2_authority_level"),r[42]=r[28].get("oblivious_validation_token_blob"),r[43]=r[28].get("device_id"),r[44]=r[28].get("backup_tenancy"),r[45]=r[28].get("encryption_version"),r[46]=r[28].get("revision_version"),r[47]=r[28].get("initialize_restore_result"),r[48]=r[28].get("device_creation_timestamp_sec"),r[49]=r[28].get("authority_level"),t.i64.neq(r[43],void 0)?t.sequence([function(e){return r[52]=void 0,t.i64.neq(r[52],void 0)?t.resolve(r[53]=r[52]):t.sequence([function(e){return r[104]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,r[105]=t[0],t})},function(e){return r[105]&&(r[114]=(r[104].push(t.i64.cast([0,0])),r[104])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,r[106]=t[0],t})},function(e){return r[106]&&(r[114]=(r[104].push(t.i64.cast([0,2])),r[104])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,r[107]=t[0],t})},function(e){return r[107]&&(r[114]=(r[104].push(t.i64.cast([0,3])),r[104])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,r[108]=t[0],t})},function(e){return r[108]&&(r[114]=(r[104].push(t.i64.cast([0,4])),r[104])),r[109]=t.createArray(),r[110]=t.i64.of_int32(r[104].length),t.i64.gt(r[110],t.i64.cast([0,0]))?t.loopAsync(r[110],function(e){return r[114]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[104],r[114]).then(function(e){var t;return t=e,r[115]=t[0],r[116]=t[1],t})},function(e){return r[117]=(r[109].push(r[115]),r[109])}])}):t.resolve()},function(e){return t.sequence([function(e){return r[114]=t.createArray(),r[115]=t.i64.of_int32(r[109].length),t.i64.gt(r[115],t.i64.cast([0,0]))?t.loopAsync(r[115],function(e){return r[117]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[109],r[117]).then(function(e){var t;return t=e,r[118]=t[0],r[119]=t[1],t})},function(e){return r[120]=(r[114].push(t.i64.to_string(r[118])),r[114])}])}):t.resolve()},function(e){return r[116]=r[114].join(","),r[111]=r[116]}])},function(e){return r[109].some(function(e){return t.i64.eq(r[45],e)})?r[112]=r[45]:r[112]=void 0,t.i64.neq(r[112],void 0)?r[113]=r[112]:r[113]=void 0,r[53]=r[113]}])},function(e){return t.i64.neq(r[53],void 0)?r[54]=r[53]:r[54]=t.i64.cast([0,0]),t.i64.neq(r[44],void 0)?r[55]=r[44]:r[55]=t.i64.cast([0,1]),t.nativeOperation(n("LSCreateSignatureKeyPair.nop")).then(function(e){var t;return t=e,r[56]=t[0],r[57]=t[1],t})},function(e){return t.nativeOperation(n("LSCreateEncryptionKeyPair.nop")).then(function(e){var t;return t=e,r[58]=t[0],r[59]=t[1],t})},function(e){return t.nativeOperation(n("LSCreateSignature_v2.nop"),r[56],t.blob("MA=="),r[59]).then(function(e){var t;return t=e,r[60]=t[0],t})},function(e){return r[61]=r[21].get("epoch_anon_id"),r[62]=r[21].get("epoch_root_key"),r[63]=t.createArray(),r[104]=(r[63].push(t.i64.cast([0,32])),r[63]),t.nativeOperation(n("LSBase64Encode.nop"),r[61]).then(function(e){var t;return t=e,r[64]=t[0],t})},function(e){return r[64]!==void 0?t.sequence([function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blobs.of_string(["epoch_devices","_",r[64]].join("")),void 0,r[62],r[63]).then(function(e){var t;return t=e,r[104]=t[0],t})},function(e){return r[104]?r[105]=!1:r[105]=!0,r[105]?t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish"),r[108]="THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoEpochUtils] ","",r[108]].join("")),r[107]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils",r[108],r[107],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,r[109]=t[0],t})},function(e){return r[106]=r[109]}]):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[104],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[107]=t[0],r[108]=t[1],t})},function(e){return r[106]=r[107]}])},function(e){return r[65]=r[106]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish"),r[105]="THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoEpochUtils] ","",r[105]].join("")),r[104]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils",r[105],r[104],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,r[106]=t[0],t})},function(e){return r[65]=r[106]}])},function(e){return t.nativeOperation(n("LSHmac_v2.nop"),r[65],r[57]).then(function(e){var t;return t=e,r[66]=t[0],t})},function(e){return t.blobs.neq(r[66],void 0)?t.resolve(r[67]=r[66]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] device_epoch_hmac is null!"),r[105]="device_epoch_hmac is null!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[105]].join("")),r[104]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[105],r[104],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,r[106]=t[0],t})},function(e){return r[67]=r[106]}])},function(e){return r[68]=r[21].get("epoch_root_key"),r[69]=t.createArray(),r[104]=(r[69].push(t.i64.cast([0,18])),r[69]),t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,r[68],r[69]).then(function(e){var t;return t=e,r[70]=t[0],t})},function(e){return r[70]!==void 0?t.sequence([function(e){return r[104]=t.i64.of_int32(r[70].length),t.i64.ge(r[104],t.i64.cast([0,1]))?t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[70],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[106]=t[0],r[107]=t[1],t})},function(e){return r[105]=r[106]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),r[107]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBFingerprint] ","",r[107]].join("")),r[106]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBFingerprint",r[107],r[106],t.i64.cast([0,3]))},function(e){return r[105]=void 0}])},function(e){return r[71]=r[105]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),r[105]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBFingerprint] ","",r[105]].join("")),r[104]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBFingerprint",r[105],r[104],t.i64.cast([0,3]))},function(e){return r[71]=void 0}])},function(e){return t.blobs.neq(r[71],void 0)?r[72]=!0:r[72]=!1,r[72]||((function(e){t.logger(e).mustfix(e)})("LS::assert is failed. Attempting to coerce a null value to nonnull."),t.throw("LS::assert is failed. Attempting to coerce a null value to nonnull.")),t.nativeOperation(n("LSOcmfClientEvolve_v2.nop"),r[39]).then(function(e){var t;return t=e,r[73]=t[0],r[74]=t[1],t})},function(e){var o;return t.blobs.neq(void 0,void 0)?t.sequence([function(e){return t.nativeOperation(n("LSOcmfClientEvolve_v2.nop"),void 0).then(function(e){var t;return t=e,r[104]=t[0],r[105]=t[1],t})},function(e){var t;return t=[r[73],r[74],r[104],r[105]],r[75]=t[0],r[76]=t[1],r[77]=t[2],r[78]=t[3],t}]):t.resolve((o=[r[73],r[74],void 0,void 0],r[75]=o[0],r[76]=o[1],r[77]=o[2],r[78]=o[3],o))},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[56]).then(function(e){var t;return t=e,r[79]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),r[16],t.blob("dmlydHVhbF9kZXZpY2U6dmlydHVhbF9kZXZpY2VfcHJpdmF0ZV9rZXk="),r[79]==null?"":r[79]).then(function(e){var t;return t=e,r[80]=t[0],t})},function(e){return r[80]!==void 0?r[81]=r[80]:r[81]="",r[81]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] encrypted_device_private_key is empty!"),r[105]="encrypted_device_private_key is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[105]].join("")),r[104]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[105],r[104],t.i64.cast([0,3]))):t.resolve()},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[58]).then(function(e){var t;return t=e,r[82]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),r[16],t.blob("dmlydHVhbF9kZXZpY2U6ZXBvY2hfc3RvcmFnZV9wcml2YXRlX2tleQ=="),r[82]==null?"":r[82]).then(function(e){var t;return t=e,r[83]=t[0],t})},function(e){return r[83]!==void 0?r[84]=r[83]:r[84]="",r[84]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] encrypted_epoch_storage_private_key is empty!"),r[105]="encrypted_epoch_storage_private_key is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[105]].join("")),r[104]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[105],r[104],t.i64.cast([0,3]))):t.resolve()},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[75]).then(function(e){var t;return t=e,r[85]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),r[16],t.blob("dmlydHVhbF9kZXZpY2U6b2NtZl9jbGllbnRfc3RhdGU="),r[85]==null?"":r[85]).then(function(e){var t;return t=e,r[86]=t[0],t})},function(e){return r[86]!==void 0?r[87]=r[86]:r[87]="",r[87]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] encrypted_orf_client_state_v1_shape is empty!"),r[105]="encrypted_orf_client_state_v1_shape is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[105]].join("")),r[104]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[105],r[104],t.i64.cast([0,3]))):t.resolve()},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[42]).then(function(e){var t;return t=e,r[88]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),r[16],t.blob("dmlydHVhbF9kZXZpY2U6b2JsaXZpb3VzX3ZhbGlkYXRpb25fdG9rZW4="),r[88]==null?"":r[88]).then(function(e){var t;return t=e,r[89]=t[0],t})},function(e){return r[89]!==void 0?r[90]=r[89]:r[90]="",r[90]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] encrypted_oblivious_validation_token is empty!"),r[105]="encrypted_oblivious_validation_token is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[105]].join("")),r[104]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[105],r[104],t.i64.cast([0,3]))):t.resolve()},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[38]).then(function(e){var t;return t=e,r[91]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),r[16],t.blob("dmlydHVhbF9kZXZpY2U6bWFpbGJveF9yb290X2tleQ=="),r[91]==null?"":r[91]).then(function(e){var t;return t=e,r[92]=t[0],t})},function(e){return r[92]!==void 0?r[93]=r[92]:r[93]="",r[93]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] encrypted_mailbox_root_key is empty!"),r[105]="encrypted_mailbox_root_key is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[105]].join("")),r[104]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[105],r[104],t.i64.cast([0,3]))):t.resolve()},function(e){return r[94]=r[21].get("epoch_anon_id"),t.nativeOperation(n("LSBase64Encode.nop"),r[94]).then(function(e){var t;return t=e,r[95]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),r[16],t.blob("dmlydHVhbF9kZXZpY2U6ZXBvY2hfYW5vbl9pZA=="),r[95]==null?"":r[95]).then(function(e){var t;return t=e,r[96]=t[0],t})},function(e){return r[96]!==void 0?r[97]=r[96]:r[97]="",r[97]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] encrypted_epoch_anon_id is empty!"),r[105]="encrypted_epoch_anon_id is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[105]].join("")),r[104]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[105],r[104],t.i64.cast([0,3]))):t.resolve()},function(e){return r[98]=r[21].get("epoch_root_key"),t.nativeOperation(n("LSBase64Encode.nop"),r[98]).then(function(e){var t;return t=e,r[99]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),r[16],t.blob("dmlydHVhbF9kZXZpY2U6ZXBvY2hfcm9vdF9rZXk="),r[99]==null?"":r[99]).then(function(e){var t;return t=e,r[100]=t[0],t})},function(e){return r[100]!==void 0?r[101]=r[100]:r[101]="",r[101]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] encrypted_epoch_root_key is empty!"),r[105]="encrypted_epoch_root_key is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[105]].join("")),r[104]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[105],r[104],t.i64.cast([0,3]))):t.resolve()},function(e){var n;return r[102]=new t.Map,r[102].set("encrypted_device_private_key",r[81]),r[102].set("encrypted_epoch_storage_private_key",r[84]),r[102].set("encrypted_ocmf_client_state",r[87]),r[102].set("encrypted_orf_client_state_v2",void 0),r[102].set("encrypted_oblivious_validation_token_blob",r[90]),r[102].set("encrypted_mailbox_root_key_blob",r[93]),r[102].set("encrypted_epoch_anon_id",r[97]),r[102].set("encrypted_epoch_root_key",r[101]),r[103]=new t.Map,r[103].set("virtual_device_public_key",r[57]),r[103].set("virtual_device_id",r[15]),r[103].set("virtual_device_epoch_storage_public_key",r[59]),r[103].set("virtual_device_epoch_storage_public_key_sig",r[60]==null?t.blob("bnVsbA=="):r[60]),r[103].set("device_epoch_hmac",r[67]),r[103].set("epoch_root_key_fingerprint",r[71]),r[103].set("virtual_device_type",a.virtualDeviceType),r[103].set("action_type",t.i64.cast([0,1])),r[103].set("ocmf_rotation_token",r[76]),r[103].set("encrypted_secret_values_payload",r[102]),r[103].set("cloud_service_account",a.cloudServiceAccount),r[103].set("hsm_pin_normalization_status",a.hsmPinNormalizationStatus),r[103].set("security_question_type",void 0),r[103].set("trusted_contact_id",void 0),n=[r[103],void 0],r[50]=n[0],r[51]=n[1]}]):t.resolve((r[52]=new t.Map,r[52].set("error_code",t.i64.cast([0,9])),r[52].set("stored_procedure","LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure"),r[52].set("error_message",""),o=[void 0,r[52]],r[50]=o[0],r[51]=o[1]))},function(e){var t;return t=[r[50],r[51]],r[29]=t[0],r[30]=t[1],t}]):t.resolve((r[31]=r[27].get("errors"),r[32]=r[27].get("errors"),r[33]=new t.Map,r[33].set("error_code",t.i64.cast([0,9])),r[33].set("stored_procedure","LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure"),r[33].set("error_message",""),o=[void 0,r[33]],r[29]=o[0],r[30]=o[1]))},function(e){var t;return t=[r[29],r[30]],r[22]=t[0],r[23]=t[1],t}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] Epoch keys are unavailable."),r[25]="Epoch keys are unavailable.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[25]].join("")),r[24]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[25],r[24],t.i64.cast([0,3]))},function(r){return t.storedProcedure(n("LSHandleCreateVirtualDeviceFailure"),e[0],!0,void 0)},function(e){var n;return r[26]=new t.Map,r[26].set("error_code",t.i64.cast([0,11])),r[26].set("stored_procedure","LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure"),r[26].set("error_message",""),n=[void 0,r[26]],r[22]=n[0],r[23]=n[1]}])},function(e){var t;return t=[r[22],r[23]],r[19]=t[0],r[20]=t[1],t}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] Invalid Recovery Code Provided"),r[22]="Invalid Recovery Code Provided",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[22]].join("")),r[21]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[22],r[21],t.i64.cast([0,3]))},function(r){return t.storedProcedure(n("LSHandleCreateVirtualDeviceFailure"),e[0],!0,void 0)},function(e){var n;return r[23]=new t.Map,r[23].set("error_code",t.i64.cast([0,10])),r[23].set("stored_procedure","LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure"),r[23].set("error_message",""),n=[void 0,r[23]],r[19]=n[0],r[20]=n[1]}])},function(e){var t;return t=[r[19],r[20]],r[17]=t[0],r[18]=t[1],t}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] Invalid Recovery Code Provided"),r[20]="Invalid Recovery Code Provided",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure] ","",r[20]].join("")),r[19]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",r[20],r[19],t.i64.cast([0,3]))},function(r){return t.storedProcedure(n("LSHandleCreateVirtualDeviceFailure"),e[0],!0,void 0)},function(e){var n;return r[21]=new t.Map,r[21].set("error_code",t.i64.cast([0,10])),r[21].set("stored_procedure","LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure"),r[21].set("error_message",""),n=[void 0,r[21]],r[17]=n[0],r[18]=n[1]}])},function(e){var t;return t=[r[17],r[18]],r[10]=t[0],r[11]=t[1],t}]))})},function(e){var t;return t=[r[10],r[11]],r[2]=t[0],r[3]=t[1],t}])},function(e){return r[4]=t.i64.of_float(Date.now()),r[5]=t.i64.random(),r[7]="Finishing execution. Execution time: ",r[8]=t.i64.to_string(t.i64.sub(r[4],r[0])),r[9]=" ms",r[6]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][generateInitialVirtualDeviceSetupPayload] ",r[6],r[7],r[6],r[8],r[6],r[9]].join("")),t.i64.eq(t.i64.mod_(r[5],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[10]=",",r[11]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"generateInitialVirtualDeviceSetupPayload",[r[7],r[10],r[8],r[10],r[9]].join(""),r[11],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[r[2],r[3]],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsGenerateInitialVirtualDeviceSetupPayloadStoredProcedure",e.__tables__=["secure_encrypted_backups_client_state","secure_encrypted_backups_generated_recovery_code"],a.exports=e}),null);
__d("LSInitializeBackupV2",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSCreateMinosEpochParams.nop","LSCreateSignature_v2.nop","LSGenerateInitialDeviceSetupPayload","LSGenerateInitialEpochSetupPayload","LSGenerateInitialVirtualDeviceSetupPayload","LSGetBlobFromString.nop","LSHmac_v2.nop","LSIsEncryptionVersionSecure","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop","gkx"],(function(t,n,r,o,a,i,l){function e(){var e=arguments,t=e[e.length-1],o=[],a=[];return t.sequence([function(i){return t.sequence([function(r){return o[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][initializeBackupV2] Beginning execution."),o[1]=t.i64.of_float(Date.now()),t.storedProcedure(n("LSGenerateInitialDeviceSetupPayload"),e[0]).then(function(e){var t;return t=e,o[2]=t[0],o[3]=t[1],t})},function(r){var a,i,l;return o[2]!==void 0?t.sequence([function(e){return o[15]=o[2].get("device_public_key"),t.nativeOperation(n("LSBase64Encode.nop"),o[15]).then(function(e){var t;return t=e,o[16]=t[0],t})},function(e){return o[17]=o[2].get("epoch_storage_public_key"),t.nativeOperation(n("LSBase64Encode.nop"),o[17]).then(function(e){var t;return t=e,o[18]=t[0],t})},function(e){return o[19]=o[2].get("epoch_storage_public_key_sig"),t.nativeOperation(n("LSBase64Encode.nop"),o[19]).then(function(e){var t;return t=e,o[20]=t[0],t})},function(e){return o[21]=o[2].get("epoch_auth_public_key"),t.nativeOperation(n("LSBase64Encode.nop"),o[21]).then(function(e){var t;return t=e,o[22]=t[0],t})},function(e){return o[23]=o[2].get("epoch_auth_public_key_sig"),t.nativeOperation(n("LSBase64Encode.nop"),o[23]).then(function(e){var t;return t=e,o[24]=t[0],t})},function(e){return o[25]=o[2].get("ocmf_client_state"),t.nativeOperation(n("LSBase64Encode.nop"),o[25]).then(function(e){var t;return t=e,o[26]=t[0],t})},function(e){return o[27]=o[2].get("mailbox_root_key"),t.nativeOperation(n("LSBase64Encode.nop"),o[27]).then(function(e){var t;return t=e,o[28]=t[0],t})},function(e){return o[29]=o[2].get("device_private_key"),o[30]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,o[31]=t[0],t})},function(e){return o[31]&&(o[44]=(o[30].push(t.i64.cast([0,0])),o[30])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,o[32]=t[0],t})},function(e){return o[32]&&(o[44]=(o[30].push(t.i64.cast([0,2])),o[30])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,o[33]=t[0],t})},function(e){return o[33]&&(o[44]=(o[30].push(t.i64.cast([0,3])),o[30])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,o[34]=t[0],t})},function(e){return o[34]&&(o[44]=(o[30].push(t.i64.cast([0,4])),o[30])),o[35]="",o[36]=t.i64.of_int32(o[30].length),t.i64.gt(o[36],t.i64.cast([0,0]))?t.loopAsync(o[36],function(e){return o[44]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[30],o[44]).then(function(e){var t;return t=e,o[45]=t[0],o[46]=t[1],t})},function(e){return o[35]=[o[35],"_",t.i64.to_string(o[45])].join("")}])}):t.resolve()},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),["supported_versions_",o[35],"revision_version_",t.i64.to_string(t.i64.cast([0,1]))].join("")).then(function(e){var t;return t=e,o[37]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateSignature_v2.nop"),o[29],t.blob("Mg=="),o[37]).then(function(e){var t;return t=e,o[38]=t[0],t})},function(e){return t.blobs.neq(o[38],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[38]).then(function(e){var t;return t=e,o[44]=t[0],t})},function(e){return o[39]=o[44]}]):t.resolve(o[39]=void 0)},function(n){var r;return o[40]=o[2].get("optimistic_backup_id"),o[41]=o[2].get("mailbox_partial_id"),o[42]=new t.Map,o[42].set("supported_encryption_versions",o[30]),o[42].set("client_version",t.i64.cast([0,1])),o[42].set("version_sig",o[39]==null?"":o[39]),o[43]=new t.Map,o[43].set("device_public_key",o[16]==null?"":o[16]),o[43].set("epoch_storage_public_key",o[18]==null?"":o[18]),o[43].set("epoch_storage_public_key_sig",o[20]==null?"":o[20]),o[43].set("epoch_auth_public_key",o[22]==null?"":o[22]),o[43].set("epoch_auth_public_key_sig",o[24]==null?"":o[24]),o[43].set("device_registration_id",e[0]),o[43].set("ocmf_client_state",o[26]==null?"":o[26]),o[43].set("mailbox_partial_id",o[41]),o[43].set("mailbox_root_key",o[28]==null?"":o[28]),o[43].set("encryption_version_data",o[42]),r=[o[43],o[40],!0,t.i64.cast([0,0])],o[4]=r[0],o[5]=r[1],o[6]=r[2],o[7]=r[3]}]):t.resolve((o[3]!==void 0?(o[19]=o[3].get("error_code"),a=[void 0,t.i64.cast([-1,4294967295]),!1,o[19]],o[15]=a[0],o[16]=a[1],o[17]=a[2],o[18]=a[3]):(i=[void 0,t.i64.cast([-1,4294967295]),!1,t.i64.cast([0,12])],o[15]=i[0],o[16]=i[1],o[17]=i[2],o[18]=i[3]),l=[o[15],o[16],o[17],o[18]],o[4]=l[0],o[5]=l[1],o[6]=l[2],o[7]=l[3]))},function(a){return o[6]?t.sequence([function(a){return o[4]!==void 0?t.sequence([function(e){return t.islc(t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))||!0}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,n){var r,a,i=e.done,l=e.value;return i?(o[25]=new t.Map,o[25].set("error_msg","Expected a nonempty query result"),o[25].set("code",t.i64.cast([0,3])),o[25].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),o[26]=t.createArray(),o[27]=(o[26].push(o[25]),o[26]),r=[void 0,o[26]],o[16]=r[0],o[17]=r[1]):(n=l.item,o[25]=new t.Map,o[25].set("backup_id",n.backupId),o[25].set("device_public_key_blob",n.devicePublicKeyBlob),o[25].set("device_private_key_blob",n.devicePrivateKeyBlob),o[25].set("epoch_storage_public_key_blob",n.epochStoragePublicKeyBlob),o[25].set("epoch_storage_private_key_blob",n.epochStoragePrivateKeyBlob),o[25].set("epoch_auth_public_key_blob",n.epochAuthPublicKeyBlob),o[25].set("epoch_auth_private_key_blob",n.epochAuthPrivateKeyBlob),o[25].set("mailbox_root_key_blob",n.mailboxRootKeyBlob),o[25].set("ocmf_client_state_blob",n.ocmfClientStateBlob),o[25].set("orf_client_state_v2_blob",void 0),o[25].set("orf_v2_authority_level",void 0),o[25].set("oblivious_validation_token_blob",n.obliviousValidationTokenBlob),o[25].set("device_id",n.deviceId),o[25].set("backup_tenancy",n.backupTenancy),o[25].set("encryption_version",n.encryptionVersion),o[25].set("revision_version",n.revisionVersion),o[25].set("initialize_restore_result",void 0),o[25].set("device_creation_timestamp_sec",void 0),o[25].set("authority_level",n.authorityLevel),a=[o[25],void 0],o[16]=a[0],o[17]=a[1])})},function(e){var a;return o[19]=new t.Map,o[19].set("value",o[16]),o[19].set("errors",o[17]),o[20]=o[19].get("value"),o[20]!==void 0?t.sequence([function(e){var a;return o[25]=o[20].get("backup_id"),o[26]=o[20].get("device_public_key_blob"),o[27]=o[20].get("device_private_key_blob"),o[28]=o[20].get("epoch_storage_public_key_blob"),o[29]=o[20].get("epoch_storage_private_key_blob"),o[30]=o[20].get("epoch_auth_public_key_blob"),o[31]=o[20].get("epoch_auth_private_key_blob"),o[32]=o[20].get("mailbox_root_key_blob"),o[33]=o[20].get("ocmf_client_state_blob"),o[34]=o[20].get("orf_client_state_v2_blob"),o[35]=o[20].get("orf_v2_authority_level"),o[36]=o[20].get("oblivious_validation_token_blob"),o[37]=o[20].get("device_id"),o[38]=o[20].get("backup_tenancy"),o[39]=o[20].get("encryption_version"),o[40]=o[20].get("revision_version"),o[41]=o[20].get("initialize_restore_result"),o[42]=o[20].get("device_creation_timestamp_sec"),o[43]=o[20].get("authority_level"),t.i64.neq(o[37],void 0)?t.sequence([function(e){return o[47]=void 0,t.i64.neq(o[47],void 0)?t.resolve(o[48]=o[47]):t.sequence([function(e){return o[58]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,o[59]=t[0],t})},function(e){return o[59]&&(o[68]=(o[58].push(t.i64.cast([0,0])),o[58])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,o[60]=t[0],t})},function(e){return o[60]&&(o[68]=(o[58].push(t.i64.cast([0,2])),o[58])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,o[61]=t[0],t})},function(e){return o[61]&&(o[68]=(o[58].push(t.i64.cast([0,3])),o[58])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,o[62]=t[0],t})},function(e){return o[62]&&(o[68]=(o[58].push(t.i64.cast([0,4])),o[58])),o[63]=t.createArray(),o[64]=t.i64.of_int32(o[58].length),t.i64.gt(o[64],t.i64.cast([0,0]))?t.loopAsync(o[64],function(e){return o[68]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[58],o[68]).then(function(e){var t;return t=e,o[69]=t[0],o[70]=t[1],t})},function(e){return o[71]=(o[63].push(o[69]),o[63])}])}):t.resolve()},function(e){return t.sequence([function(e){return o[68]=t.createArray(),o[69]=t.i64.of_int32(o[63].length),t.i64.gt(o[69],t.i64.cast([0,0]))?t.loopAsync(o[69],function(e){return o[71]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[63],o[71]).then(function(e){var t;return t=e,o[72]=t[0],o[73]=t[1],t})},function(e){return o[74]=(o[68].push(t.i64.to_string(o[72])),o[68])}])}):t.resolve()},function(e){return o[70]=o[68].join(","),o[65]=o[70]}])},function(e){return o[63].some(function(e){return t.i64.eq(o[39],e)})?o[66]=o[39]:o[66]=void 0,t.i64.neq(o[66],void 0)?o[67]=o[66]:o[67]=void 0,o[48]=o[67]}])},function(e){return t.i64.neq(o[48],void 0)?o[49]=o[48]:o[49]=t.i64.cast([0,0]),t.i64.neq(o[38],void 0)?o[50]=o[38]:o[50]=t.i64.cast([0,1]),o[51]=new t.Map,o[51].set("device_id",o[37]),o[51].set("public_key",o[26]),o[52]=t.createArray(),o[58]=(o[52].push(o[51]),o[52]),t.storedProcedure(n("LSGenerateInitialEpochSetupPayload"),o[25],o[52]).then(function(e){var t;return t=e,o[53]=t[0],o[54]=t[1],t})},function(e){var a,i,l;return o[53]!==void 0?t.sequence([function(e){return o[58]=o[53].get("epoch_anon_id"),o[59]=o[53].get("epoch_root_key"),t.blobs.neq(o[59],void 0)?t.sequence([function(e){return o[76]=t.createArray(),o[82]=(o[76].push(t.i64.cast([0,18])),o[76]),t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,o[59],o[76]).then(function(e){var t;return t=e,o[77]=t[0],t})},function(e){return o[77]!==void 0?t.sequence([function(e){return o[82]=t.i64.of_int32(o[77].length),t.i64.ge(o[82],t.i64.cast([0,1]))?t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[77],t.i64.cast([0,0])).then(function(e){var t;return t=e,o[84]=t[0],o[85]=t[1],t})},function(e){return o[83]=o[84]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),o[85]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBFingerprint] ","",o[85]].join("")),o[84]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBFingerprint",o[85],o[84],t.i64.cast([0,3]))},function(e){return o[83]=void 0}])},function(e){return o[78]=o[83]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),o[83]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBFingerprint] ","",o[83]].join("")),o[82]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBFingerprint",o[83],o[82],t.i64.cast([0,3]))},function(e){return o[78]=void 0}])},function(e){return t.blobs.neq(o[78],void 0)?o[79]=!0:o[79]=!1,o[79]||((function(e){t.logger(e).mustfix(e)})("LS::assert is failed. Attempting to coerce a null value to nonnull."),t.throw("LS::assert is failed. Attempting to coerce a null value to nonnull.")),t.nativeOperation(n("LSBase64Encode.nop"),o[78]).then(function(e){var t;return t=e,o[80]=t[0],t})},function(e){return o[80]!==void 0?o[81]=o[80]:o[81]="encodingfailed",o[60]=o[81]}]):t.resolve(o[60]="null")},function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[52],t.i64.cast([0,0])).then(function(e){var t;return t=e,o[61]=t[0],o[62]=t[1],t})},function(e){return o[63]=o[61].get("public_key"),t.nativeOperation(n("LSBase64Encode.nop"),o[63]).then(function(e){var t;return t=e,o[64]=t[0],t})},function(e){return o[65]=o[61].get("public_key"),o[66]=t.createArray(),o[76]=(o[66].push(t.i64.cast([0,32])),o[66]),t.nativeOperation(n("LSBase64Encode.nop"),o[58]).then(function(e){var t;return t=e,o[67]=t[0],t})},function(e){return o[67]!==void 0?t.sequence([function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blobs.of_string(["epoch_devices","_",o[67]].join("")),void 0,o[59],o[66]).then(function(e){var t;return t=e,o[76]=t[0],t})},function(e){return o[76]?o[77]=!1:o[77]=!0,o[77]?t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish"),o[80]="THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoEpochUtils] ","",o[80]].join("")),o[79]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils",o[80],o[79],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,o[81]=t[0],t})},function(e){return o[78]=o[81]}]):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[76],t.i64.cast([0,0])).then(function(e){var t;return t=e,o[79]=t[0],o[80]=t[1],t})},function(e){return o[78]=o[79]}])},function(e){return o[68]=o[78]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish"),o[77]="THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoEpochUtils] ","",o[77]].join("")),o[76]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils",o[77],o[76],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,o[78]=t[0],t})},function(e){return o[68]=o[78]}])},function(e){return t.nativeOperation(n("LSHmac_v2.nop"),o[68],o[65]).then(function(e){var t;return t=e,o[69]=t[0],t})},function(e){return r("gkx")("11690")&&r("gkx")("16269")?t.sequence([function(e){return t.nativeOperation(n("LSCreateMinosEpochParams.nop"),o[59],o[58],void 0,void 0,void 0).then(function(e){var t;return t=e,o[76]=t[0],o[77]=t[1],o[78]=t[2],o[79]=t[3],o[80]=t[4],o[81]=t[5],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[76]).then(function(e){var t;return t=e,o[82]=t[0],t})},function(e){return o[82]!==void 0?o[83]=o[82]:o[83]="",t.nativeOperation(n("LSBase64Encode.nop"),o[78]).then(function(e){var t;return t=e,o[84]=t[0],t})},function(e){return o[84]!==void 0?o[85]=o[84]:o[85]="",t.nativeOperation(n("LSBase64Encode.nop"),o[77]).then(function(e){var t;return t=e,o[86]=t[0],t})},function(e){return o[86]!==void 0?o[87]=o[86]:o[87]="",t.nativeOperation(n("LSBase64Encode.nop"),o[79]).then(function(e){var t;return t=e,o[88]=t[0],t})},function(e){return o[88]!==void 0?o[89]=o[88]:o[89]="",t.blobs.neq(void 0,void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),void 0).then(function(e){var t;return t=e,o[96]=t[0],t})},function(e){return o[96]!==void 0?o[97]=o[96]:o[97]="",o[90]=o[97]}]):t.resolve(o[90]=void 0)},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[80]).then(function(e){var t;return t=e,o[91]=t[0],t})},function(e){return o[91]!==void 0?o[92]=o[91]:o[92]="",t.blobs.neq(o[81],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[81]).then(function(e){var t;return t=e,o[96]=t[0],t})},function(e){return o[96]!==void 0?o[97]=o[96]:o[97]="",o[93]=o[97]}]):t.resolve(o[93]=void 0)},function(e){return o[94]=new t.Map,o[94].set("mailbox_encryption_public_key",o[83]),o[94].set("mailbox_auth_public_key",o[85]),o[94].set("mailbox_signing_public_key",o[87]),o[94].set("epoch_head",o[89]),o[94].set("previous_epoch_head",o[90]),o[94].set("self_signature",o[92]),o[94].set("prev_signature",o[93]),o[94]!==void 0?t.resolve(o[95]=o[94]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBEpochUtils] Missing Native Op for MEBMinosCreateMailboxEncryptionKeyPair"),o[97]="Missing Native Op for MEBMinosCreateMailboxEncryptionKeyPair",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBEpochUtils] ","",o[97]].join("")),o[96]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBEpochUtils",o[97],o[96],t.i64.cast([0,3]))},function(e){return o[95]=void 0}])},function(e){return o[70]=o[95]}]):t.resolve(o[70]=void 0)},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[58]).then(function(e){var t;return t=e,o[71]=t[0],t})},function(e){return o[72]=o[53].get("optimistic_epoch_id"),t.blobs.neq(o[69],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[69]).then(function(e){var t;return t=e,o[76]=t[0],t})},function(e){return o[73]=o[76]}]):t.resolve(o[73]=void 0)},function(e){var n;return o[74]=new t.Map,o[74].set("device_pub",o[64]==null?"":o[64]),o[74].set("hmac",o[73]==null?"":o[73]),o[74].set("encrypted_epoch_key",void 0),o[74].set("epoch_root_key_fingerprint",o[60]),o[75]=new t.Map,o[75].set("epoch_data",""),o[75].set("epoch_anon_id",o[71]==null?"":o[71]),o[75].set("minos_epoch_creation_params",o[70]),o[75].set("optimistic_epoch_id",o[72]),o[75].set("membership",o[74]),n=[o[75],!0,t.i64.cast([0,0])],o[55]=n[0],o[56]=n[1],o[57]=n[2]}]):t.resolve((o[54]!==void 0?(o[61]=o[54].get("error_code"),a=[void 0,!1,o[61]],o[58]=a[0],o[59]=a[1],o[60]=a[2]):(i=[void 0,!1,t.i64.cast([0,14])],o[58]=i[0],o[59]=i[1],o[60]=i[2]),l=[o[58],o[59],o[60]],o[55]=l[0],o[56]=l[1],o[57]=l[2]))},function(e){var t;return t=[o[55],o[56],o[57]],o[44]=t[0],o[45]=t[1],o[46]=t[2],t}]):t.resolve((a=[void 0,!1,t.i64.cast([0,9])],o[44]=a[0],o[45]=a[1],o[46]=a[2],a))},function(e){var t;return t=[o[44],o[45],o[46]],o[21]=t[0],o[22]=t[1],o[23]=t[2],t}]):t.resolve((o[25]=o[19].get("errors"),o[26]=o[19].get("errors"),a=[void 0,!1,t.i64.cast([0,9])],o[21]=a[0],o[22]=a[1],o[23]=a[2]))},function(r){return o[22]?t.sequence([function(r){return o[21]!==void 0?t.sequence([function(r){return t.storedProcedure(n("LSGenerateInitialVirtualDeviceSetupPayload"),o[5],e[2]).then(function(e){var t;return t=e,o[26]=t[0],o[27]=t[1],t})},function(e){var r,a,i;return o[26]!==void 0?t.sequence([function(e){return o[32]=o[26].get("virtual_device_public_key"),t.nativeOperation(n("LSBase64Encode.nop"),o[32]).then(function(e){var t;return t=e,o[33]=t[0],t})},function(e){return o[34]=o[26].get("virtual_device_id"),t.nativeOperation(n("LSBase64Encode.nop"),o[34]).then(function(e){var t;return t=e,o[35]=t[0],t})},function(e){return o[36]=o[26].get("virtual_device_epoch_storage_public_key"),t.nativeOperation(n("LSBase64Encode.nop"),o[36]).then(function(e){var t;return t=e,o[37]=t[0],t})},function(e){return o[38]=o[26].get("virtual_device_epoch_storage_public_key_sig"),t.nativeOperation(n("LSBase64Encode.nop"),o[38]).then(function(e){var t;return t=e,o[39]=t[0],t})},function(e){return o[40]=o[26].get("device_epoch_hmac"),t.nativeOperation(n("LSBase64Encode.nop"),o[40]).then(function(e){var t;return t=e,o[41]=t[0],t})},function(e){return o[42]=o[26].get("epoch_root_key_fingerprint"),t.blobs.neq(o[42],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[42]).then(function(e){var t;return t=e,o[54]=t[0],t})},function(e){return o[43]=o[54]}]):t.resolve(o[43]=void 0)},function(e){return o[44]=o[26].get("ocmf_rotation_token"),t.nativeOperation(n("LSBase64Encode.nop"),o[44]).then(function(e){var t;return t=e,o[45]=t[0],t})},function(e){var n;return o[46]=o[26].get("encrypted_secret_values_payload"),o[47]=o[26].get("virtual_device_type"),o[48]=o[26].get("action_type"),o[49]=o[26].get("cloud_service_account"),o[50]=o[26].get("hsm_pin_normalization_status"),o[51]=o[26].get("security_question_type"),o[52]=o[26].get("trusted_contact_id"),o[53]=new t.Map,o[53].set("virtual_device_public_key",o[33]==null?"":o[33]),o[53].set("virtual_device_id",o[35]==null?"":o[35]),o[53].set("virtual_device_epoch_storage_public_key",o[37]==null?"":o[37]),o[53].set("virtual_device_epoch_storage_public_key_sig",o[39]==null?"":o[39]),o[53].set("encrypted_secret_values",o[46]),o[53].set("device_epoch_hmac",o[41]==null?"":o[41]),o[53].set("epoch_root_key_fingerprint",o[43]),o[53].set("ocmf_rotation_token",o[45]==null?"":o[45]),o[53].set("virtual_device_type",o[47]),o[53].set("action_type",o[48]),o[53].set("cloud_service_account",o[49]),o[53].set("hsm_pin_normalization_status",o[50]),o[53].set("security_question_type",o[51]),o[53].set("trusted_contact_id",o[52]),n=[o[53],!0,t.i64.cast([0,0])],o[28]=n[0],o[29]=n[1],o[30]=n[2]}]):t.resolve((o[27]!==void 0?(o[35]=o[27].get("error_code"),r=[void 0,!1,o[35]],o[32]=r[0],o[33]=r[1],o[34]=r[2]):(a=[void 0,!1,t.i64.cast([0,16])],o[32]=a[0],o[33]=a[1],o[34]=a[2]),i=[o[32],o[33],o[34]],o[28]=i[0],o[29]=i[1],o[30]=i[2]))},function(r){return o[29]?t.sequence([function(r){return o[28]!==void 0?t.sequence([function(r){return o[33]=new t.Map,o[33].set("optimistic_backup_id",o[5]),o[33].set("device_payload",o[4]),o[33].set("epoch_payload",o[21]),o[33].set("virtual_device_payload",o[28]),o[38]=t.i64.cast([0,1e3]),o[34]=o[38],o[35]=new t.Map,o[35].set("success",o[33]),o[35].set("request_id",e[1]),o[36]=t.toJSON(o[35]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",t.i64.cast([0,50033]),o[36],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,o[34]).then(function(e){var t;return t=e,o[37]=t[0],t})},function(e){return o[32]=t.i64.cast([0,0])}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsInitializeBackupV2StoredProcedure] Null virtual device payload"),o[34]="Null virtual device payload",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsInitializeBackupV2StoredProcedure] ","",o[34]].join("")),o[33]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsInitializeBackupV2StoredProcedure",o[34],o[33],t.i64.cast([0,3]))},function(r){return o[35]=new t.Map,o[35].set("error_code",o[30]),o[35].set("error_message","Null virtual device payload"),o[35].set("stored_procedure","initializeBackupV2"),o[36]=new t.Map,o[36].set("failure",o[35]),o[36].set("request_id",e[1]),o[37]=t.toJSON(o[36]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",t.i64.cast([0,50033]),o[37],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,o[38]=t[0],t})},function(e){return o[32]=t.i64.cast([0,1])}])},function(e){return o[31]=o[32]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsInitializeBackupV2StoredProcedure] Could not create virtual device payload"),o[33]="Could not create virtual device payload",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsInitializeBackupV2StoredProcedure] ","",o[33]].join("")),o[32]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsInitializeBackupV2StoredProcedure",o[33],o[32],t.i64.cast([0,3]))},function(r){return o[34]=new t.Map,o[34].set("error_code",o[30]),o[34].set("error_message","Could not create virtual device payload"),o[34].set("stored_procedure","initializeBackupV2"),o[35]=new t.Map,o[35].set("failure",o[34]),o[35].set("request_id",e[1]),o[36]=t.toJSON(o[35]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",t.i64.cast([0,50033]),o[36],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,o[37]=t[0],t})},function(e){return o[31]=t.i64.cast([0,1])}])},function(e){return o[25]=o[31]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsInitializeBackupV2StoredProcedure] Null epoch payload"),o[27]="Null epoch payload",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsInitializeBackupV2StoredProcedure] ","",o[27]].join("")),o[26]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsInitializeBackupV2StoredProcedure",o[27],o[26],t.i64.cast([0,3]))},function(r){return o[28]=new t.Map,o[28].set("error_code",o[23]),o[28].set("error_message","Null epoch payload"),o[28].set("stored_procedure","initializeBackupV2"),o[29]=new t.Map,o[29].set("failure",o[28]),o[29].set("request_id",e[1]),o[30]=t.toJSON(o[29]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",t.i64.cast([0,50033]),o[30],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,o[31]=t[0],t})},function(e){return o[25]=t.i64.cast([0,1])}])},function(e){return o[24]=o[25]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsInitializeBackupV2StoredProcedure] Could not create epoch payload"),o[26]="Could not create epoch payload",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsInitializeBackupV2StoredProcedure] ","",o[26]].join("")),o[25]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsInitializeBackupV2StoredProcedure",o[26],o[25],t.i64.cast([0,3]))},function(r){return o[27]=new t.Map,o[27].set("error_code",o[23]),o[27].set("error_message","Could not create epoch payload"),o[27].set("stored_procedure","initializeBackupV2"),o[28]=new t.Map,o[28].set("failure",o[27]),o[28].set("request_id",e[1]),o[29]=t.toJSON(o[28]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",t.i64.cast([0,50033]),o[29],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,o[30]=t[0],t})},function(e){return o[24]=t.i64.cast([0,1])}])},function(e){return o[15]=o[24]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsInitializeBackupV2StoredProcedure] Null device payload"),o[17]="Null device payload",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsInitializeBackupV2StoredProcedure] ","",o[17]].join("")),o[16]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsInitializeBackupV2StoredProcedure",o[17],o[16],t.i64.cast([0,3]))},function(r){return o[18]=new t.Map,o[18].set("error_code",o[7]),o[18].set("error_message","Null device payload"),o[18].set("stored_procedure","initializeBackupV2"),o[19]=new t.Map,o[19].set("failure",o[18]),o[19].set("request_id",e[1]),o[20]=t.toJSON(o[19]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",t.i64.cast([0,50033]),o[20],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,o[21]=t[0],t})},function(e){return o[15]=t.i64.cast([0,1])}])},function(e){return o[8]=o[15]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsInitializeBackupV2StoredProcedure] Could not create device payload"),o[16]="Could not create device payload",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsInitializeBackupV2StoredProcedure] ","",o[16]].join("")),o[15]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsInitializeBackupV2StoredProcedure",o[16],o[15],t.i64.cast([0,3]))},function(r){return o[17]=new t.Map,o[17].set("error_code",o[7]),o[17].set("error_message","Could not create device payload"),o[17].set("stored_procedure","initializeBackupV2"),o[18]=new t.Map,o[18].set("failure",o[17]),o[18].set("request_id",e[1]),o[19]=t.toJSON(o[18]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",t.i64.cast([0,50033]),o[19],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,o[20]=t[0],t})},function(e){return o[8]=t.i64.cast([0,1])}])},function(e){return o[9]=t.i64.of_float(Date.now()),o[10]=t.i64.random(),o[12]="Finishing execution. Execution time: ",o[13]=t.i64.to_string(t.i64.sub(o[9],o[0])),o[14]=" ms",o[11]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][initializeBackupV2] ",o[11],o[12],o[11],o[13],o[11],o[14]].join("")),t.i64.eq(t.i64.mod_(o[10],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(o[15]=",",o[16]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"initializeBackupV2",[o[12],o[15],o[13],o[15],o[14]].join(""),o[16],t.i64.cast([0,4]))):t.resolve()},function(e){return a[0]=o[8]}])},function(e){return t.resolve(a)}])}e.__sproc_name__="LSEncryptedBackupsInitializeBackupV2StoredProcedure",e.__tables__=["secure_encrypted_backups_client_state"];var s=e;l.default=s}),98);
__d("LSInitializeBackupV2StoredProcedure",["LSInitializeBackupV2","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSInitializeBackupV2"),a.deviceRegistrationId,a.requestId,a.recoveryCodeData);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("MWEncryptedBackupsInitializeBackup",["LSFactory","LSInitializeBackupV2StoredProcedure","LSShape"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n,a){return e.runInTransaction(function(e){return r("LSInitializeBackupV2StoredProcedure")(r("LSFactory")(e),{deviceRegistrationId:t,recoveryCodeData:a?o("LSShape").ofRecord(a):void 0,requestId:n!=null?n:""})},"readwrite",void 0,void 0,i.id+":28")}l.initializeBackupStoredProcedure=e}),98);
__d("EBInitializeBackup",["EBAPIQPLPoints","EBDeps","EBLogger","EBMainThreadEBDBApiDeferred","EBSMAPI","I64","LSAuthorityLevel","LSEncryptedBackupsOpStatus","LSIntEnum","MAWTraceUtils","MWEncryptedBackupsDeviceRegistrationId","MWEncryptedBackupsInitializeBackup","Random","RecoveryCodeDB","WAResultOrError","getErrorSafe","justknobx"],(function(t,n,r,o,a,i,l){"use strict";var e,s;async function u(e,t){var n=await o("RecoveryCodeDB").getOrCreateRecoveryCodeDB(),a=o("Random").uint32();await n.runInTransaction(["persisted_recovery_code"],"readwrite",async function(n){var o=await n.stores.persisted_recovery_code.readAll(),i=o.filter(function(e){return e.virtualDeviceType===t&&e.authorityLevel===r("LSAuthorityLevel").OPTIMISTIC}).map(function(e){return e.pk});i.length>0&&await n.stores.persisted_recovery_code.bulkDelete(i),await n.stores.persisted_recovery_code.bulkPut([{authorityLevel:r("LSAuthorityLevel").OPTIMISTIC,pk:a,recoveryCode:e,virtualDeviceType:t}])},"EBDB - persist recovery code optimistic")}async function c(e,t){var n=await o("RecoveryCodeDB").getOrCreateRecoveryCodeDB();await n.runInTransaction(["persisted_recovery_code"],"readwrite",async function(n){var o=await n.stores.persisted_recovery_code.readAll(),a=o.find(function(n){return n.recoveryCode===e&&n.virtualDeviceType===t&&n.authorityLevel===r("LSAuthorityLevel").OPTIMISTIC});a!=null&&await n.stores.persisted_recovery_code.bulkPut([babelHelpers.extends({},a,{authorityLevel:r("LSAuthorityLevel").AUTHORITATIVE})])},"RecoveryCodeDB - update recovery code to authoritative")}async function d(e){var t=await o("RecoveryCodeDB").getOrCreateRecoveryCodeDB();await t.runInTransaction(["persisted_recovery_code"],"readwrite",async function(t){var n=await t.stores.persisted_recovery_code.readAll(),o=n.filter(function(t){return t.virtualDeviceType===e&&t.authorityLevel===r("LSAuthorityLevel").OPTIMISTIC}).map(function(e){return e.pk});o.length>0&&await t.stores.persisted_recovery_code.bulkDelete(o)},"RecoveryCodeDB - cleanup recovery code optimistic")}var m=!1,p=new Map;async function _(t,n,a){if(r("justknobx")._("5261")&&m===!0)return o("EBLogger").EBLogger().warn("initializeBackup: init in progress"),t.endFail(o("EBAPIQPLPoints").EBBackupInitQPLPoints.INITIALIZE_BACKUP_RUNNING),Promise.resolve(o("WAResultOrError").makeError("init_in_progress"));m=!0;var i=null;try{if((e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(16))){var l=await o("RecoveryCodeDB").getOrCreateRecoveryCodeDB(),_=await l.runInTransaction(["persisted_recovery_code"],"readonly",async function(e){var t=await e.stores.persisted_recovery_code.readAll(),n=t.find(function(e){return e.virtualDeviceType===16&&e.authorityLevel===r("LSAuthorityLevel").OPTIMISTIC});return n!=null?{pk:n.pk,recoveryCode:n.recoveryCode}:null},"RecoveryCodeDB - read existing optimistic recovery code");t.addAnnotations({bool:{is_auto_eb_retry:_!=null}});var f=r("justknobx")._("776");if(_!=null&&f)return o("EBLogger").EBLogger().mustfix("Auto EB initBackup retry prevented by killswitch: wmi/armadillo:stop_auto_eb_initbackup_retry"),t.endFail("auto_eb_retry_prevented_by_killswitch"),await d(16),m=!1,Promise.resolve(o("WAResultOrError").makeError("auto_eb_init_failed"));if(_!=null)i=_.recoveryCode,t.addAnnotations({int:{recovery_code_db_pk:_.pk}});else{var g=await r("EBSMAPI").generateRecoveryCode({virtualDeviceType:n});if(g.success===!1)return t.endFail("generate_recovery_code_failure"),m=!1,g;g.success===!0&&(i=g.value.recoveryCode,await u(i,16))}}}catch(a){var h=r("getErrorSafe")(a);return t.endFail("auto_eb_init_failed"),o("EBLogger").EBLogger().catching(h).mustfix("Auto EB init failed."),(e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(16))&&await d(16),m=!1,Promise.resolve(o("WAResultOrError").makeError("auto_eb_init_failed"))}var y=function(){},C=new Promise(function(e,n){window.setTimeout(function(){y(),o("EBLogger").EBLogger().warn("Init backup failed by timeout"),t.endFail(o("EBAPIQPLPoints").EBBackupInitQPLPoints.INITIALIZE_BACKUP_TIMEOUT),e(o("WAResultOrError").makeError("timed_out"))},r("justknobx")._("4211"))}),b=new Promise(async function(l,u){var m=o("MWEncryptedBackupsDeviceRegistrationId").getDeviceRegistrationId();if(t.addAnnotations({string:{deviceRegistrationId:m}}),m===""){t.endFail("device_registration_id_null"),l(o("WAResultOrError").makeError("device_registration_id_null"));return}t.addPoint(o("EBAPIQPLPoints").EBBackupInitQPLPoints.GET_DB_START);var _=await o("EBDeps").getDeps().getLSDB();t.addPoint(o("EBAPIQPLPoints").EBBackupInitQPLPoints.GET_DB_END),y=_.tables.secure_encrypted_backups_client_state.subscribe(async function(a,u){if(u.operation==="delete"){t.addPoint(o("EBAPIQPLPoints").EBBackupInitQPLPoints.INITIALIZE_BACKUP_SUBSCRIPTION_DELETE,{int:{deleteAuthorityLevel:(e||(e=o("I64"))).to_int32(u.prevValue.authorityLevel),deleteBackupId:e.to_int32(u.prevValue.backupId),deleteInputVirtualDeviceType:e.to_int32(n)}});return}var d=u.value,m=d.authorityLevel,p=d.backupId;(e||(e=o("I64"))).equal(m,(s||(s=o("LSIntEnum"))).ofNumber(r("LSAuthorityLevel").AUTHORITATIVE))?(t.addPoint(o("EBAPIQPLPoints").EBBackupInitQPLPoints.INITIALIZE_BACKUP_END),i!=null&&(e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(16))&&await c(i,16),y(),t.addPoint(o("EBAPIQPLPoints").EBBackupInitQPLPoints.FETCH_BACKUP_IDS_START),r("EBSMAPI").fetchBackupIds("EBInitializeBackup").finally(function(){t.addPoint(o("EBAPIQPLPoints").EBBackupInitQPLPoints.FETCH_BACKUP_IDS_END),t.endSuccess(),o("EBMainThreadEBDBApiDeferred").addNewDevice()}),l(o("WAResultOrError").makeResult(p))):t.addPoint(o("EBAPIQPLPoints").EBBackupInitQPLPoints.OPTIMISTIC_CLIENT_STATE,{int:{ocsAuthorityLevel:(e||(e=o("I64"))).to_int32(m),ocsBackupId:e.to_int32(p),ocsInputVirtualDeviceType:e.to_int32(n)},string:{ocsOperation:u.operation}})}),p.set(t.getQPLAttrs().instanceKey.toString(),{clientStateUnsubscribe:y,qplFlow:t,resolve:l}),t.addPoint(o("EBAPIQPLPoints").EBBackupInitQPLPoints.INITIALIZE_BACKUP_SPROC_START);var f=await o("MWEncryptedBackupsInitializeBackup").initializeBackupStoredProcedure(_,m,o("MAWTraceUtils").stringToTraceId(t.getQPLAttrs().instanceKey.toString()),a),g=f[0];if((e||(e=o("I64"))).equal(g,(s||(s=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsOpStatus").FAILURE))){t.endFail(o("EBAPIQPLPoints").EBBackupInitQPLPoints.INITIALIZE_BACKUP_SPROC_FAIL),(e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(16))&&await d(16),l(o("WAResultOrError").makeError("sproc_failure"));return}t.addPoint(o("EBAPIQPLPoints").EBBackupInitQPLPoints.INITIALIZE_BACKUP_SPROC_END,{int:{sproc_status:(e||(e=o("I64"))).to_int32(g)}})});return Promise.race([b,C]).then(function(e){return e}).finally(function(){p.delete(t.getQPLAttrs().instanceKey.toString()),m=!1})}async function f(t,n,r){var a=p.get(t);a!=null&&(a.resolve(o("WAResultOrError").makeError("initialize_backup_fail")),a.qplFlow.endFail(o("EBAPIQPLPoints").EBBackupInitQPLPoints.INITIALIZE_BACKUP_FAIL,{string:{errorMsg:n}}),a.clientStateUnsubscribe()),r!=null&&(e||(e=o("I64"))).equal(r,(s||(s=o("LSIntEnum"))).ofNumber(16))&&await d(16),p.delete(t)}l.initializeBackup=_,l.resolveInitializeBackupPromiseWithError=f}),98);
__d("EBOptOut",["EBAPIQPLPoints","EBDeps","EBSMAPI","ReQL","WAResultOrError","promiseDone","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e=r("requireDeferred")("encryptedBackupsOptOutOfBackup").__setRef("EBOptOut");function s(t){var n=t.qplFlow;return new Promise(function(t,a){return void e.load().then(async function(e){n.addPoint("eb_opt_out_get_db_start");var a=await o("EBDeps").getDeps().getLSDB();n.addPoint("eb_opt_out_get_db_end"),r("promiseDone")(e.optOutOfBackupStoredProcedure(a),function(e){n.addPoint(o("EBAPIQPLPoints").EBOptOutQPLPoints.OPT_OUT_BACKUP_SPROC_END);var i=a.tables.secure_encrypted_backups_client_state.subscribe(function(){r("promiseDone")(o("ReQL").toArrayAsync(o("ReQL").fromTableAscending(a.tables.secure_encrypted_backups_client_state)),function(e){if(e!=null)if(e.length===0)r("promiseDone")(r("EBSMAPI").fetchBackupIds("useEncryptedBackupsOptOutOfBackupDeferred.react").finally(function(){n.addPoint(o("EBAPIQPLPoints").EBOptOutQPLPoints.OPT_OUT_BACKUP_TASK_END),n.endSuccess(),i(),t(o("WAResultOrError").makeResult())}));else{n.addPoint(o("EBAPIQPLPoints").EBOptOutQPLPoints.OPT_OUT_BACKUP_ROW_EXISTS);return}else n.addPoint(o("EBAPIQPLPoints").EBOptOutQPLPoints.OPT_OUT_BACKUP_ROW_NULL),n.endFail("opt_out_backup_row_null"),i(),t(o("WAResultOrError").makeError("EB_OPT_OUT_CLIENT_STATE_NULL"))})})},function(){n.addPoint(o("EBAPIQPLPoints").EBOptOutQPLPoints.OPT_OUT_BACKUP_SPROC_FAIL),n.endFail("opt_out_backup_sproc_fail"),t(o("WAResultOrError").makeError("EB_OPT_OUT_SPROC_FAILURE"))})})})}l.ebOptOut=s}),98);
__d("LSGenerateLocalKeys",["LSArrayGetObjectAt","LSCreateAuthKeyPair.nop","LSCreateEncryptionKeyPair.nop","LSCreateSignatureKeyPair.nop","LSCreateSignature_v2.nop","LSIsEncryptionVersionSecure","LSLogMebClientEvent.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][generateLocalKeys] Beginning execution."),r[1]=t.i64.of_float(Date.now()),e[0]?t.sequence([function(e){return t.islc(t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))||!0}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,n){var o,a,i=e.done,l=e.value;return i?(r[29]=new t.Map,r[29].set("error_msg","Expected a nonempty query result"),r[29].set("code",t.i64.cast([0,3])),r[29].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),r[30]=t.createArray(),r[31]=(r[30].push(r[29]),r[30]),o=[void 0,r[30]],r[17]=o[0],r[18]=o[1]):(n=l.item,r[29]=new t.Map,r[29].set("backup_id",n.backupId),r[29].set("device_public_key_blob",n.devicePublicKeyBlob),r[29].set("device_private_key_blob",n.devicePrivateKeyBlob),r[29].set("epoch_storage_public_key_blob",n.epochStoragePublicKeyBlob),r[29].set("epoch_storage_private_key_blob",n.epochStoragePrivateKeyBlob),r[29].set("epoch_auth_public_key_blob",n.epochAuthPublicKeyBlob),r[29].set("epoch_auth_private_key_blob",n.epochAuthPrivateKeyBlob),r[29].set("mailbox_root_key_blob",n.mailboxRootKeyBlob),r[29].set("ocmf_client_state_blob",n.ocmfClientStateBlob),r[29].set("orf_client_state_v2_blob",void 0),r[29].set("orf_v2_authority_level",void 0),r[29].set("oblivious_validation_token_blob",n.obliviousValidationTokenBlob),r[29].set("device_id",n.deviceId),r[29].set("backup_tenancy",n.backupTenancy),r[29].set("encryption_version",n.encryptionVersion),r[29].set("revision_version",n.revisionVersion),r[29].set("initialize_restore_result",void 0),r[29].set("device_creation_timestamp_sec",void 0),r[29].set("authority_level",n.authorityLevel),a=[r[29],void 0],r[17]=a[0],r[18]=a[1])})},function(e){return r[20]=new t.Map,r[20].set("value",r[17]),r[20].set("errors",r[18]),r[21]=r[20].get("value"),r[21]!==void 0?t.sequence([function(e){return r[29]=r[21].get("backup_id"),r[30]=r[21].get("device_public_key_blob"),r[31]=r[21].get("device_private_key_blob"),r[32]=r[21].get("epoch_storage_public_key_blob"),r[33]=r[21].get("epoch_storage_private_key_blob"),r[34]=r[21].get("epoch_auth_public_key_blob"),r[35]=r[21].get("epoch_auth_private_key_blob"),r[36]=r[21].get("mailbox_root_key_blob"),r[37]=r[21].get("ocmf_client_state_blob"),r[38]=r[21].get("orf_client_state_v2_blob"),r[39]=r[21].get("orf_v2_authority_level"),r[40]=r[21].get("oblivious_validation_token_blob"),r[41]=r[21].get("device_id"),r[42]=r[21].get("backup_tenancy"),r[43]=r[21].get("encryption_version"),r[44]=r[21].get("revision_version"),r[45]=r[21].get("initialize_restore_result"),r[46]=r[21].get("device_creation_timestamp_sec"),r[47]=r[21].get("authority_level"),t.i64.neq(r[41],void 0)?t.sequence([function(e){return r[55]=void 0,t.i64.neq(r[55],void 0)?t.resolve(r[56]=r[55]):t.sequence([function(e){return r[59]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,r[60]=t[0],t})},function(e){return r[60]&&(r[69]=(r[59].push(t.i64.cast([0,0])),r[59])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,r[61]=t[0],t})},function(e){return r[61]&&(r[69]=(r[59].push(t.i64.cast([0,2])),r[59])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,r[62]=t[0],t})},function(e){return r[62]&&(r[69]=(r[59].push(t.i64.cast([0,3])),r[59])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,r[63]=t[0],t})},function(e){return r[63]&&(r[69]=(r[59].push(t.i64.cast([0,4])),r[59])),r[64]=t.createArray(),r[65]=t.i64.of_int32(r[59].length),t.i64.gt(r[65],t.i64.cast([0,0]))?t.loopAsync(r[65],function(e){return r[69]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[59],r[69]).then(function(e){var t;return t=e,r[70]=t[0],r[71]=t[1],t})},function(e){return r[72]=(r[64].push(r[70]),r[64])}])}):t.resolve()},function(e){return t.sequence([function(e){return r[69]=t.createArray(),r[70]=t.i64.of_int32(r[64].length),t.i64.gt(r[70],t.i64.cast([0,0]))?t.loopAsync(r[70],function(e){return r[72]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[64],r[72]).then(function(e){var t;return t=e,r[73]=t[0],r[74]=t[1],t})},function(e){return r[75]=(r[69].push(t.i64.to_string(r[73])),r[69])}])}):t.resolve()},function(e){return r[71]=r[69].join(","),r[66]=r[71]}])},function(e){return r[64].some(function(e){return t.i64.eq(r[43],e)})?r[67]=r[43]:r[67]=void 0,t.i64.neq(r[67],void 0)?r[68]=r[67]:r[68]=void 0,r[56]=r[68]}])},function(e){var n;return t.i64.neq(r[56],void 0)?r[57]=r[56]:r[57]=t.i64.cast([0,0]),t.i64.neq(r[42],void 0)?r[58]=r[42]:r[58]=t.i64.cast([0,1]),n=[!0,r[30],r[31],r[32],r[33],r[34],r[35]],r[48]=n[0],r[49]=n[1],r[50]=n[2],r[51]=n[3],r[52]=n[4],r[53]=n[5],r[54]=n[6]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateLocalKeysStoredProcedure] Fetching keys locally failed. Reason: 24"),r[56]="Fetching keys locally failed. Reason: 24",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateLocalKeysStoredProcedure] ","",r[56]].join("")),r[55]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateLocalKeysStoredProcedure",r[56],r[55],t.i64.cast([0,3]))},function(e){var n;return n=[!1,t.blob("ZGV2aWNlX3B1YmxpY19rZXk="),t.blob("ZGV2aWNlX3ByaXZhdGVfa2V5"),t.blob("ZXBvY2hfc3RvcmFnZV9wdWJsaWNfa2V5"),t.blob("ZXBvY2hfc3RvcmFnZV9wcml2YXRlX2tleQ=="),t.blob("ZXBvY2hfYXV0aF9wdWJsaWNfa2V5"),t.blob("ZXBvY2hfYXV0aF9wcml2YXRlX2tleQ==")],r[48]=n[0],r[49]=n[1],r[50]=n[2],r[51]=n[3],r[52]=n[4],r[53]=n[5],r[54]=n[6],n}])},function(e){var t;return t=[r[48],r[49],r[50],r[51],r[52],r[53],r[54]],r[22]=t[0],r[23]=t[1],r[24]=t[2],r[25]=t[3],r[26]=t[4],r[27]=t[5],r[28]=t[6],t}]):t.sequence([function(e){return r[29]=r[20].get("errors"),r[30]=r[20].get("errors"),(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsGenerateLocalKeysStoredProcedure] Fetching keys locally failed. Reason: 1"),r[32]="Fetching keys locally failed. Reason: 1",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGenerateLocalKeysStoredProcedure] ","",r[32]].join("")),r[31]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGenerateLocalKeysStoredProcedure",r[32],r[31],t.i64.cast([0,3]))},function(e){var n;return n=[!1,t.blob("ZGV2aWNlX3B1YmxpY19rZXk="),t.blob("ZGV2aWNlX3ByaXZhdGVfa2V5"),t.blob("ZXBvY2hfc3RvcmFnZV9wdWJsaWNfa2V5"),t.blob("ZXBvY2hfc3RvcmFnZV9wcml2YXRlX2tleQ=="),t.blob("ZXBvY2hfYXV0aF9wdWJsaWNfa2V5"),t.blob("ZXBvY2hfYXV0aF9wcml2YXRlX2tleQ==")],r[22]=n[0],r[23]=n[1],r[24]=n[2],r[25]=n[3],r[26]=n[4],r[27]=n[5],r[28]=n[6],n}])},function(e){var t;return t=[r[22],r[23],r[24],r[25],r[26],r[27],r[28]],r[2]=t[0],r[3]=t[1],r[4]=t[2],r[5]=t[3],r[6]=t[4],r[7]=t[5],r[8]=t[6],t}]):t.sequence([function(e){return t.nativeOperation(n("LSCreateSignatureKeyPair.nop")).then(function(e){var t;return t=e,r[17]=t[0],r[18]=t[1],t})},function(e){return t.nativeOperation(n("LSCreateEncryptionKeyPair.nop")).then(function(e){var t;return t=e,r[19]=t[0],r[20]=t[1],t})},function(e){return t.nativeOperation(n("LSCreateAuthKeyPair.nop")).then(function(e){var t;return t=e,r[21]=t[0],r[22]=t[1],t})},function(e){var t;return t=[!0,r[18],r[17],r[20],r[19],r[22],r[21]],r[2]=t[0],r[3]=t[1],r[4]=t[2],r[5]=t[3],r[6]=t[4],r[7]=t[5],r[8]=t[6],t}])},function(e){var o;return r[2]?t.sequence([function(e){return t.nativeOperation(n("LSCreateSignature_v2.nop"),r[4],t.blob("MA=="),r[5]).then(function(e){var t;return t=e,r[17]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateSignature_v2.nop"),r[4],t.blob("MQ=="),r[7]).then(function(e){var t;return t=e,r[18]=t[0],t})},function(e){var n;return r[19]=new t.Map,r[19].set("device_private_key",r[4]),r[19].set("device_public_key",r[3]),r[20]=new t.Map,r[20].set("epoch_storage_private_key",r[6]),r[20].set("epoch_storage_public_key",r[5]),r[21]=new t.Map,r[21].set("epoch_auth_private_key",r[8]),r[21].set("epoch_auth_public_key",r[7]),r[22]=new t.Map,r[22].set("device_key",r[19]),r[22].set("epoch_storage_key",r[20]),r[22].set("epoch_storage_public_key_sig",r[17]==null?t.blob("bnVsbA=="):r[17]),r[22].set("epoch_auth_key",r[21]),r[22].set("epoch_auth_public_key_sig",r[18]==null?t.blob("bnVsbA=="):r[18]),n=[r[22],void 0],r[9]=n[0],r[10]=n[1]}]):t.resolve((r[17]=new t.Map,r[17].set("error_code",t.i64.cast([0,9])),r[17].set("stored_procedure","LSEncryptedBackupsGenerateLocalKeysStoredProcedure"),r[17].set("error_message",""),o=[void 0,r[17]],r[9]=o[0],r[10]=o[1]))},function(e){return r[11]=t.i64.of_float(Date.now()),r[12]=t.i64.random(),r[14]="Finishing execution. Execution time: ",r[15]=t.i64.to_string(t.i64.sub(r[11],r[0])),r[16]=" ms",r[13]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][generateLocalKeys] ",r[13],r[14],r[13],r[15],r[13],r[16]].join("")),t.i64.eq(t.i64.mod_(r[12],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[17]=",",r[18]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"generateLocalKeys",[r[14],r[17],r[15],r[17],r[16]].join(""),r[18],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[r[9],r[10]],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsGenerateLocalKeysStoredProcedure",e.__tables__=["secure_encrypted_backups_client_state"],a.exports=e}),null);
__d("LSFinishAddPeerDevice",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDebugToken.nop","LSCreateDerivedKeys.nop","LSCreateSignature_v2.nop","LSDeleteBackupOnClient","LSGenerateLocalKeys","LSGetBlobFromString.nop","LSHmac_v2.nop","LSIsEncryptionVersionSecure","LSIsMobileClient","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop","LSOcmfClientEvolve_v2.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(e){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure] Beginning execution."),t.sequence([function(e){return t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,r[8]=t[0],t})},function(e){return r[8]?r[9]=!0:r[9]=!1,r[9]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),r[11]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",r[11]].join("")),r[10]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",r[11],r[10],t.i64.cast([0,3]))):t.resolve()}])},function(o){return t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))}).next().then(function(o,a){var i=o.done,l=o.value;return i?t.sequence([function(e){return t.db.table(168).fetch().next().then(function(e,r){var o=e.done,a=e.value;return o?0:(r=a.item,t.storedProcedure(n("LSDeleteBackupOnClient"),r.backupId,void 0,!1,void 0,"null",!0))})},function(o){return r[8]=e[0].get("backup_id"),t.storedProcedure(n("LSGenerateLocalKeys"),!1).then(function(e){var t;return t=e,r[9]=t[0],r[10]=t[1],t})},function(o){return r[9]!==void 0?t.sequence([function(e){return r[11]=r[9].get("device_key"),r[12]=r[9].get("epoch_storage_key"),r[13]=r[9].get("epoch_auth_key"),r[14]=r[11].get("device_private_key"),r[15]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,r[16]=t[0],t})},function(e){return r[16]&&(r[44]=(r[15].push(t.i64.cast([0,0])),r[15])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,r[17]=t[0],t})},function(e){return r[17]&&(r[44]=(r[15].push(t.i64.cast([0,2])),r[15])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,r[18]=t[0],t})},function(e){return r[18]&&(r[44]=(r[15].push(t.i64.cast([0,3])),r[15])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,r[19]=t[0],t})},function(e){return r[19]&&(r[44]=(r[15].push(t.i64.cast([0,4])),r[15])),r[20]="",r[21]=t.i64.of_int32(r[15].length),t.i64.gt(r[21],t.i64.cast([0,0]))?t.loopAsync(r[21],function(e){return r[44]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[15],r[44]).then(function(e){var t;return t=e,r[45]=t[0],r[46]=t[1],t})},function(e){return r[20]=[r[20],"_",t.i64.to_string(r[45])].join("")}])}):t.resolve()},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),["supported_versions_",r[20],"revision_version_",t.i64.to_string(t.i64.cast([0,1]))].join("")).then(function(e){var t;return t=e,r[22]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateSignature_v2.nop"),r[14],t.blob("Mg=="),r[22]).then(function(e){var t;return t=e,r[23]=t[0],t})},function(e){return t.blobs.neq(r[23],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[23]).then(function(e){var t;return t=e,r[44]=t[0],t})},function(e){return r[24]=r[44]}]):t.resolve(r[24]=void 0)},function(o){return r[25]=e[0].get("temp_ocmf_client_state"),t.nativeOperation(n("LSOcmfClientEvolve_v2.nop"),r[25]).then(function(e){var t;return t=e,r[26]=t[0],r[27]=t[1],t})},function(e){var o;return t.blobs.neq(void 0,void 0)?t.sequence([function(e){return t.nativeOperation(n("LSOcmfClientEvolve_v2.nop"),void 0).then(function(e){var t;return t=e,r[44]=t[0],r[45]=t[1],t})},function(e){var t;return t=[r[26],r[27],r[44],r[45]],r[28]=t[0],r[29]=t[1],r[30]=t[2],r[31]=t[3],t}]):t.resolve((o=[r[26],r[27],void 0,void 0],r[28]=o[0],r[29]=o[1],r[30]=o[2],r[31]=o[3],o))},function(n){return r[32]=r[11].get("device_public_key"),r[33]=r[11].get("device_private_key"),r[34]=r[12].get("epoch_storage_public_key"),r[35]=r[12].get("epoch_storage_private_key"),r[36]=r[13].get("epoch_auth_public_key"),r[37]=r[13].get("epoch_auth_private_key"),r[38]=e[0].get("mailbox_root_key"),r[39]=e[0].get("oblivious_validation_token"),t.forEach(t.filter(t.db.table(168).fetch([[[r[8]]]]),function(e){return t.i64.eq(e.backupId,r[8])&&t.i64.lt(e.authorityLevel,t.i64.cast([0,20]))}),function(e){return e.delete()})},function(e){return t.db.table(168).add({backupId:r[8],devicePublicKeyBlob:r[32],devicePrivateKeyBlob:r[33],epochStoragePublicKeyBlob:r[34],epochStoragePrivateKeyBlob:r[35],epochAuthPublicKeyBlob:r[36],epochAuthPrivateKeyBlob:r[37],mailboxRootKeyBlob:r[38],ocmfClientStateBlob:r[28],obliviousValidationTokenBlob:r[39],authorityLevel:t.i64.cast([0,20]),backupTenancy:t.i64.cast([0,1]),revisionVersion:t.i64.cast([0,1]),encryptionVersion:t.i64.cast([0,0])})},function(o){return r[40]=e[0].get("add_peer_epoch_data"),r[41]=t.i64.of_int32(r[40].length),t.i64.gt(r[41],t.i64.cast([0,0]))?t.loopAsync(r[41],function(e){return r[44]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[40],r[44]).then(function(e){var t;return t=e,r[45]=t[0],r[46]=t[1],t})},function(e){return r[47]=r[45].get("epoch_id"),r[48]=r[45].get("epoch_anon_id"),r[49]=r[45].get("epoch_root_key"),r[50]=r[45].get("epoch_status"),r[51]=r[45].get("epoch_head"),t.forEach(t.filter(t.db.table(169).fetch([[[r[47]]]]),function(e){return t.i64.eq(e.epochId,r[47])&&t.i64.lt(e.authorityLevel,t.i64.cast([0,80]))}),function(e){return e.delete()})},function(e){return t.db.table(169).add({epochId:r[47],authorityLevel:t.i64.cast([0,80]),backupId:r[8],epochAnonIdBlob:r[48],epochRootKeyBlob:r[49],epochStatus:r[50],epochHead:r[51]})}])}):t.resolve()},function(e){return t.count(t.db.table(169).fetch()).then(function(e){return r[42]=e})},function(e){return t.i64.le(r[42],t.i64.cast([0,1]))?t.sequence([function(e){return t.db.table(169).fetch().next().then(function(e,o){var a=e.done,i=e.value;return a?t.sequence([function(e){return r[46]="No epoch available in epochs table",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure] ","",r[46]].join("")),r[47]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure",[r[46]].join(""),r[47],t.i64.cast([0,3]))},function(e){return r[44]=void 0}]):(o=i.item,r[46]=new t.Map,r[46].set("epoch_id",o.epochId),r[46].set("backup_id",o.backupId),r[46].set("epoch_anon_id_blob",o.epochAnonIdBlob),r[46].set("epoch_root_key_blob",o.epochRootKeyBlob),r[46].set("epoch_status",o.epochStatus),r[46].set("epoch_head",o.epochHead),r[46].set("authority_level",o.authorityLevel),r[44]=r[46])})},function(e){return r[43]=r[44]}]):t.sequence([function(e){return r[44]="Multiple epochs available in epochs table",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure] ","",r[44]].join("")),r[45]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure",[r[44]].join(""),r[45],t.i64.cast([0,3]))},function(e){return r[43]=void 0}])},function(o){return r[43]!==void 0?t.sequence([function(e){return r[44]=r[43].get("epoch_anon_id_blob"),r[45]=r[43].get("epoch_root_key_blob"),r[46]=r[11].get("device_public_key"),r[47]=t.createArray(),r[51]=(r[47].push(t.i64.cast([0,32])),r[47]),t.nativeOperation(n("LSBase64Encode.nop"),r[44]).then(function(e){var t;return t=e,r[48]=t[0],t})},function(e){return r[48]!==void 0?t.sequence([function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blobs.of_string(["epoch_devices","_",r[48]].join("")),void 0,r[45],r[47]).then(function(e){var t;return t=e,r[51]=t[0],t})},function(e){return r[51]?r[52]=!1:r[52]=!0,r[52]?t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish"),r[55]="THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoEpochUtils] ","",r[55]].join("")),r[54]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils",r[55],r[54],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,r[56]=t[0],t})},function(e){return r[53]=r[56]}]):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[51],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[54]=t[0],r[55]=t[1],t})},function(e){return r[53]=r[54]}])},function(e){return r[49]=r[53]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish"),r[52]="THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoEpochUtils] ","",r[52]].join("")),r[51]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils",r[52],r[51],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,r[53]=t[0],t})},function(e){return r[49]=r[53]}])},function(e){return t.nativeOperation(n("LSHmac_v2.nop"),r[49],r[46]).then(function(e){var t;return t=e,r[50]=t[0],t})},function(o){return t.blobs.neq(r[50],void 0)?t.sequence([function(e){return r[51]=r[11].get("device_public_key"),t.nativeOperation(n("LSBase64Encode.nop"),r[51]).then(function(e){var t;return t=e,r[52]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[50]).then(function(e){var t;return t=e,r[53]=t[0],t})},function(e){return r[54]=r[43].get("epoch_root_key_blob"),t.blobs.neq(r[54],void 0)?t.sequence([function(e){return r[81]=t.createArray(),r[87]=(r[81].push(t.i64.cast([0,18])),r[81]),t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,r[54],r[81]).then(function(e){var t;return t=e,r[82]=t[0],t})},function(e){return r[82]!==void 0?t.sequence([function(e){return r[87]=t.i64.of_int32(r[82].length),t.i64.ge(r[87],t.i64.cast([0,1]))?t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[82],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[89]=t[0],r[90]=t[1],t})},function(e){return r[88]=r[89]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),r[90]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBFingerprint] ","",r[90]].join("")),r[89]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBFingerprint",r[90],r[89],t.i64.cast([0,3]))},function(e){return r[88]=void 0}])},function(e){return r[83]=r[88]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),r[88]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBFingerprint] ","",r[88]].join("")),r[87]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBFingerprint",r[88],r[87],t.i64.cast([0,3]))},function(e){return r[83]=void 0}])},function(e){return t.blobs.neq(r[83],void 0)?r[84]=!0:r[84]=!1,r[84]||((function(e){t.logger(e).mustfix(e)})("LS::assert is failed. Attempting to coerce a null value to nonnull."),t.throw("LS::assert is failed. Attempting to coerce a null value to nonnull.")),t.nativeOperation(n("LSBase64Encode.nop"),r[83]).then(function(e){var t;return t=e,r[85]=t[0],t})},function(e){return r[85]!==void 0?r[86]=r[85]:r[86]="encodingfailed",r[55]=r[86]}]):t.resolve(r[55]="null")},function(e){return r[56]=r[12].get("epoch_storage_public_key"),t.nativeOperation(n("LSBase64Encode.nop"),r[56]).then(function(e){var t;return t=e,r[57]=t[0],t})},function(e){return r[58]=r[9].get("epoch_storage_public_key_sig"),t.nativeOperation(n("LSBase64Encode.nop"),r[58]).then(function(e){var t;return t=e,r[59]=t[0],t})},function(e){return r[60]=r[13].get("epoch_auth_public_key"),t.nativeOperation(n("LSBase64Encode.nop"),r[60]).then(function(e){var t;return t=e,r[61]=t[0],t})},function(e){return r[62]=r[9].get("epoch_auth_public_key_sig"),t.nativeOperation(n("LSBase64Encode.nop"),r[62]).then(function(e){var t;return t=e,r[63]=t[0],t})},function(o){return r[64]=r[11].get("device_private_key"),r[65]=e[0].get("mailbox_root_key"),r[66]=r[12].get("epoch_storage_private_key"),t.blobs.neq(r[65],void 0)?t.sequence([function(e){return r[81]=new t.Map,t.nativeOperation(n("LSCreateDebugToken.nop"),r[65],"private_key",r[64],t.i64.cast([0,1]),r[81]).then(function(e){var t;return t=e,r[82]=t[0],t})},function(e){return t.blobs.neq(r[82],void 0)?r[83]=r[82]:r[83]=void 0,r[67]=r[83]}]):t.resolve(r[67]=void 0)},function(e){return t.blobs.neq(r[67],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[67]).then(function(e){var t;return t=e,r[81]=t[0],t})},function(e){return r[68]=r[81]}]):t.resolve(r[68]=void 0)},function(e){return t.blobs.neq(r[65],void 0)?t.sequence([function(e){return r[81]=new t.Map,t.nativeOperation(n("LSCreateDebugToken.nop"),r[65],"ocmf_client_state",r[28],t.i64.cast([0,1]),r[81]).then(function(e){var t;return t=e,r[82]=t[0],t})},function(e){return t.blobs.neq(r[82],void 0)?r[83]=r[82]:r[83]=void 0,r[69]=r[83]}]):t.resolve(r[69]=void 0)},function(e){return t.blobs.neq(r[69],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[69]).then(function(e){var t;return t=e,r[81]=t[0],t})},function(e){return r[70]=r[81]}]):t.resolve(r[70]=void 0)},function(e){return t.blobs.neq(r[65],void 0)?t.sequence([function(e){return r[81]=new t.Map,t.nativeOperation(n("LSCreateDebugToken.nop"),r[65],"epoch_storage_private_key",r[66],t.i64.cast([0,1]),r[81]).then(function(e){var t;return t=e,r[82]=t[0],t})},function(e){return t.blobs.neq(r[82],void 0)?r[83]=r[82]:r[83]=void 0,r[71]=r[83]}]):t.resolve(r[71]=void 0)},function(e){return t.blobs.neq(r[71],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[71]).then(function(e){var t;return t=e,r[81]=t[0],t})},function(e){return r[72]=r[81]}]):t.resolve(r[72]=void 0)},function(o){return r[73]=e[0].get("backup_id"),t.nativeOperation(n("LSBase64Encode.nop"),r[29]).then(function(e){var t;return t=e,r[74]=t[0],t})},function(o){return r[75]=e[0].get("server_data_id"),r[76]=r[43].get("epoch_id"),r[77]=new t.Map,r[77].set("supported_encryption_versions",r[15]),r[77].set("client_version",t.i64.cast([0,1])),r[77].set("version_sig",r[24]==null?"":r[24]),r[78]=new t.Map,r[78].set("backup_id",r[73]),r[78].set("device_epoch_hmac",r[53]==null?"":r[53]),r[78].set("epoch_root_key_fingerprint",r[55]),r[78].set("device_public_key",r[52]==null?"":r[52]),r[78].set("epoch_auth_pubkey",r[61]==null?"":r[61]),r[78].set("epoch_auth_pubkey_sig",r[63]==null?"":r[63]),r[78].set("epoch_storage_pubkey",r[57]==null?"":r[57]),r[78].set("epoch_storage_pubkey_sig",r[59]==null?"":r[59]),r[78].set("ocmf_rotation_token",r[74]==null?"":r[74]),r[78].set("server_data_id",r[75]),r[78].set("device_registration_id",e[1]),r[78].set("base_epoch_id",r[76]),r[78].set("encryption_version_data",r[77]),r[78].set("private_key_debug_token",r[68]),r[78].set("ocmf_client_state_debug_token",r[70]),r[78].set("epoch_storage_pvtkey_debug_token",r[72]),r[78].set("trace_id",void 0),r[78].set("occam_only_eligible",!0),r[79]=t.toJSON(r[78]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",t.i64.cast([0,50017]),r[79],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,r[80]=t[0],t})}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure] $device_epoch_hmac found to be null"),r[51]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure","$device_epoch_hmac found to be null",r[51],t.i64.cast([0,3]))},function(e){return t.storedProcedure(n("LSDeleteBackupOnClient"),r[8],"backup_init_flow",!0,void 0,void 0,!1)},function(e){return t.forEach(t.db.table(169).fetch(),function(e){return e.delete()})}])}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure] Error! There should be exactly one open epoch. Deleting local state and terminating device addition"),r[44]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure","Error! There should be exactly one open epoch. Deleting local state and terminating device addition",r[44],t.i64.cast([0,3]))},function(e){return t.storedProcedure(n("LSDeleteBackupOnClient"),r[8],"backup_init_flow",!0,void 0,void 0,!1)},function(e){return t.forEach(t.db.table(169).fetch(),function(e){return e.delete()})}])}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure] Error! Error in generating the keys. Deleting local state and terminating device addition"),r[11]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure","Error! Error in generating the keys. Deleting local state and terminating device addition",r[11],t.i64.cast([0,3]))},function(e){return t.storedProcedure(n("LSDeleteBackupOnClient"),r[8],"backup_init_flow",!0,void 0,void 0,!1)},function(e){return t.forEach(t.db.table(169).fetch(),function(e){return e.delete()})}])}]):(a=l.item,r[8]="An authoritative row already exists, aborting execution of add peer device",r[8]!==void 0?((function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure] ","",r[8]].join("")),r[9]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure",r[8],r[9],t.i64.cast([0,3]))):t.resolve())})},function(e){return r[2]=t.i64.of_float(Date.now()),r[3]=t.i64.random(),r[5]="Finishing execution. Execution time: ",r[6]=t.i64.to_string(t.i64.sub(r[2],r[0])),r[7]=" ms",r[4]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure] ",r[4],r[5],r[4],r[6],r[4],r[7]].join("")),t.i64.eq(t.i64.mod_(r[3],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[8]=",",r[9]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure",[r[5],r[8],r[6],r[8],r[7]].join(""),r[9],t.i64.cast([0,4]))):t.resolve()}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsFinishAddPeerDeviceStoredProcedure",e.__tables__=["secure_encrypted_backups_client_state","secure_encrypted_backups_epochs"],a.exports=e}),null);
__d("LSDeserializeSecretsAndAddDevice",["LSArrayGetObjectAt","LSBase64Decode.nop","LSDeserializeFromJsonIntoDictionaryV2.nop","LSFinishAddPeerDevice","LSQplInteractionHelper.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),"MEB_DS_DESERIALIZE_SECRETS_NATIVE_OP_START",t.i64.cast([0,0]),void 0)},function(o){return t.nativeOperation(n("LSDeserializeFromJsonIntoDictionaryV2.nop"),e[0]).then(function(e){var t;return t=e,r[0]=t[0],t})},function(e){return t.nativeOperation(n("LSQplInteractionHelper.nop"),"MEB_DS_DESERIALIZE_SECRETS_NATIVE_OP_END",t.i64.cast([0,0]),void 0)},function(e){return r[1]=r[0].get("temp_ocmf_client_state"),t.nativeOperation(n("LSBase64Decode.nop"),r[1]).then(function(e){var t;return t=e,r[2]=t[0],t})},function(e){return r[3]=r[0].get("mailbox_root_key"),t.nativeOperation(n("LSBase64Decode.nop"),r[3]).then(function(e){var t;return t=e,r[4]=t[0],t})},function(e){return r[5]=r[0].get("oblivious_validation_token"),t.nativeOperation(n("LSBase64Decode.nop"),r[5]).then(function(e){var t;return t=e,r[6]=t[0],t})},function(e){return r[7]=t.createArray(),r[8]=r[0].get("add_peer_epoch_data_serializable"),r[9]=t.i64.of_int32(r[8].length),t.i64.gt(r[9],t.i64.cast([0,0]))?t.loopAsync(r[9],function(e){return r[14]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[8],r[14]).then(function(e){var t;return t=e,r[15]=t[0],r[16]=t[1],t})},function(e){return r[17]=r[15].get("epoch_anon_id"),t.nativeOperation(n("LSBase64Decode.nop"),r[17]).then(function(e){var t;return t=e,r[18]=t[0],t})},function(e){return r[19]=r[15].get("epoch_root_key"),t.nativeOperation(n("LSBase64Decode.nop"),r[19]).then(function(e){var t;return t=e,r[20]=t[0],t})},function(e){return r[21]=r[15].get("epoch_id"),r[22]=r[15].get("epoch_status"),r[23]=new t.Map,r[23].set("epoch_id",r[21]),r[23].set("epoch_anon_id",r[18]==null?t.blob(""):r[18]),r[23].set("epoch_root_key",r[20]==null?t.blob(""):r[20]),r[23].set("epoch_status",r[22]),r[24]=r[15].get("epoch_head"),r[24]!==void 0?t.sequence([function(e){return t.nativeOperation(n("LSBase64Decode.nop"),r[24]).then(function(e){var t;return t=e,r[25]=t[0],t})},function(e){return r[23].set("epoch_head",r[25])}]):t.resolve()},function(e){return r[25]=(r[7].push(r[23]),r[7])}])}):t.resolve()},function(o){return r[10]=r[0].get("backup_id"),r[11]=r[0].get("server_data_id"),r[12]=new t.Map,r[12].set("backup_id",r[10]),r[12].set("server_data_id",r[11]),r[12].set("temp_ocmf_client_state",r[2]==null?t.blob(""):r[2]),r[12].set("mailbox_root_key",r[4]==null?t.blob(""):r[4]),r[12].set("oblivious_validation_token",r[6]==null?t.blob(""):r[6]),r[12].set("add_peer_epoch_data",r[7]),r[12]!==void 0?t.sequence([function(o){return t.storedProcedure(n("LSFinishAddPeerDevice"),r[12],e[1])},function(e){return r[13]=!0}]):t.resolve(r[13]=!1)},function(e){return o[0]=r[13]}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsDeserializeSecretsAndAddDeviceStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSDeserializeSecretsAndAddDeviceStoredProcedure",["LSDeserializeSecretsAndAddDevice","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSDeserializeSecretsAndAddDevice"),a.serializedPayload,a.deviceRegistrationId);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("EBOtcAddDevice",["EBAPIQPLPoints","EBDeps","EBLogger","EBMainThreadEBDBApiDeferred","I64","LSDeserializeSecretsAndAddDeviceStoredProcedure","LSEncryptedBackupsRecoveryCodeStatus","LSFactory","LSIntEnum","ReQL","WAResultOrError","getSafeQplErrorMessage"],(function(t,n,r,o,a,i,l){"use strict";var e,s;async function u(t){var n=t.initiatorId,a=t.qplFlow,i=t.secrets,l=function(){};a.addPoint(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_WAIT_FOR_EBLS_START);var u=await o("EBDeps").getDeps().getLSDB();return a.addPoint(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.ADD_DEVICE_WAIT_FOR_EBLS_END),a.addPoint(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.OTC_ADD_DEVICE_SPROC_START),new Promise(function(t,d){return u.runInTransaction(function(e){return r("LSDeserializeSecretsAndAddDeviceStoredProcedure")(r("LSFactory")(e),{deviceRegistrationId:n,serializedPayload:i})},"readwrite").then(function(n){var i=n[0];if(a.addPoint(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.OTC_ADD_DEVICE_SPROC_END),!i)return a.endFail(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.OTC_ADD_DEVICE_SPROC_FAILURE),t(c("OTC_ADD_DEVICE_SPROC_FAILURE"));l=o("ReQL").fromTableAscending(u.tables.secure_encrypted_backups_recovery_code_status).subscribe(function(n,i){if(i.operation==="add"||i.operation==="put"){l();var u=i.value.recoveryCodeStatus;if((e||(e=o("I64"))).equal(u,(s||(s=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsRecoveryCodeStatus").VALID)))a.addPoint(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.OTC_ADD_DEVICE_SUCCESS),a.endSuccess(),o("EBMainThreadEBDBApiDeferred").addNewDevice(),t(c("SUCCESS"));else if((e||(e=o("I64"))).equal(u,(s||(s=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsRecoveryCodeStatus").SYSTEM_ERROR)))a.endFail(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.OTC_ADD_DEVICE_SYSTEM_ERROR),o("EBLogger").EBLogger().mustfix("PAKE: LSEncryptedBackupsFinishAddPeerDeviceTask task failed"),t(c("OTC_ADD_DEVICE_SYSTEM_ERROR"));else{var d="PAKE: Unexpected recovery code status: "+(e||(e=o("I64"))).to_int32(u);a.endFail(o("EBAPIQPLPoints").EBAddDeviceQPLPoints.OTC_ADD_DEVICE_UNEXPECTED_RECOVERY_CODE_STATUS,{string:{errorMessage:d}}),o("EBLogger").EBLogger("wmi_eb").mustfix(d),t(c("OTC_ADD_DEVICE_UNEXPECTED_RECOVERY_CODE_STATUS",d))}}})}).catch(function(e){l(),t(c("OTC_ADD_DEVICE_SPROC_ERROR",o("getSafeQplErrorMessage").getSafeQPLErrorMessage(e)))})})}function c(e,t){return e==="SUCCESS"?o("WAResultOrError").makeResult():o("WAResultOrError").makeError({errorMessage:t,status:e})}l.otcAddDevice=u}),98);
__d("EBRepairEpochQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="25352669137720538"}),null);
__d("EBRepairEpochQuery.graphql",["EBRepairEpochQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:null,kind:"ScalarField",name:"epoch_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"epoch_anon_id",storageKey:null}],r={alias:null,args:null,concreteType:"XFBEncryptedBackupMailbox",kind:"LinkedField",name:"mailbox",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"request",variableName:"input"}],concreteType:"XFBRepairEpochResponse",kind:"LinkedField",name:"repair_epoch",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_success",storageKey:null},{alias:null,args:null,concreteType:"XFBEpochDerivationSet",kind:"LinkedField",name:"epoch_derivation_set",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"target_device_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"epoch_sync_reason",storageKey:null},{alias:null,args:null,concreteType:"XFBEncryptedBackupsEpochEdge",kind:"LinkedField",name:"epoch_edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XFBEpochIds",kind:"LinkedField",name:"from_epoch",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"XFBEpochIds",kind:"LinkedField",name:"to_epoch",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"XFBEpochForwardEdge",kind:"LinkedField",name:"forward_edge",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"encrypted_entropy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"auth_public_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"epoch_storage_public_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entropy_fingerprint",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"psk_fingerprint",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"backward_edge",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"from_epoch_fingerprint",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"to_epoch_fingerprint",storageKey:null},{alias:null,args:null,concreteType:"XFBMinosEpoch",kind:"LinkedField",name:"to_minos_epoch",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"epoch_head",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"self_epoch_signature",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exception_string",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error_code",storageKey:null}],storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"EBRepairEpochQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[r],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"EBRepairEpochQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:n("EBRepairEpochQuery_facebookRelayOperation"),metadata:{},name:"EBRepairEpochQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("EBRepairEpochQuery",["EBRepairEpochQuery.graphql","WAResultOrError","createWorkerQuery"],(function(t,n,r,o,a,i,l){"use strict";var e;async function s(t){var a,i=e!==void 0?e:e=n("EBRepairEpochQuery.graphql"),l=await r("createWorkerQuery")(i,{input:t}),s=l==null||(a=l.viewer)==null||(a=a.encrypted_backup)==null||(a=a.mailbox)==null?void 0:a.repair_epoch;return(s==null?void 0:s.is_success)===!0&&(s==null?void 0:s.epoch_derivation_set)!=null?o("WAResultOrError").makeResult(s.epoch_derivation_set):(s==null?void 0:s.exception_string)!=null?o("WAResultOrError").makeError({errorCode:s.error_code,message:s.exception_string}):o("WAResultOrError").makeError({message:"Repair epoch failed"})}l.RepairEpochQuery=s}),98);
__d("EBRepairEpochs",["Base64Utils","EBAPIQPLPoints","EBDeps","EBDeriveAndStoreEpochs","EBEpochUtils","EBGetClientState","EBRepairEpochQuery","I64","LSAuthorityLevel","LSIntEnum","QPLFlow","Random","ReQL","WAResultOrError","getErrorSafe","qpl"],(function(t,n,r,o,a,i,l){"use strict";var e,s;async function u(){var t=await o("EBDeps").getDeps().getLSDB(),n=o("Random").uint32(),a=String(n),i=o("QPLFlow").startQPLFlow(r("qpl")._(521474335,"1476"),{annotations:{string:{traceId:a}},instanceKey:n});try{i.addPoint(o("EBAPIQPLPoints").EBRepairEpochsQPLPoints.GET_CLIENT_STATE_START);var l=await o("EBGetClientState").getClientState(t);if(i.addPoint(o("EBAPIQPLPoints").EBRepairEpochsQPLPoints.GET_CLIENT_STATE_END),l==null)return i.endFail("client_state_is_missing"),o("WAResultOrError").makeError({message:"Client state is missing"});var u=l.backupId,c=l.deviceId;if(u==null||c==null)return i.endFail("backup_id_or_device_id_is_missing"),o("WAResultOrError").makeError({message:"Backup ID or device ID is missing"});i.addPoint(o("EBAPIQPLPoints").EBRepairEpochsQPLPoints.GET_EPOCHS_START);var d=await o("ReQL").toArrayAsync(o("ReQL").fromTableAscending(t.tables.secure_encrypted_backups_epochs));i.addPoint(o("EBAPIQPLPoints").EBRepairEpochsQPLPoints.GET_EPOCHS_END);var m=await Promise.all(d.filter(function(t){return(e||(e=o("I64"))).equal(t.authorityLevel,(s||(s=o("LSIntEnum"))).ofNumber(r("LSAuthorityLevel").AUTHORITATIVE))}).map(async function(t){var n=await o("EBEpochUtils").getFingerPrint(t.epochRootKeyBlob,"MEBEpochRootKey");return{epoch_id:(e||(e=o("I64"))).to_string(t.epochId),fingerprint:{sensitive_string_value:o("Base64Utils").fromArrayBuffer(n)}}}));i.addPoint(o("EBAPIQPLPoints").EBRepairEpochsQPLPoints.REPAIR_EPOCH_QUERY_START);var p=await o("EBRepairEpochQuery").RepairEpochQuery({backup_id:u,device_id:c,locally_available_epochs:m,trace_id:a});if(i.addPoint(o("EBAPIQPLPoints").EBRepairEpochsQPLPoints.REPAIR_EPOCH_QUERY_END),!p.success){var _;return i.endFail("repair_epoch_query_failed",{string:{error_code:String((_=p.error.errorCode)!=null?_:"none"),error_message:p.error.message}}),p}return i.addPoint(o("EBAPIQPLPoints").EBRepairEpochsQPLPoints.DERIVE_AND_STORE_EPOCHS_START),await o("EBDeriveAndStoreEpochs").deriveAndStoreEpochsNonLS(t,p.value),i.addPoint(o("EBAPIQPLPoints").EBRepairEpochsQPLPoints.DERIVE_AND_STORE_EPOCHS_END),i.endSuccess(),p}catch(e){var f=r("getErrorSafe")(e);return i.endFail("runtime_error",{string:{error_message:f.message}}),o("WAResultOrError").makeError({message:f.message})}}l.EBRepairEpochs=u}),98);
__d("LSGetRemoveVirtualDeviceRequestStatus",["LSLogMebClientEvent.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return t.islc(t.filter(t.db.table(184).fetch(),function(n){return t.blobs.eq(n.virtualDeviceId,e[0])}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(o,a){var i=o.done,l=o.value;return i?r[0]=t.i64.cast([0,3]):(a=l.item,t.sequence([function(o){return r[3]=a.removalStatus,t.i64.eq(r[3],t.i64.cast([0,1]))?t.resolve(r[2]=t.i64.cast([0,1])):t.sequence([function(o){return t.i64.eq(r[3],t.i64.cast([0,2]))?t.resolve(r[4]=t.i64.cast([0,0])):t.sequence([function(o){return t.i64.eq(r[3],t.i64.cast([0,3]))?t.resolve(r[5]=t.i64.cast([0,2])):t.sequence([function(o){return r[6]=["Unknown RemoveVirtualDeviceStatus found ",t.i64.to_string(r[3])].join(""),r[6]!==void 0?((function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsGetRemoveVirtualDeviceRequestStatusStoredProcedure] ","",r[6]].join("")),r[7]=t.createArray(),e[1]!==void 0&&(r[8]=(r[7].push(e[1]),r[7])),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGetRemoveVirtualDeviceRequestStatusStoredProcedure",r[6],r[7],t.i64.cast([0,3]))):t.resolve()},function(e){return r[5]=t.i64.cast([-1,4294967295])}])},function(e){return r[4]=r[5]}])},function(e){return r[2]=r[4]}])},function(e){return r[0]=r[2]}]))})},function(e){return o[0]=r[0]}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsGetRemoveVirtualDeviceRequestStatusStoredProcedure",e.__tables__=["encrypted_backups_virtual_devices"],a.exports=e}),null);
__d("LSGetRemoveVirtualDeviceRequestStatusStoredProcedure",["LSGetRemoveVirtualDeviceRequestStatus","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSGetRemoveVirtualDeviceRequestStatus"),a.virtualDeviceId,a.traceId);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSRemoveVirtualDevice",["LSAppendDataTraceAddon","LSBase64Encode.nop","LSIsMobileClient","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(e){return t.sequence([function(e){return t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,r[5]=t[0],t})},function(e){return r[5]?r[6]=!0:r[6]=!1,r[6]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),r[8]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",r[8]].join("")),r[7]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",r[8],r[7],t.i64.cast([0,3]))):t.resolve()}])},function(n){return e[1]!==void 0?r[0]=e[1]:r[0]="vd_removal:remove_vd_task",t.islc(t.filter(t.db.table(184).fetch(),function(n){return t.blobs.eq(n.virtualDeviceId,e[0])}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,t){var n,o,a=e.done,i=e.value;return a?(n=[void 0,void 0],r[1]=n[0],r[2]=n[1],n):(t=i.item,o=[t.pk,t.backupId],r[1]=o[0],r[2]=o[1])})},function(o){return t.i64.neq(r[2],void 0)?t.sequence([function(o){return t.nativeOperation(n("LSBase64Encode.nop"),e[0]).then(function(e){var t;return t=e,r[5]=t[0],t})},function(e){return r[6]=new t.Map,r[6].set("backup_id",r[2]),r[6].set("virtual_device_id",r[5]==null?"":r[5]),r[6].set("removal_reason",r[0]),r[6].set("trace_id",void 0),r[7]=t.toJSON(r[6]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"messenger_encrypted_backups",t.i64.cast([0,50024]),r[7],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,r[8]=t[0],t})},function(e){return t.i64.neq(r[1],void 0)?t.forEach(t.db.table(184).fetch([[[r[1]]]]),function(e){var n=e.update,r=e.item;return n({removalStatus:t.i64.cast([0,2])})}):t.resolve()},function(e){return r[4]=t.i64.cast([0,0])}]):t.sequence([function(e){return t.sequence([function(e){return t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,r[6]=t[0],t})},function(e){return r[6]?r[7]=!0:r[7]=!1,r[7]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),r[9]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",r[9]].join("")),r[8]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",r[9],r[8],t.i64.cast([0,3]))):t.resolve()}])},function(e){return r[5]="Backup not found",r[5]!==void 0?((function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsRemoveVirtualDeviceStoredProcedure] ","",r[5]].join("")),r[6]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsRemoveVirtualDeviceStoredProcedure",r[5],r[6],t.i64.cast([0,3]))):t.resolve()},function(e){return r[4]=t.i64.cast([0,1])}])},function(e){return o[0]=r[4]}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsRemoveVirtualDeviceStoredProcedure",e.__tables__=["encrypted_backups_virtual_devices"],a.exports=e}),null);
__d("LSRemoveVirtualDeviceStoredProcedure",["LSRemoveVirtualDevice","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSRemoveVirtualDevice"),a.virtualDeviceId,a.removalReason,a.traceId);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("EBRevokeVirtualDevice",["Base64Utils","EBAPIQPLPoints","EBDeps","I64","LSEncryptedBackupsOpStatus","LSFactory","LSGetRemoveVirtualDeviceRequestStatusStoredProcedure","LSIntEnum","LSRemoveVirtualDeviceStoredProcedure","WAResultOrError","getSafeQplErrorMessage"],(function(t,n,r,o,a,i,l){"use strict";var e,s;async function u(t,n){var a,i=function(){},l=(a=n.getQPLAttrs().instanceKey.toString())!=null?a:"";n.addPoint(o("EBAPIQPLPoints").EBRevokeVirtualDeviceQPLPoints.REVOKE_VIRTUAL_DEVICE_DB_START);var u=await o("EBDeps").getDeps().getLSDB();n.addPoint(o("EBAPIQPLPoints").EBRevokeVirtualDeviceQPLPoints.REVOKE_VIRTUAL_DEVICE_DB_END);var c=o("Base64Utils").toArrayBuffer(t),d=function(t){return u.runInTransaction(function(e){return r("LSGetRemoveVirtualDeviceRequestStatusStoredProcedure")(r("LSFactory")(e),{traceId:l,virtualDeviceId:t})},"readonly").then(function(e){return e[0]})};return u.runInTransaction(function(e){return r("LSRemoveVirtualDeviceStoredProcedure")(r("LSFactory")(e),{traceId:l,virtualDeviceId:c})},"readwrite").then(function(t){var a=t[0];return(e||(e=o("I64"))).equal(a,(s||(s=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsOpStatus").SUCCESS))?new Promise(function(e,t){i=u.tables.encrypted_backups_virtual_devices.subscribe(function(){d(c).then(function(t){switch((s||(s=o("LSIntEnum"))).toNumber(t)){case 0:return;case 2:case-1:i(),n.endFail(o("EBAPIQPLPoints").EBRevokeVirtualDeviceQPLPoints.REVOKE_VIRTUAL_DEVICE_STATUS_INTERNAL_ERROR),e(o("WAResultOrError").makeError("REVOKE_VIRTUAL_DEVICE_GET_STATUS_INTERNAL_ERROR"));return;case 1:case 3:i(),n.endSuccess(),e(o("WAResultOrError").makeResult());return}}).catch(function(t){i(),n.endFail(o("EBAPIQPLPoints").EBRevokeVirtualDeviceQPLPoints.REVOKE_VIRTUAL_DEVICE_DB_ERROR,{string:{errorMessage:o("getSafeQplErrorMessage").getSafeQPLErrorMessage(t)}}),e(o("WAResultOrError").makeError("REVOKE_VIRTUAL_DEVICE_GET_SPROC_ERROR"))})})}):(i(),n.endFail(o("EBAPIQPLPoints").EBRevokeVirtualDeviceQPLPoints.REVOKE_VIRTUAL_DEVICE_SPROC_FAILURE),o("WAResultOrError").makeError("REVOKE_VIRTUAL_DEVICE_SPROC_FAILURE"))},function(e){return i(),n.endFail(o("EBAPIQPLPoints").EBRevokeVirtualDeviceQPLPoints.REVOKE_VIRTUAL_DEVICE_SPROC_ERROR,{string:{errorMessage:o("getSafeQplErrorMessage").getSafeQPLErrorMessage(e)}}),o("WAResultOrError").makeError("REVOKE_VIRTUAL_DEVICE_SPROC_FAILURE")})}l.revokeVirtualDevice=u}),98);
__d("LSSyncEpochs",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSIsEncryptionVersionSecure","LSIsMobileClient","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(e){return t.sequence([function(e){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure] Beginning execution."),t.sequence([function(e){return t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,r[13]=t[0],t})},function(e){return r[13]?r[14]=!0:r[14]=!1,r[14]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),r[16]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",r[16]].join("")),r[15]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",r[16],r[15],t.i64.cast([0,3]))):t.resolve()}])},function(e){return t.islc(t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))||!1}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,n){var o,a,i=e.done,l=e.value;return i?(r[13]=new t.Map,r[13].set("error_msg","Expected a nonempty query result"),r[13].set("code",t.i64.cast([0,3])),r[13].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),r[14]=t.createArray(),r[15]=(r[14].push(r[13]),r[14]),o=[void 0,r[14]],r[1]=o[0],r[2]=o[1]):(n=l.item,r[13]=new t.Map,r[13].set("backup_id",n.backupId),r[13].set("device_public_key_blob",n.devicePublicKeyBlob),r[13].set("device_private_key_blob",n.devicePrivateKeyBlob),r[13].set("epoch_storage_public_key_blob",n.epochStoragePublicKeyBlob),r[13].set("epoch_storage_private_key_blob",n.epochStoragePrivateKeyBlob),r[13].set("epoch_auth_public_key_blob",n.epochAuthPublicKeyBlob),r[13].set("epoch_auth_private_key_blob",n.epochAuthPrivateKeyBlob),r[13].set("mailbox_root_key_blob",n.mailboxRootKeyBlob),r[13].set("ocmf_client_state_blob",n.ocmfClientStateBlob),r[13].set("orf_client_state_v2_blob",void 0),r[13].set("orf_v2_authority_level",void 0),r[13].set("oblivious_validation_token_blob",n.obliviousValidationTokenBlob),r[13].set("device_id",n.deviceId),r[13].set("backup_tenancy",n.backupTenancy),r[13].set("encryption_version",n.encryptionVersion),r[13].set("revision_version",n.revisionVersion),r[13].set("initialize_restore_result",void 0),r[13].set("device_creation_timestamp_sec",void 0),r[13].set("authority_level",n.authorityLevel),a=[r[13],void 0],r[1]=a[0],r[2]=a[1])})},function(e){return r[4]=new t.Map,r[4].set("value",r[1]),r[4].set("errors",r[2]),r[5]=r[4].get("value"),r[5]!==void 0?t.sequence([function(e){return r[13]=r[5].get("backup_id"),r[14]=r[5].get("device_public_key_blob"),r[15]=r[5].get("device_private_key_blob"),r[16]=r[5].get("epoch_storage_public_key_blob"),r[17]=r[5].get("epoch_storage_private_key_blob"),r[18]=r[5].get("epoch_auth_public_key_blob"),r[19]=r[5].get("epoch_auth_private_key_blob"),r[20]=r[5].get("mailbox_root_key_blob"),r[21]=r[5].get("ocmf_client_state_blob"),r[22]=r[5].get("orf_client_state_v2_blob"),r[23]=r[5].get("orf_v2_authority_level"),r[24]=r[5].get("oblivious_validation_token_blob"),r[25]=r[5].get("device_id"),r[26]=r[5].get("backup_tenancy"),r[27]=r[5].get("encryption_version"),r[28]=r[5].get("revision_version"),r[29]=r[5].get("initialize_restore_result"),r[30]=r[5].get("device_creation_timestamp_sec"),r[31]=r[5].get("authority_level"),t.i64.neq(r[25],void 0)?t.sequence([function(e){return r[33]=void 0,t.i64.neq(r[33],void 0)?t.resolve(r[34]=r[33]):t.sequence([function(e){return r[41]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,r[42]=t[0],t})},function(e){return r[42]&&(r[51]=(r[41].push(t.i64.cast([0,0])),r[41])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,r[43]=t[0],t})},function(e){return r[43]&&(r[51]=(r[41].push(t.i64.cast([0,2])),r[41])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,r[44]=t[0],t})},function(e){return r[44]&&(r[51]=(r[41].push(t.i64.cast([0,3])),r[41])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,r[45]=t[0],t})},function(e){return r[45]&&(r[51]=(r[41].push(t.i64.cast([0,4])),r[41])),r[46]=t.createArray(),r[47]=t.i64.of_int32(r[41].length),t.i64.gt(r[47],t.i64.cast([0,0]))?t.loopAsync(r[47],function(e){return r[51]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[41],r[51]).then(function(e){var t;return t=e,r[52]=t[0],r[53]=t[1],t})},function(e){return r[54]=(r[46].push(r[52]),r[46])}])}):t.resolve()},function(e){return t.sequence([function(e){return r[51]=t.createArray(),r[52]=t.i64.of_int32(r[46].length),t.i64.gt(r[52],t.i64.cast([0,0]))?t.loopAsync(r[52],function(e){return r[54]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[46],r[54]).then(function(e){var t;return t=e,r[55]=t[0],r[56]=t[1],t})},function(e){return r[57]=(r[51].push(t.i64.to_string(r[55])),r[51])}])}):t.resolve()},function(e){return r[53]=r[51].join(","),r[48]=r[53]}])},function(e){return r[46].some(function(e){return t.i64.eq(r[27],e)})?r[49]=r[27]:r[49]=void 0,t.i64.neq(r[49],void 0)?r[50]=r[49]:r[50]=void 0,r[34]=r[50]}])},function(e){return t.i64.neq(r[34],void 0)?r[35]=r[34]:r[35]=t.i64.cast([0,0]),t.i64.neq(r[26],void 0)?r[36]=r[26]:r[36]=t.i64.cast([0,1]),t.filter(t.db.table(2).fetch(),function(e){return e.context==="50013"}).next().then(function(e,t){var n=e.done,o=e.value;return n?r[37]=!1:(t=o.item,r[37]=!0)})},function(e){return t.filter(t.db.table(2).fetch(),function(e){return e.context==="50025"}).next().then(function(e,t){var n=e.done,o=e.value;return n?r[39]=!1:(t=o.item,r[39]=!0)})},function(e){return r[37]||r[39]?(r[41]="Another sync job is already in progress. Terminating this.",r[41]!==void 0?((function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure] ","",r[41]].join("")),r[42]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsSyncEpochsStoredProcedure",r[41],r[42],t.i64.cast([0,3]))):t.resolve()):t.sequence([function(e){return t.sequence([function(e){return t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,r[49]=t[0],t})},function(e){return r[49]?r[50]=!0:r[50]=!1,r[50]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),r[52]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",r[52]].join("")),r[51]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",r[52],r[51],t.i64.cast([0,3]))):t.resolve()}])},function(e){return r[41]=t.createArray(),t.forEach(t.filter(t.db.table(169).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))}),function(e){var t=e.item;return r[49]=(r[41].push(t.epochId),r[41])})},function(e){return r[47]="Queried locally available epochs. Count: ",r[42]=t.i64.of_int32(r[41].length),r[48]=t.i64.to_string(r[42]),r[43]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][MEBEpochClientUtils] ",r[43],r[47],r[43],r[48]].join("")),t.resolve()},function(e){return r[44]=new t.Map,r[44].set("backup_id",r[13]),r[44].set("device_id",r[25]),r[44].set("locally_available_epochs",r[41]),r[44].set("trace_id",void 0),r[45]=t.toJSON(r[44]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"messenger_encrypted_backups",t.i64.cast([0,50025]),r[45],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,r[46]=t[0],t})}])},function(e){return r[32]=!0}]):t.sequence([function(e){return r[33]=["Failed to load client state: ","","NULL_DEVICE_ID"].join(""),r[33]!==void 0?((function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure] ","",r[33]].join("")),r[34]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsSyncEpochsStoredProcedure",r[33],r[34],t.i64.cast([0,3]))):t.resolve()},function(e){return r[32]=!1}])},function(e){return r[6]=r[32]}]):t.sequence([function(e){return r[13]=r[4].get("errors"),r[14]=r[4].get("errors"),r[15]=["Failed to load client state: ","","BACKUP_NOT_FOUND"].join(""),r[15]!==void 0?((function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure] ","",r[15]].join("")),r[16]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsSyncEpochsStoredProcedure",r[15],r[16],t.i64.cast([0,3]))):t.resolve()},function(e){return r[6]=!1}])},function(e){return r[7]=t.i64.of_float(Date.now()),r[8]=t.i64.random(),r[10]="Finishing execution. Execution time: ",r[11]=t.i64.to_string(t.i64.sub(r[7],r[0])),r[12]=" ms",r[9]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure] ",r[9],r[10],r[9],r[11],r[9],r[12]].join("")),t.i64.eq(t.i64.mod_(r[8],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[13]=",",r[14]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsSyncEpochsStoredProcedure",[r[10],r[13],r[11],r[13],r[12]].join(""),r[14],t.i64.cast([0,4]))):t.resolve()}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsSyncEpochsStoredProcedure",e.__tables__=["secure_encrypted_backups_client_state","pending_tasks","secure_encrypted_backups_epochs"],a.exports=e}),null);
__d("LSSyncEpochsStoredProcedure",["LSSyncEpochs","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t){var a=t.storedProcedure(r("LSSyncEpochs"));return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}l.default=s}),98);
__d("EBSyncEpochs",["EBAPIQPLPoints","EBDeps","LSFactory","LSSyncEpochsStoredProcedure","QPLFlow","Random","WAResultOrError","getErrorSafe","qpl"],(function(t,n,r,o,a,i,l){"use strict";var e=new Map;function s(t,n){if(n==null){for(var r of e.entries()){var a=r[0],i=r[1];i.unsub(),window.clearTimeout(i.timeout),i.resolve(o("WAResultOrError").makeError(t)),e.delete(a)}return}var l=e.get(n);l!=null&&(l.unsub(),window.clearTimeout(l.timeout),l.resolve(o("WAResultOrError").makeError(t)),e.delete(n))}async function u(){var t=await o("EBDeps").getDeps().getLSDB(),n,a=o("Random").uint32(),l=String(a),s=o("QPLFlow").startQPLFlow(r("qpl")._(521475098,"1328"),{annotations:{string:{traceId:l}},instanceKey:a});return new Promise(async function(a,u){var c=t.tables.secure_encrypted_backups_epochs.subscribe(function(t,r){if(r.operation!=="delete")return c(),window.clearTimeout(n),e.delete(l),s.endSuccess(),a(o("WAResultOrError").makeResult())});s.addPoint(o("EBAPIQPLPoints").EBSyncEpochsQPLPoints.SYNC_EPOCH_SPROC_START),await t.runInTransaction(function(e){return r("LSSyncEpochsStoredProcedure")(r("LSFactory")(e))},"readwrite",void 0,void 0,i.id+":95").then(function(){s.addPoint(o("EBAPIQPLPoints").EBSyncEpochsQPLPoints.SYNC_EPOCH_SPROC_END),n=window.setTimeout(function(){return e.delete(l),s.endFail(o("EBAPIQPLPoints").EBSyncEpochsQPLPoints.SYNC_EPOCH_TIMEOUT),u(o("WAResultOrError").makeError("timeout"))},12e4),e.set(l,{resolve:a,timeout:n,unsub:c})}).catch(function(t){var n=r("getErrorSafe")(t);return c(),e.delete(l),u(o("WAResultOrError").makeError(n.message))})})}l.resolveSyncEpochsWithError=s,l.EBSyncEpochs=u}),98);
__d("LSCreateExtraVirtualDeviceWithRecoveryCodeData",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDebugToken.nop","LSCreateDerivedKeys.nop","LSCreateEncryptionKeyPair.nop","LSCreateSignatureKeyPair.nop","LSCreateSignatureWithArmadilloKey.nop","LSCreateSignature_v2.nop","LSGetArmadilloPublicKey.nop","LSGetBlobFromString.nop","LSGetOpenEpochKeys","LSGetViewerFBID","LSHandleCreateVirtualDeviceFailure","LSHmac_v2.nop","LSIsMobileClient","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop","LSOcmfClientEvolve_v2.nop","LSParseRecoveryCode_v2.nop","LSSymmetricEncryptionCreateEncryptedString.nop","justknobx"],(function(t,n,r,o,a,i,l){function e(){var e=arguments,t=e[e.length-1],o=[],a=[];return t.sequence([function(a){return t.sequence([function(n){return o[0]=e[2].get("recovery_code"),o[1]=e[2].get("virtual_device_type"),o[2]=e[2].get("cloud_service_account"),o[3]=e[2].get("hsm_pin_normalization_status"),o[4]=e[2].get("security_question_type"),o[5]=e[2].get("trusted_contact_id"),t.db.table(168).fetch().next().then(function(e,n){var r=e.done,a=e.value;return r?o[6]=t.i64.cast([0,1]):(n=a.item,o[9]=n.backupTenancy,t.i64.neq(o[9],void 0)?o[8]=o[9]:o[8]=t.i64.cast([0,1]),o[6]=o[8])})},function(a){return t.i64.eq(o[6],t.i64.cast([0,1]))&&o[0]==="1SHADOWTESTINGRECOVERYCODE00000000000000"?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] Invalid Recovery Code Used."),o[9]="Invalid Recovery Code Used.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[9]].join("")),o[8]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[9],o[8],t.i64.cast([0,3]))):t.sequence([function(e){return o[8]=t.createArray(),t.storedProcedure(n("LSGetViewerFBID")).then(function(e){var t;return t=e,o[9]=t[0],t})},function(e){return t.nativeOperation(n("LSParseRecoveryCode_v2.nop"),o[0],t.i64.to_string(o[9]),o[8]).then(function(e){var t;return t=e,o[10]=t[0],o[11]=t[1],t})},function(a){return t.blobs.neq(o[11],void 0)?t.blobs.neq(o[10],void 0)?t.sequence([function(e){return t.storedProcedure(n("LSGetOpenEpochKeys"),!1).then(function(e){var t;return t=e,o[12]=t[0],t})},function(a){return o[12]!==void 0?t.sequence([function(a){return o[79]=r("justknobx")._("1310"),e[3]!==void 0?o[79]?t.sequence([function(r){return e[3]!==void 0?t.storedProcedure(n("LSAppendDataTraceAddon"),e[3],t.i64.cast([0,2866]),t.i64.cast([0,2]),void 0,void 0):t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,o[89]=t[0],t})},function(e){return o[89]?o[90]=!0:o[90]=!1,o[90]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),o[92]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",o[92]].join("")),o[91]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",o[92],o[91],t.i64.cast([0,3]))):t.resolve()}]):t.sequence([function(r){return e[3]!==void 0?t.storedProcedure(n("LSAppendDataTraceAddon"),e[3],t.i64.cast([0,2867]),t.i64.cast([0,2]),void 0,void 0):t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,o[89]=t[0],t})},function(e){return o[89]?o[90]=!0:o[90]=!1,o[90]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),o[92]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",o[92]].join("")),o[91]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",o[92],o[91],t.i64.cast([0,3]))):t.resolve()}]):t.resolve()},function(e){return o[79]?t.resolve():t.sequence([function(e){return t.count(t.db.table(169).fetch()).then(function(e){return o[89]=e})},function(e){return t.i64.gt(o[89],t.i64.cast([0,1]))?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] Multiple rows in $epoch_tables."),o[91]="Multiple rows in $epoch_tables.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[91]].join("")),o[90]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[91],o[90],t.i64.cast([0,3]))):t.resolve()}])},function(e){return t.nativeOperation(n("LSCreateSignatureKeyPair.nop")).then(function(e){var t;return t=e,o[13]=t[0],o[14]=t[1],t})},function(e){return t.nativeOperation(n("LSCreateEncryptionKeyPair.nop")).then(function(e){var t;return t=e,o[15]=t[0],o[16]=t[1],t})},function(e){return t.nativeOperation(n("LSCreateSignature_v2.nop"),o[13],t.blob("MA=="),o[16]).then(function(e){var t;return t=e,o[17]=t[0],t})},function(r){return o[80]=t.blob(""),o[81]=t.blob(""),o[82]=t.blob(""),t.db.table(168).fetch([[[e[1]]]]).next().then(function(e,r){var a,i=e.done,l=e.value;return i?t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] Row with backupid not found in client state table"),o[90]="Row with backupid not found in client state table",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[90]].join("")),o[89]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[90],o[89],t.i64.cast([0,3]))},function(e){var t;return t=[o[80],o[81],void 0,o[82]],o[18]=t[0],o[19]=t[1],o[20]=t[2],o[21]=t[3],t}]):(r=l.item,a=[r.obliviousValidationTokenBlob,r.mailboxRootKeyBlob,r.deviceId,r.ocmfClientStateBlob],o[18]=a[0],o[19]=a[1],o[20]=a[2],o[21]=a[3])})},function(e){return t.blobs.eq(o[18],o[80])?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] oblivious_token is empty!"),o[90]="oblivious_token is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[90]].join("")),o[89]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[90],o[89],t.i64.cast([0,3]))):t.resolve()},function(e){return t.blobs.eq(o[19],o[81])?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] mailbox_root_key is empty!"),o[90]="mailbox_root_key is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[90]].join("")),o[89]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[90],o[89],t.i64.cast([0,3]))):t.resolve()},function(e){return t.blobs.eq(o[21],o[82])?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ocmf_client_state is empty!"),o[90]="ocmf_client_state is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[90]].join("")),o[89]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[90],o[89],t.i64.cast([0,3]))):t.resolve()},function(e){return o[23]=o[12].get("epoch_anon_id"),o[24]=o[12].get("epoch_root_key"),o[25]=t.createArray(),o[89]=(o[25].push(t.i64.cast([0,32])),o[25]),t.nativeOperation(n("LSBase64Encode.nop"),o[23]).then(function(e){var t;return t=e,o[26]=t[0],t})},function(e){return o[26]!==void 0?t.sequence([function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blobs.of_string(["epoch_devices","_",o[26]].join("")),void 0,o[24],o[25]).then(function(e){var t;return t=e,o[89]=t[0],t})},function(e){return o[89]?o[90]=!1:o[90]=!0,o[90]?t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish"),o[93]="THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoEpochUtils] ","",o[93]].join("")),o[92]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils",o[93],o[92],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,o[94]=t[0],t})},function(e){return o[91]=o[94]}]):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[89],t.i64.cast([0,0])).then(function(e){var t;return t=e,o[92]=t[0],o[93]=t[1],t})},function(e){return o[91]=o[92]}])},function(e){return o[27]=o[91]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish"),o[90]="THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoEpochUtils] ","",o[90]].join("")),o[89]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils",o[90],o[89],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,o[91]=t[0],t})},function(e){return o[27]=o[91]}])},function(e){return t.nativeOperation(n("LSHmac_v2.nop"),o[27],o[14]).then(function(e){var t;return t=e,o[28]=t[0],t})},function(e){return t.blobs.neq(o[28],void 0)?t.resolve(o[29]=o[28]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] device_epoch_hmac is null!"),o[90]="device_epoch_hmac is null!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[90]].join("")),o[89]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[90],o[89],t.i64.cast([0,3]))},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),"").then(function(e){var t;return t=e,o[91]=t[0],t})},function(e){return o[29]=o[91]}])},function(e){return o[30]=o[12].get("epoch_root_key"),t.blobs.neq(o[30],void 0)?t.sequence([function(e){return o[89]=t.createArray(),o[95]=(o[89].push(t.i64.cast([0,18])),o[89]),t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,o[30],o[89]).then(function(e){var t;return t=e,o[90]=t[0],t})},function(e){return o[90]!==void 0?t.sequence([function(e){return o[95]=t.i64.of_int32(o[90].length),t.i64.ge(o[95],t.i64.cast([0,1]))?t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),o[90],t.i64.cast([0,0])).then(function(e){var t;return t=e,o[97]=t[0],o[98]=t[1],t})},function(e){return o[96]=o[97]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),o[98]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBFingerprint] ","",o[98]].join("")),o[97]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBFingerprint",o[98],o[97],t.i64.cast([0,3]))},function(e){return o[96]=void 0}])},function(e){return o[91]=o[96]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),o[96]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBFingerprint] ","",o[96]].join("")),o[95]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBFingerprint",o[96],o[95],t.i64.cast([0,3]))},function(e){return o[91]=void 0}])},function(e){return t.blobs.neq(o[91],void 0)?o[92]=!0:o[92]=!1,o[92]||((function(e){t.logger(e).mustfix(e)})("LS::assert is failed. Attempting to coerce a null value to nonnull."),t.throw("LS::assert is failed. Attempting to coerce a null value to nonnull.")),t.nativeOperation(n("LSBase64Encode.nop"),o[91]).then(function(e){var t;return t=e,o[93]=t[0],t})},function(e){return o[93]!==void 0?o[94]=o[93]:o[94]="encodingfailed",o[31]=o[94]}]):t.resolve(o[31]="null")},function(e){return t.nativeOperation(n("LSOcmfClientEvolve_v2.nop"),o[21]).then(function(e){var t;return t=e,o[32]=t[0],o[33]=t[1],t})},function(e){var r;return t.blobs.neq(void 0,void 0)?t.sequence([function(e){return t.nativeOperation(n("LSOcmfClientEvolve_v2.nop"),void 0).then(function(e){var t;return t=e,o[89]=t[0],o[90]=t[1],t})},function(e){var t;return t=[o[32],o[33],o[89],o[90]],o[34]=t[0],o[35]=t[1],o[36]=t[2],o[37]=t[3],t}]):t.resolve((r=[o[32],o[33],void 0,void 0],o[34]=r[0],o[35]=r[1],o[36]=r[2],o[37]=r[3],r))},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[13]).then(function(e){var t;return t=e,o[38]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),o[11],t.blob("dmlydHVhbF9kZXZpY2U6dmlydHVhbF9kZXZpY2VfcHJpdmF0ZV9rZXk="),o[38]==null?"":o[38]).then(function(e){var t;return t=e,o[39]=t[0],t})},function(e){return o[39]!==void 0?o[40]=o[39]:o[40]="",o[40]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_device_private_key is empty!"),o[90]="encrypted_device_private_key is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[90]].join("")),o[89]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[90],o[89],t.i64.cast([0,3]))):t.resolve()},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[15]).then(function(e){var t;return t=e,o[41]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),o[11],t.blob("dmlydHVhbF9kZXZpY2U6ZXBvY2hfc3RvcmFnZV9wcml2YXRlX2tleQ=="),o[41]==null?"":o[41]).then(function(e){var t;return t=e,o[42]=t[0],t})},function(e){return o[42]!==void 0?o[43]=o[42]:o[43]="",o[43]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_epoch_storage_private_key is empty!"),o[90]="encrypted_epoch_storage_private_key is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[90]].join("")),o[89]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[90],o[89],t.i64.cast([0,3]))):t.resolve()},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[34]).then(function(e){var t;return t=e,o[44]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),o[11],t.blob("dmlydHVhbF9kZXZpY2U6b2NtZl9jbGllbnRfc3RhdGU="),o[44]==null?"":o[44]).then(function(e){var t;return t=e,o[45]=t[0],t})},function(e){return o[45]!==void 0?o[46]=o[45]:o[46]="",o[46]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_orf_client_state_v1_shape is empty!"),o[90]="encrypted_orf_client_state_v1_shape is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[90]].join("")),o[89]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[90],o[89],t.i64.cast([0,3]))):t.resolve()},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[18]).then(function(e){var t;return t=e,o[47]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),o[11],t.blob("dmlydHVhbF9kZXZpY2U6b2JsaXZpb3VzX3ZhbGlkYXRpb25fdG9rZW4="),o[47]==null?"":o[47]).then(function(e){var t;return t=e,o[48]=t[0],t})},function(e){return o[48]!==void 0?o[49]=o[48]:o[49]="",o[49]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_oblivious_validation_token is empty!"),o[90]="encrypted_oblivious_validation_token is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[90]].join("")),o[89]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[90],o[89],t.i64.cast([0,3]))):t.resolve()},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[19]).then(function(e){var t;return t=e,o[50]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),o[11],t.blob("dmlydHVhbF9kZXZpY2U6bWFpbGJveF9yb290X2tleQ=="),o[50]==null?"":o[50]).then(function(e){var t;return t=e,o[51]=t[0],t})},function(e){return o[51]!==void 0?o[52]=o[51]:o[52]="",o[52]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_mailbox_root_key is empty!"),o[90]="encrypted_mailbox_root_key is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[90]].join("")),o[89]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[90],o[89],t.i64.cast([0,3]))):t.resolve()},function(e){return o[53]=o[12].get("epoch_anon_id"),t.nativeOperation(n("LSBase64Encode.nop"),o[53]).then(function(e){var t;return t=e,o[54]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),o[11],t.blob("dmlydHVhbF9kZXZpY2U6ZXBvY2hfYW5vbl9pZA=="),o[54]==null?"":o[54]).then(function(e){var t;return t=e,o[55]=t[0],t})},function(e){return o[55]!==void 0?o[56]=o[55]:o[56]="",o[56]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_epoch_anon_id is empty!"),o[90]="encrypted_epoch_anon_id is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[90]].join("")),o[89]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[90],o[89],t.i64.cast([0,3]))):t.resolve()},function(e){return o[57]=o[12].get("epoch_root_key"),t.nativeOperation(n("LSBase64Encode.nop"),o[57]).then(function(e){var t;return t=e,o[58]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),o[11],t.blob("dmlydHVhbF9kZXZpY2U6ZXBvY2hfcm9vdF9rZXk="),o[58]==null?"":o[58]).then(function(e){var t;return t=e,o[59]=t[0],t})},function(e){return o[59]!==void 0?o[60]=o[59]:o[60]="",o[60]===""?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_epoch_root_key is empty!"),o[90]="encrypted_epoch_root_key is empty!",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[90]].join("")),o[89]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[90],o[89],t.i64.cast([0,3]))):t.resolve()},function(e){return o[61]=new t.Map,o[61].set("encrypted_device_private_key",o[40]),o[61].set("encrypted_epoch_storage_private_key",o[43]),o[61].set("encrypted_ocmf_client_state",o[46]),o[61].set("encrypted_orf_client_state_v2",void 0),o[61].set("encrypted_oblivious_validation_token_blob",o[49]),o[61].set("encrypted_mailbox_root_key_blob",o[52]),o[61].set("encrypted_epoch_anon_id",o[56]),o[61].set("encrypted_epoch_root_key",o[60]),t.nativeOperation(n("LSBase64Encode.nop"),o[10]).then(function(e){var t;return t=e,o[62]=t[0],t})},function(e){return o[83]=o[62]==null?"":o[62],t.nativeOperation(n("LSBase64Encode.nop"),o[14]).then(function(e){var t;return t=e,o[63]=t[0],t})},function(e){return o[84]=o[63]==null?"":o[63],t.nativeOperation(n("LSBase64Encode.nop"),o[16]).then(function(e){var t;return t=e,o[64]=t[0],t})},function(e){return o[85]=o[64]==null?"":o[64],t.nativeOperation(n("LSBase64Encode.nop"),o[17]==null?t.blob("bnVsbA=="):o[17]).then(function(e){var t;return t=e,o[65]=t[0],t})},function(e){return o[86]=o[65]==null?"":o[65],t.nativeOperation(n("LSBase64Encode.nop"),o[29]).then(function(e){var t;return t=e,o[66]=t[0],t})},function(e){return o[87]=o[66]==null?"":o[66],t.nativeOperation(n("LSBase64Encode.nop"),o[35]).then(function(e){var t;return t=e,o[67]=t[0],t})},function(e){return o[88]=o[67]==null?"":o[67],t.nativeOperation(n("LSGetBlobFromString.nop"),o[0]).then(function(e){var t;return t=e,o[68]=t[0],t})},function(e){return t.blobs.neq(o[19],void 0)?t.sequence([function(e){return o[89]=new t.Map,t.nativeOperation(n("LSCreateDebugToken.nop"),o[19],"private_key",o[13],t.i64.cast([0,1]),o[89]).then(function(e){var t;return t=e,o[90]=t[0],t})},function(e){return t.blobs.neq(o[90],void 0)?o[91]=o[90]:o[91]=void 0,o[69]=o[91]}]):t.resolve(o[69]=void 0)},function(e){return t.blobs.neq(o[69],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[69]).then(function(e){var t;return t=e,o[89]=t[0],t})},function(e){return o[70]=o[89]}]):t.resolve(o[70]=void 0)},function(e){return t.blobs.neq(o[19],void 0)?t.sequence([function(e){return o[89]=new t.Map,t.nativeOperation(n("LSCreateDebugToken.nop"),o[19],"ocmf_client_state",o[34],t.i64.cast([0,1]),o[89]).then(function(e){var t;return t=e,o[90]=t[0],t})},function(e){return t.blobs.neq(o[90],void 0)?o[91]=o[90]:o[91]=void 0,o[71]=o[91]}]):t.resolve(o[71]=void 0)},function(e){return t.blobs.neq(o[71],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[71]).then(function(e){var t;return t=e,o[89]=t[0],t})},function(e){return o[72]=o[89]}]):t.resolve(o[72]=void 0)},function(e){return t.blobs.neq(o[19],void 0)?t.sequence([function(e){return o[89]=new t.Map,t.nativeOperation(n("LSCreateDebugToken.nop"),o[19],"epoch_storage_private_key",o[15],t.i64.cast([0,1]),o[89]).then(function(e){var t;return t=e,o[90]=t[0],t})},function(e){return t.blobs.neq(o[90],void 0)?o[91]=o[90]:o[91]=void 0,o[73]=o[91]}]):t.resolve(o[73]=void 0)},function(e){return t.blobs.neq(o[73],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[73]).then(function(e){var t;return t=e,o[89]=t[0],t})},function(e){return o[74]=o[89]}]):t.resolve(o[74]=void 0)},function(e){return t.storedProcedure(n("LSGetViewerFBID")).then(function(e){var t;return t=e,o[75]=t[0],t})},function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),t.i64.to_string(o[75])).then(function(e){var t;return t=e,o[76]=t[0],t})},function(e){return t.blobs.neq(o[76],void 0)?t.sequence([function(e){return o[89]=new t.Map,t.nativeOperation(n("LSCreateDebugToken.nop"),o[76],"recovery_code",o[68],t.i64.cast([0,1]),o[89]).then(function(e){var t;return t=e,o[90]=t[0],t})},function(e){return t.blobs.neq(o[90],void 0)?o[91]=o[90]:o[91]=void 0,o[77]=o[91]}]):t.resolve(o[77]=void 0)},function(e){return t.blobs.neq(o[77],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),o[77]).then(function(e){var t;return t=e,o[89]=t[0],t})},function(e){return o[78]=o[89]}]):t.resolve(o[78]=void 0)},function(r){return t.i64.neq(o[20],void 0)?t.sequence([function(e){return o[89]=o[12].get("epoch_id"),t.db.table(168).fetch().next().then(function(e,n){var r=e.done,a=e.value;return r?o[90]=t.i64.cast([0,1]):(n=a.item,o[95]=n.backupTenancy,t.i64.neq(o[95],void 0)?o[94]=o[95]:o[94]=t.i64.cast([0,1]),o[90]=o[94])})},function(e){return t.i64.eq(o[90],t.i64.cast([0,2]))?t.resolve(o[92]=void 0):t.sequence([function(e){return t.nativeOperation(n("LSGetArmadilloPublicKey.nop")).then(function(e){var t;return t=e,o[94]=t[0],t})},function(e){return o[92]=o[94]}])},function(e){return t.blobs.neq(o[92],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSCreateSignatureWithArmadilloKey.nop"),o[14]).then(function(e){var t;return t=e,o[94]=t[0],t})},function(e){return t.blobs.neq(o[94],void 0)?t.resolve(o[95]=o[94]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoKeySigningUtils] Failed to create labyrinth signature"),o[100]="Failed to create labyrinth signature",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoKeySigningUtils] ","",o[100]].join("")),o[99]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoKeySigningUtils",o[100],o[99],t.i64.cast([0,3]))},function(e){return o[95]=void 0}])},function(e){return t.nativeOperation(n("LSCreateSignature_v2.nop"),o[13],t.blob("Mw=="),o[92]).then(function(e){var t;return t=e,o[96]=t[0],t})},function(e){return t.blobs.neq(o[96],void 0)?t.resolve(o[97]=o[96]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoKeySigningUtils] Failed to create armadillo signature"),o[100]="Failed to create armadillo signature",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoKeySigningUtils] ","",o[100]].join("")),o[99]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoKeySigningUtils",o[100],o[99],t.i64.cast([0,3]))},function(e){return o[97]=void 0}])},function(e){return t.blobs.neq(o[97],void 0)?(t.blobs.neq(o[95],void 0)?(o[100]=new t.Map,o[100].set("armadillo_public_key",o[92]),o[100].set("armadillo_key_signature",o[97]),o[100].set("labyrinth_key_signature",o[95]),o[99]=o[100]):o[99]=void 0,o[98]=o[99]):o[98]=void 0,o[93]=o[98]}]):t.resolve(o[93]=void 0)},function(r){return o[93]!==void 0?t.sequence([function(e){return o[94]=o[93].get("armadillo_public_key"),t.nativeOperation(n("LSBase64Encode.nop"),o[94]).then(function(e){var t;return t=e,o[95]=t[0],t})},function(e){return o[96]=o[93].get("armadillo_key_signature"),t.nativeOperation(n("LSBase64Encode.nop"),o[96]).then(function(e){var t;return t=e,o[97]=t[0],t})},function(e){return o[98]=o[93].get("labyrinth_key_signature"),t.nativeOperation(n("LSBase64Encode.nop"),o[98]).then(function(e){var t;return t=e,o[99]=t[0],t})},function(r){return o[100]=new t.Map,o[100].set("backup_id",e[1]),o[100].set("request_device_id",o[20]),o[100].set("virtual_device_id",o[83]),o[100].set("encrypted_secret_values",o[61]),o[100].set("public_key",o[84]),o[100].set("epoch_storage_pubkey",o[85]),o[100].set("epoch_storage_pubkey_sig",o[86]),o[100].set("device_epoch_hmac",o[87]),o[100].set("epoch_root_key_fingerprint",o[31]),o[100].set("ocmf_rotation_token",o[88]),o[100].set("is_init",!1),o[100].set("epoch_id",o[89]),o[100].set("virtual_device_type",o[1]),o[100].set("action_type",e[0]),o[100].set("private_key_debug_token",o[70]),o[100].set("ocmf_client_state_debug_token",o[72]),o[100].set("epoch_storage_pvtkey_debug_token",o[74]),o[100].set("recovery_code_debug_token",o[78]),o[100].set("trace_id",e[3]),o[100].set("cloud_service_account",o[2]),o[100].set("hsm_pin_normalization_status",o[3]),o[100].set("security_question_type",o[4]),o[100].set("trusted_contact_id",o[5]),o[100].set("armadillo_public_key",o[95]==null?"":o[95]),o[100].set("armadillo_key_signature",o[97]==null?"":o[97]),o[100].set("labyrinth_key_signature",o[99]==null?"":o[99]),o[101]=t.toJSON(o[100]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",t.i64.cast([0,50004]),o[101],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),e[3],t.i64.cast([0,0])).then(function(e){var t;return t=e,o[102]=t[0],t})}]):((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] failed to get armadillo key and device signatures"),o[94]=new t.Map,o[94].set("backup_id",e[1]),o[94].set("request_device_id",o[20]),o[94].set("virtual_device_id",o[83]),o[94].set("encrypted_secret_values",o[61]),o[94].set("public_key",o[84]),o[94].set("epoch_storage_pubkey",o[85]),o[94].set("epoch_storage_pubkey_sig",o[86]),o[94].set("device_epoch_hmac",o[87]),o[94].set("epoch_root_key_fingerprint",o[31]),o[94].set("ocmf_rotation_token",o[88]),o[94].set("is_init",!1),o[94].set("epoch_id",o[89]),o[94].set("virtual_device_type",o[1]),o[94].set("action_type",e[0]),o[94].set("private_key_debug_token",o[70]),o[94].set("ocmf_client_state_debug_token",o[72]),o[94].set("epoch_storage_pvtkey_debug_token",o[74]),o[94].set("recovery_code_debug_token",o[78]),o[94].set("trace_id",e[3]),o[94].set("cloud_service_account",o[2]),o[94].set("hsm_pin_normalization_status",o[3]),o[94].set("security_question_type",o[4]),o[94].set("trusted_contact_id",o[5]),o[95]=t.toJSON(o[94]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",t.i64.cast([0,50004]),o[95],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),e[3],t.i64.cast([0,0])).then(function(e){var t;return t=e,o[96]=t[0],t}))}]):t.storedProcedure(n("LSHandleCreateVirtualDeviceFailure"),e[1],!1,e[3])}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] Epoch keys are unavailable."),o[14]="Epoch keys are unavailable.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[14]].join("")),o[13]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[14],o[13],t.i64.cast([0,3]))},function(r){return t.storedProcedure(n("LSHandleCreateVirtualDeviceFailure"),e[1],!1,e[3])}])}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] Invalid Recovery Code Provided"),o[13]="Invalid Recovery Code Provided",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[13]].join("")),o[12]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[13],o[12],t.i64.cast([0,3]))},function(r){return t.storedProcedure(n("LSHandleCreateVirtualDeviceFailure"),e[1],!1,e[3])}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] Invalid Recovery Code Provided"),o[13]="Invalid Recovery Code Provided",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ","",o[13]].join("")),o[12]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure",o[13],o[12],t.i64.cast([0,3]))},function(r){return t.storedProcedure(n("LSHandleCreateVirtualDeviceFailure"),e[1],!1,e[3])}])}])}])},function(e){return t.resolve(a)}])}e.__sproc_name__="LSEncryptedBackupsCreateExtraVirtualDeviceWithRecoveryCodeDataStoredProcedure",e.__tables__=["secure_encrypted_backups_client_state","secure_encrypted_backups_epochs"];var s=e;l.default=s}),98);
__d("LSCreateExtraVirtualDeviceWithRecoveryCodeDataStoredProcedure",["LSCreateExtraVirtualDeviceWithRecoveryCodeData","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSCreateExtraVirtualDeviceWithRecoveryCodeData"),a.actionType,a.backupId,a.recoveryCodeData,a.traceId);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSOptOutOfBackup",["LSAppendDataTraceAddon","LSIsMobileClient","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop","justknobx"],(function(t,n,r,o,a,i,l){function e(){var e=arguments,t=e[e.length-1],o=[],a=[];return t.sequence([function(i){return t.sequence([function(a){return o[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsOptOutOfBackupStoredProcedure] Beginning execution."),r("justknobx")._("1099")?t.sequence([function(e){return t.sequence([function(e){return t.resolve()},function(e){return t.storedProcedure(n("LSIsMobileClient")).then(function(e){var t;return t=e,o[11]=t[0],t})},function(e){return o[11]?o[12]=!0:o[12]=!1,o[12]?((function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),o[14]="LSDataTraceMciTraceLog native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBTraceUtils] ","",o[14]].join("")),o[13]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBTraceUtils",o[14],o[13],t.i64.cast([0,3]))):t.resolve()}])},function(r){return o[8]=new t.Map,o[8].set("backup_id",e[0]),o[8].set("trace_id",void 0),o[9]=t.toJSON(o[8]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_opt_out",t.i64.cast([0,50019]),o[9],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,o[10]=t[0],t})},function(e){return o[1]=t.i64.cast([0,0])}]):t.resolve(((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsOptOutOfBackupStoredProcedure] backup opt out flow is not enabled"),o[1]=t.i64.cast([0,1])))},function(e){return o[2]=t.i64.of_float(Date.now()),o[3]=t.i64.random(),o[5]="Finishing execution. Execution time: ",o[6]=t.i64.to_string(t.i64.sub(o[2],o[0])),o[7]=" ms",o[4]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][LSEncryptedBackupsOptOutOfBackupStoredProcedure] ",o[4],o[5],o[4],o[6],o[4],o[7]].join("")),t.i64.eq(t.i64.mod_(o[3],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(o[8]=",",o[9]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsOptOutOfBackupStoredProcedure",[o[5],o[8],o[6],o[8],o[7]].join(""),o[9],t.i64.cast([0,4]))):t.resolve()},function(e){return a[0]=o[1]}])},function(e){return t.resolve(a)}])}e.__sproc_name__="LSEncryptedBackupsOptOutOfBackupStoredProcedure",e.__tables__=[];var s=e;l.default=s}),98);
__d("LSOptOutOfBackupStoredProcedure",["LSOptOutOfBackup","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSOptOutOfBackup"),a.backupId);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("MWEncryptedBackupsCreateExtraVirtualDeviceWithRecoveryCodeData",["LSCreateExtraVirtualDeviceWithRecoveryCodeDataStoredProcedure","LSEncryptedBackupsOpStatus","LSFactory","LSIntEnum","LSShape","ReQL"],(function(t,n,r,o,a,i,l){"use strict";var e;async function s(t,n,a){var l=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.tables.encrypted_backups));if(l==null)return[(e||(e=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsOpStatus").FAILURE)];var s=l.backupId;return s!=null?(await t.runInTransaction(function(e){return r("LSCreateExtraVirtualDeviceWithRecoveryCodeDataStoredProcedure")(r("LSFactory")(e),{actionType:n,backupId:s,recoveryCodeData:o("LSShape").ofRecord(a),traceId:void 0})},"readwrite",void 0,void 0,i.id+":41"),[(e||(e=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsOpStatus").SUCCESS)]):[(e||(e=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsOpStatus").FAILURE)]}l.initializeCreateExtraVirtualDeviceStoredProcedure=s}),98);
__d("X25519",["$InternalEnum","Promise","WACryptoCurve25519Dependencies","WASignalKeys","WASignalOther","WASignalSignatures"],(function(t,n,r,o,a,i,l){"use strict";var e,s=n("$InternalEnum").Mirrored(["Encryption","Signing"]),u=n("$InternalEnum")({PublicKey:0,PrivateKey:1,Signature:2});function c(e,t){if(t===s.Encryption)return[];var n=1;switch(e){case u.PublicKey:n=1;break;case u.PrivateKey:n=2;break;case u.Signature:n=3;break}return[255,n]}function d(e,t,n){var r=c(t,n),o=r.length;if(o<=0)return e;var a=new Uint8Array(o+e.byteLength);return a.set(Array.from(r)),a.set(e,o),a}function m(e,t,n){var r=c(t,n).length;return e.slice(r)}function p(e,t){return{privateKey:d(e.privateKey,u.PrivateKey,t),publicKey:d(e.publicKey,u.PublicKey,t)}}function _(e){var t=p(o("WASignalKeys").makeKeyPair(),e);return{pk:t.publicKey,sk:t.privateKey}}function f(e,t){if(t===s.Encryption)return 32;switch(e){case u.PublicKey:case u.PrivateKey:return 32;case u.Signature:return 64}}function g(e,t,n){var r=c(t,n),o=r.length,a=f(t,n),i=a!=null?o+a:0;if(e.length!==i)return!1;var l=e.subarray(0,o),s=new Uint8Array(r);return s.length===l.length&&s.every(function(e,t){return e===l[t]})}function h(e,t){if(g(e,u.PublicKey,t))return e}function y(e,t){if(g(e,u.PrivateKey,t))return e}function C(e,t){var n=h(e.pkBytes,t),r=y(e.skBytes,t);if(n!=null&&r!=null)return{pk:n,sk:r}}function b(t,r){var a=m(t,u.PrivateKey,s.Signing);return o("WASignalSignatures").signMsg(o("WASignalKeys").makeKeyPairFrom(o("WASignalOther").ensureSize(a,32)),r).then(function(t){var r=d(t,u.Signature,s.Signing);return(e||(e=n("Promise"))).resolve(r)})}function v(e){if(g(e,u.Signature,s.Signing))return e}function S(e,t,n){var r=m(t,u.PublicKey,s.Signing);return o("WASignalSignatures").verifyMsgSignalVariant(o("WASignalKeys").serializeIdentity(r),n,o("WASignalOther").ensureSize(m(e,u.Signature,s.Signing),64))}function R(t,r){var a=r,i=t;return!g(i,u.PublicKey,s.Encryption)||!g(a,u.PrivateKey,s.Encryption)?(e||(e=n("Promise"))).resolve():o("WACryptoCurve25519Dependencies").calculateAgreement(i,a).then(function(t){return(e||(e=n("Promise"))).resolve(new Uint8Array(t))})}l.KeyPurpose=s,l.generateKeys=_,l.publicKeyFromBytes=h,l.secretKeyFromBytes=y,l.keysFromBytes=C,l.sign=b,l.signatureFromBytes=v,l.verify=S,l.exchangeKeys=R}),98);
__d("PublicKeyCrypto",["Promise","UInt8Array","X25519"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,r){return(e||(e=n("Promise"))).all([t,r]).then(function(t){return(e||(e=n("Promise"))).resolve(t[0]!=null&&t[1]!=null?o("UInt8Array").concatBytes([t[0],t[1]]):void 0)})}function u(e,t,n){return s(o("X25519").exchangeKeys(n,e),o("X25519").exchangeKeys(n,t))}function c(e,t,n){return s(o("X25519").exchangeKeys(n,e),o("X25519").exchangeKeys(t,e))}l.senderDeriveSharedSecret=u,l.receiverDeriveSharedSecret=c}),98);
__d("WASmaxInAbPropsIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","error");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQErrorResponseMixin=e}),98);
__d("WASmaxInAbPropsIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","bad-request");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",400);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorBadRequestMixin=e}),98);
__d("WASmaxInAbPropsIQErrorFeatureNotImplementedMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","feature-not-implemented");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",501);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorFeatureNotImplementedMixin=e}),98);
__d("WASmaxInAbPropsNoRetryErrors",["WAResultOrError","WASmaxInAbPropsIQErrorBadRequestMixin","WASmaxInAbPropsIQErrorFeatureNotImplementedMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInAbPropsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:t.value});var n=o("WASmaxInAbPropsIQErrorFeatureNotImplementedMixin").parseIQErrorFeatureNotImplementedMixin(e);return n.success?o("WAResultOrError").makeResult({name:"IQErrorFeatureNotImplemented",value:n.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorBadRequest","IQErrorFeatureNotImplemented"],[t,n])}l.parseNoRetryErrors=e}),98);
__d("WASmaxInAbPropsGetExperimentConfigResponseErrorNoRetry",["WAResultOrError","WASmaxInAbPropsIQErrorResponseMixin","WASmaxInAbPropsNoRetryErrors","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInAbPropsIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInAbPropsNoRetryErrors").parseNoRetryErrors(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorNoRetryErrors:i.value})):i}l.parseGetExperimentConfigResponseErrorNoRetry=e}),98);
__d("WASmaxInAbPropsIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","internal-server-error");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",500);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorInternalServerErrorMixin=e}),98);
__d("WASmaxInAbPropsGetExperimentConfigResponseErrorRetry",["WAResultOrError","WASmaxInAbPropsIQErrorInternalServerErrorMixin","WASmaxInAbPropsIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInAbPropsIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(r.value);if(!a.success)return a;var i=o("WASmaxInAbPropsIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({errorIQErrorInternalServerErrorMixin:a.value},i.value)):i}l.parseGetExperimentConfigResponseErrorRetry=e}),98);
__d("WASmaxInAbPropsExperimentConfigMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"prop");if(!t.success)return t;var n=o("WASmaxParseUtils").attrIntRange(e,"config_code",1,void 0);if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(e,"config_value");if(!r.success)return r;var a=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrIntRange,e,"config_expo_key",0,void 0);return a.success?o("WAResultOrError").makeResult({configCode:n.value,configValue:r.value,configExpoKey:a.value}):a}l.parseExperimentConfigMixin=e}),98);
__d("WASmaxInAbPropsSamplingConfigMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"prop");if(!t.success)return t;var n=o("WASmaxParseUtils").attrIntRange(e,"event_code",1,void 0);if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(e,"sampling_weight",-1e4,1e4);return r.success?o("WAResultOrError").makeResult({eventCode:n.value,samplingWeight:r.value}):r}l.parseSamplingConfigMixin=e}),98);
__d("WASmaxInAbPropsConfigs",["WAResultOrError","WASmaxInAbPropsExperimentConfigMixin","WASmaxInAbPropsSamplingConfigMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInAbPropsExperimentConfigMixin").parseExperimentConfigMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"ExperimentConfig",value:t.value});var n=o("WASmaxInAbPropsSamplingConfigMixin").parseSamplingConfigMixin(e);return n.success?o("WAResultOrError").makeResult({name:"SamplingConfig",value:n.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["ExperimentConfig","SamplingConfig"],[t,n])}l.parseConfigs=e}),98);
__d("WASmaxInAbPropsEnums",[],(function(t,n,r,o,a,i){var e={false:"false",true:"true"};i.ENUM_FALSE_TRUE=e}),66);
__d("WASmaxInAbPropsIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQResultResponseMixin=e}),98);
__d("WASmaxInAbPropsGetExperimentConfigResponseSuccess",["WAResultOrError","WASmaxInAbPropsConfigs","WASmaxInAbPropsEnums","WASmaxInAbPropsIQResultResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"prop");if(!t.success)return t;var n=o("WASmaxInAbPropsConfigs").parseConfigs(e);return n.success?o("WAResultOrError").makeResult({configs:n.value}):n}function s(e){var t=o("WASmaxParseUtils").assertTag(e,"erid");if(!t.success)return t;var n=o("WASmaxParseUtils").contentBytesRange(e,1,100);return n.success?o("WAResultOrError").makeResult({elementValue:n.value}):n}function u(t,n){var r=o("WASmaxParseUtils").assertTag(t,"iq");if(!r.success)return r;var a=o("WASmaxParseUtils").flattenedChildWithTag(t,"props");if(!a.success)return a;var i=o("WASmaxParseUtils").optionalChildWithTag(t,"erid",s);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,a.value,"protocol","1");if(!l.success)return l;var u=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,a.value,"ab_key");if(!u.success)return u;var c=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,a.value,"hash");if(!c.success)return c;var d=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrIntRange,a.value,"refresh",0,void 0);if(!d.success)return d;var m=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrIntRange,a.value,"refresh_id",0,void 0);if(!m.success)return m;var p=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrStringEnum,a.value,"delta_update",o("WASmaxInAbPropsEnums").ENUM_FALSE_TRUE);if(!p.success)return p;var _=o("WASmaxInAbPropsIQResultResponseMixin").parseIQResultResponseMixin(t,n);if(!_.success)return _;var f=o("WASmaxParseUtils").mapChildrenWithTag(a.value,"prop",0,1/0,e);return f.success?o("WAResultOrError").makeResult(babelHelpers.extends({propsProtocol:l.value,propsAbKey:u.value,propsHash:c.value,propsRefresh:d.value,propsRefreshId:m.value,propsDeltaUpdate:p.value},_.value,{erid:i.value,propsProp:f.value})):f}l.parseGetExperimentConfigResponseSuccessPropsProp=e,l.parseGetExperimentConfigResponseSuccessErid=s,l.parseGetExperimentConfigResponseSuccess=u}),98);
__d("WASmaxOutAbPropsBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("iq",{id:o("WAWap").generateId(),type:"get"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeBaseIQGetRequestMixin=s}),98);
__d("WASmaxOutAbPropsGetExperimentConfigRequest",["WASmaxAttrs","WASmaxJsx","WASmaxOutAbPropsBaseIQGetRequestMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.propsHash,n=e.propsRefreshId,r=o("WASmaxOutAbPropsBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(o("WASmaxJsx").smax("iq",{xmlns:"abt",to:o("WAWap").S_WHATSAPP_NET},o("WASmaxJsx").smax("props",{protocol:"1",hash:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,t),refresh_id:o("WASmaxAttrs").OPTIONAL(o("WAWap").INT,n)})));return r}l.makeGetExperimentConfigRequest=e}),98);
__d("WASmaxAbPropsGetExperimentConfigRPC",["WAComms","WASmaxInAbPropsGetExperimentConfigResponseErrorNoRetry","WASmaxInAbPropsGetExperimentConfigResponseErrorRetry","WASmaxInAbPropsGetExperimentConfigResponseSuccess","WASmaxOutAbPropsGetExperimentConfigRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(t,n,r,o,a,i,l){async function e(e,t){var n=o("WASmaxOutAbPropsGetExperimentConfigRequest").makeGetExperimentConfigRequest(e),r=await o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInAbPropsGetExperimentConfigResponseSuccess").parseGetExperimentConfigResponseSuccess(r,n);if(a.success)return{name:"GetExperimentConfigResponseSuccess",value:a.value};var i=o("WASmaxInAbPropsGetExperimentConfigResponseErrorNoRetry").parseGetExperimentConfigResponseErrorNoRetry(r,n);if(i.success)return{name:"GetExperimentConfigResponseErrorNoRetry",value:i.value};var l=o("WASmaxInAbPropsGetExperimentConfigResponseErrorRetry").parseGetExperimentConfigResponseErrorRetry(r,n);if(l.success)return{name:"GetExperimentConfigResponseErrorRetry",value:l.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("GetExperimentConfig",{Success:a,ErrorNoRetry:i,ErrorRetry:l}))}l.sendGetExperimentConfigRPC=e}),98);
__d("WAGetAbPropsProtocol",["WALogger","WAResultOrError","WASmaxAbPropsGetExperimentConfigRPC"],(function(t,n,r,o,a,i,l){"use strict";var e;async function s(t){var n=await o("WASmaxAbPropsGetExperimentConfigRPC").sendGetExperimentConfigRPC(t);if(n.name==="GetExperimentConfigResponseSuccess"){var r=n.value,a=r.erid,i=r.propsAbKey,l=r.propsDeltaUpdate,s=r.propsHash,c=r.propsProp,d=r.propsRefresh,m=r.propsRefreshId,p=u(c),_=p.newProps,f=p.samplingConfigs;return o("WAResultOrError").makeResult({abKey:i,hash:s,refresh:d,refreshId:m,props:_,samplingConfigs:f,erid:a==null?void 0:a.elementValue,isDeltaUpdate:l==="true"})}return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getAbPropsProtocol failed ",""])),n.value),o("WAResultOrError").makeError()}function u(e){var t=[],n=[];return e.forEach(function(e){var r=e.configs;if(r.name==="ExperimentConfig"){var o;t.push({configCode:r.value.configCode,configValue:r.value.configValue,configExpoKey:(o=r.value.configExpoKey)==null?void 0:o.toString()})}else r.name==="SamplingConfig"&&n.push({eventCode:r.value.eventCode,samplingWeight:r.value.samplingWeight})}),{newProps:t,samplingConfigs:n}}l.getAbPropsProtocol=s}),98);
__d("WAAbPropsSync",["WAAbProps","WAAbPropsHelpers","WAGetAbPropsProtocol","WALogger","WAPromiseManagement","WAResultOrError","WATimeUtils"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=o("WAPromiseManagement").cacheWhilePending(function(){return"abProps"},m);function m(e){var t=e.sendHash,n=t===void 0?!0:t;return n==null||n===!1?_(null):o("WAAbProps").getHash().then(function(e){return _(e)})}var p=m;async function _(t){var n=await o("WAGetAbPropsProtocol").getAbPropsProtocol({propsHash:t});if(!n.success)o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["fetchAbProps failed"])));else{var r=n.value,a=r.abKey,i=r.hash,l=r.props,u=r.refresh,c=o("WAAbPropsHelpers").parseAbProps(o("WAAbProps").getConfig(),l),d=await f(a,i,u,c);d.success===!1&&(d.error,o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncAbProps: detected no hash"]))))}var m=await o("WAAbProps").getRefreshSecs();return{seconds:m}}async function f(e,t,n,r){var a=await o("WAAbProps").getAbProps(),i={abKey:e!=null?e:a.abKey,hash:t!=null?t:a.hash,refresh:o("WAAbPropsHelpers").maybeUpdateRefresh(n),lastSyncTime:o("WATimeUtils").unixTime(),propValues:a.propValues,propExpoKeys:a.propExpoKeys,internalExpoKeys:a.internalExpoKeys,expoKeyStr:a.expoKeyStr};if(t==null)return await o("WAAbProps").setAbProps(i),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["WAAbProps.update: detected no hash"]))),o("WAResultOrError").makeError("noHash");o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["WAAbProps.update: updating ab configs"])));var l=r.expoKeys,s=r.values,d=o("WAAbPropsHelpers").maybeUpdatePropValues(s,a.propValues,o("WAAbProps").getConfig()),m=o("WAAbPropsHelpers").maybeUpdateExpoKeys(l,a.propExpoKeys,o("WAAbProps").getConfig()),p=m.expoKeysToDelete,_=m.propExpoKeys,f,g,h=o("WAAbPropsHelpers").maybeUpdateInternalExpoKeys(p,a.internalExpoKeys);return h!=null&&(f=h.internalExpoKeys,g=h.expoKeyStr),await o("WAAbProps").setAbProps(babelHelpers.extends({},i,{propValues:d,propExpoKeys:_,internalExpoKeys:f,expoKeyStr:g})),o("WAResultOrError").makeResult()}l.syncAbProps=d,l.syncAbPropsDebug=p}),98);
__d("WASmaxInDevicesFetchSelfResponseError",["WAResultOrError","WASmaxInDevicesIQErrorResponseMixin","WASmaxInDevicesRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInDevicesIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInDevicesRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup").parseRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup:i.value})):i}l.parseFetchSelfResponseError=e}),98);
__d("WASmaxInDevicesDeviceInfoMixin",["WAResultOrError","WASmaxInDevicesIdentityKeyMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"platform");if(!t.success)return t;var n=o("WASmaxParseUtils").contentString(e);return n.success?o("WAResultOrError").makeResult({elementValue:n.value}):n}function s(e){var t=o("WASmaxParseUtils").assertTag(e,"manufacturer");if(!t.success)return t;var n=o("WASmaxParseUtils").contentString(e);return n.success?o("WAResultOrError").makeResult({elementValue:n.value}):n}function u(e){var t=o("WASmaxParseUtils").assertTag(e,"model");if(!t.success)return t;var n=o("WASmaxParseUtils").contentString(e);return n.success?o("WAResultOrError").makeResult({elementValue:n.value}):n}function c(e){var t=o("WASmaxParseUtils").assertTag(e,"seen");if(!t.success)return t;var n=o("WASmaxParseUtils").contentInt(e);return n.success?o("WAResultOrError").makeResult({elementValue:n.value}):n}function d(e){var t=o("WASmaxParseUtils").assertTag(e,"creation");if(!t.success)return t;var n=o("WASmaxParseUtils").contentInt(e);return n.success?o("WAResultOrError").makeResult({elementValue:n.value}):n}function m(e){var t=o("WASmaxParseUtils").assertTag(e,"ip");if(!t.success)return t;var n=o("WASmaxParseUtils").contentString(e);return n.success?o("WAResultOrError").makeResult({elementValue:n.value}):n}function p(e){var t=o("WASmaxParseUtils").assertTag(e,"location");if(!t.success)return t;var n=o("WASmaxParseUtils").attrString(e,"latitude");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(e,"longitude");if(!r.success)return r;var a=o("WASmaxParseUtils").contentString(e);return a.success?o("WAResultOrError").makeResult({latitude:n.value,longitude:r.value,elementValue:a.value}):a}function _(t){var n=o("WASmaxParseUtils").assertTag(t,"device");if(!n.success)return n;var r=o("WASmaxParseUtils").optionalChildWithTag(t,"platform",e);if(!r.success)return r;var a=o("WASmaxParseUtils").optionalChildWithTag(t,"manufacturer",s);if(!a.success)return a;var i=o("WASmaxParseUtils").optionalChildWithTag(t,"model",u);if(!i.success)return i;var l=o("WASmaxParseUtils").optionalChildWithTag(t,"seen",c);if(!l.success)return l;var _=o("WASmaxParseUtils").optionalChildWithTag(t,"creation",d);if(!_.success)return _;var f=o("WASmaxParseUtils").optionalChildWithTag(t,"ip",m);if(!f.success)return f;var g=o("WASmaxParseUtils").optionalChildWithTag(t,"location",p);if(!g.success)return g;var h=o("WASmaxParseUtils").attrIntRange(t,"id",1,999);if(!h.success)return h;var y=o("WASmaxInDevicesIdentityKeyMixin").parseIdentityKeyMixin(t);return y.success?o("WAResultOrError").makeResult(babelHelpers.extends({id:h.value},y.value,{platform:r.value,manufacturer:a.value,model:i.value,seen:l.value,creation:_.value,ip:f.value,location:g.value})):y}l.parseDeviceInfoPlatform=e,l.parseDeviceInfoManufacturer=s,l.parseDeviceInfoModel=u,l.parseDeviceInfoSeen=c,l.parseDeviceInfoCreation=d,l.parseDeviceInfoIp=m,l.parseDeviceInfoLocation=p,l.parseDeviceInfoMixin=_}),98);
__d("WASmaxInDevicesFetchSelfResponseSuccess",["WAResultOrError","WASmaxInDevicesDeviceInfoMixin","WASmaxInDevicesIQResultResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"device");if(!t.success)return t;var n=o("WASmaxInDevicesDeviceInfoMixin").parseDeviceInfoMixin(e);return n.success,n}function s(t,n){var r=o("WASmaxParseUtils").assertTag(t,"iq");if(!r.success)return r;var a=o("WASmaxParseUtils").flattenedChildWithTag(t,"self");if(!a.success)return a;var i=o("WASmaxInDevicesIQResultResponseMixin").parseIQResultResponseMixin(t,n);if(!i.success)return i;var l=o("WASmaxParseUtils").mapChildrenWithTag(a.value,"device",1,25,e);return l.success?o("WAResultOrError").makeResult(babelHelpers.extends({},i.value,{selfDevice:l.value})):l}l.parseFetchSelfResponseSuccessSelfDevice=e,l.parseFetchSelfResponseSuccess=s}),98);
__d("WASmaxOutDevicesFetchSelfRequest",["WASmaxJsx","WASmaxOutDevicesBaseIQGetRequestMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxOutDevicesBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(o("WASmaxJsx").smax("iq",{to:o("WAWap").S_WHATSAPP_NET,xmlns:"fbid:devices"},o("WASmaxJsx").smax("self",null)));return e}l.makeFetchSelfRequest=e}),98);
__d("WASmaxDevicesFetchSelfRPC",["WAComms","WASmaxInDevicesFetchSelfResponseError","WASmaxInDevicesFetchSelfResponseSuccess","WASmaxOutDevicesFetchSelfRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(t,n,r,o,a,i,l){async function e(e){var t=o("WASmaxOutDevicesFetchSelfRequest").makeFetchSelfRequest(),n=await o("WAComms").sendSmaxStanza(t,e),r=o("WASmaxInDevicesFetchSelfResponseSuccess").parseFetchSelfResponseSuccess(n,t);if(r.success)return{name:"FetchSelfResponseSuccess",value:r.value};var a=o("WASmaxInDevicesFetchSelfResponseError").parseFetchSelfResponseError(n,t);if(a.success)return{name:"FetchSelfResponseError",value:a.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("FetchSelf",{Success:r,Error:a}))}l.sendFetchSelfRPC=e}),98);
__d("WAGetCurrentUserDeviceList",["WAAssertUnreachable","WAGlobals","WAJids","WALogger","WAPersistedJobManager","WASignalKeys","WASmaxDevicesFetchSelfRPC","WATimeUtils","err"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,n){if(t.isCurrentDevice&&n.isCurrentDevice)return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Two devices were detected as isCurrentDevice in getCurrentUserDeviceList"]))),0;if(t.isCurrentDevice)return-1;if(n.isCurrentDevice)return 1;if(t.lastSeen!=null&&n.lastSeen==null)return-1;if(t.lastSeen==null&&n.lastSeen!=null)return 1;if(t.lastSeen!=null&&n.lastSeen!=null){var r=t.lastSeen,a=n.lastSeen;return a.getTime()-r.getTime()}return 0}async function u(){var e=await o("WASmaxDevicesFetchSelfRPC").sendFetchSelfRPC();switch(e.name){case"FetchSelfResponseError":{var t=e.value.errorRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup;switch(t.name){case"RetryableIQError":{var n=t.value.backoff;throw n!=null?new(o("WAPersistedJobManager")).RetryOnBackoff({algo:{delay:n,type:"constant"},jitter:0}):new(o("WAPersistedJobManager")).RetryOnBackoff({algo:{first:o("WATimeUtils").HOUR_MILLISECONDS/60,type:"exponential"},jitter:.1})}default:{t.name;var a=t.value.code;throw r("err")("Failed with an error code "+a)}}}case"FetchSelfResponseSuccess":{var i=o("WAJids").extractDeviceId(o("WAGlobals").getMyDeviceJid());return e.value.selfDevice.map(function(e){var t,n,r,a,l,s=e.creation,u=e.elementValue,c=e.id,d=e.ip,m=e.location,p=e.manufacturer,_=e.model,f=e.platform,g=e.seen;return{creationTime:s==null?null:o("WATimeUtils").toDate(o("WATimeUtils").castToUnixTime(s.elementValue)),id:o("WAJids").interpretAsDeviceId(c),identityKey:o("WASignalKeys").serializeIdentity(u),ipAddress:(t=d==null?void 0:d.elementValue)!=null?t:null,isCurrentDevice:c===i,lastSeen:g==null?null:o("WATimeUtils").toDate(o("WATimeUtils").castToUnixTime(g.elementValue)),latitude:m==null?null:parseFloat(m.latitude),location:(n=m==null?void 0:m.elementValue)!=null?n:null,longitude:m==null?null:parseFloat(m.longitude),manufacturer:(r=p==null?void 0:p.elementValue)!=null?r:null,model:(a=_==null?void 0:_.elementValue)!=null?a:null,platform:(l=f==null?void 0:f.elementValue)!=null?l:null}}).sort(s)}default:return r("WAAssertUnreachable")(e.name)}}l.getCurrentUserDeviceList=u}),98);
__d("WAPublishAppDataProtocol",["FBLogger","WABridge","WAEncUserMsg","WAGetCurrentUserDeviceInfoApi","WAGlobals","WAOdsEnums","WASmaxAppdataPublishPeerRPC","WATagsLogger","WATimeUtils"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=o("WATagsLogger").TAGS(["sendAppDataFanout"]);async function c(t){var n=t.externalId,a=t.identities,i=t.messagePayload,l=a.get(o("WAGlobals").getMyUserJid());if(l==null)throw r("FBLogger")("wmi").mustfixThrow("Missing my user identities");var c=Array.from(l.entries()).map(function(e){var t=e[0],n=e[1];return{identity:n,jid:t}}),d=[{devicesInfo:c,user:o("WAGlobals").getMyUserJid()}],m=await o("WAGlobals").getWaOneQueue().enqueue(function(e){var t=e.cryptoManager;return o("WAEncUserMsg").encryptUserMsg(d,{messageBytes:i.messageBytes,type:"appdata"},{cryptoManager:t})},{operationType:"encrypt",flush:!0}),p=m.phash,_=!1,f=[];m.participants!=null&&m.participants.forEach(function(e){e.type==="pkmsg"&&(_=!0),f.push({toJid:e.to,encTypeIndividualMixinArgs:{encType:e.type,encElementValue:e.ciphertext},encVersionFutureproofMixinArgs:{encV:parseInt(e.v,10)}})});var g={appdataTo:o("WAGlobals").getMyUserJid(),toArgs:f},h={peerPeerFanout:g},y=void 0;if(_){var C=await o("WAGetCurrentUserDeviceInfoApi").getCurrentUserDeviceInfo(),b=C==null?void 0:C.identityKey;if(b==null)throw u.ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Failed to fetch current device public identity key"]))),r("FBLogger")("wmi").mustfixThrow("No public identity key");y={deviceIdentityElementValue:b}}var v={appdataDeviceListCheck:"true"},S={appdataId:n,peerMsgTypesArgs:h,deviceIdentityMixinArgs:y,withDeviceListCheckMixinArgs:v},R=await o("WASmaxAppdataPublishPeerRPC").sendPeerRPC(S);switch(R.name){case"PeerResponseSuccess":{var L,E=(L=R.value.deviceListStaleMixin)==null?void 0:L.phash;return E!=null&&p!=null&&E!==p?(u.LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Got phash mismatch on appdata, local[","] server[","]"])),p,E),o("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:o("WAOdsEnums").Entity.PHASH_MISMATCH,key:"appdata"}),{type:"success",ts:o("WATimeUtils").castToUnixTime(R.value.t),phash:{type:"mismatch",local:p,server:E},count:null,reportingMeta:null}):{type:"success",ts:o("WATimeUtils").castToUnixTime(R.value.t),phash:{type:"ok"},count:null,reportingMeta:null}}default:throw R.name,r("FBLogger")("wmi").mustfixThrow("Failed to send appdata %s",R.value.error)}}l.publishAppData=c}),98);
__d("WASaveReceiptApi",["MAWTransactionMode","WADbTransactor","WAMsg"],(function(t,n,r,o,a,i,l){"use strict";var e=o("WADbTransactor").makeSignalTransactor({receipts:o("MAWTransactionMode").READWRITE},"saveReceipt",function(e){return(function(t){return e.receipts.put({msgId:t.id.externalId.toString(),permittedIdentitiesPerDevice:t.permittedIdentitiesPerDevice,recipientDevices:t.recipientDevices,waMsgId:o("WAMsg").craftWAMsgIdString(t.id)}).then(function(){})})});l.saveReceipt=e}),98);
__d("WAPublishMessage",["FBLogger","WAGenReportingMeta","WAGlobals","WAJids","WALoadReceiptApi","WALogger","WAMsg","WASaveReceiptApi","WASendMsgInternal","WASentBytesCache","WATimeUtils","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s;async function u(e,t){var n=e.identities,r=e.messagePayload,a={author:r.protocolMsgId.author,chat:r.protocolMsgId.chat,externalId:r.protocolMsgId.externalId},i=await o("WALoadReceiptApi").loadReceipt(a);if(i.success)return i.value;var l=new Map;for(var s of n){var u=s[0],c=s[1];for(var d of c){var m=d[0],p=d[1];m!==o("WAGlobals").getMyDeviceJid()&&l.set(m,{pubKey:p})}}var _=new Set,f={permittedIdentitiesPerDevice:l,recipientDevices:_,id:a};return t.addPoint("save_receipts_start"),await o("WASaveReceiptApi").saveReceipt(f),t.addPoint("save_receipts_end"),f}async function c(t,n){var a=t.identities,i=t.messagePayload,l=t.sendIdentity,s=l===void 0?!1:l;n.addPoint("prepare_receipt_start");var c=await u({messagePayload:i,identities:a},n);n.addPoint("prepare_receipt_end"),n.addPoint("calculate_recipients_start");var p=i.backupDirective,_=i.frankingKey,f=i.frankingVersion,g=i.messageBytes,h=i.messageType,y=i.protocolMsgId,C=d(c.permittedIdentitiesPerDevice),b=h.type==="text"&&h.invitedParticipantUserJid!=null?C.filter(function(e){return e.user===h.invitedParticipantUserJid||e.user===o("WAGlobals").getMyUserJid()}):C;n.addPoint("calculate_recipients_end",{int:{recipientsCount:b.length}});var v=h.type==="text"&&h.invitedParticipantUserJid!=null?h.invitedParticipantUserJid:y.chat,S=y.chat===o("WAGlobals").getMyUserJid();if(b.length===0&&!S)throw r("FBLogger")("wmi").mustfixThrow("Trying to send a message with no recipients");if(b.length===0&&S)return{serverResponse:{type:"success",ts:o("WATimeUtils").unixTime(),phash:{type:"ok"},count:null,reportingMeta:null},encryption:{type:"user",messageTo:o("WAGlobals").getMyUserJid(),participants:[],phash:""}};var R=s?await o("WAGlobals").getWaOneQueue().enqueue(function(e){var t=e.cryptoManager;return m(t)},{operationType:"get_my_device_identity",flush:!1,afterInit:!0}):null,L=await(h.isRevoked===!0?Promise.resolve(null):o("WAGenReportingMeta").genReportingMeta(g.bytes,_,f)),E=await o("WASendMsgInternal").sendMessageV2({type:"chat",messageBytes:g,chat:v,deviceIdentity:R,messageType:h,protocolMsgId:y,externalId:y.externalId,recipients:b,reportingMeta:L,backupDirective:p},n),k=E.serverResponse;return k.type==="success"&&await o("WASentBytesCache").sentBytesCache().saveSentBytes({ts:k.ts,frankingKey:_,frankingVersion:f,messageBytes:g,backupDirective:p,messageType:h,protocolMsgId:y,waMsgId:o("WAMsg").craftWAMsgIdString({author:y.author,chat:y.chat,externalId:y.externalId})}).catch(function(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg failed to save sent bytes to cache: ",""])),t)}),E}function d(e){var t=new Map;return e.forEach(function(e,n){var r=e.pubKey,a=o("WAJids").extractUserJid(n),i={identity:r,jid:n},l=t.get(a)||[];l.push(i),t.set(a,l)}),Array.from(t,function(e){var t=e[0],n=e[1];return{devicesInfo:n,user:t}})}async function m(e){try{var t=await e.storage.loadIdentities(o("WAGlobals").getMyUserJid()),n=t.get(o("WAGlobals").getMyDeviceJid());if(n!=null)return n;throw r("err")("missing-identity")}catch(e){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Error loading current device identity ",""])),e)}}l.publishMessage=c}),98);
__d("WASmaxInDevicesIQErrorBadRequestOrItemNotFoundMixinGroup",["WAResultOrError","WASmaxInDevicesIQErrorBadRequestMixin","WASmaxInDevicesIQErrorItemNotFoundMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInDevicesIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:t.value});var n=o("WASmaxInDevicesIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(e);return n.success?o("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:n.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorBadRequest","IQErrorItemNotFound"],[t,n])}l.parseIQErrorBadRequestOrItemNotFoundMixinGroup=e}),98);
__d("WASmaxInDevicesNonRetryableRemoveDeviceIQErrorMixin",["WAResultOrError","WASmaxInDevicesIQErrorBadRequestOrItemNotFoundMixinGroup","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxInDevicesIQErrorBadRequestOrItemNotFoundMixinGroup").parseIQErrorBadRequestOrItemNotFoundMixinGroup(e);return n.success?o("WAResultOrError").makeResult({iQErrorBadRequestOrItemNotFoundMixinGroup:n.value}):n}l.parseNonRetryableRemoveDeviceIQErrorMixin=e}),98);
__d("WASmaxInDevicesRetryableOrNonRetryableRemoveDeviceIQErrorMixinGroup",["WAResultOrError","WASmaxInDevicesNonRetryableRemoveDeviceIQErrorMixin","WASmaxInDevicesRetryableIQErrorMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInDevicesRetryableIQErrorMixin").parseRetryableIQErrorMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"RetryableIQError",value:t.value});var n=o("WASmaxInDevicesNonRetryableRemoveDeviceIQErrorMixin").parseNonRetryableRemoveDeviceIQErrorMixin(e);return n.success?o("WAResultOrError").makeResult({name:"NonRetryableRemoveDeviceIQError",value:n.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["RetryableIQError","NonRetryableRemoveDeviceIQError"],[t,n])}l.parseRetryableOrNonRetryableRemoveDeviceIQErrorMixinGroup=e}),98);
__d("WASmaxInDevicesRemoveResponseError",["WAResultOrError","WASmaxInDevicesIQErrorResponseMixin","WASmaxInDevicesRetryableOrNonRetryableRemoveDeviceIQErrorMixinGroup","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInDevicesIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInDevicesRetryableOrNonRetryableRemoveDeviceIQErrorMixinGroup").parseRetryableOrNonRetryableRemoveDeviceIQErrorMixinGroup(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorRetryableOrNonRetryableRemoveDeviceIQErrorMixinGroup:i.value})):i}l.parseRemoveResponseError=e}),98);
__d("WASmaxInDevicesRemoveResponseSuccess",["WASmaxInDevicesIQResultResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxInDevicesIQResultResponseMixin").parseIQResultResponseMixin(e,t);return r.success,r}l.parseRemoveResponseSuccess=e}),98);
__d("WASmaxOutDevicesKeyDataMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(e){var t=e.anyElementValue,n=o("WASmaxJsx").smax("smax$any",null,t);return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeKeyDataMixin=s}),98);
__d("WASmaxOutDevicesIdentityKeyMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutDevicesKeyDataMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxJsx").smax("smax$any",null,o("WASmaxOutDevicesKeyDataMixin").mergeKeyDataMixin(o("WASmaxJsx").smax("identity",null),e));return t}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeIdentityKeyMixin=s}),98);
__d("WASmaxOutDevicesRemoveRequest",["WASmaxJsx","WASmaxOutDevicesBaseIQSetRequestMixin","WASmaxOutDevicesIdentityKeyMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.removeId,n=e.identityKeyMixinArgs,r=o("WASmaxOutDevicesBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin(o("WASmaxJsx").smax("iq",{to:o("WAWap").S_WHATSAPP_NET,xmlns:"fbid:devices"},o("WASmaxOutDevicesIdentityKeyMixin").mergeIdentityKeyMixin(o("WASmaxJsx").smax("remove",{id:o("WAWap").INT(t)}),n)));return r}l.makeRemoveRequest=e}),98);
__d("WASmaxDevicesRemoveRPC",["WAComms","WASmaxInDevicesRemoveResponseError","WASmaxInDevicesRemoveResponseSuccess","WASmaxOutDevicesRemoveRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(t,n,r,o,a,i,l){async function e(e,t){var n=o("WASmaxOutDevicesRemoveRequest").makeRemoveRequest(e),r=await o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInDevicesRemoveResponseSuccess").parseRemoveResponseSuccess(r,n);if(a.success)return{name:"RemoveResponseSuccess",value:a.value};var i=o("WASmaxInDevicesRemoveResponseError").parseRemoveResponseError(r,n);if(i.success)return{name:"RemoveResponseError",value:i.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("Remove",{Success:a,Error:i}))}l.sendRemoveRPC=e}),98);
__d("WARemoveDevice",["WALogger","WAPersistedJobManager","WAPushSafeTypes","WAResultOrError","WASignalOther","WASmaxDevicesRemoveRPC","WATimeUtils"],(function(t,n,r,o,a,i,l){"use strict";var e;async function s(t){var n=o("WAPushSafeTypes").unsafeNotNullable(t),r=n.deviceId,a=n.identity,i=o("WASignalOther").sliceBytes(a,1,32),l=await o("WASmaxDevicesRemoveRPC").sendRemoveRPC({removeId:r,identityKeyMixinArgs:{anyElementValue:i}});if(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["removeDevice result for ",": "," "])),r,l),l.name==="RemoveResponseSuccess")return o("WAResultOrError").makeResult();l.name;var s=l.value.errorRetryableOrNonRetryableRemoveDeviceIQErrorMixinGroup;if(s.name!=="RetryableIQError")return o("WAResultOrError").makeError();s.name;var u=s.value.backoff;throw u!=null?new(o("WAPersistedJobManager")).RetryOnBackoff({algo:{type:"constant",delay:u},jitter:0}):new(o("WAPersistedJobManager")).RetryOnBackoff({algo:{type:"exponential",first:o("WATimeUtils").HOUR_MILLISECONDS/60},jitter:.1})}l.removeDevice=s}),98);
__d("WARemoveCurrentDevice",["WAGetCurrentUserDeviceInfoApi","WAGlobals","WALogger","WARemoveDevice","WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";var e,s=async function(){var t=await o("WAGetCurrentUserDeviceInfoApi").getCurrentUserDeviceInfo();if(t==null)return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["There is no stored user info, it was already deleted or this job was called twice, possibly from another tab"]))),o("WAResultOrError").makeResult();var n=t.deviceId,r=t.identityKey,a=await o("WARemoveDevice").removeDevice({deviceId:n,identity:r});return a.success&&await o("WAGlobals").getDependencies().clearSignalAndTempStores(),o("WAResultOrError").makeResult()};l.removeCurrentDevice=s}),98);
__d("WASendAppDataFanoutProtocol",["WAAsMessageApplication","WABridge","WAConvertAppData","WAEncUserMsg","WAErrorMessage","WAGetCurrentUserDeviceInfoApi","WAGlobals","WAMsgApplication.pb","WAOdsEnums","WAResultOrError","WASmaxAppdataPublishPeerRPC","WATagsLogger","WATimeUtils","encodeProtobuf"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_=o("WATagsLogger").TAGS(["sendAppDataFanout"]),f=24;function g(t){var n=t.checkPhash,r=n===void 0?"checkPhash":n,a=t.contents,i=t.externalId,l=t.permittedIdentitiesPerDevice;return h(a,i,l,r).catch(function(t){var n=o("WAErrorMessage").maybeGetMessageFromError(t);return _.ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Failed to send appdata to devices with error: ",""])),n),o("WAResultOrError").makeError("runtime-error")})}async function h(e,t,n,r){r===void 0&&(r="checkPhash"),_.LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Sending appdata, externalId: ",""])),t);var a=o("WAConvertAppData").convertAppData(e),i={bytes:o("WAAsMessageApplication").castToMessageApplicationBytes(o("encodeProtobuf").encodeProtobuf(o("WAMsgApplication.pb").MessageApplicationSpec,a).readByteArrayView()),version:"v3"},l=[],g=Array.from(n.entries()).map(function(e){var t=e[0],n=e[1];return{identity:n.pubKey,jid:t}}),h=f;g.length>h&&(_.WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Attempting to send an appData stanza to "," devices"])),g.length),_.ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Attempting to send an appData stanza to more than the allowed "," devices"])),h),g=g.slice(0,h));var y=[{devicesInfo:g,user:o("WAGlobals").getMyUserJid()}],C=await o("WAGlobals").getWaOneQueue().enqueue(function(e){var t=e.cryptoManager;return o("WAEncUserMsg").encryptUserMsg(y,{messageBytes:i,type:"appdata"},{cryptoManager:t})},{operationType:"encrypt",flush:!0}),b=C.phash,v=!1;C.participants!=null&&C.participants.forEach(function(e){e.type==="pkmsg"&&(v=!0),l.push({toJid:e.to,encTypeIndividualMixinArgs:{encType:e.type,encElementValue:e.ciphertext},encVersionFutureproofMixinArgs:{encV:parseInt(e.v,10)}})});var S={appdataTo:o("WAGlobals").getMyUserJid(),toArgs:l},R={peerPeerFanout:S},L=void 0;if(v){var E=await o("WAGetCurrentUserDeviceInfoApi").getCurrentUserDeviceInfo(),k=E==null?void 0:E.identityKey;if(k==null)return _.ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Failed to fetch current device public identity key"]))),o("WAResultOrError").makeError("no-public-identity");L={deviceIdentityElementValue:k}}var I={appdataDeviceListCheck:r==="checkPhash"?"true":"false"},T={appdataId:t,peerMsgTypesArgs:R,deviceIdentityMixinArgs:L,withDeviceListCheckMixinArgs:I},D=await o("WASmaxAppdataPublishPeerRPC").sendPeerRPC(T);switch(D.name){case"PeerResponseSuccess":{var x,$=(x=D.value.deviceListStaleMixin)==null?void 0:x.phash;return $!=null&&b!=null&&$!==b?(_.LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Got phash mismatch on appdata, local[","] server[","]"])),b,$),o("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:o("WAOdsEnums").Entity.PHASH_MISMATCH,key:"appdata"}),o("WAResultOrError").makeResult({phashMismatch:!0,serverTs:o("WATimeUtils").castToUnixTime(D.value.t)})):o("WAResultOrError").makeResult({phashMismatch:!1,serverTs:o("WATimeUtils").castToUnixTime(D.value.t)})}default:return D.name,_.ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Failed to send appdata. Error: ",""])),D.value.error),o("WAResultOrError").makeError("ack-failure")}}l.MAX_APPDATA_RECIPIENTS=f,l.sendAppDataToDevicesProtocol=g}),98);
__d("WASendMsgUtilV2",["WADevicesState","WAGenReportingMeta","WAGlobals","WAJids","WALoadReceiptApi","WALogger","WAMsg","WAResultOrError","WASaveReceiptApi","WASendMsgInternal","WASentBytesCache","WATimeUtils","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p;function _(e){return Promise.resolve()}function f(e,t){return o("WADevicesState").getDevicesState().waitForUserDevices(Array.from(new Set([e,o("WAGlobals").getMyUserJid()])),"GetDevicesBeforeSend: "+t)}function g(t){var n=t.chatJid,r=t.reason;return o("WAJids").switchOnChatJidType(n,{group:function(t){return _(t)},interopUser:function(t){return f(t,r)},lidUser:function(t){return f(t,r)},msgrUser:function(t){return f(t,r)},phoneUser:function(t){return f(t,r)}}).catch(function(t){return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Error during get devices before sending: ",""])),t),Promise.resolve()})}async function h(e,t){var n=e.loadThreadParticipants,r=e.messagePayload,a={author:r.protocolMsgId.author,chat:r.protocolMsgId.chat,externalId:r.protocolMsgId.externalId},i=await o("WALoadReceiptApi").loadReceipt(a);if(i.success)return i;t.addPoint("get_devices_before_send_start"),await g({chatJid:r.protocolMsgId.chat,reason:"prepareReceipt"}),t.addPoint("get_devices_before_send_end");var l=await n(r.protocolMsgId.chat);t.addPoint("get_identities_start");var u=await o("WAGlobals").getWaOneQueue().enqueue(function(e){var t=e.cryptoManager;return t.storage.bulkLoadIdentities(l)},{flush:!1,afterInit:!0,operationType:"prepare_receipt_load_identities"}),c=[];if(u.size===0)c=[].concat(l);else for(var d of u){var m=d[0],p=d[1];p.size===0&&c.push(m)}c.length>0&&(await o("WADevicesState").getDevicesState().waitForUserDevices(c,"GetDevicesBeforeSend: prepareReceipt",!0),u=await o("WAGlobals").getWaOneQueue().enqueue(function(e){var t=e.cryptoManager;return t.storage.bulkLoadIdentities(l)},{afterInit:!0,flush:!1,operationType:"prepare_receipt_load_identities"}));var _=new Map;for(var f of u){var h=f[0],y=f[1];for(var C of y){var b=C[0],v=C[1];b!==o("WAGlobals").getMyDeviceJid()&&_.set(b,{pubKey:v})}}t.addPoint("get_identities_end");var S=new Set,R={permittedIdentitiesPerDevice:_,recipientDevices:S,id:a};return t.addPoint("save_receipts_start"),await o("WASaveReceiptApi").saveReceipt(R).catch(function(e){return t.addPoint("save_receipts_fail"),o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Failed to save receipt for message with error ",""])),e),o("WAResultOrError").makeError("missing-receipt")}),t.addPoint("save_receipts_end"),o("WAResultOrError").makeResult(R)}async function y(e,t){var n=e.isInstamadillo,r=n===void 0?!1:n,a=e.loadThreadParticipants,i=e.messagePayload,l=e.sendIdentity,s=l===void 0?!1:l;t.addPoint("prepare_receipt_start");var p=await h({messagePayload:i,loadThreadParticipants:a},t);if(p.success===!1)return t.addPoint("prepare_receipt_fail"),o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Trying to send a message that does not have a receipt in db"]))),o("WAResultOrError").makeError({type:"missing-receipt"});t.addPoint("prepare_receipt_end");var _=p.value,f=i.backupDirective,g=i.frankingKey,y=i.frankingVersion,v=i.messageBytes,S=i.messageType,R=i.protocolMsgId,L=C(_.permittedIdentitiesPerDevice),E=S.type==="text"&&S.invitedParticipantUserJid!=null?L.filter(function(e){return e.user===S.invitedParticipantUserJid||e.user===o("WAGlobals").getMyUserJid()}):L;t.addPoint("recipients-calculated",{int:{recipientsCount:E.length},string:{msgType:S.type}});var k=S.type==="text"&&S.invitedParticipantUserJid!=null?S.invitedParticipantUserJid:R.chat,I=R.chat===o("WAGlobals").getMyUserJid();if(E.length===0&&!I)return o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Trying to send a message with no recipients"]))),o("WAResultOrError").makeError({type:"no-recipients",isRetriable:!1});if(E.length===0&&I)return o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Trying to send a message with no recipients, but it is a self thread"]))),o("WAResultOrError").makeResult({baseKey:null,reportingMeta:null,serverTs:o("WATimeUtils").unixTime()});var T=s?await o("WAGlobals").getWaOneQueue().enqueue(function(e){var t=e.cryptoManager;return b(t)},{operationType:"get_my_device_identity",flush:!1,afterInit:!0}):null,D=await(S.isRevoked===!0?Promise.resolve(null):o("WAGenReportingMeta").genReportingMeta(v.bytes,g,y));return o("WASendMsgInternal").sendMessage({type:"chat",messageBytes:v,chat:k,deviceIdentity:T,messageType:S,protocolMsgId:R,externalId:R.externalId,recipients:E,reportingMeta:D,backupDirective:f},t,r).then(function(e){return e.success?o("WASentBytesCache").sentBytesCache().saveSentBytes({ts:e.value.serverTs,frankingKey:g,frankingVersion:y,messageBytes:v,backupDirective:f,messageType:S,protocolMsgId:R,waMsgId:o("WAMsg").craftWAMsgIdString({author:R.author,chat:R.chat,externalId:R.externalId})}).catch(function(e){o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg failed to save sent bytes to cache: ",""])),e)}).then(function(){return e}):e})}function C(e){var t=new Map;return e.forEach(function(e,n){var r=e.pubKey,a=o("WAJids").extractUserJid(n),i={identity:r,jid:n},l=t.get(a)||[];l.push(i),t.set(a,l)}),Array.from(t,function(e){var t=e[0],n=e[1];return{devicesInfo:n,user:t}})}async function b(e){try{var t=await e.storage.loadIdentities(o("WAGlobals").getMyUserJid()),n=t.get(o("WAGlobals").getMyDeviceJid());if(n!=null)return n;throw r("err")("missing-identity")}catch(e){o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Error loading current device identity ",""])),e)}}l.getDevicesBeforeSend=g,l.sendChatMessage=y}),98);
__d("WASetClockSkewApi",["WASetMetaApi"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t){var e=t.clockSkew;return o("WASetMetaApi").setMeta({clockSkew:e})};l.setClockSkew=e}),98);
__d("WASendPing",["WAComms","WALogger","WASetClockSkewApi","WATimeUtils"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["sendPing: sending"]))),o("WAComms").sendPing()}async function u(e){var t=e.clockSkew;o("WATimeUtils").setClockSkew(t),await o("WASetClockSkewApi").setClockSkew({clockSkew:t})}l.sendPing=s,l.updateClockSkew=u}),98);
__d("WASignalDbDump",["WASignalDB","WormDump"],(function(t,n,r,o,a,i,l){"use strict";function e(){var e,t=o("WASignalDB").getDb();return t.dump({contacts:{customFields:{lastSyncTs:(e=o("WormDump")).wormNonSensitiveField},limit:2e3},meta:{customFields:{key:e.wormNonSensitiveField}},prekey:{customFields:{keyId:e.wormNonSensitiveField,isDeleted:e.wormNonSensitiveField}},prekeyGeneration:{customFields:{createdTs:e.wormNonSensitiveField,generationId:e.wormNonSensitiveField,startingId:e.wormNonSensitiveField,endingId:e.wormNonSensitiveField}}})}l.debugGetSignalDbDump=e}),98);
__d("WASyncAbProps",["WAAbPropsSync","WALogger"],(function(t,n,r,o,a,i,l){"use strict";var e;async function s(t){var n=t.sendHash;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Syncing ABProps"]))),await o("WAAbPropsSync").syncAbProps({sendHash:n})}l.syncAbProps=s}),98);
__d("encryptedBackupsOptOutOfBackup",["LSEncryptedBackupsOpStatus","LSFactory","LSIntEnum","LSOptOutOfBackupStoredProcedure","ReQL"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){return o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.tables.encrypted_backups)).then(function(n){if(n==null)return[(e||(e=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsOpStatus").FAILURE)];var a=n.backupId;return a!=null?t.runInTransaction(function(e){return r("LSOptOutOfBackupStoredProcedure")(r("LSFactory")(e),{backupId:a})},"readwrite",void 0,void 0,i.id+":32"):[(e||(e=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsOpStatus").FAILURE)]})}l.optOutOfBackupStoredProcedure=s}),98);/*FB_PKG_DELIM*/
__d("ACSCipherSuiteModule",[],(function(t,n,r,o,a,i){"use strict";var e={hash:"SHA-512",name:"HMAC"},l={curveName:"RISTRETTO",macAlgorithm:e,value:1},s=new Map([[l.value,l]]);function u(e){return s.has(e)?s.get(e):null}i.VOPRF_RISTRETTO_HMACSHA512=l,i.getACSCipherSuiteByValue=u}),66);
__d("ACSTokenHmacUtil",["XPlatReactCrypto"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){return s(e,t).then(function(e){return c(e,n)})}function s(e,t){return o("XPlatReactCrypto").subtleImportKey("raw",t,e,!1,["sign"]).then(function(t){return{algo:e,key:t}})}function u(e){return typeof e.hash=="string"?e.hash:e.hash.name}function c(e,t){var n=e.algo,r=e.key,a={hash:u(n),name:"HMAC"};return o("XPlatReactCrypto").subtleSign(a,r,t).then(function(e){return new Uint8Array(e)})}l.hmac=e}),98);
__d("EBDBConsistencyApi",["$InternalEnum","EBDB","FBLogger","I64","QPLUserFlow","ReQL","getErrorSafe","justknobx","qpl"],(function(t,n,r,o,a,i,l){"use strict";var e,s=["encrypted_backups_virtual_devices","secure_encrypted_backups_recovery_code_status","device_metadata","secure_encrypted_backups_epochs","secure_encrypted_backups_client_state","encrypted_backups","experiences_shared_state","auto_restore_opt_out"],u=null;function c(){return u}async function d(t,n){try{var a=await o("EBDB").getEBDB(),l=BigInt((e||(e=o("I64"))).to_string(n));await a.runInTransaction(["device_state"],"readwrite",function(e){return e.stores.device_state.bulkPut([{deviceId:l,env:t}])},"EBDB - AddDevice",i.id+":54"),u=l}catch(e){r("FBLogger")("wmi_eb").catching(r("getErrorSafe")(e)).mustfix("Error on EBDB - AddDevice")}}function m(e){return o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.tables.secure_encrypted_backups_client_state)).then(function(e){return e==null?void 0:e.deviceId})}async function p(e,t,n){if(n!=null)return d(t,n);try{var o=await m(e);return o==null?void 0:d(t,o)}catch(e){r("FBLogger")("wmi_eb").catching(r("getErrorSafe")(e)).mustfix("Error on fetching secure_encrypted_backups_client_state")}}async function _(e,t){r("QPLUserFlow").addPoint(t,"track_overprompting_start");try{var n=await o("EBDB").getEBDB(),a=!1;await n.runInTransaction(["device_state"],"readwrite",async function(t){var n=await t.stores.device_state.get(e);(n==null?void 0:n.deviceId)!=null&&(a=!0)},"EBDB - AddDevice",i.id+":107"),r("QPLUserFlow").addAnnotations(t,{bool:{overprompting:a}}),r("QPLUserFlow").addPoint(t,"track_overprompting_end")}catch(e){r("QPLUserFlow").addPoint(t,"track_overprompting_fail"),r("FBLogger")("wmi_eb").catching(r("getErrorSafe")(e)).mustfix("Error on track overpropting")}}var f=n("$InternalEnum")({Disabled:0,EbsmInconsistent:1,EbdbInconsistent:2,Enabled:3,Inconsistent:4});async function g(t){var n=await m(t),r=n!=null?BigInt((e||(e=o("I64"))).to_string(n)):null;return r==null&&u==null?f.Disabled:r==null&&u!=null?f.EbsmInconsistent:r!=null&&u==null?f.EbdbInconsistent:r===u?f.Enabled:f.Inconsistent}async function h(e,t,n,o){var a=1/r("justknobx")._("3914");if(!(Math.random()>=a)){var i=r("qpl")._(521471316,"2831");try{r("QPLUserFlow").start(i);var l=await g(e);o!=null&&r("QPLUserFlow").addAnnotations(i,o()),r("QPLUserFlow").endSuccess(i,{annotations:{int:{consistency:l,env:t,operation:n}}})}catch(e){r("QPLUserFlow").endFailure(i,"error"),r("FBLogger")("wmi_eb").catching(r("getErrorSafe")(e)).mustfix("Error on trackConsistency in %s",t)}}}async function y(){await o("EBDB").clearDeviceState(),u=null}var C;async function b(t,n){C!=null&&C(),await o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.tables.encrypted_backups)).then(function(e){e!=null&&((e==null?void 0:e.backupId)==null||(e==null?void 0:e.isUserOptedOut)===!0)&&y()}).catch(function(e){r("FBLogger")("wmi_eb").catching(e).mustfix("EBDBApi: EBLS error on fetching data from encrypted_backups")}),C=t.tables.encrypted_backups.subscribe(function(e,t){t.operation!=="delete"&&(t.value.backupId==null||t.value.isUserOptedOut===!0)&&y()});var a=await o("EBDB").getEBDB(),l=await a.runInTransaction(["device_state"],"readonly",function(e){return e.stores.device_state.get(n)},"EBDB - readDeviceState",i.id+":250").catch(function(e){r("FBLogger")("wmi_eb").catching(e).mustfix("EBDB error: fetching device_state")});if(u=v(l==null?void 0:l.deviceId),u==null){var s=await m(t);if(s==null)return;var c=BigInt((e||(e=o("I64"))).to_string(s));u=c,await a.runInTransaction(["device_state"],"readwrite",function(e){return e.stores.device_state.bulkPut([{deviceId:c,env:n}])},"EBDB - writeDeviceState",i.id+":272").catch(function(e){r("FBLogger")("wmi_eb").catching(e).mustfix("EBDB error: write device_state")})}}function v(t){if(t!=null){if(typeof t=="bigint")return t;if(typeof t=="number")return BigInt(t);if(typeof t=="string")try{return BigInt(t)}catch(e){r("FBLogger")("wmi_eb").catching(r("getErrorSafe")(e)).mustfix("EBDBApi: Parsing string as BigInt"),y();return}if(Array.isArray(t))try{return BigInt((e||(e=o("I64"))).to_string(t))}catch(e){r("FBLogger")("wmi_eb").catching(r("getErrorSafe")(e)).mustfix("EBDBApi: Parsing I64 as BigInt"),y();return}r("FBLogger")("wmi_eb").mustfix("EBDBApi: Parsing unknown as BigInt %s",String(t)),y()}}l.EB_STORES=s,l.getDeviceId=c,l.addNewDevice=p,l.trackOverprompting=_,l.EBConsistencyResult=f,l.checkRegistrationConsistency=g,l.trackConsistency=h,l.clearDeviceState=y,l.startListeningDeviceRegistrations=b}),98);
__d("EBEpochChangeListener",["EBIsEbEnabled","EBIsEbEnabledSubscriber","ReQL","WAPubSub","err"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.$1=o("WAPubSub").simplePubSub(),this.$3=e}var t=e.prototype;return t.initialize=async function(){var e=this;await o("EBIsEbEnabled").isEbEnabledLS(this.$3.tables)&&this.$4(this.$3),await o("EBIsEbEnabledSubscriber").isEbEnabledSubscriber().then(function(t){t.subscribe(function(t){t?e.$4(e.$3):e.$2==null||e.$2()})})},t.$4=function(t){var e=this;return this.$2==null&&(this.$2=o("ReQL").fromTableAscending(t.tables.secure_encrypted_backups_epochs).subscribe(function(t,n){e.$1.publish(n)})),this.$2},t.subscribe=function(t){return this.$1.subscribe(t)},e})(),s;async function u(t){if(s!=null)return Promise.resolve();s=new e(t),await s.initialize()}function c(e){if(s==null)throw r("err")("EBEpochChangeListener is not initialized");return s.subscribe(e)}l.initEBEpochChangeListener=u,l.subscribeToEpochChanges=c}),98);
__d("RecoveryCodeDB",["MAWCurrentUser","MAWIndexedDbMetadata","MAWODSProxy","MessengerWebInitData","QPLFlow","WAHex","WALogger","WAOdsEnums","WAResolvable","Worm","WormEAR","WormIDbDriver","qpl"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u={persisted_recovery_code:{indexes:{},primaryKey:"pk"}},c=1e4,d=new(o("WAResolvable")).Resolvable;async function m(){var t=o("MAWIndexedDbMetadata").ebRecoveryCodeDBName(o("MAWCurrentUser").getID()),n=o("WAHex").parseHex(r("MessengerWebInitData").accountKeyV2),a={log:function(t){return o("MAWODSProxy").odsBumpEntityKey({entity:o("WAOdsEnums").Entity.EB_RECOVERY_CODE_DB,key:t})}},i=r("qpl")._(1056840657,"2716"),l=o("QPLFlow").startQPLFlow(i,{annotations:{string:{dbType:"recovery_code_db",operationType:"initRecoveryCodeDB"}},timeoutInMs:c});try{var m="recovery_code_db",p=new(o("WormEAR")).WormEAR(u,m,n),_=new(o("Worm")).WormDatabase(new(o("WormIDbDriver")).WormIDbDriver(t,m,u,p,a,{onTransactionError:function(n){n instanceof o("WormEAR").DecryptionError&&o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Error decrypting RecoveryCodeDB"])))},safeToDeleteStores:new Set(["migration"])}),i);await _.init({eventFlow:l}),l.endSuccess(),d.resolve(_)}catch(e){throw l.endFail("error"),o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Error initializing RecoveryCodeDB: ",""])),e),d.reject(e),e}}async function p(){return d.resolveWasCalled()||await m(),d.promise}l.schema=u,l.getOrCreateRecoveryCodeDB=p}),98);
__d("EBOnboardDeviceWithAutomaticEB",["EBIsEbEnabled","EBLogger","EBSMAPI","LSAuthorityLevel","MAWCurrentUser","MAWODSProxy","RecoveryCodeDB","WAOdsEnums","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=o("EBLogger").EBLogger().tags(["EBOnboardDeviceWithAutomaticEB"]);async function m(){try{var t=await o("EBIsEbEnabled").isEBEnabled();if(t){d.DEBUG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["EB is already enabled, skipping onboard with recovery code"])));return}d.DEBUG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["EB is not enabled, checking for recovery code in database"])));var n=await o("RecoveryCodeDB").getOrCreateRecoveryCodeDB(),a=await n.runInTransaction(["persisted_recovery_code"],"readonly",async function(e){var t=await e.stores.persisted_recovery_code.readAll(),n=t.find(function(e){return e.authorityLevel===r("LSAuthorityLevel").AUTHORITATIVE});return n==null?void 0:n.recoveryCode},"RecoveryCodeDB - read recovery code for adding device");if(a==null){d.DEBUG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["No recovery code found in database"])));return}d.DEBUG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Found recovery code in database, attempting to add device"]))),o("MAWODSProxy").odsBumpEntityKey({entity:o("WAOdsEnums").Entity.AUTOMATIC_EB,key:"onboard_device_with_recovery_code.attempt"});var i=await r("EBSMAPI").addDeviceWithRecoveryCode({recoveryCode:a,userId:o("MAWCurrentUser").getID()});i.success?(d.info("Successfully added device with recovery code from database"),o("MAWODSProxy").odsBumpEntityKey({entity:o("WAOdsEnums").Entity.AUTOMATIC_EB,key:"onboard_device_with_recovery_code.success"})):(d.warn("Failed to add device with recovery code: "+i.error),o("MAWODSProxy").odsBumpEntityKey({entity:o("WAOdsEnums").Entity.AUTOMATIC_EB,key:"onboard_device_with_recovery_code.failure."+i.error}),o("MAWODSProxy").odsBumpEntityKey({entity:o("WAOdsEnums").Entity.AUTOMATIC_EB,key:"onboard_device_with_recovery_code.failure"}))}catch(e){d.catching(r("getErrorSafe")(e)).warn("Failed to onboard device with automatic EB after EBLS init")}}l.onboardDeviceWithAutomaticEB=m}),98);
__d("EBResumeAutomaticEBInitialisation",["EBLogger","EBSMAPI","LSAuthorityLevel","LSIntEnum","RecoveryCodeDB","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e;async function s(){try{var t=await o("RecoveryCodeDB").getOrCreateRecoveryCodeDB(),n=await t.runInTransaction(["persisted_recovery_code"],"readonly",async function(e){var t=await e.stores.persisted_recovery_code.readAll(),n=t.find(function(e){return e.virtualDeviceType===16&&e.authorityLevel===r("LSAuthorityLevel").OPTIMISTIC});return n!=null},"FetchOptimisticRecoveryCode");n&&(o("EBLogger").EBLogger().info("Found existing optimistic recovery code, resuming backup initialization"),await r("EBSMAPI").initializeBackup({virtualDeviceId:null,virtualDeviceType:(e||(e=o("LSIntEnum"))).ofNumber(16)}))}catch(e){o("EBLogger").EBLogger().catching(r("getErrorSafe")(e)).warn("Failed to resume initialization from optimistic recovery code")}}l.resumeAutomaticEBInitialisation=s}),98);
__d("EBWorkerAddDeviceUtils",["EBDB","EBDBEbsmApi","EBSMProperties","I64","LSAuthorityLevel","LSIntEnum","LSJSEBInMemoryStorage","LSMetadata","LSReStoreWrapper","MAWLSVaultingHooks","ReQL","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s;async function u(t,n){var a=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(n.tables.secure_encrypted_backups_client_state));if(a!=null)return"dest_table_not_empty";var l={clearEbStores:o("EBDB").clearEbStores,flushEBSMtoEBDB:o("EBDBEbsmApi").flushEBSMtoEBDB,rehydrateEBSMFromEBDB:o("EBDBEbsmApi").rehydrateEBSMFromEBDB,updateEBSM:function(){return Promise.resolve()}},u=await o("LSJSEBInMemoryStorage").makeReStorePersistence(l);if(u==null)throw r("err")("persistence is null");var c=o("LSReStoreWrapper").createLSReStore(u,o("LSMetadata").schema,[r("MAWLSVaultingHooks")],void 0),d=await o("ReQL").toArrayAsync(o("ReQL").fromTableAscending(c.tables.secure_encrypted_backups_epochs));return d.filter(function(t){return(e||(e=o("I64"))).equal(t.authorityLevel,(s||(s=o("LSIntEnum"))).ofNumber(r("LSAuthorityLevel").AUTHORITATIVE))}).length===0?"source_epoch_not_authoritative":c.runInTransaction(function(e){return n.runInTransaction(async function(n){var r=await Promise.all(t.map(async function(t){var r=e[t],o=r.entries(new WeakMap),a=await o.next();if(a.done)return"source_table_empty";for(var i=n[t];!a.done;){var l=a.value,s=l[0],u=l[1];await i.upsert(s,u),a=await o.next()}return"success"})),o=new Set(r);return o.has("source_table_empty")?"source_table_empty":o.has("success")&&o.size===1?"success":"fail"},"readwrite",void 0,void 0,i.id+":91")},"readonly",void 0,void 0,i.id+":89")}async function c(e){await e.runInTransaction(function(e){return Promise.all(r("EBSMProperties").persistedTablesArray.map(async function(t){for(var n=e[t],r=n.entries(new WeakMap),o=await r.next();!o.done;)await n.delete.apply(n,o.value[0]),o=await r.next()}))},"readwrite",void 0,void 0,i.id+":131")}l.copyEBStateTablesFromMainthreadToWorker=u,l.clearLSEBSMTables=c}),98);
__d("LSSyncStoredProcedureUtils",["I64","ReQL"],(function(t,n,r,o,a,i,l){"use strict";var e;async function s(t,n,r){var a=r!=null?(e||(e=o("I64"))).of_float(Date.now()+r):n.minTimeToSyncTimestampMs;await t.pending_tasks.put(babelHelpers.extends({},n,{failureCount:(e||(e=o("I64"))).add(n.failureCount,e.one),minTimeToSyncTimestampMs:a}))}async function u(e,t,n){var r=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.pending_tasks.index("queueNameTaskId")).getKeyRange(t));if(r!=null)return s(e,r,n)}async function c(t,n,r){var a=await t.network_requests.get(n,r);a!=null&&await t.network_requests.put(babelHelpers.extends({},a,{failureCount:(e||(e=o("I64"))).add(a==null?void 0:a.failureCount,e.one)}))}async function d(e,t,n){var r=await e.network_requests.get(t,n);r!=null&&await e.network_requests.put(babelHelpers.extends({},r,{epochId:void 0,networkTaskIdentifier:void 0}))}l.incrementPendingTaskFailureCount=s,l.incrementPendingTasksTaskFailureCount=u,l.incrementNetworkRequestsTaskFailureCount=c,l.closeEpoch=d}),98);
__d("LSHandleTaskSendFailureForQueue2",["I64","LSSyncStoredProcedureUtils"],(function(t,n,r,o,a,i,l){"use strict";var e;async function s(t,n,r){await o("LSSyncStoredProcedureUtils").incrementPendingTasksTaskFailureCount(t,n,r),await o("LSSyncStoredProcedureUtils").incrementNetworkRequestsTaskFailureCount(t,n,(e||(e=o("I64"))).neg_one),await o("LSSyncStoredProcedureUtils").closeEpoch(t,n,e.neg_one)}l.default=s}),98);
__d("LSHandleTaskSendSuccessForQueue2",["I64"],(function(t,n,r,o,a,i,l){"use strict";var e;async function s(t,n){var r=await t.network_requests.get(n,(e||(e=o("I64"))).neg_one);r==null||r.epochId==null||await t.network_requests.delete(n,e.neg_one)}l.default=s}),98);
__d("LSHandleTaskSuccessOpsDownloadFailureForQueue",["I64","ReQL"],(function(t,n,r,o,a,i,l){"use strict";var e;async function s(t,n){var r=await t.network_requests.get(n,(e||(e=o("I64"))).neg_one);r!=null&&r.epochId!=null&&await t.network_requests.delete(n,(e||(e=o("I64"))).neg_one);var a=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.pending_tasks.index("queueNameTaskId")).getKeyRange(n));a!=null&&await t.pending_tasks.delete(a.taskId)}l.default=s}),98);
__d("LSPlatformTaskSyncGroupId",[],(function(t,n,r,o,a,i){"use strict";var e=-1,l=e;i.default=l}),66);
__d("LSBeginHandlingFireForgetTasksForQueue",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(o){return t.sequence([function(r){return n[0]=t.createArray(),t.forEach(t.filter(t.db.table(5).fetch(),function(t){return t.queueName===e[0]}),function(e){var r=e.item;return n[3]=new t.Map,n[3].set("label",r.context),n[3].set("payload",r.taskValue),n[3].set("queue_name",r.queueName),n[3].set("task_id",r.taskId),n[3].set("failure_count",t.i64.eq(t.i64.cast([0,0]),t.i64.cast([0,0]))?void 0:t.i64.cast([0,0])),n[4]=(n[0].push(n[3]),n[0])})},function(o){return n[1]=new t.Map,n[1].set("tasks",n[0]),n[1].set("epoch_id",void 0),n[2]=new t.Map,n[2].set("queue_name",e[0]),n[2].set("next_sync_ms",void 0),n[2].set("work_item_type",t.i64.cast([0,5])),n[2].set("network_payload",n[1]),n[2].set("http_url_override",void 0),n[2].set("skip_realtime_gateway",!1),r[0]=n[2]}])},function(e){return t.resolve(r)}])}e.__sproc_name__="LSCoreBeginHandlingFireForgetTasksForQueueStoredProcedure",e.__tables__=["pending_fire_and_forget_tasks"],a.exports=e}),null);
__d("LSBeginHandlingFireForgetTasksForQueueStoredProcedure",["LSBeginHandlingFireForgetTasksForQueue","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSBeginHandlingFireForgetTasksForQueue"),a.queueName);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSForceTaskExecutionImmediately",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(r){return t.db.table(2).fetch([[[e[0]]]]).next().then(function(r,o){var a=r.done,i=r.value;return a?0:(o=i.item,n[1]=t.i64.of_float(Date.now()),t.i64.lt(n[1],o.minTimeToSyncTimestampMs)?t.forEach(t.db.table(2).fetch([[[e[0]]]]),function(e){var n=e.update,r=e.item;return n({minTimeToSyncTimestampMs:t.i64.cast([0,0]),failureCount:t.i64.add(r.failureCount,t.i64.cast([0,1]))})}):t.resolve())})},function(e){return t.resolve(r)}])}e.__sproc_name__="LSCoreForceTaskExecutionImmediatelyStoredProcedure",e.__tables__=["pending_tasks"],a.exports=e}),null);
__d("LSRemoveUsedTokens",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(e){return t.forEach(t.filter(t.db.table(309).fetch(),function(e){return t.i64.le(e.redeemLimit,t.i64.cast([0,0]))}),function(e){return e.delete()})},function(e){return t.resolve(r)}])}e.__sproc_name__="LSAnonymousCredentialsRemoveUsedTokensStoredProcedure",e.__tables__=["secure_acs_tokens"],a.exports=e}),null);
__d("LSGetCurrentTokenPoolState",["LSArrayGetObjectAt","LSRemoveBlindedTokens","LSRemoveUsedTokens"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(n){return r[0]=t.i64.of_float(Date.now()),r[1]=t.createArray(),t.count(t.filter(t.db.table(307).fetch(),function(t){return t.projectName===e[0]})).then(function(e){return r[2]=e})},function(n){return t.forEach(t.filter(t.db.table(307).fetch(),function(t){return t.projectName===e[0]}),function(e){var n=e.item;return r[7]=n.configId,t.i64.gt(r[0],n.expirationTimestampMs)?t.forEach(t.db.table(307).fetch([[[r[7]]]]),function(e){return e.delete()}):t.resolve(r[8]=(r[1].push(r[7]),r[1]))})},function(e){return t.storedProcedure(n("LSRemoveUsedTokens"))},function(e){return r[3]=t.i64.cast([0,0]),r[4]=t.i64.of_int32(r[1].length),t.i64.gt(r[4],t.i64.cast([0,0]))?t.loopAsync(r[4],function(e){return r[7]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[1],r[7]).then(function(e){var t;return t=e,r[8]=t[0],r[9]=t[1],t})},function(e){return t.count(t.filter(t.db.table(309).fetch(),function(e){return e.configId===r[8]})).then(function(e){return r[10]=e})},function(e){return r[3]=t.i64.add(r[10],r[3]),t.storedProcedure(n("LSRemoveBlindedTokens"),r[8])}])}):t.resolve()},function(e){var n;return t.i64.gt(r[2],t.i64.cast([0,0]))?(r[7]=t.i64.of_int32(r[1].length),r[5]=t.i64.ge(r[7],t.i64.cast([0,1]))):r[5]=void 0,r[5]!==void 0?(r[5]?(t.i64.gt(r[3],t.i64.cast([0,0]))?r[8]=t.i64.cast([0,3]):r[8]=t.i64.cast([0,2]),r[7]=r[8]):r[7]=t.i64.cast([0,1]),r[6]=r[7]):r[6]=t.i64.cast([0,0]),n=[r[6],r[3]],o[0]=n[0],o[1]=n[1]}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSAnonymousCredentialsGetCurrentTokenPoolStateStoredProcedure",e.__tables__=["secure_acs_configurations","secure_acs_tokens"],a.exports=e}),null);
__d("LSVoprfBlind.nop",["XPlatReactVoprf"],(function(t,n,r,o,a,i,l){"use strict";var e=async function(t,n,r){var e=await o("XPlatReactVoprf").loadXPlatReactVoprf(),a=e.voprfInstance,i=a.voprfInfo,l=a.voprfWasm;try{var s=l.blind(i,new Uint8Array(r));return[s.blindedElement.buffer,s.blindingFactor.buffer]}catch(e){throw e}finally{o("XPlatReactVoprf").freeVoprfInstance(a)}};e.__nop_name__="LSVoprfBlind",l.default=e}),98);
__d("LSVoprfCreateNonce.nop",["LSSynchronousPromise","XPlatReactCrypto"],(function(t,n,r,o,a,i,l){"use strict";var e=32,s=function(n,r){var t=e,a=new Uint8Array(t);return o("XPlatReactCrypto").getRandomValues(a),o("LSSynchronousPromise").makeSynchronousPromise([a.buffer])};s.__nop_name__="LSVoprfCreateNonce",l.default=s}),98);
__d("LSTaskSerializerAcsIssueNextSync",["LSBase64Encode.nop","LSGetCurrentTokenPoolState","LSIssueNextSync","LSVoprfBlind.nop","LSVoprfCreateNonce.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return t.db.table(310).fetch([[[e[0]]]]).next().then(function(e,o){var a,i=e.done,l=e.value;return i?((function(e){t.logger(e).mustfix(e)})("Request context for the passed task_id was not found"),a=[void 0,void 0,void 0],r[0]=a[0],r[1]=a[1],r[2]=a[2]):(o=l.item,t.sequence([function(e){return r[9]=o.projectName,r[10]=o.maxClientTokenPoolSize,t.storedProcedure(n("LSGetCurrentTokenPoolState"),r[9]).then(function(e){var t;return t=e,r[4]=t[0],r[5]=t[1],t})},function(e){var o;return t.i64.eq(r[4],t.i64.cast([0,0]))||t.i64.eq(r[4],t.i64.cast([0,1]))?t.resolve((r[11]=new t.Map,r[11].set("project_name",r[9]),r[12]=t.toJSON(r[11]),o=[r[12],t.i64.cast([0,351]),void 0],r[6]=o[0],r[7]=o[1],r[8]=o[2])):t.sequence([function(e){return r[11]=t.i64.of_float(Date.now()),t.islc(t.sortBy(t.filter(t.db.table(307).fetch(),function(e){return e.projectName===r[9]&&t.i64.gt(e.expirationTimestampMs,r[11])}),[["expirationTimestampMs","DESC"]]),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,o){var a,i=e.done,l=e.value;return i?((function(e){t.logger(e).mustfix(e)})("A config for the passed project name was not found"),r[16]=new t.Map,r[16].set("project_name",r[9]),r[16].set("max_client_token_pool_size",r[10]),r[17]=t.toJSON(r[16]),a=[r[17],t.i64.cast([0,362]),void 0],r[12]=a[0],r[13]=a[1],r[14]=a[2]):(o=l.item,t.sequence([function(e){return r[24]=o.configId,r[16]=o.maxEvals,r[26]=o.tokenPollFrequencyMs,r[25]=o.maxClientTokenPoolSize,r[17]=t.i64.sub(r[10],r[5]),r[23]=t.i64.lt(r[16],r[17])?r[16]:r[17],r[18]=t.createArray(),t.i64.gt(r[23],t.i64.cast([0,0]))?t.loopAsync(r[23],function(e){return r[27]=e,t.sequence([function(e){return t.nativeOperation(n("LSVoprfCreateNonce.nop")).then(function(e){var t;return t=e,r[28]=t[0],t})},function(e){return t.blobs.neq(r[28],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSVoprfBlind.nop"),r[28]).then(function(e){var t;return t=e,r[29]=t[0],r[30]=t[1],t})},function(e){return t.blobs.neq(r[29],void 0)&&t.blobs.neq(r[30],void 0)?t.sequence([function(e){return r[31]=t.i64.cast([-1,4294967295]),t.db.table(308).peekNextAutoIncrementId().then(function(e){return r[31]=e})},function(e){return t.db.table(308).add({tokenId:void 0,blindedNonce:r[29],blindingFactor:r[30],nonce:r[28],configId:r[24]})},function(e){return t.db.table(308).fetch([[[r[31]]]]).next().then(function(e,n){var o=e.done,a=e.value;return o?r[32]=t.i64.cast([-1,4294967295]):(n=a.item,r[32]=n.tokenId)})},function(e){return t.i64.eq(r[32],t.i64.cast([-1,4294967295]))?t.sequence([function(e){return t.islc(t.db.table(308).fetchDesc([[[{gt:t.i64.cast([0,0])}]]]),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,n){var o=e.done,a=e.value;return o?r[37]=t.i64.cast([-1,4294967295]):(n=a.item,r[37]=n.tokenId)})},function(e){return r[34]=r[37]}]):t.resolve(r[34]=r[32])},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[29]).then(function(e){var t;return t=e,r[35]=t[0],t})},function(e){return r[36]=new t.Map,r[36].set("id",r[34]),r[36].set("data",r[35]==null?"":r[35]),r[37]=(r[18].push(r[36]),r[18])}]):t.resolve()}]):t.resolve()}])}):t.resolve()},function(e){var o;return r[19]=t.i64.of_int32(r[18].length),t.i64.gt(r[19],t.i64.cast([0,0]))?t.resolve((r[27]=new t.Map,r[27].set("project_name",r[9]),r[27].set("config_id",r[24]),r[27].set("blinded_nonces",r[18]),r[28]=t.toJSON(r[27]),o=[r[28],t.i64.cast([0,354]),void 0],r[20]=o[0],r[21]=o[1],r[22]=o[2])):t.sequence([function(e){var o;return t.i64.neq(r[26],void 0)?t.sequence([function(e){var o;return t.i64.neq(r[25],void 0)?t.sequence([function(e){return(function(e){t.logger(e).info(e)})(["Already have the max number of tokens. Scheduling next ACS token sync locally for project: ",r[9]].join("")),t.storedProcedure(n("LSIssueNextSync"),r[25],r[9],r[26],!1)},function(e){var t;return t=[void 0,void 0,void 0],r[30]=t[0],r[31]=t[1],r[32]=t[2],t}]):t.resolve(((function(e){t.logger(e).info(e)})(["token_poll_frequency is nonnull but max_client_token_pool_size is null. Already have the max number of tokens. Scheduling the next ACS token sync for project: ",r[9]].join("")),r[33]=new t.Map,r[33].set("project_name",r[9]),r[33].set("max_client_token_pool_size",r[10]),r[34]=t.toJSON(r[33]),o=[r[34],t.i64.cast([0,362]),void 0],r[30]=o[0],r[31]=o[1],r[32]=o[2]))},function(e){var t;return t=[r[30],r[31],r[32]],r[27]=t[0],r[28]=t[1],r[29]=t[2],t}]):t.resolve(((function(e){t.logger(e).info(e)})(["Already have the max number of tokens. Scheduling the next ACS token sync for project: ",r[9]].join("")),r[30]=new t.Map,r[30].set("project_name",r[9]),r[30].set("max_client_token_pool_size",r[10]),r[31]=t.toJSON(r[30]),o=[r[31],t.i64.cast([0,362]),void 0],r[27]=o[0],r[28]=o[1],r[29]=o[2]))},function(e){var t;return t=[r[27],r[28],r[29]],r[20]=t[0],r[21]=t[1],r[22]=t[2],t}])},function(e){var t;return t=[r[20],r[21],r[22]],r[12]=t[0],r[13]=t[1],r[14]=t[2],t}]))})},function(e){var t;return t=[r[12],r[13],r[14]],r[6]=t[0],r[7]=t[1],r[8]=t[2],t}])},function(e){var t;return t=[r[6],r[7],r[8]],r[0]=t[0],r[1]=t[1],r[2]=t[2],t}]))})},function(e){var t;return t=[r[0],r[1],r[2]],o[0]=t[0],o[1]=t[1],o[2]=t[2],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSAnonymousCredentialsTaskSerializerAcsIssueNextSyncStoredProcedure",e.__tables__=["acs_request_context","secure_acs_configurations","secure_acs_blinded_tokens"],a.exports=e}),null);
__d("LSTaskSerializerDeleteChatHistory",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(o){return t.sequence([function(r){return t.db.table(32).fetch([[[e[0]]]]).next().then(function(r,o){var a,i=r.done,l=r.value;return i?(n[4]=t.createArray(),n[5]=(n[4].push("taskSerializerDeleteChatHistory: Task ID not found"),n[4]),n[6]=(n[4].push(e[0]),n[4]),n[7]=t.toJSON(n[4]),(function(e){t.logger(e).mustfix(e)})(n[7]),a=[void 0,void 0,void 0],n[0]=a[0],n[1]=a[1],n[2]=a[2]):(o=l.item,t.sequence([function(e){return n[8]=o.threadKey,t.db.table(9).fetch([[[n[8]]]]).next().then(function(e,r){var o,a=e.done,i=e.value;return a?(n[9]=t.createArray(),n[10]=(n[9].push("taskSerializerDeleteChatHistory: Thread not found"),n[9]),n[11]=(n[9].push(n[8]),n[9]),n[12]=t.toJSON(n[9]),(function(e){t.logger(e).mustfix(e)})(n[12]),o=[void 0,void 0,void 0],n[4]=o[0],n[5]=o[1],n[6]=o[2]):(r=i.item,t.sequence([function(e){return t.db.table(9).fetch([[[n[8]]]]).next().then(function(e,r){var o=e.done,a=e.value;return o?n[9]=t.i64.cast([0,1]):(r=a.item,n[14]=r.syncGroup,t.i64.neq(n[14],void 0)?n[13]=n[14]:n[13]=t.i64.cast([0,1]),n[9]=n[13])})},function(e){var r;return n[11]=new t.Map,n[11].set("thread_key",n[8]),n[11].set("sync_group",n[9]),n[12]=t.toJSON(n[11]),r=[n[12],t.i64.cast([0,903]),void 0],n[4]=r[0],n[5]=r[1],n[6]=r[2]}]))})},function(e){var t;return t=[n[4],n[5],n[6]],n[0]=t[0],n[1]=t[1],n[2]=t[2],t}]))})},function(e){var t;return t=[n[0],n[1],n[2]],r[0]=t[0],r[1]=t[1],r[2]=t[2],t}])},function(e){return t.resolve(r)}])}e.__sproc_name__="LSMailboxTaskSerializerDeleteChatHistoryStoredProcedure",e.__tables__=["threads_optimistic_context","threads"],a.exports=e}),null);
__d("LSTaskSerializerE2eeMessageIntegrityCheckV2",[],(function(t,n,r,o,a,i){function e(){var e,t=arguments,n=t[t.length-1],r=[],o=[];return e=[void 0,n.i64.cast([0,705]),void 0],o[0]=e[0],o[1]=e[1],o[2]=e[2],n.resolve(o)}e.__sproc_name__="LSEncryptedBackupsTaskSerializerE2eeMessageIntegrityCheckV2StoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSTaskSerializerE2eeMetadataThreadIntegrityCheck",[],(function(t,n,r,o,a,i){function e(){var e,t=arguments,n=t[t.length-1],r=[],o=[];return e=[void 0,n.i64.cast([0,700]),void 0],o[0]=e[0],o[1]=e[1],o[2]=e[2],n.resolve(o)}e.__sproc_name__="LSE2EEMessagingMetadataMailboxTaskSerializerE2eeMetadataThreadIntegrityCheckStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSTaskSerializerEncryptedBackupAction",[],(function(t,n,r,o,a,i){function e(){var e,t=arguments,n=t[t.length-1],r=[],o=[];return e=[void 0,n.i64.cast([0,319]),void 0],o[0]=e[0],o[1]=e[1],o[2]=e[2],n.resolve(o)}e.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSTaskSerializerEncryptedBackupsLoopingUpload",["LSLogMebClientEvent.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(e){return t.sequence([function(e){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][taskSerializerEncryptedBackupsLoopingUpload] Beginning execution."),r[1]=t.i64.of_float(Date.now()),(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsLoopingUploadStoredProcedure] LSEncryptedBackupsLoopingUploadPayloadsTable table not found"),r[3]="LSEncryptedBackupsLoopingUploadPayloadsTable table not found",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsLoopingUploadStoredProcedure] ","",r[3]].join("")),r[2]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsTaskSerializerEncryptedBackupsLoopingUploadStoredProcedure",r[3],r[2],t.i64.cast([0,3]))},function(e){return r[4]=t.i64.of_float(Date.now()),r[5]=t.i64.random(),r[7]="Finishing execution. Execution time: ",r[8]=t.i64.to_string(t.i64.sub(r[4],r[0])),r[9]=" ms",r[6]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][taskSerializerEncryptedBackupsLoopingUpload] ",r[6],r[7],r[6],r[8],r[6],r[9]].join("")),t.i64.eq(t.i64.mod_(r[5],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[10]=",",r[11]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"taskSerializerEncryptedBackupsLoopingUpload",[r[7],r[10],r[8],r[10],r[9]].join(""),r[11],t.i64.cast([0,4]))):t.resolve()},function(e){var n;return n=['{"request_id":"unknown","upload_type":"FBN","payload":{"error_code":2,"operation":"","error_message":"","__typename":"MPSUploadFailurePayload"}}',t.i64.cast([0,50043]),void 0],o[0]=n[0],o[1]=n[1],o[2]=n[2],n}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsLoopingUploadStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSQueryLocalPersistenceStoreForBackup.nop",["ReQL"],(function(t,n,r,o,a,i,l){"use strict";var e=async function(t,n,r,a){var e=await o("ReQL").toArrayAsync(o("ReQL").fromTableDescending(t.local_message_persistence_store).filter(function(e){var t=e.offlineThreadingId,n=e.threadId;return n===r&&a===t}));if(e.length===0)return Promise.resolve([void 0,void 0,!1]);var i=e[0];return Promise.resolve([i.messagePayload,i.messageTimestampMs,!1])};e.__nop_name__="LSQueryLocalPersistenceStoreForBackup",l.default=e}),98);
__d("LSQueryLocalPersistenceStoreSupplementalForBackup.nop",["ReQL"],(function(t,n,r,o,a,i,l){"use strict";var e=async function(t,n,r,a,i){var e=await o("ReQL").firstAsync(o("ReQL").fromTableDescending(t.local_message_persistence_store_supplemental).filter(function(e){var t=e.supplementalKey,n=e.threadId,o=e.toplevelOfflineThreadingId;return n===r&&o===a&&t===i}));return e==null?Promise.resolve([void 0,void 0]):Promise.resolve([e.messagePayload,e.messageTimestampMs])};e.__nop_name__="LSQueryLocalPersistenceStoreSupplementalForBackup",l.default=e}),98);
__d("LSQueryLocalPersistenceStoreTagsForBackup.nop",["LSVec","ReQL"],(function(t,n,r,o,a,i,l){"use strict";var e=":",s=async function(n,a,i,l){var t=await o("ReQL").firstAsync(o("ReQL").fromTableDescending(n.local_message_persistence_store_tag_index.index("offlineThreadingId")).getKeyRange(l,i));if(t==null)return Promise.resolve([r("LSVec").ofArray([])]);var s=t.tag;return Promise.resolve([r("LSVec").ofArray(s.split(e))])};s.__nop_name__="LSQueryLocalPersistenceStoreTagsForBackup",l.default=s}),98);
__d("LSLoadUnencryptedProtobufWithInputs",["LSBase64Encode.nop","LSGetBlobFromString.nop","LSLogMebClientEvent.nop","LSQueryLocalPersistenceStoreForBackup.nop","LSQueryLocalPersistenceStoreSupplementalForBackup.nop","LSQueryLocalPersistenceStoreTagsForBackup.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][loadUnencryptedProtobufWithInputs] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.i64.eq(e[0],t.i64.cast([0,1]))?t.sequence([function(o){return t.nativeOperation(n("LSQueryLocalPersistenceStoreForBackup.nop"),e[1],e[2]).then(function(e){var t;return t=e,r[10]=t[0],r[11]=t[1],r[12]=t[2],t})},function(o){return t.nativeOperation(n("LSQueryLocalPersistenceStoreTagsForBackup.nop"),e[1],e[2]).then(function(e){var t;return t=e,r[13]=t[0],t})},function(o){var a,i,l;return t.blobs.neq(r[10],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[10]).then(function(e){var t;return t=e,r[16]=t[0],t})},function(n){var o,a,i;return r[16]!==void 0?(r[13]!==void 0?(r[21]=new t.Map,r[21].set("message_tags",r[13]),r[22]=t.toJSON(r[21]),r[19]=r[22]):r[19]=void 0,r[20]=new t.Map,r[20].set("backup_action",e[0]),r[20].set("protobuf_encrypted",r[16]),r[20].set("supplemental_data_encrypted",void 0),r[20].set("timestamp_ms",e[4]),r[20].set("message_tags",r[19]),o=[r[20],void 0],r[17]=o[0],r[18]=o[1]):((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error PROTOBUF_FORMATTING_FAILED"),r[19]=new t.Map,r[19].set("error_code",t.i64.cast([0,68])),r[19].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),r[19].set("error_message",""),a=[void 0,r[19]],r[17]=a[0],r[18]=a[1]),i=[r[17],r[18]],r[14]=i[0],r[15]=i[1]}]):t.resolve((r[12]?((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error PROTOBUF_ALREADY_DELETED"),r[18]=new t.Map,r[18].set("error_code",t.i64.cast([0,70])),r[18].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),r[18].set("error_message",""),a=[void 0,r[18]],r[16]=a[0],r[17]=a[1]):((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error PROTOBUF_NOT_FOUND_IN_TOPLEVEL_TABLE"),r[18]=new t.Map,r[18].set("error_code",t.i64.cast([0,63])),r[18].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),r[18].set("error_message",""),i=[void 0,r[18]],r[16]=i[0],r[17]=i[1]),l=[r[16],r[17]],r[14]=l[0],r[15]=l[1]))},function(e){var t;return t=[r[14],r[15]],r[2]=t[0],r[3]=t[1],t}]):t.sequence([function(o){var a,i,l;return t.i64.eq(e[0],t.i64.cast([0,2]))?t.sequence([function(o){var a;return e[3]!==void 0?t.sequence([function(o){return t.nativeOperation(n("LSQueryLocalPersistenceStoreSupplementalForBackup.nop"),e[1],e[2],e[3]).then(function(e){var t;return t=e,r[14]=t[0],r[15]=t[1],t})},function(o){return t.nativeOperation(n("LSQueryLocalPersistenceStoreTagsForBackup.nop"),e[1],e[2]).then(function(e){var t;return t=e,r[16]=t[0],t})},function(o){var a;return t.blobs.neq(r[14],void 0)?t.sequence([function(o){return t.nativeOperation(n("LSGetBlobFromString.nop"),e[3]).then(function(e){var t;return t=e,r[19]=t[0],t})},function(o){var a;return t.blobs.neq(r[19],void 0)?t.sequence([function(e){return r[22]=new t.Map,r[22].set("sk_ciphertext",r[19]),r[22].set("sk_hash",r[19]),t.nativeOperation(n("LSBase64Encode.nop"),r[14]).then(function(e){var t;return t=e,r[23]=t[0],t})},function(n){var o,a,i;return r[23]!==void 0?(r[16]!==void 0?(r[28]=new t.Map,r[28].set("message_tags",r[16]),r[29]=t.toJSON(r[28]),r[26]=r[29]):r[26]=void 0,r[27]=new t.Map,r[27].set("backup_action",e[0]),r[27].set("protobuf_encrypted",r[23]),r[27].set("supplemental_data_encrypted",r[22]),r[27].set("timestamp_ms",e[4]),r[27].set("message_tags",r[26]),o=[r[27],void 0],r[24]=o[0],r[25]=o[1]):((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error PROTOBUF_FORMATTING_FAILED"),r[26]=new t.Map,r[26].set("error_code",t.i64.cast([0,68])),r[26].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),r[26].set("error_message",""),a=[void 0,r[26]],r[24]=a[0],r[25]=a[1]),i=[r[24],r[25]],r[20]=i[0],r[21]=i[1]}]):t.resolve(((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error SUPPLEMENTAL_FORMATTING_FAILED"),r[22]=new t.Map,r[22].set("error_code",t.i64.cast([0,69])),r[22].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),r[22].set("error_message",""),a=[void 0,r[22]],r[20]=a[0],r[21]=a[1]))},function(e){var t;return t=[r[20],r[21]],r[17]=t[0],r[18]=t[1],t}]):t.resolve(((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error PROTOBUF_NOT_FOUND_IN_SUPPLEMENTAL_TABLE"),r[19]=new t.Map,r[19].set("error_code",t.i64.cast([0,64])),r[19].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),r[19].set("error_message",""),a=[void 0,r[19]],r[17]=a[0],r[18]=a[1]))},function(e){var t;return t=[r[17],r[18]],r[12]=t[0],r[13]=t[1],t}]):t.resolve(((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error SUPPLEMENTAL_KEY_NOT_SET_IN_CONTEXT_TABLE"),r[14]=new t.Map,r[14].set("error_code",t.i64.cast([0,65])),r[14].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),r[14].set("error_message",""),a=[void 0,r[14]],r[12]=a[0],r[13]=a[1]))},function(e){var t;return t=[r[12],r[13]],r[10]=t[0],r[11]=t[1],t}]):t.resolve((t.i64.eq(e[0],t.i64.cast([0,3]))?(r[14]=new t.Map,r[14].set("backup_action",e[0]),r[14].set("protobuf_encrypted",void 0),r[14].set("supplemental_data_encrypted",void 0),r[14].set("timestamp_ms",e[4]),r[14].set("message_tags",void 0),a=[r[14],void 0],r[12]=a[0],r[13]=a[1]):((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error INVALID_BACKUP_OPERATION"),r[14]=new t.Map,r[14].set("error_code",t.i64.cast([-1,4294967289])),r[14].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),r[14].set("error_message",""),i=[void 0,r[14]],r[12]=i[0],r[13]=i[1]),l=[r[12],r[13]],r[10]=l[0],r[11]=l[1]))},function(e){var t;return t=[r[10],r[11]],r[2]=t[0],r[3]=t[1],t}])},function(e){return r[4]=t.i64.of_float(Date.now()),r[5]=t.i64.random(),r[7]="Finishing execution. Execution time: ",r[8]=t.i64.to_string(t.i64.sub(r[4],r[0])),r[9]=" ms",r[6]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][loadUnencryptedProtobufWithInputs] ",r[6],r[7],r[6],r[8],r[6],r[9]].join("")),t.i64.eq(t.i64.mod_(r[5],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[10]=",",r[11]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"loadUnencryptedProtobufWithInputs",[r[7],r[10],r[8],r[10],r[9]].join(""),r[11],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[r[2],r[3]],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSLoadUnencryptedProtobufBackupSerializedPayloadData",["LSLoadUnencryptedProtobufWithInputs","LSLogMebClientEvent.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(n){var o;return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][loadUnencryptedProtobufBackupSerializedPayloadData] Beginning execution."),r[1]=t.i64.of_float(Date.now()),r[18]=t.i64.mul(r[1],t.i64.cast([0,1e6])),t.sequence([function(n){return t.db.table(2).fetch([[[e[0]]]]).next().then(function(n,o){var a,i,l=n.done,s=n.value;return l?(r[30]=t.i64.of_float(Date.now()),a=[e[0],void 0,void 0,void 0,void 0,t.i64.sub(t.i64.mul(r[30],t.i64.cast([0,1e6])),r[18]),void 0],r[22]=a[0],r[23]=a[1],r[24]=a[2],r[25]=a[3],r[26]=a[4],r[27]=a[5],r[28]=a[6]):(o=s.item,r[30]=t.i64.of_float(Date.now()),i=[e[0],o.queueName,o.enqueueTimestampMs,o.priority,o.firstExecutedTimestampMs,t.i64.sub(t.i64.mul(r[30],t.i64.cast([0,1e6])),r[18]),void 0],r[22]=i[0],r[23]=i[1],r[24]=i[2],r[25]=i[3],r[26]=i[4],r[27]=i[5],r[28]=i[6])})},function(e){var t;return t=[r[22],r[23],r[24],r[25],r[26],r[27],r[28]],r[2]=t[0],r[3]=t[1],r[4]=t[2],r[5]=t[3],r[6]=t[4],r[7]=t[5],r[8]=t[6],t}])},function(o){return r[9]=new t.Map,r[9].set("task_id",r[2]),r[9].set("queue_name",r[3]),r[9].set("enqueue_timestamp_ms",r[4]),r[9].set("priority",r[5]),r[9].set("first_executed_timestamp_ms",r[6]),r[9].set("execution_time_ns",r[7]),r[9].set("echo_encoding_execution_time_ns",r[8]),r[10]=new t.Map,r[10].set("task_metadata",r[9]),r[10].set("action_type",void 0),r[10].set("content_type",void 0),r[10].set("identifiers",void 0),r[10].set("identifiers_v2",void 0),r[10].set("task_creation_source",void 0),r[10].set("message_payload_source",t.i64.cast([0,2])),t.filter(t.db.table(305).fetch(),function(n){return t.i64.eq(n.pendingBackupTaskId,e[0])}).next().then(function(o,a){var i,l=o.done,s=o.value;return l?(r[22]=new t.Map,r[22].set("error_code",t.i64.cast([0,5])),r[22].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufBackupSerializedPayloadDataStoredProcedure"),r[22].set("error_message",""),i=[void 0,r[22],r[10]],r[11]=i[0],r[12]=i[1],r[13]=i[2]):(a=s.item,t.sequence([function(n){var o;return r[39]=a.actThreadId,r[40]=a.toplevelOfflineThreadingId,r[23]=a.messageTimestampMs,r[22]=new t.Map,r[22].set("backup_id","openEbUploadGenericBackupId"),r[22].set("act_thread_id",r[39]),r[22].set("server_thread_id",r[39]),r[22].set("timestamp",t.i64.to_string(r[23])),r[22].set("otid",r[40]),r[24]=new t.Map,r[24].set("backup_id","openEbUploadGenericBackupId"),r[24].set("act_thread_id",r[39]),r[24].set("timestamp",t.i64.to_string(r[23])),r[24].set("otid",r[40]),t.sequence([function(n){return t.db.table(2).fetch([[[e[0]]]]).next().then(function(n,o){var a,i,l=n.done,s=n.value;return l?(r[49]=t.i64.of_float(Date.now()),a=[e[0],void 0,void 0,void 0,void 0,t.i64.sub(t.i64.mul(r[49],t.i64.cast([0,1e6])),r[18]),void 0],r[41]=a[0],r[42]=a[1],r[43]=a[2],r[44]=a[3],r[45]=a[4],r[46]=a[5],r[47]=a[6]):(o=s.item,r[49]=t.i64.of_float(Date.now()),i=[e[0],o.queueName,o.enqueueTimestampMs,o.priority,o.firstExecutedTimestampMs,t.i64.sub(t.i64.mul(r[49],t.i64.cast([0,1e6])),r[18]),void 0],r[41]=i[0],r[42]=i[1],r[43]=i[2],r[44]=i[3],r[45]=i[4],r[46]=i[5],r[47]=i[6])})},function(e){var t;return t=[r[41],r[42],r[43],r[44],r[45],r[46],r[47]],r[25]=t[0],r[26]=t[1],r[27]=t[2],r[28]=t[3],r[29]=t[4],r[30]=t[5],r[31]=t[6],t}])},function(e){return r[32]=new t.Map,r[32].set("task_id",r[25]),r[32].set("queue_name",r[26]),r[32].set("enqueue_timestamp_ms",r[27]),r[32].set("priority",r[28]),r[32].set("first_executed_timestamp_ms",r[29]),r[32].set("execution_time_ns",r[30]),r[32].set("echo_encoding_execution_time_ns",r[31]),r[33]=new t.Map,r[33].set("task_metadata",r[32]),r[33].set("action_type",void 0),r[33].set("content_type",void 0),r[33].set("identifiers",void 0),r[33].set("identifiers_v2",r[24]),r[33].set("task_creation_source",void 0),r[33].set("message_payload_source",t.i64.cast([0,2])),t.storedProcedure(n("LSLoadUnencryptedProtobufWithInputs"),a.backupAction,r[39],r[40],a.supplementalKey,r[23],r[22]).then(function(e){var t;return t=e,r[34]=t[0],r[35]=t[1],t})},function(e){var n,o,i;return r[34]!==void 0?(r[41]=new t.Map,r[41].set("unencrypted_protobuf_backup_payload",r[34]),r[41].set("message_identifiers",r[22]),r[41].set("attachment_backup_payload",a.attachmentPayload),r[41].set("sender_id",a.senderId),r[41].set("extra_data_for_eb_upload",void 0),n=[r[41],void 0,r[33]],r[36]=n[0],r[37]=n[1],r[38]=n[2]):(o=[void 0,r[35],r[33]],r[36]=o[0],r[37]=o[1],r[38]=o[2]),i=[r[36],r[37],r[38]],r[11]=i[0],r[12]=i[1],r[13]=i[2]}]))})},function(e){return r[15]=t.i64.of_float(Date.now()),r[16]=t.i64.random(),r[19]="Finishing execution. Execution time: ",r[20]=t.i64.to_string(t.i64.sub(r[15],r[0])),r[21]=" ms",r[17]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][loadUnencryptedProtobufBackupSerializedPayloadData] ",r[17],r[19],r[17],r[20],r[17],r[21]].join("")),t.i64.eq(t.i64.mod_(r[16],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[22]=",",r[23]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"loadUnencryptedProtobufBackupSerializedPayloadData",[r[19],r[22],r[20],r[22],r[21]].join(""),r[23],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[r[11],r[12],r[13]],o[0]=t[0],o[1]=t[1],o[2]=t[2],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsLoadUnencryptedProtobufBackupSerializedPayloadDataStoredProcedure",e.__tables__=["pending_tasks","pending_protobuf_backups_context"],a.exports=e}),null);
__d("LSTaskSerializerEncryptedBackupsOpenUpload",["LSArrayGetObjectAt","LSBase64Encode.nop","LSDeserializeFromJsonIntoDictionaryV2.nop","LSLoadUnencryptedProtobufBackupSerializedPayloadData","LSLogMebClientEvent.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][taskSerializerEncryptedBackupsOpenUpload] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.storedProcedure(n("LSLoadUnencryptedProtobufBackupSerializedPayloadData"),e[0]).then(function(e){var t;return t=e,r[2]=t[0],r[3]=t[1],r[4]=t[2],t})},function(e){var o,a,i;return r[2]!==void 0?t.sequence([function(e){return r[15]=r[2].get("message_identifiers"),r[16]=r[2].get("unencrypted_protobuf_backup_payload"),r[17]=r[15].get("server_thread_id"),r[18]=r[15].get("timestamp"),r[19]=r[15].get("otid"),r[20]=r[15].get("act_thread_id"),r[21]=new t.Map,r[21].set("server_thread_key",r[17]),r[21].set("timestamp",r[18]),r[21].set("otid",r[19]),r[21].set("wa_thread_id",t.i64.from_string(r[20])),r[22]=new t.Map,r[22].set("message_identifiers",r[21]),r[23]=r[2].get("extra_data_for_eb_upload"),r[23]!==void 0?t.sequence([function(e){return t.nativeOperation(n("LSDeserializeFromJsonIntoDictionaryV2.nop"),r[23]).then(function(e){var t;return t=e,r[32]=t[0],t})},function(e){return r[33]=new t.Map,r[34]=r[32].keys(),r[35]=t.i64.of_int32(r[34].length),t.i64.gt(r[35],t.i64.cast([0,0]))?t.loopAsync(r[35],function(e){return r[36]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[34],r[36]).then(function(e){var t;return t=e,r[37]=t[0],r[38]=t[1],t})},function(e){return r[39]=r[32].get(r[37]),r[33].set(r[37],r[39])}])}):t.resolve()},function(e){return r[24]=r[33]}]):t.resolve(r[24]=void 0)},function(e){return r[24]!==void 0?t.sequence([function(e){return r[32]=r[24].get("mt"),r[32]?r[33]=!1:r[33]=!0,r[33]?t.resolve(r[34]=void 0):t.sequence([function(e){return r[36]=new t.Map,r[37]=r[32].keys(),r[38]=t.i64.of_int32(r[37].length),t.i64.gt(r[38],t.i64.cast([0,0]))?t.loopAsync(r[38],function(e){return r[39]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[37],r[39]).then(function(e){var t;return t=e,r[40]=t[0],r[41]=t[1],t})},function(e){return r[42]=r[32].get(r[40]),r[36].set(r[40],r[42])}])}):t.resolve()},function(e){return r[34]=r[36]}])},function(e){return r[34]!==void 0?(r[36]=t.toJSON(r[34]),r[35]=r[36]):r[35]=void 0,r[25]=r[35]}]):t.resolve(r[25]=void 0)},function(e){return r[26]=r[16].get("supplemental_data_encrypted"),r[26]!==void 0?t.sequence([function(e){return r[32]=r[16].get("protobuf_encrypted"),r[33]=r[16].get("backup_action"),r[34]=r[16].get("timestamp_ms"),r[35]=r[26].get("sk_ciphertext"),t.nativeOperation(n("LSBase64Encode.nop"),r[35]).then(function(e){var t;return t=e,r[36]=t[0],t})},function(e){return r[37]=r[26].get("sk_hash"),t.nativeOperation(n("LSBase64Encode.nop"),r[37]).then(function(e){var t;return t=e,r[38]=t[0],t})},function(e){return r[39]=new t.Map,r[39].set("supplementary_data_key",void 0),r[39].set("encrypted_protobuf",r[32]),r[39].set("key_value_backup_action",r[33]),r[39].set("protobuf_ts_ms",r[34]),r[39].set("supplemental_key_ciphertext",r[36]),r[39].set("supplemental_key_hash",r[38]),r[39].set("message_tags",r[25]),r[27]=r[39]}]):t.resolve((r[32]=r[16].get("protobuf_encrypted"),r[33]=r[16].get("backup_action"),r[34]=r[16].get("timestamp_ms"),r[35]=new t.Map,r[35].set("supplementary_data_key",void 0),r[35].set("encrypted_protobuf",r[32]),r[35].set("key_value_backup_action",r[33]),r[35].set("protobuf_ts_ms",r[34]),r[35].set("message_tags",r[25]),r[27]=r[35]))},function(e){return r[22].set("key_value_backup_unencrypted_payload",r[27]),r[28]=r[2].get("sender_id"),r[22].set("sender_id",r[28]),r[29]=r[2].get("attachment_backup_payload"),r[29]!==void 0&&r[22].set("attachment_backup_payload",r[29]),r[24]!==void 0?t.sequence([function(e){return r[32]=r[24].get("ttd"),r[32]?r[33]=!1:r[33]=!0,r[33]?t.resolve(r[34]=void 0):t.sequence([function(e){return r[36]=new t.Map,r[37]=r[32].keys(),r[38]=t.i64.of_int32(r[37].length),t.i64.gt(r[38],t.i64.cast([0,0]))?t.loopAsync(r[38],function(e){return r[39]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[37],r[39]).then(function(e){var t;return t=e,r[40]=t[0],r[41]=t[1],t})},function(e){return r[42]=r[32].get(r[40]),r[36].set(r[40],r[42])}])}):t.resolve()},function(e){return r[34]=r[36]}])},function(e){return r[34]!==void 0?(r[36]=t.toJSON(r[34]),r[35]=r[36]):r[35]=void 0,r[30]=r[35]}]):t.resolve(r[30]=void 0)},function(e){var n;return r[30]!==void 0&&r[22].set("tags_to_delete",r[30]),r[31]=t.toJSON(r[22]),n=[r[31],void 0,r[4]],r[5]=n[0],r[6]=n[1],r[7]=n[2]}]):t.resolve((r[3]?r[15]=!1:r[15]=!0,r[15]?(a=[void 0,void 0,r[4]],r[16]=a[0],r[17]=a[1],r[18]=a[2]):(o=[void 0,r[3],r[4]],r[16]=o[0],r[17]=o[1],r[18]=o[2]),i=[r[16],r[17],r[18]],r[5]=i[0],r[6]=i[1],r[7]=i[2]))},function(e){return r[15]=new t.Map,r[16]=r[15].set("success",r[5]),r[17]=r[15].set("failure",r[6]),r[18]=r[15].set("context",r[7]),r[19]=t.toJSON(r[15]),r[8]=r[19],r[9]=t.i64.of_float(Date.now()),r[10]=t.i64.random(),r[12]="Finishing execution. Execution time: ",r[13]=t.i64.to_string(t.i64.sub(r[9],r[0])),r[14]=" ms",r[11]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][taskSerializerEncryptedBackupsOpenUpload] ",r[11],r[12],r[11],r[13],r[11],r[14]].join("")),t.i64.eq(t.i64.mod_(r[10],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[15]=",",r[16]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"taskSerializerEncryptedBackupsOpenUpload",[r[12],r[15],r[13],r[15],r[14]].join(""),r[16],t.i64.cast([0,4]))):t.resolve()},function(e){var n;return n=[r[8],t.i64.cast([0,50048])],o[0]=n[0],o[1]=n[1],n}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsOpenUploadStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSTaskSerializerEncryptedBackupsRestoreWithSerializer",[],(function(t,n,r,o,a,i){function e(){var e,t=arguments,n=t[t.length-1],r=[],o=[];return e=[void 0,void 0,void 0],o[0]=e[0],o[1]=e[1],o[2]=e[2],n.resolve(o)}e.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSDeriveValueSecretRefV2",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSGetBlobFromString.nop","LSLogMebClientEvent.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][deriveValueSecretRefV2] Beginning execution."),r[1]=t.i64.of_float(Date.now()),r[2]=e[2].get("message_payload_encryption_keys"),r[3]=r[2].get("encryption_version"),r[4]=r[2].get("epoch_anon_id"),r[5]=r[2].get("epoch_root_key"),r[6]=r[2].get("payload_key"),r[7]=t.createArray(),r[41]=(r[7].push(t.i64.cast([0,6])),r[7]),t.nativeOperation(n("LSGetBlobFromString.nop"),"epoch_anon_id_debug").then(function(e){var t;return t=e,r[8]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),r[8],void 0,r[4],r[7]).then(function(e){var t;return t=e,r[9]=t[0],t})},function(e){return r[9]?r[10]=!1:r[10]=!0,r[10]?t.resolve(r[11]=""):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[9],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[41]=t[0],r[42]=t[1],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[41]).then(function(e){var t;return t=e,r[43]=t[0],t})},function(e){return r[11]=r[43]==null?"":r[43]}])},function(e){return r[12]=t.createArray(),r[41]=(r[12].push(t.i64.cast([0,6])),r[12]),t.nativeOperation(n("LSGetBlobFromString.nop"),"epoch_root_key_debug").then(function(e){var t;return t=e,r[13]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),r[13],void 0,r[5],r[12]).then(function(e){var t;return t=e,r[14]=t[0],t})},function(e){return r[14]?r[15]=!1:r[15]=!0,r[15]?t.resolve(r[16]=""):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[14],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[41]=t[0],r[42]=t[1],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[41]).then(function(e){var t;return t=e,r[43]=t[0],t})},function(e){return r[16]=r[43]==null?"":r[43]}])},function(e){return r[17]=t.createArray(),r[41]=(r[17].push(t.i64.cast([0,6])),r[17]),t.nativeOperation(n("LSGetBlobFromString.nop"),"message_key_debug").then(function(e){var t;return t=e,r[18]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),r[18],void 0,r[6],r[17]).then(function(e){var t;return t=e,r[19]=t[0],t})},function(e){return r[19]?r[20]=!1:r[20]=!0,r[20]?t.resolve(r[21]=""):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[19],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[41]=t[0],r[42]=t[1],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[41]).then(function(e){var t;return t=e,r[43]=t[0],t})},function(e){return r[21]=r[43]==null?"":r[43]}])},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[5]).then(function(e){var t;return t=e,r[22]=t[0],t})},function(o){return t.nativeOperation(n("LSGetBlobFromString.nop"),[r[22]==null?"":r[22],e[0]].join("")).then(function(e){var t;return t=e,r[23]=t[0],t})},function(e){return r[24]=t.createArray(),r[41]=(r[24].push(t.i64.cast([0,6])),r[24]),t.nativeOperation(n("LSGetBlobFromString.nop"),"epoch_root_key_thread_id_debug").then(function(e){var t;return t=e,r[25]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),r[25],void 0,r[23],r[24]).then(function(e){var t;return t=e,r[26]=t[0],t})},function(e){return r[26]?r[27]=!1:r[27]=!0,r[27]?t.resolve(r[28]=""):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[26],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[41]=t[0],r[42]=t[1],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[41]).then(function(e){var t;return t=e,r[43]=t[0],t})},function(e){return r[28]=r[43]==null?"":r[43]}])},function(e){return r[29]=":",t.blobs.neq(r[5],void 0)?t.sequence([function(e){return r[41]=t.createArray(),r[47]=(r[41].push(t.i64.cast([0,18])),r[41]),t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,r[5],r[41]).then(function(e){var t;return t=e,r[42]=t[0],t})},function(e){return r[42]!==void 0?t.sequence([function(e){return r[47]=t.i64.of_int32(r[42].length),t.i64.ge(r[47],t.i64.cast([0,1]))?t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[42],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[49]=t[0],r[50]=t[1],t})},function(e){return r[48]=r[49]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),r[50]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBFingerprint] ","",r[50]].join("")),r[49]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBFingerprint",r[50],r[49],t.i64.cast([0,3]))},function(e){return r[48]=void 0}])},function(e){return r[43]=r[48]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),r[48]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBFingerprint] ","",r[48]].join("")),r[47]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBFingerprint",r[48],r[47],t.i64.cast([0,3]))},function(e){return r[43]=void 0}])},function(e){return t.blobs.neq(r[43],void 0)?r[44]=!0:r[44]=!1,r[44]||((function(e){t.logger(e).mustfix(e)})("LS::assert is failed. Attempting to coerce a null value to nonnull."),t.throw("LS::assert is failed. Attempting to coerce a null value to nonnull.")),t.nativeOperation(n("LSBase64Encode.nop"),r[43]).then(function(e){var t;return t=e,r[45]=t[0],t})},function(e){return r[45]!==void 0?r[46]=r[45]:r[46]="encodingfailed",r[30]=r[46]}]):t.resolve(r[30]="null")},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[4]).then(function(e){var t;return t=e,r[31]=t[0],t})},function(o){return r[32]=new t.Map,r[32].set("encryption_version",r[3]),r[32].set("epoch_anon_id",r[31]==null?"":r[31]),r[32].set("message_encryption_values",[r[11],r[29],r[16],r[29],r[21],r[29],r[28]].join("")),r[32].set("root_key_fingerprint",r[30]),r[32].set("backup_id",e[1]),r[33]=t.toJSON(r[32]),r[34]=new t.Map,r[34].set("value_secret_ref",r[33]),r[35]=t.i64.of_float(Date.now()),r[36]=t.i64.random(),r[38]="Finishing execution. Execution time: ",r[39]=t.i64.to_string(t.i64.sub(r[35],r[0])),r[40]=" ms",r[37]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][deriveValueSecretRefV2] ",r[37],r[38],r[37],r[39],r[37],r[40]].join("")),t.i64.eq(t.i64.mod_(r[36],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[41]=",",r[42]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"deriveValueSecretRefV2",[r[38],r[41],r[39],r[41],r[40]].join(""),r[42],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[r[34],void 0],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsDeriveValueSecretRefV2StoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("GetBlobFromInt64BE",["I64","LSResult","Promise"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t){var a=new Uint8Array(8);return a.reduceRight(function(e,t,n){var r=(s||(s=o("I64"))).to_int32(s.mod_(e,s.of_string("256")));return a[n]=r,s.div(e,s.of_string("256"))},t),(e||(e=n("Promise"))).resolve(r("LSResult")(a.buffer))}l.GetBlobFromInt64BE=u}),98);
__d("LSGetBlobFromInt64BE.nop",["GetBlobFromInt64BE"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t,n,r){return o("GetBlobFromInt64BE").GetBlobFromInt64BE(r)};e.__nop_name__="LSGetBlobFromInt64BE",l.default=e}),98);
__d("OcmfClientMap",["CryptoLogger","LSCryptoUtils","Promise","requireDeferred","tweetnacl"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("requireDeferred")("ristretto255").__setRef("OcmfClientMap"),u=function(r,a){var t=o("tweetnacl").hash(o("LSCryptoUtils").bufToUint8(a));return(e||(e=n("Promise"))).all([t,s.load()]).then(function(e){var t=e[0],n=e[1],o=n.fromHash(new Uint8Array(t)),a=n.scalarMult(new Uint8Array(r),o);return a.buffer}).catch(function(e){throw o("CryptoLogger").captureError(o("CryptoLogger").CryptoLogger("ocmf_client_map"),e).mustfix("Failed OcmfClientMap."),e})};l.default=u}),98);
__d("LSOcmfClientMap.nop",["LSResult","OcmfClientMap"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t,n,o,a){return r("OcmfClientMap")(o,a).then(function(e){return r("LSResult")(e)})};e.__nop_name__="LSOcmfClientMap",l.default=e}),98);
__d("OrderPreservingEncryption",["FBLogger","LSCryptoUtils","Promise","UInt8Array","XPlatReactCrypto"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){return o("XPlatReactCrypto").getRandomValues(new Uint8Array(32)).buffer}function u(e){var t=e.length;return t%2!==0?"0"+e:e}function c(e){for(var t=BigInt(e),n=u(t.toString(16)),r=n.length,o=r/2,a=[],i=0;i<o;++i)a.push(i*2);return new Uint8Array(a.map(function(e){var t=e+2;return n.slice(e,t)}).map(function(e){return parseInt(e,16)}))}function d(e){var t=e.map(function(e){return e._0});return{_0:o("UInt8Array").concatBytes(t)}}function m(e){return"OPE key has length "+String(e)+", expected  "+String(32)}function p(e,t,n){var r=new ArrayBuffer(0);return o("XPlatReactCrypto").subtleImportKey("raw",e.buffer,"HKDF",!1,["deriveKey","deriveBits"]).then(function(e){return o("XPlatReactCrypto").subtleDeriveBits({hash:"SHA-256",info:t.buffer,name:"HKDF",salt:r},e,n*8)}).then(function(e){return{_0:new Uint8Array(e)}})}function _(e,t){return{_0:o("LSCryptoUtils").modAddBytes(e._0,t)}}function f(t,a,i,l){var s=i.byteLength;if(s!==32)throw r("FBLogger")("wmi_eb").mustfixThrow(m(s));var u=l.byteLength,c=function(t,n){var e=new Uint8Array(1+u),r=new Uint8Array(u-n).fill(0);return e.set([n]),e.set(t.subarray(0,n),1),e.set(r,n+1),e};if(u>=255)throw r("FBLogger")("wmi_eb").mustfixThrow("Input is too large");var f=Array.from(l).map(function(e,n){var r=c(l,n),o=new Uint8Array(t);o[t-1]=e;var a=new Uint8Array(i);return p(a,r,t).then(function(e){return _(e,o)})});return(e||(e=n("Promise"))).all(f).then(function(e){return o("UInt8Array").concatBytes([new Uint8Array([a]),d(e)._0])})}function g(e,t,n,r){var o=c(r);return f(e,t,n,o)}l.keyGen=s,l.intStringToBEBytes=c,l.buildKeyLengthErrorMsg=m,l.encryptBigEndianBytes=f,l.encryptIntString=g}),98);
__d("OpeEncrypt",["CryptoLogger","I64","LSResult","OrderPreservingEncryption"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,n,a){var i=o("CryptoLogger").CryptoLogger("ope_encrypt");return o("OrderPreservingEncryption").encryptBigEndianBytes((e||(e=o("I64"))).to_int32(a),1,t,new Uint8Array(n)).then(function(e){return r("LSResult")(e.buffer)},function(e){throw o("CryptoLogger").captureError(i,e).mustfix("OpeEncrypt_impl failed"),e})}l.OpeEncrypt=s}),98);
__d("LSOpeEncrypt.nop",["OpeEncrypt"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t,n,r,a,i){return o("OpeEncrypt").OpeEncrypt(r,a,i)};e.__nop_name__="LSOpeEncrypt",l.default=e}),98);
__d("TruncateSortKey",["CryptoLogger","LSResult","Promise"],(function(t,n,r,o,a,i,l){"use strict";var e,s=o("CryptoLogger").CryptoLogger("truncate_sort_key");function u(t){if(t.byteLength!==8)throw s.mustfixThrow("Bad length on sort key for truncation");var o=new Uint8Array(t),a=o.subarray(0,2);if(a.some(function(e){return e!==0}))throw s.mustfixThrow("Bad prefix on sort key for truncation");return(e||(e=n("Promise"))).resolve(r("LSResult")(t.slice(2)))}l.TruncateSortKey=u}),98);
__d("LSTruncateSortKey.nop",["TruncateSortKey"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t,n,r){return o("TruncateSortKey").TruncateSortKey(r)};e.__nop_name__="LSTruncateSortKey",l.default=e}),98);
__d("LSEncryptIdentifiersV2",["LSBase64Encode.nop","LSBinaryToHex.nop","LSGetBlobFromInt64BE.nop","LSGetBlobFromString.nop","LSHmac_v2.nop","LSLogMebClientEvent.nop","LSOcmfClientMap.nop","LSOpeEncrypt.nop","LSTruncateSortKey.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][encryptIdentifiersV2] Beginning execution."),r[1]=t.i64.of_float(Date.now()),r[2]=e[6].get("ocmf_shared_key"),t.nativeOperation(n("LSGetBlobFromString.nop"),e[2]).then(function(e){var t;return t=e,r[3]=t[0],t})},function(e){return t.nativeOperation(n("LSHmac_v2.nop"),t.blob("bWFpbGJveF9pZF9zY29wZQ=="),r[3]).then(function(e){var t;return t=e,r[4]=t[0],t})},function(e){return t.nativeOperation(n("LSOcmfClientMap.nop"),r[2],r[4]).then(function(e){var t;return t=e,r[5]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[5]).then(function(e){var t;return t=e,r[6]=t[0],t})},function(o){return t.i64.eq(e[0],t.i64.cast([0,2]))&&t.i64.eq(e[1],t.i64.cast([0,2]))?r[7]=e[5]:r[7]=e[3],r[8]=e[6].get("ocmf_shared_key"),t.nativeOperation(n("LSGetBlobFromString.nop"),r[7]).then(function(e){var t;return t=e,r[9]=t[0],t})},function(e){return t.nativeOperation(n("LSHmac_v2.nop"),t.blob("dGhyZWFkX2lkX3Njb3Bl"),r[9]).then(function(e){var t;return t=e,r[10]=t[0],t})},function(e){return t.nativeOperation(n("LSOcmfClientMap.nop"),r[8],r[10]).then(function(e){var t;return t=e,r[11]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[11]).then(function(e){var t;return t=e,r[12]=t[0],t})},function(o){return r[13]=e[6].get("ope_key"),t.nativeOperation(n("LSGetBlobFromInt64BE.nop"),e[4]).then(function(e){var t;return t=e,r[14]=t[0],t})},function(e){return t.nativeOperation(n("LSTruncateSortKey.nop"),r[14]).then(function(e){var t;return t=e,r[15]=t[0],t})},function(e){return t.nativeOperation(n("LSOpeEncrypt.nop"),r[13],r[15],t.i64.cast([0,16])).then(function(e){var t;return t=e,r[16]=t[0],t})},function(e){return t.nativeOperation(n("LSBinaryToHex.nop"),r[16]).then(function(e){var t;return t=e,r[17]=t[0],t})},function(o){return r[18]=e[6].get("ocmf_shared_key"),t.nativeOperation(n("LSGetBlobFromString.nop"),e[5]).then(function(e){var t;return t=e,r[19]=t[0],t})},function(e){return t.nativeOperation(n("LSHmac_v2.nop"),t.blob("bWVzc2FnZV9pZF9zY29wZQ=="),r[19]).then(function(e){var t;return t=e,r[20]=t[0],t})},function(e){return t.nativeOperation(n("LSOcmfClientMap.nop"),r[18],r[20]).then(function(e){var t;return t=e,r[21]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[21]).then(function(e){var t;return t=e,r[22]=t[0],t})},function(e){return r[23]=new t.Map,r[23].set("backup_id_ocmf_partial",r[6]==null?"":r[6]),r[23].set("act_thread_id_ocmf_partial",r[12]==null?"":r[12]),r[23].set("timestamp_encrypted",r[17]==null?"":r[17]),r[23].set("otid_ocmf_partial",r[22]==null?"":r[22]),r[24]=t.i64.of_float(Date.now()),r[25]=t.i64.random(),r[27]="Finishing execution. Execution time: ",r[28]=t.i64.to_string(t.i64.sub(r[24],r[0])),r[29]=" ms",r[26]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][encryptIdentifiersV2] ",r[26],r[27],r[26],r[28],r[26],r[29]].join("")),t.i64.eq(t.i64.mod_(r[25],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[30]=",",r[31]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"encryptIdentifiersV2",[r[27],r[30],r[28],r[30],r[29]].join(""),r[31],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[r[23],void 0],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsEncryptIdentifiersV2StoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSEncryptMessagePayloadV2",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSGetBlobFromString.nop","LSLogMebClientEvent.nop","LSSymmetricEncryptionCreateEncryptedString.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][encryptMessagePayloadV2] Beginning execution."),r[1]=t.i64.of_float(Date.now()),r[2]=e[2].get("message_payload_encryption_keys"),r[3]=r[2].get("payload_key"),t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedString.nop"),r[3],t.blobs.of_string(["message_thread","_",e[1]].join("")),e[3]).then(function(e){var t;return t=e,r[4]=t[0],t})},function(o){var a;return r[4]!==void 0?t.sequence([function(e){return r[13]=r[2].get("encryption_version"),r[14]=r[2].get("epoch_anon_id"),r[15]=r[2].get("epoch_root_key"),r[16]=r[2].get("payload_key"),r[17]=t.createArray(),r[45]=(r[17].push(t.i64.cast([0,6])),r[17]),t.nativeOperation(n("LSGetBlobFromString.nop"),"epoch_anon_id_debug").then(function(e){var t;return t=e,r[18]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),r[18],void 0,r[14],r[17]).then(function(e){var t;return t=e,r[19]=t[0],t})},function(e){return r[19]?r[20]=!1:r[20]=!0,r[20]?t.resolve(r[21]=""):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[19],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[45]=t[0],r[46]=t[1],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[45]).then(function(e){var t;return t=e,r[47]=t[0],t})},function(e){return r[21]=r[47]==null?"":r[47]}])},function(e){return r[22]=t.createArray(),r[45]=(r[22].push(t.i64.cast([0,6])),r[22]),t.nativeOperation(n("LSGetBlobFromString.nop"),"epoch_root_key_debug").then(function(e){var t;return t=e,r[23]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),r[23],void 0,r[15],r[22]).then(function(e){var t;return t=e,r[24]=t[0],t})},function(e){return r[24]?r[25]=!1:r[25]=!0,r[25]?t.resolve(r[26]=""):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[24],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[45]=t[0],r[46]=t[1],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[45]).then(function(e){var t;return t=e,r[47]=t[0],t})},function(e){return r[26]=r[47]==null?"":r[47]}])},function(e){return r[27]=t.createArray(),r[45]=(r[27].push(t.i64.cast([0,6])),r[27]),t.nativeOperation(n("LSGetBlobFromString.nop"),"message_key_debug").then(function(e){var t;return t=e,r[28]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),r[28],void 0,r[16],r[27]).then(function(e){var t;return t=e,r[29]=t[0],t})},function(e){return r[29]?r[30]=!1:r[30]=!0,r[30]?t.resolve(r[31]=""):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[29],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[45]=t[0],r[46]=t[1],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[45]).then(function(e){var t;return t=e,r[47]=t[0],t})},function(e){return r[31]=r[47]==null?"":r[47]}])},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[15]).then(function(e){var t;return t=e,r[32]=t[0],t})},function(o){return t.nativeOperation(n("LSGetBlobFromString.nop"),[r[32]==null?"":r[32],e[1]].join("")).then(function(e){var t;return t=e,r[33]=t[0],t})},function(e){return r[34]=t.createArray(),r[45]=(r[34].push(t.i64.cast([0,6])),r[34]),t.nativeOperation(n("LSGetBlobFromString.nop"),"epoch_root_key_thread_id_debug").then(function(e){var t;return t=e,r[35]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),r[35],void 0,r[33],r[34]).then(function(e){var t;return t=e,r[36]=t[0],t})},function(e){return r[36]?r[37]=!1:r[37]=!0,r[37]?t.resolve(r[38]=""):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[36],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[45]=t[0],r[46]=t[1],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[45]).then(function(e){var t;return t=e,r[47]=t[0],t})},function(e){return r[38]=r[47]==null?"":r[47]}])},function(e){return r[39]=":",t.blobs.neq(r[15],void 0)?t.sequence([function(e){return r[45]=t.createArray(),r[51]=(r[45].push(t.i64.cast([0,18])),r[45]),t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,r[15],r[45]).then(function(e){var t;return t=e,r[46]=t[0],t})},function(e){return r[46]!==void 0?t.sequence([function(e){return r[51]=t.i64.of_int32(r[46].length),t.i64.ge(r[51],t.i64.cast([0,1]))?t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[46],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[53]=t[0],r[54]=t[1],t})},function(e){return r[52]=r[53]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),r[54]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBFingerprint] ","",r[54]].join("")),r[53]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBFingerprint",r[54],r[53],t.i64.cast([0,3]))},function(e){return r[52]=void 0}])},function(e){return r[47]=r[52]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),r[52]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBFingerprint] ","",r[52]].join("")),r[51]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBFingerprint",r[52],r[51],t.i64.cast([0,3]))},function(e){return r[47]=void 0}])},function(e){return t.blobs.neq(r[47],void 0)?r[48]=!0:r[48]=!1,r[48]||((function(e){t.logger(e).mustfix(e)})("LS::assert is failed. Attempting to coerce a null value to nonnull."),t.throw("LS::assert is failed. Attempting to coerce a null value to nonnull.")),t.nativeOperation(n("LSBase64Encode.nop"),r[47]).then(function(e){var t;return t=e,r[49]=t[0],t})},function(e){return r[49]!==void 0?r[50]=r[49]:r[50]="encodingfailed",r[40]=r[50]}]):t.resolve(r[40]="null")},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[14]).then(function(e){var t;return t=e,r[41]=t[0],t})},function(n){var o;return r[42]=new t.Map,r[42].set("encryption_version",r[13]),r[42].set("epoch_anon_id",r[41]==null?"":r[41]),r[42].set("message_encryption_values",[r[21],r[39],r[26],r[39],r[31],r[39],r[38]].join("")),r[42].set("root_key_fingerprint",r[40]),r[42].set("backup_id",e[0]),r[43]=t.toJSON(r[42]),r[44]=new t.Map,r[44].set("encrypted_message_payload",r[4]),r[44].set("value_secret_ref",r[43]),o=[r[44],void 0],r[5]=o[0],r[6]=o[1]}]):t.resolve((r[13]=new t.Map,r[13].set("error_code",t.i64.cast([0,40])),r[13].set("stored_procedure","LSEncryptedBackupsEncryptMessagePayloadV2StoredProcedure"),r[13].set("error_message",""),a=[void 0,r[13]],r[5]=a[0],r[6]=a[1]))},function(e){return r[7]=t.i64.of_float(Date.now()),r[8]=t.i64.random(),r[10]="Finishing execution. Execution time: ",r[11]=t.i64.to_string(t.i64.sub(r[7],r[0])),r[12]=" ms",r[9]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][encryptMessagePayloadV2] ",r[9],r[10],r[9],r[11],r[9],r[12]].join("")),t.i64.eq(t.i64.mod_(r[8],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[13]=",",r[14]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"encryptMessagePayloadV2",[r[10],r[13],r[11],r[13],r[12]].join(""),r[14],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[r[5],r[6]],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsEncryptMessagePayloadV2StoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSGetLatestEpochKeys",["LSLogMebClientEvent.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(n){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][getLatestEpochKeys] Beginning execution."),r[1]=t.i64.of_float(Date.now()),r[2]="",r[3]=void 0,r[4]=void 0,r[5]=void 0,e[0]?t.resolve(0):(r[15]=void 0,t.i64.neq(r[15],void 0)?t.sequence([function(e){return t.count(t.db.table(169).fetch([[[r[15]]]])).then(function(e){return r[16]=e})},function(e){return t.i64.le(r[16],t.i64.cast([0,1]))?t.sequence([function(e){return t.db.table(169).fetch([[[r[15]]]]).next().then(function(e,n){var o,a,i=e.done,l=e.value;return i?(r[26]=new t.Map,r[26].set("error_msg","Expected a nonempty query result"),r[26].set("code",t.i64.cast([0,3])),r[26].set("src_line","MEBEpochClientUtils.php:313 MEBEpochClientUtils::requireEpochReturnShapeFromPersistentEpochsTableDirectly()"),r[27]=t.createArray(),r[28]=(r[27].push(r[26]),r[27]),o=[void 0,r[27]],r[22]=o[0],r[23]=o[1]):(n=l.item,r[26]=new t.Map,r[26].set("epoch_id",n.epochId),r[26].set("backup_id",n.backupId),r[26].set("epoch_anon_id_blob",n.epochAnonIdBlob),r[26].set("epoch_root_key_blob",n.epochRootKeyBlob),r[26].set("epoch_status",n.epochStatus),r[26].set("epoch_head",n.epochHead),r[26].set("authority_level",n.authorityLevel),a=[r[26],void 0],r[22]=a[0],r[23]=a[1])})},function(e){return r[25]=new t.Map,r[25].set("value",r[22]),r[25].set("errors",r[23]),r[17]=r[25]}]):t.resolve((r[22]=new t.Map,r[22].set("error_msg","Expected at most one result"),r[22].set("code",t.i64.cast([0,4])),r[22].set("src_line","MEBEpochClientUtils.php:313 MEBEpochClientUtils::requireEpochReturnShapeFromPersistentEpochsTableDirectly()"),r[23]=t.createArray(),r[25]=(r[23].push(r[22]),r[23]),r[24]=new t.Map,r[24].set("value",void 0),r[24].set("errors",r[23]),r[17]=r[24]))},function(e){return r[18]=r[17].get("value"),r[18]!==void 0?(r[22]=r[18].get("epoch_id"),r[23]=r[18].get("backup_id"),r[24]=r[18].get("epoch_anon_id_blob"),r[25]=r[18].get("epoch_root_key_blob"),r[26]=r[18].get("epoch_status"),r[27]=r[18].get("epoch_head"),r[28]=r[18].get("authority_level"),r[29]=r[17],r[19]=r[29]):(r[22]=r[17].get("errors"),r[23]=r[17].get("errors"),r[24]=new t.Map,r[24].set("value",void 0),r[24].set("errors",r[22]),r[19]=r[24]),r[20]=r[19].get("value"),r[20]!==void 0?(r[22]=r[20].get("epoch_id"),r[23]=r[20].get("backup_id"),r[24]=r[20].get("epoch_anon_id_blob"),r[25]=r[20].get("epoch_root_key_blob"),r[26]=r[20].get("epoch_status"),r[27]=r[20].get("epoch_head"),r[28]=r[20].get("authority_level"),r[2]=t.blobs.to_string(r[24]),r[3]=r[22],r[4]=r[25],t.blobs.neq(r[27],void 0)&&(r[5]=r[27]),r[21]=!0):(r[22]=r[19].get("errors"),r[23]=r[19].get("errors"),r[21]=!1)}]):t.resolve())},function(n){return t.i64.neq(r[3],void 0)?t.resolve(0):t.sequence([function(n){return r[15]=void 0,r[16]="",r[17]=void 0,r[18]=void 0,t.forEach(t.filter(t.db.table(169).fetch(),function(n){return e[0]||t.i64.eq(n.authorityLevel,t.i64.cast([0,80]))}),function(e){var n=e.item;return r[20]=t.blobs.to_string(n.epochAnonIdBlob),t.i64.eq([0,r[20].length],[0,r[16].length])?r[19]=r[20]>r[16]:r[19]=t.i64.gt([0,r[20].length],[0,r[16].length]),r[19]?(r[15]=n.epochId,r[16]=r[20],r[17]=n.epochRootKeyBlob,r[18]=n.epochHead):0})},function(e){return t.i64.neq(r[15],void 0)&&(r[2]=r[16],r[3]=r[15],r[4]=r[17],t.blobs.neq(r[18],void 0)&&(r[5]=r[18]),r[19]=t.i64.of_float(Date.now())),0}])},function(e){var o,a,i,l,s,u;return r[11]=t.blobs.of_string(r[2]),t.i64.neq(r[3],void 0)?(t.blobs.neq(r[11],void 0)?(t.blobs.neq(r[4],void 0)?(r[19]=new t.Map,r[19].set("epoch_id",r[3]),r[19].set("epoch_root_key",r[4]),r[19].set("epoch_anon_id",r[11]),r[19].set("epoch_head",r[5]),r[20]=new t.Map,r[20].set("epoch_keys",r[19]),o=[r[20],void 0],r[17]=o[0],r[18]=o[1]):(r[19]=new t.Map,r[19].set("error_code",t.i64.cast([0,402])),r[19].set("error_message","failed to query latest epoch"),r[19].set("stored_procedure","LSEncryptedBackupsGetLatestEpochKeysStoredProcedure"),a=[void 0,r[19]],r[17]=a[0],r[18]=a[1]),i=[r[17],r[18]],r[15]=i[0],r[16]=i[1]):(r[17]=new t.Map,r[17].set("error_code",t.i64.cast([0,403])),r[17].set("error_message","failed to query latest epoch"),r[17].set("stored_procedure","LSEncryptedBackupsGetLatestEpochKeysStoredProcedure"),l=[void 0,r[17]],r[15]=l[0],r[16]=l[1]),s=[r[15],r[16]],r[6]=s[0],r[7]=s[1]):(r[15]=new t.Map,r[15].set("error_code",t.i64.cast([0,400])),r[15].set("error_message","failed to query latest epoch"),r[15].set("stored_procedure","LSEncryptedBackupsGetLatestEpochKeysStoredProcedure"),u=[void 0,r[15]],r[6]=u[0],r[7]=u[1]),r[8]=t.i64.of_float(Date.now()),r[9]=t.i64.random(),r[12]="Finishing execution. Execution time: ",r[13]=t.i64.to_string(t.i64.sub(r[8],r[0])),r[14]=" ms",r[10]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][getLatestEpochKeys] ",r[10],r[12],r[10],r[13],r[10],r[14]].join("")),t.i64.eq(t.i64.mod_(r[9],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[15]=",",r[16]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"getLatestEpochKeys",[r[12],r[15],r[13],r[15],r[14]].join(""),r[16],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[r[6],r[7]],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsGetLatestEpochKeysStoredProcedure",e.__tables__=["secure_encrypted_backups_epochs"],a.exports=e}),null);
__d("LSLoadAndEncryptProtobufWithInputsV2",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSGetBlobFromString.nop","LSHmac_v2.nop","LSLogMebClientEvent.nop","LSQueryLocalPersistenceStoreForBackup.nop","LSQueryLocalPersistenceStoreSupplementalForBackup.nop","LSQueryLocalPersistenceStoreTagsForBackup.nop","LSSymmetricEncryptionCreateEncryptedData.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][loadAndEncryptProtobufWithInputsV2] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.i64.eq(e[0],t.i64.cast([0,1]))?t.sequence([function(o){return t.nativeOperation(n("LSQueryLocalPersistenceStoreForBackup.nop"),e[1],e[2]).then(function(e){var t;return t=e,r[10]=t[0],r[11]=t[1],r[12]=t[2],t})},function(o){return t.nativeOperation(n("LSQueryLocalPersistenceStoreTagsForBackup.nop"),e[1],e[2]).then(function(e){var t;return t=e,r[13]=t[0],t})},function(o){var a,i,l;return r[14]=new t.Map,r[14].set("message_tags",r[13]),r[15]=new t.Map,r[15].set("mt",r[14]),t.blobs.neq(r[10],void 0)?t.sequence([function(o){return r[18]=e[5].get("message_payload_encryption_keys"),r[19]=r[18].get("payload_key"),t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedData.nop"),r[19],t.blobs.of_string(["message_thread","_",e[1]].join("")),r[10]).then(function(e){var t;return t=e,r[20]=t[0],t})},function(e){return t.blobs.neq(r[20],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[20]).then(function(e){var t;return t=e,r[24]=t[0],t})},function(e){return r[21]=r[24]}]):t.resolve(r[21]=void 0)},function(o){var a;return r[21]!==void 0?t.sequence([function(e){return r[15]!==void 0?t.sequence([function(e){return r[27]=r[15].get("mt"),r[27]?r[28]=!1:r[28]=!0,r[28]?t.resolve(r[29]=void 0):t.sequence([function(e){return r[31]=new t.Map,r[32]=r[27].keys(),r[33]=t.i64.of_int32(r[32].length),t.i64.gt(r[33],t.i64.cast([0,0]))?t.loopAsync(r[33],function(e){return r[34]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[32],r[34]).then(function(e){var t;return t=e,r[35]=t[0],r[36]=t[1],t})},function(e){return r[37]=r[27].get(r[35]),r[31].set(r[35],r[37])}])}):t.resolve()},function(e){return r[29]=r[31]}])},function(e){return r[29]!==void 0?(r[31]=t.toJSON(r[29]),r[30]=r[31]):r[30]=void 0,r[24]=r[30]}]):t.resolve(r[24]=void 0)},function(n){var o;return r[15]!==void 0?(r[27]=r[15].get("mooos"),r[25]=r[27]):r[25]=void 0,r[26]=new t.Map,r[26].set("backup_action",e[0]),r[26].set("protobuf_encrypted",r[21]),r[26].set("supplemental_data_encrypted",void 0),r[26].set("timestamp_ms",e[4]),r[26].set("message_tags",r[24]),r[26].set("serialized_attachment_backup_payload",void 0),r[26].set("maybe_ooo_supplemental_upload",r[25]),o=[r[26],void 0],r[22]=o[0],r[23]=o[1]}]):t.resolve(((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_ENCRYPTION_FAILED"),r[24]=new t.Map,r[24].set("error_code",t.i64.cast([0,62])),r[24].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),r[24].set("error_message",""),a=[void 0,r[24]],r[22]=a[0],r[23]=a[1]))},function(e){var t;return t=[r[22],r[23]],r[16]=t[0],r[17]=t[1],t}]):t.resolve((r[12]?((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_ALREADY_DELETED"),r[20]=new t.Map,r[20].set("error_code",t.i64.cast([0,70])),r[20].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),r[20].set("error_message",""),a=[void 0,r[20]],r[18]=a[0],r[19]=a[1]):((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_NOT_FOUND_IN_TOPLEVEL_TABLE"),r[20]=new t.Map,r[20].set("error_code",t.i64.cast([0,63])),r[20].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),r[20].set("error_message",""),i=[void 0,r[20]],r[18]=i[0],r[19]=i[1]),l=[r[18],r[19]],r[16]=l[0],r[17]=l[1]))},function(e){var t;return t=[r[16],r[17]],r[2]=t[0],r[3]=t[1],t}]):t.sequence([function(o){return t.i64.eq(e[0],t.i64.cast([0,2]))?t.sequence([function(o){var a;return e[3]!==void 0?t.sequence([function(o){return t.nativeOperation(n("LSQueryLocalPersistenceStoreSupplementalForBackup.nop"),e[1],e[2],e[3]).then(function(e){var t;return t=e,r[14]=t[0],r[15]=t[1],t})},function(o){return t.nativeOperation(n("LSQueryLocalPersistenceStoreTagsForBackup.nop"),e[1],e[2]).then(function(e){var t;return t=e,r[16]=t[0],t})},function(o){var a;return r[17]=new t.Map,r[17].set("message_tags",r[16]),r[18]=new t.Map,r[18].set("mt",r[17]),t.blobs.neq(r[14],void 0)?t.sequence([function(o){var a;return e[3]!==void 0?t.sequence([function(o){var a;return r[23]=e[5].get("mailbox_root_key_v2"),t.blobs.neq(r[23],void 0)?t.sequence([function(o){return r[26]=e[5].get("message_payload_encryption_keys"),r[27]=r[26].get("epoch_root_key"),r[28]=t.createArray(),r[41]=(r[28].push(t.i64.cast([0,32])),r[28]),t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleV92Mj5zdXBwbGVtZW50YWxfcHJmX2tleQ=="),void 0,r[23],r[28]).then(function(e){var t;return t=e,r[29]=t[0],t})},function(e){return r[29]!==void 0?t.sequence([function(e){return r[41]=t.i64.of_int32(r[29].length),t.i64.ge(r[41],t.i64.cast([0,1]))?t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[29],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[43]=t[0],r[44]=t[1],t})},function(e){return r[42]=r[43]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),r[44]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoUtils] ","",r[44]].join("")),r[43]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoUtils",r[44],r[43],t.i64.cast([0,3]))},function(e){return r[42]=void 0}])},function(e){return r[30]=r[42]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),r[42]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoUtils] ","",r[42]].join("")),r[41]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoUtils",r[42],r[41],t.i64.cast([0,3]))},function(e){return r[30]=void 0}])},function(e){return t.blobs.neq(r[30],void 0)?r[31]=!0:r[31]=!1,r[31]||((function(e){t.logger(e).mustfix(e)})("LS::assert is failed. Attempting to coerce a null value to nonnull."),t.throw("LS::assert is failed. Attempting to coerce a null value to nonnull.")),r[32]=t.createArray(),r[41]=(r[32].push(t.i64.cast([0,32])),r[32]),t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleV92Mj5zdXBwbGVtZW50YWxfZW5jX2tleQ=="),void 0,r[27],r[32]).then(function(e){var t;return t=e,r[33]=t[0],t})},function(e){return r[33]!==void 0?t.sequence([function(e){return r[41]=t.i64.of_int32(r[33].length),t.i64.ge(r[41],t.i64.cast([0,1]))?t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[33],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[43]=t[0],r[44]=t[1],t})},function(e){return r[42]=r[43]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),r[44]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoUtils] ","",r[44]].join("")),r[43]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoUtils",r[44],r[43],t.i64.cast([0,3]))},function(e){return r[42]=void 0}])},function(e){return r[34]=r[42]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),r[42]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoUtils] ","",r[42]].join("")),r[41]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoUtils",r[42],r[41],t.i64.cast([0,3]))},function(e){return r[34]=void 0}])},function(o){return t.blobs.neq(r[34],void 0)?r[35]=!0:r[35]=!1,r[35]||((function(e){t.logger(e).mustfix(e)})("LS::assert is failed. Attempting to coerce a null value to nonnull."),t.throw("LS::assert is failed. Attempting to coerce a null value to nonnull.")),t.nativeOperation(n("LSGetBlobFromString.nop"),e[3]).then(function(e){var t;return t=e,r[36]=t[0],t})},function(e){return t.nativeOperation(n("LSHmac_v2.nop"),r[30],r[36]).then(function(e){var t;return t=e,r[37]=t[0],t})},function(e){return t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedData.nop"),r[34],t.blob("c3VwcGxlbWVudGFsX2VuY19hYWQ="),r[36]).then(function(e){var t;return t=e,r[38]=t[0],t})},function(o){var a;return t.blobs.neq(r[38],void 0)?t.sequence([function(o){return r[41]=new t.Map,r[41].set("sk_ciphertext",r[38]),r[41].set("sk_hash",r[37]),r[42]=e[5].get("message_payload_encryption_keys"),r[43]=r[42].get("payload_key"),t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedData.nop"),r[43],t.blobs.of_string(["message_thread","_",e[1]].join("")),r[14]).then(function(e){var t;return t=e,r[44]=t[0],t})},function(e){return t.blobs.neq(r[44],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[44]).then(function(e){var t;return t=e,r[48]=t[0],t})},function(e){return r[45]=r[48]}]):t.resolve(r[45]=void 0)},function(o){var a;return r[45]!==void 0?t.sequence([function(e){return r[18]!==void 0?t.sequence([function(e){return r[51]=r[18].get("mt"),r[51]?r[52]=!1:r[52]=!0,r[52]?t.resolve(r[53]=void 0):t.sequence([function(e){return r[55]=new t.Map,r[56]=r[51].keys(),r[57]=t.i64.of_int32(r[56].length),t.i64.gt(r[57],t.i64.cast([0,0]))?t.loopAsync(r[57],function(e){return r[58]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[56],r[58]).then(function(e){var t;return t=e,r[59]=t[0],r[60]=t[1],t})},function(e){return r[61]=r[51].get(r[59]),r[55].set(r[59],r[61])}])}):t.resolve()},function(e){return r[53]=r[55]}])},function(e){return r[53]!==void 0?(r[55]=t.toJSON(r[53]),r[54]=r[55]):r[54]=void 0,r[48]=r[54]}]):t.resolve(r[48]=void 0)},function(n){var o;return r[18]!==void 0?(r[51]=r[18].get("mooos"),r[49]=r[51]):r[49]=void 0,r[50]=new t.Map,r[50].set("backup_action",e[0]),r[50].set("protobuf_encrypted",r[45]),r[50].set("supplemental_data_encrypted",r[41]),r[50].set("timestamp_ms",e[4]),r[50].set("message_tags",r[48]),r[50].set("serialized_attachment_backup_payload",void 0),r[50].set("maybe_ooo_supplemental_upload",r[49]),o=[r[50],void 0],r[46]=o[0],r[47]=o[1]}]):t.resolve(((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_ENCRYPTION_FAILED"),r[48]=new t.Map,r[48].set("error_code",t.i64.cast([0,62])),r[48].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),r[48].set("error_message",""),a=[void 0,r[48]],r[46]=a[0],r[47]=a[1]))},function(e){var t;return t=[r[46],r[47]],r[39]=t[0],r[40]=t[1],t}]):t.resolve(((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error SUPPLEMENTAL_ENCRYPTION_FAILED"),r[41]=new t.Map,r[41].set("error_code",t.i64.cast([0,66])),r[41].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),r[41].set("error_message",""),a=[void 0,r[41]],r[39]=a[0],r[40]=a[1]))},function(e){var t;return t=[r[39],r[40]],r[24]=t[0],r[25]=t[1],t}]):t.resolve(((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error NULL_MAILBOX_ROOT_KEY_V2"),r[26]=new t.Map,r[26].set("error_code",t.i64.cast([0,27])),r[26].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),r[26].set("error_message",""),a=[void 0,r[26]],r[24]=a[0],r[25]=a[1]))},function(e){var t;return t=[r[24],r[25]],r[21]=t[0],r[22]=t[1],t}]):t.resolve(((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error SUPPLEMENTAL_KEY_NOT_SET_IN_CONTEXT_TABLE"),r[23]=new t.Map,r[23].set("error_code",t.i64.cast([0,65])),r[23].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),r[23].set("error_message",""),a=[void 0,r[23]],r[21]=a[0],r[22]=a[1]))},function(e){var t;return t=[r[21],r[22]],r[19]=t[0],r[20]=t[1],t}]):t.resolve(((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_NOT_FOUND_IN_SUPPLEMENTAL_TABLE"),r[21]=new t.Map,r[21].set("error_code",t.i64.cast([0,64])),r[21].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),r[21].set("error_message",""),a=[void 0,r[21]],r[19]=a[0],r[20]=a[1]))},function(e){var t;return t=[r[19],r[20]],r[12]=t[0],r[13]=t[1],t}]):t.resolve(((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error SUPPLEMENTAL_KEY_NOT_SET_IN_CONTEXT_TABLE"),r[14]=new t.Map,r[14].set("error_code",t.i64.cast([0,65])),r[14].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),r[14].set("error_message",""),a=[void 0,r[14]],r[12]=a[0],r[13]=a[1]))},function(e){var t;return t=[r[12],r[13]],r[10]=t[0],r[11]=t[1],t}]):t.sequence([function(o){return t.i64.eq(e[0],t.i64.cast([0,4]))?t.sequence([function(o){return t.nativeOperation(n("LSQueryLocalPersistenceStoreForBackup.nop"),e[1],e[2]).then(function(e){var t;return t=e,r[14]=t[0],r[15]=t[1],r[16]=t[2],t})},function(o){return t.nativeOperation(n("LSQueryLocalPersistenceStoreTagsForBackup.nop"),e[1],e[2]).then(function(e){var t;return t=e,r[17]=t[0],t})},function(o){var a,i,l;return r[18]=new t.Map,r[18].set("message_tags",r[17]),r[19]=new t.Map,r[19].set("mt",r[18]),t.blobs.neq(r[14],void 0)?t.sequence([function(o){return r[22]=e[5].get("message_payload_encryption_keys"),r[23]=r[22].get("payload_key"),t.nativeOperation(n("LSSymmetricEncryptionCreateEncryptedData.nop"),r[23],t.blobs.of_string(["message_thread","_",e[1]].join("")),r[14]).then(function(e){var t;return t=e,r[24]=t[0],t})},function(e){return t.blobs.neq(r[24],void 0)?t.sequence([function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[24]).then(function(e){var t;return t=e,r[28]=t[0],t})},function(e){return r[25]=r[28]}]):t.resolve(r[25]=void 0)},function(o){var a;return r[25]!==void 0?t.sequence([function(e){return r[19]!==void 0?t.sequence([function(e){return r[31]=r[19].get("mt"),r[31]?r[32]=!1:r[32]=!0,r[32]?t.resolve(r[33]=void 0):t.sequence([function(e){return r[35]=new t.Map,r[36]=r[31].keys(),r[37]=t.i64.of_int32(r[36].length),t.i64.gt(r[37],t.i64.cast([0,0]))?t.loopAsync(r[37],function(e){return r[38]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[36],r[38]).then(function(e){var t;return t=e,r[39]=t[0],r[40]=t[1],t})},function(e){return r[41]=r[31].get(r[39]),r[35].set(r[39],r[41])}])}):t.resolve()},function(e){return r[33]=r[35]}])},function(e){return r[33]!==void 0?(r[35]=t.toJSON(r[33]),r[34]=r[35]):r[34]=void 0,r[28]=r[34]}]):t.resolve(r[28]=void 0)},function(n){var o;return r[19]!==void 0?(r[31]=r[19].get("mooos"),r[29]=r[31]):r[29]=void 0,r[30]=new t.Map,r[30].set("backup_action",e[0]),r[30].set("protobuf_encrypted",r[25]),r[30].set("supplemental_data_encrypted",void 0),r[30].set("timestamp_ms",e[4]),r[30].set("message_tags",r[28]),r[30].set("serialized_attachment_backup_payload",void 0),r[30].set("maybe_ooo_supplemental_upload",r[29]),o=[r[30],void 0],r[26]=o[0],r[27]=o[1]}]):t.resolve(((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_ENCRYPTION_FAILED"),r[28]=new t.Map,r[28].set("error_code",t.i64.cast([0,62])),r[28].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),r[28].set("error_message",""),a=[void 0,r[28]],r[26]=a[0],r[27]=a[1]))},function(e){var t;return t=[r[26],r[27]],r[20]=t[0],r[21]=t[1],t}]):t.resolve((r[16]?((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_ALREADY_DELETED"),r[24]=new t.Map,r[24].set("error_code",t.i64.cast([0,70])),r[24].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),r[24].set("error_message",""),a=[void 0,r[24]],r[22]=a[0],r[23]=a[1]):((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_NOT_FOUND_IN_TOPLEVEL_TABLE"),r[24]=new t.Map,r[24].set("error_code",t.i64.cast([0,63])),r[24].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),r[24].set("error_message",""),i=[void 0,r[24]],r[22]=i[0],r[23]=i[1]),l=[r[22],r[23]],r[20]=l[0],r[21]=l[1]))},function(e){var t;return t=[r[20],r[21]],r[12]=t[0],r[13]=t[1],t}]):t.sequence([function(n){var o;return t.i64.eq(e[0],t.i64.cast([0,3]))?t.sequence([function(e){return t.resolve(r[16]=void 0)},function(n){var o;return r[17]=void 0,r[18]=new t.Map,r[18].set("backup_action",e[0]),r[18].set("protobuf_encrypted",void 0),r[18].set("supplemental_data_encrypted",void 0),r[18].set("timestamp_ms",e[4]),r[18].set("message_tags",r[16]),r[18].set("serialized_attachment_backup_payload",void 0),r[18].set("maybe_ooo_supplemental_upload",r[17]),o=[r[18],void 0],r[14]=o[0],r[15]=o[1]}]):t.resolve(((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error UNKNOWN_PROTOBUF_TYPE"),r[16]=new t.Map,r[16].set("error_code",t.i64.cast([0,60])),r[16].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),r[16].set("error_message",""),o=[void 0,r[16]],r[14]=o[0],r[15]=o[1]))},function(e){var t;return t=[r[14],r[15]],r[12]=t[0],r[13]=t[1],t}])},function(e){var t;return t=[r[12],r[13]],r[10]=t[0],r[11]=t[1],t}])},function(e){var t;return t=[r[10],r[11]],r[2]=t[0],r[3]=t[1],t}])},function(e){return r[4]=t.i64.of_float(Date.now()),r[5]=t.i64.random(),r[7]="Finishing execution. Execution time: ",r[8]=t.i64.to_string(t.i64.sub(r[4],r[0])),r[9]=" ms",r[6]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][loadAndEncryptProtobufWithInputsV2] ",r[6],r[7],r[6],r[8],r[6],r[9]].join("")),t.i64.eq(t.i64.mod_(r[5],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[10]=",",r[11]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"loadAndEncryptProtobufWithInputsV2",[r[7],r[10],r[8],r[10],r[9]].join(""),r[11],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[r[2],r[3]],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSLoadAndEncryptProtobufV2",["LSLoadAndEncryptProtobufWithInputsV2","LSLogMebClientEvent.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][loadAndEncryptProtobufV2] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.filter(t.db.table(305).fetch(),function(n){return t.i64.eq(n.pendingBackupTaskId,e[0])}).next().then(function(o,a){var i,l=o.done,s=o.value;return l?((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufV2StoredProcedure] Returning error PROTOBUF_CONTEXT_ROW_NOT_FOUND"),r[11]=new t.Map,r[11].set("error_code",t.i64.cast([0,67])),r[11].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufV2StoredProcedure"),r[11].set("error_message",""),i=[void 0,r[11]],r[2]=i[0],r[3]=i[1]):(a=s.item,t.sequence([function(o){return t.storedProcedure(n("LSLoadAndEncryptProtobufWithInputsV2"),a.backupAction,e[2],a.toplevelOfflineThreadingId,a.supplementalKey,a.messageTimestampMs,e[1]).then(function(e){var t;return t=e,r[11]=t[0],r[12]=t[1],t})},function(e){var t;return t=[r[11],r[12]],r[2]=t[0],r[3]=t[1],t}]))})},function(e){return r[5]=t.i64.of_float(Date.now()),r[6]=t.i64.random(),r[8]="Finishing execution. Execution time: ",r[9]=t.i64.to_string(t.i64.sub(r[5],r[0])),r[10]=" ms",r[7]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][loadAndEncryptProtobufV2] ",r[7],r[8],r[7],r[9],r[7],r[10]].join("")),t.i64.eq(t.i64.mod_(r[6],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[11]=",",r[12]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"loadAndEncryptProtobufV2",[r[8],r[11],r[9],r[11],r[10]].join(""),r[12],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[r[2],r[3]],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsLoadAndEncryptProtobufV2StoredProcedure",e.__tables__=["pending_protobuf_backups_context"],a.exports=e}),null);
__d("LSSerializeBackupPayloadV2",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSDeriveValueSecretRefV2","LSEncryptIdentifiersV2","LSEncryptMessagePayloadV2","LSGetBlobFromString.nop","LSGetLatestEpochKeys","LSIsEncryptionVersionSecure","LSLoadAndEncryptProtobufV2","LSLogMebClientEvent.nop","LSLogWebQpl.nop","LSQplAnnotateBool.nop","LSQplAnnotateString.nop","LSQplMarkEnd.nop","LSQplMarkPoint.nop","LSQplStartTrace.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(n){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][serializeBackupPayloadV2] Beginning execution."),r[1]=t.i64.of_float(Date.now()),r[19]=t.i64.mul(r[1],t.i64.cast([0,1e6])),r[2]=t.i64.random(),r[6]=t.i64.to_string(r[2]),t.db.table(2).fetch([[[e[0]]]]).next().then(function(e,t){var n=e.done,o=e.value;return n?r[3]=void 0:(t=o.item,r[3]=t.dataTraceId)})},function(e){return r[3]!==void 0?r[5]=r[3]:r[5]=void 0,r[6]!==void 0?t.nativeOperation(n("LSQplStartTrace.nop"),t.i64.cast([0,637746317]),r[6],!0,r[5]):t.resolve()},function(e){return r[6]!==void 0?t.nativeOperation(n("LSQplMarkPoint.nop"),t.i64.cast([0,637746317]),r[6],"LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure_start"):t.resolve()},function(e){return t.islc(t.filter(t.db.table(168).fetch(),function(e){return t.i64.eq(e.authorityLevel,t.i64.cast([0,80]))||!1}),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,n){var o,a,i=e.done,l=e.value;return i?(r[23]=new t.Map,r[23].set("error_msg","Expected a nonempty query result"),r[23].set("code",t.i64.cast([0,3])),r[23].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),r[24]=t.createArray(),r[25]=(r[24].push(r[23]),r[24]),o=[void 0,r[24]],r[7]=o[0],r[8]=o[1]):(n=l.item,r[23]=new t.Map,r[23].set("backup_id",n.backupId),r[23].set("device_public_key_blob",n.devicePublicKeyBlob),r[23].set("device_private_key_blob",n.devicePrivateKeyBlob),r[23].set("epoch_storage_public_key_blob",n.epochStoragePublicKeyBlob),r[23].set("epoch_storage_private_key_blob",n.epochStoragePrivateKeyBlob),r[23].set("epoch_auth_public_key_blob",n.epochAuthPublicKeyBlob),r[23].set("epoch_auth_private_key_blob",n.epochAuthPrivateKeyBlob),r[23].set("mailbox_root_key_blob",n.mailboxRootKeyBlob),r[23].set("ocmf_client_state_blob",n.ocmfClientStateBlob),r[23].set("orf_client_state_v2_blob",void 0),r[23].set("orf_v2_authority_level",void 0),r[23].set("oblivious_validation_token_blob",n.obliviousValidationTokenBlob),r[23].set("device_id",n.deviceId),r[23].set("backup_tenancy",n.backupTenancy),r[23].set("encryption_version",n.encryptionVersion),r[23].set("revision_version",n.revisionVersion),r[23].set("initialize_restore_result",void 0),r[23].set("device_creation_timestamp_sec",void 0),r[23].set("authority_level",n.authorityLevel),a=[r[23],void 0],r[7]=a[0],r[8]=a[1])})},function(o){return r[10]=new t.Map,r[10].set("value",r[7]),r[10].set("errors",r[8]),r[11]=r[10].get("value"),r[11]!==void 0?t.sequence([function(o){return r[23]=r[11].get("backup_id"),r[24]=r[11].get("device_public_key_blob"),r[25]=r[11].get("device_private_key_blob"),r[26]=r[11].get("epoch_storage_public_key_blob"),r[27]=r[11].get("epoch_storage_private_key_blob"),r[28]=r[11].get("epoch_auth_public_key_blob"),r[29]=r[11].get("epoch_auth_private_key_blob"),r[30]=r[11].get("mailbox_root_key_blob"),r[31]=r[11].get("ocmf_client_state_blob"),r[32]=r[11].get("orf_client_state_v2_blob"),r[33]=r[11].get("orf_v2_authority_level"),r[34]=r[11].get("oblivious_validation_token_blob"),r[35]=r[11].get("device_id"),r[36]=r[11].get("backup_tenancy"),r[37]=r[11].get("encryption_version"),r[38]=r[11].get("revision_version"),r[39]=r[11].get("initialize_restore_result"),r[40]=r[11].get("device_creation_timestamp_sec"),r[41]=r[11].get("authority_level"),t.i64.neq(r[35],void 0)?t.sequence([function(e){return r[46]=void 0,t.i64.neq(r[46],void 0)?t.resolve(r[47]=r[46]):t.sequence([function(e){return r[55]=t.createArray(),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,0])).then(function(e){var t;return t=e,r[56]=t[0],t})},function(e){return r[56]&&(r[65]=(r[55].push(t.i64.cast([0,0])),r[55])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,2])).then(function(e){var t;return t=e,r[57]=t[0],t})},function(e){return r[57]&&(r[65]=(r[55].push(t.i64.cast([0,2])),r[55])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,3])).then(function(e){var t;return t=e,r[58]=t[0],t})},function(e){return r[58]&&(r[65]=(r[55].push(t.i64.cast([0,3])),r[55])),t.storedProcedure(n("LSIsEncryptionVersionSecure"),t.i64.cast([0,4])).then(function(e){var t;return t=e,r[59]=t[0],t})},function(e){return r[59]&&(r[65]=(r[55].push(t.i64.cast([0,4])),r[55])),r[60]=t.createArray(),r[61]=t.i64.of_int32(r[55].length),t.i64.gt(r[61],t.i64.cast([0,0]))?t.loopAsync(r[61],function(e){return r[65]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[55],r[65]).then(function(e){var t;return t=e,r[66]=t[0],r[67]=t[1],t})},function(e){return r[68]=(r[60].push(r[66]),r[60])}])}):t.resolve()},function(e){return t.sequence([function(e){return r[65]=t.createArray(),r[66]=t.i64.of_int32(r[60].length),t.i64.gt(r[66],t.i64.cast([0,0]))?t.loopAsync(r[66],function(e){return r[68]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[60],r[68]).then(function(e){var t;return t=e,r[69]=t[0],r[70]=t[1],t})},function(e){return r[71]=(r[65].push(t.i64.to_string(r[69])),r[65])}])}):t.resolve()},function(e){return r[67]=r[65].join(","),r[62]=r[67]}])},function(e){return r[60].some(function(e){return t.i64.eq(r[37],e)})?r[63]=r[37]:r[63]=void 0,t.i64.neq(r[63],void 0)?r[64]=r[63]:r[64]=void 0,r[47]=r[64]}])},function(o){return t.i64.neq(r[47],void 0)?r[48]=r[47]:r[48]=t.i64.cast([0,0]),t.i64.neq(r[36],void 0)?r[49]=r[36]:r[49]=t.i64.cast([0,1]),t.db.table(177).fetch([[[e[0]]],"fk_pending_tasks"]).next().then(function(o,a){var i=o.done,l=o.value;return i?t.sequence([function(n){return t.db.table(2).fetch([[[e[0]]]]).next().then(function(n,o){var a,i,l=n.done,s=n.value;return l?(r[67]=t.i64.of_float(Date.now()),a=[e[0],void 0,void 0,void 0,void 0,t.i64.sub(t.i64.mul(r[67],t.i64.cast([0,1e6])),r[19]),void 0],r[55]=a[0],r[56]=a[1],r[57]=a[2],r[58]=a[3],r[59]=a[4],r[60]=a[5],r[61]=a[6]):(o=s.item,r[67]=t.i64.of_float(Date.now()),i=[e[0],o.queueName,o.enqueueTimestampMs,void 0,o.firstExecutedTimestampMs,t.i64.sub(t.i64.mul(r[67],t.i64.cast([0,1e6])),r[19]),void 0],r[55]=i[0],r[56]=i[1],r[57]=i[2],r[58]=i[3],r[59]=i[4],r[60]=i[5],r[61]=i[6])})},function(e){return r[63]=new t.Map,r[63].set("task_id",r[55]),r[63].set("queue_name",r[56]),r[63].set("enqueue_timestamp_ms",r[57]),r[63].set("priority",r[58]),r[63].set("first_executed_timestamp_ms",r[59]),r[63].set("execution_time_ns",r[60]),r[63].set("echo_encoding_execution_time_ns",r[61]),r[64]=new t.Map,r[64].set("task_metadata",r[63]),r[64].set("action_type",void 0),r[64].set("content_type",void 0),r[64].set("identifiers",void 0),r[64].set("identifiers_v2",void 0),r[64].set("task_creation_source",void 0),r[64].set("message_payload_source",t.i64.cast([0,2])),r[65]=new t.Map,r[65].set("error_code",t.i64.cast([0,5])),r[65].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),r[65].set("error_message","Pending backup context row not found"),r[65]!==void 0?(r[67]=r[65].get("stored_procedure"),r[68]=r[65].get("error_code"),r[69]=r[65].get("error_message"),r[70]=".",r[71]=[r[67],r[70],t.i64.to_string(r[68]),r[70],r[69]].join(""),r[6]!==void 0&&r[71]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,637746317]),r[6],"exception_error",r[71]):t.resolve()):t.resolve()},function(e){return t.resolve()},function(e){return r[6]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,637746317]),r[6],!1):t.resolve()},function(e){var n;return r[66]=t.createArray(),n=[void 0,r[65],r[64],r[66]],r[50]=n[0],r[51]=n[1],r[52]=n[2],r[53]=n[3]}]):(a=l.item,t.sequence([function(n){return r[62]=a.actionType,r[63]=a.contentType,r[68]=a.echoContent,r[69]=a.lsTraceId,r[67]=a.echoEncodingLatencyNs,r[66]=a.attachmentPayload,r[72]=a.attachmentErrorCode,r[70]=a.tamThreadSubtype,r[71]=a.isInstamadillo,r[55]=new t.Map,r[55].set("backup_id",t.i64.to_string(r[23])),r[55].set("act_thread_id",a.listKey),r[55].set("timestamp",a.sortKey),r[55].set("otid",a.uniqueKey),t.filter(t.db.table(305).fetch(),function(n){return t.i64.eq(n.pendingBackupTaskId,e[0])}).next().then(function(e,t){var n=e.done,o=e.value;return n?r[56]=!1:(t=o.item,r[55].set("supplemental_otid",t.supplementalOfflineThreadingId),r[55].set("deletion_otid",t.deletionOfflineThreadingId),r[56]=!0)})},function(e){return r[65]=t.i64.eq(void 0,void 0),r[6]!==void 0?t.nativeOperation(n("LSQplAnnotateBool.nop"),t.i64.cast([0,637746317]),r[6],"should_run_device_timestamp_sync",r[65]):t.resolve()},function(o){return r[64]=a.error==null?t.i64.cast([0,0]):a.error,[t.i64.cast([0,0]),t.i64.cast([0,32])].some(function(e){return t.i64.eq(r[64],e)})?t.sequence([function(e){return r[73]=r[55].get("act_thread_id"),r[74]=r[55].get("otid"),t.storedProcedure(n("LSGetLatestEpochKeys"),!1).then(function(e){var t;return t=e,r[75]=t[0],r[76]=t[1],t})},function(e){var o;return r[75]!==void 0?t.sequence([function(e){return t.i64.eq(r[63],t.i64.cast([0,1]))?t.sequence([function(e){return r[86]=t.createArray(),r[91]=(r[86].push(t.i64.cast([0,32])),r[86]),t.nativeOperation(n("LSGetBlobFromString.nop"),["thread_ope_key","_",r[73]].join("")).then(function(e){var t;return t=e,r[87]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),r[87],void 0,r[30],r[86]).then(function(e){var t;return t=e,r[88]=t[0],t})},function(e){return r[88]?r[89]=!1:r[89]=!0,r[89]?t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoUtils] Got null keys while deriving message list OPE key. Returning null blobish"),r[92]="Got null keys while deriving message list OPE key. Returning null blobish",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoUtils] ","",r[92]].join("")),r[91]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoUtils",r[92],r[91],t.i64.cast([0,3]))},function(e){return r[90]=void 0}]):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[88],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[91]=t[0],r[92]=t[1],t})},function(e){return r[90]=r[91]}])},function(e){return r[83]=r[90]}]):t.sequence([function(e){return t.i64.eq(r[62],t.i64.cast([0,2]))?t.sequence([function(e){return r[87]=t.createArray(),r[92]=(r[87].push(t.i64.cast([0,32])),r[87]),t.nativeOperation(n("LSGetBlobFromString.nop"),["thread_ope_key","_",r[74]].join("")).then(function(e){var t;return t=e,r[88]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),r[88],void 0,r[30],r[87]).then(function(e){var t;return t=e,r[89]=t[0],t})},function(e){return r[89]?r[90]=!1:r[90]=!0,r[90]?t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoUtils] Got null keys while deriving message list OPE key. Returning null blobish"),r[93]="Got null keys while deriving message list OPE key. Returning null blobish",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoUtils] ","",r[93]].join("")),r[92]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoUtils",r[93],r[92],t.i64.cast([0,3]))},function(e){return r[91]=void 0}]):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[89],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[92]=t[0],r[93]=t[1],t})},function(e){return r[91]=r[92]}])},function(e){return r[86]=r[91]}]):t.resolve(r[86]=void 0)},function(e){return r[83]=r[86]}])},function(e){var o;return t.blobs.neq(r[83],void 0)?t.sequence([function(e){return r[86]=r[75].get("epoch_keys"),r[87]=r[86].get("epoch_anon_id"),r[88]=r[86].get("epoch_root_key"),r[89]=t.createArray(),r[104]=(r[89].push(t.i64.cast([0,32])),r[89]),t.i64.ge(r[48],t.i64.cast([0,3]))?t.resolve(r[90]=void 0):t.sequence([function(e){return t.nativeOperation(n("LSGetBlobFromString.nop"),r[73]).then(function(e){var t;return t=e,r[104]=t[0],t})},function(e){return r[90]=r[104]}])},function(e){return t.i64.ge(r[48],t.i64.cast([0,4]))?(r[104]="_",r[91]=["message_key_in_epoch",r[104],t.blobs.to_string(r[87]),r[104],"cipher_version",r[104],t.i64.to_string(r[48]),r[104],"thread",r[104],r[73]==null?"":r[73]].join("")):(t.i64.ge(r[48],t.i64.cast([0,3]))?(r[105]="_",r[104]=["message_key_in_epoch",r[105],t.blobs.to_string(r[87]),r[105],"cipher_version",r[105],t.i64.to_string(r[48]),r[105],"thread",r[105],r[73]==null?"":r[73]].join("")):(t.i64.ge(r[48],t.i64.cast([0,2]))?(r[106]="_",r[105]=["message_key_in_epoch",r[106],t.blobs.to_string(r[87]),r[106],"cipher_version",r[106],t.i64.to_string(r[48])].join("")):r[105]=["message_key_in_epoch","_",t.blobs.to_string(r[87])].join(""),r[104]=r[105]),r[91]=r[104]),t.nativeOperation(n("LSGetBlobFromString.nop"),r[91]).then(function(e){var t;return t=e,r[92]=t[0],t})},function(e){return t.nativeOperation(n("LSCreateDerivedKeys.nop"),r[92],r[90],r[88],r[89]).then(function(e){var t;return t=e,r[93]=t[0],t})},function(e){return r[93]?r[94]=!1:r[94]=!0,r[94]?t.resolve(r[95]=void 0):t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[93],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[104]=t[0],r[105]=t[1],t})},function(e){return r[95]=r[104]}])},function(e){return t.filter(t.db.table(169).fetch(),function(e){return t.blobs.eq(e.epochAnonIdBlob,t.blob("MA=="))}).next().then(function(e,n){var o,a,i=e.done,l=e.value;return i?(r[104]=new t.Map,r[104].set("error_msg","Expected a nonempty query result"),r[104].set("code",t.i64.cast([0,3])),r[104].set("src_line","MEBEpochClientUtils.php:556 MEBEpochClientUtils::maybeEpochWithAnonIDFromPersistentEpochsTableDirectly()"),r[105]=t.createArray(),r[106]=(r[105].push(r[104]),r[105]),o=[void 0,r[105]],r[96]=o[0],r[97]=o[1]):(n=l.item,r[104]=new t.Map,r[104].set("epoch_id",n.epochId),r[104].set("backup_id",n.backupId),r[104].set("epoch_anon_id_blob",n.epochAnonIdBlob),r[104].set("epoch_root_key_blob",n.epochRootKeyBlob),r[104].set("epoch_status",n.epochStatus),r[104].set("epoch_head",n.epochHead),r[104].set("authority_level",n.authorityLevel),a=[r[104],void 0],r[96]=a[0],r[97]=a[1])})},function(e){return r[99]=new t.Map,r[99].set("value",r[96]),r[99].set("errors",r[97]),r[100]=r[99].get("value"),r[100]!==void 0?t.sequence([function(e){return r[104]=r[100].get("epoch_id"),r[105]=r[100].get("backup_id"),r[106]=r[100].get("epoch_anon_id_blob"),r[107]=r[100].get("epoch_root_key_blob"),r[108]=r[100].get("epoch_status"),r[109]=r[100].get("epoch_head"),r[110]=r[100].get("authority_level"),r[111]=t.createArray(),r[119]=(r[111].push(t.i64.cast([0,32])),r[111]),t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleT5zYWx0X21haWxib3hfcm9vdF9rZXlfdjI="),void 0,r[30],r[111]).then(function(e){var t;return t=e,r[112]=t[0],t})},function(e){return r[112]!==void 0?t.sequence([function(e){return r[119]=t.i64.of_int32(r[112].length),t.i64.ge(r[119],t.i64.cast([0,1]))?t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[112],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[121]=t[0],r[122]=t[1],t})},function(e){return r[120]=r[121]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),r[122]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoUtils] ","",r[122]].join("")),r[121]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoUtils",r[122],r[121],t.i64.cast([0,3]))},function(e){return r[120]=void 0}])},function(e){return r[113]=r[120]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),r[120]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoUtils] ","",r[120]].join("")),r[119]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoUtils",r[120],r[119],t.i64.cast([0,3]))},function(e){return r[113]=void 0}])},function(e){return t.blobs.neq(r[113],void 0)?r[114]=!0:r[114]=!1,r[114]||((function(e){t.logger(e).mustfix(e)})("LS::assert is failed. Attempting to coerce a null value to nonnull."),t.throw("LS::assert is failed. Attempting to coerce a null value to nonnull.")),r[115]=t.createArray(),r[119]=(r[115].push(t.i64.cast([0,32])),r[115]),t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleT5tYWlsYm94X3Jvb3Rfa2V5X3Yy"),r[113],r[107],r[115]).then(function(e){var t;return t=e,r[116]=t[0],t})},function(e){return r[116]!==void 0?t.sequence([function(e){return r[119]=t.i64.of_int32(r[116].length),t.i64.ge(r[119],t.i64.cast([0,1]))?t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[116],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[121]=t[0],r[122]=t[1],t})},function(e){return r[120]=r[121]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),r[122]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoUtils] ","",r[122]].join("")),r[121]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoUtils",r[122],r[121],t.i64.cast([0,3]))},function(e){return r[120]=void 0}])},function(e){return r[117]=r[120]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),r[120]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoUtils] ","",r[120]].join("")),r[119]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoUtils",r[120],r[119],t.i64.cast([0,3]))},function(e){return r[117]=void 0}])},function(e){return t.blobs.neq(r[117],void 0)?r[118]=!0:r[118]=!1,r[118]||((function(e){t.logger(e).mustfix(e)})("LS::assert is failed. Attempting to coerce a null value to nonnull."),t.throw("LS::assert is failed. Attempting to coerce a null value to nonnull.")),r[101]=r[117]}]):t.sequence([function(e){return r[104]=r[99].get("errors"),r[105]=r[99].get("errors"),(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBEpochClientUtils] Failed to get mailbox_root_key_v2: epoch 0 is not available."),r[107]="Failed to get mailbox_root_key_v2: epoch 0 is not available.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBEpochClientUtils] ","",r[107]].join("")),r[106]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBEpochClientUtils",r[107],r[106],t.i64.cast([0,3]))},function(e){return r[101]=void 0}])},function(e){var o;return t.blobs.neq(r[95],void 0)?t.sequence([function(e){return t.blobs.neq(r[101],void 0)?t.sequence([function(e){return r[110]=t.createArray(),r[114]=(r[110].push(t.i64.cast([0,32])),r[110]),t.nativeOperation(n("LSCreateDerivedKeys.nop"),t.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleV92Mj5mYWxsYmFja19rZXk="),void 0,r[101],r[110]).then(function(e){var t;return t=e,r[111]=t[0],t})},function(e){return r[111]!==void 0?t.sequence([function(e){return r[114]=t.i64.of_int32(r[111].length),t.i64.ge(r[114],t.i64.cast([0,1]))?t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[111],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[116]=t[0],r[117]=t[1],t})},function(e){return r[115]=r[116]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),r[117]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoUtils] ","",r[117]].join("")),r[116]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoUtils",r[117],r[116],t.i64.cast([0,3]))},function(e){return r[115]=void 0}])},function(e){return r[112]=r[115]}]):t.sequence([function(e){return(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),r[115]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][MEBCryptoUtils] ","",r[115]].join("")),r[114]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"MEBCryptoUtils",r[115],r[114],t.i64.cast([0,3]))},function(e){return r[112]=void 0}])},function(e){return t.blobs.neq(r[112],void 0)?r[113]=!0:r[113]=!1,r[113]||((function(e){t.logger(e).mustfix(e)})("LS::assert is failed. Attempting to coerce a null value to nonnull."),t.throw("LS::assert is failed. Attempting to coerce a null value to nonnull.")),r[104]=r[112]}]):t.resolve(r[104]=void 0)},function(e){var n;return r[105]=r[86].get("epoch_root_key"),r[106]=r[86].get("epoch_anon_id"),r[107]=r[86].get("epoch_id"),r[108]=new t.Map,r[108].set("payload_key",r[95]),r[108].set("payload_fallback_key",r[104]),r[108].set("encryption_version",r[48]),r[108].set("epoch_root_key",r[105]),r[108].set("epoch_anon_id",r[106]),r[108].set("epoch_id",r[107]),r[109]=new t.Map,r[109].set("ope_key",r[83]),r[109].set("message_payload_encryption_keys",r[108]),r[109].set("ocmf_shared_key",r[31]),r[109].set("mailbox_base_salt",r[30]),r[109].set("mailbox_root_key_v2",r[101]),n=[r[109],void 0],r[102]=n[0],r[103]=n[1]}]):t.resolve((r[104]=new t.Map,r[104].set("error_code",t.i64.cast([0,26])),r[104].set("stored_procedure","MEBKeyDeriver"),r[104].set("error_message",""),o=[void 0,r[104]],r[102]=o[0],r[103]=o[1]))},function(e){var t;return t=[r[102],r[103]],r[84]=t[0],r[85]=t[1],t}]):t.resolve((r[86]=new t.Map,r[86].set("error_code",t.i64.cast([0,25])),r[86].set("stored_procedure","MEBKeyDeriver"),r[86].set("error_message",""),o=[void 0,r[86]],r[84]=o[0],r[85]=o[1]))},function(e){var t;return t=[r[84],r[85]],r[77]=t[0],r[78]=t[1],t}]):t.resolve((o=[void 0,r[76]],r[77]=o[0],r[78]=o[1],o))},function(o){return r[77]!==void 0?t.sequence([function(e){return r[83]=r[55].get("backup_id"),r[84]=r[55].get("act_thread_id"),r[85]=r[55].get("timestamp"),r[86]=r[55].get("otid"),t.storedProcedure(n("LSEncryptIdentifiersV2"),r[62],r[63],r[83],r[84],t.i64.from_string(r[85]),r[86],r[77]).then(function(e){var t;return t=e,r[87]=t[0],r[88]=t[1],t})},function(o){return r[87]!==void 0?t.sequence([function(o){return r[93]=r[55].get("act_thread_id"),t.storedProcedure(n("LSLoadAndEncryptProtobufV2"),e[0],r[77],r[93]).then(function(e){var t;return t=e,r[94]=t[0],r[95]=t[1],t})},function(o){return r[100]=t.i64.eq(r[64],t.i64.cast([0,32]))||!1||!0,r[101]=r[94]!==void 0,r[100]&&r[101]?t.sequence([function(e){return r[102]=r[55].get("act_thread_id"),r[103]=r[55].get("backup_id"),t.storedProcedure(n("LSDeriveValueSecretRefV2"),r[102],r[103],r[77]).then(function(e){var t;return t=e,r[104]=t[0],r[105]=t[1],t})},function(o){return r[94]!==void 0?t.sequence([function(o){return r[104]!==void 0?t.sequence([function(e){return r[114]=r[104].get("value_secret_ref"),r[115]=r[87].get("act_thread_id_ocmf_partial"),r[116]=r[87].get("otid_ocmf_partial"),r[117]=r[87].get("timestamp_encrypted"),r[118]=new t.Map,r[118].set("list_key",r[115]),r[118].set("unique_key",r[116]),r[118].set("sort_key",r[117]),r[119]=void 0,r[120]=new t.Map,r[120].set("list_item_id",r[118]),r[120].set("list_item",r[119]),r[120].set("action_type",r[62]),r[121]=r[55].get("timestamp"),r[122]=r[55].get("otid"),r[123]=r[55].get("act_thread_id"),r[124]=r[55].get("supplemental_otid"),r[125]=r[55].get("deletion_otid"),r[126]=new t.Map,r[126].set("timestamp",r[121]),r[126].set("otid",r[122]),r[126].set("wa_thread_id",t.i64.from_string(r[123])),r[126].set("supplemental_otid",r[124]),r[126].set("deletion_otid",r[125]),r[127]=r[77].get("mailbox_base_salt"),t.nativeOperation(n("LSBase64Encode.nop"),r[127]).then(function(e){var t;return t=e,r[128]=t[0],t})},function(e){return r[129]=r[77].get("ocmf_shared_key"),t.nativeOperation(n("LSBase64Encode.nop"),r[129]).then(function(e){var t;return t=e,r[130]=t[0],t})},function(e){return r[131]=new t.Map,r[131].set("mailbox_root_key",r[128]==null?"":r[128]),r[131].set("ocmf_client_state_blob",r[130]==null?"":r[130]),r[132]=r[87].get("backup_id_ocmf_partial"),r[133]=r[77].get("message_payload_encryption_keys"),r[134]=r[133].get("epoch_id"),r[135]=r[77].get("message_payload_encryption_keys"),r[136]=r[135].get("encryption_version"),r[151]=r[69]==null?"":r[69],r[137]=new t.Map,r[137].set("mailbox_partial_id",r[132]),r[137].set("action",r[120]),r[137].set("device_id",r[35]),r[137].set("echo_version",t.i64.cast([0,0])),r[137].set("epoch_id",r[134]),r[137].set("trace_id",void 0),r[137].set("encryption_version",r[136]),r[137].set("is_thread",t.i64.eq(r[63],t.i64.cast([0,2]))),r[137].set("raw_identifiers",r[126]),r[137].set("raw_tokens",r[131]),r[137].set("request_id",r[151]),r[137].set("tam_thread_subtype",r[70]==null?t.i64.cast([0,0]):r[70]),r[137].set("is_instamadillo",r[71]==null?!1:r[71]),r[137].set("should_run_device_creation_timestamp_sync",r[65]),r[137].set("value_secret_ref",r[114]),r[137].set("empty_echo_payload_reason",t.i64.cast([0,1])),r[94]!==void 0?t.sequence([function(e){return r[152]=r[94].get("supplemental_data_encrypted"),r[152]!==void 0?t.sequence([function(e){return r[154]=r[94].get("protobuf_encrypted"),r[155]=r[94].get("backup_action"),r[156]=r[94].get("timestamp_ms"),r[157]=r[152].get("sk_ciphertext"),t.nativeOperation(n("LSBase64Encode.nop"),r[157]).then(function(e){var t;return t=e,r[158]=t[0],t})},function(e){return r[159]=r[152].get("sk_hash"),t.nativeOperation(n("LSBase64Encode.nop"),r[159]).then(function(e){var t;return t=e,r[160]=t[0],t})},function(e){return r[161]=r[94].get("message_tags"),r[162]=r[94].get("maybe_ooo_supplemental_upload"),r[163]=new t.Map,r[163].set("supplementary_data_key",void 0),r[163].set("encrypted_protobuf",r[154]),r[163].set("key_value_backup_action",r[155]),r[163].set("protobuf_ts_ms",r[156]),r[163].set("supplemental_key_ciphertext",r[158]),r[163].set("supplemental_key_hash",r[160]),r[163].set("message_tags",r[161]),r[163].set("maybe_ooo_supplemental_upload",r[162]),r[153]=r[163]}]):t.resolve((r[154]=r[94].get("protobuf_encrypted"),r[155]=r[94].get("backup_action"),r[156]=r[94].get("timestamp_ms"),r[157]=r[94].get("message_tags"),r[158]=new t.Map,r[158].set("supplementary_data_key",void 0),r[158].set("encrypted_protobuf",r[154]),r[158].set("key_value_backup_action",r[155]),r[158].set("protobuf_ts_ms",r[156]),r[158].set("message_tags",r[157]),r[153]=r[158]))},function(e){return r[137].set("key_value_backup_payload",r[153])}]):t.resolve()},function(e){return r[66]!==void 0?t.resolve(r[137].set("attachment_backup_payload",r[66])):((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure] attachment_payload is null."),r[152]=["payload_null",".",t.i64.to_string(r[72])==null?"null":t.i64.to_string(r[72])].join(""),r[6]!==void 0&&r[152]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,637746317]),r[6],"attachment_info",r[152]):t.resolve())},function(e){return r[151]!==void 0?t.nativeOperation(n("LSLogWebQpl.nop"),r[151],t.i64.cast([0,521481602]),"upload_start",t.i64.cast([0,0]),void 0,void 0):t.resolve()},function(n){return r[138]=t.toJSON(r[137]),t.db.table(2).fetch([[[e[0]]]]).next().then(function(n,o){var a,i,l=n.done,s=n.value;return l?(r[152]=t.i64.of_float(Date.now()),t.i64.eq(r[67],t.i64.cast([0,0]))||t.i64.eq(r[67],void 0)?r[153]=void 0:r[153]=r[67],a=[e[0],void 0,void 0,void 0,void 0,t.i64.sub(t.i64.mul(r[152],t.i64.cast([0,1e6])),r[19]),r[153]],r[139]=a[0],r[140]=a[1],r[141]=a[2],r[142]=a[3],r[143]=a[4],r[144]=a[5],r[145]=a[6]):(o=s.item,r[152]=t.i64.of_float(Date.now()),t.i64.eq(r[67],t.i64.cast([0,0]))||t.i64.eq(r[67],void 0)?r[153]=void 0:r[153]=r[67],i=[e[0],o.queueName,o.enqueueTimestampMs,void 0,o.firstExecutedTimestampMs,t.i64.sub(t.i64.mul(r[152],t.i64.cast([0,1e6])),r[19]),r[153]],r[139]=i[0],r[140]=i[1],r[141]=i[2],r[142]=i[3],r[143]=i[4],r[144]=i[5],r[145]=i[6])})},function(e){return r[147]=new t.Map,r[147].set("task_id",r[139]),r[147].set("queue_name",r[140]),r[147].set("enqueue_timestamp_ms",r[141]),r[147].set("priority",r[142]),r[147].set("first_executed_timestamp_ms",r[143]),r[147].set("execution_time_ns",r[144]),r[147].set("echo_encoding_execution_time_ns",r[145]),r[148]=new t.Map,r[148].set("task_metadata",r[147]),r[148].set("action_type",r[62]),r[148].set("content_type",r[63]),r[148].set("identifiers",void 0),r[148].set("identifiers_v2",r[55]),r[148].set("task_creation_source",void 0),r[148].set("message_payload_source",t.i64.cast([0,2])),t.resolve()},function(e){return t.resolve()},function(e){return r[6]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,637746317]),r[6],!0):t.resolve()},function(e){var n;return r[149]=new t.Map,r[149].set("payload",r[138]),r[150]=t.createArray(),r[152]=(r[150].push(void 0),r[150]),n=[r[149],void 0,r[148],r[150]],r[110]=n[0],r[111]=n[1],r[112]=n[2],r[113]=n[3]}]):t.sequence([function(n){return t.db.table(2).fetch([[[e[0]]]]).next().then(function(n,o){var a,i,l=n.done,s=n.value;return l?(r[125]=t.i64.of_float(Date.now()),t.i64.eq(r[67],t.i64.cast([0,0]))||t.i64.eq(r[67],void 0)?r[126]=void 0:r[126]=r[67],a=[e[0],void 0,void 0,void 0,void 0,t.i64.sub(t.i64.mul(r[125],t.i64.cast([0,1e6])),r[19]),r[126]],r[114]=a[0],r[115]=a[1],r[116]=a[2],r[117]=a[3],r[118]=a[4],r[119]=a[5],r[120]=a[6]):(o=s.item,r[125]=t.i64.of_float(Date.now()),t.i64.eq(r[67],t.i64.cast([0,0]))||t.i64.eq(r[67],void 0)?r[126]=void 0:r[126]=r[67],i=[e[0],o.queueName,o.enqueueTimestampMs,void 0,o.firstExecutedTimestampMs,t.i64.sub(t.i64.mul(r[125],t.i64.cast([0,1e6])),r[19]),r[126]],r[114]=i[0],r[115]=i[1],r[116]=i[2],r[117]=i[3],r[118]=i[4],r[119]=i[5],r[120]=i[6])})},function(e){return r[122]=new t.Map,r[122].set("task_id",r[114]),r[122].set("queue_name",r[115]),r[122].set("enqueue_timestamp_ms",r[116]),r[122].set("priority",r[117]),r[122].set("first_executed_timestamp_ms",r[118]),r[122].set("execution_time_ns",r[119]),r[122].set("echo_encoding_execution_time_ns",r[120]),r[123]=new t.Map,r[123].set("task_metadata",r[122]),r[123].set("action_type",r[62]),r[123].set("content_type",r[63]),r[123].set("identifiers",void 0),r[123].set("identifiers_v2",r[55]),r[123].set("task_creation_source",void 0),r[123].set("message_payload_source",t.i64.cast([0,2])),r[105]!==void 0?(r[125]=r[105].get("stored_procedure"),r[126]=r[105].get("error_code"),r[127]=r[105].get("error_message"),r[128]=".",r[129]=[r[125],r[128],t.i64.to_string(r[126]),r[128],r[127]].join(""),r[6]!==void 0&&r[129]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,637746317]),r[6],"exception_error",r[129]):t.resolve()):t.resolve()},function(e){return t.resolve()},function(e){return r[6]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,637746317]),r[6],!1):t.resolve()},function(e){var n;return r[124]=t.createArray(),r[125]=(r[124].push(void 0),r[124]),n=[void 0,r[105],r[123],r[124]],r[110]=n[0],r[111]=n[1],r[112]=n[2],r[113]=n[3]}])},function(e){var t;return t=[r[110],r[111],r[112],r[113]],r[106]=t[0],r[107]=t[1],r[108]=t[2],r[109]=t[3],t}]):t.sequence([function(n){return t.db.table(2).fetch([[[e[0]]]]).next().then(function(n,o){var a,i,l=n.done,s=n.value;return l?(r[121]=t.i64.of_float(Date.now()),t.i64.eq(r[67],t.i64.cast([0,0]))||t.i64.eq(r[67],void 0)?r[122]=void 0:r[122]=r[67],a=[e[0],void 0,void 0,void 0,void 0,t.i64.sub(t.i64.mul(r[121],t.i64.cast([0,1e6])),r[19]),r[122]],r[110]=a[0],r[111]=a[1],r[112]=a[2],r[113]=a[3],r[114]=a[4],r[115]=a[5],r[116]=a[6]):(o=s.item,r[121]=t.i64.of_float(Date.now()),t.i64.eq(r[67],t.i64.cast([0,0]))||t.i64.eq(r[67],void 0)?r[122]=void 0:r[122]=r[67],i=[e[0],o.queueName,o.enqueueTimestampMs,void 0,o.firstExecutedTimestampMs,t.i64.sub(t.i64.mul(r[121],t.i64.cast([0,1e6])),r[19]),r[122]],r[110]=i[0],r[111]=i[1],r[112]=i[2],r[113]=i[3],r[114]=i[4],r[115]=i[5],r[116]=i[6])})},function(e){return r[118]=new t.Map,r[118].set("task_id",r[110]),r[118].set("queue_name",r[111]),r[118].set("enqueue_timestamp_ms",r[112]),r[118].set("priority",r[113]),r[118].set("first_executed_timestamp_ms",r[114]),r[118].set("execution_time_ns",r[115]),r[118].set("echo_encoding_execution_time_ns",r[116]),r[119]=new t.Map,r[119].set("task_metadata",r[118]),r[119].set("action_type",r[62]),r[119].set("content_type",r[63]),r[119].set("identifiers",void 0),r[119].set("identifiers_v2",r[55]),r[119].set("task_creation_source",void 0),r[119].set("message_payload_source",t.i64.cast([0,2])),t.resolve()},function(e){return r[95]!==void 0?(r[121]=r[95].get("stored_procedure"),r[122]=r[95].get("error_code"),r[123]=r[95].get("error_message"),r[124]=".",r[125]=[r[121],r[124],t.i64.to_string(r[122]),r[124],r[123]].join(""),r[6]!==void 0&&r[125]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,637746317]),r[6],"exception_error",r[125]):t.resolve()):t.resolve()},function(e){return r[6]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,637746317]),r[6],!1):t.resolve()},function(e){var n;return r[120]=t.createArray(),r[121]=(r[120].push(r[95]),r[120]),n=[void 0,void 0,r[119],r[120]],r[106]=n[0],r[107]=n[1],r[108]=n[2],r[109]=n[3]}])},function(e){var t;return t=[r[106],r[107],r[108],r[109]],r[96]=t[0],r[97]=t[1],r[98]=t[2],r[99]=t[3],t}]):t.sequence([function(o){return r[100]===!0&&r[101]===!1?t.sequence([function(n){return t.db.table(2).fetch([[[e[0]]]]).next().then(function(n,o){var a,i,l=n.done,s=n.value;return l?(r[117]=t.i64.of_float(Date.now()),t.i64.eq(r[67],t.i64.cast([0,0]))||t.i64.eq(r[67],void 0)?r[118]=void 0:r[118]=r[67],a=[e[0],void 0,void 0,void 0,void 0,t.i64.sub(t.i64.mul(r[117],t.i64.cast([0,1e6])),r[19]),r[118]],r[106]=a[0],r[107]=a[1],r[108]=a[2],r[109]=a[3],r[110]=a[4],r[111]=a[5],r[112]=a[6]):(o=s.item,r[117]=t.i64.of_float(Date.now()),t.i64.eq(r[67],t.i64.cast([0,0]))||t.i64.eq(r[67],void 0)?r[118]=void 0:r[118]=r[67],i=[e[0],o.queueName,o.enqueueTimestampMs,void 0,o.firstExecutedTimestampMs,t.i64.sub(t.i64.mul(r[117],t.i64.cast([0,1e6])),r[19]),r[118]],r[106]=i[0],r[107]=i[1],r[108]=i[2],r[109]=i[3],r[110]=i[4],r[111]=i[5],r[112]=i[6])})},function(e){return r[114]=new t.Map,r[114].set("task_id",r[106]),r[114].set("queue_name",r[107]),r[114].set("enqueue_timestamp_ms",r[108]),r[114].set("priority",r[109]),r[114].set("first_executed_timestamp_ms",r[110]),r[114].set("execution_time_ns",r[111]),r[114].set("echo_encoding_execution_time_ns",r[112]),r[115]=new t.Map,r[115].set("task_metadata",r[114]),r[115].set("action_type",r[62]),r[115].set("content_type",r[63]),r[115].set("identifiers",void 0),r[115].set("identifiers_v2",r[55]),r[115].set("task_creation_source",void 0),r[115].set("message_payload_source",t.i64.cast([0,2])),t.resolve()},function(e){return r[95]!==void 0?(r[117]=r[95].get("stored_procedure"),r[118]=r[95].get("error_code"),r[119]=r[95].get("error_message"),r[120]=".",r[121]=[r[117],r[120],t.i64.to_string(r[118]),r[120],r[119]].join(""),r[6]!==void 0&&r[121]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,637746317]),r[6],"exception_error",r[121]):t.resolve()):t.resolve()},function(e){return r[6]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,637746317]),r[6],!1):t.resolve()},function(e){var n;return r[116]=t.createArray(),r[117]=(r[116].push(r[95]),r[116]),n=[void 0,void 0,r[115],r[116]],r[102]=n[0],r[103]=n[1],r[104]=n[2],r[105]=n[3]}]):t.sequence([function(o){var a,i,l,s;return t.i64.eq(r[62],t.i64.cast([0,1]))?(r[114]=r[68]===""?void 0:r[68],r[114]!==void 0?(a=[r[114],void 0],r[112]=a[0],r[113]=a[1]):(r[115]=new t.Map,r[115].set("error_code",t.i64.cast([0,30])),r[115].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),r[115].set("error_message",""),i=[void 0,r[115]],r[112]=i[0],r[113]=i[1]),l=[r[112],r[113]],r[106]=l[0],r[107]=l[1]):(s=["",void 0],r[106]=s[0],r[107]=s[1]),r[106]!==void 0?t.sequence([function(e){var o;return t.i64.eq(r[62],t.i64.cast([0,1]))?t.sequence([function(e){return r[118]=r[55].get("backup_id"),r[119]=r[55].get("act_thread_id"),t.storedProcedure(n("LSEncryptMessagePayloadV2"),r[118],r[119],r[77],r[106]).then(function(e){var t;return t=e,r[120]=t[0],r[121]=t[1],t})},function(e){var t;return t=[r[120],r[121]],r[112]=t[0],r[113]=t[1],t}]):t.resolve((r[118]=new t.Map,r[118].set("encrypted_message_payload",""),r[118].set("value_secret_ref",""),o=[r[118],void 0],r[112]=o[0],r[113]=o[1]))},function(o){return r[112]!==void 0?t.sequence([function(e){return r[94]!==void 0&&t.i64.eq(r[62],t.i64.cast([0,2]))?t.sequence([function(e){return r[156]=r[55].get("act_thread_id"),r[157]=r[55].get("backup_id"),t.storedProcedure(n("LSDeriveValueSecretRefV2"),r[156],r[157],r[77]).then(function(e){var t;return t=e,r[158]=t[0],r[159]=t[1],t})},function(e){return r[158]!==void 0?(r[161]=r[158].get("value_secret_ref"),r[160]=r[161]):r[160]="",r[118]=r[160]}]):t.resolve(r[118]="")},function(e){return r[119]=r[87].get("act_thread_id_ocmf_partial"),r[120]=r[87].get("otid_ocmf_partial"),r[121]=r[87].get("timestamp_encrypted"),r[122]=new t.Map,r[122].set("list_key",r[119]),r[122].set("unique_key",r[120]),r[122].set("sort_key",r[121]),r[112]!==void 0?(r[156]=r[112].get("encrypted_message_payload"),r[157]=r[112].get("value_secret_ref"),r[158]=new t.Map,r[158].set("value",r[156]),r[158].set("value_secret_ref",r[157]),r[123]=r[158]):r[123]=void 0,r[124]=new t.Map,r[124].set("list_item_id",r[122]),r[124].set("list_item",r[123]),r[124].set("action_type",r[62]),r[125]=r[55].get("timestamp"),r[126]=r[55].get("otid"),r[127]=r[55].get("act_thread_id"),r[128]=r[55].get("supplemental_otid"),r[129]=r[55].get("deletion_otid"),r[130]=new t.Map,r[130].set("timestamp",r[125]),r[130].set("otid",r[126]),r[130].set("wa_thread_id",t.i64.from_string(r[127])),r[130].set("supplemental_otid",r[128]),r[130].set("deletion_otid",r[129]),r[131]=r[77].get("mailbox_base_salt"),t.nativeOperation(n("LSBase64Encode.nop"),r[131]).then(function(e){var t;return t=e,r[132]=t[0],t})},function(e){return r[133]=r[77].get("ocmf_shared_key"),t.nativeOperation(n("LSBase64Encode.nop"),r[133]).then(function(e){var t;return t=e,r[134]=t[0],t})},function(e){return r[135]=new t.Map,r[135].set("mailbox_root_key",r[132]==null?"":r[132]),r[135].set("ocmf_client_state_blob",r[134]==null?"":r[134]),r[136]=r[87].get("backup_id_ocmf_partial"),r[137]=r[77].get("message_payload_encryption_keys"),r[138]=r[137].get("epoch_id"),r[139]=r[77].get("message_payload_encryption_keys"),r[140]=r[139].get("encryption_version"),r[155]=r[69]==null?"":r[69],r[141]=new t.Map,r[141].set("mailbox_partial_id",r[136]),r[141].set("action",r[124]),r[141].set("device_id",r[35]),r[141].set("echo_version",t.i64.cast([0,0])),r[141].set("epoch_id",r[138]),r[141].set("trace_id",void 0),r[141].set("encryption_version",r[140]),r[141].set("is_thread",t.i64.eq(r[63],t.i64.cast([0,2]))),r[141].set("raw_identifiers",r[130]),r[141].set("raw_tokens",r[135]),r[141].set("request_id",r[155]),r[141].set("tam_thread_subtype",r[70]==null?t.i64.cast([0,0]):r[70]),r[141].set("is_instamadillo",r[71]==null?!1:r[71]),r[141].set("should_run_device_creation_timestamp_sync",r[65]),r[141].set("value_secret_ref",r[118]),r[94]!==void 0?t.sequence([function(e){return r[156]=r[94].get("supplemental_data_encrypted"),r[156]!==void 0?t.sequence([function(e){return r[158]=r[94].get("protobuf_encrypted"),r[159]=r[94].get("backup_action"),r[160]=r[94].get("timestamp_ms"),r[161]=r[156].get("sk_ciphertext"),t.nativeOperation(n("LSBase64Encode.nop"),r[161]).then(function(e){var t;return t=e,r[162]=t[0],t})},function(e){return r[163]=r[156].get("sk_hash"),t.nativeOperation(n("LSBase64Encode.nop"),r[163]).then(function(e){var t;return t=e,r[164]=t[0],t})},function(e){return r[165]=r[94].get("message_tags"),r[166]=r[94].get("maybe_ooo_supplemental_upload"),r[167]=new t.Map,r[167].set("supplementary_data_key",void 0),r[167].set("encrypted_protobuf",r[158]),r[167].set("key_value_backup_action",r[159]),r[167].set("protobuf_ts_ms",r[160]),r[167].set("supplemental_key_ciphertext",r[162]),r[167].set("supplemental_key_hash",r[164]),r[167].set("message_tags",r[165]),r[167].set("maybe_ooo_supplemental_upload",r[166]),r[157]=r[167]}]):t.resolve((r[158]=r[94].get("protobuf_encrypted"),r[159]=r[94].get("backup_action"),r[160]=r[94].get("timestamp_ms"),r[161]=r[94].get("message_tags"),r[162]=new t.Map,r[162].set("supplementary_data_key",void 0),r[162].set("encrypted_protobuf",r[158]),r[162].set("key_value_backup_action",r[159]),r[162].set("protobuf_ts_ms",r[160]),r[162].set("message_tags",r[161]),r[157]=r[162]))},function(e){return r[141].set("key_value_backup_payload",r[157])}]):t.resolve()},function(e){return r[66]!==void 0?t.resolve(r[141].set("attachment_backup_payload",r[66])):((function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure] attachment_payload is null."),r[156]=["payload_null",".",t.i64.to_string(r[72])==null?"null":t.i64.to_string(r[72])].join(""),r[6]!==void 0&&r[156]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,637746317]),r[6],"attachment_info",r[156]):t.resolve())},function(e){return r[155]!==void 0?t.nativeOperation(n("LSLogWebQpl.nop"),r[155],t.i64.cast([0,521481602]),"upload_start",t.i64.cast([0,0]),void 0,void 0):t.resolve()},function(n){return r[142]=t.toJSON(r[141]),t.db.table(2).fetch([[[e[0]]]]).next().then(function(n,o){var a,i,l=n.done,s=n.value;return l?(r[156]=t.i64.of_float(Date.now()),t.i64.eq(r[67],t.i64.cast([0,0]))||t.i64.eq(r[67],void 0)?r[157]=void 0:r[157]=r[67],a=[e[0],void 0,void 0,void 0,void 0,t.i64.sub(t.i64.mul(r[156],t.i64.cast([0,1e6])),r[19]),r[157]],r[143]=a[0],r[144]=a[1],r[145]=a[2],r[146]=a[3],r[147]=a[4],r[148]=a[5],r[149]=a[6]):(o=s.item,r[156]=t.i64.of_float(Date.now()),t.i64.eq(r[67],t.i64.cast([0,0]))||t.i64.eq(r[67],void 0)?r[157]=void 0:r[157]=r[67],i=[e[0],o.queueName,o.enqueueTimestampMs,void 0,o.firstExecutedTimestampMs,t.i64.sub(t.i64.mul(r[156],t.i64.cast([0,1e6])),r[19]),r[157]],r[143]=i[0],r[144]=i[1],r[145]=i[2],r[146]=i[3],r[147]=i[4],r[148]=i[5],r[149]=i[6])})},function(e){return r[151]=new t.Map,r[151].set("task_id",r[143]),r[151].set("queue_name",r[144]),r[151].set("enqueue_timestamp_ms",r[145]),r[151].set("priority",r[146]),r[151].set("first_executed_timestamp_ms",r[147]),r[151].set("execution_time_ns",r[148]),r[151].set("echo_encoding_execution_time_ns",r[149]),r[152]=new t.Map,r[152].set("task_metadata",r[151]),r[152].set("action_type",r[62]),r[152].set("content_type",r[63]),r[152].set("identifiers",void 0),r[152].set("identifiers_v2",r[55]),r[152].set("task_creation_source",void 0),r[152].set("message_payload_source",t.i64.cast([0,2])),t.resolve()},function(e){return r[95]!==void 0?(r[156]=r[95].get("stored_procedure"),r[157]=r[95].get("error_code"),r[158]=r[95].get("error_message"),r[159]=".",r[160]=[r[156],r[159],t.i64.to_string(r[157]),r[159],r[158]].join(""),r[6]!==void 0&&r[160]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,637746317]),r[6],"exception_error",r[160]):t.resolve()):t.resolve()},function(e){return r[6]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,637746317]),r[6],!0):t.resolve()},function(e){var n;return r[153]=new t.Map,r[153].set("payload",r[142]),r[154]=t.createArray(),r[156]=(r[154].push(r[95]),r[154]),n=[r[153],void 0,r[152],r[154]],r[114]=n[0],r[115]=n[1],r[116]=n[2],r[117]=n[3]}]):t.sequence([function(n){return t.db.table(2).fetch([[[e[0]]]]).next().then(function(n,o){var a,i,l=n.done,s=n.value;return l?(r[129]=t.i64.of_float(Date.now()),t.i64.eq(r[67],t.i64.cast([0,0]))||t.i64.eq(r[67],void 0)?r[130]=void 0:r[130]=r[67],a=[e[0],void 0,void 0,void 0,void 0,t.i64.sub(t.i64.mul(r[129],t.i64.cast([0,1e6])),r[19]),r[130]],r[118]=a[0],r[119]=a[1],r[120]=a[2],r[121]=a[3],r[122]=a[4],r[123]=a[5],r[124]=a[6]):(o=s.item,r[129]=t.i64.of_float(Date.now()),t.i64.eq(r[67],t.i64.cast([0,0]))||t.i64.eq(r[67],void 0)?r[130]=void 0:r[130]=r[67],i=[e[0],o.queueName,o.enqueueTimestampMs,void 0,o.firstExecutedTimestampMs,t.i64.sub(t.i64.mul(r[129],t.i64.cast([0,1e6])),r[19]),r[130]],r[118]=i[0],r[119]=i[1],r[120]=i[2],r[121]=i[3],r[122]=i[4],r[123]=i[5],r[124]=i[6])})},function(e){return r[126]=new t.Map,r[126].set("task_id",r[118]),r[126].set("queue_name",r[119]),r[126].set("enqueue_timestamp_ms",r[120]),r[126].set("priority",r[121]),r[126].set("first_executed_timestamp_ms",r[122]),r[126].set("execution_time_ns",r[123]),r[126].set("echo_encoding_execution_time_ns",r[124]),r[127]=new t.Map,r[127].set("task_metadata",r[126]),r[127].set("action_type",r[62]),r[127].set("content_type",r[63]),r[127].set("identifiers",void 0),r[127].set("identifiers_v2",r[55]),r[127].set("task_creation_source",void 0),r[127].set("message_payload_source",t.i64.cast([0,2])),r[113]!==void 0?(r[129]=r[113].get("stored_procedure"),r[130]=r[113].get("error_code"),r[131]=r[113].get("error_message"),r[132]=".",r[133]=[r[129],r[132],t.i64.to_string(r[130]),r[132],r[131]].join(""),r[6]!==void 0&&r[133]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,637746317]),r[6],"exception_error",r[133]):t.resolve()):t.resolve()},function(e){return r[95]!==void 0?(r[129]=r[95].get("stored_procedure"),r[130]=r[95].get("error_code"),r[131]=r[95].get("error_message"),r[132]=".",r[133]=[r[129],r[132],t.i64.to_string(r[130]),r[132],r[131]].join(""),r[6]!==void 0&&r[133]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,637746317]),r[6],"exception_error",r[133]):t.resolve()):t.resolve()},function(e){return r[6]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,637746317]),r[6],!1):t.resolve()},function(e){var n;return r[128]=t.createArray(),r[129]=(r[128].push(r[95]),r[128]),n=[void 0,r[113],r[127],r[128]],r[114]=n[0],r[115]=n[1],r[116]=n[2],r[117]=n[3]}])},function(e){var t;return t=[r[114],r[115],r[116],r[117]],r[108]=t[0],r[109]=t[1],r[110]=t[2],r[111]=t[3],t}]):t.sequence([function(n){return t.db.table(2).fetch([[[e[0]]]]).next().then(function(n,o){var a,i,l=n.done,s=n.value;return l?(r[123]=t.i64.of_float(Date.now()),t.i64.eq(r[67],t.i64.cast([0,0]))||t.i64.eq(r[67],void 0)?r[124]=void 0:r[124]=r[67],a=[e[0],void 0,void 0,void 0,void 0,t.i64.sub(t.i64.mul(r[123],t.i64.cast([0,1e6])),r[19]),r[124]],r[112]=a[0],r[113]=a[1],r[114]=a[2],r[115]=a[3],r[116]=a[4],r[117]=a[5],r[118]=a[6]):(o=s.item,r[123]=t.i64.of_float(Date.now()),t.i64.eq(r[67],t.i64.cast([0,0]))||t.i64.eq(r[67],void 0)?r[124]=void 0:r[124]=r[67],i=[e[0],o.queueName,o.enqueueTimestampMs,void 0,o.firstExecutedTimestampMs,t.i64.sub(t.i64.mul(r[123],t.i64.cast([0,1e6])),r[19]),r[124]],r[112]=i[0],r[113]=i[1],r[114]=i[2],r[115]=i[3],r[116]=i[4],r[117]=i[5],r[118]=i[6])})},function(e){return r[120]=new t.Map,r[120].set("task_id",r[112]),r[120].set("queue_name",r[113]),r[120].set("enqueue_timestamp_ms",r[114]),r[120].set("priority",r[115]),r[120].set("first_executed_timestamp_ms",r[116]),r[120].set("execution_time_ns",r[117]),r[120].set("echo_encoding_execution_time_ns",r[118]),r[121]=new t.Map,r[121].set("task_metadata",r[120]),r[121].set("action_type",r[62]),r[121].set("content_type",r[63]),r[121].set("identifiers",void 0),r[121].set("identifiers_v2",r[55]),r[121].set("task_creation_source",void 0),r[121].set("message_payload_source",t.i64.cast([0,2])),r[107]!==void 0?(r[123]=r[107].get("stored_procedure"),r[124]=r[107].get("error_code"),r[125]=r[107].get("error_message"),r[126]=".",r[127]=[r[123],r[126],t.i64.to_string(r[124]),r[126],r[125]].join(""),r[6]!==void 0&&r[127]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,637746317]),r[6],"exception_error",r[127]):t.resolve()):t.resolve()},function(e){return r[95]!==void 0?(r[123]=r[95].get("stored_procedure"),r[124]=r[95].get("error_code"),r[125]=r[95].get("error_message"),r[126]=".",r[127]=[r[123],r[126],t.i64.to_string(r[124]),r[126],r[125]].join(""),r[6]!==void 0&&r[127]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,637746317]),r[6],"exception_error",r[127]):t.resolve()):t.resolve()},function(e){return r[6]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,637746317]),r[6],!1):t.resolve()},function(e){var n;return r[122]=t.createArray(),r[123]=(r[122].push(r[95]),r[122]),n=[void 0,r[107],r[121],r[122]],r[108]=n[0],r[109]=n[1],r[110]=n[2],r[111]=n[3]}])},function(e){var t;return t=[r[108],r[109],r[110],r[111]],r[102]=t[0],r[103]=t[1],r[104]=t[2],r[105]=t[3],t}])},function(e){var t;return t=[r[102],r[103],r[104],r[105]],r[96]=t[0],r[97]=t[1],r[98]=t[2],r[99]=t[3],t}])},function(e){var t;return t=[r[96],r[97],r[98],r[99]],r[89]=t[0],r[90]=t[1],r[91]=t[2],r[92]=t[3],t}]):t.sequence([function(n){return t.db.table(2).fetch([[[e[0]]]]).next().then(function(n,o){var a,i,l=n.done,s=n.value;return l?(r[104]=t.i64.of_float(Date.now()),t.i64.eq(r[67],t.i64.cast([0,0]))||t.i64.eq(r[67],void 0)?r[105]=void 0:r[105]=r[67],a=[e[0],void 0,void 0,void 0,void 0,t.i64.sub(t.i64.mul(r[104],t.i64.cast([0,1e6])),r[19]),r[105]],r[93]=a[0],r[94]=a[1],r[95]=a[2],r[96]=a[3],r[97]=a[4],r[98]=a[5],r[99]=a[6]):(o=s.item,r[104]=t.i64.of_float(Date.now()),t.i64.eq(r[67],t.i64.cast([0,0]))||t.i64.eq(r[67],void 0)?r[105]=void 0:r[105]=r[67],i=[e[0],o.queueName,o.enqueueTimestampMs,void 0,o.firstExecutedTimestampMs,t.i64.sub(t.i64.mul(r[104],t.i64.cast([0,1e6])),r[19]),r[105]],r[93]=i[0],r[94]=i[1],r[95]=i[2],r[96]=i[3],r[97]=i[4],r[98]=i[5],r[99]=i[6])})},function(e){return r[101]=new t.Map,r[101].set("task_id",r[93]),r[101].set("queue_name",r[94]),r[101].set("enqueue_timestamp_ms",r[95]),r[101].set("priority",r[96]),r[101].set("first_executed_timestamp_ms",r[97]),r[101].set("execution_time_ns",r[98]),r[101].set("echo_encoding_execution_time_ns",r[99]),r[102]=new t.Map,r[102].set("task_metadata",r[101]),r[102].set("action_type",r[62]),r[102].set("content_type",r[63]),r[102].set("identifiers",void 0),r[102].set("identifiers_v2",r[55]),r[102].set("task_creation_source",void 0),r[102].set("message_payload_source",t.i64.cast([0,2])),r[88]!==void 0?(r[104]=r[88].get("stored_procedure"),r[105]=r[88].get("error_code"),r[106]=r[88].get("error_message"),r[107]=".",r[108]=[r[104],r[107],t.i64.to_string(r[105]),r[107],r[106]].join(""),r[6]!==void 0&&r[108]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,637746317]),r[6],"exception_error",r[108]):t.resolve()):t.resolve()},function(e){return t.resolve()},function(e){return r[6]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,637746317]),r[6],!1):t.resolve()},function(e){var n;return r[103]=t.createArray(),r[104]=(r[103].push(void 0),r[103]),n=[void 0,r[88],r[102],r[103]],r[89]=n[0],r[90]=n[1],r[91]=n[2],r[92]=n[3]}])},function(e){var t;return t=[r[89],r[90],r[91],r[92]],r[79]=t[0],r[80]=t[1],r[81]=t[2],r[82]=t[3],t}]):t.sequence([function(n){return t.db.table(2).fetch([[[e[0]]]]).next().then(function(n,o){var a,i,l=n.done,s=n.value;return l?(r[94]=t.i64.of_float(Date.now()),t.i64.eq(r[67],t.i64.cast([0,0]))||t.i64.eq(r[67],void 0)?r[95]=void 0:r[95]=r[67],a=[e[0],void 0,void 0,void 0,void 0,t.i64.sub(t.i64.mul(r[94],t.i64.cast([0,1e6])),r[19]),r[95]],r[83]=a[0],r[84]=a[1],r[85]=a[2],r[86]=a[3],r[87]=a[4],r[88]=a[5],r[89]=a[6]):(o=s.item,r[94]=t.i64.of_float(Date.now()),t.i64.eq(r[67],t.i64.cast([0,0]))||t.i64.eq(r[67],void 0)?r[95]=void 0:r[95]=r[67],i=[e[0],o.queueName,o.enqueueTimestampMs,void 0,o.firstExecutedTimestampMs,t.i64.sub(t.i64.mul(r[94],t.i64.cast([0,1e6])),r[19]),r[95]],r[83]=i[0],r[84]=i[1],r[85]=i[2],r[86]=i[3],r[87]=i[4],r[88]=i[5],r[89]=i[6])})},function(e){return r[91]=new t.Map,r[91].set("task_id",r[83]),r[91].set("queue_name",r[84]),r[91].set("enqueue_timestamp_ms",r[85]),r[91].set("priority",r[86]),r[91].set("first_executed_timestamp_ms",r[87]),r[91].set("execution_time_ns",r[88]),r[91].set("echo_encoding_execution_time_ns",r[89]),r[92]=new t.Map,r[92].set("task_metadata",r[91]),r[92].set("action_type",r[62]),r[92].set("content_type",r[63]),r[92].set("identifiers",void 0),r[92].set("identifiers_v2",r[55]),r[92].set("task_creation_source",void 0),r[92].set("message_payload_source",t.i64.cast([0,2])),r[78]!==void 0?(r[94]=r[78].get("stored_procedure"),r[95]=r[78].get("error_code"),r[96]=r[78].get("error_message"),r[97]=".",r[98]=[r[94],r[97],t.i64.to_string(r[95]),r[97],r[96]].join(""),r[6]!==void 0&&r[98]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,637746317]),r[6],"exception_error",r[98]):t.resolve()):t.resolve()},function(e){return t.resolve()},function(e){return r[6]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,637746317]),r[6],!1):t.resolve()},function(e){var n;return r[93]=t.createArray(),r[94]=(r[93].push(void 0),r[93]),n=[void 0,r[78],r[92],r[93]],r[79]=n[0],r[80]=n[1],r[81]=n[2],r[82]=n[3]}])},function(e){var t;return t=[r[79],r[80],r[81],r[82]],r[58]=t[0],r[59]=t[1],r[60]=t[2],r[61]=t[3],t}]):t.sequence([function(n){return t.db.table(2).fetch([[[e[0]]]]).next().then(function(n,o){var a,i,l=n.done,s=n.value;return l?(r[85]=t.i64.of_float(Date.now()),t.i64.eq(r[67],t.i64.cast([0,0]))||t.i64.eq(r[67],void 0)?r[86]=void 0:r[86]=r[67],a=[e[0],void 0,void 0,void 0,void 0,t.i64.sub(t.i64.mul(r[85],t.i64.cast([0,1e6])),r[19]),r[86]],r[73]=a[0],r[74]=a[1],r[75]=a[2],r[76]=a[3],r[77]=a[4],r[78]=a[5],r[79]=a[6]):(o=s.item,r[85]=t.i64.of_float(Date.now()),t.i64.eq(r[67],t.i64.cast([0,0]))||t.i64.eq(r[67],void 0)?r[86]=void 0:r[86]=r[67],i=[e[0],o.queueName,o.enqueueTimestampMs,void 0,o.firstExecutedTimestampMs,t.i64.sub(t.i64.mul(r[85],t.i64.cast([0,1e6])),r[19]),r[86]],r[73]=i[0],r[74]=i[1],r[75]=i[2],r[76]=i[3],r[77]=i[4],r[78]=i[5],r[79]=i[6])})},function(e){return r[81]=new t.Map,r[81].set("task_id",r[73]),r[81].set("queue_name",r[74]),r[81].set("enqueue_timestamp_ms",r[75]),r[81].set("priority",r[76]),r[81].set("first_executed_timestamp_ms",r[77]),r[81].set("execution_time_ns",r[78]),r[81].set("echo_encoding_execution_time_ns",r[79]),r[82]=new t.Map,r[82].set("task_metadata",r[81]),r[82].set("action_type",r[62]),r[82].set("content_type",r[63]),r[82].set("identifiers",void 0),r[82].set("identifiers_v2",r[55]),r[82].set("task_creation_source",void 0),r[82].set("message_payload_source",t.i64.cast([0,2])),r[83]=new t.Map,r[83].set("error_code",r[64]),r[83].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),r[83].set("error_message",""),r[83]!==void 0?(r[85]=r[83].get("stored_procedure"),r[86]=r[83].get("error_code"),r[87]=r[83].get("error_message"),r[88]=".",r[89]=[r[85],r[88],t.i64.to_string(r[86]),r[88],r[87]].join(""),r[6]!==void 0&&r[89]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,637746317]),r[6],"exception_error",r[89]):t.resolve()):t.resolve()},function(e){return t.resolve()},function(e){return r[6]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,637746317]),r[6],!1):t.resolve()},function(e){var n;return r[84]=t.createArray(),n=[void 0,r[83],r[82],r[84]],r[58]=n[0],r[59]=n[1],r[60]=n[2],r[61]=n[3]}])},function(e){var t;return t=[r[58],r[59],r[60],r[61]],r[50]=t[0],r[51]=t[1],r[52]=t[2],r[53]=t[3],t}]))})},function(e){var t;return t=[r[50],r[51],r[52],r[53]],r[42]=t[0],r[43]=t[1],r[44]=t[2],r[45]=t[3],t}]):t.sequence([function(n){return t.db.table(2).fetch([[[e[0]]]]).next().then(function(n,o){var a,i,l=n.done,s=n.value;return l?(r[58]=t.i64.of_float(Date.now()),a=[e[0],void 0,void 0,void 0,void 0,t.i64.sub(t.i64.mul(r[58],t.i64.cast([0,1e6])),r[19]),void 0],r[46]=a[0],r[47]=a[1],r[48]=a[2],r[49]=a[3],r[50]=a[4],r[51]=a[5],r[52]=a[6]):(o=s.item,r[58]=t.i64.of_float(Date.now()),i=[e[0],o.queueName,o.enqueueTimestampMs,void 0,o.firstExecutedTimestampMs,t.i64.sub(t.i64.mul(r[58],t.i64.cast([0,1e6])),r[19]),void 0],r[46]=i[0],r[47]=i[1],r[48]=i[2],r[49]=i[3],r[50]=i[4],r[51]=i[5],r[52]=i[6])})},function(e){return r[54]=new t.Map,r[54].set("task_id",r[46]),r[54].set("queue_name",r[47]),r[54].set("enqueue_timestamp_ms",r[48]),r[54].set("priority",r[49]),r[54].set("first_executed_timestamp_ms",r[50]),r[54].set("execution_time_ns",r[51]),r[54].set("echo_encoding_execution_time_ns",r[52]),r[55]=new t.Map,r[55].set("task_metadata",r[54]),r[55].set("action_type",void 0),r[55].set("content_type",void 0),r[55].set("identifiers",void 0),r[55].set("identifiers_v2",void 0),r[55].set("task_creation_source",void 0),r[55].set("message_payload_source",t.i64.cast([0,2])),r[56]=new t.Map,r[56].set("error_code",t.i64.cast([0,24])),r[56].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),r[56].set("error_message",""),r[56]!==void 0?(r[58]=r[56].get("stored_procedure"),r[59]=r[56].get("error_code"),r[60]=r[56].get("error_message"),r[61]=".",r[62]=[r[58],r[61],t.i64.to_string(r[59]),r[61],r[60]].join(""),r[6]!==void 0&&r[62]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,637746317]),r[6],"exception_error",r[62]):t.resolve()):t.resolve()},function(e){return t.resolve()},function(e){return r[6]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,637746317]),r[6],!1):t.resolve()},function(e){var n;return r[57]=t.createArray(),n=[void 0,r[56],r[55],r[57]],r[42]=n[0],r[43]=n[1],r[44]=n[2],r[45]=n[3]}])},function(e){var t;return t=[r[42],r[43],r[44],r[45]],r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=t[3],t}]):t.sequence([function(n){return r[23]=r[10].get("errors"),r[24]=r[10].get("errors"),t.db.table(2).fetch([[[e[0]]]]).next().then(function(n,o){var a,i,l=n.done,s=n.value;return l?(r[37]=t.i64.of_float(Date.now()),a=[e[0],void 0,void 0,void 0,void 0,t.i64.sub(t.i64.mul(r[37],t.i64.cast([0,1e6])),r[19]),void 0],r[25]=a[0],r[26]=a[1],r[27]=a[2],r[28]=a[3],r[29]=a[4],r[30]=a[5],r[31]=a[6]):(o=s.item,r[37]=t.i64.of_float(Date.now()),i=[e[0],o.queueName,o.enqueueTimestampMs,void 0,o.firstExecutedTimestampMs,t.i64.sub(t.i64.mul(r[37],t.i64.cast([0,1e6])),r[19]),void 0],r[25]=i[0],r[26]=i[1],r[27]=i[2],r[28]=i[3],r[29]=i[4],r[30]=i[5],r[31]=i[6])})},function(e){return r[33]=new t.Map,r[33].set("task_id",r[25]),r[33].set("queue_name",r[26]),r[33].set("enqueue_timestamp_ms",r[27]),r[33].set("priority",r[28]),r[33].set("first_executed_timestamp_ms",r[29]),r[33].set("execution_time_ns",r[30]),r[33].set("echo_encoding_execution_time_ns",r[31]),r[34]=new t.Map,r[34].set("task_metadata",r[33]),r[34].set("action_type",void 0),r[34].set("content_type",void 0),r[34].set("identifiers",void 0),r[34].set("identifiers_v2",void 0),r[34].set("task_creation_source",void 0),r[34].set("message_payload_source",t.i64.cast([0,2])),r[35]=new t.Map,r[35].set("error_code",t.i64.cast([0,1])),r[35].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),r[35].set("error_message",""),r[35]!==void 0?(r[37]=r[35].get("stored_procedure"),r[38]=r[35].get("error_code"),r[39]=r[35].get("error_message"),r[40]=".",r[41]=[r[37],r[40],t.i64.to_string(r[38]),r[40],r[39]].join(""),r[6]!==void 0&&r[41]!==void 0?t.nativeOperation(n("LSQplAnnotateString.nop"),t.i64.cast([0,637746317]),r[6],"exception_error",r[41]):t.resolve()):t.resolve()},function(e){return t.resolve()},function(e){return r[6]!==void 0?t.nativeOperation(n("LSQplMarkEnd.nop"),t.i64.cast([0,637746317]),r[6],!1):t.resolve()},function(e){var n;return r[36]=t.createArray(),n=[void 0,r[35],r[34],r[36]],r[12]=n[0],r[13]=n[1],r[14]=n[2],r[15]=n[3]}])},function(e){return r[16]=t.i64.of_float(Date.now()),r[17]=t.i64.random(),r[20]="Finishing execution. Execution time: ",r[21]=t.i64.to_string(t.i64.sub(r[16],r[0])),r[22]=" ms",r[18]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][serializeBackupPayloadV2] ",r[18],r[20],r[18],r[21],r[18],r[22]].join("")),t.i64.eq(t.i64.mod_(r[17],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[23]=",",r[24]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"serializeBackupPayloadV2",[r[20],r[23],r[21],r[23],r[22]].join(""),r[24],t.i64.cast([0,4]))):t.resolve()},function(e){var t;return t=[r[12],r[13],r[14],r[15]],o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure",e.__tables__=["pending_tasks","secure_encrypted_backups_client_state","pending_backups_context_v2","pending_protobuf_backups_context","secure_encrypted_backups_epochs"],a.exports=e}),null);
__d("LSTaskSerializerEncryptedBackupsUpload",["LSArrayGetObjectAt","LSLogMebClientEvent.nop","LSSerializeBackupPayloadV2"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(n){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][taskSerializerEncryptedBackupsUpload] Beginning execution."),r[1]=t.i64.of_float(Date.now()),t.forEach(t.db.table(177).fetch([[[e[0]]],"fk_pending_tasks"]),function(e){var n=e.update,r=e.item;return n({backupStatus:t.i64.cast([0,2])})})},function(o){return t.storedProcedure(n("LSSerializeBackupPayloadV2"),e[0]).then(function(e){var t;return t=e,r[2]=t[0],r[3]=t[1],r[4]=t[2],r[5]=t[3],t})},function(e){return r[6]=t.createArray(),r[7]=t.i64.of_int32(r[5].length),t.i64.gt(r[7],t.i64.cast([0,0]))?t.loopAsync(r[7],function(e){return r[23]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[5],r[23]).then(function(e){var t;return t=e,r[24]=t[0],r[25]=t[1],t})},function(e){return r[24]!==void 0?r[26]=(r[6].push(r[24]),r[6]):0}])}):t.resolve()},function(e){return r[8]=t.i64.of_int32(r[6].length),t.i64.gt(r[8],t.i64.cast([0,0]))?t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[6],t.i64.cast([0,0])).then(function(e){var t;return t=e,r[23]=t[0],r[24]=t[1],t})},function(e){return r[9]=r[23]}]):t.resolve(r[9]=void 0)},function(e){var o,a,i,l;return r[2]?r[10]=!1:r[10]=!0,r[10]?(r[3]?r[23]=!1:r[23]=!0,r[23]?(i=[void 0,void 0,r[9],r[6],r[4]],r[24]=i[0],r[25]=i[1],r[26]=i[2],r[27]=i[3],r[28]=i[4]):(a=[void 0,r[3],r[9],r[6],r[4]],r[24]=a[0],r[25]=a[1],r[26]=a[2],r[27]=a[3],r[28]=a[4]),l=[r[24],r[25],r[26],r[27],r[28]],r[11]=l[0],r[12]=l[1],r[13]=l[2],r[14]=l[3],r[15]=l[4]):(r[23]=r[2].get("payload"),o=[r[23],r[3],r[9],r[6],r[4]],r[11]=o[0],r[12]=o[1],r[13]=o[2],r[14]=o[3],r[15]=o[4]),r[23]=new t.Map,r[24]=r[23].set("success",r[11]),r[25]=r[23].set("failure",r[12]),r[26]=r[23].set("protobuf_failure",r[13]),r[27]=r[23].set("protobuf_failures",r[14]),r[28]=r[23].set("context",r[15]),r[29]=t.toJSON(r[23]),r[16]=r[29],r[17]=t.i64.of_float(Date.now()),r[18]=t.i64.random(),r[20]="Finishing execution. Execution time: ",r[21]=t.i64.to_string(t.i64.sub(r[17],r[0])),r[22]=" ms",r[19]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][taskSerializerEncryptedBackupsUpload] ",r[19],r[20],r[19],r[21],r[19],r[22]].join("")),t.i64.eq(t.i64.mod_(r[18],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[23]=",",r[24]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"taskSerializerEncryptedBackupsUpload",[r[20],r[23],r[21],r[23],r[22]].join(""),r[24],t.i64.cast([0,4]))):t.resolve()},function(e){var n;return n=[r[16],t.i64.cast([0,50026])],o[0]=n[0],o[1]=n[1],n}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsUploadStoredProcedure",e.__tables__=["pending_backups_context_v2"],a.exports=e}),null);
__d("LSTaskSerializerEncryptedBackupsUploadProtobufOnly",[],(function(t,n,r,o,a,i){function e(){var e,t=arguments,n=t[t.length-1],r=[],o=[];return r[0]=new n.Map,r[0].set("error_code",n.i64.cast([0,802])),r[0].set("stored_procedure","LSEncryptedBackupsTaskSerializerEncryptedBackupsUploadProtobufOnlyStoredProcedure"),r[0].set("error_message",""),r[2]=new n.Map,r[3]=r[2].set("success",void 0),r[4]=r[2].set("failure",r[0]),r[5]=r[2].set("context",void 0),r[6]=n.toJSON(r[2]),r[1]=r[6],e=[r[1],n.i64.cast([0,50042]),void 0],o[0]=e[0],o[1]=e[1],o[2]=e[2],n.resolve(o)}e.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsUploadProtobufOnlyStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSTaskSerializerEncryptedBackupsUploadSenderBackup",["LSLogMebClientEvent.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(e){return t.sequence([function(e){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][taskSerializerEncryptedBackupsUploadSenderBackup] Beginning execution."),r[1]=t.i64.of_float(Date.now()),(function(e){t.logger(e).mustfix(e)})("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsUploadSenderBackupStoredProcedure] LSEncryptedBackupsMinosEncrypt native op not supported"),r[3]="LSEncryptedBackupsMinosEncrypt native op not supported",(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsUploadSenderBackupStoredProcedure] ","",r[3]].join("")),r[2]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsTaskSerializerEncryptedBackupsUploadSenderBackupStoredProcedure",r[3],r[2],t.i64.cast([0,3]))},function(e){return r[4]=new t.Map,r[4].set("error_code",t.i64.cast([0,3])),r[4].set("stored_procedure","taskSerializerEncryptedBackupsUploadSenderBackup"),r[4].set("error_message",""),r[12]=new t.Map,r[13]=r[12].set("success",void 0),r[14]=r[12].set("failure",r[4]),r[15]=r[12].set("context",void 0),r[16]=t.toJSON(r[12]),r[5]=r[16],r[6]=t.i64.of_float(Date.now()),r[7]=t.i64.random(),r[9]="Finishing execution. Execution time: ",r[10]=t.i64.to_string(t.i64.sub(r[6],r[0])),r[11]=" ms",r[8]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][taskSerializerEncryptedBackupsUploadSenderBackup] ",r[8],r[9],r[8],r[10],r[8],r[11]].join("")),t.i64.eq(t.i64.mod_(r[7],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[12]=",",r[13]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"taskSerializerEncryptedBackupsUploadSenderBackup",[r[9],r[12],r[10],r[12],r[11]].join(""),r[13],t.i64.cast([0,4]))):t.resolve()},function(e){var n;return n=[r[5],t.i64.cast([0,50057]),void 0],o[0]=n[0],o[1]=n[1],o[2]=n[2],n}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsUploadSenderBackupStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSTaskSerializerMuteThreadV2",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(o){return t.sequence([function(r){return t.db.table(32).fetch([[[e[0]]]]).next().then(function(r,o){var a,i=r.done,l=r.value;return i?(n[4]=t.createArray(),n[5]=(n[4].push("TaskSerializerMuteThreadV2: Task ID not found"),n[4]),n[6]=(n[4].push(e[0]),n[4]),n[7]=t.toJSON(n[4]),(function(e){t.logger(e).mustfix(e)})(n[7]),a=[void 0,void 0,void 0],n[0]=a[0],n[1]=a[1],n[2]=a[2]):(o=l.item,t.sequence([function(e){return n[8]=o.threadKey,t.db.table(9).fetch([[[n[8]]]]).next().then(function(e,r){var o,a=e.done,i=e.value;return a?(n[9]=t.createArray(),n[10]=(n[9].push("TaskSerializerMuteThreadV2: Thread not found"),n[9]),n[11]=(n[9].push(n[8]),n[9]),n[12]=t.toJSON(n[9]),(function(e){t.logger(e).mustfix(e)})(n[12]),o=[void 0,void 0,void 0],n[4]=o[0],n[5]=o[1],n[6]=o[2]):(r=i.item,t.sequence([function(e){return t.db.table(9).fetch([[[n[8]]]]).next().then(function(e,r){var o=e.done,a=e.value;return o?n[9]=t.i64.cast([0,1]):(r=a.item,n[14]=r.syncGroup,t.i64.neq(n[14],void 0)?n[13]=n[14]:n[13]=t.i64.cast([0,1]),n[9]=n[13])})},function(e){var o;return n[11]=new t.Map,n[11].set("thread_key",n[8]),n[11].set("mailbox_type",t.i64.cast([0,0])),n[11].set("mute_expire_time_ms",r.muteExpireTimeMs),n[11].set("sync_group",n[9]),n[12]=t.toJSON(n[11]),o=[n[12],t.i64.cast([0,144]),void 0],n[4]=o[0],n[5]=o[1],n[6]=o[2]}]))})},function(e){var t;return t=[n[4],n[5],n[6]],n[0]=t[0],n[1]=t[1],n[2]=t[2],t}]))})},function(e){var t;return t=[n[0],n[1]],r[0]=t[0],r[1]=t[1],t}])},function(e){return t.resolve(r)}])}e.__sproc_name__="LSMailboxTaskSerializerMuteThreadV2StoredProcedure",e.__tables__=["threads_optimistic_context","threads"],a.exports=e}),null);
__d("LSTaskSerializerRemoveThread",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(o){return t.sequence([function(r){return t.db.table(32).fetch([[[e[0]]]]).next().then(function(r,o){var a,i,l,s,u=r.done,c=r.value;return u?(n[4]=t.createArray(),n[5]=(n[4].push("TaskSerializerRemoveThreadV2: Task ID not found"),n[4]),n[6]=(n[4].push(e[0]),n[4]),n[7]=t.toJSON(n[4]),(function(e){t.logger(e).mustfix(e)})(n[7]),a=[void 0,void 0,void 0],n[0]=a[0],n[1]=a[1],n[2]=a[2]):(o=c.item,n[7]=o.removeType,t.i64.neq(n[7],void 0)?(n[8]=new t.Map,n[8].set("thread_key",o.threadKey),n[8].set("remove_type",n[7]),n[8].set("sync_group",o.syncGroup==null?t.i64.cast([0,1]):o.syncGroup),n[9]=t.toJSON(n[8]),i=[n[9],t.i64.cast([0,146]),void 0],n[4]=i[0],n[5]=i[1],n[6]=i[2]):(l=[void 0,void 0,void 0],n[4]=l[0],n[5]=l[1],n[6]=l[2]),s=[n[4],n[5],n[6]],n[0]=s[0],n[1]=s[1],n[2]=s[2])})},function(e){var t;return t=[n[0],n[1]],r[0]=t[0],r[1]=t[1],t}])},function(e){return t.resolve(r)}])}e.__sproc_name__="LSMailboxTaskSerializerRemoveThreadStoredProcedure",e.__tables__=["threads_optimistic_context"],a.exports=e}),null);
__d("LSTaskSerializerSendMessageV2",["LSArrayGetObjectAt","LSDeserializeFromJsonIntoDictionaryV2.nop","LSSymmetricEncryptionCreateEncryptedString.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return t.db.table(31).fetch([[[e[0]]]]).next().then(function(o,a){var i,l=o.done,s=o.value;return l?(r[4]=t.createArray(),r[5]=(r[4].push("task ID not found"),r[4]),r[6]=(r[4].push(e[0]),r[4]),r[7]=t.toJSON(r[4]),(function(e){t.logger(e).mustfix(e)})(r[7]),i=[void 0,void 0,void 0],r[0]=i[0],r[1]=i[1],r[2]=i[2]):(a=s.item,t.sequence([function(o){return r[12]=a.offlineThreadingId,r[13]=a.messageId,r[11]=a.threadAttributionSource,r[9]=a.platformRef,r[10]=a.platformToken,r[8]=a.replySourceId,r[14]=a.replySourceType,r[23]=a.sendType,r[25]=a.markThreadRead,r[16]=a.initiatingSource,r[17]=a.skipUrlPreviewGen,r[19]=a.textHasLinks,r[20]=a.dataclassParams,r[21]=a.multitabEnv,r[22]=a.metadataDataclass,r[18]=a.richTextFormatType,r[24]=a.subthreadParentMessageId,r[15]=a.isExclusiveToSubthread,t.db.table(12).fetch([[[r[12]]],"optimistic"]).next().then(function(o,a){var i,l=o.done,s=o.value;return l?(r[26]=t.createArray(),r[27]=(r[26].push("OTID not found"),r[26]),r[28]=(r[26].push(r[12]),r[26]),r[29]=t.toJSON(r[26]),(function(e){t.logger(e).mustfix(e)})(r[29]),i=[void 0,void 0,void 0],r[4]=i[0],r[5]=i[1],r[6]=i[2]):(a=s.item,t.sequence([function(o){return r[34]=a.text,r[30]=a.threadKey,r[35]=a.messageId,r[43]=a.senderId,r[32]=a.stickerId,r[37]=a.mentionOffsets,r[38]=a.mentionLengths,r[31]=a.mentionIds,r[39]=a.mentionTypes,r[42]=a.replyType,r[40]=a.isForwarded,r[36]=a.forwardScore,r[41]=a.hotEmojiSize,r[33]=a.metadataDataclass,t.db.table(9).fetch([[[r[30]]]]).next().then(function(o,i){var l,s=o.done,u=o.value;return s?(r[44]=t.createArray(),r[45]=(r[44].push("thread not found"),r[44]),r[46]=(r[44].push(r[30]),r[44]),r[47]=t.toJSON(r[44]),(function(e){t.logger(e).mustfix(e)})(r[47]),l=[void 0,void 0,void 0],r[26]=l[0],r[27]=l[1],r[28]=l[2]):(i=u.item,t.sequence([function(n){return r[51]=i.threadName,r[49]=i.threadKey,r[52]=i.mailboxType,r[50]=i.threadType,r[53]=i.capabilities,r[54]=i.capabilities2,r[55]=i.capabilities3,r[56]=i.capabilities4,r[57]=i.capabilities5,t.db.table(2).fetch([[[e[0]]]]).next().then(function(n,o){var a=n.done,i=n.value;return a?r[44]=!1:(o=i.item,t.sequence([function(n){return t.islc(t.db.table(2).fetch([[[o.queueName]],"queueNameTaskId"]),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(n,o){var a=n.done,i=n.value;return a?r[58]=!1:(o=i.item,r[58]=t.i64.eq(o.taskId,e[0]))})},function(e){return r[44]=r[58]}]))})},function(e){return t.i64.eq(i.authorityLevel,t.i64.cast([0,20]))&&[t.i64.cast([0,2]),t.i64.cast([0,5]),t.i64.cast([0,205]),t.i64.cast([0,206]),t.i64.cast([0,26])].some(function(e){return t.i64.eq(r[50],e)})&&r[44]?t.sequence([function(e){return r[61]=r[23]==null?t.i64.cast([0,1]):r[23],t.db.table(9).fetch([[[r[30]]]]).next().then(function(e,n){var o=e.done,a=e.value;return o?r[58]=t.i64.cast([0,1]):(n=a.item,r[79]=n.syncGroup,t.i64.neq(r[79],void 0)?r[78]=r[79]:r[78]=t.i64.cast([0,1]),r[58]=r[78])})},function(e){return r[60]=new t.Map,r[60].set("thread_id",r[30]),r[60].set("otid",r[12]),r[60].set("source",r[11]==null?t.i64.cast([0,0]):r[11]),r[60].set("send_type",t.i64.cast([0,1])),r[60].set("sync_group",r[58]),r[60].set("mark_thread_read",r[25]),t.i64.eq(r[61],t.i64.cast([0,1]))?t.resolve(r[60].set("text",r[34])):t.i64.eq(r[61],t.i64.cast([0,2]))?(t.i64.neq(r[32],void 0)&&(r[60].set("sticker_id",r[32]),r[60].set("send_type",r[61])),r[33]!==void 0?t.sequence([function(e){return t.nativeOperation(n("LSDeserializeFromJsonIntoDictionaryV2.nop"),r[33]).then(function(e){var t;return t=e,r[78]=t[0],t})},function(e){return r[79]=new t.Map,r[80]=r[78].keys(),r[81]=t.i64.of_int32(r[80].length),t.i64.gt(r[81],t.i64.cast([0,0]))?t.loopAsync(r[81],function(e){return r[85]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[80],r[85]).then(function(e){var t;return t=e,r[86]=t[0],r[87]=t[1],t})},function(e){return r[88]=r[78].get(r[86]),r[79].set(r[86],r[88])}])}):t.resolve()},function(e){return r[82]=r[79].get("xma_music_sticker_message_metadata"),r[82]?r[83]=!1:r[83]=!0,r[83]?t.resolve(r[84]=void 0):t.sequence([function(e){return r[85]=new t.Map,r[86]=r[82].keys(),r[87]=t.i64.of_int32(r[86].length),t.i64.gt(r[87],t.i64.cast([0,0]))?t.loopAsync(r[87],function(e){return r[88]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[86],r[88]).then(function(e){var t;return t=e,r[89]=t[0],r[90]=t[1],t})},function(e){return r[91]=r[82].get(r[89]),r[85].set(r[89],r[91])}])}):t.resolve()},function(e){return r[84]=r[85]}])},function(e){return r[84]!==void 0?r[60].set("send_type",r[61]):0}]):t.resolve()):t.i64.eq(r[61],t.i64.cast([0,7]))?t.sequence([function(e){return t.db.table(16).fetch([[[r[30],r[35]]]]).next().then(function(e,t){var n,o,a=e.done,i=e.value;return a?(n=[void 0,void 0],r[78]=n[0],r[79]=n[1],n):(t=i.item,o=[t.filename,t.attributionAppId],r[78]=o[0],r[79]=o[1])})},function(e){return r[78]!==void 0&&t.i64.neq(r[79],void 0)?(r[60].set("url",r[78]),r[60].set("attribution_app_id",r[79]),r[60].set("send_type",r[61]),r[33]!==void 0?r[60].set("metadata_dataclass",r[33]):0):0}]):t.i64.eq(r[61],t.i64.cast([0,3]))?t.sequence([function(e){return r[60].set("text",r[34]),r[78]=t.createArray(),r[79]=t.createArray(),t.forEach(t.sortBy(t.db.table(16).fetch([[[r[30],r[35]]]]),[["attachmentIndex","ASC"]]),function(e){var n=e.item;return r[80]=n.offlineAttachmentId,r[81]=(r[78].push(t.i64.from_string(n.attachmentFbid)),r[78]),r[80]!==void 0?r[81]=(r[79].push(r[80]),r[79]):0})},function(e){return r[60].set("attachment_fbids",r[78]),t.i64.eq(r[61],t.i64.cast([0,9]))&&r[60].set("offline_attachment_ids",r[79]),r[60].set("send_type",r[61])}]):t.i64.eq(r[61],t.i64.cast([0,9]))?t.sequence([function(e){return r[60].set("text",r[34]),r[78]=t.createArray(),r[79]=t.createArray(),t.forEach(t.sortBy(t.db.table(16).fetch([[[r[30],r[35]]]]),[["attachmentIndex","ASC"]]),function(e){var n=e.item;return r[80]=n.offlineAttachmentId,r[81]=(r[78].push(t.i64.from_string(n.attachmentFbid)),r[78]),r[80]!==void 0?r[81]=(r[79].push(r[80]),r[79]):0})},function(e){return r[60].set("attachment_fbids",r[78]),t.i64.eq(r[61],t.i64.cast([0,9]))&&r[60].set("offline_attachment_ids",r[79]),r[60].set("send_type",r[61])}]):t.i64.eq(r[61],t.i64.cast([0,4]))?t.sequence([function(e){return t.db.table(16).fetch([[[r[30],r[35]]]]).next().then(function(e,t){var n=e.done,o=e.value;return n?r[78]=void 0:(t=o.item,r[78]=t.attachmentFbid)})},function(e){return t.db.table(16).fetch([[[r[30],r[35]]]]).next().then(function(e,t){var n=e.done,o=e.value;return n?r[80]=void 0:(t=o.item,r[80]=t.actionUrl)})},function(e){return r[78]!==void 0?(r[60].set("text",r[34]),r[80]!==void 0&&r[60].set("url",r[80]),r[60].set("forwarded_share_id",r[78]),r[60].set("send_type",r[61])):0}]):t.i64.eq(r[61],t.i64.cast([0,5]))?t.resolve(r[13]!==void 0?(r[60].set("forwarded_msg_id",r[13]),r[60].set("send_type",r[61]),t.i64.neq(r[36],void 0)&&r[60].set("forward_score",r[36]),r[60].set("strip_forwarded_msg_caption",!1)):0):t.i64.eq(r[61],t.i64.cast([0,6]))?t.sequence([function(e){return t.db.table(16).fetch([[[r[30],r[35]]]]).next().then(function(e,t){var n,o,a=e.done,i=e.value;return a?(n=[void 0,void 0],r[78]=n[0],r[79]=n[1],n):(t=i.item,o=[t.filename,t.attributionAppId],r[78]=o[0],r[79]=o[1])})},function(e){return r[78]!==void 0?(r[60].set("url",r[78]),r[60].set("text",r[34]),r[60].set("send_type",r[61])):0}]):t.i64.eq(r[61],t.i64.cast([0,11]))?t.sequence([function(e){return t.db.table(16).fetch([[[r[30],r[35]]]]).next().then(function(e,t){var n,o,a=e.done,i=e.value;return a?(n=[void 0,void 0],r[78]=n[0],r[79]=n[1],n):(t=i.item,o=[t.actionUrl,t.attributionAppId],r[78]=o[0],r[79]=o[1])})},function(e){return r[78]!==void 0?(r[60].set("url",r[78]),r[60].set("text",r[34]),r[60].set("send_type",r[61])):0}]):t.resolve(t.i64.eq(r[61],t.i64.cast([0,12]))?r[60].set("send_type",r[61]):0)},function(e){return r[73]=r[24]==null?void 0:r[24],r[72]=r[8]===""?void 0:r[8],r[72]!==void 0&&t.i64.neq(r[14],void 0)&&(r[78]=new t.Map,r[78].set("reply_source_id",r[72]),r[78].set("reply_source_type",r[14]),r[78].set("reply_type",r[42]==null?t.i64.cast([0,0]):r[42]),r[78].set("reply_source_attachment_id",void 0),r[60].set("reply_metadata",r[78])),r[73]!==void 0&&r[15]!==void 0&&(r[78]=new t.Map,r[78].set("subthread_parent_message_id",r[73]),r[78].set("is_exclusive_to_subthread",r[15]),r[60].set("subthread_data",r[78])),r[74]=r[31]===""?void 0:r[31],r[74]!==void 0&&(r[78]=r[37]===""?void 0:r[37],r[78]!==void 0&&(r[79]=r[38]===""?void 0:r[38],r[79]!==void 0&&(r[80]=new t.Map,r[80].set("mention_ids",r[74]),r[80].set("mention_offsets",r[78]),r[80].set("mention_lengths",r[79]),r[80].set("mention_types",r[39]===""?void 0:r[39]),r[60].set("mention_data",r[80])))),r[40]!==void 0&&r[60].set("is_forwarded",r[40]),r[75]=r[9]===""?void 0:r[9],r[75]!==void 0&&r[60].set("platform_ref",r[75]),r[76]=r[10]===""?void 0:r[10],r[76]!==void 0&&r[60].set("platform_token",r[76]),[t.i64.cast([0,1]),t.i64.cast([0,2])].some(function(e){return t.i64.eq(r[61],e)})&&t.i64.neq(r[41],void 0)&&r[60].set("hot_emoji_size",r[41]),t.i64.neq(r[16],void 0)&&r[60].set("initiating_source",r[16]),r[17]!==void 0&&r[60].set("skip_url_preview_gen",r[17]),t.i64.neq(r[18],void 0)&&r[60].set("rich_text_format_type",r[18]),t.resolve()},function(e){return r[19]!==void 0&&r[60].set("text_has_links",r[19]),r[20]!==void 0&&r[60].set("dataclass_params",r[20]),r[21]!==void 0&&r[60].set("multitab_env",r[21]),r[22]!==void 0&&r[60].set("metadata_dataclass",r[22]),t.filter(t.db.table(14).fetch([[[r[49],r[43]]]]),function(e){return t.i64.eq(e.threadKey,r[49])&&t.i64.eq(t.i64.cast([0,0]),r[52])&&t.i64.eq(e.contactId,r[43])}).next().then(function(e,n){var o=e.done,a=e.value;return o?r[62]=!1:(n=a.item,t.i64.eq(r[50],t.i64.cast([0,152]))?(r[79]=n.threadRoles,t.i64.lt(t.i64.cast([0,7]),t.i64.cast([0,0]))||t.i64.gt(t.i64.cast([0,7]),t.i64.cast([0,11]))?r[80]=!1:r[80]=!t.i64.eq(t.i64.and_(t.i64.lsl_(t.i64.cast([0,1]),t.i64.to_int32(t.i64.cast([0,7]))),r[79]),t.i64.cast([0,0])),r[81]=r[53],r[82]=r[54],r[83]=r[55],r[84]=r[56],r[85]=r[57],r[87]=t.i64.div(t.i64.cast([0,223]),t.i64.cast([0,64])),r[88]=t.i64.lsl_(t.i64.cast([0,1]),t.i64.to_int32(t.i64.sub(t.i64.cast([0,223]),t.i64.mul(r[87],t.i64.cast([0,64]))))),t.i64.lt(t.i64.cast([0,223]),t.i64.cast([0,0]))||t.i64.gt(t.i64.cast([0,223]),t.i64.cast([0,308]))?r[86]=!1:(t.i64.eq(r[87],t.i64.cast([0,0]))?r[89]=!t.i64.eq(t.i64.and_(r[88],r[81]),t.i64.cast([0,0])):(t.i64.eq(r[87],t.i64.cast([0,1]))?r[90]=!t.i64.eq(t.i64.and_(r[88],r[82]),t.i64.cast([0,0])):(t.i64.eq(r[87],t.i64.cast([0,2]))?r[91]=!t.i64.eq(t.i64.and_(r[88],r[83]),t.i64.cast([0,0])):(t.i64.eq(r[87],t.i64.cast([0,3]))?r[92]=!t.i64.eq(t.i64.and_(r[88],r[84]),t.i64.cast([0,0])):(t.i64.eq(r[87],t.i64.cast([0,4]))?r[93]=!t.i64.eq(t.i64.and_(r[88],r[85]),t.i64.cast([0,0])):r[93]=!1,r[92]=r[93]),r[91]=r[92]),r[90]=r[91]),r[89]=r[90]),r[86]=r[89]),r[80]!==r[86]&&((function(e){t.logger(e).mustfix(e)})("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting"),t.throw("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting")),r[78]=r[80]):r[78]=!1,r[62]=r[78])})},function(e){return r[62]&&r[60].set("perform_action_as_page",!0),r[64]=t.createArray(),t.forEach(t.db.table(14).fetch([[[r[30]]]]),function(e){var t=e.item;return r[78]=(r[64].push(t.contactId),r[64])})},function(e){return r[65]=new t.Map,r[65].set("participants",r[64]),r[65].set("send_payload",r[60]),r[51]!==void 0&&r[65].set("thread_name",r[51]),t.db.table(312).fetch([[[r[30]]]]).next().then(function(e,t){var n=e.done,o=e.value;return n?r[66]=void 0:(t=o.item,r[66]=t.metadata)})},function(e){return r[65].set("thread_metadata",r[66]),r[77]=r[11]==null?t.i64.cast([0,0]):r[11],t.i64.eq(r[77],t.i64.cast([0,393217]))?r[68]="broadcast_flow":(t.i64.eq(r[77],t.i64.cast([0,393216]))?r[78]="broadcast_flow":(t.i64.eq(r[77],t.i64.cast([0,393219]))?r[79]="broadcast_flow":(t.i64.eq(r[77],t.i64.cast([0,393224]))?r[80]="broadcast_flow":(t.i64.eq(r[77],t.i64.cast([0,458752]))?r[81]="inbox_new_message":(t.i64.eq(r[77],t.i64.cast([0,65537]))?r[82]="inbox_new_message":(t.i64.eq(r[77],t.i64.cast([0,2097155]))?r[83]="inbox_new_message":r[83]=void 0,r[82]=r[83]),r[81]=r[82]),r[80]=r[81]),r[79]=r[80]),r[78]=r[79]),r[68]=r[78]),r[65].set("group_thread_creation_entry_point",r[68]),t.forEach(t.db.table(9).fetch([[[r[49]]]]),function(e){var t=e.update,n=e.item;return t({otidOfFirstMessage:a.offlineThreadingId})})},function(e){var n,o,a,i,l,s,u,c,d;return r[66]===void 0?(t.i64.eq(r[50],t.i64.cast([0,5]))||t.i64.eq(r[50],t.i64.cast([0,26]))?((function(e){t.logger(e).mustfix(e)})("For Marketplace & community chat subthreads, thread metadata cannot be null"),n=[void 0,void 0,void 0],r[78]=n[0],r[79]=n[1],r[80]=n[2]):(r[81]=t.toJSON(r[65]),o=[r[81],t.i64.cast([0,130]),void 0],r[78]=o[0],r[79]=o[1],r[80]=o[2]),a=[r[78],r[79],r[80]],r[69]=a[0],r[70]=a[1],r[71]=a[2]):(t.i64.eq(r[50],t.i64.cast([0,5]))?(r[81]=t.toJSON(r[65]),i=[r[81],t.i64.cast([0,645]),void 0],r[78]=i[0],r[79]=i[1],r[80]=i[2]):(t.i64.eq(r[50],t.i64.cast([0,2]))?(r[84]=t.toJSON(r[65]),l=[r[84],t.i64.cast([0,787]),void 0],r[81]=l[0],r[82]=l[1],r[83]=l[2]):(r[84]=t.toJSON(r[65]),s=[r[84],t.i64.cast([0,645]),void 0],r[81]=s[0],r[82]=s[1],r[83]=s[2]),u=[r[81],r[82],r[83]],r[78]=u[0],r[79]=u[1],r[80]=u[2]),c=[r[78],r[79],r[80]],r[69]=c[0],r[70]=c[1],r[71]=c[2]),d=[r[69],r[70],r[71]],r[46]=d[0],r[47]=d[1],r[48]=d[2]}]):t.sequence([function(e){return r[61]=r[23]==null?t.i64.cast([0,1]):r[23],t.db.table(9).fetch([[[r[30]]]]).next().then(function(e,n){var o=e.done,a=e.value;return o?r[58]=t.i64.cast([0,1]):(n=a.item,r[71]=n.syncGroup,t.i64.neq(r[71],void 0)?r[70]=r[71]:r[70]=t.i64.cast([0,1]),r[58]=r[70])})},function(e){return r[60]=new t.Map,r[60].set("thread_id",r[30]),r[60].set("otid",r[12]),r[60].set("source",r[11]==null?t.i64.cast([0,0]):r[11]),r[60].set("send_type",t.i64.cast([0,1])),r[60].set("sync_group",r[58]),r[60].set("mark_thread_read",r[25]),t.i64.eq(r[61],t.i64.cast([0,1]))?t.resolve(r[60].set("text",r[34])):t.i64.eq(r[61],t.i64.cast([0,2]))?(t.i64.neq(r[32],void 0)&&(r[60].set("sticker_id",r[32]),r[60].set("send_type",r[61])),r[33]!==void 0?t.sequence([function(e){return t.nativeOperation(n("LSDeserializeFromJsonIntoDictionaryV2.nop"),r[33]).then(function(e){var t;return t=e,r[70]=t[0],t})},function(e){return r[71]=new t.Map,r[72]=r[70].keys(),r[73]=t.i64.of_int32(r[72].length),t.i64.gt(r[73],t.i64.cast([0,0]))?t.loopAsync(r[73],function(e){return r[77]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[72],r[77]).then(function(e){var t;return t=e,r[78]=t[0],r[79]=t[1],t})},function(e){return r[80]=r[70].get(r[78]),r[71].set(r[78],r[80])}])}):t.resolve()},function(e){return r[74]=r[71].get("xma_music_sticker_message_metadata"),r[74]?r[75]=!1:r[75]=!0,r[75]?t.resolve(r[76]=void 0):t.sequence([function(e){return r[77]=new t.Map,r[78]=r[74].keys(),r[79]=t.i64.of_int32(r[78].length),t.i64.gt(r[79],t.i64.cast([0,0]))?t.loopAsync(r[79],function(e){return r[80]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[78],r[80]).then(function(e){var t;return t=e,r[81]=t[0],r[82]=t[1],t})},function(e){return r[83]=r[74].get(r[81]),r[77].set(r[81],r[83])}])}):t.resolve()},function(e){return r[76]=r[77]}])},function(e){return r[76]!==void 0?r[60].set("send_type",r[61]):0}]):t.resolve()):t.i64.eq(r[61],t.i64.cast([0,7]))?t.sequence([function(e){return t.db.table(16).fetch([[[r[30],r[35]]]]).next().then(function(e,t){var n,o,a=e.done,i=e.value;return a?(n=[void 0,void 0],r[70]=n[0],r[71]=n[1],n):(t=i.item,o=[t.filename,t.attributionAppId],r[70]=o[0],r[71]=o[1])})},function(e){return r[70]!==void 0&&t.i64.neq(r[71],void 0)?(r[60].set("url",r[70]),r[60].set("attribution_app_id",r[71]),r[60].set("send_type",r[61]),r[33]!==void 0?r[60].set("metadata_dataclass",r[33]):0):0}]):t.i64.eq(r[61],t.i64.cast([0,3]))?t.sequence([function(e){return r[60].set("text",r[34]),r[70]=t.createArray(),r[71]=t.createArray(),t.forEach(t.sortBy(t.db.table(16).fetch([[[r[30],r[35]]]]),[["attachmentIndex","ASC"]]),function(e){var n=e.item;return r[72]=n.offlineAttachmentId,r[73]=(r[70].push(t.i64.from_string(n.attachmentFbid)),r[70]),r[72]!==void 0?r[73]=(r[71].push(r[72]),r[71]):0})},function(e){return r[60].set("attachment_fbids",r[70]),t.i64.eq(r[61],t.i64.cast([0,9]))&&r[60].set("offline_attachment_ids",r[71]),r[60].set("send_type",r[61])}]):t.i64.eq(r[61],t.i64.cast([0,9]))?t.sequence([function(e){return r[60].set("text",r[34]),r[70]=t.createArray(),r[71]=t.createArray(),t.forEach(t.sortBy(t.db.table(16).fetch([[[r[30],r[35]]]]),[["attachmentIndex","ASC"]]),function(e){var n=e.item;return r[72]=n.offlineAttachmentId,r[73]=(r[70].push(t.i64.from_string(n.attachmentFbid)),r[70]),r[72]!==void 0?r[73]=(r[71].push(r[72]),r[71]):0})},function(e){return r[60].set("attachment_fbids",r[70]),t.i64.eq(r[61],t.i64.cast([0,9]))&&r[60].set("offline_attachment_ids",r[71]),r[60].set("send_type",r[61])}]):t.i64.eq(r[61],t.i64.cast([0,4]))?t.sequence([function(e){return t.db.table(16).fetch([[[r[30],r[35]]]]).next().then(function(e,t){var n=e.done,o=e.value;return n?r[70]=void 0:(t=o.item,r[70]=t.attachmentFbid)})},function(e){return t.db.table(16).fetch([[[r[30],r[35]]]]).next().then(function(e,t){var n=e.done,o=e.value;return n?r[72]=void 0:(t=o.item,r[72]=t.actionUrl)})},function(e){return r[70]!==void 0?(r[60].set("text",r[34]),r[72]!==void 0&&r[60].set("url",r[72]),r[60].set("forwarded_share_id",r[70]),r[60].set("send_type",r[61])):0}]):t.i64.eq(r[61],t.i64.cast([0,5]))?t.resolve(r[13]!==void 0?(r[60].set("forwarded_msg_id",r[13]),r[60].set("send_type",r[61]),t.i64.neq(r[36],void 0)&&r[60].set("forward_score",r[36]),r[60].set("strip_forwarded_msg_caption",!1)):0):t.i64.eq(r[61],t.i64.cast([0,6]))?t.sequence([function(e){return t.db.table(16).fetch([[[r[30],r[35]]]]).next().then(function(e,t){var n,o,a=e.done,i=e.value;return a?(n=[void 0,void 0],r[70]=n[0],r[71]=n[1],n):(t=i.item,o=[t.filename,t.attributionAppId],r[70]=o[0],r[71]=o[1])})},function(e){return r[70]!==void 0?(r[60].set("url",r[70]),r[60].set("text",r[34]),r[60].set("send_type",r[61])):0}]):t.i64.eq(r[61],t.i64.cast([0,11]))?t.sequence([function(e){return t.db.table(16).fetch([[[r[30],r[35]]]]).next().then(function(e,t){var n,o,a=e.done,i=e.value;return a?(n=[void 0,void 0],r[70]=n[0],r[71]=n[1],n):(t=i.item,o=[t.actionUrl,t.attributionAppId],r[70]=o[0],r[71]=o[1])})},function(e){return r[70]!==void 0?(r[60].set("url",r[70]),r[60].set("text",r[34]),r[60].set("send_type",r[61])):0}]):t.resolve(t.i64.eq(r[61],t.i64.cast([0,12]))?r[60].set("send_type",r[61]):0)},function(e){return r[66]=r[24]==null?void 0:r[24],r[65]=r[8]===""?void 0:r[8],r[65]!==void 0&&t.i64.neq(r[14],void 0)&&(r[70]=new t.Map,r[70].set("reply_source_id",r[65]),r[70].set("reply_source_type",r[14]),r[70].set("reply_type",r[42]==null?t.i64.cast([0,0]):r[42]),r[70].set("reply_source_attachment_id",void 0),r[60].set("reply_metadata",r[70])),r[66]!==void 0&&r[15]!==void 0&&(r[70]=new t.Map,r[70].set("subthread_parent_message_id",r[66]),r[70].set("is_exclusive_to_subthread",r[15]),r[60].set("subthread_data",r[70])),r[67]=r[31]===""?void 0:r[31],r[67]!==void 0&&(r[70]=r[37]===""?void 0:r[37],r[70]!==void 0&&(r[71]=r[38]===""?void 0:r[38],r[71]!==void 0&&(r[72]=new t.Map,r[72].set("mention_ids",r[67]),r[72].set("mention_offsets",r[70]),r[72].set("mention_lengths",r[71]),r[72].set("mention_types",r[39]===""?void 0:r[39]),r[60].set("mention_data",r[72])))),r[40]!==void 0&&r[60].set("is_forwarded",r[40]),r[68]=r[9]===""?void 0:r[9],r[68]!==void 0&&r[60].set("platform_ref",r[68]),r[69]=r[10]===""?void 0:r[10],r[69]!==void 0&&r[60].set("platform_token",r[69]),[t.i64.cast([0,1]),t.i64.cast([0,2])].some(function(e){return t.i64.eq(r[61],e)})&&t.i64.neq(r[41],void 0)&&r[60].set("hot_emoji_size",r[41]),t.i64.neq(r[16],void 0)&&r[60].set("initiating_source",r[16]),r[17]!==void 0&&r[60].set("skip_url_preview_gen",r[17]),t.i64.neq(r[18],void 0)&&r[60].set("rich_text_format_type",r[18]),t.resolve()},function(e){return r[19]!==void 0&&r[60].set("text_has_links",r[19]),r[20]!==void 0&&r[60].set("dataclass_params",r[20]),r[21]!==void 0&&r[60].set("multitab_env",r[21]),r[22]!==void 0&&r[60].set("metadata_dataclass",r[22]),t.filter(t.db.table(14).fetch([[[r[49],r[43]]]]),function(e){return t.i64.eq(e.threadKey,r[49])&&t.i64.eq(t.i64.cast([0,0]),r[52])&&t.i64.eq(e.contactId,r[43])}).next().then(function(e,n){var o=e.done,a=e.value;return o?r[62]=!1:(n=a.item,t.i64.eq(r[50],t.i64.cast([0,152]))?(r[71]=n.threadRoles,t.i64.lt(t.i64.cast([0,7]),t.i64.cast([0,0]))||t.i64.gt(t.i64.cast([0,7]),t.i64.cast([0,11]))?r[72]=!1:r[72]=!t.i64.eq(t.i64.and_(t.i64.lsl_(t.i64.cast([0,1]),t.i64.to_int32(t.i64.cast([0,7]))),r[71]),t.i64.cast([0,0])),r[73]=r[53],r[74]=r[54],r[75]=r[55],r[76]=r[56],r[77]=r[57],r[79]=t.i64.div(t.i64.cast([0,223]),t.i64.cast([0,64])),r[80]=t.i64.lsl_(t.i64.cast([0,1]),t.i64.to_int32(t.i64.sub(t.i64.cast([0,223]),t.i64.mul(r[79],t.i64.cast([0,64]))))),t.i64.lt(t.i64.cast([0,223]),t.i64.cast([0,0]))||t.i64.gt(t.i64.cast([0,223]),t.i64.cast([0,308]))?r[78]=!1:(t.i64.eq(r[79],t.i64.cast([0,0]))?r[81]=!t.i64.eq(t.i64.and_(r[80],r[73]),t.i64.cast([0,0])):(t.i64.eq(r[79],t.i64.cast([0,1]))?r[82]=!t.i64.eq(t.i64.and_(r[80],r[74]),t.i64.cast([0,0])):(t.i64.eq(r[79],t.i64.cast([0,2]))?r[83]=!t.i64.eq(t.i64.and_(r[80],r[75]),t.i64.cast([0,0])):(t.i64.eq(r[79],t.i64.cast([0,3]))?r[84]=!t.i64.eq(t.i64.and_(r[80],r[76]),t.i64.cast([0,0])):(t.i64.eq(r[79],t.i64.cast([0,4]))?r[85]=!t.i64.eq(t.i64.and_(r[80],r[77]),t.i64.cast([0,0])):r[85]=!1,r[84]=r[85]),r[83]=r[84]),r[82]=r[83]),r[81]=r[82]),r[78]=r[81]),r[72]!==r[78]&&((function(e){t.logger(e).mustfix(e)})("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting"),t.throw("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting")),r[70]=r[72]):r[70]=!1,r[62]=r[70])})},function(e){var n;return r[62]&&r[60].set("perform_action_as_page",!0),r[64]=t.toJSON(r[60]),n=[r[64],t.i64.cast([0,46]),void 0],r[46]=n[0],r[47]=n[1],r[48]=n[2]}])},function(e){var t;return t=[r[46],r[47],r[48]],r[26]=t[0],r[27]=t[1],r[28]=t[2],t}]))})},function(e){var t;return t=[r[26],r[27],r[28]],r[4]=t[0],r[5]=t[1],r[6]=t[2],t}]))})},function(e){var t;return t=[r[4],r[5],r[6]],r[0]=t[0],r[1]=t[1],r[2]=t[2],t}]))})},function(e){var t;return t=[r[0],r[1]],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxTaskSerializerSendMessageV2StoredProcedure",e.__tables__=["messages_optimistic_context","messages","threads","pending_tasks","attachments","participants","threads_optimistic_metadata"],a.exports=e}),null);
__d("LSTaskSerializerSyncThreadCapabilities",[],(function(t,n,r,o,a,i){function e(){var e,t=arguments,n=t[t.length-1],r=[],o=[];return e=[void 0,void 0,void 0],o[0]=e[0],o[1]=e[1],o[2]=e[2],n.resolve(o)}e.__sproc_name__="LSMailboxTaskSerializerSyncThreadCapabilitiesStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSACSExperimentCapability",[],(function(t,n,r,o,a,i){var e=Object.freeze({RETRY_AFTER_TASK_SERIALIZATION_FAILURE_EXPONENTIAL_BACKOFF:0,BUMP_TOKEN_SYNC_TASK_AT_TASK_SERIALIZATION:1,INSERT_PENDING_TASK_PARENT_ROW_WHEN_NO_ACS_TOKENS_AT_TASK_INSERTION:2});i.default=e}),66);
__d("LSIsExperimentCapabilityEnabled.nop",["LSACSExperimentCapability","LSIntEnum","MetaConfig","Promise"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=r("MetaConfig")._("87"),c=r("MetaConfig")._("156"),d=function(a,i,l,d){switch((s||(s=o("LSIntEnum"))).toNumber(l)){case r("LSACSExperimentCapability").BUMP_TOKEN_SYNC_TASK_AT_TASK_SERIALIZATION:return(e||(e=n("Promise"))).resolve([c]);case r("LSACSExperimentCapability").INSERT_PENDING_TASK_PARENT_ROW_WHEN_NO_ACS_TOKENS_AT_TASK_INSERTION:return(e||(e=n("Promise"))).resolve([!1]);case r("LSACSExperimentCapability").RETRY_AFTER_TASK_SERIALIZATION_FAILURE_EXPONENTIAL_BACKOFF:return(e||(e=n("Promise"))).resolve([u])}return(e||(e=n("Promise"))).resolve([!1])};d.__nop_name__="LSIsExperimentCapabilityEnabled",l.default=d}),98);
__d("LSVoprfHmac.nop",["ACSCipherSuiteModule","ACSTokenHmacUtil","XPlatReactTextEncoder"],(function(t,n,r,o,a,i,l){"use strict";var e=async function(t,n,r,a){var e=o("ACSCipherSuiteModule").getACSCipherSuiteByValue(o("ACSCipherSuiteModule").VOPRF_RISTRETTO_HMACSHA512.value);if(!e)return Promise.resolve([void 0]);var i=await o("ACSTokenHmacUtil").hmac(e.macAlgorithm,new Uint8Array(a).slice(),new(o("XPlatReactTextEncoder")).TextEncoder().encode(r));return Promise.resolve([i.buffer])};e.__nop_name__="LSVoprfHmac",l.default=e}),98);
__d("LSTaskSerializerUnauthenticatedTask",["LSArrayGetObjectAt","LSBase64Encode.nop","LSIsExperimentCapabilityEnabled.nop","LSMailboxTaskCompletionApiOnTaskCompletion","LSRemoveUsedTokens","LSVoprfHmac.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(n){return t.db.table(311).fetch([[[e[0]]]]).next().then(function(e,t){var n=e.done,o=e.value;return n?r[0]=void 0:(t=o.item,r[0]=t.projectName)})},function(o){return r[0]!==void 0?t.sequence([function(o){return e[1]!==void 0?t.sequence([function(e){return r[9]=t.createArray(),r[10]=t.i64.of_float(Date.now()),t.forEach(t.filter(t.db.table(307).fetch(),function(e){return r[0]===e.projectName&&t.i64.gt(e.expirationTimestampMs,r[10])}),function(e){var t=e.item;return r[16]=(r[9].push(t.configId),r[9])})},function(e){return t.sequence([function(e){return r[16]=t.createArray(),r[17]=t.i64.of_int32(r[9].length),t.i64.gt(r[17],t.i64.cast([0,0]))?t.loopAsync(r[17],function(e){return r[19]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[9],r[19]).then(function(e){var t;return t=e,r[20]=t[0],r[21]=t[1],t})},function(e){return r[22]=(r[16].push(r[20]),r[16])}])}):t.resolve()},function(e){return r[18]=r[16].join(","),r[11]=r[18]}])},function(o){return t.filter(t.db.table(309).fetch(),function(e){return r[9].includes(e.configId)&&t.i64.gt(e.redeemLimit,t.i64.cast([0,0]))}).next().then(function(o,a){var i=o.done,l=o.value;return i?t.sequence([function(e){return t.nativeOperation(n("LSIsExperimentCapabilityEnabled.nop"),t.i64.cast([0,0]),r[0]).then(function(e){var t;return t=e,r[16]=t[0],t})},function(o){return r[16]?t.sequence([function(n){return t.db.table(311).fetch([[[e[0]]]]).next().then(function(e,n){var o=e.done,a=e.value;return o?r[20]=t.i64.cast([0,0]):(n=a.item,r[20]=n.failureCount)})},function(n){return t.forEach(t.db.table(311).fetch([[[e[0]]]]),function(e){var n=e.item;return t.forEach(t.db.table(311).fetch([[[n.taskId]]]),function(e){var n=e.update,o=e.item;return n({failureCount:t.i64.add(r[20],t.i64.cast([0,1]))})})})},function(e){var n;return n=[void 0,void 0,t.i64.mul(t.i64.lsl_(t.i64.cast([0,1]),t.i64.to_int32(t.i64.mod_(r[20],t.i64.cast([0,7])))),t.i64.cast([0,500]))],r[17]=n[0],r[18]=n[1],r[19]=n[2],n}]):t.sequence([function(r){return t.storedProcedure(n("LSMailboxTaskCompletionApiOnTaskCompletion"),e[0],!1)},function(n){var o;return r[20]=t.createArray(),r[21]=(r[20].push("Unauthenticated Task Serializer: no valid tokens"),r[20]),r[22]=(r[20].push(e[0]),r[20]),r[23]=(r[20].push(r[0]),r[20]),r[24]=t.toJSON(r[20]),(function(e){t.logger(e).mustfix(e)})(r[24]),o=[void 0,void 0,void 0],r[17]=o[0],r[18]=o[1],r[19]=o[2]}])},function(e){var t;return t=[r[17],r[18],r[19]],r[12]=t[0],r[13]=t[1],r[14]=t[2],t}]):(a=l.item,t.sequence([function(o){return r[20]=a.tokenId,t.nativeOperation(n("LSVoprfHmac.nop"),e[2]==null?"":e[2],a.sharedSecret).then(function(e){var t;return t=e,r[16]=t[0],t})},function(o){return t.blobs.neq(r[16],void 0)?t.sequence([function(e){return t.forEach(t.db.table(309).fetch([[[r[20]]]]),function(e){var n=e.update,r=e.item;return n({redeemLimit:t.i64.sub(r.redeemLimit,t.i64.cast([0,1]))})})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),r[16]).then(function(e){var t;return t=e,r[21]=t[0],t})},function(e){return t.nativeOperation(n("LSBase64Encode.nop"),a.nonce).then(function(e){var t;return t=e,r[22]=t[0],t})},function(n){var o;return r[23]=new t.Map,r[23].set("config_id",a.configId),r[23].set("tag",r[21]==null?"":r[21]),r[23].set("aux",r[22]==null?"":r[22]),r[23].set("project_name",r[0]),r[24]=t.toJSON(r[23]),r[25]=new t.Map,r[25].set("payload",e[2]==null?"":e[2]),r[25].set("token",r[24]),r[26]=t.toJSON(r[25]),o=[r[26],t.i64.from_string(e[1]),void 0],r[17]=o[0],r[18]=o[1],r[19]=o[2]}]):t.sequence([function(e){return t.forEach(t.db.table(309).fetch([[[r[20]]]]),function(e){return e.delete()})},function(r){return t.storedProcedure(n("LSMailboxTaskCompletionApiOnTaskCompletion"),e[0],!1)},function(n){var o;return r[21]=t.createArray(),r[22]=(r[21].push("Unauthenticated Task Serializer: hmac failed"),r[21]),r[23]=(r[21].push(e[0]),r[21]),r[24]=t.toJSON(r[21]),(function(e){t.logger(e).mustfix(e)})(r[24]),o=[void 0,void 0,void 0],r[17]=o[0],r[18]=o[1],r[19]=o[2]}])},function(e){var t;return t=[r[17],r[18],r[19]],r[12]=t[0],r[13]=t[1],r[14]=t[2],t}]))})},function(e){var t;return t=[r[12],r[13],r[14]],r[6]=t[0],r[7]=t[1],r[8]=t[2],t}]):t.sequence([function(r){return t.storedProcedure(n("LSMailboxTaskCompletionApiOnTaskCompletion"),e[0],!1)},function(n){var o;return r[9]=t.createArray(),r[10]=(r[9].push("Unauthenticated Task Serializer: task has no write label"),r[9]),r[11]=(r[9].push(e[0]),r[9]),r[12]=t.toJSON(r[9]),(function(e){t.logger(e).mustfix(e)})(r[12]),o=[void 0,void 0,void 0],r[6]=o[0],r[7]=o[1],r[8]=o[2]}])},function(e){var t;return t=[r[6],r[7],r[8]],r[2]=t[0],r[3]=t[1],r[4]=t[2],t}]):t.sequence([function(r){return t.storedProcedure(n("LSMailboxTaskCompletionApiOnTaskCompletion"),e[0],!1)},function(n){var o;return r[6]=t.createArray(),r[7]=(r[6].push("Unauthenticated Task Serializer: anonymous_task_context row not found"),r[6]),r[8]=(r[6].push(e[0]),r[6]),r[9]=t.toJSON(r[6]),(function(e){t.logger(e).mustfix(e)})(r[9]),o=[void 0,void 0,void 0],r[2]=o[0],r[3]=o[1],r[4]=o[2]}])},function(e){return t.storedProcedure(n("LSRemoveUsedTokens"))},function(e){return r[0]!==void 0?t.sequence([function(e){return t.nativeOperation(n("LSIsExperimentCapabilityEnabled.nop"),t.i64.cast([0,1]),r[0]).then(function(e){var t;return t=e,r[6]=t[0],t})},function(e){return r[6]?t.sequence([function(e){return t.i64.neq(r[4],void 0)?t.resolve(r[8]=!0):t.sequence([function(e){return r[10]=t.createArray(),r[11]=t.i64.of_float(Date.now()),t.forEach(t.filter(t.db.table(307).fetch(),function(e){return r[0]===e.projectName&&t.i64.gt(e.expirationTimestampMs,r[11])}),function(e){var t=e.item;return r[15]=(r[10].push(t.configId),r[10])})},function(e){return t.sequence([function(e){return r[15]=t.createArray(),r[16]=t.i64.of_int32(r[10].length),t.i64.gt(r[16],t.i64.cast([0,0]))?t.loopAsync(r[16],function(e){return r[18]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[10],r[18]).then(function(e){var t;return t=e,r[19]=t[0],r[20]=t[1],t})},function(e){return r[21]=(r[15].push(r[19]),r[15])}])}):t.resolve()},function(e){return r[17]=r[15].join(","),r[12]=r[17]}])},function(e){return t.filter(t.db.table(309).fetch(),function(e){return r[10].includes(e.configId)&&t.i64.gt(e.redeemLimit,t.i64.cast([0,0]))}).next().then(function(e,t){var n=e.done,o=e.value;return n?r[13]=!0:(t=o.item,r[13]=!1)})},function(e){return r[8]=r[13]}])},function(e){return r[8]?t.sequence([function(e){return t.filter(t.db.table(310).fetch(),function(e){return e.projectName===r[0]}).next().then(function(e,t){var n=e.done,o=e.value;return n?r[10]=void 0:(t=o.item,r[10]=t.taskId)})},function(e){return r[9]=r[10]}]):t.resolve(r[9]=void 0)},function(e){return r[7]=r[9]}]):t.resolve(r[7]=void 0)},function(e){return r[5]=r[7]}]):t.resolve(r[5]=void 0)},function(e){var t;return t=[r[2],r[3],r[4],r[5]],o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSAnonymousCredentialsTaskSerializerUnauthenticatedTaskStoredProcedure",e.__tables__=["anonymous_task_context","secure_acs_configurations","secure_acs_tokens","acs_request_context"],a.exports=e}),null);
__d("LSTaskSerializerUpdateThreadName",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(o){return t.sequence([function(r){return t.db.table(32).fetch([[[e[0]]]]).next().then(function(r,o){var a,i=r.done,l=r.value;return i?(n[4]=t.createArray(),n[5]=(n[4].push("taskSerializerUpdateThreadName: Task ID not found"),n[4]),n[6]=(n[4].push(e[0]),n[4]),n[7]=t.toJSON(n[4]),(function(e){t.logger(e).mustfix(e)})(n[7]),a=[void 0,void 0,void 0],n[0]=a[0],n[1]=a[1],n[2]=a[2]):(o=l.item,t.sequence([function(e){return n[8]=o.threadKey,t.db.table(9).fetch([[[n[8]]]]).next().then(function(e,r){var o,a=e.done,i=e.value;return a?(n[9]=t.createArray(),n[10]=(n[9].push("taskSerializerUpdateThreadName: Thread not found"),n[9]),n[11]=(n[9].push(n[8]),n[9]),n[12]=t.toJSON(n[9]),(function(e){t.logger(e).mustfix(e)})(n[12]),o=[void 0,void 0,void 0],n[4]=o[0],n[5]=o[1],n[6]=o[2]):(r=i.item,t.sequence([function(e){return t.db.table(9).fetch([[[n[8]]]]).next().then(function(e,r){var o=e.done,a=e.value;return o?n[9]=t.i64.cast([0,1]):(r=a.item,n[14]=r.syncGroup,t.i64.neq(n[14],void 0)?n[13]=n[14]:n[13]=t.i64.cast([0,1]),n[9]=n[13])})},function(e){var o;return n[11]=new t.Map,n[11].set("thread_key",n[8]),n[11].set("thread_name",r.threadName==null?"":r.threadName),n[11].set("sync_group",n[9]),n[12]=t.toJSON(n[11]),o=[n[12],t.i64.cast([0,32]),void 0],n[4]=o[0],n[5]=o[1],n[6]=o[2]}]))})},function(e){var t;return t=[n[4],n[5],n[6]],n[0]=t[0],n[1]=t[1],n[2]=t[2],t}]))})},function(e){var t;return t=[n[0],n[1],n[2]],r[0]=t[0],r[1]=t[1],r[2]=t[2],t}])},function(e){return t.resolve(r)}])}e.__sproc_name__="LSMailboxTaskSerializerUpdateThreadNameStoredProcedure",e.__tables__=["threads_optimistic_context","threads"],a.exports=e}),null);
__d("LSSerializeTask",["LSForceTaskExecutionImmediately","LSLogMebClientEvent.nop","LSTaskSerializerAcsIssueNextSync","LSTaskSerializerDeleteChatHistory","LSTaskSerializerE2eeMessageIntegrityCheckV2","LSTaskSerializerE2eeMetadataThreadIntegrityCheck","LSTaskSerializerEncryptedBackupAction","LSTaskSerializerEncryptedBackupsLoopingUpload","LSTaskSerializerEncryptedBackupsOpenUpload","LSTaskSerializerEncryptedBackupsRestoreWithSerializer","LSTaskSerializerEncryptedBackupsUpload","LSTaskSerializerEncryptedBackupsUploadProtobufOnly","LSTaskSerializerEncryptedBackupsUploadSenderBackup","LSTaskSerializerMuteThreadV2","LSTaskSerializerRemoveThread","LSTaskSerializerSendMessageV2","LSTaskSerializerSyncThreadCapabilities","LSTaskSerializerUnauthenticatedTask","LSTaskSerializerUpdateThreadName"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return e[1]==="46"?t.sequence([function(o){return t.storedProcedure(n("LSTaskSerializerSendMessageV2"),e[0]).then(function(e){var t;return t=e,r[8]=t[0],r[9]=t[1],t})},function(e){var n;return n=[r[8],t.i64.to_string(r[9]),void 0,void 0],r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],n}]):t.sequence([function(o){return e[1]==="144"?t.sequence([function(o){return t.storedProcedure(n("LSTaskSerializerMuteThreadV2"),e[0]).then(function(e){var t;return t=e,r[12]=t[0],r[13]=t[1],t})},function(e){var n;return n=[r[12],t.i64.to_string(r[13]),void 0,void 0],r[8]=n[0],r[9]=n[1],r[10]=n[2],r[11]=n[3],n}]):t.sequence([function(o){return e[1]==="146"?t.sequence([function(o){return t.storedProcedure(n("LSTaskSerializerRemoveThread"),e[0]).then(function(e){var t;return t=e,r[16]=t[0],r[17]=t[1],t})},function(e){var n;return n=[r[16],t.i64.to_string(r[17]),void 0,void 0],r[12]=n[0],r[13]=n[1],r[14]=n[2],r[15]=n[3],n}]):t.sequence([function(o){return e[1]==="32"?t.sequence([function(o){return t.storedProcedure(n("LSTaskSerializerUpdateThreadName"),e[0]).then(function(e){var t;return t=e,r[20]=t[0],r[21]=t[1],r[22]=t[2],t})},function(e){var n;return n=[r[20],t.i64.to_string(r[21]),void 0,r[22]],r[16]=n[0],r[17]=n[1],r[18]=n[2],r[19]=n[3],n}]):t.sequence([function(o){return e[1]==="362"?t.sequence([function(o){return t.storedProcedure(n("LSTaskSerializerAcsIssueNextSync"),e[0]).then(function(e){var t;return t=e,r[24]=t[0],r[25]=t[1],r[26]=t[2],t})},function(e){var n;return n=[r[24],t.i64.to_string(r[25]),void 0,r[26]],r[20]=n[0],r[21]=n[1],r[22]=n[2],r[23]=n[3],n}]):t.sequence([function(o){return e[1]==="50015"?t.sequence([function(o){return t.storedProcedure(n("LSTaskSerializerEncryptedBackupsRestoreWithSerializer"),e[0]).then(function(e){var t;return t=e,r[28]=t[0],r[29]=t[1],r[30]=t[2],t})},function(e){var n;return n=[r[28],t.i64.to_string(r[29]),void 0,r[30]],r[24]=n[0],r[25]=n[1],r[26]=n[2],r[27]=n[3],n}]):t.sequence([function(o){return e[1]==="319"?t.sequence([function(o){return t.storedProcedure(n("LSTaskSerializerEncryptedBackupAction"),e[0]).then(function(e){var t;return t=e,r[32]=t[0],r[33]=t[1],r[34]=t[2],t})},function(e){var n;return n=[r[32],t.i64.to_string(r[33]),void 0,r[34]],r[28]=n[0],r[29]=n[1],r[30]=n[2],r[31]=n[3],n}]):t.sequence([function(o){return e[1]==="50026"?t.sequence([function(o){return t.storedProcedure(n("LSTaskSerializerEncryptedBackupsUpload"),e[0]).then(function(e){var t;return t=e,r[36]=t[0],r[37]=t[1],t})},function(e){var n;return n=[r[36],t.i64.to_string(r[37]),void 0,void 0],r[32]=n[0],r[33]=n[1],r[34]=n[2],r[35]=n[3],n}]):t.sequence([function(o){return e[1]==="50042"?t.sequence([function(o){return t.storedProcedure(n("LSTaskSerializerEncryptedBackupsUploadProtobufOnly"),e[0]).then(function(e){var t;return t=e,r[40]=t[0],r[41]=t[1],r[42]=t[2],t})},function(e){var n;return n=[r[40],t.i64.to_string(r[41]),void 0,r[42]],r[36]=n[0],r[37]=n[1],r[38]=n[2],r[39]=n[3],n}]):t.sequence([function(o){return e[1]==="700"?t.sequence([function(o){return t.storedProcedure(n("LSTaskSerializerE2eeMetadataThreadIntegrityCheck"),e[0]).then(function(e){var t;return t=e,r[44]=t[0],r[45]=t[1],r[46]=t[2],t})},function(e){var n;return n=[r[44],t.i64.to_string(r[45]),void 0,r[46]],r[40]=n[0],r[41]=n[1],r[42]=n[2],r[43]=n[3],n}]):t.sequence([function(o){return e[1]==="705"?t.sequence([function(o){return t.storedProcedure(n("LSTaskSerializerE2eeMessageIntegrityCheckV2"),e[0]).then(function(e){var t;return t=e,r[48]=t[0],r[49]=t[1],r[50]=t[2],t})},function(e){var n;return n=[r[48],t.i64.to_string(r[49]),void 0,r[50]],r[44]=n[0],r[45]=n[1],r[46]=n[2],r[47]=n[3],n}]):t.sequence([function(o){return e[1]==="50043"?t.sequence([function(o){return t.storedProcedure(n("LSTaskSerializerEncryptedBackupsLoopingUpload"),e[0]).then(function(e){var t;return t=e,r[52]=t[0],r[53]=t[1],r[54]=t[2],t})},function(e){var n;return n=[r[52],t.i64.to_string(r[53]),void 0,r[54]],r[48]=n[0],r[49]=n[1],r[50]=n[2],r[51]=n[3],n}]):t.sequence([function(o){return e[1]==="50048"?t.sequence([function(o){return t.storedProcedure(n("LSTaskSerializerEncryptedBackupsOpenUpload"),e[0]).then(function(e){var t;return t=e,r[56]=t[0],r[57]=t[1],t})},function(e){var n;return n=[r[56],t.i64.to_string(r[57]),void 0,void 0],r[52]=n[0],r[53]=n[1],r[54]=n[2],r[55]=n[3],n}]):t.sequence([function(o){return e[1]==="160013"?t.sequence([function(o){return t.storedProcedure(n("LSTaskSerializerSyncThreadCapabilities"),e[0]).then(function(e){var t;return t=e,r[60]=t[0],r[61]=t[1],r[62]=t[2],t})},function(e){var n;return n=[r[60],t.i64.to_string(r[61]),void 0,r[62]],r[56]=n[0],r[57]=n[1],r[58]=n[2],r[59]=n[3],n}]):t.sequence([function(o){return e[1]==="903"?t.sequence([function(o){return t.storedProcedure(n("LSTaskSerializerDeleteChatHistory"),e[0]).then(function(e){var t;return t=e,r[64]=t[0],r[65]=t[1],r[66]=t[2],t})},function(e){var n;return n=[r[64],t.i64.to_string(r[65]),void 0,r[66]],r[60]=n[0],r[61]=n[1],r[62]=n[2],r[63]=n[3],n}]):t.sequence([function(o){var a;return e[1]==="50057"?t.sequence([function(o){return t.storedProcedure(n("LSTaskSerializerEncryptedBackupsUploadSenderBackup"),e[0]).then(function(e){var t;return t=e,r[68]=t[0],r[69]=t[1],r[70]=t[2],t})},function(e){var n;return n=[r[68],t.i64.to_string(r[69]),void 0,r[70]],r[64]=n[0],r[65]=n[1],r[66]=n[2],r[67]=n[3],n}]):t.resolve((a=[e[2],e[1],void 0,void 0],r[64]=a[0],r[65]=a[1],r[66]=a[2],r[67]=a[3],a))},function(e){var t;return t=[r[64],r[65],r[66],r[67]],r[60]=t[0],r[61]=t[1],r[62]=t[2],r[63]=t[3],t}])},function(e){var t;return t=[r[60],r[61],r[62],r[63]],r[56]=t[0],r[57]=t[1],r[58]=t[2],r[59]=t[3],t}])},function(e){var t;return t=[r[56],r[57],r[58],r[59]],r[52]=t[0],r[53]=t[1],r[54]=t[2],r[55]=t[3],t}])},function(e){var t;return t=[r[52],r[53],r[54],r[55]],r[48]=t[0],r[49]=t[1],r[50]=t[2],r[51]=t[3],t}])},function(e){var t;return t=[r[48],r[49],r[50],r[51]],r[44]=t[0],r[45]=t[1],r[46]=t[2],r[47]=t[3],t}])},function(e){var t;return t=[r[44],r[45],r[46],r[47]],r[40]=t[0],r[41]=t[1],r[42]=t[2],r[43]=t[3],t}])},function(e){var t;return t=[r[40],r[41],r[42],r[43]],r[36]=t[0],r[37]=t[1],r[38]=t[2],r[39]=t[3],t}])},function(e){var t;return t=[r[36],r[37],r[38],r[39]],r[32]=t[0],r[33]=t[1],r[34]=t[2],r[35]=t[3],t}])},function(e){var t;return t=[r[32],r[33],r[34],r[35]],r[28]=t[0],r[29]=t[1],r[30]=t[2],r[31]=t[3],t}])},function(e){var t;return t=[r[28],r[29],r[30],r[31]],r[24]=t[0],r[25]=t[1],r[26]=t[2],r[27]=t[3],t}])},function(e){var t;return t=[r[24],r[25],r[26],r[27]],r[20]=t[0],r[21]=t[1],r[22]=t[2],r[23]=t[3],t}])},function(e){var t;return t=[r[20],r[21],r[22],r[23]],r[16]=t[0],r[17]=t[1],r[18]=t[2],r[19]=t[3],t}])},function(e){var t;return t=[r[16],r[17],r[18],r[19]],r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=t[3],t}])},function(e){var t;return t=[r[12],r[13],r[14],r[15]],r[8]=t[0],r[9]=t[1],r[10]=t[2],r[11]=t[3],t}])},function(e){var t;return t=[r[8],r[9],r[10],r[11]],r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],t}])},function(o){return e[3]?t.sequence([function(e){return r[9]=r[1]==="60009"||r[1]==="60006"||r[1]==="60008"||r[1]==="60011"||r[1]==="765"||r[1]==="1006"||r[1]==="160009"||r[1]==="761"||r[1]==="1018"||r[1]==="632"||r[1]==="384"||r[1]==="384",r[9]&&r[1]!==void 0?(r[15]=["Deidentified task is being executed through the 'identified' path. Canceling task with label: ",r[1]].join(""),(function(e){t.logger(e).mustfix(e)})(["[EncryptedBackups][LSCoreSerializeTaskStoredProcedure] ","",r[15]].join("")),r[14]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSCoreSerializeTaskStoredProcedure",r[15],r[14],t.i64.cast([0,3]))):t.resolve()},function(e){return t.resolve(r[8]=!1)},function(e){var t,n,o;return r[9]||r[8]?(t=[void 0,void 0,void 0,void 0],r[10]=t[0],r[11]=t[1],r[12]=t[2],r[13]=t[3]):(n=[r[0],r[1],r[2],r[3]],r[10]=n[0],r[11]=n[1],r[12]=n[2],r[13]=n[3]),o=[r[10],r[11],r[12],r[13]],r[4]=o[0],r[5]=o[1],r[6]=o[2],r[7]=o[3]}]):t.sequence([function(o){return t.storedProcedure(n("LSTaskSerializerUnauthenticatedTask"),e[0],r[1],r[0]).then(function(e){var t;return t=e,r[8]=t[0],r[9]=t[1],r[10]=t[2],r[11]=t[3],t})},function(e){return t.i64.neq(r[11],void 0)?t.storedProcedure(n("LSForceTaskExecutionImmediately"),r[11]):t.resolve()},function(e){var n;return n=[r[8],t.i64.to_string(r[9]),void 0,r[10]],r[4]=n[0],r[5]=n[1],r[6]=n[2],r[7]=n[3],n}])},function(e){var t;return t=[r[4],r[5],r[6],r[7]],o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSCoreSerializeTaskStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSSerializeTaskStoredProcedure",["LSSerializeTask","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSSerializeTask"),a.taskId,a.taskLabel,a.taskValue,a.requiresAuthentication);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSBeginHandlingPendingTasksForQueue2",["I64","LSFactory","LSIntEnum","LSPendingTasksPluginType","LSSerializeTaskStoredProcedure","LSShape","LSVec","ReQL","XPlatReactCrypto","gkx","isNativeTask"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=500,c=3e4,d=5,m=100,p=7;async function _(e,t){var n=await e.lightspeed_task_context.get(t);return n==null||n.requiresAuthentication}async function f(t,n){var a=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.pending_tasks.index("queueNameTaskId")).getKeyRange(n));return a==null?{context:void 0,failureCount:(e||(e=o("I64"))).neg_one,httpUrlOverride:void 0,minTimeToSyncTimestampMs:e.neg_one,pluginType:(s||(s=o("LSIntEnum"))).ofNumber(r("LSPendingTasksPluginType").LS_BROKER),queueName:""}:a}async function g(t,n){var r=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.network_requests).getKeyRange(n));return r==null?0:(e||(e=o("I64"))).to_float(r.lastSyncRequestTimestampMs)}function h(t,n,r){var a=(e||(e=o("I64"))).equal(t.failureCount,(e||(e=o("I64"))).zero)||n;if(a)return 0;var i=(e||(e=o("I64"))).to_float(t.failureCount)>p?(e||(e=o("I64"))).to_float(t.failureCount)-p:(e||(e=o("I64"))).to_float(t.failureCount),l=Math.min((1<<Math.min(i-1,p))*u,c),s=r+l;return Math.max(s-Date.now(),0)}function y(){var t=Array.from(o("XPlatReactCrypto").getRandomValues(new Uint32Array(2)));return t[0]>>>=1,(e||(e=o("I64"))).add(e.lsl_(e.of_float(t[0]),32),e.of_float(t[1]))}function C(){var t=(e||(e=o("I64"))).of_float(Date.now());return e.and_(e.or_(e.lsl_(t,22),e.and_(y(),e.castExn([0,4194303]))),e.castExn([2147483647,4294967295]))}async function b(t,n){var r=C(),a=await t.network_requests.get(n,(e||(e=o("I64"))).neg_one);return a==null?await t.network_requests.add({epochId:r,failureCount:(e||(e=o("I64"))).zero,lastSentTimestampMs:e.zero,lastSyncRequestTimestampMs:e.of_float(Date.now()),syncDatabaseId:e.neg_one,taskQueueName:n}):await t.network_requests.put(babelHelpers.extends({},a,{epochId:r,lastSyncRequestTimestampMs:(e||(e=o("I64"))).of_float(Date.now())})),r}async function v(e,t){return await o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.network_requests).getKeyRange(t).filter(function(e){return e.epochId!=null}))!=null}function S(t,n,r){var a=(e||(e=o("I64"))).to_float(t.minTimeToSyncTimestampMs),i=Date.now(),l=a-i,s=l<=0;return s?h(t,n,r):l}function R(t){return t.httpUrlOverride!=null||(e||(e=o("I64"))).to_float(t.failureCount)>p}function L(t){return t.timeoutTimestampMs!=null?(e||(e=o("I64"))).to_float(t.timeoutTimestampMs)<=Date.now():!1}function E(e){return e==="90"||e==="130"||e==="153"}function k(e,t,n,r,o){var a=o===0?void 0:o;return{failureCount:a,label:e,payload:t,queueName:n,taskId:r}}async function I(t,n,a){var i=await r("LSSerializeTaskStoredProcedure")(r("LSFactory")(t),{requiresAuthentication:a,taskId:n.taskId,taskLabel:n.context,taskValue:n.taskValue}),l=i[0],s=i[1],u=i[2],c=i[3];return l==null?c!=null?{minRetryDelayMs:c}:void 0:k(s,l,n.queueName,n.taskId,(e||(e=o("I64"))).to_float(n.failureCount))}async function T(e,t,n){if(t.context==null){await e.pending_tasks.delete(t.taskId);return}var r=L(t);if(r){await e.pending_tasks.delete(t.taskId);return}return I(e,t,n)}function D(e,t){var n=t>=(r("gkx")("26373")&&e===String(207)?m:d)||E(e);return!n}async function x(t,n){var r=await t.pending_tasks.get(n.taskId);r!=null&&(e||(e=o("I64"))).equal(n.firstExecutedTimestampMs,(e||(e=o("I64"))).zero)&&await t.pending_tasks.put(babelHelpers.extends({},r,{firstExecutedTimestampMs:(e||(e=o("I64"))).of_float(Date.now())}))}async function $(t,n){if(n.length===0)return{epochId:void 0,tasks:[]};var r=[],a=n[0].httpUrlOverride,i=(await Promise.all(n.map(function(e){return _(t,e.taskId)}))).some(Boolean);for(var l of n){var s=l.httpUrlOverride===a,u=await _(t,l.taskId)===i;if(await x(t,l),!s||!u)break;var c=await T(t,l,i);if(c!=null&&c.payload!=null)r.push(c);else if((c==null?void 0:c.minRetryDelayMs)!=null){var d=await t.pending_tasks.get(l.taskId);if(d!=null){var m;await t.pending_tasks.put(babelHelpers.extends({},d,{failureCount:(e||(e=o("I64"))).add((m=d.failureCount)!=null?m:(e||(e=o("I64"))).zero,e.one),minTimeToSyncTimestampMs:e.add(c.minRetryDelayMs,e.of_float(Date.now()))}))}}else await t.pending_tasks.delete(l.taskId);if(!D(l.context,r.length))break}return{epochId:void 0,tasks:r}}async function P(e,t,n,r,o){o===void 0&&(o=!0);var a=await $(e,t),i=a.tasks;if(i.length===0)return{httpUrlOverride:void 0,networkPayload:void 0,nextSyncMs:void 0,queueName:n,skipRealtimeGateway:!1,workItemType:4};if(o===!0){var l=await b(e,n);a.epochId=l}var s=await f(e,n);return{httpUrlOverride:s.httpUrlOverride,networkPayload:a,nextSyncMs:void 0,queueName:n,skipRealtimeGateway:R(s),workItemType:r}}async function N(e,t,n){var a=await f(e,t),i=await g(e,t),l=S(a,n,i),s=l!==0;if(s)return[{httpUrlOverride:void 0,networkPayload:void 0,nextSyncMs:l,queueName:t,skipRealtimeGateway:!1,workItemType:3}];var u=[],c=await o("ReQL").toArrayAsync(o("ReQL").fromTableAscending(e.pending_tasks.index("queueNameTaskId")).getKeyRange(t)),d=c.filter(r("isNativeTask"));if(d.length>0){var m=await P(e,d,t,2,r("gkx")("4778")===!0);u.push(m)}var p=c.filter(function(e){return!r("isNativeTask")(e)});if(p.length>0){var _=await P(e,p,t,1);u.push(_)}return u}async function M(e,t,n){var r=!await v(e,t);return r?N(e,t,n):[{httpUrlOverride:void 0,networkPayload:void 0,nextSyncMs:void 0,queueName:t,skipRealtimeGateway:!1,workItemType:4}]}async function w(t,n){var a=n.ignoreSoftDelay,i=n.queueName,l=await M(t,i,a);return l.map(function(t){var n,a,i;return o("LSShape").ofRecord({network_payload:o("LSShape").ofRecord({epoch_id:(n=t.networkPayload)==null?void 0:n.epochId,tasks:r("LSVec").ofArray(((a=(i=t.networkPayload)==null?void 0:i.tasks)!=null?a:[]).map(function(t){var n;return o("LSShape").ofRecord({failure_count:t.failureCount!=null?(e||(e=o("I64"))).of_float(t.failureCount):void 0,label:(n=t.label)!=null?n:void 0,payload:t.payload,queue_name:t.queueName,task_id:t.taskId})}))}),next_sync_ms:t.nextSyncMs!=null?(e||(e=o("I64"))).of_float(t.nextSyncMs):void 0,queue_name:t.queueName,skip_realtime_gateway:t.skipRealtimeGateway,work_item_type:(s||(s=o("LSIntEnum"))).ofNumber(t.workItemType)})})}w._updateTaskIfNeeded=x,w._getHeadOfNormalQueue=f,w._lastSyncRequestTimestampForQueue=g,w._exponentialBackoffForNormalQueue=h,w._generateNewEpoch=C,w._openNewEpochForQueue=b,w._isEpochOpenForQueue=v,w._calculateDelayForNormalQueue=S,w._queueShouldSkipRealtimeGateway=R,w._isNativeTask=r("isNativeTask"),w._taskIsTimedOut=L,w._taskShouldStopBatching=E,w._buildTaskPayloadExpressionForNormalTaskWithParameters=k,w._buildTaskPayloadExpressionForValidatedNormalTask=I,w._buildTaskPayloadExpressionForUnvalidatedNormalTask=T,w._workForNormalQueueWithoutDelay=P,w._workForNormalQueueWithClosedEpoch=N,w._buildWorkForNormalQueue=M,w._buildNetworkPayloadShapeForTasks=$,w._canContinueBatchingForQueue=D,l.default=w}),98);
__d("MWPBeginHandlingPendingTasksForQueue",["LSBeginHandlingFireForgetTasksForQueueStoredProcedure","LSBeginHandlingPendingTasksForQueue2","LSFactory"],(function(t,n,r,o,a,i,l){"use strict";async function e(e,t){var n=t.fireAndForgetTask,o=t.ignoreSoftDelay,a=t.queueName,l=await e.runInTransaction(async function(e){if(n===!0){var t=await r("LSBeginHandlingFireForgetTasksForQueueStoredProcedure")(r("LSFactory")(e),{queueName:a}),i=t[0];return[i]}return r("LSBeginHandlingPendingTasksForQueue2")(e,{ignoreSoftDelay:o,queueName:a})},"readwrite",void 0,void 0,i.id+":37");return l}l.default=e}),98);
__d("MWPlatformTaskUtils",["FBLogger","I64","JSScheduler","MetaConfig","ReQL","getErrorSafe","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t,n){async function a(){try{await t(n)}catch(t){var e=r("getErrorSafe")(t);r("FBLogger")("messenger_web").catching(e).warn("Failed to calculate work for task queue %s",n.queueName)}}if((s||(s=o("I64"))).gt(n.priority,(s||(s=o("I64"))).zero)&&r("MetaConfig")._("78")){var i=function(){var e=a()};(e||(e=r("JSScheduler"))).scheduleLoggingPriCallback(i)}else r("promiseDone")(a())}async function c(e,t){try{await e(t)}catch(e){var n=r("getErrorSafe")(e);r("FBLogger")("messenger_web").catching(n).warn("Failed to calculate work for fire forget queue %s",t.queueName)}}function d(e,t){var n=new Set,r=[],a=[];return a.push(e.tables.pending_tasks.index("queueNameTaskId").subscribe(function(e,t){var a,i;if(t.operation==="delete"){n.add(e[0]);return}var l=t.operation==="put"&&t.prevValue==null||t.operation==="add",u=t.operation==="put"&&(s||(s=o("I64"))).compare(t.value.failureCount,(a=(i=t.prevValue)==null?void 0:i.failureCount)!=null?a:(s||(s=o("I64"))).zero)>0;(l||u)&&n.add(t.value.queueName),(t.operation==="add"&&t.value.dataTraceId==null||t.value.dataTraceId==="")&&r.push(t.value)})),a.push(e.tables.network_requests.subscribe(function(e,t){var r=e[0];r!==""&&(t.operation==="delete"||t.value.epochId==null)&&n.add(r)})),a.push(e.subscribeToCommit(function(){var a=Array.from(n);n.clear(),r=[],a.forEach(async function(n){var r=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.tables.pending_tasks.index("queueNameTaskId")).bounds({gte:[n]}));r!=null&&u(t,r)})})),a}function m(e,t){r("promiseDone")((async function(){var n=await o("ReQL").toArrayAsync(o("ReQL").fromTableAscending(e.tables.pending_tasks)),r=new Set;for(var a of n)r.has(a.queueName)||(r.add(a.queueName),u(t,a))})())}function p(e,t){r("promiseDone")((async function(){var n=await o("ReQL").toArrayAsync(o("ReQL").fromTableAscending(e.tables.pending_fire_and_forget_tasks));await Promise.all(n.map(function(e){return c(t,e)})),r("promiseDone")(e.runInTransaction(function(e){return Promise.all(n.map(function(t){return e.pending_fire_and_forget_tasks.delete(t.taskId)}))},"readwrite","background",void 0,i.id+":199"))})())}function _(e,t){var n=!1,r=[];return r.push(e.tables.pending_fire_and_forget_tasks.subscribe(function(e,t){if(t.operation!=="delete"){var r=t.operation==="put"&&t.prevValue==null||t.operation==="add";r&&(n=!0)}})),r.push(e.subscribeToCommit(function(){n&&p(e,t),n=!1})),r}l.checkQueuesWhenPendingTaskTableUpdates=d,l.checkAllPendingTasksForWork=m,l.checkAllFireForgetTasksForWork=p,l.checkQueuesWhenPendingFireForgetTaskTableUpdates=_}),98);
__d("LSPlatformTaskSystemTransport",["CurrentMessengerUser","FBLogger","I64","JSResourceForInteraction","JSScheduler","LSDatabaseProviderType","LSHandleTaskSendFailureForQueue2","LSHandleTaskSendSuccessForQueue2","LSHandleTaskSuccessOpsDownloadFailureForQueue","LSJson","LSMailboxInitialSyncCursor","LSPlatformRealtimeTransport","LSPlatformRequestId","LSPlatformRequestScheduler","LSPlatformServerResponseHandler","LSPlatformTaskSyncGroupId","LSShape","LSVec","MWPBeginHandlingPendingTasksForQueue","MWPBumpEntityKey","MWPlatformTaskUtils","ReQL","cr:4031","cr:6668","gkx","promiseDone","qex"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=500,c=r("JSResourceForInteraction")("publishLSPlatformDeidentifiedPayload").__setRef("LSPlatformTaskSystemTransport"),d=new Set([632,765,60011,1006,1018].map(function(e){return e.toString()})),m=(function(){function t(e,t,n,a){var i=this;this.key="ls",this.$8=!1,this.$19=async function(e,t){var n=await r("MWPBeginHandlingPendingTasksForQueue")(i.$1,{ignoreSoftDelay:t,queueName:e});for(var a of n)await i.$18(o("LSShape").toRecord(a))},this.$1=e,this.$2=t,this.$3=n,this.$4=a,this.$8=o("LSDatabaseProviderType").isProviderPersisted(e),this.$5=new(r("LSPlatformRequestScheduler")),this.$6=new(r("LSPlatformServerResponseHandler"))(n),this.$7=this.$9(),this.$10()}var a=t.prototype;return a.$11=async function(t,n){var e=t.filter(function(e){return e.label!=null&&d.has(e.label)});if(e.length<t.length){e.length>0&&r("FBLogger")("maw_ohai").mustfix("Deidentifed tasks label %s sent together with normal tasks",e[0].label);var o=await this.$2.publish(n);return o}var a=e[0],i=await c.load(),l=await i(babelHelpers.extends({},n,{taskLabel:a.label}));return l},a.$12=async function(t){await this.$1.runInTransaction(function(e){return r("LSHandleTaskSendFailureForQueue2")(e,t)},"readwrite",void 0,void 0,i.id+":150")},a.$13=async function(t){await this.$1.runInTransaction(function(e){return r("LSHandleTaskSendSuccessForQueue2")(e,t)},"readwrite","background",void 0,i.id+":159")},a.$14=async function(t){await this.$1.runInTransaction(function(e){return r("LSHandleTaskSuccessOpsDownloadFailureForQueue")(e,t)},"readwrite",void 0,void 0,i.id+":167")},a.$15=async function(t){var e=r("LSVec").toArray(t.tasks).slice(0).map(function(e){return o("LSShape").toRecord(e)}),n=e[0];if(n!=null){var a=await o("ReQL").firstAsync(o("ReQL").fromTableAscending(this.$1.tables.pending_tasks).getKeyRange(n.task_id));return a==null?void 0:a.dataTraceId}},a.$16=async function(a,i){var t=this;if(a.network_payload!=null){var l=o("LSShape").toRecord(a.network_payload);(s||(s=r("JSScheduler"))).scheduleLoggingPriCallback(function(){return l&&(n("cr:6668")==null?void 0:n("cr:6668").recordTaskSending(l.tasks))});var u=this.$4;try{await Promise.all(r("LSVec").toArray(l.tasks).map(function(e){return o("LSShape").toRecord(e)}).map(function(n){var l=r("LSPlatformRequestId").generate();return t.$11([n],{databaseType:r("LSPlatformTaskSyncGroupId"),payload:o("LSJson").stringify(o("LSShape").ofRecord({label:n.label,payload:n.payload,version:u})),queueName:a.queue_name,requestId:l,syncChannel:o("LSMailboxInitialSyncCursor").taskChannel,type_:(e||(e=o("I64"))).of_int32(i)})}))}catch(e){}}},a.$17=async function(a,i){if(a.network_payload!=null){var t=o("LSShape").toRecord(a.network_payload),l=r("LSVec").toArray(t.tasks).map(function(e){return o("LSShape").toRecord(e)}),u=await this.$15(t);(s||(s=r("JSScheduler"))).scheduleLoggingPriCallback(function(){return t&&(n("cr:6668")==null?void 0:n("cr:6668").recordTaskSending(t.tasks))});var c=r("LSPlatformRequestId").generate(),d;try{d=await this.$11(l,{databaseType:r("LSPlatformTaskSyncGroupId"),payload:o("LSJson").stringify(o("LSShape").ofRecord(babelHelpers.extends({},t,{version_id:this.$4},u==null?{}:{data_trace_id:u}))),queueName:a.queue_name,requestId:c,syncChannel:o("LSMailboxInitialSyncCursor").taskChannel,type_:(e||(e=o("I64"))).of_int32(i)})}catch(e){e.RE_EXN_ID===o("LSPlatformRealtimeTransport").Timeout?o("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_tasks","send_fail_timeout"):e.RE_EXN_ID===o("LSPlatformRealtimeTransport").NotConnected?(o("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_tasks","send_fail_notconnected"),r("FBLogger")("messenger_web").warn("Publishing a task to the server not connected")):(o("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_tasks","send_fail_generic"),r("FBLogger")("messenger_web").warn("Error while publishing a task for request: %s, error %s",i,JSON.stringify(e))),await this.$12(a.queue_name)}if(d!=null&&d.type==="taskresponse")try{var m=d.downloadTask,p=d.payload,_={experiments:p.ex,sp:p.sp,syncScript:p.payload,target:p.target,taskNames:l.map(function(e){return e.label}).filter(Boolean)};await this.$6.evalWhenReady(m,_),await this.$13(a.queue_name),(s||(s=r("JSScheduler"))).scheduleLoggingPriCallback(function(){return t&&(n("cr:6668")==null?void 0:n("cr:6668").recordTaskSent(t.tasks,p.payload))})}catch(e){o("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_tasks","handle_task_failure"),r("FBLogger")("messenger_web").catching(e).mustfix("Encountered an error while processing a task response via realtime transport"),(e==null?void 0:e.name)==="dynamic_sproc_loading_timeout"&&r("gkx")("14417")?await this.$14(a.queue_name):await this.$12(a.queue_name)}}},a.decideWhatToDoWithTask=async function(t,n,a,i){var e=this,l=await r("MWPBeginHandlingPendingTasksForQueue")(t,{fireAndForgetTask:i,ignoreSoftDelay:!1,queueName:n,transportKey:a});r("promiseDone")((async function(){for(var t of l)await e.$18(o("LSShape").toRecord(t))})())},a.$18=async function(a){var t=this.$5,i=this.$19;function l(n,a){t.schedule(function(){r("promiseDone")(i(n,!1))},n,a!=null?(e||(e=o("I64"))).to_float(a):u)}var s=(e||(e=o("I64"))).to_int32(a.work_item_type);switch(s){case 1:await this.$17(a,3);break;case 5:await this.$16(a,4);break;case 3:l(a.queue_name,a.next_sync_ms);break;case 2:await n("cr:4031").handleLSWork(this.$1,a,o("CurrentMessengerUser").getAccountID());break;case 4:break;default:r("FBLogger")("messenger_web").warn("Unknown Task type of %s",s)}},a.$9=function(){var e=this,t=this.$1;return this.$2.onReconnect(function(n){o("LSMailboxInitialSyncCursor").isWebApp&&n===3&&r("qex")._("2082")===!0||(r("promiseDone")(t.runInTransaction(async function(e){var t=await o("ReQL").toArrayAsync(o("ReQL").fromTableAscending(e.network_requests).bounds({gte:o("ReQL").key("")}));await Promise.all(t.map(function(t){var n=t.taskQueueName;return r("LSHandleTaskSendFailureForQueue2")(e,n)}))},"readwrite",void 0,void 0,i.id+":446")),e.$10())})},a.$10=function(){var e=this;o("MWPlatformTaskUtils").checkAllPendingTasksForWork(this.$1,function(t){var n=t.queueName;return e.decideWhatToDoWithTask(e.$1,n)})},a.cleanup=function(){this.$7()},t})();l.default=m}),98);
__d("LSFetchBackupIds",["LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(o){return r[0]=t.i64.of_float(Date.now()),(function(e){t.logger(e).info(e)})("[EncryptedBackups][LSEncryptedBackupsFetchBackupIdsStoredProcedure] Beginning execution."),r[11]=t.i64.cast([0,0]),r[7]=r[11],r[8]=new t.Map,r[8].set("backup_tenancy",e[0]),r[8].set("trace_id",void 0),r[9]=t.toJSON(r[8]),t.storedProcedure(n("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",t.i64.cast([0,50008]),r[9],t.i64.cast([0,0]),t.i64.cast([0,93]),t.i64.cast([0,0]),void 0,r[7]).then(function(e){var t;return t=e,r[10]=t[0],t})},function(e){return r[1]=t.i64.of_float(Date.now()),r[2]=t.i64.random(),r[4]="Finishing execution. Execution time: ",r[5]=t.i64.to_string(t.i64.sub(r[1],r[0])),r[6]=" ms",r[3]="",(function(e){t.logger(e).info(e)})(["[EncryptedBackups][LSEncryptedBackupsFetchBackupIdsStoredProcedure] ",r[3],r[4],r[3],r[5],r[3],r[6]].join("")),t.i64.eq(t.i64.mod_(r[2],t.i64.cast([0,1e3])),t.i64.cast([0,0]))?(r[7]=",",r[8]=t.createArray(),t.nativeOperation(n("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFetchBackupIdsStoredProcedure",[r[4],r[7],r[5],r[7],r[6]].join(""),r[8],t.i64.cast([0,4]))):t.resolve()}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSEncryptedBackupsFetchBackupIdsStoredProcedure",e.__tables__=["encrypted_backups"],a.exports=e}),null);
__d("LSFetchBackupIdsStoredProcedure",["LSFetchBackupIds","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSFetchBackupIds"),a.backupTenancy,a.traceId,a.isUiBlocking);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("isInstamadilloEB",["qex"],(function(t,n,r,o,a,i,l){"use strict";function e(){return r("qex")._("670")===!0}l.default=e}),98);
__d("MWEncryptedBackupsListenForChangesToBackupStateInitPath",["EBSMAPI","I64","LSAuthorityLevel","LSEncryptedBackupsBackupTenancy","LSFactory","LSFetchBackupIdsStoredProcedure","LSIntEnum","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWEncryptedBackupsFirstRestoreUpsellTime","QPLEvent","QPLUserFlow","ReQL","WebSession","isInstamadilloEB","promiseDone","qex"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=r("qex")._("121")===!0;function d(t){function n(){r("promiseDone")(r("EBSMAPI").fetchBackupIds("MWEncryptedBackupsListenForChangesToBackupStateInitPath"),function(){return void 0})}function a(){var n=o("ReQL").fromTableAscending(t.tables.encrypted_backups),a=n.subscribe(function(t,n){n.operation==="delete"||!(e||(e=o("I64"))).equal(n.value.authorityLevel,(s||(s=o("LSIntEnum"))).ofNumber(r("LSAuthorityLevel").AUTHORITATIVE))||(a(),r("QPLUserFlow").getActiveFlowIDs().includes((u||(u=o("QPLEvent"))).getMarkerId(o("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent))&&o("MWChatEncryptedBackupsLogging").endSuccess({event:o("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent}))}),l=o("MWEncryptedBackupsFirstRestoreUpsellTime").getFirstRestoreUpsellTime();r("QPLUserFlow").getActiveFlowIDs().includes((u||(u=o("QPLEvent"))).getMarkerId(o("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent))||r("QPLUserFlow").start(o("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent,{annotations:{string:{ebSessionIdentifier:l,fetchBackupIdsVersion:"msys",sessionTabId:o("WebSession").getId()}}}),r("promiseDone")(t.runInTransaction(function(e){return r("LSFetchBackupIdsStoredProcedure")(r("LSFactory")(e),{backupTenancy:(s||(s=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsBackupTenancy").PRODUCTION),isUiBlocking:!1})},"readwrite",void 0,void 0,i.id+":86"),function(){return void 0})}var l=n;(c||r("isInstamadilloEB")())&&(l=a,l());var d=o("ReQL").fromTableAscending(t.tables.encrypted_backups_status_trigger);return d.subscribe(l)}function m(e){}var p={listenForChangesToBackupState:d,preloadEBData:m};l.default=p}),98);
__d("MWPlatformTaskSystem",["LSPlatformRequestScheduler","MWPlatformTaskUtils"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e,t){var n=this;this.$1=e,this.$2=t,this.$3=new(r("LSPlatformRequestScheduler")),this.$4=o("MWPlatformTaskUtils").checkQueuesWhenPendingTaskTableUpdates(e,function(t){var r=t.queueName,o=t.transportKey;return n.$6(e,r,o,!1)}),this.$5=o("MWPlatformTaskUtils").checkQueuesWhenPendingFireForgetTaskTableUpdates(e,function(t){var r=t.queueName,o=t.transportKey;return n.$6(e,r,o,!0)}),this.$7()}var t=e.prototype;return t.$6=async function(t,n,r,o){await this.$2.decideWhatToDoWithTask(t,n,r,o)},t.$7=function(){var e=this;o("MWPlatformTaskUtils").checkAllPendingTasksForWork(this.$1,function(t){var n=t.queueName;return e.$6(e.$1,n)})},t.cleanup=function(){this.$4.forEach(function(e){return e()}),this.$5.forEach(function(e){return e()}),this.$2.cleanup()},e})();l.default=e}),98);
__d("EBLS",["EBDB","EBDBEbsmApi","EBEpochChangeListener","EBIsEbEnabled","EBIsEbEnabledSubscriber","EBLogger","EBOnboardDeviceWithAutomaticEB","EBReadyNotifier","EBReenrollmentTriggerListener","EBResumeAutomaticEBInitialisation","EBWorkerAddDeviceUtils","I64","LSAuthorityLevel","LSDataTraceFlushDeferred","LSDatascriptEvaluatorMaybeDeferred","LSDedicatedMqttChannel","LSDefaultSyncGroups","LSDeleteAllAndInsertConnectivityStatusStoredProcedure","LSEncryptedBackupsBackupTenancy","LSFactory","LSIntEnum","LSInternetConnectionState","LSJSEBInMemoryStorage","LSMetadata","LSPlatformDeviceId","LSPlatformMessengerSyncParams","LSPlatformMqttRealtimeTransport","LSPlatformRealtimeTransport","LSPlatformTaskSystemTransport","LSReStoreWrapper","LSVersion","MAWBridge","MAWEBLSInWorkerSwitch","MAWLSVaultingHooks","MAWODSProxy","MAWVaultMaterialsStorage","MWEncryptedBackupsListenForChangesToBackupStateInitPath","MWPlatformTaskSystem","MqttEnv","QPLUserFlow","ReQL","ServerAppID","WAAssertUnreachable","WAOdsEnums","WAPromiseDelays","WAResolvable","emptyFunction","err","getMWLSRegion","justknobx","nullthrows","promiseDone","qpl","vulture"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T,D,x,$=o("EBLogger").EBLogger().tags(["EBLS"]),P=r("qpl")._(521478817,"2806");function N(){return F()}var M,w,A;function F(){return M?M.promise:O({copyKeys:!0,getNewDB:!1}).promise}function O(e){M!=null&&!M.isSettled&&M.reject(r("err")("LSClient is not settled")),w!=null&&!w.isSettled&&w.reject(r("err")("LSDBStorage is not settled"));var t=new(o("WAResolvable")).Resolvable;return M=t,w=null,B(e).then(function(e){t.resolve(e)},function(e){t.reject(e)}),t}async function B(t){var n,a=t.getNewDB;o("EBReadyNotifier").resetEBReady(),(n=r("QPLUserFlow")).start(P,{timeoutInMs:6e4}),n.addPoint(P,"ls_storage_creation_start");var i=await q(a);n.addPoint(P,"ls_storage_creation_end"),n.addPoint(P,"eb_worker_add_device_skipped"),n.endSuccess(P),o("EBReadyNotifier").markEBReady(),$.DEBUG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Initialised db"])));var l={appId:r("nullthrows")(r("ServerAppID").app_id),executeGraphQLLightSpeedRequest:async function(){r("vulture")("ZrOlCWyJ0L0hG2xX4QdNxz1doLM=");for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=await o("MAWBridge").getBridge().sendAndReceive("event","executeGraphQLLightSpeedRequest",{args:t});return a},getDb:q,getEval:function(){return r("LSDatascriptEvaluatorMaybeDeferred")()},platformName:"Messenger",realtimeUnderylingTransport:function(){return Promise.resolve(function(e,t){var n;return r("LSPlatformMqttRealtimeTransport")(r("LSVersion"),t,{getInstance:o("LSDedicatedMqttChannel").getInstance(function(){return!0},(n={},n[o("MqttEnv").MqttGkNames.mqttweb_global_connection_counter]=!1,n),function(e,t){return t},r("emptyFunction")),shutdownAndClear:o("LSDedicatedMqttChannel").shutdownAndClear})})},region:r("getMWLSRegion")(),schemaVersion:r("LSVersion"),sendHardcodedInitSync:!1,syncParams:r("LSPlatformMessengerSyncParams")};$.DEBUG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["created config"]))),r("QPLUserFlow").addAnnotations(P,{string:{appId:l.appId}});var c=o("LSPlatformDeviceId").getDeviceIdForProviderType("ephemeral");r("QPLUserFlow").addPoint(P,"platform_client_init_start");var d=await G(i,l,c);return r("QPLUserFlow").addPoint(P,"platform_client_init_end"),A=await W(i),$.DEBUG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["finished init successfully"]))),d}async function W(e){var t=z(e);return await o("EBIsEbEnabledSubscriber").initIsEbEnabledPubSub(e),await o("EBEpochChangeListener").initEBEpochChangeListener(e),await o("EBReenrollmentTriggerListener").initEBReenrollmentTriggerListener(e),o("EBResumeAutomaticEBInitialisation").resumeAutomaticEBInitialisation(),r("justknobx")._("862")&&o("EBOnboardDeviceWithAutomaticEB").onboardDeviceWithAutomaticEB(),t}async function q(e){if(e===void 0&&(e=!1),!e&&w!=null)return w.promise;var t=new(o("WAResolvable")).Resolvable;w=t,await o("MAWVaultMaterialsStorage").setupVaultMaterials();var n={clearEbStores:o("EBDB").clearEbStores,flushEBSMtoEBDB:o("EBDBEbsmApi").flushEBSMtoEBDB,rehydrateEBSMFromEBDB:o("EBDBEbsmApi").rehydrateEBSMFromEBDB},a=await o("LSJSEBInMemoryStorage").makeReStorePersistence(n),l=o("LSReStoreWrapper").createLSReStore(a,o("LSMetadata").schema,[r("MAWLSVaultingHooks")],void 0);return n.updateEBSM=o("EBDBEbsmApi").updateEBSM(l),await l.runInTransaction(async function(e){await o("LSDefaultSyncGroups").seedDb(e,void 0)},"readwrite","ui",void 0,i.id+":245"),t.resolve(l),l}async function U(){M!=null&&await o("EBWorkerAddDeviceUtils").clearLSEBSMTables(await q())}function V(e){var t=r("MWEncryptedBackupsListenForChangesToBackupStateInitPath").listenForChangesToBackupState(e);return function(){t()}}function H(e,t){var n=t==="Connected"?(D||(D=o("LSIntEnum"))).ofNumber(r("LSInternetConnectionState").CONNECTED):(D||(D=o("LSIntEnum"))).ofNumber(r("LSInternetConnectionState").NOT_CONNECTED);$.DEBUG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Platform client sync connection status: ",""])),t),r("promiseDone")(e.runInTransaction(function(e){return r("LSDeleteAllAndInsertConnectivityStatusStoredProcedure")(r("LSFactory")(e),{internetConnectionState:n})},"readwrite",void 0,void 0,i.id+":283"),function(){$.DEBUG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Platform client sync connection status set successfully"])))},function(e){throw $.MUSTFIX(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Platform client sync connection status set failed: ",""])),e==null?void 0:e.message),e})}async function G(e,t,n){$.DEBUG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Platform client sync starting..."])));var a=await t.getEval();$.DEBUG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Getting datascript evaluator success"])));var i=a()(e);$.DEBUG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["Clearing epoch before resume sync..."]))),$.DEBUG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["Starting realtime transport"])));var l=await t.realtimeUnderylingTransport(),s=o("LSPlatformRealtimeTransport").LSPlatformRealtimeTransport(l,t.appId,n);$.DEBUG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Starting task system"])));var u=new(r("MWPlatformTaskSystem"))(e,new(r("LSPlatformTaskSystemTransport"))(e,s,i,t.schemaVersion));$.DEBUG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["Starting backup state listeners"])));var c=null;r("QPLUserFlow").addPoint(P,"sync_system_creation_skipped");var d=V(e);$.DEBUG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["Watching for expired traces"])));var m;return r("promiseDone")(o("LSDataTraceFlushDeferred").watchForExpiredTraces(e).then(function(e){m=e})),$.DEBUG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["Subscribing to mqtt sync status change events"]))),s.onConnectionStatusChange(function(t){H(e,t)}),$.DEBUG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["Platform client sync starting sucess"]))),{cleanup:function(){$.DEBUG(S||(S=babelHelpers.taggedTemplateLiteralLoose(["Platform client sync cleaning up"]))),u==null||u.cleanup(),s.cleanup(),c==null||c.cleanup(),d(),m==null||m(),A.forEach(function(e){return e()})},db:e}}function z(e){var t=[],n=j(e);return t.push(n),t}function j(e){var t=null;function n(e){var n=t===null?"null":String(t),a=String(e);o("MAWODSProxy").odsBumpEntityKey({entity:o("WAOdsEnums").Entity.EB_SWITCH_STATE,key:"ebls_switch.state_transition."+n+"_to_"+a}),$.DEBUG(R||(R=babelHelpers.taggedTemplateLiteralLoose(["EBLS Switch state transition: "," -> ",""])),n,a),t===!0&&e===!1&&($.DEBUG(L||(L=babelHelpers.taggedTemplateLiteralLoose(["EBLS Switch detected true->false transition, setting timeout to check self-correction"]))),o("WAPromiseDelays").delayMs(1e3).then(async function(){var e=await o("EBIsEbEnabled").isEBEnabled(),t=e===!0;$.DEBUG(E||(E=babelHelpers.taggedTemplateLiteralLoose(["EBLS Switch true->false correction check: corrected=",", current_state=",""])),String(t),String(e)),o("MAWODSProxy").odsBumpEntityKey({entity:o("WAOdsEnums").Entity.EB_SWITCH_STATE,key:"ebls_switch.true_to_false_correction."+(t?"corrected":"not_corrected")});var n=r("MAWEBLSInWorkerSwitch").isEnabled(),a=e===n?"match":"mismatch";o("MAWODSProxy").odsBumpEntityKey({entity:o("WAOdsEnums").Entity.EB_SWITCH_STATE,key:"ebls_switch.true_to_false_check."+a})}).catch(function(e){$.catching(e).MUSTFIX(k||(k=babelHelpers.taggedTemplateLiteralLoose(["EBLS Switch failed to check true->false correction"])))})),r("MAWEBLSInWorkerSwitch").set(e),t=e}return o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.tables.secure_encrypted_backups_client_state)).then(function(e){e!=null?n(K(e)):n(!1)}).catch(function(e){$.catching(e).MUSTFIX(I||(I=babelHelpers.taggedTemplateLiteralLoose(["Failed to get initial state for EBLS Switch"])))}),e.tables.secure_encrypted_backups_client_state.subscribe(function(e,t){switch($.DEBUG(T||(T=babelHelpers.taggedTemplateLiteralLoose(["EBLS Switch state changed. operation: ",""])),t.operation),t.operation){case"delete":n(!1);break;case"add":case"put":n(K(t.value));break;default:throw t.operation,r("WAAssertUnreachable")(t.operation)}})}function K(e){var t=e.authorityLevel,n=e.backupTenancy;if(t==null)return!1;var a=n!=null?n:(D||(D=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsBackupTenancy").PRODUCTION);return(x||(x=o("I64"))).equal(a,(D||(D=o("LSIntEnum"))).ofNumber(r("LSEncryptedBackupsBackupTenancy").PRODUCTION))&&(x||(x=o("I64"))).equal(t,(D||(D=o("LSIntEnum"))).ofNumber(r("LSAuthorityLevel").AUTHORITATIVE))}l.init=N,l.genLSClient=F,l.getLSStorage=q,l.clearEBSMStorage=U,l.platformClientInit=G}),98);
__d("EBMinosWasmDeriveAttachmentAccessTokenSecret",["EBMinosTypes","EBMinosWasm.pb","EBMinosWasmReactorSingleton","WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";function e(){function e(e){var t=e.attachmentAccessTokenSecret;return o("WAResultOrError").makeResult(o("EBMinosTypes").unsafeCastToAttachmentAccessTokenSecret(t))}return async function(n){var t=n.mediaKey;return await o("EBMinosWasmReactorSingleton").DEPRECATED_minosCommand({InputSpec:o("EBMinosWasm.pb").MinosCommandSpec,ResultSpec:o("EBMinosWasm.pb").DeriveAttachmentAccessTokenSecretResultSpec,validateResult:e},{deriveAttachmentAccessTokenSecret:{mediaKey:t}})}}var s=e();l.deriveAttachmentAccessTokenSecret=s}),98);
__d("EBMinosWasmDeriveAttachmentPrimaryKeySecret",["EBMinosTypes","EBMinosWasm.pb","EBMinosWasmReactorSingleton","WAResultOrError"],(function(t,n,r,o,a,i,l){"use strict";function e(){function e(e){var t=e.attachmentPrimaryKeySecret;return o("WAResultOrError").makeResult(o("EBMinosTypes").unsafeCastToAttachmentPrimaryKeySecret(t))}return async function(n){var t=n.mediaKey;return await o("EBMinosWasmReactorSingleton").DEPRECATED_minosCommand({InputSpec:o("EBMinosWasm.pb").MinosCommandSpec,ResultSpec:o("EBMinosWasm.pb").DeriveAttachmentPrimaryKeySecretResultSpec,validateResult:e},{deriveAttachmentPrimaryKeySecret:{mediaKey:t}})}}var s=e();l.deriveAttachmentPrimaryKeySecret=s}),98);
__d("EBWorkerEBDBApi",["EBDB","EBDBConsistencyApi","EBLS","LSAuthorityLevel","LSEncryptedBackupsBackupTenancy","WALogger","WAResolvable"],(function(t,n,r,o,a,i,l){"use strict";var e,s=new(o("WAResolvable")).Resolvable;async function u(){var t=await o("EBLS").genLSClient();try{await o("EBDBConsistencyApi").startListeningDeviceRegistrations(t.db,o("EBDB").EBDBEnvironment.Worker)}catch(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Error on EBDB init in Worker: ",""])),t)}finally{s.resolve(t.db)}}async function c(e){await o("EBDBConsistencyApi").trackOverprompting(o("EBDB").EBDBEnvironment.Worker,e)}async function d(e){var t=await s.promise;await o("EBDBConsistencyApi").addNewDevice(t,o("EBDB").EBDBEnvironment.Worker,e)}async function m(e){var t=await s.promise;return o("EBDBConsistencyApi").trackConsistency(t,o("EBDB").EBDBEnvironment.Worker,e),o("EBDBConsistencyApi").getDeviceId()}async function p(){var e=await o("EBDB").getEBDB(),t=await e.store("secure_encrypted_backups_client_state").readAll();return t[0]}async function _(){var e=await o("EBDB").getEBDB(),t=await e.store("secure_encrypted_backups_client_state").readAll();if((t==null?void 0:t.length)===0)return!1;var n=t[0],a=n.authorityLevel,i=n.backupTenancy;if(a==null)return!1;var l=i!=null?i:r("LSEncryptedBackupsBackupTenancy").PRODUCTION;return Number(l)===r("LSEncryptedBackupsBackupTenancy").PRODUCTION&&Number(a)===r("LSAuthorityLevel").AUTHORITATIVE}l.startListeningEBDeviceRegistrations=u,l.trackOverprompting=c,l.addNewDevice=d,l.trackConsistency=m,l.getSecureEBClientState=p,l.isEBEnabledEBDB=_}),98);
__d("PublicKeyEncryptionUtils",["Promise","UInt8Array","XPlatReactCrypto"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e,t){}function u(e){return e!=null?e:new Uint8Array(0).buffer}function c(e,t,n,r,a){return o("UInt8Array").concatBytes([e,t,n,r,a]).buffer}function d(e,t,n,r){return o("XPlatReactCrypto").subtleImportKey("raw",e.buffer,"HKDF",!1,["deriveKey"]).then(function(e){return o("XPlatReactCrypto").subtleDeriveKey({hash:"SHA-256",info:n,name:"HKDF",salt:t},e,{length:256,name:"AES-GCM"},!1,[r])})}var m="key length is not 32";function p(e,t){if(e.length!==32)return t(m)}function _(t){return new(e||(e=n("Promise")))(function(e,n){return p(t,n),e()})}var f=32;l.assertValidCurvePoint=s,l.getSalt=u,l.concatAad=c,l.getAesKey=d,l.testKeyLength=p,l.assertKeyLength=_,l.keyLength=f}),98);
__d("PublicEncryptionCreateDecryptedData",["CryptoLogger","Promise","PublicKeyEncryptionUtils","RetUtil","XPlatReactCrypto","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("requireDeferred")("PublicKeyCrypto").__setRef("PublicEncryptionCreateDecryptedData"),u=r("requireDeferred")("X25519").__setRef("PublicEncryptionCreateDecryptedData");function c(e,t){var n=1+o("PublicKeyEncryptionUtils").keyLength+16,r=e.length;r<1+o("PublicKeyEncryptionUtils").keyLength+16&&t("CipherText length is "+r+", < "+n)}function d(e,t,n){var r=t[0];if(r!==e)return n("Unexpected version "+r)}function m(t){return new(e||(e=n("Promise")))(function(e,n){return d(1,t,n),c(t,n),e()})}function p(t,r){return new(e||(e=n("Promise")))(function(e,n){return o("PublicKeyEncryptionUtils").assertValidCurvePoint(t,n),o("PublicKeyEncryptionUtils").assertValidCurvePoint(r,n),e()})}function _(t,r,a,i,l,c){var d,_=new Uint8Array(l),f=new Uint8Array([1]),g=(d=o("PublicKeyEncryptionUtils")).getSalt(i),h=new Uint8Array(t),y=new Uint8Array(a),C=new Uint8Array(r),b=new Uint8Array(c);return(e||(e=n("Promise"))).all([o("PublicKeyEncryptionUtils").assertKeyLength(h),o("PublicKeyEncryptionUtils").assertKeyLength(C),o("PublicKeyEncryptionUtils").assertKeyLength(y)]).then(function(){return m(b)}).then(function(){return u.load()}).then(function(t){var r=b.slice(1,o("PublicKeyEncryptionUtils").keyLength+1),a=t.publicKeyFromBytes(r,t.KeyPurpose.Encryption);return p(a,y).then(function(){var i=o("PublicKeyEncryptionUtils").concatAad(f,y,h,r,_),l=function(o,i,l){var r=t.publicKeyFromBytes(o,t.KeyPurpose.Encryption),s=t.publicKeyFromBytes(i,t.KeyPurpose.Encryption),u=t.secretKeyFromBytes(l,t.KeyPurpose.Encryption);return r==null||s==null||u==null||a==null?(e||(e=n("Promise"))).resolve():(e||(e=n("Promise"))).resolve([r,s,u,a])};return l(h,y,C).then(function(e){if(e!=null)return{ephemeralPub:e[3],innerAad:i,receiverPriv:e[2],receiverPub:e[0],senderPub:e[1]}})})}).then(function(e){if(e!=null){var t=e.ephemeralPub,n=e.receiverPriv,r=e.senderPub,a=e.innerAad;return s.load().then(function(e){return e.receiverDeriveSharedSecret(n,t,r)}).then(function(e){return e==null?null:o("PublicKeyEncryptionUtils").getAesKey(e,g,a,"decrypt")}).then(function(e){if(e!=null){var t=new Uint8Array(12).buffer,n=b.slice(o("PublicKeyEncryptionUtils").keyLength+1).buffer;return o("XPlatReactCrypto").subtleDecrypt({additionalData:a,iv:new Uint8Array(t),name:"AES-GCM",tagLength:128},e,n)}})}}).then(function(t){return(e||(e=n("Promise"))).resolve(o("RetUtil").getNullableRetResult(t))}).catch(function(t){var r=o("CryptoLogger").CryptoLogger("public_encryption_create_decrypted_data");return o("CryptoLogger").captureError(r,t).mustfix("Creation of decrypted data for public encryption failed"),(e||(e=n("Promise"))).resolve(o("RetUtil").getNullableRetResult(void 0))})}l.default=_}),98);
__d("PublicEncryptionCreateEncryptedData",["CryptoLogger","Promise","PublicKeyEncryptionUtils","RetUtil","UInt8Array","XPlatReactCrypto","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("requireDeferred")("PublicKeyCrypto").__setRef("PublicEncryptionCreateEncryptedData"),u=r("requireDeferred")("X25519").__setRef("PublicEncryptionCreateEncryptedData");function c(e,t){if(e.byteLength>32)return t("PSK is too long")}function d(t,r){return new(e||(e=n("Promise")))(function(e,n){return o("PublicKeyEncryptionUtils").assertValidCurvePoint(r,n),c(t,n),e()})}function m(t,r,a,i,l,c){var m,p=new Uint8Array([1]),_=new Uint8Array(l),f=(m=o("PublicKeyEncryptionUtils")).getSalt(i),g=new Uint8Array(t),h=new Uint8Array(r),y=new Uint8Array(a);return(e||(e=n("Promise"))).all([o("PublicKeyEncryptionUtils").assertKeyLength(g),o("PublicKeyEncryptionUtils").assertKeyLength(h),o("PublicKeyEncryptionUtils").assertKeyLength(y)]).then(function(){return d(f,g)}).then(function(){return u.load()}).then(function(t){var r=t.generateKeys(t.KeyPurpose.Encryption),a=r.pk,i=o("PublicKeyEncryptionUtils").concatAad(p,h,g,a,_),l=function(o,a,i){var r=t.publicKeyFromBytes(o,t.KeyPurpose.Encryption),l=t.publicKeyFromBytes(a,t.KeyPurpose.Encryption),s=t.secretKeyFromBytes(i,t.KeyPurpose.Encryption);return r==null||l==null||s==null?(e||(e=n("Promise"))).resolve():(e||(e=n("Promise"))).resolve([r,l,s])};return l(g,h,y).then(function(e){return e==null?null:{ephemeralPriv:r.sk,ephemeralPubBytes:r.pk,innerAad:i,receiverPub:e[0],senderPriv:e[2],senderPub:e[1]}})}).then(function(e){if(e!=null){var t=e.ephemeralPubBytes,n=e.ephemeralPriv,r=e.senderPriv,a=e.receiverPub,i=e.innerAad;return s.load().then(function(e){return e.senderDeriveSharedSecret(r,n,a)}).then(function(e){if(e!=null)return o("PublicKeyEncryptionUtils").getAesKey(e,f,i,"encrypt")}).then(function(e){if(e!=null){var t=new Uint8Array(12).buffer;return o("XPlatReactCrypto").subtleEncrypt({additionalData:i,iv:new Uint8Array(t),name:"AES-GCM",tagLength:128},e,c)}}).then(function(e){if(e!=null){var n=new Uint8Array(e);return o("UInt8Array").concatBytes([p,t,n]).buffer}})}}).then(function(t){return(e||(e=n("Promise"))).resolve(o("RetUtil").getNullableRetResult(t))}).catch(function(t){var r=o("CryptoLogger").CryptoLogger("public_encryption_create_encrypted_data");return o("CryptoLogger").captureError(r,t).mustfix("Creation of encrypted data for public encryption failed"),(e||(e=n("Promise"))).resolve(o("RetUtil").getNullableRetResult(void 0))})}l.default=m}),98);
__d("WACryptoEd25519",["WACryptoPrimitives","err"],(function(t,n,r,o,a,i,l){"use strict";var e=null;function s(t){var n=e;e=[];try{return t()}finally{(e!=null?e:[]).forEach(function(e){return void e.fill(0)}),e=n}}function u(t,n){if(e==null)throw r("err")("allocate called outside of active scope");return new t(n)}function c(e,t,n){o("WACryptoPrimitives").lowlevel.crypto_hash(e,t,n)}function d(e,t){for(var n=0;n<64;++n)t[n]=e[n],e[n]=0;_(e,t),t.fill(0)}function m(e,t){var n=[p(),p(),p(),p()];o("WACryptoPrimitives").lowlevel.scalarbase(n,t),j(e,n)}function p(e){var t=u(Float64Array,16);if(e){if(e.length>16)throw r("err")("Incorrect initialiser array provided to the fieldElement");for(var n=0;n<e.length;n++)t[n]=e[n]}return t}function _(e,t){o("WACryptoPrimitives").lowlevel.modL(e,t)}var f=function(){return p([0])},g=function(){return p([1])},h=function(){return p([2])},y=function(){return p([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139])};function C(){return[p(),p(),p(),p()]}function b(){return[p(),p(),p(),p()]}function v(){return[p(),p(),p()]}function S(e,t){for(var n=0,r=t;r>0;){var o=r%65536;e[n]=o,r=(r-o)/65536,n++}}function R(e,t){return Q(e,t)?0:1}function L(e){var t=o("WACryptoPrimitives").lowlevel.pack25519,n=u(Uint8Array,32);return t(n,e),n[0]&1}function E(e,t){var n=o("WACryptoPrimitives").lowlevel.M,r=o("WACryptoPrimitives").lowlevel.S,a=h(),i=p();r(i,t),n(e,a,i)}function k(e,t){var n=o("WACryptoPrimitives").lowlevel.A,r=o("WACryptoPrimitives").lowlevel.M,a=o("WACryptoPrimitives").lowlevel.S,i=f(),l=g(),s=p(),u=p(),c=p(),d=p();S(i,486662),a(s,t),r(u,i,t),n(c,s,u),n(d,c,l),r(e,t,d)}function I(e,t,n){n===1&&e.set(t)}var T=new Uint8Array([176,160,14,74,39,27,238,196,120,228,47,173,6,24,67,47,167,215,251,61,153,0,77,43,11,223,193,79,128,36,131,43]);function D(e,t){var n,r=(n=o("WACryptoPrimitives")).lowlevel.M,a=n.lowlevel.S,i=n.lowlevel.pow2523,l=n.lowlevel.unpack25519,s=p();l(s,T);var u=p();i(u,t);var c=p();r(c,t,u);var d=p();a(d,c);var m=p();r(m,c,s),I(c,m,1^R(d,t)),e.set(c)}function x(e,t){var n=o("WACryptoPrimitives").lowlevel.A,r=o("WACryptoPrimitives").lowlevel.M,a=o("WACryptoPrimitives").lowlevel.Z,i=g(),l=p(),s=p(),u=p();a(l,t,i),n(s,t,i),K(u,s),r(e,l,u)}function $(e,t){var n=o("WACryptoPrimitives").lowlevel.Z,r=f();n(e,r,t)}function P(e,t){var n=o("WACryptoPrimitives").lowlevel.M;n(e[0],t[0],t[3]),n(e[1],t[1],t[2]),n(e[2],t[2],t[3])}function N(e,t){var n=o("WACryptoPrimitives").lowlevel.M;n(e[0],t[0],t[3]),n(e[1],t[1],t[2]),n(e[2],t[2],t[3]),n(e[3],t[0],t[1])}function M(e,t){var n=o("WACryptoPrimitives").lowlevel.A,r=o("WACryptoPrimitives").lowlevel.S,a=o("WACryptoPrimitives").lowlevel.Z;r(e[0],t[0]),r(e[2],t[1]),E(e[3],t[2]),n(e[1],t[0],t[1]);var i=p();r(i,e[1]),n(e[1],e[2],e[0]),a(e[2],e[2],e[0]),a(e[0],i,e[1]),a(e[3],e[3],e[2])}var w=new Uint8Array([6,126,69,255,170,4,110,204,130,26,125,75,209,211,161,197,126,79,252,3,220,8,123,210,187,6,160,96,244,237,38,15]);function A(e,t,n){var r=o("WACryptoPrimitives").lowlevel.M,a=o("WACryptoPrimitives").lowlevel.unpack25519,i=p();a(i,w);var l=p();x(l,t);var s=p();k(s,t);var u=p();D(u,s);var c=p();r(c,t,i);var d=p();K(d,u);var m=p();r(m,c,d);var _=p();$(_,m),I(m,_,L(m)^n),e[0].set(m),e[1].set(l),e[2].set(g()),r(e[3],e[0],e[1])}function F(e,t){e[0].set(t[0]),e[1].set(t[1]),e[2].set(t[2])}function O(e,t){var n=v();F(n,t),M(e,n)}function B(e,t){var n=b(),r=v();O(n,t),P(r,n),M(n,r),P(r,n),M(n,r),N(e,n)}function W(e){var t,n=(t=o("WACryptoPrimitives")).lowlevel.M,r=t.lowlevel.S,a=t.lowlevel.pack25519,i=t.lowlevel.pow2523,l=p(),s=p(),u=p(),c=p(),d=p();i(l,e),r(s,l),r(u,s),n(c,u,e),n(d,c,e);var m=new Uint8Array(32);return a(m,d),1&m[31]}function q(e,t){$(e[0],t[0]),e[1].set(t[1]),e[2].set(t[2]),$(e[3],t[3])}function U(e,t){var n=C(),r=X(n,t);return r!==0?-1:(q(e,n),0)}function V(e,t){var n=o("WACryptoPrimitives").lowlevel.A,r=o("WACryptoPrimitives").lowlevel.M,a=t,i=g(),l=f();S(l,486662);var s=p();E(s,a);var u=p();n(u,s,i);var c=p();K(c,u);var d=p();r(d,c,l);var m=p();$(m,d);var _=p();k(_,m);var h=W(_),y=p([0]);I(y,l,h);var C=p();n(C,m,y);var b=p();$(b,C),I(C,b,h),e.set(C)}function H(e){var t=o("WACryptoPrimitives").lowlevel.unpack25519,n=o("WACryptoPrimitives").hash(e),r=(n[31]&128)>>7;n[31]&=127;var a=p();t(a,n);var i=p();G(i,a);var l=C();A(l,i,r);var s=C();return B(s,l),s}function G(e,t){return s(function(){return V(e,t)})}function z(e){return s(function(){return H(e)})}function j(e,t){var n=p(),r=p(),a=p(),i=o("WACryptoPrimitives").lowlevel.M,l=o("WACryptoPrimitives").lowlevel.pack25519;K(a,t[2]),i(n,t[0],a),i(r,t[1],a),l(e,r);var s=new Uint8Array(32);l(s,n),e[31]^=(s[0]&1)<<7}function K(e,t){var n=p();n.set(t);for(var r=o("WACryptoPrimitives").lowlevel.M,a=o("WACryptoPrimitives").lowlevel.S,i=253;i>=0;--i)a(n,n),i!==2&&i!==4&&r(n,n,t);e.set(n)}function Q(e,t){var n=o("WACryptoPrimitives").lowlevel.crypto_verify_32,r=o("WACryptoPrimitives").lowlevel.pack25519,a=new Uint8Array(32),i=new Uint8Array(32);return r(a,e),r(i,t),n(a,0,i,0)}function X(e,t){var n,r=(n=o("WACryptoPrimitives")).lowlevel.A,a=n.lowlevel.D,i=n.lowlevel.M,l=n.lowlevel.S,s=n.lowlevel.Z,u=n.lowlevel.pow2523,c=n.lowlevel.set25519,d=n.lowlevel.unpack25519,m=p(),_=p(),h=p(),C=p(),b=p(),v=p(),S=p();return c(e[2],g()),d(e[1],t),l(h,e[1]),i(C,h,a),s(h,h,e[2]),r(C,e[2],C),l(b,C),l(v,b),i(S,v,b),i(m,S,h),i(m,m,C),u(m,m),i(m,m,h),i(m,m,C),i(m,m,C),i(e[0],m,C),l(_,e[0]),i(_,_,C),Q(_,h)&&i(e[0],e[0],y()),l(_,e[0]),i(_,_,C),Q(_,h)?-1:(Y(e[0])===t[31]>>7&&s(e[0],f(),e[0]),i(e[3],e[0],e[1]),0)}function Y(e){var t=o("WACryptoPrimitives").lowlevel.pack25519,n=new Uint8Array(32);return t(n,e),n[0]&1}l.runInAllocationScope=s,l.allocate=u,l.hashSha512=c,l.reduce=d,l.scalarmultBase=m,l.fieldElement=p,l.modL=_,l.p3Element=C,l.unpack=U,l.elligator=G,l.hashToPoint=z,l.pack=j,l.inv25519=K,l.unpackneg=X}),98);
__d("WASignalSignatures",["Promise","WACryptoDependencies","WACryptoEd25519","WACryptoPrimitives","WAHex","WALongInt","WASignalKeys","WASignalLocalStorageProtocol.pb","WASignalOther","decodeProtobuf","err"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e,t,n){return o("WACryptoEd25519").runInAllocationScope(function(){var r,a=t.length,i=e.privateKey,l=new Uint8Array(32);(r=o("WACryptoEd25519")).scalarmultBase(l,i);var s=l[31]&128,u=new Uint8Array(a+128);u[0]=254,u.fill(255,1,32),u.set(i,32),u.set(t,64),u.set(n,a+64);var c=r.allocate(Uint8Array,64);r.hashSha512(c,u,a+128),u.set(l,32);var d=r.allocate(Float64Array,64);r.reduce(c,d),r.scalarmultBase(u,c);var m=r.allocate(Uint8Array,64);r.hashSha512(m,u,a+64),r.reduce(m,d);var p,_;for(p=0;p<32;++p)d[p]=c[p];for(p=0;p<32;++p)for(_=0;_<32;++_)d[p+_]+=m[p]*i[_];return r.modL(u.subarray(32,64),d),{pubKeyNegative:s!==0,signedMsg:u}})}function u(t,r){return(e||(e=n("Promise"))).resolve().then(function(){var e=o("WASignalOther").makeBytes(64);return o("WACryptoDependencies").getCrypto().getRandomValues(e),d(t,r,e)})}function c(e,t,n){var r=n[63];return r&96?!1:o("WACryptoEd25519").runInAllocationScope(function(){var a,i,l=(a=o("WACryptoPrimitives")).lowlevel.A,s=a.lowlevel.M,u=a.lowlevel.Z,c=a.lowlevel.pack25519,d=a.lowlevel.unpack25519,m=(i=o("WACryptoEd25519")).allocate(Uint8Array,64);m.set(n),m[63]=r&127;var p=i.fieldElement(),_=i.fieldElement(),f=i.fieldElement(),g=i.fieldElement(),h=i.fieldElement(),y=i.allocate(Uint8Array,32),C=i.fieldElement();return C[0]=1,d(p,e.subarray(1)),u(_,p,C),l(f,p,C),i.inv25519(g,f),s(h,_,g),c(y,h),y[31]=y[31]&127|r&128,a.signDetachedVerify(t,m,y)})}function d(e,t,n){var r=s(e,t,n),a=o("WASignalOther").sliceBytes(r.signedMsg,0,64);return a[63]=a[63]&127|(r.pubKeyNegative?128:0),a}function m(e,t,n){var a=o("WASignalKeys").makeKeyPair(),i=o("WASignalOther").makeBytes(64);o("WACryptoDependencies").getCrypto().getRandomValues(i);var l=d(n,o("WASignalKeys").serializePubKey(a),i);if(!Number.isSafeInteger(t))throw r("err")("Expected timestamp to be a safe integer, given "+String(t));return{id:o("WASignalKeys").castToPreKeyId(e),ts:t,keyPair:a,signature:l}}function p(e,t){var n=o("WASignalOther").makeBytes(64);return o("WACryptoDependencies").getCrypto().getRandomValues(n),d(e,t,n)}function _(e){var t=e.id,n=e.keyPair;return o("WASignalOther").encodeSignalProto(o("WASignalLocalStorageProtocol.pb").SignedPreKeyRecordStructureSpec,{id:t,publicKey:o("WASignalKeys").serializePubKey(n),privateKey:n.privateKey,signature:e.signature,timestamp:e.ts})}function f(e){try{var t=o("decodeProtobuf").decodeProtobuf(o("WASignalLocalStorageProtocol.pb").SignedPreKeyRecordStructureSpec,e),n=t.id,r=t.privateKey,a=t.publicKey,i=t.signature,l=t.timestamp;return n==null||a==null||r==null||i==null||l==null?null:{id:o("WASignalKeys").castToSignedPreKeyId(n),ts:o("WALongInt").numberOrThrowIfTooLarge(l),keyPair:o("WASignalKeys").makeKeyPairFromSerialized(o("WASignalOther").toBytes(r,32),o("WASignalKeys").castToSerializedPubKey(new Uint8Array(a))),signature:o("WASignalOther").toBytes(i,64)}}catch(e){return null}}function g(e){return new Uint8Array(o("WAHex").parseHex(e))}function h(e){if(e.length===33)return o("WASignalKeys").castToSerializedPubKey(e);if(e.length===32)return o("WASignalKeys").serializeIdentity(e);throw r("err")("verifyCertificate publicKey incorrect length")}function y(t,r,o){return(e||(e=n("Promise"))).resolve().then(function(){var e=m(t,r,o),n=_(e);return{plainObject:e,record:n}})}l.signMsg=u,l.verifyMsgSignalVariant=c,l.makeSignature=d,l.makeSignedPreKey=m,l.signSenderKeyMessage=p,l.serializeSignedPreKeyForPrivateStorage=_,l.deserializeSignedPreKey=f,l.convertPublicKeyHexToUint8Array=g,l.convertPublicKeyToSerializedPubKey=h,l.generateSignedPreKey=y}),98);/*FB_PKG_DELIM*/
__d("BladeRunnerConfig",["RTISubscriptionManagerConfig","WebDriverConfig","cr:3024","gkx","isEmpty"],(function(t,n,r,o,a,i,l){var e,s="javascript-sandbox",u="OverrideServer",c="www_sandbox",d="www_tier",m=(function(){function t(){}var o=t.prototype;return o.patchRequestHeaders=function(o){var t={},a=r("RTISubscriptionManagerConfig").bladerunner_www_sandbox,i=r("RTISubscriptionManagerConfig").is_intern;if((e||(e=r("isEmpty")))(r("WebDriverConfig").auxiliaryServiceInfo))a!=null&&(t[s]=a);else{var l,m=(l=r("WebDriverConfig").auxiliaryServiceInfo.BladeRunner)!=null?l:r("WebDriverConfig").auxiliaryServiceInfo["BladeRunner-sandcastle"];m!=null?(typeof m.ip_address=="string"?t[u]=m.ip_address+":18295":typeof m.hostname=="string"&&(t[u]=m.hostname+":18295"),typeof r("WebDriverConfig").originHost=="string"&&(t[c]="www."+r("WebDriverConfig").originHost)):a!=null&&(t[s]=a)}if(i===!0&&(t[d]="intern"),r("WebDriverConfig").isTestRunning&&r("gkx")("20919")){var p=n("cr:3024")==null?void 0:n("cr:3024").get();p!=null&&(t.is_test="true",t.original_request_id=p)}r("gkx")("20929")&&(t["Accept-Ack"]="RSAck");for(var _ in o)t[_]=o[_];return t.http_referer=window.location.href,t},t})(),p=new m,_=p;l.default=_}),98);
__d("BladeRunnerLogger",["FBLogger","ODS"],(function(t,n,r,o,a,i,l){var e,s="bladerunner_js_client",u={info:"info",warning:"warning",exception:"exception"},c=(function(){function t(){this.setFBLoggerLevel(1)}var n=t.prototype;return n.info=function(t){this.$2>=2&&r("FBLogger")(s).info("BladeRunner info: %s",t),this.$3(u.info,t)},n.warn=function(t){this.$2>=1&&r("FBLogger")(s).warn("BladeRunner warn: %s",t),this.$3(u.warning,t)},n.exception=function(t,n){n===void 0&&(n="");var e=n+" "+t.toString();this.$2>=0&&r("FBLogger")(s).warn("BladeRunner exception: %s, %s",n,t.toString()),this.$3(u.exception,e)},n.trimForLogging=function(t){var e=1024;return typeof t=="string"&&t.length>e?"[trimmed]:"+t.substring(0,e)+"...":t},n.bumpCounter=function(n,r){r===void 0&&(r=1),(e||(e=o("ODS"))).bumpEntityKey(2966,"BladeRunnerClient",n,r)},n.setClientSessionId=function(t){this.$1=t},n.setFBLoggerLevel=function(t){this.$2=t},n.$3=function(t,n){},t})(),d=new c,m=d;l.default=m}),98);
__d("BladeRunnerTypes",[],(function(t,n,r,o,a,i,l){var e={REQUEST:1,DATA:2,DATA_ACK:3,STATUS_UPDATE:4,REWRITE_REQUEST:5,LOG:6},s={BLADE_RUNNER:1,GATEWAY:2};l.StreamFrameType=e,l.StreamRequestType=s}),98);
__d("BladeRunnerTypesInternal",["Base64","BladeRunnerLogger","BladeRunnerTypes"],(function(t,n,r,o,a,i,l){var e=(function(){function e(){}var t=e.prototype;return t.getHeaders=function(){if(this.headers!=null)return this.headers;throw new Error("Expected headers")},t.getInstrumentationData=function(){if(this.instrumentationData!=null&&this.instrumentationData.length>0)try{return JSON.parse(this.instrumentationData)}catch(e){return null}else return null},t.updateRetryRequestPayload=function(t){t!=null?this.payload=r("Base64").encode(t):this.payload=null},e.readObject=function(n){var t=new e;return t.streamId=f(n.streamId),t.requestType=f(n.requestType),t.payload=y(n.payload),t.headers=v(n.headers),t.extraHeader=y(n.extraHeader),t.requestTarget=y(n.requestTarget),t.instrumentationData=y(n.instrumentationData),t},e})(),s=(function(){function e(){}e.readObject=function(n){var t=new e;return t.streamId=f(n.streamId),t.dataId=g(n.dataId),t.data=y(n.data),t.shouldAck=R(n.shouldAck),t};var t=e.prototype;return t.rawData=function(){if(this.data==null)throw new Error("Expected data");return this.data},t.rawDataSize=function(){return this.data==null?0:this.data.length},t.decodeData=function(){if(this.data==null)throw new Error("Expected data");return r("Base64").decode(this.data)},t.setData=function(t){this.data=r("Base64").encode(t)},t.getInstrumentationData=function(){return this.instrumentationData!=null?JSON.parse(this.instrumentationData):null},e})(),u=(function(){function e(){}return e.readObject=function(n){var t=new e;return t.streamId=f(n.streamId),t.dataId=f(n.dataId),t.success=S(n.success),t.message=y(n.message),t.code=g(n.code),t},e})();u.ACK_CODE_LANDED_AND_ACCEPTED=20,u.ACK_CODE_LANDED_BUT_NOT_ACCEPTED=21,u.ACK_CODE_FAILED_TO_LAND=50;var c=(function(){function e(){}return e.readObject=function(n){var t=new e;return t.streamId=g(n.streamId),t.message=y(n.message),t},e})(),d=(function(){function e(){}return e.readObject=function(n){var t=new e;return t.streamId=f(n.streamId),t.status=f(n.status),t.message=y(n.message),t.code=g(n.code),t.shouldRetry=R(n.shouldRetry),t.retryDelayMs=g(n.retryDelayMs),t},e})(),m=(function(){function e(){}return e.readObject=function(n){var t=new e;return t.streamId=f(n.streamId),t.newBody=y(n.newBody),t.newExtraHeader=y(n.newExtraHeader),t.patchExtraHeader=y(n.patchExtraHeader),t.killBody=R(n.killBody),t.temporary=R(n.temporary),t},e})(),p=(function(){function t(){}var n=t.prototype;return n.getRequest=function(){if(this.type==o("BladeRunnerTypes").StreamFrameType.REQUEST&&this.request!=null)return this.request;throw new Error("Expected request")},n.getData=function(){if(this.type==o("BladeRunnerTypes").StreamFrameType.DATA&&this.data!=null)return this.data;throw new Error("Expected data")},n.getDataAck=function(){if(this.type==o("BladeRunnerTypes").StreamFrameType.DATA_ACK&&this.dataAck!=null)return this.dataAck;throw new Error("Expected dataAck")},n.getStatusUpdate=function(){if(this.type==o("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE&&this.statusUpdate!=null)return this.statusUpdate;throw new Error("Expected status update")},n.getLog=function(){if(this.type==o("BladeRunnerTypes").StreamFrameType.LOG&&this.log!=null)return this.log;throw new Error("Expected log")},n.getRewriteRequest=function(){if(this.type==o("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST&&this.rewriteRequest!=null)return this.rewriteRequest;throw new Error("Expected rewrite request")},n.getStreamId=function(){if(this.type==o("BladeRunnerTypes").StreamFrameType.REQUEST&&this.request!=null)return this.request.streamId;if(this.type==o("BladeRunnerTypes").StreamFrameType.DATA&&this.data!=null)return this.data.streamId;if(this.type==o("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE&&this.statusUpdate!=null)return this.statusUpdate.streamId;if(this.type==o("BladeRunnerTypes").StreamFrameType.LOG&&this.log!=null)return this.log.streamId;if(this.type==o("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST&&this.rewriteRequest!=null)return this.rewriteRequest.streamId;if(this.type==o("BladeRunnerTypes").StreamFrameType.DATA_ACK&&this.dataAck!=null)return this.dataAck.streamId;throw new Error("Frame with unexpected type")},n.isInstrumented=function(){return this.type===o("BladeRunnerTypes").StreamFrameType.REQUEST?this.getRequest().instrumentationData!=null:this.type===o("BladeRunnerTypes").StreamFrameType.DATA?this.getData().instrumentationData!=null:!1},t.readObject=function(a){var n=new t;switch(n.type=f(a.type),n.type){case o("BladeRunnerTypes").StreamFrameType.REQUEST:n.request=e.readObject(C(a.request));break;case o("BladeRunnerTypes").StreamFrameType.DATA:n.data=s.readObject(C(a.data));break;case o("BladeRunnerTypes").StreamFrameType.DATA_ACK:n.dataAck=u.readObject(C(a.dataAck));break;case o("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:n.statusUpdate=d.readObject(C(a.statusUpdate));break;case o("BladeRunnerTypes").StreamFrameType.LOG:n.log=c.readObject(C(a.log));break;case o("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST:n.rewriteRequest=m.readObject(C(a.rewriteRequest));break;default:return r("BladeRunnerLogger").warn("Frame with unexpected type: "+n.type),null}return n},t.newRequestFrame=function(n){var e=new t;return e.type=o("BladeRunnerTypes").StreamFrameType.REQUEST,e.request=n,e},t.newDataFrame=function(n){var e=new t;return e.type=o("BladeRunnerTypes").StreamFrameType.DATA,e.data=n,e},t.newDataAckFrame=function(n){var e=new t;return e.type=o("BladeRunnerTypes").StreamFrameType.DATA_ACK,e.dataAck=n,e},t.newStatusUpdateFrame=function(n){var e=new t;return e.type=o("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE,e.statusUpdate=n,e},t.newLogFrame=function(n){var e=new t;return e.type=o("BladeRunnerTypes").StreamFrameType.LOG,e.log=n,e},t.newRewriteRequestFrame=function(n){var e=new t;return e.type=o("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST,e.rewriteRequest=n,e},t})(),_=(function(){function e(e,t,n){this.batchId=e,this.frames=t,this.instrumentationData=n}var t=e.prototype;return t.getFrames=function(){if(this.frames!=null)return this.frames;throw new Error("Expected frames")},t.getInstrumentationData=function(){if(this.instrumentationData!=null)try{return JSON.parse(this.instrumentationData)}catch(e){return null}else return null},t.getInstrumentationDataDfTraceId=function(){if(this.instrumentationData!=null)try{var e,t=JSON.parse(this.instrumentationData);return(e=t.dataFlowTracingData)==null?void 0:e.traceId}catch(e){return null}else return null},t.write=function(){return JSON.stringify(this)},t.isInstrumented=function(){return this.getFrames().some(function(e){return e.isInstrumented()})},e.read=function(n){var t=JSON.parse(n),r=t.batchId||0,o=[];for(var a of t.frames){var i=p.readObject(a);i!=null&&o.push(i)}var l=t.instrumentationData||null;return new e(r,o,l)},e})();function f(e){if(typeof e=="number")return e;throw new Error("Expected number")}function g(e){return e==null?null:f(e)}function h(e){if(typeof e=="string")return e;throw new Error("Expected string")}function y(e){return e==null?null:h(e)}function C(e){if(typeof e=="object"&&e!=null)return e;throw new Error("Expected object")}function b(e){if(typeof e=="object"&&e!=null){var t=e,n={};return Object.keys(t).forEach(function(e){var r=t[e];typeof r=="string"&&r!=null&&(n[e]=r)}),n}throw new Error("Expected string map")}function v(e){return e==null?null:b(e)}function S(e){if(typeof e=="boolean"&&e!=null)return e;throw new Error("Expected boolean")}function R(e){return e==null?null:S(e)}l.GatewayStreamRequest=e,l.GatewayStreamData=s,l.GatewayStreamDataAck=u,l.GatewayStreamLog=c,l.GatewayStreamStatusUpdate=d,l.GatewayStreamRewriteRequest=m,l.GatewayStreamFrame=p,l.GatewayStreamBatch=_}),98);
__d("RequestStreamE2EClientLoggerEvent",[],(function(t,n,r,o,a,i){var e=Object.freeze({RECEIVED:"received",SENT:"sent",FAILURE:"failure",PUBACK:"puback"});i.default=e}),66);
__d("RequestStreamE2EClientLoggerMessageType",[],(function(t,n,r,o,a,i){var e=Object.freeze({REQUEST_STREAM:"request_stream",AMENDMENT:"amendment",AMENDMENT_ACK:"amendment_ack",CANCEL:"cancel",RESPONSE:"response",RESPONSE_ACK:"response_ack",TIMED_REQUEST:"timed_request",INTERRUPT:"interrupt"});i.default=e}),66);
__d("BladeRunnerEventHandler",["BladeRunnerLogger","BladeRunnerStreamStatus","BladeRunnerTypes","BladeRunnerTypesInternal","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","getErrorSafe","setTimeoutAcrossTransitions"],(function(t,n,r,o,a,i,l){var e=1e3,s=(function(){function t(e,t,n){this.$2=e,this.$1=t,this.$3=n}var n=t.prototype;return n.onProxyResponse=function(t){var e,n;this.$4(t);var a=[];for(var i of t.getFrames())this.$2.witnessFrame(i)&&a.push(i);var l=this.$2.getRequest();(e=l.e2eLogger)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").RESPONSE,r("RequestStreamE2EClientLoggerEvent").SENT,{},(n=t.getInstrumentationData())==null?void 0:n.auxId,null,t.getInstrumentationDataDfTraceId()),a.length>0&&this.$5(new(o("BladeRunnerTypesInternal")).GatewayStreamBatch(t.batchId,a,t.instrumentationData))},n.onDisconnect=function(){this.$2.resetErrors();var e=new(o("BladeRunnerTypesInternal")).GatewayStreamStatusUpdate;e.streamId=this.$2.getRequest().streamId,e.status=o("BladeRunnerStreamStatus").StreamStatus.CLOSED,e.shouldRetry=!0,e.retryDelayMs=0;var t=new(o("BladeRunnerTypesInternal")).GatewayStreamBatch(null,[o("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(e)]);this.onProxyResponse(t)},n.$4=function(n){var t=this,a=n.getFrames().filter(function(e){return e.type==o("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE});for(var i of a){var l=i.getStatusUpdate();if(l.status==o("BladeRunnerStreamStatus").StreamStatus.CLOSED||l.status==o("BladeRunnerStreamStatus").StreamStatus.REJECTED){this.$2.onError();var s=l.shouldRetry!=null&&l.shouldRetry,u=l.message!=null?l.message:"null";if(s&&this.$2.getErrorCount()<=this.$2.getRetriesAllowed()){l.status=o("BladeRunnerStreamStatus").StreamStatus.STOPPED;var c=e;l.retryDelayMs!=null&&(c=l.retryDelayMs),r("BladeRunnerLogger").info("Can retry: stream "+l.streamId+" closed with status "+l.status+", message "+u+". Error count: "+this.$2.getErrorCount()+", retryDelay "+c+"ms. Already retrying: "+this.$2.getRetryRequestScheduled().toString()),this.$2.getRetryRequestScheduled()?r("BladeRunnerLogger").bumpCounter("stream_closed_already_retrying"):(r("BladeRunnerLogger").bumpCounter("stream_closed_will_retry"),this.$2.setRetryRequestScheduled(!0),c>0?r("setTimeoutAcrossTransitions")(function(){return t.$6()},c):this.$6())}else r("BladeRunnerLogger").info("Will not retry: stream "+l.streamId+" closed with status "+l.status+", message "+u+". Error count: "+this.$2.getErrorCount()+", shouldRetry "+s.toString()+". Already retrying: "+this.$2.getRetryRequestScheduled().toString()),s?r("BladeRunnerLogger").bumpCounter("stream_closed_retry_exceeded"):r("BladeRunnerLogger").bumpCounter("stream_closed_no_retry"),this.$3.removeStream(l.streamId)}}},n.$6=function(){if(this.$2.setRetryRequestScheduled(!1),this.$2.isAlive()){var e=this.$1.getUpdatedRequestBody();e!=null&&this.$2.updateRetryRequestPayload(e),this.$3.sendRetryStreamRequest(this.$2)}},n.$5=function(t){r("BladeRunnerLogger").bumpCounter("send_to_handler");var e=[];this.$1.onBatch(t);for(var n of t.getFrames())try{switch(n.type){case o("BladeRunnerTypes").StreamFrameType.DATA:this.$1.onData(n.getData()),e.push(n.getData());break;case o("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:this.$1.onStatusUpdate(n.getStatusUpdate().status);break;case o("BladeRunnerTypes").StreamFrameType.LOG:var a=n.getLog().message;a!=null&&this.$1.onLog(a);break;case o("BladeRunnerTypes").StreamFrameType.DATA_ACK:break;default:throw new Error("Frame with unexpected type")}}catch(e){var i=r("getErrorSafe")(e);r("BladeRunnerLogger").bumpCounter("send_to_handler_error"),r("BladeRunnerLogger").exception(i,"Failed sending frame to stream handler")}this.$7(e)},n.$7=function(t){var e=[];for(var n of t)if(n.shouldAck===!0&&n.dataId!=null){var r=new(o("BladeRunnerTypesInternal")).GatewayStreamDataAck;r.streamId=n.streamId,r.dataId=n.dataId,r.success=!0,e.push(r)}this.$3.sendDataAcks(e)},t})();l.default=s}),98);
__d("RtiRequestStreamE2eClientBatchFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("819"),s=o("FalcoLoggerInternal").create("rti_request_stream_e2e_client_batch",e),u=s;l.default=u}),98);
__d("RtiRequestStreamE2eClientFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("1857112"),s=o("FalcoLoggerInternal").create("rti_request_stream_e2e_client",e),u=s;l.default=u}),98);
__d("RequestStreamE2ELogger",["ConstUriUtils","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","RtiRequestStreamE2eClientBatchFalcoEvent","RtiRequestStreamE2eClientFalcoEvent","WebStorage"],(function(t,n,r,o,a,i,l){"use strict";var e,s="rs_debug_logging",u=["FBGQLS:COMMENT_CREATE_SUBSCRIBE","FBGQLS:COMMENT_LIKE_SUBSCRIBE","FBGQLS:FEEDBACK_COMMENT_PERMISSION_TOGGLE_SUBSCRIBE","FBGQLS:FEEDBACK_TYPING_SUBSCRIBE","GRAPHQL:CometNotificationsReceiveLiveQuery"],c=0;function d(){var e=Date.now();return c>=e?c+=1:c=e,c.toString()}var m=(function(){function e(e,t,n,r,a,i,l,s,u,c){this.$10=[],this.$11=!1,this.$1=e,this.$2=t,this.$3=n,this.$4=r,this.$5=a,this.$6=i,this.$7=l,this.$8=s,this.$9=u,this.$12=c!=null?c:!1;var d=o("ConstUriUtils").getUri(window.location.href);d&&(this.$13=d.getDomain())}var t=e.prototype;return t.logE2EEvent=function(t,n,r,o,a,i,l){if(r===void 0&&(r=null),o===void 0&&(o=null),a===void 0&&(a=null),i===void 0&&(i=null),l===void 0&&(l=null),this.$3!=="Falco"){var e={request_id:this.$1,resume_id:"0",retry_id:a,transport:this.$2,method:this.$3,use_case:this.$4,request_log_context:this.$5,force_log_context:this.$6,e2e_sample_rate:this.$7,message_type:t,event:n,timestamp_ms:d(),aux_id:o,additional_data:r,dgw_stream_group_logging_id:this.$8,dgw_count_prior_streams_in_group:this.$9,domain:this.$13,df_trace_id:i};this.$14(e,l)}},t.$14=function(t,n){if(!this.$12){r("RtiRequestStreamE2eClientFalcoEvent").log(function(){return t});return}if(this.$10.push(t),this.$11||t.event==r("RequestStreamE2EClientLoggerEvent").FAILURE||t.message_type==r("RequestStreamE2EClientLoggerMessageType").RESPONSE){var e={events:this.$10};r("RtiRequestStreamE2eClientBatchFalcoEvent").log(function(){return e}),this.$10=[],this.$11=!0}},t.getRequestId=function(){return this.$1},e})();function p(e,t,n){if(e==null||e.method==null)return null;var r=!1;if(u.includes(e.method)&&(r=!0),t==null||t.length===0)return null;var o=JSON.parse(t);return o.requestId==null?null:new m(o.requestId,n,e.method,_(e.method,e),o.requestLogContext,o.forceLogContext,o.sampleRate,o.dgwStreamGroupLoggingId,o.dgwCountPriorStreamsInGroup,r)}function _(e,t){if(e==="FBLQ"&&t.config_id)return t.config_id;if(e==="SKY"){if(t.topic){var n=t.topic.lastIndexOf("/");return n>0?t.topic.substr(0,n):t.topic}return}return e}function f(e,t,n,o,a,i){if(a===void 0&&(a=null),i===void 0&&(i=null),!(e==null||e.requestId==null||e.clientLoggingDisabled!=null)){var l={request_id:e.requestId,resume_id:"0",transport:t,e2e_sample_rate:e.sampleRate,message_type:n,event:o,timestamp_ms:d(),aux_id:e.auxId,additional_data:a,df_trace_id:i};r("RtiRequestStreamE2eClientFalcoEvent").log(function(){return l})}}l.RequestStreamE2ELogger=m,l.createStreamLogger=p,l.logRequestStreamE2EEventStatic=f}),98);
__d("RequestStreamTransport",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["WEB_BR_MQTT","WEB_RS_MQTT","WEB_RS_STARGATE"]);i.RequestStreamTransport=e}),66);
__d("BladeRunnerSocket",["BladeRunnerEventHandler","BladeRunnerLogger","BladeRunnerStreamStatus","BladeRunnerTypes","BladeRunnerTypesInternal","CurrentUser","FBMqttChannel","MqttPublishListener","Promise","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","RequestStreamE2ELogger","RequestStreamTransport","getErrorSafe","justknobx","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e,s="Connected",u="Disconnected",c="/br_sr",d="/sr_res",m=null;function p(e){var t,n;switch(e.type){case o("BladeRunnerTypes").StreamFrameType.REQUEST:return(t=e.request)==null?void 0:t.getInstrumentationData();case o("BladeRunnerTypes").StreamFrameType.DATA:return(n=e.data)==null?void 0:n.getInstrumentationData()}return null}function _(e){switch(e.type){case o("BladeRunnerTypes").StreamFrameType.REQUEST:return r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM;case o("BladeRunnerTypes").StreamFrameType.DATA:return r("RequestStreamE2EClientLoggerMessageType").AMENDMENT}return null}function f(e){if(e===null)return null;switch(e){case o("BladeRunnerStreamStatus").StreamStatus.ACCEPTED:return"Accepted";case o("BladeRunnerStreamStatus").StreamStatus.REJECTED:return"Rejected";case o("BladeRunnerStreamStatus").StreamStatus.STARTED:return"Started";case o("BladeRunnerStreamStatus").StreamStatus.STOPPED:return"Stopped";case o("BladeRunnerStreamStatus").StreamStatus.CLOSED:return"Closed"}return null}function g(e){var t,n={};return e==null||(t=e.frames)==null||t.forEach(function(e){if(e.type===o("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE){var t,r=(t=e.statusUpdate)==null?void 0:t.status,a=f(r);a!==null&&(n.flow_status=a)}}),n}function h(e,t){var n,r;switch(e.type){case o("BladeRunnerTypes").StreamFrameType.REQUEST:t.data_base64_size=(n=e.request)==null||(n=n.payload)==null||(n=n.length)==null?void 0:n.toString();break;case o("BladeRunnerTypes").StreamFrameType.DATA:t.data_base64_size=(r=e.data)==null||(r=r.rawDataSize())==null?void 0:r.toString();break}return null}function y(e,t,n){var a,i=p(e);if(i!=null){var l=_(e);if(l!=null){var s=null;switch(t){case o("MqttPublishListener").MqttPublishEvent.SENT:s=r("RequestStreamE2EClientLoggerEvent").SENT;break;case o("MqttPublishListener").MqttPublishEvent.ACKED:s=r("RequestStreamE2EClientLoggerEvent").PUBACK;break;case o("MqttPublishListener").MqttPublishEvent.NOT_ACKED:case o("MqttPublishListener").MqttPublishEvent.NOT_CONNECTED:case o("MqttPublishListener").MqttPublishEvent.PUBLISH_ERROR:s=r("RequestStreamE2EClientLoggerEvent").FAILURE,n.reason==null&&(n.reason=t);break}if(s!=null)if(h(e,n),((a=e.request)==null?void 0:a.e2eLogger)!=null&&i.clientLoggingDisabled==null){var u;(u=e.request)==null||u.e2eLogger.logE2EEvent(l,s,n,i.auxId)}else o("RequestStreamE2ELogger").logRequestStreamE2EEventStatic(i,o("RequestStreamTransport").RequestStreamTransport.WEB_BR_MQTT,l,s,n)}}}var C=(function(){function t(e){this.$1=[],this.$2=0,this.$3=0,this.$4=null,this.$5=0,this.$6=new Map,this.$7=e!=null?e:r("FBMqttChannel"),this.$8=new Map,r("BladeRunnerLogger").setClientSessionId(r("uuidv4")()),this.$9()}t.get=function(){return m==null&&(m=new t(r("FBMqttChannel"))),m};var a=t.prototype;return a.sendNewStreamRequest=function(n,o){var e=new(r("BladeRunnerEventHandler"))(n,o,this),a=n.getRequest();if(this.$6.set(a.streamId,e),!this.$10()){this.$11(e,a.streamId);return}this.getStreamCount()<=t.maxStreamCount?this.$12(a):(r("BladeRunnerLogger").bumpCounter("socket_request_throttled_max_streams"),r("BladeRunnerLogger").warn("Maximum stream count reached, will not send request: "+JSON.stringify(n.getRequest().getHeaders())),this.$11(e,a.streamId))},a.sendRetryStreamRequest=function(t){this.$12(t.getRequest())},a.sendCancel=function(t){r("BladeRunnerLogger").bumpCounter("socket_send_cancel");var e=new(o("BladeRunnerTypesInternal")).GatewayStreamStatusUpdate;e.streamId=t.streamId,e.status=o("BladeRunnerStreamStatus").StreamStatus.CLOSED,this.$13(e,t),this.removeStream(t.streamId)},a.sendAmendment=function(t,n,a){r("BladeRunnerLogger").bumpCounter("socket_send_amendment");var e=new(o("BladeRunnerTypesInternal")).GatewayStreamData;e.streamId=t,e.setData(n),a!=null&&(e.instrumentationData=a),this.$14(e)},a.sendAmendmentWithAck=function(a,i,l){var t=this;r("BladeRunnerLogger").bumpCounter("socket_send_amendment");var s=this.$15(),u=new(o("BladeRunnerTypesInternal")).GatewayStreamData;u.streamId=a,u.setData(i),u.shouldAck=!0,u.dataId=s,l!=null&&(u.instrumentationData=l);var c=new(e||(e=n("Promise")))(function(e,n){t.$8.set(s,{resolve:e,reject:n})});return this.$14(u),c},a.$14=function(t){this.$1.push(o("BladeRunnerTypesInternal").GatewayStreamFrame.newDataFrame(t)),this.$16()},a.sendDataAcks=function(t){r("BladeRunnerLogger").bumpCounter("socket_send_data_ack",t.length),this.$17(t)},a.removeStream=function(t){this.$6.delete(t)},a.getStreamCount=function(){return this.$6.size},a.getNextStreamId=function(){return this.$5++,this.$5},a.onMQTTStateChanged=function(t){this.$16(),!(t!=u&&t!=s||this.$4==t)&&(this.$4=t,r("BladeRunnerLogger").info("MQTTStateChanged: "+t),t==u?(r("BladeRunnerLogger").bumpCounter("mqtt_state_disconnected"),this.$18()):t==s&&r("BladeRunnerLogger").bumpCounter("mqtt_state_connected"))},a.$12=function(t){if(r("BladeRunnerLogger").bumpCounter("socket_send_request"),this.$1.push(o("BladeRunnerTypesInternal").GatewayStreamFrame.newRequestFrame(t)),!this.$16()){var e;(e=t.e2eLogger)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"MQTT Not Connected"})}},a.$13=function(t,n){if(this.$1.push(o("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(t)),this.$16()){var e;(e=n.e2eLogger)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").CANCEL,r("RequestStreamE2EClientLoggerEvent").SENT)}},a.$17=function(t){for(var e of t)this.$1.push(o("BladeRunnerTypesInternal").GatewayStreamFrame.newDataAckFrame(e));this.$16()},a.$19=function(){return this.$2++,this.$2},a.$15=function(){return this.$3++,this.$3},a.$16=function(){var e=!1;if(this.$7.getConnectionState()===s&&this.$1.length>0)try{this.$20(this.$1),e=!0}catch(e){}finally{this.$1=[]}return e},a.$20=function(t){var e=this,n=new(o("BladeRunnerTypesInternal")).GatewayStreamBatch(this.$19(),t),a=n.write();if(a.length>this.$21()){var i=Math.floor(t.length/2);if(i===0){t.forEach(function(e){return y(e,o("MqttPublishListener").MqttPublishEvent.PUBLISH_ERROR,{reason:"too long"})});var l=new Error("Publish is too long: "+a.length);throw l.stack,this.$22(n,l,"Publish is too long"),l}this.$20(t.slice(0,i)),this.$20(t.slice(i,t.length))}else try{r("BladeRunnerLogger").info("send message to "+c+" ("+a.length+" bytes)");var s={qos:1,skipBuffer:!1};if(n.isInstrumented()){var u=Date.now();s.listener={onEvent:function(n){var e=(Date.now()-u).toString();t.forEach(function(t){y(t,n,{latency:e})})}}}this.$7.publish(c,a,s).catch(function(t){e.$22(n,t,"Failed publishing to MQTT")}),r("BladeRunnerLogger").bumpCounter("mqtt_publish_success")}catch(e){var d=r("getErrorSafe")(e);throw this.$22(n,d,"Failed publishing to MQTT"),d}},a.$9=function(){var e=this;r("BladeRunnerLogger").info("Starting socket with endpoint "+this.$7.getEndpoint()+" useragent "+navigator.userAgent),this.onMQTTStateChanged(this.$7.getConnectionState()),this.$7.subscribeChannelEvents({onMQTTStateChanged:function(n){e.onMQTTStateChanged(n)},onJSError:function(t){var e=t!=null&&typeof t.isRecoverable=="boolean"?t.isRecoverable:!1;e?r("BladeRunnerLogger").bumpCounter("mqtt_channel_recoverable_error"):(r("BladeRunnerLogger").warn("JS error in MQTTChannel: "+(typeof t=="object"&&t!=null?t.toString():"unknown error")+", "+JSON.stringify(t)),r("BladeRunnerLogger").bumpCounter("mqtt_channel_error"))}}),this.$7.subscribe(c,function(e){throw new Error("Unexpected response: "+c+" "+e.toString())}),this.$7.subscribe(d,function(t){e.$23(t)})},a.$23=function(t){var e=o("BladeRunnerTypesInternal").GatewayStreamBatch.read(t);this.processBatch(e)},a.$22=function(t,n,a){for(var e of t.getFrames())if(e.type===o("BladeRunnerTypes").StreamFrameType.REQUEST){var i=e.getRequest(),l=this.$6.get(i.streamId);l!=null&&this.$24(l,i.streamId,o("BladeRunnerStreamStatus").StreamStatus.CLOSED,!0,null)}else if(e.type===o("BladeRunnerTypes").StreamFrameType.DATA){var s=e.getData(),u=s.dataId;if(s.shouldAck!=null&&s.shouldAck&&u!=null){var c=new(o("BladeRunnerTypesInternal")).GatewayStreamDataAck;c.streamId=s.streamId,c.dataId=u,c.success=!1,c.code=o("BladeRunnerTypesInternal").GatewayStreamDataAck.ACK_CODE_FAILED_TO_LAND,c.message=a,this.$25(c)}}r("BladeRunnerLogger").info("Failed publishing to MQTT: "+n.message),r("BladeRunnerLogger").bumpCounter("mqtt_publish_error")},a.$25=function(t){var e=this.$8.get(t.dataId);e!=null&&(this.$8.delete(t.dataId),t.success?e.resolve(!0):t.code===o("BladeRunnerTypesInternal").GatewayStreamDataAck.ACK_CODE_LANDED_BUT_NOT_ACCEPTED?e.resolve(!1):e.reject(t.message))},a.processBatch=function(t){try{o("RequestStreamE2ELogger").logRequestStreamE2EEventStatic(t.getInstrumentationData(),o("RequestStreamTransport").RequestStreamTransport.WEB_BR_MQTT,r("RequestStreamE2EClientLoggerMessageType").RESPONSE,r("RequestStreamE2EClientLoggerEvent").RECEIVED,g(t),t.getInstrumentationDataDfTraceId()),r("BladeRunnerLogger").bumpCounter("socket_process_batch");var e=JSON.stringify(t);r("BladeRunnerLogger").info("Received batch ("+e.length+" bytes)");var n=null;for(var a of t.getFrames()){var i=a.getStreamId();if(n==null&&(n=i),i!=null&&n!=i)throw new Error("Received batch with frames for multiple streams");a.type==o("BladeRunnerTypes").StreamFrameType.DATA_ACK&&this.$25(a.getDataAck())}if(n!=null){var l=this.$6.get(n);l!=null?l.onProxyResponse(t):r("BladeRunnerLogger").info("Received batch with frames for unknown stream id: "+n)}else r("BladeRunnerLogger").info("Received batch with no frames")}catch(e){var s=r("getErrorSafe")(e);throw r("BladeRunnerLogger").exception(s,"Failed processing batch from MQTT"),r("BladeRunnerLogger").bumpCounter("socket_process_batch_error"),s}},a.$18=function(){this.$6.forEach(function(e,t,n){e.onDisconnect()})},a.$11=function(t,n){this.$24(t,n,o("BladeRunnerStreamStatus").StreamStatus.REJECTED,!1,0)},a.$24=function(t,n,r,a,i){var e=new(o("BladeRunnerTypesInternal")).GatewayStreamStatusUpdate;e.streamId=n,e.status=r,e.shouldRetry=a,e.retryDelayMs=i;var l=new(o("BladeRunnerTypesInternal")).GatewayStreamBatch(null,[o("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(e)]);t.onProxyResponse(l)},a.$10=function(){return r("CurrentUser").isLoggedIn()?!0:(r("BladeRunnerLogger").bumpCounter("request_stream_user_logged_out"),!1)},a.$21=function(){var e=1048576,t=512*1024;try{var n=r("justknobx")._("317");t=n*e}catch(e){}return Math.max(t-1024,0)},t})();C.maxStreamCount=2e3,l.default=C}),98);
__d("BladeRunnerStream",[],(function(t,n,r,o,a,i){var e=(function(){function e(e){this.$1=e}var t=e.prototype;return t.getStreamHandler=function(){return this.$1},t.cancel=function(){},t.amendWithAck=async function(t){return!1},t.amendFireAndForget=function(t){},t.amendWithoutAck=function(t){},t.start=function(){return Promise.resolve()},t.isAlive=function(){return!1},t.canAmend=function(){return!1},t.getStatus=function(){return null},t.getStreamId=function(){return 0},e})();i.default=e}),66);
__d("BladeRunnerStreamState",["BladeRunnerLogger","BladeRunnerStreamStatus","BladeRunnerTypes"],(function(t,n,r,o,a,i,l){var e=(function(){function e(e){this.$1=e,this.$2=null,this.$3=0,this.$4=!1,this.$5=0,this.$6=!1}var t=e.prototype;return t.getRequest=function(){return this.$1},t.updateRetryRequestPayload=function(t){this.$1.updateRetryRequestPayload(t)},t.isAlive=function(){return!(this.$2==o("BladeRunnerStreamStatus").StreamStatus.CLOSED||this.$2==o("BladeRunnerStreamStatus").StreamStatus.REJECTED)},t.canAmend=function(){return this.$2==o("BladeRunnerStreamStatus").StreamStatus.ACCEPTED||this.$2==o("BladeRunnerStreamStatus").StreamStatus.STARTED||this.$2==o("BladeRunnerStreamStatus").StreamStatus.STOPPED},t.getLastStatus=function(){return this.$2},t.setLastStatus=function(t){this.$2=t},t.onError=function(){this.$3+=1},t.getErrorCount=function(){return this.$3},t.resetErrors=function(){this.$3=0},t.getRetryRequestScheduled=function(){return this.$6},t.setRetryRequestScheduled=function(t){this.$6=t},t.witnessFrame=function(t){switch(t.type){case o("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:var e=t.getStatusUpdate(),n=!0;switch(e.status){case o("BladeRunnerStreamStatus").StreamStatus.ACCEPTED:n=!this.$4,this.$4||(this.$4=!0);break;case o("BladeRunnerStreamStatus").StreamStatus.STARTED:n=this.getLastStatus()!=o("BladeRunnerStreamStatus").StreamStatus.STARTED;break;case o("BladeRunnerStreamStatus").StreamStatus.STOPPED:n=this.getLastStatus()==o("BladeRunnerStreamStatus").StreamStatus.STARTED;break;case o("BladeRunnerStreamStatus").StreamStatus.CLOSED:case o("BladeRunnerStreamStatus").StreamStatus.REJECTED:default:n=!0}return this.setLastStatus(e.status),n;case o("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST:return this.$7(t.getRewriteRequest()),!1;default:return!0}},t.setRetriesAllowed=function(t){this.$5=t},t.getRetriesAllowed=function(){return this.$5},t.$7=function(t){if(!(t.temporary!=null||t.temporary==!0)){if(t.newBody!=null&&(this.$1.payload=t.newBody),t.newExtraHeader!=null&&(this.$1.extraHeader=t.newExtraHeader,this.$1.headers=JSON.parse(t.newExtraHeader)),t.patchExtraHeader!=null)try{var e=JSON.parse(t.patchExtraHeader),n=this.$1.extraHeader!=null?JSON.parse(this.$1.extraHeader):{};this.$1.headers==null&&(this.$1.headers={});for(var o of Object.keys(e))this.$1.headers[o]=e[o],n[o]=e[o];this.$1.extraHeader=JSON.stringify(n)}catch(e){r("BladeRunnerLogger").warn("Failed to patch header: "+t.patchExtraHeader)}t.killBody!=null&&t.killBody==!0&&(this.$1.payload=null)}},e})();l.default=e}),98);
__d("BladeRunnerSocketStream",["BladeRunnerStream","BladeRunnerStreamState","BladeRunnerStreamStatus","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","uuidv4"],(function(t,n,r,o,a,i,l){var e=4,s={reason:"stream_dead"},u=(function(t){function n(n,o,a){var i;return i=t.call(this,n)||this,i.$BladeRunnerSocketStream$p_1=a,i.$BladeRunnerSocketStream$p_2=new(r("BladeRunnerStreamState"))(o),i.$BladeRunnerSocketStream$p_2.setRetriesAllowed(e),i}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.start=function(){var e=this;return new Promise(function(t){e.send(),t()})},a.send=function(){var e,t,n=this.$BladeRunnerSocketStream$p_2.getRequest();(e=n.e2eLogger)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,r("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_base64_size:(t=n.payload)==null||(t=t.length)==null?void 0:t.toString()}),this.$BladeRunnerSocketStream$p_1.sendNewStreamRequest(this.$BladeRunnerSocketStream$p_2,this.getStreamHandler())},a.amendWithAck=async function(t){var e,n=this.$BladeRunnerSocketStream$p_2.getRequest(),o=n.getInstrumentationData();if(o){var a,i;o.auxId=r("uuidv4")(),(a=n.e2eLogger)==null||a.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_size:t==null||(i=t.length)==null?void 0:i.toString()},o.auxId)}if(this.canAmend()){if(o){var l,u;(l=n.e2eLogger)==null||l.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").SENT,{data_size:t==null||(u=t.length)==null?void 0:u.toString()},o.auxId)}return this.$BladeRunnerSocketStream$p_1.sendAmendmentWithAck(n.streamId,this.$BladeRunnerSocketStream$p_3(t),o==null?null:JSON.stringify(o))}return(e=n.e2eLogger)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").FAILURE,s,o==null?void 0:o.auxId),Promise.reject("Stream is closed or not accepted")},a.amendFireAndForget=function(t){var e=this.$BladeRunnerSocketStream$p_2.getRequest(),n=e.getInstrumentationData();if(n){var o,a;n.auxId=r("uuidv4")(),(o=e.e2eLogger)==null||o.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_size:t==null||(a=t.length)==null?void 0:a.toString()},n.auxId)}if(this.canAmend()){if(this.$BladeRunnerSocketStream$p_1.sendAmendment(this.$BladeRunnerSocketStream$p_2.getRequest().streamId,this.$BladeRunnerSocketStream$p_3(t),n==null?null:JSON.stringify(n)),n){var i,l;(i=e.e2eLogger)==null||i.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").SENT,{data_size:t==null||(l=t.length)==null?void 0:l.toString()},n.auxId)}}else{var u;throw(u=e.e2eLogger)==null||u.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").FAILURE,s,n==null?void 0:n.auxId),new Error("Stream is closed or not accepted")}},a.amendWithoutAck=function(t){this.amendFireAndForget(t)},a.$BladeRunnerSocketStream$p_3=function(t){return typeof t=="object"?btoa(new TextDecoder("utf8").decode(t)):t},a.cancel=function(){var e,t=this.$BladeRunnerSocketStream$p_2.getRequest();(e=t.e2eLogger)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").CANCEL,r("RequestStreamE2EClientLoggerEvent").RECEIVED),this.isAlive()&&(this.$BladeRunnerSocketStream$p_1.sendCancel(this.$BladeRunnerSocketStream$p_2.getRequest()),this.$BladeRunnerSocketStream$p_2.setLastStatus(o("BladeRunnerStreamStatus").StreamStatus.CLOSED),this.getStreamHandler().onClientCancel())},a.isAlive=function(){return this.$BladeRunnerSocketStream$p_2.isAlive()},a.canAmend=function(){return this.$BladeRunnerSocketStream$p_2.canAmend()},a.getStatus=function(){return this.$BladeRunnerSocketStream$p_2.getLastStatus()},a.getStreamId=function(){return this.$BladeRunnerSocketStream$p_2.getRequest().streamId},n})(r("BladeRunnerStream"));l.default=u}),98);
__d("RequestStreamE2ESampling",["invariant","Random","RequestStreamE2EClientSamplingConfig","uuidv4"],(function(t,n,r,o,a,i,l,s){"use strict";function e(e){return e==null?!1:e.requestId!=null&&typeof e.requestId=="string"&&e.forceLogContext!=null&&typeof e.forceLogContext=="string"}function u(e,t){var n=r("RequestStreamE2EClientSamplingConfig").sampleRate;if(n>1&&e!=null){var o=r("RequestStreamE2EClientSamplingConfig").methodToSamplingMultiplier[e];o==0?n=0:o!=null&&(n/=o)}return n==1?1:n/t}function c(e,t,n,o){var a=r("uuidv4")();(t.requestId==null||t.requestId===""||typeof t.requestId!="string")&&(e.requestId!=null&&typeof e.requestId=="string"?t.requestId=e.requestId:t.requestId=a),t.requestId+="/_"+a.substring(0,4),t.resumeId="0",n!=null?t.sampleRate=n:t.sampleRate=void 0;var i="";o!=null&&o.length>0&&(i=o),i.length>0&&(t.requestLogContext!=null&&t.requestLogContext.length>0?t.requestLogContext+=":":t.requestLogContext="",t.requestLogContext+=i),(e==null?void 0:e.method)==="Falco"&&(t.clientLoggingDisabled="Falco");var l={};for(var s of Object.keys(t).sort())l[s]=t[s];return JSON.stringify(l)}function d(t,n,o,a){n&&(!n.requestId.includes("/")&&!n.requestId.includes("#")||s(0,41721));var i=u(t.method,a!=null?a:1);return r("Random").coinflip(i)?c(t,n||{requestId:""},i,o):e(n)?c(t,n||{requestId:""},null,o):""}l.isForceLogged=e,l.getSampleRateForLogging=u,l.normalizeInstrumentationData=c,l.validateInstrumentationData=d}),98);
__d("BladeRunnerClient",["Base64","BladeRunnerConfig","BladeRunnerLogger","BladeRunnerSocket","BladeRunnerSocketStream","BladeRunnerTypes","BladeRunnerTypesInternal","RequestStreamE2ELogger","RequestStreamE2ESampling","RequestStreamTransport","cr:2046346"],(function(t,n,r,o,a,i,l){var e=(function(){function e(e,t){this.$2=o("RequestStreamTransport").RequestStreamTransport.WEB_BR_MQTT,this.$1=e!=null?e:r("BladeRunnerSocket").get(),t&&(this.$2=t)}var t=e.prototype;return t.createStream=function(t,n,r,o){return this.$3(t,n,r,o)},t.requestStream=function(t,r,o,a){var e=this.$3(t,r,o,a);return e.send(),n("cr:2046346")!=null&&n("cr:2046346").startPulsarTest(),e},t.logInfo=function(t){r("BladeRunnerLogger").info(t)},t.bumpCounter=function(t){r("BladeRunnerLogger").bumpCounter(t)},t.$3=function(t,n,a,i){var e=new(o("BladeRunnerTypesInternal")).GatewayStreamRequest;return e.streamId=this.$1.getNextStreamId(),e.requestType=o("BladeRunnerTypes").StreamRequestType.BLADE_RUNNER,e.headers=r("BladeRunnerConfig").patchRequestHeaders(t),e.extraHeader=JSON.stringify(e.headers),e.payload=n!=null?r("Base64").encode(n):null,i!=null&&(i.transport="WEB_RS_MQTT"),e.instrumentationData=o("RequestStreamE2ESampling").validateInstrumentationData(e.headers||{},i),e.e2eLogger=o("RequestStreamE2ELogger").createStreamLogger(e.headers,e.instrumentationData,this.$2),new(r("BladeRunnerSocketStream"))(a,e,this.$1)},e})();l.default=e}),98);
__d("jsbi",[],(function(t,n,r,o,a,i){(function(e,t){typeof i=="object"&&typeof a!="undefined"?a.exports=t():typeof define=="function"&&define.amd?define(t):e.JSBI=t()})(this,function(){"use strict";function e(t){return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n,r=0;r<t.length;r++)n=t[r],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}function o(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function l(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function s(){return s=l()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=Function.bind.apply(e,r),a=new o;return n&&i(a,n.prototype),a},s.apply(null,arguments)}function u(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function c(e){var t=typeof Map=="function"?new Map:void 0;return c=function(e){function n(){return s(e,arguments,a(this).constructor)}if(e===null||!u(e))return e;if(typeof e!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t!="undefined"){if(t.has(e))return t.get(e);t.set(e,n)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),i(n,e)},c(e)}function d(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t){return t&&(typeof t=="object"||typeof t=="function")?t:d(e)}var p=(function(n){var i=Math.abs,l=Math.max,s=Math.imul,u=Math.clz32;function c(e,n){var r;if(t(this,c),e>c.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded");return r=m(this,a(c).call(this,e)),r.sign=n,r}return o(c,n),r(c,[{key:"toDebugString",value:function(){var e=["BigInt["],t=!0,n=!1,r=void 0;try{for(var o,a,i=this[Symbol.iterator]();!(t=(o=i.next()).done);t=!0)a=o.value,e.push((a&&(a>>>0).toString(16))+", ")}catch(e){n=!0,r=e}finally{try{t||i.return==null||i.return()}finally{if(n)throw r}}return e.push("]"),e.join("")}},{key:"toString",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:10;if(2>e||36<e)throw new RangeError("toString() radix argument must be between 2 and 36");return this.length===0?"0":(e&e-1)==0?c.__toStringBasePowerOfTwo(this,e):c.__toStringGeneric(this,e,!1)}},{key:"__copy",value:function(){for(var e=new c(this.length,this.sign),t=0;t<this.length;t++)e[t]=this[t];return e}},{key:"__trim",value:function(){for(var e=this.length,t=this[e-1];t===0;)e--,t=this[e-1],this.pop();return e===0&&(this.sign=!1),this}},{key:"__initializeDigits",value:function(){for(var e=0;e<this.length;e++)this[e]=0}},{key:"__clzmsd",value:function(){return u(this[this.length-1])}},{key:"__inplaceMultiplyAdd",value:function(e,t,n){n>this.length&&(n=this.length);for(var r=65535&e,o=e>>>16,a=0,i=65535&t,l=t>>>16,u=0;u<n;u++){var c=this.__digit(u),d=65535&c,m=c>>>16,p=s(d,r),_=s(d,o),f=s(m,r),g=s(m,o),h=i+(65535&p),y=l+a+(h>>>16)+(p>>>16)+(65535&_)+(65535&f);i=(_>>>16)+(f>>>16)+(65535&g)+(y>>>16),a=i>>>16,i&=65535,l=g>>>16,this.__setDigit(u,65535&h|y<<16)}if(a!==0||i!==0||l!==0)throw new Error("implementation bug")}},{key:"__inplaceAdd",value:function(e,t,n){for(var r,o=0,a=0;a<n;a++)r=this.__halfDigit(t+a)+e.__halfDigit(a)+o,o=r>>>16,this.__setHalfDigit(t+a,r);return o}},{key:"__inplaceSub",value:function(e,t,n){var r=0;if(1&t){t>>=1;for(var o=this.__digit(t),a=65535&o,i=0;i<n-1>>>1;i++){var l=e.__digit(i),s=(o>>>16)-(65535&l)-r;r=1&s>>>16,this.__setDigit(t+i,s<<16|65535&a),o=this.__digit(t+i+1),a=(65535&o)-(l>>>16)-r,r=1&a>>>16}var u=e.__digit(i),c=(o>>>16)-(65535&u)-r;if(r=1&c>>>16,this.__setDigit(t+i,c<<16|65535&a),t+i+1>=this.length)throw new RangeError("out of bounds");(1&n)==0&&(o=this.__digit(t+i+1),a=(65535&o)-(u>>>16)-r,r=1&a>>>16,this.__setDigit(t+e.length,4294901760&o|65535&a))}else{t>>=1;for(var d=0;d<e.length-1;d++){var m=this.__digit(t+d),p=e.__digit(d),_=(65535&m)-(65535&p)-r;r=1&_>>>16;var f=(m>>>16)-(p>>>16)-r;r=1&f>>>16,this.__setDigit(t+d,f<<16|65535&_)}var g=this.__digit(t+d),h=e.__digit(d),y=(65535&g)-(65535&h)-r;r=1&y>>>16;var C=0;(1&n)==0&&(C=(g>>>16)-(h>>>16)-r,r=1&C>>>16),this.__setDigit(t+d,C<<16|65535&y)}return r}},{key:"__inplaceRightShift",value:function(e){if(e!==0){for(var t,n=this.__digit(0)>>>e,r=this.length-1,o=0;o<r;o++)t=this.__digit(o+1),this.__setDigit(o,t<<32-e|n),n=t>>>e;this.__setDigit(r,n)}}},{key:"__digit",value:function(e){return this[e]}},{key:"__unsignedDigit",value:function(e){return this[e]>>>0}},{key:"__setDigit",value:function(e,t){this[e]=0|t}},{key:"__setDigitGrow",value:function(e,t){this[e]=0|t}},{key:"__halfDigitLength",value:function(){var e=this.length;return 65535>=this.__unsignedDigit(e-1)?2*e-1:2*e}},{key:"__halfDigit",value:function(e){return 65535&this[e>>>1]>>>((1&e)<<4)}},{key:"__setHalfDigit",value:function(e,t){var n=e>>>1,r=this.__digit(n),o=1&e?65535&r|t<<16:4294901760&r|65535&t;this.__setDigit(n,o)}}],[{key:"BigInt",value:function(t){var n=Math.floor,r=Number.isFinite;if(typeof t=="number"){if(t===0)return c.__zero();if((0|t)===t)return 0>t?c.__oneDigit(-t,!0):c.__oneDigit(t,!1);if(!r(t)||n(t)!==t)throw new RangeError("The number "+t+" cannot be converted to BigInt because it is not an integer");return c.__fromDouble(t)}if(typeof t=="string"){var o=c.__fromString(t);if(o===null)throw new SyntaxError("Cannot convert "+t+" to a BigInt");return o}if(typeof t=="boolean")return t===!0?c.__oneDigit(1,!1):c.__zero();if(e(t)==="object"){if(t.constructor===c)return t;var a=c.__toPrimitive(t);return c.BigInt(a)}throw new TypeError("Cannot convert "+t+" to a BigInt")}},{key:"toNumber",value:function(e){var t=e.length;if(t===0)return 0;if(t===1){var n=e.__unsignedDigit(0);return e.sign?-n:n}var r=e.__digit(t-1),o=u(r),a=32*t-o;if(1024<a)return e.sign?-1/0:1/0;var i=a-1,l=r,s=t-1,d=o+1,m=d===32?0:l<<d;m>>>=12;var p=d-12,_=12<=d?0:l<<20+d,f=20+d;0<p&&0<s&&(s--,l=e.__digit(s),m|=l>>>32-p,_=l<<p,f=p),0<f&&0<s&&(s--,l=e.__digit(s),_|=l>>>32-f,f-=32);var g=c.__decideRounding(e,f,s,l);if((g===1||g===0&&(1&_)==1)&&(_=_+1>>>0,_===0&&(m++,m>>>20!=0&&(m=0,i++,1023<i))))return e.sign?-1/0:1/0;var h=e.sign?-2147483648:0;return i=i+1023<<20,c.__kBitConversionInts[1]=h|i|m,c.__kBitConversionInts[0]=_,c.__kBitConversionDouble[0]}},{key:"unaryMinus",value:function(e){if(e.length===0)return e;var t=e.__copy();return t.sign=!e.sign,t}},{key:"bitwiseNot",value:function(e){return e.sign?c.__absoluteSubOne(e).__trim():c.__absoluteAddOne(e,!0)}},{key:"exponentiate",value:function(e,t){if(t.sign)throw new RangeError("Exponent must be positive");if(t.length===0)return c.__oneDigit(1,!1);if(e.length===0)return e;if(e.length===1&&e.__digit(0)===1)return e.sign&&(1&t.__digit(0))==0?c.unaryMinus(e):e;if(1<t.length)throw new RangeError("BigInt too big");var n=t.__unsignedDigit(0);if(n===1)return e;if(n>=c.__kMaxLengthBits)throw new RangeError("BigInt too big");if(e.length===1&&e.__digit(0)===2){var r=1+(n>>>5),o=e.sign&&(1&n)!=0,a=new c(r,o);a.__initializeDigits();var i=1<<(31&n);return a.__setDigit(r-1,i),a}var l=null,s=e;for((1&n)!=0&&(l=e),n>>=1;n!==0;n>>=1)s=c.multiply(s,s),(1&n)!=0&&(l===null?l=s:l=c.multiply(l,s));return l}},{key:"multiply",value:function(e,t){if(e.length===0)return e;if(t.length===0)return t;var n=e.length+t.length;32<=e.__clzmsd()+t.__clzmsd()&&n--;var r=new c(n,e.sign!==t.sign);r.__initializeDigits();for(var o=0;o<e.length;o++)c.__multiplyAccumulate(t,e.__digit(o),r,o);return r.__trim()}},{key:"divide",value:function(e,t){if(t.length===0)throw new RangeError("Division by zero");if(0>c.__absoluteCompare(e,t))return c.__zero();var n,r=e.sign!==t.sign,o=t.__unsignedDigit(0);if(t.length===1&&65535>=o){if(o===1)return r===e.sign?e:c.unaryMinus(e);n=c.__absoluteDivSmall(e,o,null)}else n=c.__absoluteDivLarge(e,t,!0,!1);return n.sign=r,n.__trim()}},{key:"remainder",value:function(t,n){if(n.length===0)throw new RangeError("Division by zero");if(0>c.__absoluteCompare(t,n))return t;var e=n.__unsignedDigit(0);if(n.length===1&&65535>=e){if(e===1)return c.__zero();var r=c.__absoluteModSmall(t,e);return r===0?c.__zero():c.__oneDigit(r,t.sign)}var o=c.__absoluteDivLarge(t,n,!1,!0);return o.sign=t.sign,o.__trim()}},{key:"add",value:function(e,t){var n=e.sign;return n===t.sign?c.__absoluteAdd(e,t,n):0<=c.__absoluteCompare(e,t)?c.__absoluteSub(e,t,n):c.__absoluteSub(t,e,!n)}},{key:"subtract",value:function(e,t){var n=e.sign;return n===t.sign?0<=c.__absoluteCompare(e,t)?c.__absoluteSub(e,t,n):c.__absoluteSub(t,e,!n):c.__absoluteAdd(e,t,n)}},{key:"leftShift",value:function(e,t){return t.length===0||e.length===0?e:t.sign?c.__rightShiftByAbsolute(e,t):c.__leftShiftByAbsolute(e,t)}},{key:"signedRightShift",value:function(e,t){return t.length===0||e.length===0?e:t.sign?c.__leftShiftByAbsolute(e,t):c.__rightShiftByAbsolute(e,t)}},{key:"unsignedRightShift",value:function(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}},{key:"lessThan",value:function(e,t){return 0>c.__compareToBigInt(e,t)}},{key:"lessThanOrEqual",value:function(e,t){return 0>=c.__compareToBigInt(e,t)}},{key:"greaterThan",value:function(e,t){return 0<c.__compareToBigInt(e,t)}},{key:"greaterThanOrEqual",value:function(e,t){return 0<=c.__compareToBigInt(e,t)}},{key:"equal",value:function(e,t){if(e.sign!==t.sign||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e.__digit(n)!==t.__digit(n))return!1;return!0}},{key:"notEqual",value:function(e,t){return!c.equal(e,t)}},{key:"bitwiseAnd",value:function(e,t){if(!e.sign&&!t.sign)return c.__absoluteAnd(e,t).__trim();if(e.sign&&t.sign){var n=l(e.length,t.length)+1,r=c.__absoluteSubOne(e,n),o=c.__absoluteSubOne(t);return r=c.__absoluteOr(r,o,r),c.__absoluteAddOne(r,!0,r).__trim()}if(e.sign){var a=[t,e];e=a[0],t=a[1]}return c.__absoluteAndNot(e,c.__absoluteSubOne(t)).__trim()}},{key:"bitwiseXor",value:function(e,t){if(!e.sign&&!t.sign)return c.__absoluteXor(e,t).__trim();if(e.sign&&t.sign){var n=l(e.length,t.length),r=c.__absoluteSubOne(e,n),o=c.__absoluteSubOne(t);return c.__absoluteXor(r,o,r).__trim()}var a=l(e.length,t.length)+1;if(e.sign){var i=[t,e];e=i[0],t=i[1]}var s=c.__absoluteSubOne(t,a);return s=c.__absoluteXor(s,e,s),c.__absoluteAddOne(s,!0,s).__trim()}},{key:"bitwiseOr",value:function(e,t){var n=l(e.length,t.length);if(!e.sign&&!t.sign)return c.__absoluteOr(e,t).__trim();if(e.sign&&t.sign){var r=c.__absoluteSubOne(e,n),o=c.__absoluteSubOne(t);return r=c.__absoluteAnd(r,o,r),c.__absoluteAddOne(r,!0,r).__trim()}if(e.sign){var a=[t,e];e=a[0],t=a[1]}var i=c.__absoluteSubOne(t,n);return i=c.__absoluteAndNot(i,e,i),c.__absoluteAddOne(i,!0,i).__trim()}},{key:"asIntN",value:function(e,t){if(t.length===0)return t;if(e===0)return c.__zero();if(e>=c.__kMaxLengthBits)return t;var n=e+31>>>5;if(t.length<n)return t;var r=t.__unsignedDigit(n-1),o=1<<(31&e-1);if(t.length===n&&r<o)return t;if((r&o)!==o)return c.__truncateToNBits(e,t);if(!t.sign)return c.__truncateAndSubFromPowerOfTwo(e,t,!0);if((r&o-1)==0){for(var a=n-2;0<=a;a--)if(t.__digit(a)!==0)return c.__truncateAndSubFromPowerOfTwo(e,t,!1);return t.length===n&&r===o?t:c.__truncateToNBits(e,t)}return c.__truncateAndSubFromPowerOfTwo(e,t,!1)}},{key:"asUintN",value:function(e,t){if(t.length===0)return t;if(e===0)return c.__zero();if(t.sign){if(e>c.__kMaxLengthBits)throw new RangeError("BigInt too big");return c.__truncateAndSubFromPowerOfTwo(e,t,!1)}if(e>=c.__kMaxLengthBits)return t;var n=e+31>>>5;if(t.length<n)return t;var r=31&e;if(t.length==n){if(r==0)return t;var o=t.__digit(n-1);if(!(o>>>r))return t}return c.__truncateToNBits(e,t)}},{key:"ADD",value:function(e,t){if(e=c.__toPrimitive(e),t=c.__toPrimitive(t),typeof e=="string")return typeof t!="string"&&(t=t.toString()),e+t;if(typeof t=="string")return e.toString()+t;if(e=c.__toNumeric(e),t=c.__toNumeric(t),c.__isBigInt(e)&&c.__isBigInt(t))return c.add(e,t);if(typeof e=="number"&&typeof t=="number")return e+t;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}},{key:"LT",value:function(e,t){return c.__compare(e,t,0)}},{key:"LE",value:function(e,t){return c.__compare(e,t,1)}},{key:"GT",value:function(e,t){return c.__compare(e,t,2)}},{key:"GE",value:function(e,t){return c.__compare(e,t,3)}},{key:"EQ",value:function(t,n){for(;;){if(c.__isBigInt(t))return c.__isBigInt(n)?c.equal(t,n):c.EQ(n,t);if(typeof t=="number"){if(c.__isBigInt(n))return c.__equalToNumber(n,t);if(e(n)!=="object")return t==n;n=c.__toPrimitive(n)}else if(typeof t=="string"){if(c.__isBigInt(n))return t=c.__fromString(t),t!==null&&c.equal(t,n);if(e(n)!=="object")return t==n;n=c.__toPrimitive(n)}else if(typeof t=="boolean"){if(c.__isBigInt(n))return c.__equalToNumber(n,+t);if(e(n)!=="object")return t==n;n=c.__toPrimitive(n)}else if(e(t)==="symbol"){if(c.__isBigInt(n))return!1;if(e(n)!=="object")return t==n;n=c.__toPrimitive(n)}else if(e(t)==="object"){if(e(n)==="object"&&n.constructor!==c)return t==n;t=c.__toPrimitive(t)}else return t==n}}},{key:"NE",value:function(e,t){return!c.EQ(e,t)}},{key:"__zero",value:function(){return new c(0,!1)}},{key:"__oneDigit",value:function(e,t){var n=new c(1,t);return n.__setDigit(0,e),n}},{key:"__decideRounding",value:function(e,t,n,r){if(0<t)return-1;var o;if(0>t)o=-t-1;else{if(n===0)return-1;n--,r=e.__digit(n),o=31}var a=1<<o;if((r&a)==0)return-1;if(a-=1,(r&a)!=0)return 1;for(;0<n;)if(n--,e.__digit(n)!==0)return 1;return 0}},{key:"__fromDouble",value:function(e){c.__kBitConversionDouble[0]=e;var t,n=2047&c.__kBitConversionInts[1]>>>20,r=n-1023,o=(r>>>5)+1,a=new c(o,0>e),i=1048575&c.__kBitConversionInts[1]|1048576,l=c.__kBitConversionInts[0],s=20,u=31&r,d=0;if(u<s){var m=s-u;d=m+32,t=i>>>m,i=i<<32-m|l>>>m,l<<=32-m}else if(u===s)d=32,t=i,i=l;else{var p=u-s;d=32-p,t=i<<p|l>>>32-p,i=l<<p}a.__setDigit(o-1,t);for(var _=o-2;0<=_;_--)0<d?(d-=32,t=i,i=l):t=0,a.__setDigit(_,t);return a.__trim()}},{key:"__isWhitespace",value:function(e){return 13>=e&&9<=e||(159>=e?e==32:131071>=e?e==160||e==5760:196607>=e?(e&=131071,10>=e||e==40||e==41||e==47||e==95||e==4096):e==65279)}},{key:"__fromString",value:function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,n=0,r=e.length,o=0;if(o===r)return c.__zero();for(var a=e.charCodeAt(o);c.__isWhitespace(a);){if(++o===r)return c.__zero();a=e.charCodeAt(o)}if(a===43){if(++o===r)return null;a=e.charCodeAt(o),n=1}else if(a===45){if(++o===r)return null;a=e.charCodeAt(o),n=-1}if(t===0){if(t=10,a===48){if(++o===r)return c.__zero();if(a=e.charCodeAt(o),a===88||a===120){if(t=16,++o===r)return null;a=e.charCodeAt(o)}else if(a===79||a===111){if(t=8,++o===r)return null;a=e.charCodeAt(o)}else if(a===66||a===98){if(t=2,++o===r)return null;a=e.charCodeAt(o)}}}else if(t===16&&a===48){if(++o===r)return c.__zero();if(a=e.charCodeAt(o),a===88||a===120){if(++o===r)return null;a=e.charCodeAt(o)}}for(;a===48;){if(++o===r)return c.__zero();a=e.charCodeAt(o)}var i=r-o,l=c.__kMaxBitsPerChar[t],s=c.__kBitsPerCharTableMultiplier-1;if(i>1073741824/l)return null;var u=l*i+s>>>c.__kBitsPerCharTableShift,d=new c(u+31>>>5,!1),m=10>t?t:10,p=10<t?t-10:0;if((t&t-1)==0){l>>=c.__kBitsPerCharTableShift;var _=[],f=[],g=!1;do{for(var h,y=0,C=0;;){if(h=void 0,a-48>>>0<m)h=a-48;else if((32|a)-97>>>0<p)h=(32|a)-87;else{g=!0;break}if(C+=l,y=y<<l|h,++o===r){g=!0;break}if(a=e.charCodeAt(o),32<C+l)break}_.push(y),f.push(C)}while(!g);c.__fillFromParts(d,_,f)}else{d.__initializeDigits();var b=!1,v=0;do{for(var S,R=0,L=1;;){if(S=void 0,a-48>>>0<m)S=a-48;else if((32|a)-97>>>0<p)S=(32|a)-87;else{b=!0;break}var E=L*t;if(4294967295<E)break;if(L=E,R=R*t+S,v++,++o===r){b=!0;break}a=e.charCodeAt(o)}s=32*c.__kBitsPerCharTableMultiplier-1;var k=l*v+s>>>c.__kBitsPerCharTableShift+5;d.__inplaceMultiplyAdd(L,R,k)}while(!b)}if(o!==r){if(!c.__isWhitespace(a))return null;for(o++;o<r;o++)if(a=e.charCodeAt(o),!c.__isWhitespace(a))return null}return n!==0&&t!==10?null:(d.sign=n===-1,d.__trim())}},{key:"__fillFromParts",value:function(e,t,n){for(var r=0,o=0,a=0,i=t.length-1;0<=i;i--){var l=t[i],s=n[i];o|=l<<a,a+=s,a===32?(e.__setDigit(r++,o),a=0,o=0):32<a&&(e.__setDigit(r++,o),a-=32,o=l>>>s-a)}if(o!==0){if(r>=e.length)throw new Error("implementation bug");e.__setDigit(r++,o)}for(;r<e.length;r++)e.__setDigit(r,0)}},{key:"__toStringBasePowerOfTwo",value:function(e,t){var n=e.length,r=t-1;r=(85&r>>>1)+(85&r),r=(51&r>>>2)+(51&r),r=(15&r>>>4)+(15&r);var o=r,a=t-1,i=e.__digit(n-1),l=u(i),s=0|(32*n-l+o-1)/o;if(e.sign&&s++,268435456<s)throw new Error("string too long");for(var d=Array(s),m=s-1,p=0,_=0,f=0;f<n-1;f++){var g=e.__digit(f),h=(p|g<<_)&a;d[m--]=c.__kConversionChars[h];var y=o-_;for(p=g>>>y,_=32-y;_>=o;)d[m--]=c.__kConversionChars[p&a],p>>>=o,_-=o}var C=(p|i<<_)&a;for(d[m--]=c.__kConversionChars[C],p=i>>>o-_;p!==0;)d[m--]=c.__kConversionChars[p&a],p>>>=o;if(e.sign&&(d[m--]="-"),m!==-1)throw new Error("implementation bug");return d.join("")}},{key:"__toStringGeneric",value:function(e,t,n){var r=e.length;if(r===0)return"";if(r===1){var o=e.__unsignedDigit(0).toString(t);return n===!1&&e.sign&&(o="-"+o),o}var a=32*r-u(e.__digit(r-1)),i=c.__kMaxBitsPerChar[t],l=i-1,s=a*c.__kBitsPerCharTableMultiplier;s+=l-1,s=0|s/l;var d,m,p=s+1>>1,_=c.exponentiate(c.__oneDigit(t,!1),c.__oneDigit(p,!1)),f=_.__unsignedDigit(0);if(_.length===1&&65535>=f){d=new c(e.length,!1),d.__initializeDigits();for(var g,h=0,y=2*e.length-1;0<=y;y--)g=h<<16|e.__halfDigit(y),d.__setHalfDigit(y,0|g/f),h=0|g%f;m=h.toString(t)}else{var C=c.__absoluteDivLarge(e,_,!0,!0);d=C.quotient;var b=C.remainder.__trim();m=c.__toStringGeneric(b,t,!0)}d.__trim();for(var v=c.__toStringGeneric(d,t,!0);m.length<p;)m="0"+m;return n===!1&&e.sign&&(v="-"+v),v+m}},{key:"__unequalSign",value:function(e){return e?-1:1}},{key:"__absoluteGreater",value:function(e){return e?-1:1}},{key:"__absoluteLess",value:function(e){return e?1:-1}},{key:"__compareToBigInt",value:function(e,t){var n=e.sign;if(n!==t.sign)return c.__unequalSign(n);var r=c.__absoluteCompare(e,t);return 0<r?c.__absoluteGreater(n):0>r?c.__absoluteLess(n):0}},{key:"__compareToNumber",value:function(e,t){if(!0|t){var n=e.sign,r=0>t;if(n!==r)return c.__unequalSign(n);if(e.length===0){if(r)throw new Error("implementation bug");return t===0?0:-1}if(1<e.length)return c.__absoluteGreater(n);var o=i(t),a=e.__unsignedDigit(0);return a>o?c.__absoluteGreater(n):a<o?c.__absoluteLess(n):0}return c.__compareToDouble(e,t)}},{key:"__compareToDouble",value:function(e,t){if(t!==t)return t;if(t===1/0)return-1;if(t===-1/0)return 1;var n=e.sign;if(n!==0>t)return c.__unequalSign(n);if(t===0)throw new Error("implementation bug: should be handled elsewhere");if(e.length===0)return-1;c.__kBitConversionDouble[0]=t;var r=2047&c.__kBitConversionInts[1]>>>20;if(r==2047)throw new Error("implementation bug: handled elsewhere");var o=r-1023;if(0>o)return c.__absoluteGreater(n);var a=e.length,i=e.__digit(a-1),l=u(i),s=32*a-l,d=o+1;if(s<d)return c.__absoluteLess(n);if(s>d)return c.__absoluteGreater(n);var m=1048576|1048575&c.__kBitConversionInts[1],p=c.__kBitConversionInts[0],_=20,f=31-l;if(f!==(s-1)%31)throw new Error("implementation bug");var g,h=0;if(f<_){var y=_-f;h=y+32,g=m>>>y,m=m<<32-y|p>>>y,p<<=32-y}else if(f===_)h=32,g=m,m=p;else{var C=f-_;h=32-C,g=m<<C|p>>>32-C,m=p<<C}if(i>>>=0,g>>>=0,i>g)return c.__absoluteGreater(n);if(i<g)return c.__absoluteLess(n);for(var b=a-2;0<=b;b--){0<h?(h-=32,g=m>>>0,m=p,p=0):g=0;var v=e.__unsignedDigit(b);if(v>g)return c.__absoluteGreater(n);if(v<g)return c.__absoluteLess(n)}if(m!==0||p!==0){if(h===0)throw new Error("implementation bug");return c.__absoluteLess(n)}return 0}},{key:"__equalToNumber",value:function(e,t){return t|t===0?t===0?e.length===0:e.length===1&&e.sign===0>t&&e.__unsignedDigit(0)===i(t):c.__compareToDouble(e,t)===0}},{key:"__comparisonResultToBool",value:function(e,t){switch(t){case 0:return 0>e;case 1:return 0>=e;case 2:return 0<e;case 3:return 0<=e}throw new Error("unreachable")}},{key:"__compare",value:function(e,t,n){if(e=c.__toPrimitive(e),t=c.__toPrimitive(t),typeof e=="string"&&typeof t=="string")switch(n){case 0:return e<t;case 1:return e<=t;case 2:return e>t;case 3:return e>=t}if(c.__isBigInt(e)&&typeof t=="string")return t=c.__fromString(t),t!==null&&c.__comparisonResultToBool(c.__compareToBigInt(e,t),n);if(typeof e=="string"&&c.__isBigInt(t))return e=c.__fromString(e),e!==null&&c.__comparisonResultToBool(c.__compareToBigInt(e,t),n);if(e=c.__toNumeric(e),t=c.__toNumeric(t),c.__isBigInt(e)){if(c.__isBigInt(t))return c.__comparisonResultToBool(c.__compareToBigInt(e,t),n);if(typeof t!="number")throw new Error("implementation bug");return c.__comparisonResultToBool(c.__compareToNumber(e,t),n)}if(typeof e!="number")throw new Error("implementation bug");if(c.__isBigInt(t))return c.__comparisonResultToBool(c.__compareToNumber(t,e),2^n);if(typeof t!="number")throw new Error("implementation bug");return n===0?e<t:n===1?e<=t:n===2?e>t:n===3?e>=t:void 0}},{key:"__absoluteAdd",value:function(e,t,n){if(e.length<t.length)return c.__absoluteAdd(t,e,n);if(e.length===0)return e;if(t.length===0)return e.sign===n?e:c.unaryMinus(e);var r=e.length;(e.__clzmsd()===0||t.length===e.length&&t.__clzmsd()===0)&&r++;for(var o=new c(r,n),a=0,i=0;i<t.length;i++){var l=t.__digit(i),s=e.__digit(i),u=(65535&s)+(65535&l)+a,d=(s>>>16)+(l>>>16)+(u>>>16);a=d>>>16,o.__setDigit(i,65535&u|d<<16)}for(;i<e.length;i++){var m=e.__digit(i),p=(65535&m)+a,_=(m>>>16)+(p>>>16);a=_>>>16,o.__setDigit(i,65535&p|_<<16)}return i<o.length&&o.__setDigit(i,a),o.__trim()}},{key:"__absoluteSub",value:function(e,t,n){if(e.length===0)return e;if(t.length===0)return e.sign===n?e:c.unaryMinus(e);for(var r=new c(e.length,n),o=0,a=0;a<t.length;a++){var i=e.__digit(a),l=t.__digit(a),s=(65535&i)-(65535&l)-o;o=1&s>>>16;var u=(i>>>16)-(l>>>16)-o;o=1&u>>>16,r.__setDigit(a,65535&s|u<<16)}for(;a<e.length;a++){var d=e.__digit(a),m=(65535&d)-o;o=1&m>>>16;var p=(d>>>16)-o;o=1&p>>>16,r.__setDigit(a,65535&m|p<<16)}return r.__trim()}},{key:"__absoluteAddOne",value:function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,r=e.length;n===null?n=new c(r,t):n.sign=t;for(var o=!0,a=0;a<r;a++){var i=e.__digit(a),l=i===-1;o&&(i=0|i+1),o=l,n.__setDigit(a,i)}return o&&n.__setDigitGrow(r,1),n}},{key:"__absoluteSubOne",value:function(e,t){var n=e.length;t=t||n;for(var r=new c(t,!1),o=!0,a=0;a<n;a++){var i=e.__digit(a),l=i===0;o&&(i=0|i-1),o=l,r.__setDigit(a,i)}for(var s=n;s<t;s++)r.__setDigit(s,0);return r}},{key:"__absoluteAnd",value:function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,r=e.length,o=t.length,a=o;if(r<o){a=r;var i=e,l=r;e=t,r=o,t=i,o=l}var s=a;n===null?n=new c(s,!1):s=n.length;for(var u=0;u<a;u++)n.__setDigit(u,e.__digit(u)&t.__digit(u));for(;u<s;u++)n.__setDigit(u,0);return n}},{key:"__absoluteAndNot",value:function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,r=e.length,o=t.length,a=o;r<o&&(a=r);var i=r;n===null?n=new c(i,!1):i=n.length;for(var l=0;l<a;l++)n.__setDigit(l,e.__digit(l)&~t.__digit(l));for(;l<r;l++)n.__setDigit(l,e.__digit(l));for(;l<i;l++)n.__setDigit(l,0);return n}},{key:"__absoluteOr",value:function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,r=e.length,o=t.length,a=o;if(r<o){a=r;var i=e,l=r;e=t,r=o,t=i,o=l}var s=r;n===null?n=new c(s,!1):s=n.length;for(var u=0;u<a;u++)n.__setDigit(u,e.__digit(u)|t.__digit(u));for(;u<r;u++)n.__setDigit(u,e.__digit(u));for(;u<s;u++)n.__setDigit(u,0);return n}},{key:"__absoluteXor",value:function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,r=e.length,o=t.length,a=o;if(r<o){a=r;var i=e,l=r;e=t,r=o,t=i,o=l}var s=r;n===null?n=new c(s,!1):s=n.length;for(var u=0;u<a;u++)n.__setDigit(u,e.__digit(u)^t.__digit(u));for(;u<r;u++)n.__setDigit(u,e.__digit(u));for(;u<s;u++)n.__setDigit(u,0);return n}},{key:"__absoluteCompare",value:function(e,t){var n=e.length-t.length;if(n!=0)return n;for(var r=e.length-1;0<=r&&e.__digit(r)===t.__digit(r);)r--;return 0>r?0:e.__unsignedDigit(r)>t.__unsignedDigit(r)?1:-1}},{key:"__multiplyAccumulate",value:function(e,t,n,r){if(t!==0){for(var o=65535&t,a=t>>>16,i=0,l=0,u=0,c=0;c<e.length;c++,r++){var d=n.__digit(r),m=65535&d,p=d>>>16,_=e.__digit(c),f=65535&_,g=_>>>16,h=s(f,o),y=s(f,a),C=s(g,o),b=s(g,a);m+=l+(65535&h),p+=u+i+(m>>>16)+(h>>>16)+(65535&y)+(65535&C),i=p>>>16,l=(y>>>16)+(C>>>16)+(65535&b)+i,i=l>>>16,l&=65535,u=b>>>16,d=65535&m|p<<16,n.__setDigit(r,d)}for(;i!==0||l!==0||u!==0;r++){var v=n.__digit(r),S=(65535&v)+l,R=(v>>>16)+(S>>>16)+u+i;l=0,u=0,i=R>>>16,v=65535&S|R<<16,n.__setDigit(r,v)}}}},{key:"__internalMultiplyAdd",value:function(e,t,n,r,o){for(var a=n,i=0,l=0;l<r;l++){var u=e.__digit(l),c=s(65535&u,t),d=(65535&c)+i+a;a=d>>>16;var m=s(u>>>16,t),p=(65535&m)+(c>>>16)+a;a=p>>>16,i=m>>>16,o.__setDigit(l,p<<16|65535&d)}if(o.length>r)for(o.__setDigit(r++,a+i);r<o.length;)o.__setDigit(r++,0);else if(a+i!==0)throw new Error("implementation bug")}},{key:"__absoluteDivSmall",value:function(e,t,n){n===null&&(n=new c(e.length,!1));for(var r=0,o=2*e.length-1;0<=o;o-=2){var a=(r<<16|e.__halfDigit(o))>>>0,i=0|a/t;r=0|a%t,a=(r<<16|e.__halfDigit(o-1))>>>0;var l=0|a/t;r=0|a%t,n.__setDigit(o>>>1,i<<16|l)}return n}},{key:"__absoluteModSmall",value:function(e,t){for(var n,r=0,o=2*e.length-1;0<=o;o--)n=(r<<16|e.__halfDigit(o))>>>0,r=0|n%t;return r}},{key:"__absoluteDivLarge",value:function(e,t,n,r){var o=t.__halfDigitLength(),a=t.length,i=e.__halfDigitLength()-o,l=null;n&&(l=new c(i+2>>>1,!1),l.__initializeDigits());var u=new c(o+2>>>1,!1);u.__initializeDigits();var d=c.__clz16(t.__halfDigit(o-1));0<d&&(t=c.__specialLeftShift(t,d,0));for(var m=c.__specialLeftShift(e,d,1),p=t.__halfDigit(o-1),_=0,f=i;0<=f;f--){var g=65535,h=m.__halfDigit(f+o);if(h!==p){var y=(h<<16|m.__halfDigit(f+o-1))>>>0;g=0|y/p;for(var C=0|y%p,b=t.__halfDigit(o-2),v=m.__halfDigit(f+o-2);s(g,b)>>>0>(C<<16|v)>>>0&&(g--,C+=p,!(65535<C)););}c.__internalMultiplyAdd(t,g,0,a,u);var S=m.__inplaceSub(u,f,o+1);S!==0&&(S=m.__inplaceAdd(t,f,o),m.__setHalfDigit(f+o,m.__halfDigit(f+o)+S),g--),n&&(1&f?_=g<<16:l.__setDigit(f>>>1,_|g))}return r?(m.__inplaceRightShift(d),n?{quotient:l,remainder:m}:m):n?l:void 0}},{key:"__clz16",value:function(e){return u(e)-16}},{key:"__specialLeftShift",value:function(e,t,n){var r=e.length,o=new c(r+n,!1);if(t===0){for(var a=0;a<r;a++)o.__setDigit(a,e.__digit(a));return 0<n&&o.__setDigit(r,0),o}for(var i,l=0,s=0;s<r;s++)i=e.__digit(s),o.__setDigit(s,i<<t|l),l=i>>>32-t;return 0<n&&o.__setDigit(r,l),o}},{key:"__leftShiftByAbsolute",value:function(e,t){var n=c.__toShiftAmount(t);if(0>n)throw new RangeError("BigInt too big");var r=n>>>5,o=31&n,a=e.length,i=o!==0&&e.__digit(a-1)>>>32-o!=0,l=a+r+(i?1:0),s=new c(l,e.sign);if(o===0){for(var u=0;u<r;u++)s.__setDigit(u,0);for(;u<l;u++)s.__setDigit(u,e.__digit(u-r))}else{for(var d=0,m=0;m<r;m++)s.__setDigit(m,0);for(var p,_=0;_<a;_++)p=e.__digit(_),s.__setDigit(_+r,p<<o|d),d=p>>>32-o;if(i)s.__setDigit(a+r,d);else if(d!==0)throw new Error("implementation bug")}return s.__trim()}},{key:"__rightShiftByAbsolute",value:function(e,t){var n=e.length,r=e.sign,o=c.__toShiftAmount(t);if(0>o)return c.__rightShiftByMaximum(r);var a=o>>>5,i=31&o,l=n-a;if(0>=l)return c.__rightShiftByMaximum(r);var s=!1;if(r){if((e.__digit(a)&(1<<i)-1)!=0)s=!0;else for(var u=0;u<a;u++)if(e.__digit(u)!==0){s=!0;break}}if(s&&i===0){var d=e.__digit(n-1);~d==0&&l++}var m=new c(l,r);if(i===0)for(var p=a;p<n;p++)m.__setDigit(p-a,e.__digit(p));else{for(var _,f=e.__digit(a)>>>i,g=n-a-1,h=0;h<g;h++)_=e.__digit(h+a+1),m.__setDigit(h,_<<32-i|f),f=_>>>i;m.__setDigit(g,f)}return s&&(m=c.__absoluteAddOne(m,!0,m)),m.__trim()}},{key:"__rightShiftByMaximum",value:function(e){return e?c.__oneDigit(1,!0):c.__zero()}},{key:"__toShiftAmount",value:function(e){if(1<e.length)return-1;var t=e.__unsignedDigit(0);return t>c.__kMaxLengthBits?-1:t}},{key:"__toPrimitive",value:function(t){var n=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"default";if(e(t)!=="object"||t.constructor===c)return t;var r=t[Symbol.toPrimitive];if(r){var o=r(n);if(e(o)!=="object")return o;throw new TypeError("Cannot convert object to primitive value")}var a=t.valueOf;if(a){var i=a.call(t);if(e(i)!=="object")return i}var l=t.toString;if(l){var s=l.call(t);if(e(s)!=="object")return s}throw new TypeError("Cannot convert object to primitive value")}},{key:"__toNumeric",value:function(e){return c.__isBigInt(e)?e:+e}},{key:"__isBigInt",value:function(t){return e(t)==="object"&&t.constructor===c}},{key:"__truncateToNBits",value:function(e,t){for(var n=e+31>>>5,r=new c(n,t.sign),o=n-1,a=0;a<o;a++)r.__setDigit(a,t.__digit(a));var i=t.__digit(o);if((31&e)!=0){var l=32-(31&e);i=i<<l>>>l}return r.__setDigit(o,i),r.__trim()}},{key:"__truncateAndSubFromPowerOfTwo",value:function(e,t,n){for(var r=Math.min,o=e+31>>>5,a=new c(o,n),i=0,l=o-1,s=0,u=r(l,t.length);i<u;i++){var d=t.__digit(i),m=0-(65535&d)-s;s=1&m>>>16;var p=0-(d>>>16)-s;s=1&p>>>16,a.__setDigit(i,65535&m|p<<16)}for(;i<l;i++)a.__setDigit(i,0|-s);var _,f=l<t.length?t.__digit(l):0,g=31&e;if(g===0){var h=0-(65535&f)-s;s=1&h>>>16;var y=0-(f>>>16)-s;_=65535&h|y<<16}else{var C=32-g;f=f<<C>>>C;var b=1<<32-C,v=(65535&b)-(65535&f)-s;s=1&v>>>16;var S=(b>>>16)-(f>>>16)-s;_=65535&v|S<<16,_&=b-1}return a.__setDigit(l,_),a.__trim()}},{key:"__digitPow",value:function(e,t){for(var n=1;0<t;)1&t&&(n*=e),t>>>=1,e*=e;return n}}]),c})(c(Array));return p.__kMaxLength=33554432,p.__kMaxLengthBits=p.__kMaxLength<<5,p.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],p.__kBitsPerCharTableShift=5,p.__kBitsPerCharTableMultiplier=1<<p.__kBitsPerCharTableShift,p.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],p.__kBitConversionBuffer=new ArrayBuffer(8),p.__kBitConversionDouble=new Float64Array(p.__kBitConversionBuffer),p.__kBitConversionInts=new Int32Array(p.__kBitConversionBuffer),p})}),null);
__d("TCompactProtocolPolyfill",["StringToUtf8","ThriftTypes","Utf8ToString","jsbi"],(function(t,n,r,o,a,i,l){var e,s,u=Object.freeze({CT_STOP:0,CT_BOOLEAN_TRUE:1,CT_BOOLEAN_FALSE:2,CT_BYTE:3,CT_I16:4,CT_I32:5,CT_I64:6,CT_DOUBLE:7,CT_BINARY:8,CT_LIST:9,CT_SET:10,CT_MAP:11,CT_STRUCT:12,CT_FLOAT:13}),c=Object.freeze({NONE:-1,CT_BOOLEAN_TRUE:u.CT_BOOLEAN_TRUE,CT_BOOLEAN_FALSE:u.CT_BOOLEAN_FALSE}),d=[u.CT_STOP,0,u.CT_BOOLEAN_TRUE,u.CT_BYTE,u.CT_DOUBLE,0,u.CT_I16,0,u.CT_I32,0,u.CT_I64,u.CT_BINARY,u.CT_STRUCT,u.CT_MAP,u.CT_SET,u.CT_LIST,0,0,0,u.CT_FLOAT],m=Math.pow(2,7)-1,p=-1*Math.pow(2,7),_=Math.pow(2,15)-1,f=-1*Math.pow(2,15),g=Math.pow(2,31)-1,h=-1*Math.pow(2,31),y=Math.pow(2,32)-1,C=(s=r("jsbi")).BigInt("9223372036854775807"),b=s.BigInt("-9223372036854775808"),v=s.BigInt("18446744073709551615"),S=s.BigInt(63),R=s.BigInt(1),L=s.BigInt(0),E=s.BigInt(7),k=s.BigInt(70),I=s.BigInt(127),T=s.BigInt(128),D=Math.pow(2,4),x=(function(){function t(e){this.$4=null,this.$5=null,this.$1=e,this.$2=[],this.$3=0,this.$6=new DataView(new ArrayBuffer(1))}var n=t.prototype;return n.readStructBegin=function(){this.$2.push(this.$3),this.$3=0},n.readStructEnd=function(){return this.$3=this.$2.pop(),0},n.writeStructBegin=function(t){return this.$2.push(this.$3),this.$3=0,0},n.writeStructEnd=function(){return this.$3=this.$2.pop(),0},n.writeFieldBegin=function(n){return n.ftype===(e||(e=r("ThriftTypes"))).BOOL?(this.$4={fid:n.fid,fname:n.fname,ftype:n.ftype},0):this.$7(n,c.NONE)},n.writeListBegin=function(t){return this.$8(t)},n.writeListEnd=function(){return 0},n.writeSetBegin=function(t){return this.$8(t)},n.writeSetEnd=function(){return 0},n.writeMapBegin=function(t){var e=0;if(t.size===0)e+=this.$1.writeByte(0);else if(e+=this.writeVarint32(t.size),t.ktype!=null&&t.vtype!=null)e+=this.$1.writeByte(this.$9(t.ktype)<<4|this.$9(t.vtype));else throw new Error("received invalid map info: "+JSON.stringify(t));return e},n.writeMapEnd=function(){return 0},n.$7=function(t,n){var e=0,r=n===c.NONE?this.$9(t.ftype):n;return t.fid>this.$3&&t.fid-this.$3<=D-1?e+=this.$1.writeByte(t.fid-this.$3<<4|r):(e+=this.$1.writeByte(r),e+=this.writeI16(t.fid)),this.$3=t.fid,e},n.$8=function(t){var e=0,n=this.$9(t.etype);return t.size<=D-2?e+=this.$1.writeByte(t.size<<4|n):(e+=this.$1.writeByte(240|n),e+=this.writeVarint32(t.size)),e},n.readFieldBegin=function(){var t=this.$1.readByte(),n=t&15;if(n===(e||(e=r("ThriftTypes"))).STOP)return{ftype:(e||(e=r("ThriftTypes"))).STOP,fid:0};var o=(t&240)>>>4,a;o===0?a=this.readI16():a=this.$3+o;var i=this.$10(n);return(n===u.CT_BOOLEAN_TRUE||n===u.CT_BOOLEAN_FALSE)&&(this.$5=n===u.CT_BOOLEAN_TRUE),this.$3=a,{ftype:i,fid:a}},n.readListBegin=function(){return this.$11()},n.readListEnd=function(){return 0},n.readSetBegin=function(){return this.$11()},n.readSetEnd=function(){return 0},n.readMapBegin=function(){var e=this.readVarint32();if(e>0){var t=this.$1.readByte(),n=this.$12(t>>4,"readMapBegin:key"),r=this.$12(t&15,"readMapBegin:value");return{ktype:this.$10(n),vtype:this.$10(r),size:e}}return{size:e}},n.readMapEnd=function(){return 0},n.$12=function(t,n){if(t<0||t>13)throw new Error(n+" read invalid compact type: "+t);return t},n.$11=function(){var e=this.$1.readByte(),t=this.$12(e&15,"_readListOrSetBegin"),n=this.$10(t),r=e>>4&15;return r===15&&(r=this.readVarint32()),{etype:n,size:r}},n.readFieldEnd=function(){return 0},n.readByte=function(){return this.$6.setUint8(0,this.$1.readByte()),this.$6.getInt8(0)},n.writeByte=function(t){if(t<p||t>m)throw new Error("byte to write is out of range: "+t);return this.$6.setInt8(0,t),this.$1.writeByte(this.$6.getUint8(0))},n.readFloat=function(){return this.$1.readFloatBE()},n.writeFloat=function(t){return this.$1.writeFloatBE(t)},n.readDouble=function(){return this.$1.readDoubleBE()},n.writeDouble=function(t){return this.$1.writeDoubleBE(t)},n.writeString=function(t){return this.writeBinary(o("StringToUtf8").StringToUtf8(t))},n.skip=function(n){switch(n){case(e||(e=r("ThriftTypes"))).STOP:return;case(e||(e=r("ThriftTypes"))).BOOL:this.readBool();break;case(e||(e=r("ThriftTypes"))).BYTE:this.readByte();break;case(e||(e=r("ThriftTypes"))).DOUBLE:this.readDouble();break;case(e||(e=r("ThriftTypes"))).I16:this.readI16();break;case(e||(e=r("ThriftTypes"))).I32:this.readI32();break;case(e||(e=r("ThriftTypes"))).I64:this.readI64();break;case(e||(e=r("ThriftTypes"))).STRING:this.readString();break;case(e||(e=r("ThriftTypes"))).STRUCT:{this.readStructBegin();for(var t;t=this.readFieldBegin(),t.ftype!==(e||(e=r("ThriftTypes"))).STOP;)this.skip(t.ftype);this.readStructEnd();break}case(e||(e=r("ThriftTypes"))).MAP:{var o=this.readMapBegin();if(o.size>0&&o.ktype!=null&&o.vtype!=null)for(var a=o.ktype,i=o.vtype,l=0;l<o.size;l++)this.skip(a),this.skip(i);break}case(e||(e=r("ThriftTypes"))).SET:case(e||(e=r("ThriftTypes"))).LIST:{for(var s=this.$11(),u=0;u<s.size;u++)this.skip(s.etype);break}case(e||(e=r("ThriftTypes"))).FLOAT:this.readFloat();break;default:throw new Error("encoutered unknow thrift type: "+n+" in skip")}},n.toByteArray=function(){return this.$1.toByteArray()},n.writeFieldEnd=function(){return 0},n.writeFieldStop=function(){return this.$1.writeByte((e||(e=r("ThriftTypes"))).STOP)},n.writeI16=function(t){if(t<f||t>_)throw new Error("trying to write i16 out of range: "+t);return this.writeVarint32(this.i32ToZigzag(t))},n.readI16=function(){var e=this.zigzagToI32(this.readVarint32());if(e<f||e>_)throw new Error("read invalid i16: "+e);return e},n.writeI32=function(t){if(t<h||t>g)throw new Error("i32 out of range: "+t);return this.writeVarint32(this.i32ToZigzag(t))},n.readI32=function(){return this.zigzagToI32(this.readVarint32())},n.writeI64=function(t){return this.writeVarint64(this.i64ToZigzag(t))},n.readI64=function(){return this.zigzagToI64(this.readVarint64())},n.readBool=function(){var e;return this.$5!=null?(e=this.$5,this.$5=null):e=this.$1.readByte()===u.CT_BOOLEAN_TRUE,e},n.writeBool=function(t){var e=0;return this.$4!=null?(e+=this.$7(this.$4,t?c.CT_BOOLEAN_TRUE:c.CT_BOOLEAN_FALSE),this.$4=null):e+=this.$1.writeByte(t?u.CT_BOOLEAN_TRUE:u.CT_BOOLEAN_FALSE),e},n.readBinary=function(){var e=this.readVarint32();return e===0?new Uint8Array(0):this.$1.readBytes(e)},n.writeBinary=function(t){var e=0;return e+=this.writeVarint32(t.length),e+=this.$1.write(t),e},n.i32ToZigzag=function(t){if(t<h||t>g)throw new Error("number: "+t+" is out of range of i32");return(t<<1^(t<0?4294967295:0))>>>0},n.zigzagToI32=function(t){if(t<0||t>y)throw new Error("number: "+t+" is out of range of uint32");return t>>>1^-1*(t&1)},n.i64ToZigzag=function(t){if(r("jsbi").greaterThan(t,C)||r("jsbi").lessThan(t,b))throw new Error("i64 out of range: "+t.toString());return r("jsbi").bitwiseXor(r("jsbi").signedRightShift(t,S),r("jsbi").leftShift(t,R))},n.zigzagToI64=function(t){if(r("jsbi").lessThan(t,0)||r("jsbi").greaterThan(t,v))throw new Error("invalid uint64: "+t.toString());return r("jsbi").equal(r("jsbi").bitwiseAnd(t,R),R)?r("jsbi").bitwiseNot(r("jsbi").signedRightShift(t,R)):r("jsbi").signedRightShift(t,R)},n.writeVarint32=function(t){if(t<0||t>y)throw new Error("writeVarint32 received out of range uint32: "+t);for(var e=t,n=0;;)if(e>>>7)this.$1.writeByte(e&127|128),n++,e>>>=7;else{this.$1.writeByte(e),n++;break}return n},n.readVarint32=function(){for(var e=0,t=0,n;;){if(n=this.$1.readByte(),e=(e|(n&127)<<t)>>>0,t+=7,(n&128)==0){if(t===35&&(n&240)!=0)throw new Error("result exceeded 32 bit limit");break}if(t>28)throw new Error("result exceeded 32 bit limit")}return e},n.writeVarint64=function(t){if(r("jsbi").lessThan(t,L)||r("jsbi").greaterThan(t,v))throw new Error("invalid uint64: "+t.toString());for(var e=t,n=0;;)if(r("jsbi").equal(r("jsbi").signedRightShift(e,E),L)){this.$1.writeByte(r("jsbi").toNumber(e)),n++;break}else{var o,a=(o=r("jsbi")).toNumber(o.bitwiseOr(o.bitwiseAnd(e,I),T));this.$1.writeByte(a),n++,e=o.signedRightShift(e,E)}return n},n.readVarint64=function(){for(var e=L,t=L,n;;){var o;if(n=(o=r("jsbi")).BigInt(this.$1.readByte()),e=o.bitwiseOr(e,o.leftShift(o.bitwiseAnd(n,I),t)),t=o.add(t,E),r("jsbi").equal(r("jsbi").bitwiseAnd(n,T),L)){if(r("jsbi").equal(t,k)&&r("jsbi").notEqual(n,R))throw new Error("result exceeded 64 bit limit");break}if(r("jsbi").greaterThan(t,S))throw new Error("result exceeded 64 bit limit")}return e},n.readString=function(){return o("Utf8ToString").Utf8ToString(this.readBinary())},n.getLastFieldId=function(){return this.$3},n.getLastField=function(){return this.$2},n.getBooleanFieldInfo=function(){return this.$4},n.getBooleanValue=function(){return this.$5},n.$9=function(t){return d[t]},n.$10=function(n){switch(n){case u.CT_STOP:return(e||(e=r("ThriftTypes"))).STOP;case u.CT_BOOLEAN_FALSE:case u.CT_BOOLEAN_TRUE:return(e||(e=r("ThriftTypes"))).BOOL;case u.CT_BYTE:return(e||(e=r("ThriftTypes"))).BYTE;case u.CT_I16:return(e||(e=r("ThriftTypes"))).I16;case u.CT_I32:return(e||(e=r("ThriftTypes"))).I32;case u.CT_I64:return(e||(e=r("ThriftTypes"))).I64;case u.CT_DOUBLE:return(e||(e=r("ThriftTypes"))).DOUBLE;case u.CT_FLOAT:return(e||(e=r("ThriftTypes"))).FLOAT;case u.CT_BINARY:return(e||(e=r("ThriftTypes"))).STRING;case u.CT_LIST:return(e||(e=r("ThriftTypes"))).LIST;case u.CT_SET:return(e||(e=r("ThriftTypes"))).SET;case u.CT_MAP:return(e||(e=r("ThriftTypes"))).MAP;case u.CT_STRUCT:return(e||(e=r("ThriftTypes"))).STRUCT;default:throw new Error("don't know what type")}},t})();l.default=x}),98);
__d("CompactSerializerPolyfill",["TCompactProtocolPolyfill","TNoOpWriteBuffer","TReadBuffer","TWriteBuffer","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){var n=new(r("TReadBuffer"))(e),o=new(r("TCompactProtocolPolyfill"))(n);return t(o)}function s(t,n,o){try{return e(t,n)}catch(e){o!=null&&o(r("getErrorSafe")(e))}return null}function u(e,t,n){n===void 0&&(n=!1);var o;if(n){var a=new(r("TNoOpWriteBuffer")),i=new(r("TCompactProtocolPolyfill"))(a);t(e,i),o=new(r("TWriteBuffer"))(a.currentSize())}else o=new(r("TWriteBuffer"));var l=new(r("TCompactProtocolPolyfill"))(o);return t(e,l),l.toByteArray()}function c(e,t,n,o){n===void 0&&(n=!1);try{return u(e,t,n)}catch(e){o!=null&&o(r("getErrorSafe")(e))}return null}l.deserialize=e,l.deserializeNoThrow=s,l.serialize=u,l.serializeNoThrow=c}),98);
__d("ContextualConfigConstants",[],(function(t,n,r,o,a,i){"use strict";var e=1e3,l=", ",s={SAME:"same",NULL:"null",NNULL:"nnull",CATCH_ALL:"catch_all",EQ:"eq",NEQ:"neq",LT:"lt",LTE:"lte",GT:"gt",GTE:"gte",COR:"cor",CONTAINS:"contains",REGEX:"regex",IN:"in",NIN:"nin"},u={DENSE:"dense",MULTI_OUTPUT_RESOLVED:"multi-output-resolved",TABLE:"table"},c=[],d=[],m=[],p={BAD_BOOLEAN_FORMAT:"Bad boolean format",BAD_CONFIG:"Bad config",BAD_CONTEXT_IDENTIFIER:"Bad context identifier",BAD_CONTEXT_VALUE:"Bad context value",BAD_MONITORED_CONTEXTS:"Bad monitored contexts",BAD_NUMBER_FORMAT:"Bad number format",BAD_OUTPUT_NAME:"Bad output name",BAD_OUTPUT_TYPE:"Bad output type",BAD_VALUE_ORDER:"Bad values order",DUPLICATE_OUTPUT_NAME:"Duplicate output name",ILLEGAL_BOOLEAN_STRATEGY:"Illegal boolean strategy",ILLEGAL_BUCKET_VALUES:"Illegal bucket values",ILLEGAL_NUMERIC_STRATEGY:"Illegal numeric strategy",ILLEGAL_STRING_STRATEGY:"Illegal string strategy",INVALID_BOOLEAN:"Invalid boolean",INVALID_FLOAT:"Invalid float",INVALID_INTEGER:"Invalid integer",INVALID_STRING:"Invalid string",INVALID_VALUE_TYPE:"Invalid value type",MISMATCH_NUMBER_OF_VALUES:"Mismatching number of values",MISSING_BUCKETS:"Missing buckets",MISSING_BUCKET_MATCH:"Missing bucket match",MISSING_BUCKET_NAME:"Missing bucket name",MISSING_BUCKET_STRATEGY:"Missing bucket strategy",MISSING_CONTEXT_IN_CONFIG:"Missing context in config",MISSING_DEFAULT_VALUE:"Missing default value",MISSING_OUTPUTS_DEFINITION:"Missing outputs field definition",MISSING_RESULTS:"Missing results",MISSING_TABLE:"Missing table",MISSING_TABLE_ITEM_BUCKET:"Missing table item bucket",MISSING_TABLE_ITEM_VALUES:"Missing table item values",MISSING_VECTOR:"Missing vector",REGEX_SYNTAX_ERROR:"Regex syntax error",REQUESTED_PARAM_NOT_FOUND:"Requested param not found",RESULTS_VECTOR_SIZE_MISMATCH:"Results vector size mismatch",UNDECLARED_OUTPUT_PARAM:"Undeclared output param",UNKNOWN_BUCKET_DEFINITION:"Unknown bucket definition",UNKNOWN_CONFIG_TYPE:"Unknown config type",UNSUPPORTED_CONFIG_VERSION:"Unsupported config version"},_=10,f=", ",g={BOOL:"BOOL",FLOAT:"FLOAT",INT:"INT",STRING:"STRING"};i.ANALYTICS_SAMPLE_RATE=e,i.BUCKET_DELIMITER=l,i.CONTEXT_BUCKET_STRATEGY=s,i.CONFIG_TYPE=u,i.EMPTY_RESOLVED_CONTEXTS=c,i.EMPTY_RESOLVED_MONITORS=d,i.EMPTY_RESULT_PARAMS=m,i.ERROR=p,i.JSON_SUB_SAMPLE_RATE=_,i.LIST_DELIMITER=f,i.TYPE=g}),66);
__d("ContextualConfigResolvedContextsUtils",[],(function(t,n,r,o,a,i){"use strict";var e=function(t){var e=[];for(var n of t){var r=n.bucketIndex;if(r==null)break;e.push(r)}return e},l=function(t){var e=[];for(var n of t){var r=n.bucketName;if(r===void 0)break;e.push(r)}return e},s=function(t){return t.name},u=function(t){return t.map(s)},c=function(t){var e=[];for(var n of t){var r=n.value;if(r===void 0)break;e.push(r)}return e};i.getBucketIndices=e,i.getBucketNames=l,i.getContextNames=u,i.getContextValues=c}),66);
__d("ContextualConfigCollateExposureData",["ContextualConfigConstants","ContextualConfigResolvedContextsUtils"],(function(t,n,r,o,a,i,l){"use strict";var e=["cfg_ver_timestamp","policy_id","version","sample_rate"],s=function(t){return t.join(o("ContextualConfigConstants").LIST_DELIMITER)},u=function(n,r){for(var t of e)r[t]!=null&&(n[t]=r[t]);r.name&&(n.config_name=r.name)},c=function(t,n){var e=n[0],r=n[1],a=n[2],i=n[3];e!=null&&(t.exception=e.message),t.result=s(r.map(function(e){return e.value}))||"INVALID",t.context=s(o("ContextualConfigResolvedContextsUtils").getContextNames(a)),t.context_value=s(o("ContextualConfigResolvedContextsUtils").getContextValues(a)),t.bucket_name=s(o("ContextualConfigResolvedContextsUtils").getBucketNames(a)),t.monitor=s(o("ContextualConfigResolvedContextsUtils").getContextNames(i)),t.monitor_value=s(o("ContextualConfigResolvedContextsUtils").getContextValues(i))};function d(e,t,n){var r={sample_rate:o("ContextualConfigConstants").ANALYTICS_SAMPLE_RATE};return u(r,e),c(r,t),n&&(r.config_contents=JSON.stringify(e)),r}l.default=d}),98);
__d("ContextualConfigExposureEvent",["Random"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e,t,n){this.$2=e,this.$4=o("Random").random()<1/e.sample_rate,this.$3=t,this.$1=n}var t=e.prototype;return t.getData=function(){return this.$2},t.log=function(t){var e=this.$2,n=this.$3,r=this.$4;return t&&n(e),r&&this.$1(e),this},t.isSampled=function(){return this.$4},e})();l.default=e}),98);
__d("ContextualConfigExposureLoggerFactory",["ContextualConfigExposureEvent"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e,t){this.$2=e,this.$1=t}var t=e.prototype;return t.createEvent=function(t){var e=new(r("ContextualConfigExposureEvent"))(t,this.$2,this.$1);return e},e})();function s(t,n){return new e(t,n)}l.default=s}),98);
__d("ContextualConfigExposureLogger",["ContextualConfigExposureLoggerFactory","MarauderLogger"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t){},s=function(t){o("MarauderLogger").log("contextual_config_exposure","",t)},u=r("ContextualConfigExposureLoggerFactory")(e,s);l.default=u}),98);
__d("ContextualConfigAssert",[],(function(t,n,r,o,a,i){"use strict";function e(e,t){if(e===!1)throw new Error(t)}i.default=e}),66);
__d("ContextualConfigValidators",["ContextualConfigConstants"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t){return Array.isArray(t)},s=function(t){return typeof t=="boolean"},u=function(t){return t!=null},c=function(t){return(function(e){return Object.prototype.hasOwnProperty.call(t,e)})},d=function(t){return p(t)&&t%1===0},m=function(t){return _(t)&&t.length>0},p=function(t){return typeof t=="number"&&!isNaN(t)&&t!==1/0&&t!==-1/0},_=function(t){return typeof t=="string"},f=function(t){switch(t){case o("ContextualConfigConstants").TYPE.BOOL:case o("ContextualConfigConstants").TYPE.FLOAT:case o("ContextualConfigConstants").TYPE.INT:case o("ContextualConfigConstants").TYPE.STRING:return!0;default:return!1}};l.isArray=e,l.isBoolean=s,l.isDefined=u,l.isKey=c,l.isInteger=d,l.isNonEmptyString=m,l.isNumber=p,l.isString=_,l.isType=f}),98);
__d("ContextualConfigParseBoolean",["ContextualConfigConstants"],(function(t,n,r,o,a,i,l){"use strict";function e(e){switch(e.toUpperCase()){case"TRUE":return!0;case"FALSE":return!1;default:throw new Error(o("ContextualConfigConstants").ERROR.BAD_BOOLEAN_FORMAT)}}l.default=e}),98);
__d("ContextualConfigParsePredBoolean",["ContextualConfigConstants","ContextualConfigParseBoolean"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){var n;switch(t){case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.SAME:var a=r("ContextualConfigParseBoolean")(e);n=function(t){return t===a};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NULL:n=function(t){return t==null};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NNULL:n=function(t){return t!=null};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.CATCH_ALL:n=function(t){return!0};break;default:throw new Error(o("ContextualConfigConstants").ERROR.ILLEGAL_BOOLEAN_STRATEGY)}return function(e){return n(e)}}l.default=e}),98);
__d("ContextualConfigParseFloat",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e,s=/^[-\+]?([1-9]\d*|0)(\.\d+)?$/,u=function(t){return s.test(t)};function c(t){(e||(e=r("ContextualConfigAssert")))(u(t),o("ContextualConfigConstants").ERROR.BAD_NUMBER_FORMAT);var n=parseFloat(t);return e(o("ContextualConfigValidators").isNumber(n),o("ContextualConfigConstants").ERROR.BAD_NUMBER_FORMAT),n}l.default=c}),98);
__d("ContextualConfigParseInteger",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e,s=/^[-\+]?([1-9]\d*|0)$/,u=function(t){return s.test(t)};function c(t){(e||(e=r("ContextualConfigAssert")))(u(t),o("ContextualConfigConstants").ERROR.BAD_NUMBER_FORMAT);var n=parseInt(t,10);return e(o("ContextualConfigValidators").isNumber(n),o("ContextualConfigConstants").ERROR.BAD_NUMBER_FORMAT),n}l.default=c}),98);
__d("ContextualConfigPredAssertions",["ContextualConfigAssert","ContextualConfigConstants"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(n){return(e||(e=r("ContextualConfigAssert")))(n>0,o("ContextualConfigConstants").ERROR.MISMATCH_NUMBER_OF_VALUES)},u=function(n,a){return(e||(e=r("ContextualConfigAssert")))(n===a,o("ContextualConfigConstants").ERROR.MISMATCH_NUMBER_OF_VALUES)},c=function(n,a){return(e||(e=r("ContextualConfigAssert")))(n<a,o("ContextualConfigConstants").ERROR.BAD_VALUE_ORDER)};l.assertHasValues=s,l.assertNumberOfValues=u,l.assertValueOrder=c}),98);
__d("ContextualConfigParsePredNumeric",["ContextualConfigConstants","ContextualConfigParseFloat","ContextualConfigParseInteger","ContextualConfigPredAssertions","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,n,a,i){var l=a.map(i?r("ContextualConfigParseInteger"):e||(e=r("ContextualConfigParseFloat"))),s;switch(n){case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.SAME:var u=i?r("ContextualConfigParseInteger")(t):(e||(e=r("ContextualConfigParseFloat")))(t);s=function(t){return i&&!o("ContextualConfigValidators").isInteger(t)?!1:t===u};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NULL:s=function(t){return t==null};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NNULL:s=function(t){return t!=null};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.CATCH_ALL:s=function(t){return!0};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.COR:o("ContextualConfigPredAssertions").assertNumberOfValues(l.length,2),o("ContextualConfigPredAssertions").assertValueOrder(l[0],l[1]),s=function(t){return typeof t!="number"||i&&!o("ContextualConfigValidators").isInteger(t)?!1:t>=l[0]&&t<l[1]};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.LT:o("ContextualConfigPredAssertions").assertNumberOfValues(l.length,1),s=function(t){return typeof t!="number"||i&&!o("ContextualConfigValidators").isInteger(t)?!1:t<l[0]};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.LTE:o("ContextualConfigPredAssertions").assertNumberOfValues(l.length,1),s=function(t){return typeof t!="number"||i&&!o("ContextualConfigValidators").isInteger(t)?!1:t<=l[0]};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.EQ:o("ContextualConfigPredAssertions").assertNumberOfValues(l.length,1),s=function(t){return typeof t!="number"||i&&!o("ContextualConfigValidators").isInteger(t)?!1:t===l[0]};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NEQ:o("ContextualConfigPredAssertions").assertNumberOfValues(l.length,1),s=function(t){return typeof t!="number"||i&&!o("ContextualConfigValidators").isInteger(t)?!1:t!==l[0]};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.GT:o("ContextualConfigPredAssertions").assertNumberOfValues(l.length,1),s=function(t){return typeof t!="number"||i&&!o("ContextualConfigValidators").isInteger(t)?!1:t>l[0]};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.GTE:o("ContextualConfigPredAssertions").assertNumberOfValues(l.length,1),s=function(t){return typeof t!="number"||i&&!o("ContextualConfigValidators").isInteger(t)?!1:t>=l[0]};break;default:throw new Error(o("ContextualConfigConstants").ERROR.ILLEGAL_NUMERIC_STRATEGY)}return function(e){return s(e)}}l.default=s}),98);
__d("ContextualConfigParseRegExp",["ContextualConfigConstants"],(function(t,n,r,o,a,i,l){"use strict";var e=/^\/(.+)\/(.*)$/;function s(t){try{var n=t.match(e);return n!=null?new RegExp(n[1],n[2]):new RegExp(t)}catch(e){throw new Error(o("ContextualConfigConstants").ERROR.REGEX_SYNTAX_ERROR)}}l.default=s}),98);
__d("ContextualConfigParsePredString",["ContextualConfigConstants","ContextualConfigParseRegExp","ContextualConfigPredAssertions"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t){if(typeof t!="string")throw new Error(o("ContextualConfigConstants").ERROR.INVALID_VALUE_TYPE);return t},s=function(n){var t=[];for(var r of n)t.push(e(r));return t};function u(e,t,n){var a=s(n),i;switch(t){case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.SAME:i=function(n){return typeof n!="string"?!1:n===e};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NULL:i=function(t){return t==null};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NNULL:i=function(t){return t!=null};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.CATCH_ALL:i=function(t){return!0};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.IN:o("ContextualConfigPredAssertions").assertHasValues(a.length),i=function(t){return typeof t!="string"?!1:a.indexOf(t)!==-1};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NIN:o("ContextualConfigPredAssertions").assertHasValues(a.length),i=function(t){return typeof t!="string"?!1:a.indexOf(t)===-1};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.CONTAINS:o("ContextualConfigPredAssertions").assertNumberOfValues(a.length,1),i=function(t){return typeof t!="string"?!1:t.indexOf(a[0])!==-1};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.REGEX:o("ContextualConfigPredAssertions").assertNumberOfValues(a.length,1);var l=r("ContextualConfigParseRegExp")(a[0]);i=function(t){return typeof t!="string"?!1:l.test(t)};break;default:throw new Error(o("ContextualConfigConstants").ERROR.ILLEGAL_STRING_STRATEGY)}return function(e){return i(e)}}l.default=u}),98);
__d("ContextualConfigParseContextBuckets",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParsePredBoolean","ContextualConfigParsePredNumeric","ContextualConfigParsePredString","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isDefined(n),o("ContextualConfigConstants").ERROR.MISSING_BUCKETS)},u=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isArray(n),o("ContextualConfigConstants").ERROR.MISSING_BUCKETS)},c=o("ContextualConfigValidators").isKey(o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY),d=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isString(n)&&c(n.toUpperCase()),o("ContextualConfigConstants").ERROR.MISSING_BUCKET_STRATEGY)},m=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isArray(n),o("ContextualConfigConstants").ERROR.ILLEGAL_BUCKET_VALUES)},p=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isNonEmptyString(n),o("ContextualConfigConstants").ERROR.MISSING_BUCKET_NAME)},_=function(t,n){var e=n.name;p(e);var a=n.strategy;d(a);var i=n.values||[];switch(m(i),t){case o("ContextualConfigConstants").TYPE.BOOL:return r("ContextualConfigParsePredBoolean")(e,a);case o("ContextualConfigConstants").TYPE.FLOAT:return r("ContextualConfigParsePredNumeric")(e,a,i,!1);case o("ContextualConfigConstants").TYPE.INT:return r("ContextualConfigParsePredNumeric")(e,a,i,!0);case o("ContextualConfigConstants").TYPE.STRING:return r("ContextualConfigParsePredString")(e,a,i);default:throw new Error(o("ContextualConfigConstants").ERROR.UNKNOWN_BUCKET_DEFINITION)}},f=function(t,n){s(n);var e=n.name;return p(e),{name:e,pred:_(t,n)}};function g(e,t){return u(t),t.map(function(t){return f(e,t)})}l.default=g}),98);
__d("ContextualConfigParseContexts",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseContextBuckets","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isDefined(n),o("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},u=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isArray(n)&&n.length>0,o("ContextualConfigConstants").ERROR.MISSING_CONTEXT_IN_CONFIG)},c=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isNonEmptyString(n),o("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},d=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isType(n),o("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},m=function(t){s(t);var e=t.buckets,n=t.name,o=t.type;return c(n),d(o),{name:n,type:o,buckets:r("ContextualConfigParseContextBuckets")(o,e)}};function p(e){return u(e),e.map(m)}l.default=p}),98);
__d("ContextualConfigIsEqualParams",[],(function(t,n,r,o,a,i){"use strict";function e(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n+=1){var r=e[n],o=t[n];if(r.name!==o.name||r.type!==o.type)return!1}return!0}i.default=e}),66);
__d("ContextualConfigParseResultParamValue",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseBoolean","ContextualConfigParseFloat","ContextualConfigParseInteger","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isString(n),o("ContextualConfigConstants").ERROR.INVALID_STRING)};function c(e,t){switch(u(t),e){case o("ContextualConfigConstants").TYPE.BOOL:return r("ContextualConfigParseBoolean")(t);case o("ContextualConfigConstants").TYPE.FLOAT:return(s||(s=r("ContextualConfigParseFloat")))(t);case o("ContextualConfigConstants").TYPE.INT:return r("ContextualConfigParseInteger")(t);case o("ContextualConfigConstants").TYPE.STRING:return t;default:throw new Error(o("ContextualConfigConstants").ERROR.INVALID_VALUE_TYPE)}}l.default=c}),98);
__d("ContextualConfigParseResultParams",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseResultParamValue","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isArray(n),o("ContextualConfigConstants").ERROR.MISSING_RESULTS)},c=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isDefined(n),o("ContextualConfigConstants").ERROR.BAD_CONTEXT_VALUE)},d=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isNonEmptyString(n),o("ContextualConfigConstants").ERROR.BAD_CONTEXT_VALUE)},m=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isType(n),o("ContextualConfigConstants").ERROR.BAD_CONTEXT_VALUE)},p=function(t,n){for(var e of t)if(e.name===n)return e.type;throw new Error(o("ContextualConfigConstants").ERROR.UNDECLARED_OUTPUT_PARAM)},_=function(t){return(function(e){c(e);var n=e.name;d(n);var o=p(t,n);m(o);var a=(s||(s=r("ContextualConfigParseResultParamValue")))(o,e.value);return{name:n,type:o,value:a}})};function f(e,t){return u(t),t.map(_(e))}l.default=f}),98);
__d("ContextualConfigParseDenseResultParams",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigIsEqualParams","ContextualConfigParseResultParams"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(n,a){return(e||(e=r("ContextualConfigAssert")))(r("ContextualConfigIsEqualParams")(n,a),o("ContextualConfigConstants").ERROR.RESULTS_VECTOR_SIZE_MISMATCH)};function u(e,t){var n=r("ContextualConfigParseResultParams")(e,t.map(function(t,n){return{name:e[n].name,value:t}}));return s(e,n),n}l.default=u}),98);
__d("ContextualConfigParseDenseDefaults",["ContextualConfigConstants","ContextualConfigParseDenseResultParams"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){try{return r("ContextualConfigParseDenseResultParams")(e,t)}catch(e){throw new Error(o("ContextualConfigConstants").ERROR.MISSING_DEFAULT_VALUE)}}l.default=e}),98);
__d("ContextualConfigParseMonitors",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isDefined(n),o("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},u=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isArray(n),o("ContextualConfigConstants").ERROR.BAD_MONITORED_CONTEXTS)},c=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isNonEmptyString(n),o("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},d=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isType(n),o("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},m=function(t){s(t);var e=t.name,n=t.type;return c(e),d(n),{name:e,type:n}};function p(e){return u(e),e.map(m)}l.default=p}),98);
__d("ContextualConfigParseOutputParams",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){var e,s=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isArray(n),o("ContextualConfigConstants").ERROR.MISSING_OUTPUTS_DEFINITION)},u=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isType(n),o("ContextualConfigConstants").ERROR.BAD_OUTPUT_TYPE)},c=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isNonEmptyString(n),o("ContextualConfigConstants").ERROR.BAD_OUTPUT_NAME)},d=function(n){return(e||(e=r("ContextualConfigAssert")))(m(n),o("ContextualConfigConstants").ERROR.DUPLICATE_OUTPUT_NAME)},m=function(t){var e={};for(var n of t){if(e[n.name])return!1;e[n.name]=!0}return!0},p=function(t){return c(t.name),u(t.type),t};function _(e){s(e);var t=e.map(p);return d(t),t}l.default=_}),98);
__d("ContextualConfigParseVector",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseResultParamValue","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isArray(n),o("ContextualConfigConstants").ERROR.MISSING_VECTOR)},c=function(n,a){return(e||(e=r("ContextualConfigAssert")))(n===a,o("ContextualConfigConstants").ERROR.RESULTS_VECTOR_SIZE_MISMATCH)},d=function(t,n){c(t.length,n.length);for(var e=0;e<t.length;e+=1){var o=t[e].type,a=n[e];(s||(s=r("ContextualConfigParseResultParamValue")))(o,a)}},m=function(t){return t.reduce(function(e,t){var n=t.buckets;return e*n.length},1)};function p(e,t,n){u(n);var r=m(t),o=e.length;c(r*o,n.length);for(var a=0;a<r;a+=1){var i=a*o;d(e,n.slice(i,i+o))}return n}l.default=p}),98);
__d("ContextualConfigResolveContexts",["ContextualConfigConstants"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t,n){for(var e=0;e<t.length;e+=1){var r=t[e];try{if(r.pred(n))return[r.name,e]}catch(e){return null}}return null};function s(t,n,r){var a=null,i=t.map(function(t){var i=t.name,l={name:i};if(a!=null)return l;var s;if(r[i]!=null?s=r[i]:n[i]!=null?s=n[i]():s=null,l.value=s,t.buckets!=null){var u=e(t.buckets,s);if(u==null)return a=new Error(o("ContextualConfigConstants").ERROR.MISSING_BUCKET_MATCH),l;var c=u[0],d=u[1];l.bucketName=c,l.bucketIndex=d}return l});return[a,i]}l.default=s}),98);
__d("DenseContextualConfig",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseContexts","ContextualConfigParseDenseDefaults","ContextualConfigParseDenseResultParams","ContextualConfigParseMonitors","ContextualConfigParseOutputParams","ContextualConfigParseVector","ContextualConfigResolveContexts","ContextualConfigResolvedContextsUtils","ContextualConfigValidators","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isDefined(n),o("ContextualConfigConstants").ERROR.BAD_CONFIG)},u=function(t){for(var e=[],n=1,r=t.length-1;r>=0;r-=1)e.push(n),n*=t[r].buckets.length;return e.reverse()},c=function(t,n,o,a){try{var e=n.slice(o,o+t.length);return[null,r("ContextualConfigParseDenseResultParams")(t,e)]}catch(e){return[r("getErrorSafe")(e),a]}},d=function(n,o,a){try{var t=a.reduce(function(t,o,a){return(e||(e=r("ContextualConfigAssert")))(a<n.length,"Auxillery index out of range."),t+n[a]*o},0);return[null,t*o]}catch(e){return[r("getErrorSafe")(e),-1]}},m=(function(){function e(e,t){s(e),this.globalContextProviders=babelHelpers.extends({},t);var n=r("ContextualConfigParseOutputParams")(e.outputs),o=r("ContextualConfigParseContexts")(e.contexts);this.aux=u(o),this.contexts=o,this.defaults=r("ContextualConfigParseDenseDefaults")(n,e.vectorDefaults),this.monitors=e.monitors!=null?r("ContextualConfigParseMonitors")(e.monitors):[],this.outputs=n,this.vector=r("ContextualConfigParseVector")(n,o,e.vector)}var t=e.prototype;return t.resolve=function(t){try{return this.unsafeResolve(t)}catch(e){return[r("getErrorSafe")(e),this.defaults,o("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,o("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]}},t.unsafeResolve=function(t){var e=this.aux,n=this.contexts,a=this.defaults,i=this.globalContextProviders,l=this.monitors,s=this.outputs,u=this.vector,m=r("ContextualConfigResolveContexts")(n,i,t),p=m[0],_=m[1];if(p!=null)return[p,a,_,o("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS];var f=d(e,s.length,o("ContextualConfigResolvedContextsUtils").getBucketIndices(_)),g=f[0],h=f[1];if(g!=null)return[g,a,_,o("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS];var y=c(s,u,h,a),C=y[0],b=y[1];if(C!=null)return[C,b,_,o("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS];var v=r("ContextualConfigResolveContexts")(l,i,t),S=v[0],R=v[1];return S!=null?[S,b,_,o("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]:[null,b,_,R]},e})();l.default=m}),98);
__d("MultiOutputResolvedContextualConfig",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseMonitors","ContextualConfigParseOutputParams","ContextualConfigParseResultParams","ContextualConfigResolveContexts","ContextualConfigValidators","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isDefined(n),o("ContextualConfigConstants").ERROR.BAD_CONFIG)},u=(function(){function e(e,t){s(e),this.globalContextProviders=babelHelpers.extends({},t);var n=r("ContextualConfigParseOutputParams")(e.outputs);this.monitors=e.monitors!=null?r("ContextualConfigParseMonitors")(e.monitors):[],this.values=r("ContextualConfigParseResultParams")(n,e.values)}var t=e.prototype;return t.resolve=function(t){try{return this.unsafeResolve(t)}catch(e){return[r("getErrorSafe")(e),this.values,o("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,o("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]}},t.unsafeResolve=function(t){var e=this.globalContextProviders,n=this.monitors,a=this.values,i=r("ContextualConfigResolveContexts")(n,e,t),l=i[0],s=i[1];return l!=null?[l,a,o("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,o("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]:[null,a,o("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,s]},e})();l.default=u}),98);
__d("ContextualConfigMergePartialResultParams",[],(function(t,n,r,o,a,i){"use strict";function e(e,t){var n={};for(var r of t)n[r.name]=r;var o=[];for(var a of e){var i=n[a.name];o.push(i!=null&&i.name===a.name&&i.type===a.type?i:a)}return o}i.default=e}),66);
__d("ContextualConfigParseDefaults",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigIsEqualParams","ContextualConfigParseResultParams"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(n,a){return(e||(e=r("ContextualConfigAssert")))(r("ContextualConfigIsEqualParams")(n,a),o("ContextualConfigConstants").ERROR.MISSING_DEFAULT_VALUE)};function u(e,t){var n=r("ContextualConfigParseResultParams")(e,t);return s(e,n),n}l.default=u}),98);
__d("ContextualConfigParseTable",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseResultParams","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isArray(n),o("ContextualConfigConstants").ERROR.MISSING_TABLE)},u=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isDefined(n),o("ContextualConfigConstants").ERROR.MISSING_TABLE)},c=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isNonEmptyString(n),o("ContextualConfigConstants").ERROR.MISSING_TABLE_ITEM_BUCKET)},d=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isArray(n),o("ContextualConfigConstants").ERROR.MISSING_TABLE_ITEM_VALUES)},m=function(t,n){u(n);var e=n.bucket,o=n.values;return c(e),d(o),{bucket:e,values:r("ContextualConfigParseResultParams")(t,o)}};function p(e,t){return s(t),t.reduce(function(t,n){var r=m(e,n);return t[r.bucket]=r.values,t},{})}l.default=p}),98);
__d("TableContextualConfig",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigMergePartialResultParams","ContextualConfigParseContexts","ContextualConfigParseDefaults","ContextualConfigParseMonitors","ContextualConfigParseOutputParams","ContextualConfigParseTable","ContextualConfigResolveContexts","ContextualConfigResolvedContextsUtils","ContextualConfigValidators","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e,s=[],u=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isDefined(n),o("ContextualConfigConstants").ERROR.BAD_CONFIG)},c=(function(){function e(e,t){u(e),this.globalContextProviders=babelHelpers.extends({},t);var n=r("ContextualConfigParseOutputParams")(e.outputs);this.contexts=r("ContextualConfigParseContexts")(e.contexts),this.defaults=r("ContextualConfigParseDefaults")(n,e.defaults),this.monitors=e.monitors!=null?r("ContextualConfigParseMonitors")(e.monitors):[],this.table=r("ContextualConfigParseTable")(n,e.table)}var t=e.prototype;return t.resolve=function(t){try{return this.unsafeResolve(t)}catch(e){return[r("getErrorSafe")(e),this.defaults,o("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,o("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]}},t.unsafeResolve=function(t){var e=this.contexts,n=this.defaults,a=this.globalContextProviders,i=this.monitors,l=this.table,u=r("ContextualConfigResolveContexts")(e,a,t),c=u[0],d=u[1];if(c!=null)return[c,n,d,[]];var m=o("ContextualConfigResolvedContextsUtils").getBucketNames(d).join(o("ContextualConfigConstants").BUCKET_DELIMITER),p=l[m]||s,_=r("ContextualConfigMergePartialResultParams")(n,p),f=r("ContextualConfigResolveContexts")(i,a,t),g=f[0],h=f[1];return g!=null?[g,_,d,[]]:[null,_,d,h]},e})();l.default=c}),98);
__d("ContextualConfigParseConfig",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators","DenseContextualConfig","MultiOutputResolvedContextualConfig","TableContextualConfig"],(function(t,n,r,o,a,i,l){"use strict";var e,s=[1],u=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isDefined(n)&&o("ContextualConfigValidators").isDefined(n.version),o("ContextualConfigConstants").ERROR.BAD_CONFIG)},c=function(n){return(e||(e=r("ContextualConfigAssert")))(s.indexOf(n)!==-1,o("ContextualConfigConstants").ERROR.UNSUPPORTED_CONFIG_VERSION)};function d(e,t){switch(u(e),c(e.version),e.cctype){case o("ContextualConfigConstants").CONFIG_TYPE.DENSE:return new(r("DenseContextualConfig"))(e,t);case o("ContextualConfigConstants").CONFIG_TYPE.MULTI_OUTPUT_RESOLVED:return new(r("MultiOutputResolvedContextualConfig"))(e,t);case o("ContextualConfigConstants").CONFIG_TYPE.TABLE:return new(r("TableContextualConfig"))(e,t);default:throw new Error(o("ContextualConfigConstants").ERROR.UNKNOWN_CONFIG_TYPE)}}l.default=d}),98);
__d("ContextualConfigWarn",[],(function(t,n,r,o,a,i){"use strict";function e(e){}i.default=e}),66);
__d("ContextualConfigResult",["ContextualConfigConstants","ContextualConfigWarn","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.$1=e.reduce(function(e,t){var n=t.name,r=t.value;return e[n]=r,e},{}),this.$2=e}var t=e.prototype;return t.get=function(t,n){try{var e=this.$1[t];return typeof e!=typeof n?(r("ContextualConfigWarn")(o("ContextualConfigConstants").ERROR.REQUESTED_PARAM_NOT_FOUND),n):e}catch(e){return r("ContextualConfigWarn")(r("getErrorSafe")(e).message),n}},t.getParams=function(){return this.$2},e})();l.default=e}),98);
__d("ErrorContextualConfig",["ContextualConfigConstants"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.error=e}var t=e.prototype;return t.resolve=function(t){return[this.error,o("ContextualConfigConstants").EMPTY_RESULT_PARAMS,o("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,o("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]},e})();l.default=e}),98);
__d("ContextualConfig",["ContextualConfigCollateExposureData","ContextualConfigConstants","ContextualConfigExposureLogger","ContextualConfigParseConfig","ContextualConfigResult","ErrorContextualConfig","Random","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e=1/o("ContextualConfigConstants").JSON_SUB_SAMPLE_RATE,s=1,u=(function(){function t(e,t){t===void 0&&(t={}),this.isDebugLoggingEnabled=!1,this.$3=!1,this.$4=e,this.$2=t}var n=t.prototype;return n.$5=function(){if(this.$1)return this.$1;var e=this.$2,t=this.$4,n;try{n=r("ContextualConfigParseConfig")(t,e)}catch(e){n=new(r("ErrorContextualConfig"))(r("getErrorSafe")(e))}return this.$1=n,n},n.$6=function(n){var t=this.isDebugLoggingEnabled,a=this.$3,i=!a&&o("Random").random()<e;i&&(this.$3=!0);var l=r("ContextualConfigCollateExposureData")(this.$4,n,i),s=r("ContextualConfigExposureLogger").createEvent(l);s.log(t)},n.resolve=function(t){t===void 0&&(t={});var e=this.$1||this.$5(),n=e.resolve(t);return this.$6(n),new(r("ContextualConfigResult"))(n[s])},t})();l.default=u}),98);
__d("DGWRequestStreamUtils",["Base64"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n,o,a){var i={};for(var l of Object.entries(e)){var s=l[0],u=l[1];typeof u=="string"?i["XRSS-"+s]=u:typeof u=="number"?i["XRSN-"+s]=u.toString():typeof u=="boolean"?i["XRSB-"+s]=u.toString():typeof u=="object"&&u!=null&&(i["XRSO-"+s]=r("Base64").encode(JSON.stringify(u)))}return t&&(i["xrs-body"]="true"),n!=null&&n.length>0&&(i["xrs-instrumentation"]=r("Base64").encode(n)),i["XRS-Accept-Ack"]="RSAck",o!=null&&o.ackTimeoutSec!=null&&(i["XRS-SRAck-Timeout"]=o.ackTimeoutSec.toString()),i["XRSS-http_referer"]=window.location.href,a!=null&&(i["XRSB-is_test"]="true",i["XRSS-original_request_id"]=a),i}function s(e){return Object.keys(e).reduce(function(t,n){return(typeof e[n]=="string"||typeof e[n]=="boolean"||typeof e[n]=="number"||typeof e[n]=="object")&&(t[n]=e[n]),t},{})}function u(e){if(e.response&&e.response.instrumentation_data!=null&&e.response.instrumentation_data.length>0)try{var t,n=JSON.parse(new TextDecoder("utf-8").decode(e.response.instrumentation_data));return{auxId:n.auxId,dfTraceId:(t=n.dataFlowTracingData)==null?void 0:t.traceId}}catch(e){}return null}function c(e,t){var n=e.headers,r=e.body;if(t.kill_body===!0&&(r=null),t.new_body!=null&&(r=t.new_body),t.new_headers!=null)try{n=s(JSON.parse(t.new_headers))}catch(e){}if(t.patch_headers!=null)try{n=babelHelpers.extends({},n,s(JSON.parse(t.patch_headers)))}catch(e){}return{headers:n,body:r}}l.convertHeaders=e,l.cleanHeaders=s,l.getInstrumentationDataFieldsFromPayload=u,l.transformContextWithRewriteDelta=c}),98);
__d("DGWStreamHandler",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(e,t,n,r,o){this.$2=e,this.$3=t,this.$4=n,this.$5=r,this.$6=o,this.$1=!0}var t=e.prototype;return t.onClose=function(t){this.$1&&this.$2(t)},t.onDataReceived=function(t){this.$1&&this.$3(t)},t.onError=function(t){this.$1&&this.$4(t)},t.onStreamMustDrain=function(t,n){this.$1&&this.$5(t,n)},t.onServerHasFinishedSendingData=function(t){this.$1&&this.$6(t)},t.stop=function(){this.$1=!1},t.isStopped=function(){return!this.$1},e})();i.default=e}),66);
__d("InflightAmends",["Deferred","err"],(function(t,n,r,o,a,i,l){"use strict";var e="inflight_amends_timeout",s="inflight_amends_duplicate_id",u=(function(){function t(e,t,n){this.$1=e,this.$3=t,this.$4=n,this.$2=new Map}var n=t.prototype;return n.add=function(n){var t=this;if(this.$2.has(n))throw r("err")(s);var o=new(r("Deferred")),a=Date.now(),i=setTimeout(function(){t.$2.has(n)&&t.reject(n,r("err")(e))},this.$1);return this.$2.set(n,{id:n,deferred:o,createdTimestampMs:a,timeoutId:i}),o.getPromise()},n.getPromise=function(t){var e;return(e=this.$5(t))==null?void 0:e.deferred.getPromise()},n.resolve=function(t,n){var e=this.$5(t);e&&(e.deferred.resolve==null||e.deferred.resolve(n),this.$3(e.id,Date.now()-e.createdTimestampMs),this.$6(e))},n.reject=function(t,n){var e=this.$5(t);e&&(e.deferred.reject==null||e.deferred.reject(n),this.$4(e.id,n),this.$6(e))},n.rejectAll=function(t){for(var e of this.$2.entries()){var n=e[0],r=e[1];this.reject(n,t)}},n.getSize=function(){return this.$2.size},n.getAllPromises=function(){var e=[];for(var t of this.$2.values())e.push(t.deferred.getPromise());return e},n.$6=function(t){clearTimeout(t.timeoutId),this.$2.delete(t.id)},n.$5=function(t){return this.$2.get(t)},t})();l.default=u}),98);
__d("RequestStreamCloseReason",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["UserIntention","StartStreamFailure","StreamError","RemoteTermination","ServerDataEnd","ServerDrain","ReestablishError","ClientError"]);i.RequestStreamCloseReason=e}),66);
__d("RequestStreamCommonRequestStreamCommonSerializers",["RequestStreamCommonRequestStreamCommonTypes","ThriftTypes","jsbi"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){return{}}function u(){return{expected_existing_headers:"",patch_headers_if_match:""}}function c(){return{bytes:Uint8Array.of()}}function d(){return{message:""}}function m(){return{reason:o("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(0)}}function p(){return{}}function _(){return{stream_id:"0",last_sequencer:0,amendment_count:0,last_status:o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(0)}}function f(){return{caller_timestamp_ms:"0"}}function g(){return{original_ping_timestamp_ms:"0"}}function h(){return{}}function y(t,n){n.writeStructBegin("ResponseRewriteRequest"),t.new_headers!=null&&(n.writeFieldBegin({fname:"new_headers",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),n.writeString(t.new_headers),n.writeFieldEnd()),t.new_body!=null&&(n.writeFieldBegin({fname:"new_body",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeBinary(t.new_body),n.writeFieldEnd()),t.patch_headers!=null&&(n.writeFieldBegin({fname:"patch_headers",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:3}),n.writeString(t.patch_headers),n.writeFieldEnd()),t.kill_body!=null&&(n.writeFieldBegin({fname:"kill_body",ftype:(e||(e=r("ThriftTypes"))).BOOL,fid:4}),n.writeBool(t.kill_body),n.writeFieldEnd()),t.temporary!=null&&(n.writeFieldBegin({fname:"temporary",ftype:(e||(e=r("ThriftTypes"))).BOOL,fid:5}),n.writeBool(t.temporary),n.writeFieldEnd()),t.conditional_patch_headers!=null&&(n.writeFieldBegin({fname:"conditional_patch_headers",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:6}),C(t.conditional_patch_headers,n),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function C(t,n){if(n.writeStructBegin("ResponseRewriteConditionalPatchHeaders"),n.writeFieldBegin({fname:"expected_existing_headers",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.expected_existing_headers!=null)n.writeString(t.expected_existing_headers);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"patch_headers_if_match",ftype:e.STRING,fid:2}),t.patch_headers_if_match!=null)n.writeString(t.patch_headers_if_match);else{var a="";n.writeString(a)}n.writeFieldEnd(),t.patch_headers_otherwise!=null&&(n.writeFieldBegin({fname:"patch_headers_otherwise",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:3}),n.writeString(t.patch_headers_otherwise),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function b(t,n){if(n.writeStructBegin("ResponseData"),n.writeFieldBegin({fname:"bytes",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.bytes!=null)n.writeBinary(t.bytes);else{var o=Uint8Array.of();n.writeBinary(o)}n.writeFieldEnd(),t.metadata!=null&&(n.writeFieldBegin({fname:"metadata",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeString(t.metadata),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function v(t,n){if(n.writeStructBegin("LogMessage"),n.writeFieldBegin({fname:"message",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.message!=null)n.writeString(t.message);else{var o="";n.writeString(o)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function S(t,n){if(n.writeStructBegin("Termination"),n.writeFieldBegin({fname:"reason",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),t.reason!=null){var a;n.writeI32((a=t.reason)!=null?a:0)}else{var i=o("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(0);n.writeI32(i!=null?i:0)}n.writeFieldEnd(),t.message!=null&&(n.writeFieldBegin({fname:"message",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeString(t.message),n.writeFieldEnd()),t.retry_delay_ms!=null&&(n.writeFieldBegin({fname:"retry_delay_ms",ftype:(e||(e=r("ThriftTypes"))).I64,fid:3}),n.writeI64(r("jsbi").BigInt(t.retry_delay_ms)),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function R(t,n){n.writeStructBegin("AmendStreamAck"),t.amendment_id!=null&&(n.writeFieldBegin({fname:"amendment_id",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),n.writeI64(r("jsbi").BigInt(t.amendment_id)),n.writeFieldEnd()),t.accepted!=null&&(n.writeFieldBegin({fname:"accepted",ftype:(e||(e=r("ThriftTypes"))).BOOL,fid:2}),n.writeBool(t.accepted),n.writeFieldEnd()),t.result!=null&&(n.writeFieldBegin({fname:"result",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:3}),n.writeBinary(t.result),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function L(t,n){if(n.writeStructBegin("StreamCheck"),n.writeFieldBegin({fname:"stream_id",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),t.stream_id!=null)n.writeI64(r("jsbi").BigInt(t.stream_id));else{var a="0";n.writeI64(r("jsbi").BigInt(a))}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"last_sequencer",ftype:e.I32,fid:2}),t.last_sequencer!=null)n.writeI32(t.last_sequencer);else{var i=0;n.writeI32(i)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"amendment_count",ftype:e.I32,fid:4}),t.amendment_count!=null)n.writeI32(t.amendment_count);else{var l=0;n.writeI32(l)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"last_status",ftype:e.I32,fid:3}),t.last_status!=null){var s;n.writeI32((s=t.last_status)!=null?s:0)}else{var u=o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(0);n.writeI32(u!=null?u:0)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function E(t,n){if(n.writeStructBegin("Ping"),n.writeFieldBegin({fname:"caller_timestamp_ms",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),t.caller_timestamp_ms!=null)n.writeI64(r("jsbi").BigInt(t.caller_timestamp_ms));else{var o="0";n.writeI64(r("jsbi").BigInt(o))}if(n.writeFieldEnd(),t.streams_to_check!=null){n.writeFieldBegin({fname:"streams_to_check",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:2}),n.writeListBegin({etype:e.STRUCT,size:t.streams_to_check.length});for(var a of t.streams_to_check)L(a,n);n.writeListEnd(),n.writeFieldEnd()}n.writeFieldStop(),n.writeStructEnd()}function k(t,n){if(n.writeStructBegin("Pong"),n.writeFieldBegin({fname:"original_ping_timestamp_ms",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),t.original_ping_timestamp_ms!=null)n.writeI64(r("jsbi").BigInt(t.original_ping_timestamp_ms));else{var o="0";n.writeI64(r("jsbi").BigInt(o))}if(n.writeFieldEnd(),t.stream_ids_missing!=null){n.writeFieldBegin({fname:"stream_ids_missing",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:2}),n.writeListBegin({etype:e.I64,size:t.stream_ids_missing.length});for(var a of t.stream_ids_missing)n.writeI64(r("jsbi").BigInt(a));n.writeListEnd(),n.writeFieldEnd()}if(t.stream_ids_behind!=null){n.writeFieldBegin({fname:"stream_ids_behind",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:3}),n.writeListBegin({etype:e.I64,size:t.stream_ids_behind.length});for(var i of t.stream_ids_behind)n.writeI64(r("jsbi").BigInt(i));n.writeListEnd(),n.writeFieldEnd()}if(t.stream_ids_with_lost_amendments!=null){n.writeFieldBegin({fname:"stream_ids_with_lost_amendments",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:4}),n.writeListBegin({etype:e.I64,size:t.stream_ids_with_lost_amendments.length});for(var l of t.stream_ids_with_lost_amendments)n.writeI64(r("jsbi").BigInt(l));n.writeListEnd(),n.writeFieldEnd()}if(t.stream_ids_with_wrong_status!=null){n.writeFieldBegin({fname:"stream_ids_with_wrong_status",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:5}),n.writeListBegin({etype:e.I64,size:t.stream_ids_with_wrong_status.length});for(var s of t.stream_ids_with_wrong_status)n.writeI64(r("jsbi").BigInt(s));n.writeListEnd(),n.writeFieldEnd()}n.writeFieldStop(),n.writeStructEnd()}function I(t,n){if(n.writeStructBegin("StreamResponseDelta"),t.flow_status!=null){var o;n.writeFieldBegin({fname:"flow_status",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),n.writeI32((o=t.flow_status)!=null?o:0),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.log!=null){n.writeFieldBegin({fname:"log",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:2}),v(t.log,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.rewrite!=null){n.writeFieldBegin({fname:"rewrite",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:3}),y(t.rewrite,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.data!=null){n.writeFieldBegin({fname:"data",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:4}),b(t.data,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.termination!=null){n.writeFieldBegin({fname:"termination",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:5}),S(t.termination,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.amend_ack!=null){n.writeFieldBegin({fname:"amend_ack",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:6}),R(t.amend_ack,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}n.writeFieldStop(),n.writeStructEnd()}function T(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.new_headers=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.new_body=t.readBinary():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).STRING?n.patch_headers=t.readString():t.skip(a);break;case 4:a===(e||(e=r("ThriftTypes"))).BOOL?n.kill_body=t.readBool():t.skip(a);break;case 5:a===(e||(e=r("ThriftTypes"))).BOOL?n.temporary=t.readBool():t.skip(a);break;case 6:a===(e||(e=r("ThriftTypes"))).STRUCT?n.conditional_patch_headers=D(t):t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n}function D(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.expected_existing_headers=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.patch_headers_if_match=t.readString():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).STRING?n.patch_headers_otherwise=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.expected_existing_headers===void 0&&(n.expected_existing_headers=""),n.patch_headers_if_match===void 0&&(n.patch_headers_if_match=""),n}function x(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.bytes=t.readBinary():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.metadata=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.bytes===void 0&&(n.bytes=Uint8Array.of()),n}function $(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.message=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.message===void 0&&(n.message=""),n}function P(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I32?n.reason=o("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(t.readI32()):t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).STRING?n.message=t.readString():t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).I64?n.retry_delay_ms=t.readI64().toString():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.reason===void 0&&(n.reason=o("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(0)),n}function N(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).I64?n.amendment_id=t.readI64().toString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).BOOL?n.accepted=t.readBool():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).STRING?n.result=t.readBinary():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n}function M(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I64?n.stream_id=t.readI64().toString():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).I32?n.last_sequencer=t.readI32():t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).I32?n.amendment_count=t.readI32():t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).I32?n.last_status=o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(t.readI32()):t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.stream_id===void 0&&(n.stream_id="0"),n.last_sequencer===void 0&&(n.last_sequencer=0),n.amendment_count===void 0&&(n.amendment_count=0),n.last_status===void 0&&(n.last_status=o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(0)),n}function w(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).I64?n.caller_timestamp_ms=t.readI64().toString():t.skip(a);break;case 2:if(a===(e||(e=r("ThriftTypes"))).LIST){n.streams_to_check=[];for(var l=t.readListBegin(),s=0;s<l.size;s++){var u=M(t);n.streams_to_check.push(u)}}else t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.caller_timestamp_ms===void 0&&(n.caller_timestamp_ms="0"),n}function A(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).I64?n.original_ping_timestamp_ms=t.readI64().toString():t.skip(a);break;case 2:if(a===(e||(e=r("ThriftTypes"))).LIST){n.stream_ids_missing=[];for(var l=t.readListBegin(),s=0;s<l.size;s++){var u=t.readI64().toString();n.stream_ids_missing.push(u)}}else t.skip(a);break;case 3:if(a===(e||(e=r("ThriftTypes"))).LIST){n.stream_ids_behind=[];for(var c=t.readListBegin(),d=0;d<c.size;d++){var m=t.readI64().toString();n.stream_ids_behind.push(m)}}else t.skip(a);break;case 4:if(a===(e||(e=r("ThriftTypes"))).LIST){n.stream_ids_with_lost_amendments=[];for(var p=t.readListBegin(),_=0;_<p.size;_++){var f=t.readI64().toString();n.stream_ids_with_lost_amendments.push(f)}}else t.skip(a);break;case 5:if(a===(e||(e=r("ThriftTypes"))).LIST){n.stream_ids_with_wrong_status=[];for(var g=t.readListBegin(),h=0;h<g.size;h++){var y=t.readI64().toString();n.stream_ids_with_wrong_status.push(y)}}else t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.original_ping_timestamp_ms===void 0&&(n.original_ping_timestamp_ms="0"),n}function F(t){var n,a={};for(t.readStructBegin();;){var i=t.readFieldBegin(),l=i.ftype,s=i.fid;if(l===(e||(e=r("ThriftTypes"))).STOP)break;switch(s){case 1:if(l===(e||(e=r("ThriftTypes"))).I32)if(n==null)a.flow_status=o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(t.readI32()),n="flow_status";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: flow_status, previous deserialized field: "+n);else t.skip(l);break;case 2:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.log=$(t),n="log";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: log, previous deserialized field: "+n);else t.skip(l);break;case 3:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.rewrite=T(t),n="rewrite";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: rewrite, previous deserialized field: "+n);else t.skip(l);break;case 4:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.data=x(t),n="data";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: data, previous deserialized field: "+n);else t.skip(l);break;case 5:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.termination=P(t),n="termination";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: termination, previous deserialized field: "+n);else t.skip(l);break;case 6:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.amend_ack=N(t),n="amend_ack";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: amend_ack, previous deserialized field: "+n);else t.skip(l);break;default:t.skip(l)}t.readFieldEnd()}return t.readStructEnd(),a}l.ResponseRewriteRequest$DefaultConstructor=s,l.ResponseRewriteConditionalPatchHeaders$DefaultConstructor=u,l.ResponseData$DefaultConstructor=c,l.LogMessage$DefaultConstructor=d,l.Termination$DefaultConstructor=m,l.AmendStreamAck$DefaultConstructor=p,l.StreamCheck$DefaultConstructor=_,l.Ping$DefaultConstructor=f,l.Pong$DefaultConstructor=g,l.StreamResponseDelta$DefaultConstructor=h,l.serializeResponseRewriteRequest=y,l.serializeResponseRewriteConditionalPatchHeaders=C,l.serializeResponseData=b,l.serializeLogMessage=v,l.serializeTermination=S,l.serializeAmendStreamAck=R,l.serializeStreamCheck=L,l.serializePing=E,l.serializePong=k,l.serializeStreamResponseDelta=I,l.deserializeResponseRewriteRequest=T,l.deserializeResponseRewriteConditionalPatchHeaders=D,l.deserializeResponseData=x,l.deserializeLogMessage=$,l.deserializeTermination=P,l.deserializeAmendStreamAck=N,l.deserializeStreamCheck=M,l.deserializePing=w,l.deserializePong=A,l.deserializeStreamResponseDelta=F}),98);
__d("RequestStreamSingleChannelSingleChannelRequestStreamTypes",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum")({Ignored:100,Success:200,Queued:250,UnknownStream:400,HandledUnknownResult:450,Failure:500}),l=n("$InternalEnum")({Request_headers:"request_headers",Request_body:"request_body",Amend:"amend",Ack:"ack",Response:"response",Ping:"ping",Pong:"pong"});a.exports={Ack:e,Payload$Types:l}}),null);
__d("RequestStreamSingleChannelSingleChannelRequestStreamSerializers",["RequestStreamCommonRequestStreamCommonSerializers","RequestStreamCommonRequestStreamCommonTypes","RequestStreamSingleChannelSingleChannelRequestStreamTypes","ThriftTypes","jsbi"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){return{}}function u(){return{body:Uint8Array.of()}}function c(){return{amendment:Uint8Array.of()}}function d(){return{ack:o("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(0)}}function m(){return{delta:[]}}function p(){return{}}function _(t,n){n.writeStructBegin("RequestStreamHeaders"),t.headers!=null&&(n.writeFieldBegin({fname:"headers",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),n.writeBinary(t.headers),n.writeFieldEnd()),t.instrumentation_data!=null&&(n.writeFieldBegin({fname:"instrumentation_data",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeBinary(t.instrumentation_data),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function f(t,n){if(n.writeStructBegin("RequestStreamBody"),n.writeFieldBegin({fname:"body",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.body!=null)n.writeBinary(t.body);else{var o=Uint8Array.of();n.writeBinary(o)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function g(t,n){if(n.writeStructBegin("AmendStream"),t.amendment_id!=null&&(n.writeFieldBegin({fname:"amendment_id",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),n.writeI64(r("jsbi").BigInt(t.amendment_id)),n.writeFieldEnd()),n.writeFieldBegin({fname:"amendment",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),t.amendment!=null)n.writeBinary(t.amendment);else{var o=Uint8Array.of();n.writeBinary(o)}n.writeFieldEnd(),t.is_query!=null&&(n.writeFieldBegin({fname:"is_query",ftype:(e||(e=r("ThriftTypes"))).BOOL,fid:3}),n.writeBool(t.is_query),n.writeFieldEnd()),t.instrumentation_data!=null&&(n.writeFieldBegin({fname:"instrumentation_data",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:4}),n.writeBinary(t.instrumentation_data),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function h(t,n){if(n.writeStructBegin("StreamResponseAck"),t.response_id!=null&&(n.writeFieldBegin({fname:"response_id",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),n.writeI64(r("jsbi").BigInt(t.response_id)),n.writeFieldEnd()),n.writeFieldBegin({fname:"ack",ftype:(e||(e=r("ThriftTypes"))).I32,fid:2}),t.ack!=null){var a;n.writeI32((a=t.ack)!=null?a:0)}else{var i=o("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(0);n.writeI32(i!=null?i:0)}n.writeFieldEnd(),t.query_result!=null&&(n.writeFieldBegin({fname:"query_result",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:3}),n.writeBinary(t.query_result),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function y(t,n){if(n.writeStructBegin("StreamResponse"),t.response_id!=null&&(n.writeFieldBegin({fname:"response_id",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),n.writeI64(r("jsbi").BigInt(t.response_id)),n.writeFieldEnd()),n.writeFieldBegin({fname:"delta",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:2}),t.delta!=null){n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:t.delta.length});for(var a of t.delta)o("RequestStreamCommonRequestStreamCommonSerializers").serializeStreamResponseDelta(a,n);n.writeListEnd()}else{var i=[];n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:i.length});for(var l of i)o("RequestStreamCommonRequestStreamCommonSerializers").serializeStreamResponseDelta(l,n);n.writeListEnd()}if(n.writeFieldEnd(),t.ack_level!=null){var s;n.writeFieldBegin({fname:"ack_level",ftype:(e||(e=r("ThriftTypes"))).I32,fid:3}),n.writeI32((s=t.ack_level)!=null?s:0),n.writeFieldEnd()}t.query_request!=null&&(n.writeFieldBegin({fname:"query_request",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:4}),n.writeBinary(t.query_request),n.writeFieldEnd()),t.instrumentation_data!=null&&(n.writeFieldBegin({fname:"instrumentation_data",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:5}),n.writeBinary(t.instrumentation_data),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function C(t,n){if(n.writeStructBegin("Payload"),t.request_headers!=null){n.writeFieldBegin({fname:"request_headers",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:1}),_(t.request_headers,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.request_body!=null){n.writeFieldBegin({fname:"request_body",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:2}),f(t.request_body,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.amend!=null){n.writeFieldBegin({fname:"amend",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:3}),g(t.amend,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.ack!=null){n.writeFieldBegin({fname:"ack",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:4}),h(t.ack,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.response!=null){n.writeFieldBegin({fname:"response",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:5}),y(t.response,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.ping!=null){n.writeFieldBegin({fname:"ping",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:6}),o("RequestStreamCommonRequestStreamCommonSerializers").serializePing(t.ping,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.pong!=null){n.writeFieldBegin({fname:"pong",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:7}),o("RequestStreamCommonRequestStreamCommonSerializers").serializePong(t.pong,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}n.writeFieldStop(),n.writeStructEnd()}function b(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.headers=t.readBinary():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.instrumentation_data=t.readBinary():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n}function v(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.body=t.readBinary():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.body===void 0&&(n.body=Uint8Array.of()),n}function S(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).I64?n.amendment_id=t.readI64().toString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.amendment=t.readBinary():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).BOOL?n.is_query=t.readBool():t.skip(a);break;case 4:a===(e||(e=r("ThriftTypes"))).STRING?n.instrumentation_data=t.readBinary():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.amendment===void 0&&(n.amendment=Uint8Array.of()),n}function R(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I64?n.response_id=t.readI64().toString():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).I32?n.ack=o("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(t.readI32()):t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).STRING?n.query_result=t.readBinary():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.ack===void 0&&(n.ack=o("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(0)),n}function L(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I64?n.response_id=t.readI64().toString():t.skip(i);break;case 2:if(i===(e||(e=r("ThriftTypes"))).LIST){n.delta=[];for(var s=t.readListBegin(),u=0;u<s.size;u++){var c=o("RequestStreamCommonRequestStreamCommonSerializers").deserializeStreamResponseDelta(t);n.delta.push(c)}}else t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).I32?n.ack_level=o("RequestStreamCommonRequestStreamCommonTypes").AckLevel.cast(t.readI32()):t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).STRING?n.query_request=t.readBinary():t.skip(i);break;case 5:i===(e||(e=r("ThriftTypes"))).STRING?n.instrumentation_data=t.readBinary():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.delta===void 0&&(n.delta=[]),n}function E(t){var n,a={};for(t.readStructBegin();;){var i=t.readFieldBegin(),l=i.ftype,s=i.fid;if(l===(e||(e=r("ThriftTypes"))).STOP)break;switch(s){case 1:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.request_headers=b(t),n="request_headers";else throw new Error("more than one field have been deserialized in union type: Payload; current field: request_headers, previous deserialized field: "+n);else t.skip(l);break;case 2:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.request_body=v(t),n="request_body";else throw new Error("more than one field have been deserialized in union type: Payload; current field: request_body, previous deserialized field: "+n);else t.skip(l);break;case 3:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.amend=S(t),n="amend";else throw new Error("more than one field have been deserialized in union type: Payload; current field: amend, previous deserialized field: "+n);else t.skip(l);break;case 4:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.ack=R(t),n="ack";else throw new Error("more than one field have been deserialized in union type: Payload; current field: ack, previous deserialized field: "+n);else t.skip(l);break;case 5:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.response=L(t),n="response";else throw new Error("more than one field have been deserialized in union type: Payload; current field: response, previous deserialized field: "+n);else t.skip(l);break;case 6:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.ping=o("RequestStreamCommonRequestStreamCommonSerializers").deserializePing(t),n="ping";else throw new Error("more than one field have been deserialized in union type: Payload; current field: ping, previous deserialized field: "+n);else t.skip(l);break;case 7:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.pong=o("RequestStreamCommonRequestStreamCommonSerializers").deserializePong(t),n="pong";else throw new Error("more than one field have been deserialized in union type: Payload; current field: pong, previous deserialized field: "+n);else t.skip(l);break;default:t.skip(l)}t.readFieldEnd()}return t.readStructEnd(),a}l.RequestStreamHeaders$DefaultConstructor=s,l.RequestStreamBody$DefaultConstructor=u,l.AmendStream$DefaultConstructor=c,l.StreamResponseAck$DefaultConstructor=d,l.StreamResponse$DefaultConstructor=m,l.Payload$DefaultConstructor=p,l.serializeRequestStreamHeaders=_,l.serializeRequestStreamBody=f,l.serializeAmendStream=g,l.serializeStreamResponseAck=h,l.serializeStreamResponse=y,l.serializePayload=C,l.deserializeRequestStreamHeaders=b,l.deserializeRequestStreamBody=v,l.deserializeAmendStream=S,l.deserializeStreamResponseAck=R,l.deserializeStreamResponse=L,l.deserializePayload=E}),98);
__d("RequestStreamState",["RequestStreamCommonRequestStreamCommonTypes"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){switch(t){case o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted:return e.seenAccepted||e.flowStatus===o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started?e:{flowStatus:o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted,seenAccepted:!0};default:return!e.seenAccepted||e.flowStatus===t?e:{flowStatus:t,seenAccepted:!0}}}l.getNextState=e}),98);
__d("StreamRetryState",[],(function(t,n,r,o,a,i){"use strict";var e=1e3,l=120*1e3,s=(function(){function t(){this.$1=0}var n=t.prototype;return n.resetErrorAndRetryCount=function(){this.$1=0},n.onRetry=function(){this.$1+=1},n.getRetryCount=function(){return this.$1},n.getBackoffDelayMs=function(){if(this.$1<=1)return 0;if(this.$1===2)return e*Math.random();var t=e*Math.pow(2,this.$1-3),n=t*Math.random(),r=t+n;return Math.min(r,l)},t})();i.default=s}),66);
__d("DGWRequestStreamRef",["CompactSerializerPolyfill","DGWRequestStreamUtils","DGWStream","DGWStreamHandler","InflightAmends","RequestStreamCloseReason","RequestStreamCommonRequestStreamCommonTypes","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","RequestStreamE2ELogger","RequestStreamE2ESampling","RequestStreamSingleChannelSingleChannelRequestStreamSerializers","RequestStreamSingleChannelSingleChannelRequestStreamTypes","RequestStreamState","RequestStreamTransport","StreamRetryState","err","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e=4,s=0,u=1e3,c=2,d=5e3,m="dgw_stream_send_ack_failure";function p(e){if(!e){var t=r("err")(m);throw t.stack,t}}function _(e,t){if(e==null||e.length===0)return null;var n=JSON.parse(e);return n.auxId=t,new TextEncoder().encode(JSON.stringify(n))}function f(e){var t={},n=e.delta;return n.forEach(function(e){if(e.flow_status)switch(t.type=o("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Flow_status,e.flow_status){case o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted:t.flow_status="Accepted";break;case o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started:t.flow_status="Started";break;case o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped:t.flow_status="Stopped";break}else e.log?t.type=o("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Log:e.rewrite?t.type=o("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Rewrite:e.data?t.type=o("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Data:e.termination?t.type=o("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Termination:e.amend_ack&&(t.type=o("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Amend_ack)}),t}var g=(function(){function t(t,n,a,i,l,s,u){var c=this,p,_,f;this.$6=null,this.$7={},this.$10=!1,this.$15=new(r("StreamRetryState")),this.$16=0,this.$17=0,this.$18=0,this.$21=0;var g=null;typeof n=="string"?g=new TextEncoder().encode(n):typeof n=="object"&&(g=n),this.$1={headers:t,body:g},this.$3=a,this.$4=u,this.$12=e,this.$9=!1,this.$14=!1,this.$20=s;var h=i==null?void 0:i.serviceId;l!=null&&(this.$22()||(l.dgwStreamGroupLoggingId=this.$20.getStreamGroupLoggingId(h)),l.dgwCountPriorStreamsInGroup=this.$20.guessStreamGroupPriorStreamCount(h),l.transport="WEB_RS_STARGATE"),this.$5=o("RequestStreamE2ESampling").validateInstrumentationData(t,l,i==null?void 0:i.requestLogContext,i==null?void 0:i.upsampleMultiplier),this.$22()?this.$7.disableFalcoLogging=!0:this.$6=o("RequestStreamE2ELogger").createStreamLogger(t,this.$5,o("RequestStreamTransport").RequestStreamTransport.WEB_RS_STARGATE),(i==null?void 0:i.deviceId)!=null&&(this.$7.deviceId=i.deviceId),this.$6&&(this.$7.loggingId=this.$6.getRequestId()),i&&i.overrideUrl!=null&&(this.$7.overrideUrl=i.overrideUrl),h!=null&&(this.$7.serviceId=h),(i==null?void 0:i.authType)!=null&&(this.$7.authType=i.authType),(i==null?void 0:i.authToken)!=null&&(this.$7.authToken=i.authToken),this.$8={flowStatus:o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped,seenAccepted:!1},this.$19=new(r("InflightAmends"))(d,function(e,t){var n;(n=c.$6)==null||n.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT_ACK,r("RequestStreamE2EClientLoggerEvent").RECEIVED,babelHelpers.extends({},c.$23(),{latency:t.toString()}),e)},function(e,t){if(t.message!==m){var n;(n=c.$6)==null||n.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT_ACK,r("RequestStreamE2EClientLoggerEvent").FAILURE,babelHelpers.extends({},c.$23(),{reason:t.message}),e)}}),(p=this.$6)==null||p.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,r("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_size:(_=n==null||(f=n.length)==null?void 0:f.toString())!=null?_:"0"},"0","0")}var n=t.prototype;return n.getInstrumentationData=function(){return this.$5},n.getE2EClientLogger=function(){return this.$6},n.amendWithAck=function(t){var e=this.$24(t,!0);return e==null?Promise.resolve(!1):this.$19.getPromise(e)||Promise.resolve(!1)},n.amendWithoutAck=function(t){this.$24(t,!1)},n.cancel=function(){var e;(e=this.$6)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").CANCEL,r("RequestStreamE2EClientLoggerEvent").RECEIVED),this.$9=!0,this.$25(o("RequestStreamCloseReason").RequestStreamCloseReason.UserIntention,"user cancel the stream",!0)},n.start=function(t){var e=this;t===void 0&&(t=!1);var n=String(this.$16++),a=Date.now();return this.$26(n).then(function(){var t;e.$14=!1,e.$21=0;var o=(Date.now()-a).toString();(t=e.$6)==null||t.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,r("RequestStreamE2EClientLoggerEvent").PUBACK,{latency:o},n,String(e.$18))}).catch(function(a){if(a.stack,!(a.message===m&&e.$10))if(e.$14=!1,a!==o("DGWStream").StreamError.ESTABLISHMENT_ERROR){var i,l=a.message;if(a===o("DGWStream").StreamError.UNAUTHENTICATED?l="UNAUTHENTICATED":a===o("DGWStream").StreamError.UNAUTHORIZED&&(l="UNAUTHORIZED"),(i=e.$6)==null||i.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:l},n,String(e.$18)),e.$25(t?o("RequestStreamCloseReason").RequestStreamCloseReason.ReestablishError:o("RequestStreamCloseReason").RequestStreamCloseReason.StartStreamFailure,l,!0),a===o("DGWStream").StreamError.UNAUTHENTICATED||a===o("DGWStream").StreamError.UNAUTHORIZED)return;throw a}else{var s,d;(s=e.$6)==null||s.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:(d=a.message)!=null?d:a},n,String(e.$18)),e.$15.onRetry();var p=e.$4.unlimited_retries_on_stream_error?e.$15.getBackoffDelayMs():u*Math.pow(c,e.$21);return new Promise(function(e){return window.setTimeout(e,p)}).then(function(){return e.$21++,e.$18++,e.start()})}})},n.getFlowStatus=function(){return this.$8.flowStatus},n.shouldTerminateOrRetry=function(t,n,a,i){var e=this;if(!this.$14){var l=n;if(this.$12||(l="cannot retry for error: "+n+" because of hit max retry limitation"),t!==o("RequestStreamCloseReason").RequestStreamCloseReason.ClientError){var u;(u=this.$6)==null||u.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:l},null,String(this.$18))}var c=a&&(this.$4.unlimited_retries_on_stream_error||this.$12);if(this.$25(t,l,!c),c){var d=this.$4.unlimited_retries_on_stream_error?Math.max(i!=null?i:0,this.$15.getBackoffDelayMs()):i!=null?i:s;return this.$14=!0,new Promise(function(e){return window.setTimeout(e,d)}).then(function(){return e.$27()}).catch(function(e){})}}},n.$28=function(){return this.$11!=null},n.$24=function(t,n){var e,a=this,i=typeof t=="string"?new TextEncoder().encode(t):t,l=String(this.$17++);(e=this.$6)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").RECEIVED,{},l);var s=_(this.$5,l),u={amend:{amendment:i,instrumentation_data:s}};n&&u.amend&&(u.amend.amendment_id=l);var c=o("CompactSerializerPolyfill").serialize(u,o("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").serializePayload),d=Date.now();if(this.$29()&&this.$11!=null){var m,f,g;return n&&this.$19.add(l),this.$11.send(c).then(function(e){var t;p(e);var n=(Date.now()-d).toString();(t=a.$6)==null||t.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").PUBACK,{latency:n},l)}).catch(function(e){var t;(t=a.$6)==null||t.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:e.message},l),a.$19.reject(l,e)}),(m=this.$6)==null||m.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").SENT,{data_size:(f=t==null||(g=t.length)==null?void 0:g.toString())!=null?f:"0"},l),l}else{var h;(h=this.$6)==null||h.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"not_started"},l)}},n.$26=async function(n){var t=this;if(this.$9)throw new Error("stream_already_canceled");var a,i=this.$2||this.$1;try{var l=this.$30();this.$13=l;var s=i.headers.graphiql_sandbox,u=babelHelpers.extends({},i.headers,this.$31());s!=null&&(u=babelHelpers.extends({},u,{www_sandbox:s,distillery_sandbox:s+":8086"}));var c=o("DGWRequestStreamUtils").convertHeaders(u,i.body!=null,this.$5,void 0,this.$4.webdriver_test_request_id);this.$11=await this.$20.establishStream(c,l,this.$7)}catch(e){var d=typeof e=="string"?o("DGWStream").StreamError.cast(e):void 0;if(d===o("DGWStream").StreamError.ESTABLISHMENT_ERROR||d!=null&&!o("DGWStream").isRetryableError(d))throw d;if(d!=null&&o("DGWStream").isRetryableError(d)){this.$32(d);return}throw e}if(this.$9){this.$25(o("RequestStreamCloseReason").RequestStreamCloseReason.UserIntention,"user cancel the stream",!0);return}var m=new Uint8Array([]);if(i.body!=null){var _={request_body:{body:i.body}};m=o("CompactSerializerPolyfill").serialize(_,o("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").serializePayload)}if(!this.$11)throw new Error("dgwstream_is_null");var f=this.$11.send(m).then(function(e){p(e),t.$9&&t.$25(o("RequestStreamCloseReason").RequestStreamCloseReason.UserIntention,"user cancel the stream",!0)});return(a=this.$6)==null||a.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,r("RequestStreamE2EClientLoggerEvent").SENT,{},n,String(this.$18)),this.$12=e,f},n.$29=function(){return this.$8.flowStatus===o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started||this.$8.flowStatus===o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted},n.$25=function(t,n,r){var e;this.$11&&t!==o("RequestStreamCloseReason").RequestStreamCloseReason.StreamError&&t!==o("RequestStreamCloseReason").RequestStreamCloseReason.RemoteTermination&&this.$11.close(),(e=this.$13)==null||e.stop(),this.$11=null,this.$10=!0,this.$33(o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped)&&this.$3.onFlowStatus(o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped),r&&!this.$9&&this.$3.onTermination("terminate stream because "+t+" with msg : "+n)},n.$33=function(t){var e=this.$8;return this.$8=o("RequestStreamState").getNextState(e,t),e!==this.$8},n.$27=function(){return this.$12--,this.$18++,this.$15.onRetry(),this.start(!0)},n.$34=function(t){var e=this,n=o("CompactSerializerPolyfill").deserialize(t,o("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").deserializePayload);if(n.response){var a,i,l=o("DGWRequestStreamUtils").getInstrumentationDataFieldsFromPayload(n),s=l==null?void 0:l.auxId,u=l==null?void 0:l.dfTraceId;if(!this.$28()){var c;(c=this.$6)==null||c.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").RESPONSE,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"response_received_after_close"},s,String(this.$18),u);return}var d;(a=this.$6)==null||a.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").RESPONSE,r("RequestStreamE2EClientLoggerEvent").RECEIVED,f(n.response),s,String(this.$18),u,d);var m=n.response.delta;m.forEach(function(t){if(t.data)e.$15.resetErrorAndRetryCount(),e.$3.onData(new TextDecoder("utf-8").decode(t.data.bytes));else if(t.flow_status){var n=t.flow_status;n===o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started&&e.$15.resetErrorAndRetryCount(),e.$33(n)&&e.$3.onFlowStatus(n)}else if(t.termination){var r,a=(r=t.termination.message)!=null?r:"unknown termination msg";e.$2=null,e.shouldTerminateOrRetry(o("RequestStreamCloseReason").RequestStreamCloseReason.RemoteTermination,a,t.termination.reason===o("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.TryAgain,t.termination.retry_delay_ms!=null?parseInt(t.termination.retry_delay_ms,10):null)}else if(t.log)e.$3.onLog(t.log.message);else if(t.amend_ack){var i=t.amend_ack.amendment_id;if(i!=null){var l=t.amend_ack.accepted||!1;e.$19.resolve(i,l)}}else if(t.rewrite){var s=o("DGWRequestStreamUtils").transformContextWithRewriteDelta(e.$1,t.rewrite);t.rewrite.temporary===!0?e.$2=s:e.$1=s}}),(i=this.$6)==null||i.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").RESPONSE,r("RequestStreamE2EClientLoggerEvent").SENT,f(n.response),s,String(this.$18),u),n.response.ack_level===o("RequestStreamCommonRequestStreamCommonTypes").AckLevel.Device&&n.response.response_id!=null&&this.$35(n.response.response_id,s)}else{var p;(p=this.$6)==null||p.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").RESPONSE,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"unexpected_payload_type"},null,String(this.$18))}},n.$35=function(t,n){var e={ack:{response_id:t,ack:o("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.Success}},a=o("CompactSerializerPolyfill").serialize(e,o("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").serializePayload);if(this.$11!=null){var i;this.$11.send(a),(i=this.$6)==null||i.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").RESPONSE_ACK,r("RequestStreamE2EClientLoggerEvent").SENT,{},n,String(this.$18))}else{var l;(l=this.$6)==null||l.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").RESPONSE_ACK,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"not_started"},n,String(this.$18))}},n.$22=function(){return this.$1.headers.method==="Falco"},n.$30=function(){var e=this;return new(r("DGWStreamHandler"))(function(t){return e.$36(t)},function(t){return e.$37(t)},function(t){return e.$32(t)},function(t,n){return e.$38(t,n)},function(t){return e.$39(t)})},n.$39=function(t){var e;(e=this.$6)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"OnClose: Server Has FinishedSendingData"},null,String(this.$18)),this.$25(o("RequestStreamCloseReason").RequestStreamCloseReason.ServerDataEnd,"Client receive OnServerHasFinishedSendingData and Server will not send more data",!0)},n.$36=function(t){var e;(e=this.$6)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"OnClose: Server Close Connection"},null,String(this.$18)),this.$25(o("RequestStreamCloseReason").RequestStreamCloseReason.RemoteTermination,"Client receive OnClose and Server will not send more data",!0)},n.$37=function(t){try{this.$34(t)}catch(t){var e,n=r("getErrorSafe")(t);(e=this.$6)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").RESPONSE,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:n.message},null,String(this.$18)),this.shouldTerminateOrRetry(o("RequestStreamCloseReason").RequestStreamCloseReason.ClientError,n.message,!1)}},n.$32=function(t){var e="",n=o("DGWStream").isRetryableError(t);e="StreamError: Received "+t,this.shouldTerminateOrRetry(o("RequestStreamCloseReason").RequestStreamCloseReason.StreamError,e,n)},n.$38=function(t,n){this.shouldTerminateOrRetry(o("RequestStreamCloseReason").RequestStreamCloseReason.ServerDrain,n,!0)},n.$31=function(){return this.$4.overrideHeaders},n.$23=function(){return{pending_amendments_size:this.$19.getSize().toString()}},t})();l.default=g}),98);
__d("DGWStreamFactory",["DGWStreamGroupHandler","Promise","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e,s="realtime",u=1e4,c=null,d=(function(){function t(e){this.$1=e,this.$2={}}t.get=function(n){return c==null&&(c=new t(n)),c};var o=t.prototype;return o.$3=function(t){this.$2[t]={dgwStreamGroup:null,multiStreamGroupLoggingId:null,multiStreamGroupPriorStreamCountGuess:0,authType:null}},o.getStreamGroupLoggingId=function(t){var e;return t===void 0&&(t=null),(e=this.$2[t!=null?t:s])==null?void 0:e.multiStreamGroupLoggingId},o.guessStreamGroupPriorStreamCount=function(t){var e;return t===void 0&&(t=null),((e=this.$2[t!=null?t:s])==null?void 0:e.multiStreamGroupPriorStreamCountGuess)||0},o.establishStream=function(o,a,i){var t=this,l=i.serviceId==null?s:i.serviceId,c=this.$2[l],d=c==null?void 0:c.dgwStreamGroup,m=c==null?void 0:c.authType,p=i.authType,_=d!=null&&m!==p;if(d==null||!d.canCreateGroupedStream()||_){var f={deviceId:i.deviceId,serviceId:l,disableFalcoLogging:i.disableFalcoLogging,streamGroupAppHeaders:{"stream-group":"group1"},authToken:i.authToken,authType:i.authType};i.overrideUrl!=null&&(f.overrideUrl=i.overrideUrl),f.keepAliveMs=u,this.$1.log_dgw_streamgroup&&(f.loggingId=r("uuidv4")());try{d=this.$1.dgw_client_factory().createStreamGroup(new(r("DGWStreamGroupHandler"))(function(){t.$3(l)},function(){t.$3(l)},function(){t.$3(l)}),f),this.$2[l]={dgwStreamGroup:d,multiStreamGroupLoggingId:f.loggingId,multiStreamGroupPriorStreamCountGuess:0,authType:i.authType}}catch(t){return(e||(e=n("Promise"))).reject(t)}}return this.$2[l].multiStreamGroupPriorStreamCountGuess++,d.establishStream({loggingId:i.loggingId,disableFalcoLogging:i.disableFalcoLogging,groupedStreamHeaders:o},a)},t})();l.default=d}),98);
__d("SCIsolationRollout",["gkx"],(function(t,n,r,o,a,i,l){"use strict";function e(e){if(e.startsWith("Falco"))return!1;if(e.startsWith("FBLQ:")||e.startsWith("GRAPHQL:")||e.startsWith("FBGQLS:")||e.startsWith("IGGQLS:"))return!0;var t=e.toUpperCase();return t.startsWith("SKY:")||t==="SKY"?r("gkx")("17115"):e==="MLCInternCollab"||e==="MLCCollab"?r("gkx")("3193"):!1}l.shouldUseSCIsolation=e}),98);
__d("DGWRequestStreamClient",["DGWRequestStreamRef","DGWStreamFactory","Promise","SCIsolationRollout","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e,s="streamcontroller",u=(function(){function t(e,t){this.$1=e,this.$2=t!=null?t:r("DGWStreamFactory").get(e.dgwStreamFactoryConfig)}var a=t.prototype;return a.createStream=function(a,i,l,u,c){var t=l,d=null;(c==null?void 0:c.serviceId)!=null?d=c.serviceId:a.method!=null&&o("SCIsolationRollout").shouldUseSCIsolation(a.method)&&(d=s);var m=null;return c!=null&&d!=null?m=babelHelpers.extends({},c,{serviceId:d}):c!=null?m=c:d!=null&&(m={serviceId:d}),(e||(e=n("Promise"))).resolve(new(r("DGWRequestStreamRef"))(a,i,u,m,t,this.$2,this.$1.dgwRequestStreamRefConfig))},t})();l.default=u}),98);/*FB_PKG_DELIM*/
__d("hyperionChannel",["hyperionHook"],(function(t,n,r,o,a,i,l){var e,s=(function(){function t(){this.$1=new(e||(e=o("hyperionHook"))).Hook}var n=t.prototype;return n.pipe=function(t,n){var e=this.$1.add(n?function(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];n(function(){t.emit.apply(t,[e].concat(o))})}:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];t.emit.apply(t,[e].concat(r))});return e.$2=t,t},n.unpipe=function(t){return this.$1.removeIf(function(e){return e.$2===t})},n.emit=function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(e=this.$1).call.apply(e,[t].concat(r))},t})(),u=(function(t){function n(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,e.$Channel1=Object.create(null),babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(n,t);var r=n.prototype;return r.$Channel2=function(n){var t=this.$Channel1[n];return t||(t=this.$Channel1[n]=new(e||(e=o("hyperionHook"))).Hook),t},r.on=function(t){return this.$Channel2(t)},r.addListener=function(t,n){return this.on(t).add(n)},r.removeListener=function(t,n){return this.on(t).remove(n),n},r.emit=function(n){for(var e,r,o=arguments.length,a=new Array(o>1?o-1:0),i=1;i<o;i++)a[i-1]=arguments[i];(e=this.$Channel2(n)).call.apply(e,a),(r=t.prototype.emit).call.apply(r,[this,n].concat(a))},n})(s),c=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.$PausableChannel1=!1,babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.pause=function(){this.$PausableChannel1=!0},n.unpause=function(){this.$PausableChannel1=!1},n.isPaused=function(){return this.$PausableChannel1},n.emit=function(n){var t;if(!this.$PausableChannel1){for(var r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];(t=e.prototype.emit).call.apply(t,[this,n].concat(o))}},t})(u);l.Channel=u,l.PausableChannel=c,l.PipeableEmitter=s}),98);
__d("ALChannel",["hyperionChannel"],(function(t,n,r,o,a,i,l){"use strict";var e=new(o("hyperionChannel")).Channel,s=e;l.default=s}),98);
__d("ALReactUtils",["FBLogger","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t){return!0},s=function(t){var e=Object.keys(t).find(function(e){return e.startsWith("__reactFiber$")});return e!=null?t[e]:null},u=function(t){var e,n,r=(e=t.displayName)!=null?e:t.name;if(r==null)return null;var o=r.match(/.*\[from (.*)\.react\]/);return(n=o==null?void 0:o[1])!=null?n:r};function c(t,n){if(t==null)return r("FBLogger")("ads_manager_auto_logging").warn("[AL] Null element passed to getReactComponentName_THIS_CAN_BREAK."),null;var o=n||e,a=t;try{for(var i=s(a);i;){var l=i.type;if(l==null||typeof l=="string"){i=i.return;continue}var c=u(l);if(c==null&&l.render!=null&&(c=u(l.render)),c!=null&&c!==""&&o(c))return c;i=i.return}}catch(e){var d=r("getErrorSafe")(e);return r("FBLogger")("ads_manager_auto_logging").catching(d).warn("[AL] Caught exception in getReactComponentName_THIS_CAN_BREAK."),null}}l.getReactComponentName_THIS_CAN_BREAK=c}),98);
__d("AccessibilityWebAssistiveTechTypedLoggerLite",["generateLiteTypedLogger"],(function(t,n,r,o,a,i){"use strict";a.exports=n("generateLiteTypedLogger")("logger:AccessibilityWebAssistiveTechLoggerConfig")}),null);
__d("AutoLoggingComponentValidatorListSitevarConfig.experimental",["cr:27482"],(function(t,n,r,o,a,i,l){"use strict";l.default=n("cr:27482")}),98);
__d("AutoLoggingComponentNameValidator",["AutoLoggingComponentValidatorListSitevarConfig.experimental","FBLogger"],(function(t,n,r,o,a,i,l){"use strict";var e={COMPONENT_ALLOW_LIST:r("AutoLoggingComponentValidatorListSitevarConfig.experimental").COMPONENT_ALLOW_LIST,COMPONENT_BLOCK_LIST:r("AutoLoggingComponentValidatorListSitevarConfig.experimental").COMPONENT_BLOCK_LIST},s=function(t){return t.join("|")},u=null;function c(t){var n,o;u!=null&&u!==t&&r("FBLogger")("auto_logging").warn("Config name used to get validator changed, ensure you are using consistent init config across AutoLogging",u,t),u=t;var a=(n=(o=r("AutoLoggingComponentValidatorListSitevarConfig.experimental").TOOL_CONFIG)==null?void 0:o[t])!=null?n:e,i=s(a.COMPONENT_ALLOW_LIST),l=s(a.COMPONENT_BLOCK_LIST);return function(e){return e.match(i)!=null&&e.match(l)==null}}l.getComponentNameValidator=c}),98);
__d("AdsALReactUtils",["ALReactUtils","AutoLoggingComponentNameValidator"],(function(t,n,r,o,a,i,l){"use strict";var e=o("AutoLoggingComponentNameValidator").getComponentNameValidator("ads");function s(t,n){var r;return n===void 0&&(n=null),o("ALReactUtils").getReactComponentName_THIS_CAN_BREAK(t,((r=n)==null?void 0:r.skipValidator)===!0?function(){return!0}:e)}function u(t){return!e(t)}l.getReactComponentName_THIS_CAN_BREAK=s,l.isComponentNameBlocked=u}),98);
__d("AutoLoggingComponentValidatorListSitevarConfigJSModuleWrapper",["AutoLoggingComponentValidatorListSitevarConfig"],(function(t,n,r,o,a,i,l){"use strict";l.default=r("AutoLoggingComponentValidatorListSitevarConfig")}),98);
__d("BDSignalBufferData",[],(function(t,n,r,o,a,i){"use strict";var e={},l=e;i.default=l}),66);
__d("SignalValueContext",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(e){this.cn=e}var t=e.prototype;return t.getSignalValueContextName=function(){return this.cn},e})();i.default=e}),66);
__d("BDSignalCollectorBase",["BDSignalBufferData","SignalValueContext"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.signalType=e}var t=e.prototype;return t.executeSignalCollection=function(){throw new Error("Child class responsibility to implement executeSignalCollection")},t.executeAsyncSignalCollection=async function(){var e=await this.executeSignalCollection();return e},e.getSanitizedURI=function(){var e=window.location.href,t=e.indexOf("?");return t<0?e:e.substring(0,t)},t.getContext=function(){return new(r("SignalValueContext"))(e.getSanitizedURI())},t.throwIfNotInitialized=function(){if(!(this.signalType in r("BDSignalBufferData")))throw new Error("Signal is not intialized")},e})();l.default=e}),98);
__d("BDBiometricSignalCollectorBase",["BDSignalCollectorBase","err"],(function(t,n,r,o,a,i,l){"use strict";var e="biometric_signal_collected",s=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.listenForSignals=function(){throw r("err")("Child class responsibility to implement listenForSignals")},n.executeSignalCollection=function(){throw r("err")("executeAsyncSignalCollection and executeSignalCollection should not be called on biometric signals")},t})(r("BDSignalCollectorBase"));l.BIOMETRIC_SIGNAL_COLLECTED_EVENT_NAME=e,l.BDBiometricSignalCollectorBase=s}),98);
__d("BDSignalWrapper",["BDSignalBufferData","SignalCollectorMap"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e,t){this.signalFlags=e,this.signalType=t}var t=e.prototype;return t.getSignalCollector=function(){return r("SignalCollectorMap").get(this.signalType)},t.getBufferConfig=function(){return r("BDSignalBufferData")[this.signalType]},e})();l.default=e}),98);
__d("BDLoggingConstants",[],(function(t,n,r,o,a,i){"use strict";var e={ERROR:"error",WARNING:"warning",INFO:"info"},l={KEY_NOT_FOUND:"key_not_found",APPEND_SIGNAL:"bd_append_signal",APPEND_SIGNAL_FAIL:"bd_append_signal_fail",HB_COLLECTED:"append_hb",HB_COLLECTION_FAILED:"hb_collection_failed",BD_EXCEPTION:"bd_exception",SIGNAL_NOT_IMPLEMENTED:"signal_not_implemented",SIGNAL_VALUE_NULL:"signal_value_null",EMPTY_SIGNAL_CONFIG:"empty_signal_config",INVALID_BUFFER_SIZE:"invalid_buffer_size",INVALID_DURATION:"invalid_duration",SIGNAL_FLAGS_MISSING:"signal_flags_missing",DYNAMIC_SIGNAL_COLLECTION_STARTED:"dynamic_signal_collection_started",BIOMETRIC_SIGNAL_COLLECTION_STARTED:"biometric_signal_collection_started",INVALID_GUID:"invalid_guid",INVALID_LENGTH:"invalid_length",GET_LOCAL_STORAGE_ERROR:"get_local_storage_error",WEB_STORAGE:"web_storage",PARSE_CONFIG_ERROR:"parse_config_error",HB_START_FAILURE:"hb_start_failure",HB_ALREADY_RUNNING:"hb_already_running",TRY_RESTARTING_HB:"try_restarting_hb",BANZAI_LOG_ERROR:"banzai_log_error"},s="JS";i.LEVELS=e,i.OPERATIONS=l,i.COMPONENT_NAME=s}),66);
__d("BDOperationTypedLogger",["Banzai","GeneratedLoggerUtils"],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(){this.$1={}}var t=e.prototype;return t.log=function(t){n("GeneratedLoggerUtils").log("logger:BDOperationLoggerConfig",this.$1,n("Banzai").BASIC,t)},t.logVital=function(t){n("GeneratedLoggerUtils").log("logger:BDOperationLoggerConfig",this.$1,n("Banzai").VITAL,t)},t.logImmediately=function(t){n("GeneratedLoggerUtils").log("logger:BDOperationLoggerConfig",this.$1,{signal:!0},t)},t.clear=function(){return this.$1={},this},t.getData=function(){return babelHelpers.extends({},this.$1)},t.updateData=function(t){return this.$1=babelHelpers.extends({},this.$1,t),this},t.setBdSessionID=function(t){return this.$1.bd_session_id=t,this},t.setComponent=function(t){return this.$1.component=t,this},t.setDurationUs=function(t){return this.$1.duration_us=t,this},t.setExceptionMessage=function(t){return this.$1.exception_message=t,this},t.setExceptionStackTrace=function(t){return this.$1.exception_stack_trace=t,this},t.setExceptionType=function(t){return this.$1.exception_type=t,this},t.setIntValue=function(t){return this.$1.int_value=t,this},t.setLevel=function(t){return this.$1.level=t,this},t.setOperation=function(t){return this.$1.operation=t,this},t.setOperationInfo=function(t){return this.$1.operation_info=n("GeneratedLoggerUtils").serializeMap(t),this},t.setSessionlets=function(t){return this.$1.sessionlets=n("GeneratedLoggerUtils").serializeVector(t),this},e})(),l={bd_session_id:!0,component:!0,duration_us:!0,exception_message:!0,exception_stack_trace:!0,exception_type:!0,int_value:!0,level:!0,operation:!0,operation_info:!0,sessionlets:!0};i.default=e}),66);
__d("BDOperationLogHelper",["BDLoggingConstants","BDOperationTypedLogger","Random"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n,r){c(e,o("BDLoggingConstants").LEVELS.INFO,t,n,r)}function s(e,t,n,r){c(e,o("BDLoggingConstants").LEVELS.WARNING,t,n,r)}function u(e,t,n,r){c(e,o("BDLoggingConstants").LEVELS.ERROR,t,n,r)}function c(e,t,n,a,i){if(a===void 0&&(a={}),o("Random").coinflip(d(n))){if(a===null)throw new Error("opeartion info null");a.source=e,new(r("BDOperationTypedLogger"))().setLevel(t).setDurationUs(i).setOperation(n).setComponent(o("BDLoggingConstants").COMPONENT_NAME).setOperationInfo(a).log()}}function d(e){var t=o("BDLoggingConstants").OPERATIONS;switch(e){case t.APPEND_SIGNAL:case t.HB_COLLECTED:case t.GET_LOCAL_STORAGE_ERROR:case t.WEB_STORAGE:case t.SIGNAL_NOT_IMPLEMENTED:case t.BIOMETRIC_SIGNAL_COLLECTION_STARTED:return 1e3;default:return 1}}l.logInfo=e,l.logWarning=s,l.logError=u,l.log=c,l.getFlipSamplingByOperation=d}),98);
__d("SignalErrorValueTypeDef",[],(function(t,n,r,o,a,i){"use strict";var e="ec",l="en",s="es",u=500,c=(function(){function t(e,t,n){this.$1=e,this.$2=t,n!=null&&(this.$3=n.substr(0,u))}var n=t.prototype;return n.getErrorCode=function(){return this.$1},n.getErrorName=function(){return this.$2},n.getErrorDetails=function(){return this.$3},n.isEqual=function(t){return this.$1===t.getErrorCode()&&this.$3===t.getErrorDetails()&&this.$2===t.getErrorName()},n.toJSON=function(){var t={};switch(t[e]=this.$1,this.$1){case 0:t[l]=this.$2,t[s]=this.$3;break}return t},t})();i.SignalErrorValueTypeDef=c}),66);
__d("SignalValueTypeDef",["BDLoggingConstants","BDOperationLogHelper","SignalErrorValueTypeDef"],(function(t,n,r,o,a,i,l){"use strict";var e="SignalValueTypeDef",s="t",u="ctx",c="v",d="e",m={NUMBER:"NUMBER",STRING:"STRING",BOOLEAN:"BOOLEAN",CUSTOM_OBJECT:"CUSTOM_OBJECT",INT_ARRAY:"INT_ARRAY",TOUCH:"TOUCH",MAP:"MAP",LIST:"LIST",SENSOR:"SENSOR",ERROR:"ERROR"},p=(function(){function t(e,t,n,r,o){this.$1=e,this.$2=t,this.$3=n,this.$4=r,this.$5=o!=null?o:0}var n=t.prototype;return n.getTimeStampMS=function(){return this.$1},n.getSignalContext=function(){return this.$2},n.getSignalValue=function(){return this.$3},n.getSignalValueType=function(){return this.$4},n.isEqual=function(n,r){if(n==null)return o("BDOperationLogHelper").logWarning(e,o("BDLoggingConstants").OPERATIONS.SIGNAL_VALUE_NULL),!1;if(this.getSignalValueType()!==n.getSignalValueType())return!1;if(this.getSignalValueType()===m.ERROR&&n.getSignalValueType()===m.ERROR)return this.equalValue(n);var t=!1;return r.has(128)&&(t=this.equalValue(n)),r.has(256)&&(t=t&&this.getSignalContext()!=null&&n.getSignalContext()!=null&&this.getSignalContext().getSignalValueContextName()===n.getSignalContext().getSignalValueContextName()),r.has(512)&&(t=t&&Math.abs(this.getTimeStampMS()-n.getTimeStampMS())<=this.$5),t},n.equalValue=function(t){if(this.isPrimitiveType())return this.getSignalValue()===t.getSignalValue();throw new Error("Must implement in the subclasses")},n.toJSON=function(t){var e={};return t&&(e[s]=this.$1/1e3,this.$2!=null&&(e[u]=this.$2)),this.$3==null?e[d]=new(o("SignalErrorValueTypeDef")).SignalErrorValueTypeDef(2):this.addValueOrErrorToJSON(e),e},n.addValueOrErrorToJSON=function(t){if(this.isPrimitiveType())t[c]=this.$3;else throw new Error("Must implement in the subclasses")},n.isPrimitiveType=function(){switch(typeof this.$3){case"number":case"boolean":case"string":return!0;default:return!1}},t})();l.BD_VALUE=c,l.BD_ERROR=d,l.VALUE_TYPES=m,l.SignalValueTypeDef=p}),98);
__d("ErrorSignalValueType",["SignalValueTypeDef"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(t,n,r){return e.call(this,t,n,r,o("SignalValueTypeDef").VALUE_TYPES.ERROR)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.equalValue=function(t){return this.getSignalValue().isEqual(t.getSignalValue())},n.addValueOrErrorToJSON=function(t){t[o("SignalValueTypeDef").BD_ERROR]=this.getSignalValue().toJSON()},t})(o("SignalValueTypeDef").SignalValueTypeDef);l.default=e}),98);
__d("NumberSignalValueType",["SignalValueTypeDef"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(t,n,r){return e.call(this,t,n,r,o("SignalValueTypeDef").VALUE_TYPES.NUMBER)||this}return babelHelpers.inheritsLoose(t,e),t})(o("SignalValueTypeDef").SignalValueTypeDef);l.default=e}),98);
__d("BDConnectionRTTSignalCollector",["BDSignalCollectorBase","ErrorSignalValueType","NumberSignalValueType","SignalErrorValueTypeDef"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,u.signalType)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.executeSignalCollection=function(){var e;if(navigator.connection!=null&&navigator.connection.rtt!=null){var t=navigator.connection.rtt;e=new(r("NumberSignalValueType"))(Date.now(),this.getContext(),t)}else e=new(r("ErrorSignalValueType"))(Date.now(),this.getContext(),new(o("SignalErrorValueTypeDef")).SignalErrorValueTypeDef(3,"navigator.connection.rtt not supported"));return{valueOrError:e}},t})(r("BDSignalCollectorBase")),s=null,u={signalType:30004,get:function(){return s==null&&(s=new e),s}},c=u;l.default=c}),98);
__d("CustomObjectSignalValueType",["SignalValueTypeDef"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(t,n,r){return e.call(this,t,n,r,o("SignalValueTypeDef").VALUE_TYPES.CUSTOM_OBJECT)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.equalValue=function(t){return this.getSignalValue().isEqual(t.getSignalValue())},n.addValueOrErrorToJSON=function(t){t[o("SignalValueTypeDef").BD_VALUE]=this.getSignalValue().toJSON()},t})(o("SignalValueTypeDef").SignalValueTypeDef);l.default=e}),98);
__d("HeartbeatObject",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(){this.isAppForeground=!0}var t=e.prototype;return t.toJSON=function(){return{f:this.isAppForeground}},t.isEqual=function(t){return!1},e})();i.default=e}),66);
__d("BDHeartbeatSignalCollector",["BDSignalCollectorBase","CustomObjectSignalValueType","HeartbeatObject"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,u.signalType)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.executeSignalCollection=function(){var e=new(r("CustomObjectSignalValueType"))(Date.now(),this.getContext(),new(r("HeartbeatObject")));return{valueOrError:e}},t})(r("BDSignalCollectorBase")),s=null,u={signalType:38e3,get:function(){return s==null&&(s=new e),s}},c=u;l.default=c}),98);
__d("KeyDownUpObject",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(e,t){this.action=null,this.key_code=null,this.action=e,this.key_code=t}var t=e.prototype;return t.toJSON=function(){return{action:this.action,key_code:this.key_code}},t.isEqual=function(n){return n instanceof e?this.action===n.action&&this.key_code===n.key_code:!1},e})();i.default=e}),66);
__d("BDKeyDownUpSignalCollector",["BDBiometricSignalCollectorBase","CustomObjectSignalValueType","KeyDownUpObject","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,u.signalType)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.listenForSignals=function(){var e=this;r("gkx")("21049")&&(document.addEventListener("keydown",function(t){return e.collectSignals(2)}),document.addEventListener("keyup",function(t){return e.collectSignals(1)}))},n.collectSignals=function(t){var e=new(r("CustomObjectSignalValueType"))(Date.now(),this.getContext(),new(r("KeyDownUpObject"))(t,0)),n={signalId:this.signalType,data:{valueOrError:e}};window.dispatchEvent(new CustomEvent(o("BDBiometricSignalCollectorBase").BIOMETRIC_SIGNAL_COLLECTED_EVENT_NAME,{detail:n}))},t})(o("BDBiometricSignalCollectorBase").BDBiometricSignalCollectorBase),s=null,u={signalType:30100,get:function(){return s==null&&(s=new e),s}},c=u;l.default=c}),98);
__d("StringArrayObject",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(e){this.strings=[],this.strings=e}var t=e.prototype;return t.toJSON=function(){return this.strings},t.isEqual=function(n){if(!(n instanceof e))return!1;if(n.strings===this.strings)return!0;if(n.strings.length!==this.strings.length)return!1;for(var t=0;t<this.strings.length;t++)if(this.strings[t]!==n.strings[t])return!1;return!0},e})();i.default=e}),66);
__d("BDLanguagesSignalCollector",["BDSignalCollectorBase","CustomObjectSignalValueType","StringArrayObject"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,u.signalType)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.executeSignalCollection=function(){var e=[].concat(navigator.languages),t=new(r("CustomObjectSignalValueType"))(Date.now(),this.getContext(),new(r("StringArrayObject"))(e));return{valueOrError:t}},t})(r("BDSignalCollectorBase")),s=null,u={signalType:30003,get:function(){return s==null&&(s=new e),s}},c=u;l.default=c}),98);
__d("BDMimeTypeCountSignalCollector",["BDSignalCollectorBase","NumberSignalValueType"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,u.signalType)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.executeSignalCollection=function(){var e=navigator.mimeTypes?navigator.mimeTypes.length:-1,t=new(r("NumberSignalValueType"))(Date.now(),this.getContext(),e);return{valueOrError:t}},t})(r("BDSignalCollectorBase")),s=null,u={signalType:30002,get:function(){return s==null&&(s=new e),s}},c=u;l.default=c}),98);
__d("BooleanSignalValueType",["SignalValueTypeDef"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(t,n,r){return e.call(this,t,n,r,o("SignalValueTypeDef").VALUE_TYPES.BOOLEAN)||this}return babelHelpers.inheritsLoose(t,e),t})(o("SignalValueTypeDef").SignalValueTypeDef);l.default=e}),98);
__d("BDTouchOrMouseSignalCollectorBase",["BDBiometricSignalCollectorBase","BDLoggingConstants","BDOperationLogHelper","BooleanSignalValueType","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e="BDTouchOrMouseSignalCollectorBase",s=(function(t){function n(e,n,r){var o;return o=t.call(this,e)||this,o.eventsToSubscribe=[],o.pauseTimeout=36e5,o.eventsToSubscribe=n,o.pauseTimeout=r,o.handler=function(e){return o.collectSignals(e)},o}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.listenForSignals=function(){this.collectSignals(),this.addListeners()},a.addListeners=function(){var t=this;this.eventsToSubscribe.forEach(function(n){try{document.addEventListener(n,t.handler)}catch(t){var a=r("getErrorSafe")(t);o("BDOperationLogHelper").logError(e,o("BDLoggingConstants").OPERATIONS.BD_EXCEPTION,{error:a.message})}})},a.pauseListeners=function(){var e=this;this.eventsToSubscribe.forEach(function(t){document.removeEventListener(t,e.handler)}),window.setTimeout(function(){return e.addListeners()},this.pauseTimeout)},a.collectSignals=function(t){var e=t!=null;e&&this.pauseListeners();var n=new(r("BooleanSignalValueType"))(Date.now(),this.getContext(),e),a={signalId:this.signalType,data:{valueOrError:n}};window.dispatchEvent(new CustomEvent(o("BDBiometricSignalCollectorBase").BIOMETRIC_SIGNAL_COLLECTED_EVENT_NAME,{detail:a}))},n})(o("BDBiometricSignalCollectorBase").BDBiometricSignalCollectorBase);l.default=s}),98);
__d("BDMousePresenceSignalCollector",["BDTouchOrMouseSignalCollectorBase"],(function(t,n,r,o,a,i,l){"use strict";var e=36e5,s=(function(t){function n(){return t.call(this,c.signalType,["mousedown","mousemove"],e)||this}return babelHelpers.inheritsLoose(n,t),n})(r("BDTouchOrMouseSignalCollectorBase")),u=null,c={signalType:30106,get:function(){return u==null&&(u=new s),u}},d=c;l.default=d}),98);
__d("StringSignalValueType",["SignalValueTypeDef"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(t,n,r){return e.call(this,t,n,r,o("SignalValueTypeDef").VALUE_TYPES.STRING)||this}return babelHelpers.inheritsLoose(t,e),t})(o("SignalValueTypeDef").SignalValueTypeDef);l.default=e}),98);
__d("BDNavigatorAppVersionSignalCollector",["BDSignalCollectorBase","StringSignalValueType"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,u.signalType)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.executeSignalCollection=function(){var e=navigator.appVersion,t=new(r("StringSignalValueType"))(Date.now(),this.getContext(),e);return{valueOrError:t}},t})(r("BDSignalCollectorBase")),s=null,u={signalType:30013,get:function(){return s==null&&(s=new e),s}},c=u;l.default=c}),98);
__d("BDNavigatorHardwareConcurrencySignalCollector",["BDSignalCollectorBase","NumberSignalValueType"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,u.signalType)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.executeSignalCollection=function(){var e,t=new(r("NumberSignalValueType"))(Date.now(),this.getContext(),(e=navigator.hardwareConcurrency)!=null?e:0);return{valueOrError:t}},t})(r("BDSignalCollectorBase")),s=null,u={signalType:30018,get:function(){return s==null&&(s=new e),s}},c=u;l.default=c}),98);
__d("BDNavigatorMaxTouchPointSignalCollector",["BDSignalCollectorBase","NumberSignalValueType"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,u.signalType)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.executeSignalCollection=function(){var e=new(r("NumberSignalValueType"))(Date.now(),this.getContext(),navigator.maxTouchPoints);return{valueOrError:e}},t})(r("BDSignalCollectorBase")),s=null,u={signalType:30093,get:function(){return s==null&&(s=new e),s}},c=u;l.default=c}),98);
__d("BDNavigatorNotificationPermissionSignalCollector",["BDSignalCollectorBase","ErrorSignalValueType","SignalErrorValueTypeDef","StringSignalValueType"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,u.signalType)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.executeAsyncSignalCollection=async function(){var e;try{if(navigator.permissions){var t=await navigator.permissions.query({name:"notifications"});e=new(r("StringSignalValueType"))(Date.now(),this.getContext(),t.state)}else e=new(r("ErrorSignalValueType"))(Date.now(),this.getContext(),new(o("SignalErrorValueTypeDef")).SignalErrorValueTypeDef(3,"navigator.permissions not supported"))}catch(t){e=new(r("ErrorSignalValueType"))(Date.now(),this.getContext(),new(o("SignalErrorValueTypeDef")).SignalErrorValueTypeDef(3,"notifications cannot be queried from navigator.permissions"))}return{valueOrError:e}},t})(r("BDSignalCollectorBase")),s=null,u={signalType:30008,get:function(){return s==null&&(s=new e),s}},c=u;l.default=c}),98);
__d("BDNavigatorPlatformSignalCollector",["BDSignalCollectorBase","StringSignalValueType"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,u.signalType)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.executeSignalCollection=function(){var e=new(r("StringSignalValueType"))(Date.now(),this.getContext(),navigator.platform);return{valueOrError:e}},t})(r("BDSignalCollectorBase")),s=null,u={signalType:30015,get:function(){return s==null&&(s=new e),s}},c=u;l.default=c}),98);
__d("BDNavigatorPluginsFileExtensionsSignalCollector",["BDSignalCollectorBase","ErrorSignalValueType","SignalErrorValueTypeDef","StringArrayObject"],(function(t,n,r,o,a,i,l){"use strict";var e=10,s=(function(t){function n(){return t.call(this,c.signalType)||this}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.executeSignalCollection=function(){var t=null;try{for(var n=navigator.plugins?navigator.plugins.length:0,a=new Set,i=0;i<n;i++){var l=navigator.plugins[i].filename;if(l){var s=l.indexOf(".");if(!(s==-1||s==l.length-1)&&(a.add(l.substr(s+1)),a.size>=e))break}}a.size&&(t=new(r("StringArrayObject"))(Array.from(a)))}catch(e){t=new(r("ErrorSignalValueType"))(Date.now(),this.getContext(),new(o("SignalErrorValueTypeDef")).SignalErrorValueTypeDef(3,"navigator.plugins is not defined"))}return{valueOrError:t}},n})(r("BDSignalCollectorBase")),u=null,c={signalType:30019,get:function(){return u==null&&(u=new s),u}},d=c;l.default=d}),98);
__d("BDNavigatorUserAgentSignalCollector",["BDSignalCollectorBase","StringSignalValueType"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,u.signalType)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.executeSignalCollection=function(){var e=new(r("StringSignalValueType"))(Date.now(),this.getContext(),navigator.userAgent);return{valueOrError:e}},t})(r("BDSignalCollectorBase")),s=null,u={signalType:30094,get:function(){return s==null&&(s=new e),s}},c=u;l.default=c}),98);
__d("BDNavigatorVendorSignalCollector",["BDSignalCollectorBase","StringSignalValueType"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,u.signalType)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.executeSignalCollection=function(){var e=navigator.vendor,t=new(r("StringSignalValueType"))(Date.now(),this.getContext(),e);return{valueOrError:t}},t})(r("BDSignalCollectorBase")),s=null,u={signalType:30012,get:function(){return s==null&&(s=new e),s}},c=u;l.default=c}),98);
__d("BDNotificationPermissionSignalCollector",["BDSignalCollectorBase","ErrorSignalValueType","SignalErrorValueTypeDef","StringSignalValueType"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,u.signalType)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.executeSignalCollection=function(){var e;return window.Notification?e=new(r("StringSignalValueType"))(Date.now(),this.getContext(),Notification.permission):e=new(r("ErrorSignalValueType"))(Date.now(),this.getContext(),new(o("SignalErrorValueTypeDef")).SignalErrorValueTypeDef(3,"Notification not supported")),{valueOrError:e}},t})(r("BDSignalCollectorBase")),s=null,u={signalType:30007,get:function(){return s==null&&(s=new e),s}},c=u;l.default=c}),98);
__d("BDPluginCountSignalCollector",["BDSignalCollectorBase","NumberSignalValueType"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,u.signalType)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.executeSignalCollection=function(){var e=navigator.plugins?navigator.plugins.length:-1,t=new(r("NumberSignalValueType"))(Date.now(),this.getContext(),e);return{valueOrError:t}},t})(r("BDSignalCollectorBase")),s=null,u={signalType:30001,get:function(){return s==null&&(s=new e),s}},c=u;l.default=c}),98);
__d("BDTimezoneOffsetSignalCollector",["BDSignalCollectorBase","NumberSignalValueType"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,u.signalType)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.executeSignalCollection=function(){var e,t=new(r("NumberSignalValueType"))(Date.now(),this.getContext(),(e=new Date().getTimezoneOffset())!=null?e:999);return{valueOrError:t}},t})(r("BDSignalCollectorBase")),s=null,u={signalType:30040,get:function(){return s==null&&(s=new e),s}},c=u;l.default=c}),98);
__d("BDTouchPresenceSignalCollector",["BDTouchOrMouseSignalCollectorBase"],(function(t,n,r,o,a,i,l){"use strict";var e=36e5,s=(function(t){function n(){return t.call(this,c.signalType,["touchstart","touchcancel"],e)||this}return babelHelpers.inheritsLoose(n,t),n})(r("BDTouchOrMouseSignalCollectorBase")),u=null,c={signalType:30107,get:function(){return u==null&&(u=new s),u}},d=c;l.default=d}),98);
__d("BDWebdriverSignalCollector",["BDSignalCollectorBase","BooleanSignalValueType"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,u.signalType)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.executeSignalCollection=function(){var e=!!navigator.webdriver,t=new(r("BooleanSignalValueType"))(Date.now(),this.getContext(),e);return{valueOrError:t}},t})(r("BDSignalCollectorBase")),s=null,u={signalType:3e4,get:function(){return s==null&&(s=new e),s}},c=u;l.default=c}),98);
__d("BDWebglSupportSignalCollector",["BDSignalCollectorBase","BooleanSignalValueType"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,u.signalType)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.executeSignalCollection=function(){var e=document.createElement("canvas"),t=null;try{t=e.getContext("webgl")||e.getContext("experimental-webgl")}catch(e){}var n=!!t,o=new(r("BooleanSignalValueType"))(Date.now(),this.getContext(),n);return{valueOrError:o}},t})(r("BDSignalCollectorBase")),s=null,u={signalType:30022,get:function(){return s==null&&(s=new e),s}},c=u;l.default=c}),98);
__d("BDWindowHistoryLengthSignalCollector",["BDSignalCollectorBase","NumberSignalValueType"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,u.signalType)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.executeSignalCollection=function(){var e=new(r("NumberSignalValueType"))(Date.now(),this.getContext(),window.history?window.history.length:0);return{valueOrError:e}},t})(r("BDSignalCollectorBase")),s=null,u={signalType:30095,get:function(){return s==null&&(s=new e),s}},c=u;l.default=c}),98);
__d("DimensionObject",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(e,t){this.width=null,this.height=null,this.width=e,this.height=t}var t=e.prototype;return t.toJSON=function(){return{w:this.width,h:this.height}},t.isEqual=function(n){return n instanceof e?this.width===n.width&&this.height===n.height:!1},e})();i.default=e}),66);
__d("BDWindowOuterDimensionSignalCollector",["BDSignalCollectorBase","CustomObjectSignalValueType","DimensionObject"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,u.signalType)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.executeSignalCollection=function(){var e=window.innerHeight,t=window.innerWidth,n=new(r("CustomObjectSignalValueType"))(Date.now(),this.getContext(),new(r("DimensionObject"))(t,e));return{valueOrError:n}},t})(r("BDSignalCollectorBase")),s=null,u={signalType:30005,get:function(){return s==null&&(s=new e),s}},c=u;l.default=c}),98);
__d("SignalCollectorMap",["BDConnectionRTTSignalCollector","BDHeartbeatSignalCollector","BDHeartbeatV2SignalCollector","BDKeyDownUpSignalCollector","BDLanguagesSignalCollector","BDMimeTypeCountSignalCollector","BDMousePresenceSignalCollector","BDNavigatorAppVersionSignalCollector","BDNavigatorHardwareConcurrencySignalCollector","BDNavigatorMaxTouchPointSignalCollector","BDNavigatorNotificationPermissionSignalCollector","BDNavigatorPlatformSignalCollector","BDNavigatorPluginsFileExtensionsSignalCollector","BDNavigatorUserAgentSignalCollector","BDNavigatorVendorSignalCollector","BDNotificationPermissionSignalCollector","BDPluginCountSignalCollector","BDTimezoneOffsetSignalCollector","BDTouchPresenceSignalCollector","BDWebdriverSignalCollector","BDWebglSupportSignalCollector","BDWindowHistoryLengthSignalCollector","BDWindowOuterDimensionSignalCollector"],(function(t,n,r,o,a,i,l){"use strict";var e={get:function(t){switch(t){case 3e4:return r("BDWebdriverSignalCollector").get();case 30001:return r("BDPluginCountSignalCollector").get();case 30002:return r("BDMimeTypeCountSignalCollector").get();case 30003:return r("BDLanguagesSignalCollector").get();case 30004:return r("BDConnectionRTTSignalCollector").get();case 30005:return r("BDWindowOuterDimensionSignalCollector").get();case 30007:return r("BDNotificationPermissionSignalCollector").get();case 30008:return r("BDNavigatorNotificationPermissionSignalCollector").get();case 30012:return r("BDNavigatorVendorSignalCollector").get();case 30013:return r("BDNavigatorAppVersionSignalCollector").get();case 30015:return r("BDNavigatorPlatformSignalCollector").get();case 30018:return r("BDNavigatorHardwareConcurrencySignalCollector").get();case 30019:return r("BDNavigatorPluginsFileExtensionsSignalCollector").get();case 30022:return r("BDWebglSupportSignalCollector").get();case 30040:return r("BDTimezoneOffsetSignalCollector").get();case 30093:return r("BDNavigatorMaxTouchPointSignalCollector").get();case 30094:return r("BDNavigatorUserAgentSignalCollector").get();case 30095:return r("BDWindowHistoryLengthSignalCollector").get();case 30100:return r("BDKeyDownUpSignalCollector").get();case 30106:return r("BDMousePresenceSignalCollector").get();case 30107:return r("BDTouchPresenceSignalCollector").get();case 38e3:return r("BDHeartbeatSignalCollector").get();case 38001:return r("BDHeartbeatV2SignalCollector").get()}}},s=e;l.default=s}),98);
__d("HeartbeatV2Object",["HeartbeatObject"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(t){var n;return n=e.call(this)||this,n.id="",n.id=t,n}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.toJSON=function(){return{f:this.isAppForeground,id:this.id}},t})(r("HeartbeatObject"));l.default=e}),98);
__d("BDHeartbeatV2SignalCollector",["BDClientConfig","BDSignalCollectorBase","CustomObjectSignalValueType","HeartbeatV2Object"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.call(this,u.signalType)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.executeSignalCollection=function(){var e=new(r("CustomObjectSignalValueType"))(Date.now(),this.getContext(),new(r("HeartbeatV2Object"))(r("BDClientConfig").get().getHeartbeatVersion()));return{valueOrError:e}},t})(r("BDSignalCollectorBase")),s=null,u={signalType:38001,get:function(){return s==null&&(s=new e),s}},c=u;l.default=c}),98);
__d("BDClientConfig",["BDLoggingConstants","BDOperationLogHelper","BDSignalWrapper"],(function(t,n,r,o,a,i,l){"use strict";var e="BDClientConfig",s=(function(){function t(){this.staticSignalBufferSize=1,this.dynamicSignalBufferSize=1,this.biometricSignalBufferSize=1,this.staticSignals=[],this.dynamicSignals=[],this.biometricSignals=[],this.biometricSignalsMap=new Map,this.heartbeatSignal=new(r("BDSignalWrapper"))([],38001),this.bufferSizeBySignalIdMap={},this.periodicCollectionIntervalMs=Number.MAX_SAFE_INTEGER,this.signalConfigGenerationTimeStampMs=0,this.suspiciousTiersFlushDurationMs=Number.MAX_SAFE_INTEGER,this.allTiersFlushDurationMs=Number.MAX_SAFE_INTEGER,this.heartbeatIntervalMs=-1,this.parsingDone=!1,this.sid=-1,this.hbVersion="",this.bufferSizeBySignalIdMap[38001]=1}var n=t.prototype;return n.setStaticSignalBufferSize=function(n){return n>0?this.staticSignalBufferSize=n:o("BDOperationLogHelper").logError(e,o("BDLoggingConstants").OPERATIONS.INVALID_BUFFER_SIZE,{size:n.toString(),type:"s"}),this},n.getStaticSignalBufferSize=function(){return this.staticSignalBufferSize},n.setDynamicSignalBufferSize=function(n){return n>1?this.dynamicSignalBufferSize=n:o("BDOperationLogHelper").logError(e,o("BDLoggingConstants").OPERATIONS.INVALID_BUFFER_SIZE,{size:n.toString(),type:"d"}),this},n.getDynamicSignalBufferSize=function(){return this.dynamicSignalBufferSize},n.setBiometricSignalBufferSize=function(n){return n>1?this.biometricSignalBufferSize=n:o("BDOperationLogHelper").logError(e,o("BDLoggingConstants").OPERATIONS.INVALID_BUFFER_SIZE,{size:n.toString(),type:"b"}),this},n.setSID=function(t){return this.sid=t,this},n.setHeartbeatVersion=function(t){return this.hbVersion=t,this},n.getHeartbeatVersion=function(){return this.hbVersion},n.getBiometricSignalBufferSize=function(){return this.biometricSignalBufferSize},n.setConfigGenerationTimeStamp=function(t){return this.signalConfigGenerationTimeStampMs=t,this},n.getConfigGenerationTimeStamp=function(){return this.signalConfigGenerationTimeStampMs},n.setHeartbeatIntervalMinutes=function(t){return this.heartbeatIntervalMs=t*60*1e3,this},n.getHeartbeatIntervalMs=function(){return this.heartbeatIntervalMs},n.setSuspiciousTiersFlushDurationMinutes=function(n){return n>0?this.suspiciousTiersFlushDurationMs=n*60*1e3:o("BDOperationLogHelper").logError(e,o("BDLoggingConstants").OPERATIONS.INVALID_DURATION,{size:n.toString(),type:"fds"}),this},n.getSuspiciousTiersFlushDurationMs=function(){return this.suspiciousTiersFlushDurationMs},n.setAllTiersFlushDurationMinutes=function(n){return n>0?this.allTiersFlushDurationMs=n*60*1e3:o("BDOperationLogHelper").logError(e,o("BDLoggingConstants").OPERATIONS.INVALID_DURATION,{size:n.toString(),type:"fda"}),this},n.getAllTiersFlushDurationMs=function(){return this.allTiersFlushDurationMs},n.addMultipleSignalsToClientConfig=function(t){var e=this;return t.forEach(function(t){return e.addSignalToClientConfig(t)}),this},n.addSignalToClientConfig=function(t){var e=t.getSignalFlags(),n=t.getSignalId();if(n===38e3)return this;var o=new(r("BDSignalWrapper"))(e,n);return n===38001?(this.heartbeatSignal=o,this):(e.includes(2)?e.includes(4)?this.biometricSignals.push(o):this.dynamicSignals.push(o):this.staticSignals.push(o),t.getBufferSize()>0&&(this.bufferSizeBySignalIdMap[t.getSignalId()]=t.getBufferSize()),this)},n.setPeriodicCollectionIntervalSeconds=function(n){return n>0?this.periodicCollectionIntervalMs=n*1e3:o("BDOperationLogHelper").logError(e,o("BDLoggingConstants").OPERATIONS.INVALID_DURATION,{size:n.toString(),type:"pi"}),this},n.getPeriodicCollectionIntervalMs=function(){return this.periodicCollectionIntervalMs},n.getDynamicSignals=function(){return this.dynamicSignals},n.getStaticSignals=function(){return this.staticSignals},n.getBiometricSignals=function(){return this.biometricSignals},n.getBiometricSignalsMap=function(){return this.biometricSignalsMap.size===0&&this.biometricSignals.length>0&&(this.biometricSignalsMap=this.biometricSignals.reduce(function(e,t){return e.set(t.signalType,t)},new Map)),this.biometricSignalsMap},n.getHeartbeatSignal=function(){return this.heartbeatSignal},n.getBufferSizeBySignalId=function(t){return this.bufferSizeBySignalIdMap[t]},n.setParsingDone=function(t){this.parsingDone=t},n.isParsingDone=function(){return this.parsingDone},t})(),u=null,c={get:function(){return u==null&&(u=new s),u}},d=c;l.default=d}),98);
__d("BDCollectionTypeEnum",[],(function(t,n,r,o,a,i){"use strict";var e=Object.freeze({STATIC:0,DYNAMIC:1,BIOMETRIC:2});i.default=e}),66);
__d("BotDetection_SignalFlags",[],(function(t,n,r,o,a,i){var e=Object.freeze({ACTIVE:1,DYNAMIC:2,BIOMETRIC:4,DEPRECATED:8,WEB:16,IOS_NATIVE:32,ANDROID_NATIVE:64,EQUAL_BY_VALUE:128,EQUAL_BY_CONTEXT:256,EQUAL_BY_TIMESTAMP:512,SUSPICIOUS_TIER:1024,PARANOID_TIER:2048,RANDOM_SAMPLE_TIER_DEPRECATED:4096,BENIGN_TIER:262144,EMPLOYEES_TIER:524288,BUNDLE:8192,ONSITE:16384,OFFSITE:32768,OFFSITE_SENSITIVE:65536,SENSITIVE:131072});i.default=e}),66);
__d("BDServerSignalConfig",["BDLoggingConstants","BDOperationLogHelper","BotDetection_SignalFlags"],(function(t,n,r,o,a,i,l){"use strict";var e="BDServerSignalConfig",s=(function(){function t(e,t,n){this.parsedSignalFlags=[],this.signalId=e,this.signalFlags=t,this.bufferSize=n}var n=t.prototype;return n.getSignalId=function(){return this.signalId},n.getSignalFlags=function(){var t=this;if(this.parsedSignalFlags.length===0){var n=Object.keys(r("BotDetection_SignalFlags"));n.forEach(function(e){(r("BotDetection_SignalFlags")[e]&t.signalFlags)===r("BotDetection_SignalFlags")[e]&&t.parsedSignalFlags.push(r("BotDetection_SignalFlags")[e])})}return this.parsedSignalFlags.length===0&&o("BDOperationLogHelper").logError(e,o("BDLoggingConstants").OPERATIONS.SIGNAL_FLAGS_MISSING,{id:this.signalId.toString(),flags:this.signalFlags.toString()}),this.parsedSignalFlags},n.getBufferSize=function(){return this.bufferSize!=null?this.bufferSize:0},t})();l.default=s}),98);
__d("BDServerConfig",["BDClientConfig","BDLoggingConstants","BDOperationLogHelper","BDServerSignalConfig","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e="BDServerConfig";function s(t){var n=[];try{var a=JSON.parse(t.sc),i=new Map(a.c);if(i.forEach(function(e,t){return n.push(new(r("BDServerSignalConfig"))(t,e))}),i.size===0){o("BDOperationLogHelper").logError(e,o("BDLoggingConstants").OPERATIONS.EMPTY_SIGNAL_CONFIG);return}var l=r("BDClientConfig").get();l.setPeriodicCollectionIntervalSeconds(t.i).addMultipleSignalsToClientConfig(n).setConfigGenerationTimeStamp(a.t).setAllTiersFlushDurationMinutes(t.fda).setSuspiciousTiersFlushDurationMinutes(t.fds).setHeartbeatIntervalMinutes(t.hbi).setStaticSignalBufferSize(t.sbs).setDynamicSignalBufferSize(t.dbs).setBiometricSignalBufferSize(t.bbs).setSID(t.sid).setHeartbeatVersion(t.hbv).setParsingDone(!0)}catch(t){var s=r("getErrorSafe")(t);o("BDOperationLogHelper").logError(e,o("BDLoggingConstants").OPERATIONS.PARSE_CONFIG_ERROR,{e:s.message})}}l.parseConfig=s}),98);
__d("BDSignalBuffer",["BDClientConfig","BDCollectionTypeEnum","BDLoggingConstants","BDOperationLogHelper","BDSignalBufferData"],(function(t,n,r,o,a,i,l){"use strict";var e="BDSignalBuffer";function s(e,t,n){if(!(e in r("BDSignalBufferData"))){var o=1;t!==void 0&&(o=t),r("BDSignalBufferData")[e]={values:[],max_buffer_size:o,signal_flags:n!=null?n:[]}}}function u(e){if(e in r("BDSignalBufferData"))r("BDSignalBufferData")[e].values=[];else throw new Error("Tried to clear signal buffer that was not intialized:")}function c(t,n){if(t in r("BDSignalBufferData")){var a=r("BDSignalBufferData")[t],i=a.max_buffer_size;a.values.length>=i&&a.values.shift(),a.values.push(n),o("BDOperationLogHelper").logInfo(e,o("BDLoggingConstants").OPERATIONS.APPEND_SIGNAL,{id:t.toString()})}else throw o("BDOperationLogHelper").logError(e,o("BDLoggingConstants").OPERATIONS.APPEND_SIGNAL_FAIL,{id:t.toString()}),new Error("Tried to append signal that was not intialized:")}function d(){var e=r("BDClientConfig").get(),t=e.getBiometricSignals();t.forEach(function(e){e.signalType in r("BDSignalBufferData")&&u(e.signalType)})}function m(e){var t,n=r("BDSignalBufferData")[e],o=n==null||(t=n.values)==null?void 0:t.length;return o!=null&&o>0?n.values[o-1]:{valueOrError:void 0}}function p(e){return r("BDSignalBufferData")[e].values}function _(e){var t={};for(var n of e)n in r("BDSignalBufferData")&&(t[n]=p(n).map(function(e){return e.valueOrError}));return t}function f(e){var t=g(e);return JSON.stringify(_(t))}function g(e){var t=r("BDClientConfig").get(),n=[];return e.forEach(function(e){switch(e){case r("BDCollectionTypeEnum").STATIC:n=[].concat(n,t.getStaticSignals());break;case r("BDCollectionTypeEnum").DYNAMIC:n=[].concat(n,t.getDynamicSignals());break;case r("BDCollectionTypeEnum").BIOMETRIC:n=[].concat(n,t.getBiometricSignals());break}}),n.map(function(e){return e.signalType})}l.initialize=s,l.clearBuffer=u,l.appendSignal=c,l.clearBiometricSignals=d,l.getLastSignalFormatBySignalId=m,l.retrieveSignal=p,l.retrieveSignals=_,l.getSignalsAsJSONString=f,l._getSignalIdsByCollectionType=g}),98);
__d("BDUtils",[],(function(t,n,r,o,a,i){"use strict";function e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,n=e=="x"?t:t&3|8;return n.toString(16)})}i.uuid=e}),66);
__d("BdPdcSignalsFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("1743095"),s=o("FalcoLoggerInternal").create("bd_pdc_signals",e),u=s;l.default=u}),98);
__d("SignalCollectionManager",["BDBiometricSignalCollectorBase","BDClientConfig","BDLoggingConstants","BDOperationLogHelper","BDSignalBuffer","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e="SignalCollectionManager",s=(function(){function t(){var e=this;this.$1=!1,this.$6=function(t){if(t instanceof CustomEvent&&t.detail!=null&&t.detail.data!=null){var n=r("BDClientConfig").get().getBiometricSignalsMap().get(t.detail.signalId);n!=null&&e.$4(t.detail.data,n)}}}var n=t.prototype;return n.collectSignals=async function(t){var e=this,n=[];t.forEach(function(t){t.signalFlags.includes(4)?e.$2(t):n.push(e.$3(t))}),await Promise.all(n)},n.isEqualToLastCollectedSignal=function(t,n){var e=o("BDSignalBuffer").getLastSignalFormatBySignalId(n.signalType);return e.valueOrError==null?!1:t.isEqual(e.valueOrError,new Set(n.signalFlags))},n.getCircularBufferSize=function(t){var e=r("BDClientConfig").get(),n=e.getBufferSizeBySignalId(t.signalType);return n!=null&&e.getBufferSizeBySignalId(t.signalType)>0?n:t.signalFlags.includes(2)?t.signalFlags.includes(4)?e.getBiometricSignalBufferSize():e.getDynamicSignalBufferSize():e.getStaticSignalBufferSize()},n.$3=async function(n){var t=n.getSignalCollector();if(t!=null)try{var a=await t.executeAsyncSignalCollection();this.$4(a,n)}catch(t){o("BDOperationLogHelper").logError(e,o("BDLoggingConstants").OPERATIONS.BD_EXCEPTION,{error:r("getErrorSafe")(t).message})}},n.$2=function(t){this.$5();var e=t.getSignalCollector();e!=null&&e instanceof o("BDBiometricSignalCollectorBase").BDBiometricSignalCollectorBase&&e.listenForSignals()},n.$5=function(){this.$1||(window.addEventListener(o("BDBiometricSignalCollectorBase").BIOMETRIC_SIGNAL_COLLECTED_EVENT_NAME,this.$6),this.$1=!0)},n.$4=function(t,n){n.getBufferConfig()==null&&o("BDSignalBuffer").initialize(n.signalType,this.getCircularBufferSize(n),n.signalFlags),t.valueOrError&&!this.isEqualToLastCollectedSignal(t.valueOrError,n)&&o("BDSignalBuffer").appendSignal(n.signalType,t)},t})(),u=null,c={get:function(){return u==null&&(u=new s),u}},d=c;l.default=d}),98);
__d("BDClientSignalCollectionTrigger",["BDClientConfig","BDCollectionTypeEnum","BDLoggingConstants","BDOperationLogHelper","BDServerConfig","BDSignalBuffer","BDUtils","BdPdcSignalsFalcoEvent","SignalCollectionManager","WebStorage","getErrorSafe","javascript-blowfish"],(function(t,n,r,o,a,i,l){"use strict";var e,s="BDClientSignalCollectionTrigger",u="signal_flush_timestamp",c=!1,d=!1,m=!1,p=!1,_=0,f=0,g=0,h=30,y=5,C,b,v=o("BDUtils").uuid(),S=r("BDClientConfig").get(),R=Object.freeze({NONE:0,VITAL:1,CRITICAL:2}),L={startSignalCollection:async function(t){if(S.setSID(t.sid),!c){if(c=!0,o("BDServerConfig").parseConfig(t),!S.isParsingDone()){o("BDOperationLogHelper").logError(s,o("BDLoggingConstants").OPERATIONS.PARSE_CONFIG_ERROR,{config:JSON.stringify(t)}),c=!1;return}t!=null&&(f=t.hbcbc&&t.hbcbc>0?t.hbcbc:f,g=t.hbvbc&&t.hbvbc>0?t.hbvbc:g,h=t.hbbi&&t.hbbi>0?t.hbbi:h),L.startHeartbeatDelayed(),b=new Promise(function(e,t){try{S.getDynamicSignals().length>0&&(L.collectDynamicSignals(),o("BDOperationLogHelper").logInfo(s,o("BDLoggingConstants").OPERATIONS.DYNAMIC_SIGNAL_COLLECTION_STARTED,{ts:Date.now().toString()})),S.getBiometricSignals().length>0&&(L.collectBiometricSignals(),o("BDOperationLogHelper").logInfo(s,o("BDLoggingConstants").OPERATIONS.BIOMETRIC_SIGNAL_COLLECTION_STARTED,{ts:Date.now().toString()})),e()}catch(e){t(e)}}),await b,await L.startSignalPosting()}c&&!m&&!p&&y>0&&(y-=1,o("BDOperationLogHelper").logWarning(s,o("BDLoggingConstants").OPERATIONS.TRY_RESTARTING_HB),L.startHeartbeatDelayed())},retrieveSignals:async function(){await b,await L.postSignals([r("BDCollectionTypeEnum").DYNAMIC,r("BDCollectionTypeEnum").BIOMETRIC,r("BDCollectionTypeEnum").STATIC])},retrieveSignalsSkipLogging:async function(){await b,await L.collectStaticSignals()},postSignals:async function(t){await L.collectStaticSignals(),L._postSignalsHelper(o("BDSignalBuffer").getSignalsAsJSONString(t),R.NONE)&&L.setTimestampInStorage(Date.now(),u)},_postSignalsHelper:function(t,n){if(t.length<=2)return!1;var e=S.getConfigGenerationTimeStamp(),a=L.encryptDataUsingAsid(v,t),i=function(){return{asid:v,ct:e,sjd:a,sid:S.sid}},l=!1;try{n===R.CRITICAL?r("BdPdcSignalsFalcoEvent").logCritical(i):n===R.VITAL?r("BdPdcSignalsFalcoEvent").logImmediately(i):r("BdPdcSignalsFalcoEvent").log(i),l=!0}catch(e){var u=r("getErrorSafe")(e);o("BDOperationLogHelper").logError(s,o("BDLoggingConstants").OPERATIONS.BANZAI_LOG_ERROR,{error:u.message}),l=!1}finally{return l}},getInitialVector:function(t){if(t.length!==16)return o("BDOperationLogHelper").logError(s,o("BDLoggingConstants").OPERATIONS.INVALID_LENGTH),"";for(var e="",n=0;n<8;n++)e+=String.fromCharCode(t.charCodeAt(n)^t.charCodeAt(8+n));return e},encryptDataUsingAsid:function(t,n){if(t.length!==36)return o("BDOperationLogHelper").logError(s,o("BDLoggingConstants").OPERATIONS.INVALID_GUID),n;var e=t.slice(19,23)+t.slice(24,36),a=L.getInitialVector(e),i=new(r("javascript-blowfish"))(e,"cbc");return i.base64Encode(i.encrypt(n,a))},startSignalPosting:async function(){var e=L.getTimestampInStorage(u),t=Date.now()-e;t>=S.getAllTiersFlushDurationMs()?await L.postSignalsIntermittently():window.setTimeout(function(){L.postSignalsIntermittently()},S.getAllTiersFlushDurationMs()-t)},postSignalsIntermittently:function(){L.postSignals([r("BDCollectionTypeEnum").STATIC]),window.setInterval(function(){L.postSignals([r("BDCollectionTypeEnum").STATIC,r("BDCollectionTypeEnum").DYNAMIC,r("BDCollectionTypeEnum").BIOMETRIC])},S.getAllTiersFlushDurationMs())},setTimestampInStorage:function(n,a){var t=(e||(e=r("WebStorage"))).getLocalStorage();if(!t){o("BDOperationLogHelper").logWarning(s,o("BDLoggingConstants").OPERATIONS.GET_LOCAL_STORAGE_ERROR);return}var i=e.setItemGuarded(t,a,n.toString());i!=null&&o("BDOperationLogHelper").logWarning(s,o("BDLoggingConstants").OPERATIONS.WEB_STORAGE,{error:i.message})},getTimestampInStorage:function(n){var t=(e||(e=r("WebStorage"))).getLocalStorage();if(!t)return o("BDOperationLogHelper").logWarning(s,o("BDLoggingConstants").OPERATIONS.GET_LOCAL_STORAGE_ERROR),0;var a=t.getItem(n);if(a==null)return 0;var i=Number.parseInt(a,10);return Number.isFinite(i)?i:0},resetHeartbeatStartedForTest:function(){m=!1,p=!1},startHeartbeatDelayed:function(){if(!(m||p)){var e=L.getTimestampInStorage(L.HEARTBEAT_TIMESTAMP_STORAGE_KEY),t=Date.now()-e;try{t>=S.getHeartbeatIntervalMs()?L.startHeartbeat():(window.setTimeout(function(){return L.startHeartbeat()},S.getHeartbeatIntervalMs()-t),p=!0)}catch(e){var n=r("getErrorSafe")(e);o("BDOperationLogHelper").logError(s,o("BDLoggingConstants").OPERATIONS.HB_START_FAILURE,{lastBeatSince:t.toString(),hbi:S.getHeartbeatIntervalMs().toString(),error:n.message})}}},HEARTBEAT_TIMESTAMP_STORAGE_KEY:"hb_timestamp",startHeartbeat:function(){!m&&S.getHeartbeatIntervalMs()>0&&(L.collectHeartbeatTimes(f,g),_!==0&&(window.clearInterval(_),o("BDOperationLogHelper").logWarning(s,o("BDLoggingConstants").OPERATIONS.HB_ALREADY_RUNNING)),_=window.setInterval(function(){return L.collectHeartbeatTimes(f,g)},S.getHeartbeatIntervalMs()),m=!0)},collectHeartbeatTimes:function(t,n){t<=0&&n<=0||(t>0&&L.collectHeartbeat(R.CRITICAL),n>0&&L.collectHeartbeat(R.VITAL),(t>1||n>1)&&window.setTimeout(function(){return L.collectHeartbeatTimes(t-1,n-1)},h*1e3))},collectHeartbeat:function(t){var e,n=S==null||(e=S.getHeartbeatSignal())==null||(e=e.getSignalCollector())==null?void 0:e.executeSignalCollection();if(n==null){o("BDOperationLogHelper").logError(s,o("BDLoggingConstants").OPERATIONS.HB_COLLECTION_FAILED,{urgency:t.toString()});return}else o("BDOperationLogHelper").logInfo(s,o("BDLoggingConstants").OPERATIONS.HB_COLLECTED,{urgency:t.toString()});L.postHeartbeat(t,n)&&L.setTimestampInStorage(Date.now(),L.HEARTBEAT_TIMESTAMP_STORAGE_KEY)},postHeartbeat:function(t,n){var e={};e[38001]=[n==null?void 0:n.valueOrError];var r=JSON.stringify(e);return L._postSignalsHelper(r,t)},collectStaticSignals:async function(){await L.collectSignalsOneTime(S.getStaticSignals())},collectDynamicSignals:function(){L.stopDynamicSignalCollection(),C=window.setInterval(async function(){await L.collectSignalsOneTime(S.getDynamicSignals())},S.getPeriodicCollectionIntervalMs())},collectBiometricSignals:function(){L.collectSignalsOneTime(S.getBiometricSignals())},stopDynamicSignalCollection:function(){C!=null&&(window.clearInterval(C),C=null)},collectSignalsOneTime:async function(t){await r("SignalCollectionManager").get().collectSignals(t)},startLoginTimeSignalCollection:async function(t){d||(d=!0,o("BDServerConfig").parseConfig(t),await L.collectSignalsOneTime(S.getDynamicSignals()),await L.collectSignalsOneTime(S.getBiometricSignals()),await L.collectSignalsOneTime(S.getStaticSignals()))},getSignalsAsJSONString:function(){return o("BDSignalBuffer").getSignalsAsJSONString([r("BDCollectionTypeEnum").DYNAMIC,r("BDCollectionTypeEnum").STATIC,r("BDCollectionTypeEnum").BIOMETRIC])}},E=L;l.default=E}),98);
__d("BDCometSignalCollectionTrigger",["BDClientSignalCollectionTrigger","BDSignalCollectionData","FBLogger","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";function e(){r("BDClientSignalCollectionTrigger").startSignalCollection(r("BDSignalCollectionData")).catch(function(e){r("FBLogger")("bot_detection").catching(r("getErrorSafe")(e)).mustfix("Failed to start signal collection")})}l.initSignalCollection=e}),98);
__d("BaseCalloutImpl.react",["BaseContextualLayer.react","BaseContextualLayerAnchorRootContext","BasePopoverReflowSheet.react","LayoutAnimationBoundaryContext","react","react-compiler-runtime","useCometDisplayTimingTrackerForInteraction","useMatchViewport"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e.useEffect;function c(e){var t=o("react-compiler-runtime").c(18),n=e.anchorRef,a=e.anchorRefOverride,i=e.anchorRootRefContext,l=e.animationContext,c=e.children,m=e.contextualLayerProps,p=e.imperativeRef,_=e.scrollableAreaContext,f=a===void 0?!1:a,g=r("useCometDisplayTimingTrackerForInteraction")("FDSCalloutManager"),h=r("useMatchViewport")("max","width",600)?r("BasePopoverReflowSheet.react"):s.Fragment,y,C;if(t[0]!==p||t[1]!==_?(y=function(){var e=_.map(d).filter(Boolean),t=function(){var e;return(e=p.current)==null?void 0:e.reposition()};if(e.length>0)return e.forEach(function(e){return e.addEventListener("scroll",t,{passive:!0})}),(function(){e.forEach(function(e){return e.removeEventListener("scroll",t)})})},C=[p,_],t[0]=p,t[1]=_,t[2]=y,t[3]=C):(y=t[2],C=t[3]),u(y,C),m==null||n==null)return null;var b;t[4]!==h||t[5]!==n||t[6]!==f||t[7]!==c||t[8]!==m||t[9]!==p||t[10]!==g?(b=m!=null?s.jsx(h,{children:s.jsx(r("BaseContextualLayer.react"),{align:m.align,anchorRef:f?n:void 0,contextRef:n,disableAutoAlign:m.disableAutoAlign,disableAutoFlip:m.disableAutoFlip,imperativeRef:p,position:m.position,ref:g,reflowToPosition:h!==s.Fragment,children:c})}):null,t[4]=h,t[5]=n,t[6]=f,t[7]=c,t[8]=m,t[9]=p,t[10]=g,t[11]=b):b=t[11];var v;t[12]!==i||t[13]!==b?(v=s.jsx(r("BaseContextualLayerAnchorRootContext").Provider,{value:i,children:b}),t[12]=i,t[13]=b,t[14]=v):v=t[14];var S;return t[15]!==l||t[16]!==v?(S=s.jsx(r("LayoutAnimationBoundaryContext").Provider,{value:l,children:v}),t[15]=l,t[16]=v,t[17]=S):S=t[17],S}function d(e){return e.getDOMNode()}l.default=c}),98);
__d("Chromedome",["fbt"],(function(t,n,r,o,a,i,l,s){function e(){if(document.domain==null)return null;var e=document.domain,t=/^intern\./.test(e);if(t)return null;var n=/(^|\.)facebook\.(com|sg)$/.test(e);if(n)return"facebook";var r=/(^|\.)instagram\.com$/.test(e);if(r)return"instagram";var o=/(^|\.)threads\.(com|net)$/.test(e);if(o)return"threads";var a=/(^|\.)messenger\.com$/.test(e);return a?"messenger":null}function u(e){return e==="instagram"?s._(/*BTDS*/"This is a browser feature intended for developers. If someone told you to copy-paste something here to enable an Instagram feature or \"hack\" someone's account, it is a scam and will give them access to your Instagram account."):e==="threads"?s._(/*BTDS*/"This is a browser feature intended for developers. If someone told you to copy-paste something here to enable a Threads feature or \"hack\" someone's account, it is a scam and will give them access to your Threads account."):s._(/*BTDS*/"This is a browser feature intended for developers. If someone told you to copy-paste something here to enable a Facebook feature or \"hack\" someone's account, it is a scam and will give them access to your Facebook account.")}function c(t){if(top===window){var n=e();if(n!=null){var r=s._(/*BTDS*/"Stop!"),o=u(n),a=s._(/*BTDS*/"See https:\/\/www.facebook.com\/selfxss for more information."),i="font-family:helvetica; font-size:20px; ";[[r,i+"font-size:50px; font-weight:bold; color:red; -webkit-text-stroke:1px black;"],[o,i],[a,i],["",""]].map(function(e){window.setTimeout(console.log.bind(console,"\n%c"+e[0].toString(),e[1]))})}}}l.start=c}),226);
__d("ClientConsistencyFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("1764786"),s=o("FalcoLoggerInternal").create("client_consistency",e),u=s;l.default=u}),98);
__d("WebBrowserDimensionsTypedLoggerLite",["generateLiteTypedLogger"],(function(t,n,r,o,a,i){"use strict";a.exports=n("generateLiteTypedLogger")("logger:WebBrowserDimensionsLoggerConfig")}),null);
__d("CometBrowserDimensionsLogger",["CometDebounce","Cookie","ExecutionEnvironment","SiteData","WebBrowserDimensionsTypedLoggerLite","getViewportDimensions","isInIframe"],(function(t,n,r,o,a,i,l){"use strict";var e,s=null,u=!1,c={height:0,width:0};function d(){return s===null&&(s=r("getViewportDimensions")()),s}function m(){var e=r("getViewportDimensions")(),t=e.height,n=e.width;(c.width!==n||c.height!==t)&&(c={height:t,width:n},r("Cookie").set("wd",n+"x"+t))}function p(){!(e||(e=r("ExecutionEnvironment"))).canUseDOM||r("isInIframe")()||u||(u=!0,m(),window.addEventListener("resize",r("CometDebounce")(m,{wait:250}),{passive:!0}),window.addEventListener("focus",m,{passive:!0}))}function _(e){var t,n=d();p();var o={client_hint_width:e==null?void 0:e.clientHintWidth,pixel_ratio:(t=window.devicePixelRatio)!=null?t:1,screen_x:window.screen.width,screen_y:window.screen.height,server_pixel_ratio:r("SiteData").pr,server_viewport_x:e==null?void 0:e.viewportWidth,server_viewport_y:e==null?void 0:e.viewportHeight,viewport_x:n.width,viewport_y:n.height};if(window.navigator&&window.navigator.hardwareConcurrency&&(o.cpu_cores_count=window.navigator.hardwareConcurrency),window.innerWidth>0&&window.outerWidth>0){var a=Math.round(window.outerWidth/window.innerWidth*100)/100;o.zoom_ratio=a}if(window.getComputedStyle&&document.documentElement!=null){var i=window.getComputedStyle(document.documentElement);i!=null&&(o.document_font_size=i.fontSize)}r("WebBrowserDimensionsTypedLoggerLite").log(o)}l.init=_}),98);
__d("CometChromeDome",["JSScheduler","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("requireDeferred")("Chromedome").__setRef("CometChromeDome");function u(){s.onReady(function(t){(e||(e=o("JSScheduler"))).scheduleLoggingPriCallback(function(){t.start({})})})}l.init=u}),98);
__d("CometFBUncaughtError.react",["fbt","CometContentArea.react","FDSNullState.react","NullStateGeneral","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react"));function c(){var e=o("react-compiler-runtime").c(2),t;e[0]===Symbol.for("react.memo_cache_sentinel")?(t={className:"x6s0dn4 x78zum5 x1dr59a3 xl56j7k xixxii4 xh8yej3"},e[0]=t):t=e[0];var n;return e[1]===Symbol.for("react.memo_cache_sentinel")?(n=u.jsx("div",babelHelpers.extends({},t,{children:u.jsx(r("CometContentArea.react"),{verticalAlign:"middle",children:u.jsx(r("FDSNullState.react"),{headline:s._(/*BTDS*/"Sorry! Something went wrong :("),icon:r("NullStateGeneral")})})})),e[1]=n):n=e[1],n}l.default=c}),226);
__d("CometIconWirelessSlashFilled.react",["CometSVGIcon.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){var t=o("react-compiler-runtime").c(3),n;t[0]===Symbol.for("react.memo_cache_sentinel")?(n=s.jsx("path",{d:"M23.7805.2195c.2925.293.2925.768 0 1.061l-22.5 22.5C1.134 23.927.942 24 .75 24c-.192 0-.384-.073-.5305-.2195-.2925-.293-.2925-.768 0-1.061l12.1967947-12.1971509c-2.3773758-.1150468-4.79162015.7286756-6.6038447 2.5401009-.3905.3905-1.0235.3905-1.414 0-.3905-.3905-.3905-1.024 0-1.414 2.65728981-2.65728981 6.3696459-3.62280965 9.8005664-2.90852144l2.430738-2.43186193C11.7816792 4.58111626 6.15198938 5.65271062 2.27735 9.52735c-.3905.3905-1.0235.3905-1.414 0-.3905-.3905-.3905-1.0235 0-1.414 4.6714534-4.67191574 11.571522-5.78608437 17.3096457-3.34843552L22.7195.2195c.293-.2925.768-.2925 1.061 0zM12 18.5c.6905 0 1.25.5595 1.25 1.25S12.6905 21 12 21s-1.25-.5595-1.25-1.25.5595-1.25 1.25-1.25zm1.4175-4.81495c.9705.2455 1.8905.741 2.6485 1.499.3905.3905.3905 1.0235 0 1.414-.1955.1955-.451.293-.707.293-.256 0-.512-.0975-.707-.293-.7835333-.7835333-1.8301422-1.1445778-2.8581093-1.0880116L11.574 15.52855l1.8435-1.8435zm3.8154-3.8154c.848.4725 1.649 1.059 2.3685 1.779.391.39.391 1.023 0 1.414-.195.195-.451.293-.707.293-.2555 0-.5115-.098-.707-.293-.7285-.728-1.5575-1.291-2.439-1.7085zm2.1908-2.1908l1.4425-1.4425c.8.545 1.5615 1.168 2.2705 1.877.3905.3905.3905 1.0235 0 1.414-.1955.1955-.451.293-.707.293-.256 0-.5115-.0975-.707-.293-.5933333-.59333333-1.2283333-1.11861111-1.895162-1.57959491L19.4237 7.67885l1.4425-1.4425z"}),t[0]=n):n=t[0];var a;return t[1]!==e?(a=s.jsx(r("CometSVGIcon.react"),babelHelpers.extends({viewBox:"0 0 24 24"},e,{children:n})),t[1]=e,t[2]=a):a=t[2],a}l.default=u}),98);
__d("CometLogoutHandlerQuery.graphql",["relay-runtime"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={alias:null,args:null,kind:"ScalarField",name:"logout_whitelist",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"logout_hash",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"has_confirmed_contactpoints",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},o=[r],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometLogoutHandlerQuery",selections:[e,{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[t,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actor",plural:!1,selections:[{kind:"InlineFragment",selections:[n,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"pending_contactpoints",plural:!0,selections:[{kind:"InlineFragment",selections:o,type:"PendingEmail",abstractKey:null},{kind:"InlineFragment",selections:o,type:"Phone",abstractKey:null}],storageKey:null}],type:"User",abstractKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"CometLogoutHandlerQuery",selections:[e,{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[t,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actor",plural:!1,selections:[r,a,{kind:"InlineFragment",selections:[n,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"pending_contactpoints",plural:!0,selections:[r,{kind:"InlineFragment",selections:[a],type:"Node",abstractKey:"__isNode"}],storageKey:null}],type:"User",abstractKey:null}],storageKey:null}],storageKey:null}]},params:{id:"29300489429598867",metadata:{},name:"CometLogoutHandlerQuery",operationKind:"query",text:null}}})();n("relay-runtime").PreloadableQueryRegistry.set(e.params.id,e),a.exports=e}),null);
__d("useLogoutWithPendingContactpointConfirmation",["fbt","react","react-compiler-runtime","useCometConfirmationDialog"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=(e||(e=o("react"))).useCallback;function c(e,t){var n=o("react-compiler-runtime").c(4),a=r("useCometConfirmationDialog")(),i;n[0]!==e||n[1]!==t||n[2]!==a?(i=function(){a({body:e==="PhoneNumber"?s._(/*BTDS*/"Are you sure you want to log out of Facebook before you confirm your mobile number? Confirming the mobile number on your account ensures you will be able to log in again."):s._(/*BTDS*/"Are you sure you want to log out of Facebook before you confirm your email? Confirming the email on your account ensures you will be able to log in again."),cancel:s._(/*BTDS*/"Confirm account"),confirm:s._(/*BTDS*/"Log out"),title:s._(/*BTDS*/"Log out of Facebook?")},t)},n[0]=e,n[1]=t,n[2]=a,n[3]=i):i=n[3];var l=i;return e==="PendingEmail"||e==="PhoneNumber"?l:null}l.default=c}),226);
__d("CometLogoutHandler.react",["Banzai","CometComposerDraftingUtils","CometLogoutHandlerQuery.graphql","CometRelay","CometVisualCompletionAttributes","FBLogger","ServiceWorkerLoginAndLogout","WebStorageMonster","XLogoutControllerRouteBuilder","react","react-compiler-runtime","useLogoutWithPendingContactpointConfirmation"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=s||(s=o("react")),c=s,d=c.useCallback,m=c.useEffect,p=c.useImperativeHandle,_=c.useRef;function f(t){var a,i,l=o("react-compiler-runtime").c(17),s=t.ref,c=t.shouldInitiateLogout,d=_(!1),f=o("CometRelay").useLazyLoadQuery(e!==void 0?e:e=n("CometLogoutHandlerQuery.graphql"),{}),h=f.logout_whitelist,y=f.viewer,C=_(),b;l[0]!==h?(b=function(){if(!d.current){d.current=!0;var e=C.current;if(e==null){r("FBLogger")("web_navigation_and_bookmarks").mustfix("Unable to get logout form ref to submit");return}r("WebStorageMonster").cleanOnLogout(h,"CometLogoutHandler"),r("ServiceWorkerLoginAndLogout").logout(),o("CometComposerDraftingUtils").clearAllDraftsFromIndexedDB().catch(g),r("Banzai").flush(),e.submit()}},l[0]=h,l[1]=b):b=l[1];var v=b,S=r("useLogoutWithPendingContactpointConfirmation")((y==null||(a=y.actor)==null?void 0:a.has_confirmed_contactpoints)!==!0?y==null||(i=y.actor)==null||(i=i.pending_contactpoints)==null||(i=i[0])==null?void 0:i.__typename:null,v),R;l[2]!==v||l[3]!==S?(R=function(){S?S():v()},l[2]=v,l[3]=S,l[4]=R):R=l[4];var L=R,E;l[5]!==L?(E=function(){return{logout:L}},l[5]=L,l[6]=E):E=l[6],p(s,E);var k,I;l[7]!==L||l[8]!==c?(k=function(){C.current==null?r("FBLogger")("web_navigation_and_bookmarks").mustfix("Expected logout form ref to be valid"):c===!0&&L()},I=[L,c],l[7]=L,l[8]=c,l[9]=k,l[10]=I):(k=l[9],I=l[10]),m(k,I);var T;l[11]===Symbol.for("react.memo_cache_sentinel")?(T=r("XLogoutControllerRouteBuilder").buildURL({button_location:"settings",button_name:"logout"}),l[11]=T):T=l[11];var D=T,x=y==null?void 0:y.logout_hash,$;l[12]!==x?($=u.jsx("input",{name:"h",type:"hidden",value:x}),l[12]=x,l[13]=$):$=l[13];var P;l[14]===Symbol.for("react.memo_cache_sentinel")?(P=u.jsx("input",{name:"ref",type:"hidden",value:"mb"}),l[14]=P):P=l[14];var N;return l[15]!==$?(N=u.jsxs("form",babelHelpers.extends({action:D,method:"POST",ref:C},r("CometVisualCompletionAttributes").IGNORE,{children:[$,P]})),l[15]=$,l[16]=N):N=l[16],N}function g(e){return r("FBLogger")("comet_composer").mustfix("Error clearing drafts on logout: "+e.message)}l.default=f}),98);
__d("CometNetworkStatusToast",["fbt","BaseToasterStateManager","CometIconWirelessSlashFilled.react","CometRelayEnvironmentFactory","FDSIcon.react","FDSWirelessFilled24Icon","NetworkStatus","SVGIcon","cometPushToast","gkx","react"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=null,d=null,m=r("gkx")("22885");function p(e){var t=e.online,n=r("BaseToasterStateManager").getInstance();c!=null&&(n.expire(c),c=null),t&&!m&&(c=o("cometPushToast").cometPushToast({icon:u.jsx(r("FDSIcon.react"),{color:"positive",icon:r("FDSWirelessFilled24Icon"),size:24}),message:s._(/*BTDS*/"Your internet connection was restored.")},4e3,n)),t||(c=o("cometPushToast").cometPushToast({action:m?void 0:{label:s._(/*BTDS*/"Refresh"),onPress:function(){o("CometRelayEnvironmentFactory").commitLocalUpdateForEachEnvironment(function(e,t,n){n.invalidateStore()})}},icon:u.jsx(r("FDSIcon.react"),{color:"disabled",icon:o("SVGIcon").legacySVGIcon(r("CometIconWirelessSlashFilled.react")),size:24}),message:s._(/*BTDS*/"You are currently offline.")},1/0,n))}function _(){d=r("NetworkStatus").onChange(p)}function f(){var e;(e=d)==null||e.remove(),d=null}l.subscribe=_,l.unsubscribe=f}),226);
__d("CometPixelRatioUpdater",["Cookie","Run","WebPixelRatio"],(function(t,n,r,o,a,i,l){"use strict";var e="dpr";function s(t){r("Cookie").set(e,String(t))}function u(){window.devicePixelRatio!==o("WebPixelRatio").get()&&s(window.devicePixelRatio)}function c(){u(),o("Run").onBeforeUnload(u,!1),"onpagehide"in window&&window.addEventListener("pageHide",u)}l.startDetecting=c}),98);
__d("CometVirtualCursorStatus",["UserAgent","cr:1345969","setTimeout"],(function(t,n,r,o,a,i,l){"use strict";var e=null,s=null;function u(){s||(s=window.addEventListener("blur",function(){e=null,c()}))}function c(){s&&(s.remove(),s=null)}function d(t){e=t.keyCode,u()}function m(t){e=null,c()}if(typeof window!="undefined"&&window.document&&window.document.createElement){var p=document.documentElement;if(p){if(p.addEventListener)p.addEventListener("keydown",d,!0),p.addEventListener("keyup",m,!0);else if(p.attachEvent){var _=p.attachEvent;_("onkeydown",d),_("onkeyup",m)}}}var f={getKeyDownCode:function(){return e},isKeyDown:function(){return!!e}},g=!1,h=!1,y=null,C=!1;function b(e){var t=new Set,n=f.isKeyDown(),o=e.WEBKIT_FORCE_AT_MOUSE_DOWN,a=e.clientX,i=e.clientY,l=e.isTrusted,s=e.mozInputSource,u=e.offsetX,c=e.offsetY,d=e.webkitForce;if(a===0&&i===0&&u>=0&&c>=0&&h&&l&&s==null&&t.add("Chrome"),g&&h&&!n&&d!=null&&d<o&&u===0&&c===0&&s==null&&t.add("Safari-edge"),a===0&&i===0&&u<0&&c<0&&h&&s==null&&t.add("Safari-old"),!g&&!h&&!n&&l&&r("UserAgent").isBrowser("IE >= 10")&&s==null){var m=e.target,p=m.clientHeight,_=m.clientWidth;a<0&&i<0?t.add("IE"):(u<0||u>_)&&(c<0||c>p)&&t.add("MSIE")}return s===0&&l&&t.add("Firefox"),t}function v(){g=!0,r("setTimeout")(function(){g=!1},0)}function S(){h=!0,r("setTimeout")(function(){h=!1},0)}function R(e){C&&n("cr:1345969").log({extra_data:{source_app:"comet"},indicated_browsers:y,is_virtual_cursor_action:e})}function L(e){y===null&&(y=Array.from(b(e))),C=y!=null&&y.length>0;var t=e.target!=null&&e.target.getAttribute!=null&&e.target.getAttribute("data-accessibilityid")==="virtual_cursor_trigger";R(t),r("setTimeout")(function(){C=!1,y=null},0)}function E(){document.addEventListener("click",L,!0),document.addEventListener("mousedown",v,!0),document.addEventListener("mouseup",S,!0)}l.initLogging=E}),98);
__d("SimplePageLoadLogger",["ODS","performance"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(){(s||(s=o("ODS"))).bumpEntityKey(1678,"www_client_navigations",c())}function c(){if((e||(e=r("performance"))).navigation==null||(e||(e=r("performance"))).navigation.type==null)return"UNSUPPORTED";switch((e||(e=r("performance"))).navigation.type){case(e||(e=r("performance"))).navigation.TYPE_NAVIGATE:return"NAVIGATE";case(e||(e=r("performance"))).navigation.TYPE_RELOAD:return"RELOAD";case(e||(e=r("performance"))).navigation.TYPE_BACK_FORWARD:return"BACK_FORWARD";case(e||(e=r("performance"))).navigation.TYPE_RESERVED:return"RESERVED";default:return"UNKNOWN"}}l.logPageNavigationType=u}),98);
__d("setCometDeferredCookies",["DeferredCookie","ErrorGuard"],(function(t,n,r,o,a,i,l){"use strict";var e,s=!1,u=new Set;function c(e){s?e():u.add(e)}function d(t){Object.entries(t).forEach(function(e){var t=e[0],n=e[1],o=n.expiration_for_js,a=n.first_party_only,i=n.path,l=n.secure,s=n.value;r("DeferredCookie").addToQueue(t,s,o,i,a,!1,l)}),s=!0,u.forEach(function(t){return(e||(e=r("ErrorGuard"))).applyWithGuard(t,null,[])}),u.clear()}l.onCometDeferredCookieSet=c,l.setCometDeferredCookies=d}),98);
__d("CometRootDeferredShared",["CometBootloaderErrorLoggerUtil","CometBootloaderLoggerUtil","CometOfflineTracing","CometVirtualCursorStatus","ErrorGuard","FBLogger","JSScheduler","RunComet","SimplePageLoadLogger","WebStorageMonster","cr:1201738","cr:1332233","cr:1516609","cr:17080","cr:1813330","cr:22915","cr:2718","getErrorSafe","gkx","setCometDeferredCookies","vc-tracker"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t){var a=t.blLoggingCavalryFields,i=t.deferredCookies,l=t.networkStatusToast,u=l===void 0?n("cr:17080"):l;if((s||(s=r("ErrorGuard"))).applyWithGuard(function(){return o("CometBootloaderLoggerUtil").initLogging(a)},null,[]),s.applyWithGuard(function(){return o("CometBootloaderErrorLoggerUtil").initLogging(a)},null,[]),s.applyWithGuard(function(){return o("CometVirtualCursorStatus").initLogging()},null,[]),u!=null&&!r("gkx")("11394")&&(s||(s=r("ErrorGuard"))).applyWithGuard(function(){return u.subscribe()},null,[]),s.applyWithGuard(function(){return o("CometOfflineTracing").initialize()},null,[]),s.applyWithGuard(function(){return o("SimplePageLoadLogger").logPageNavigationType()},null,[]),(e||(e=o("JSScheduler"))).scheduleSpeculativeCallback(function(){r("WebStorageMonster").schedule()}),n("cr:1201738")&&r("vc-tracker").VisualCompletionTraceObserver.subscribe(function(e){e.interactionType==="INITIAL_LOAD"&&n("cr:1201738").init("comet.idle").catch(function(e){r("FBLogger")("comet_infra").catching(r("getErrorSafe")(e)).warn("Failed to initialize JsSelfProfilerIdleTraceRunner")})}),o("setCometDeferredCookies").setCometDeferredCookies(i),n("cr:1332233")&&(s||(s=r("ErrorGuard"))).applyWithGuard(function(){return n("cr:1332233")()},null,[]),n("cr:1516609")!=null&&(s||(s=r("ErrorGuard"))).applyWithGuard(function(){return n("cr:1516609").initSignalCollection()},null,[]),n("cr:1813330")&&(s||(s=r("ErrorGuard"))).applyWithGuard(function(){return n("cr:1813330").init()},null,[]),n("cr:2718")&&(s||(s=r("ErrorGuard"))).applyWithGuard(function(){return n("cr:2718").init()},null,[]),n("cr:22915"))var c=o("RunComet").onAfterLoad(function(){(s||(s=r("ErrorGuard"))).applyWithGuard(function(){n("cr:22915")==null||n("cr:22915").startRSTFromMainThread(),c.remove()},null,[])})}l.initDeferred=u}),98);
__d("CometToasterView_DO_NOT_USE.react",["BaseContextualLayerAnchorRoot.react","BasePortal.react","BaseToastAnimationInternal.react","CometVisualCompletionAttributes","XPlatReactToasterView.react","gkx","react","react-compiler-runtime","useToasterStateManager"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e,c=u.useEffect,d=u.useState,m={root:{display:"x78zum5",insetInlineEnd:"xtijo5x",insetInlineStart:"x17syakg",left:null,right:null,pointerEvents:"x47corl",position:"xixxii4",width:"xh8yej3",zIndex:"xoegz02",$$css:!0},rootBlue:{zIndex:"x1jvg36b",$$css:!0},rootWorkplaceLegacy:{zIndex:"xdwmgzo",$$css:!0},toast:{paddingTop:"xyamay9",paddingInlineEnd:"xv54qhq",paddingBottom:"x1l90r2v",paddingInlineStart:"xf7dkkf",pointerEvents:"x71s49j","@media (max-width: 899px)_maxWidth":"xx1nl2z",$$css:!0}},p={bottom:{bottom:"x1ey2m1c",$$css:!0},top:{top:"x13vifvy",$$css:!0}},_={center:{justifyContent:"xl56j7k",$$css:!0},end:{justifyContent:"x13a6bvl",$$css:!0},start:{justifyContent:"x1nhvcw1",$$css:!0}},f={full:{maxWidth:"x193iq5w",$$css:!0},regular:{maxWidth:"x1xi1syu",$$css:!0}};function g(e){var t=o("react-compiler-runtime").c(24),n=e.align,a=e.filterToasts,i=e.maxVisible,l=e.maxWidth,u=e.position,g=e.xstyle,h=n===void 0?"start":n,y=i===void 0?1:i,C=l===void 0?"full":l,b=u===void 0?"bottom":u,v=r("useToasterStateManager")(),S;t[0]!==v?(S=function(){return v.getEmptyState()},t[0]=v,t[1]=S):S=t[1];var R=d(S),L=R[0],E=R[1],k,I;t[2]!==v?(k=function(){var e=v.registerView(E,0);return e.remove},I=[v],t[2]=v,t[3]=k,t[4]=I):(k=t[3],I=t[4]),c(k,I);var T=_[h],D=p[b],x;t[5]!==T||t[6]!==D||t[7]!==g?(x=[m.root,r("gkx")("20935")?null:r("gkx")("22885")?m.rootWorkplaceLegacy:m.rootBlue,T,D,g],t[5]=T,t[6]=D,t[7]=g,t[8]=x):x=t[8];var $;t[9]===Symbol.for("react.memo_cache_sentinel")?($={className:"x78zum5 xdt5ytf x3ct3a4 x193iq5w"},t[9]=$):$=t[9];var P;t[10]!==v?(P=function(t){v.expire(t)},t[10]=v,t[11]=P):P=t[11];var N;t[12]!==C||t[13]!==b?(N=function(t,n,o,a){return s.jsx(r("BaseToastAnimationInternal.react"),{expired:o,id:n,position:a,toasterPosition:b,xstyle:[m.toast,f[r("gkx")("22886")?"regular":C]],children:s.jsx(r("BaseContextualLayerAnchorRoot.react"),{children:t})},a)},t[12]=C,t[13]=b,t[14]=N):N=t[14];var M;t[15]!==a||t[16]!==y||t[17]!==P||t[18]!==N||t[19]!==L?(M=s.jsx("ul",babelHelpers.extends({},$,{children:s.jsx(r("XPlatReactToasterView.react"),{filterToasts:a,maxVisible:y,onExpireToast:P,toasterState:L,children:N})})),t[15]=a,t[16]=y,t[17]=P,t[18]=N,t[19]=L,t[20]=M):M=t[20];var w;return t[21]!==x||t[22]!==M?(w=s.jsx(r("BasePortal.react"),babelHelpers.extends({target:document.body,xstyle:x},r("CometVisualCompletionAttributes").IGNORE,{children:M})),t[21]=x,t[22]=M,t[23]=w):w=t[23],w}l.default=g}),98);
__d("FDSCalloutEdgeArrow.svg.react",["react","stylex"],(function(t,n,r,o,a,i,l){"use strict";var e=["children","xstyle"],s,u,c=u||(u=o("react"));function d(t){var n=t.children,o=t.xstyle,a=babelHelpers.objectWithoutPropertiesLoose(t,e);return c.jsxs("svg",babelHelpers.extends({"aria-hidden":!0,className:(s||(s=r("stylex")))(o),height:"12px",viewBox:"0 0 21 12",width:"21px"},a,{children:[a.title!=null&&c.jsx("title",{children:a.title}),n!=null&&c.jsx("defs",{children:n}),c.jsx("path",{d:"M20.685.12c-2.229.424-4.278 1.914-6.181 3.403L5.4 10.94c-2.026 2.291-5.434.62-5.4-2.648V.12h20.684z"})]}))}d.displayName=d.name+" [from "+i.id+"]",d._isSVG=!0,l.default=d}),98);
__d("FDSCalloutEdge.react",["BaseContextualLayerContextSizeContext","BaseContextualLayerLayerAdjustmentContext","BaseContextualLayerOrientationContext","BaseRow.react","BaseView.react","CometHideLayerOnEscape.react","FDSCalloutEdgeArrow.svg.react","FocusRegionStrictMode.react","Locale","focusScopeQueries","react","react-compiler-runtime","useOnOutsideClick"],(function(t,n,r,o,a,i,l){"use strict";var e=["children","disableAutoFocus","id","onClose","onOutsideClick","type","xstyle"],s,u=s||(s=o("react")),c=s.useContext,d={arrow:{position:"x10l6tqk",$$css:!0},container:{display:"x78zum5",$$css:!0},content:{backgroundColor:"x1h0vfkc",borderStartStartRadius:"x1obq294",borderStartEndRadius:"x5a5i1n",borderEndEndRadius:"xde0f50",borderEndStartRadius:"x15x8krk",borderTopWidth:"x178xt8z",borderInlineEndWidth:"x1lun4ml",borderBottomWidth:"xso031l",borderInlineStartWidth:"xpilrb4",boxShadow:"xofhs1l",paddingTop:"xyamay9",paddingBottom:"x1l90r2v",paddingInlineStart:"x1g0dm76",paddingInlineEnd:"xpdmqnj",paddingLeft:null,paddingRight:null,$$css:!0}},m={accent:{backgroundColor:"xdk9wry",$$css:!0},default:{backgroundColor:"x9bbmet",$$css:!0}},p={end:{borderEndEndRadius:"x16uus16",marginBottom:"xieb3on",$$css:!0},middle:{marginBottom:"x12nagc",$$css:!0},start:{borderEndStartRadius:"xbiv7yw",marginBottom:"xieb3on",$$css:!0}},_={end:{borderStartEndRadius:"x1ga7v0g",marginTop:"x1sy10c2",$$css:!0},middle:{marginTop:"x1gslohp",$$css:!0},start:{borderStartStartRadius:"x15mokao",marginTop:"x1sy10c2",$$css:!0}},f={end:{bottom:"x7ofzsv",insetInlineEnd:"xtijo5x",left:null,right:null,transform:"xpk2tj9",$$css:!0},middle:{bottom:"x7ofzsv",insetInlineEnd:"xtijo5x",left:null,right:null,$$css:!0},start:{bottom:"x7ofzsv",insetInlineStart:"x1o0tod",left:null,right:null,$$css:!0}},g={end:{$$css:!0},middle:{$$css:!0},start:{$$css:!0}},h={end:{bottom:"x7ofzsv",insetInlineEnd:"xtijo5x",left:null,right:null,transform:"xpk2tj9",$$css:!0},middle:{bottom:"x7ofzsv",insetInlineEnd:"xtijo5x",left:null,right:null,$$css:!0},start:{bottom:"x7ofzsv",insetInlineStart:"x1o0tod",left:null,right:null,$$css:!0}},y={end:{$$css:!0},middle:{$$css:!0},start:{$$css:!0}},C={end:{insetInlineEnd:"xtijo5x",left:null,right:null,top:"x1nl0pjx",transform:"x19jd1h0",$$css:!0},middle:{insetInlineEnd:"xtijo5x",left:null,right:null,top:"x1nl0pjx",transform:"x1oihik5",$$css:!0},start:{insetInlineStart:"x1o0tod",left:null,right:null,top:"x1nl0pjx",transform:"x1oihik5",$$css:!0}},b={end:{transform:"x19jd1h0",$$css:!0},middle:{transform:"x1oihik5",$$css:!0},start:{transform:"x1oihik5",$$css:!0}},v={end:{insetInlineEnd:"xtijo5x",left:null,right:null,top:"x1nl0pjx",transform:"x19jd1h0",$$css:!0},middle:{insetInlineEnd:"xtijo5x",left:null,right:null,top:"x1nl0pjx",transform:"x1oihik5",$$css:!0},start:{insetInlineStart:"x1o0tod",left:null,right:null,top:"x1nl0pjx",transform:"x1oihik5",$$css:!0}},S={end:{transform:"x19jd1h0",$$css:!0},middle:{transform:"x1oihik5",$$css:!0},start:{transform:"x1oihik5",$$css:!0}};function R(e){return e==="start"?"end":e==="end"?"start":e}function L(t){var n,a,i=o("react-compiler-runtime").c(41),l,s,f,g,h,y,C,b;i[0]!==t?(s=t.children,y=t.disableAutoFocus,f=t.id,g=t.onClose,h=t.onOutsideClick,C=t.type,b=t.xstyle,l=babelHelpers.objectWithoutPropertiesLoose(t,e),i[0]=t,i[1]=l,i[2]=s,i[3]=f,i[4]=g,i[5]=h,i[6]=y,i[7]=C,i[8]=b):(l=i[1],s=i[2],f=i[3],g=i[4],h=i[5],y=i[6],C=i[7],b=i[8]);var v=y===void 0?!1:y,S=C===void 0?"default":C,L=c(r("BaseContextualLayerOrientationContext")),E=L.align,T=L.position,D=E==="stretch"?"start":E,x=T==="start"?"above":T==="end"?"below":T,$=c(r("BaseContextualLayerContextSizeContext")),P=(n=c(r("BaseContextualLayerLayerAdjustmentContext")))!=null?n:0,N;i[9]!==D||i[10]!==P?(N=P!==0?R(D):D,i[9]=D,i[10]=P,i[11]=N):N=i[11];var M=N,w=(a=$==null?void 0:$.width)!=null?a:0,A;i[12]!==M||i[13]!==P||i[14]!==w?(A=I(M,w,P),i[12]=M,i[13]=P,i[14]=w,i[15]=A):A=i[15];var F=A,O=r("useOnOutsideClick")(h),B=f!=null?f:void 0,W=v?void 0:o("focusScopeQueries").tabbableScopeQuery,q=m[S],U=x==="above"&&p[M],V=x==="below"&&_[M],H;i[16]!==V||i[17]!==q||i[18]!==U||i[19]!==b?(H=[d.content,q,U,V,b],i[16]=V,i[17]=q,i[18]=U,i[19]=b,i[20]=H):H=i[20];var G;i[21]!==s||i[22]!==O||i[23]!==H?(G=u.jsx(r("BaseRow.react"),{ref:O,xstyle:H,children:s}),i[21]=s,i[22]=O,i[23]=H,i[24]=G):G=i[24];var z;i[25]!==M||i[26]!==x||i[27]!==S?(z=u.jsx(k,{align:M,position:x,type:S}),i[25]=M,i[26]=x,i[27]=S,i[28]=z):z=i[28];var j;i[29]!==g||i[30]!==G||i[31]!==z?(j=u.jsxs(r("CometHideLayerOnEscape.react"),{onHide:g,children:[G,z]}),i[29]=g,i[30]=G,i[31]=z,i[32]=j):j=i[32];var K;i[33]!==j||i[34]!==W?(K=u.jsx(o("FocusRegionStrictMode.react").FocusRegion,{autoFocusQuery:W,children:j}),i[33]=j,i[34]=W,i[35]=K):K=i[35];var Q;return i[36]!==l||i[37]!==F||i[38]!==K||i[39]!==B?(Q=u.jsx(r("BaseView.react"),babelHelpers.extends({},l,{id:B,role:"dialog",style:F,xstyle:d.container,children:K})),i[36]=l,i[37]=F,i[38]=K,i[39]=B,i[40]=Q):Q=i[40],Q}var E=o("Locale").isRTL();function k(e){var t=o("react-compiler-runtime").c(8),n=e.align,a=e.position,i=e.type,l=i==="default"?"var(--popover-background)":"var(--callout-background-color-accent, var(--accent))",s=a==="above"&&i==="default"&&(E?g[n]:f[n]),c=a==="above"&&i==="accent"&&(E?y[n]:h[n]),m=a==="below"&&i==="default"&&(E?b[n]:C[n]),p=a==="below"&&i==="accent"&&(E?S[n]:v[n]),_;t[0]!==s||t[1]!==c||t[2]!==m||t[3]!==p?(_=[d.arrow,s,c,m,p],t[0]=s,t[1]=c,t[2]=m,t[3]=p,t[4]=_):_=t[4];var R;return t[5]!==l||t[6]!==_?(R=u.jsx(r("FDSCalloutEdgeArrow.svg.react"),{fill:l,xstyle:_}),t[5]=l,t[6]=_,t[7]=R):R=t[7],R}function I(e,t,n){var r=n===0?t/2:0;if(r!==0){if(e==="start")return{transform:"translateX("+(E?-1*r:r)+"px)"};if(e==="end")return{transform:"translateX("+(E?r:-1*r)+"px)"}}}l.default=L}),98);
__d("FDSCalloutInsetArrow.svg.react",["react","stylex"],(function(t,n,r,o,a,i,l){"use strict";var e=["children","xstyle"],s,u,c=u||(u=o("react"));function d(t){var n=t.children,o=t.xstyle,a=babelHelpers.objectWithoutPropertiesLoose(t,e);return c.jsxs("svg",babelHelpers.extends({"aria-hidden":!0,className:(s||(s=r("stylex")))(o),height:"12px",viewBox:"0 0 21 12",width:"21px"},a,{children:[a.title!=null&&c.jsx("title",{children:a.title}),n!=null&&c.jsx("defs",{children:n}),c.jsx("path",{d:"M20.685.12c-2.229.424-4.278 1.914-6.181 3.403L5.4 10.94c-2.026 2.291-5.434.62-5.4-2.648V.12h20.684z"})]}))}d.displayName=d.name+" [from "+i.id+"]",d._isSVG=!0,l.default=d}),98);
__d("FDSCalloutInset.react",["BaseContextualLayerContextSizeContext","BaseContextualLayerLayerAdjustmentContext","BaseContextualLayerOrientationContext","BaseRow.react","BaseView.react","CometHideLayerOnEscape.react","FDSCalloutInsetArrow.svg.react","FocusRegionStrictMode.react","Locale","focusScopeQueries","react","react-compiler-runtime","useOnOutsideClick"],(function(t,n,r,o,a,i,l){"use strict";var e=["children","disableAutoFocus","id","onClose","onOutsideClick","type","xstyle"],s,u=s||(s=o("react")),c=s.useContext,d={arrow:{position:"x10l6tqk",$$css:!0},container:{display:"x78zum5",$$css:!0},content:{backgroundColor:"x1h0vfkc",borderStartStartRadius:"x1obq294",borderStartEndRadius:"x5a5i1n",borderEndEndRadius:"xde0f50",borderEndStartRadius:"x15x8krk",borderTopWidth:"x178xt8z",borderInlineEndWidth:"x1lun4ml",borderBottomWidth:"xso031l",borderInlineStartWidth:"xpilrb4",boxShadow:"xofhs1l",paddingTop:"xyamay9",paddingBottom:"x1l90r2v",paddingInlineStart:"x1g0dm76",paddingInlineEnd:"xpdmqnj",paddingLeft:null,paddingRight:null,$$css:!0}},m={accent:{backgroundColor:"xdk9wry",$$css:!0},default:{backgroundColor:"x9bbmet",$$css:!0}},p={above:{marginBottom:"x1yztbdb",$$css:!0},below:{marginTop:"xw7yly9",$$css:!0},end:{marginInlineStart:"xyqm7xq",$$css:!0}},_={above:{bottom:"x1wa3icf",$$css:!0},below:{top:"x1jzctok",transform:"x1oihik5",$$css:!0},end:{$$css:!0}},f={above:{bottom:"x1wa3icf",$$css:!0},below:{top:"x1jzctok",transform:"x1oihik5",$$css:!0},end:{$$css:!0}};function g(t){var n,a,i=o("react-compiler-runtime").c(38),l,s,_,f,g,y,b,v;i[0]!==t?(s=t.children,y=t.disableAutoFocus,_=t.id,f=t.onClose,g=t.onOutsideClick,b=t.type,v=t.xstyle,l=babelHelpers.objectWithoutPropertiesLoose(t,e),i[0]=t,i[1]=l,i[2]=s,i[3]=_,i[4]=f,i[5]=g,i[6]=y,i[7]=b,i[8]=v):(l=i[1],s=i[2],_=i[3],f=i[4],g=i[5],y=i[6],b=i[7],v=i[8]);var S=y===void 0?!1:y,R=b===void 0?"default":b,L=c(r("BaseContextualLayerOrientationContext")),E=L.align,k=L.position,I=E==="stretch"?"start":E,T=k==="start"?"above":k==="end"?"below":k,D=c(r("BaseContextualLayerContextSizeContext")),x=(n=c(r("BaseContextualLayerLayerAdjustmentContext")))!=null?n:0,$=(a=D==null?void 0:D.width)!=null?a:0,P;i[9]!==I||i[10]!==x||i[11]!==T||i[12]!==$?(P=C(I,T,$,x),i[9]=I,i[10]=x,i[11]=T,i[12]=$,i[13]=P):P=i[13];var N=P,M=N[0],w=N[1],A=r("useOnOutsideClick")(g),F=_!=null?_:void 0,O=S?void 0:o("focusScopeQueries").tabbableScopeQuery,B=m[R],W=p[T],q;i[14]!==B||i[15]!==W||i[16]!==v?(q=[d.content,B,W,v],i[14]=B,i[15]=W,i[16]=v,i[17]=q):q=i[17];var U;i[18]!==s||i[19]!==A||i[20]!==q?(U=u.jsx(r("BaseRow.react"),{ref:A,xstyle:q,children:s}),i[18]=s,i[19]=A,i[20]=q,i[21]=U):U=i[21];var V;i[22]!==w||i[23]!==T||i[24]!==R?(V=u.jsx(h,{arrowStyles:w,position:T,type:R}),i[22]=w,i[23]=T,i[24]=R,i[25]=V):V=i[25];var H;i[26]!==f||i[27]!==U||i[28]!==V?(H=u.jsxs(r("CometHideLayerOnEscape.react"),{onHide:f,children:[U,V]}),i[26]=f,i[27]=U,i[28]=V,i[29]=H):H=i[29];var G;i[30]!==H||i[31]!==O?(G=u.jsx(o("FocusRegionStrictMode.react").FocusRegion,{autoFocusQuery:O,children:H}),i[30]=H,i[31]=O,i[32]=G):G=i[32];var z;return i[33]!==l||i[34]!==M||i[35]!==G||i[36]!==F?(z=u.jsx(r("BaseView.react"),babelHelpers.extends({},l,{id:F,role:"dialog",style:M,xstyle:d.container,children:G})),i[33]=l,i[34]=M,i[35]=G,i[36]=F,i[37]=z):z=i[37],z}function h(e){var t=o("react-compiler-runtime").c(7),n=e.arrowStyles,a=e.position,i=e.type,l=i==="default"?"var(--popover-background)":"var(--callout-background-color-accent, var(--accent))",s=_[a],c=i==="accent"&&f[a],m;t[0]!==s||t[1]!==c?(m=[d.arrow,s,c],t[0]=s,t[1]=c,t[2]=m):m=t[2];var p;return t[3]!==n||t[4]!==l||t[5]!==m?(p=u.jsx(r("FDSCalloutInsetArrow.svg.react"),{fill:l,style:n,xstyle:m}),t[3]=n,t[4]=l,t[5]=m,t[6]=p):p=t[6],p}var y=o("Locale").isRTL();function C(e,t,n,r){var o=Math.max(n/2-8,16)+Math.abs(r),a=n/2-8<16,i=24-n/2;if(t==="above")if(e==="start"){var l,s=y?"right":"left";return[a?{transform:"translateX("+(y?i:-i)+"px)"}:void 0,(l={},l[s]="min(calc(100% - 32px), "+o+"px)",l)]}else if(e==="end"){var u,c=y?"left":"right";return[a?{transform:"translateX("+(y?-i:i)+"px)"}:void 0,(u={},u[c]="min(calc(100% - 32px), "+o+"px)",u)]}else{var d,m=y?"left":"right",p=(y?-r:r)-8;return[void 0,(d={},d[m]="calc(50% + "+p+"px)",d)]}else if(e==="start"){var _,f=y?"right":"left";return[a?{transform:"translateX("+(y?i:-i)+"px)"}:void 0,(_={},_[f]="min(calc(100% - 32px), "+o+"px)",_)]}else if(e==="end"){var g,h=y?"left":"right";return[a?{transform:"translateX("+(y?-i:i)+"px)"}:void 0,(g={},g[h]="min(calc(100% - 32px), "+o+"px)",g)]}else{var C,b=y?"left":"right",v=(y?-r:r)-8;return[void 0,(C={},C[b]="calc(50% + "+v+"px)",C)]}}l.default=g}),98);
__d("FDSCallout.react",["fbt","ix","BaseContextualLayerOrientationContext","BasePopoverReflowSheetContext","BaseRow.react","BaseRowItem.react","BaseView.react","CometColumn.react","CometColumnItem.react","CometErrorBoundary.react","CometHideLayerOnEscape.react","FBLogger","FDSCalloutEdge.react","FDSCalloutInset.react","FDSIcon.react","FDSTextPairing.react","FocusRegionStrictMode.react","fbicon","focusScopeQueries","react","react-compiler-runtime","useOnOutsideClick","useVisibilityObserver"],(function(t,n,r,o,a,i,l,s,u){"use strict";var e,c=e||(e=o("react")),d=e,m=d.useContext,p=d.useMemo,_={container:{display:"x78zum5",$$css:!0},content:{backgroundColor:"x1h0vfkc",borderStartStartRadius:"x1obq294",borderStartEndRadius:"x5a5i1n",borderEndEndRadius:"xde0f50",borderEndStartRadius:"x15x8krk",borderTopWidth:"x178xt8z",borderInlineEndWidth:"x1lun4ml",borderBottomWidth:"xso031l",borderInlineStartWidth:"xpilrb4",boxShadow:"xofhs1l",paddingTop:"xyamay9",paddingBottom:"x1l90r2v",paddingInlineStart:"x1g0dm76",paddingInlineEnd:"xpdmqnj",paddingLeft:null,paddingRight:null,$$css:!0},crossoutButton:{marginInlineEnd:"x1lxpwgx",marginTop:"x9otpla",$$css:!0},fitContent:{width:"xeq5yr9",$$css:!0},item:{paddingTop:"x1yrsyyn",paddingBottom:"x10b6aqq",paddingInlineStart:"x25sj25",paddingInlineEnd:"x1icxu4v",paddingLeft:null,paddingRight:null,$$css:!0}},f={accent:{backgroundColor:"xdk9wry",$$css:!0},default:{backgroundColor:"x9bbmet",$$css:!0}},g={above:{marginBottom:"x12nagc",$$css:!0},below:{marginTop:"x1gslohp",$$css:!0},end:{marginInlineStart:"xdwrcjd",$$css:!0},start:{$$css:!0}};function h(e){var t=o("react-compiler-runtime").c(66),n=e.arrowStyle,a=e.calloutID,i=e.content,l=e.contentID,d=e.disableAutoFocus,p=e.onClose,h=e.onHide,C=e.onOutsideClick,b=e.onShow,v=e.titleID,S=e.type,R=e.xstyle,L=e.addOn,E=e["aria-label"],k=e.hasCloseButton,I=e.title,T=n===void 0?"none":n,D=d===void 0?!1:d,x=S===void 0?"default":S,$=k===void 0?!0:k,P=m(r("BaseContextualLayerOrientationContext")),N=P.position,M=r("useOnOutsideClick")(C),w=m(r("BasePopoverReflowSheetContext")),A=w.isReflowSheet,F;t[0]!==h||t[1]!==b?(F={onHidden:h,onVisible:b},t[0]=h,t[1]=b,t[2]=F):F=t[2];var O=r("useVisibilityObserver")(F),B=x==="default"?"primary":"white";if(N==="end"&&(T==="inset"||T==="edge"))throw r("FBLogger")("comet_ui").mustfixThrow('"end" position with arrow is not supported yet');var W;t[3]!==E||t[4]!==l||t[5]!==I||t[6]!==v?(W=I!=null?{"aria-describedby":l,"aria-labelledby":v}:{"aria-describedby":l,"aria-label":E},t[3]=E,t[4]=l,t[5]=I,t[6]=v,t[7]=W):W=t[7];var q=W,U;t[8]!==B||t[9]!==i||t[10]!==l||t[11]!==I||t[12]!==v?(U=c.jsx(r("FDSTextPairing.react"),{body:i,bodyColor:B,bodyId:l,headline:I,headlineColor:B,headlineId:v,isSemanticHeading:!0,level:3}),t[8]=B,t[9]=i,t[10]=l,t[11]=I,t[12]=v,t[13]=U):U=t[13];var V;t[14]!==U||t[15]!==O?(V=c.jsx(r("BaseRowItem.react"),{expanding:!0,ref:O,verticalAlign:"center",xstyle:_.item,children:U}),t[14]=U,t[15]=O,t[16]=V):V=t[16];var H;t[17]!==$||t[18]!==p||t[19]!==x?(H=$&&c.jsx(r("BaseRowItem.react"),{xstyle:[_.crossoutButton,_.item],children:c.jsx(r("FDSIcon.react"),{"aria-label":s._(/*BTDS*/"Close"),color:x==="default"?"secondary":"white",focusable:!0,icon:o("fbicon")._(u("478232"),16),onPress:p,size:16})}),t[17]=$,t[18]=p,t[19]=x,t[20]=H):H=t[20];var G;t[21]!==V||t[22]!==H?(G=c.jsx(r("CometColumnItem.react"),{children:c.jsxs(r("BaseRow.react"),{children:[V,H]})}),t[21]=V,t[22]=H,t[23]=G):G=t[23];var z;t[24]!==L?(z=L!=null&&c.jsx(r("CometColumnItem.react"),{paddingTop:12,children:c.jsx(r("BaseRow.react"),{children:c.jsx(r("BaseRowItem.react"),{expanding:!0,verticalAlign:"center",xstyle:_.item,children:L})})}),t[24]=L,t[25]=z):z=t[25];var j;t[26]!==G||t[27]!==z?(j=c.jsxs(r("CometColumn.react"),{children:[G,z]}),t[26]=G,t[27]=z,t[28]=j):j=t[28];var K=j;if(!A&&T==="inset"){var Q;return t[29]!==q||t[30]!==a||t[31]!==K||t[32]!==D||t[33]!==p||t[34]!==C||t[35]!==x||t[36]!==R?(Q=c.jsx(r("FDSCalloutInset.react"),babelHelpers.extends({},q,{disableAutoFocus:D,id:a,onClose:p,onOutsideClick:C,type:x,xstyle:R,children:K})),t[29]=q,t[30]=a,t[31]=K,t[32]=D,t[33]=p,t[34]=C,t[35]=x,t[36]=R,t[37]=Q):Q=t[37],Q}if(!A&&T==="edge"){var X;return t[38]!==q||t[39]!==a||t[40]!==K||t[41]!==D||t[42]!==p||t[43]!==C||t[44]!==x||t[45]!==R?(X=c.jsx(r("FDSCalloutEdge.react"),babelHelpers.extends({},q,{disableAutoFocus:D,id:a,onClose:p,onOutsideClick:C,type:x,xstyle:R,children:K})),t[38]=q,t[39]=a,t[40]=K,t[41]=D,t[42]=p,t[43]=C,t[44]=x,t[45]=R,t[46]=X):X=t[46],X}var Y=a!=null?a:void 0,J=D?void 0:o("focusScopeQueries").tabbableScopeQuery,Z=f[x],ee=T==="none"&&g[N],te=A&&_.fitContent,ne;t[47]!==Z||t[48]!==ee||t[49]!==te||t[50]!==R?(ne=[_.content,Z,ee,R,te],t[47]=Z,t[48]=ee,t[49]=te,t[50]=R,t[51]=ne):ne=t[51];var re;t[52]!==K||t[53]!==M||t[54]!==ne?(re=c.jsx(r("BaseRow.react"),{ref:M,xstyle:ne,children:K}),t[52]=K,t[53]=M,t[54]=ne,t[55]=re):re=t[55];var oe;t[56]!==p||t[57]!==re?(oe=c.jsx(r("CometHideLayerOnEscape.react"),{onHide:p,children:re}),t[56]=p,t[57]=re,t[58]=oe):oe=t[58];var ae;t[59]!==J||t[60]!==oe?(ae=c.jsx(o("FocusRegionStrictMode.react").FocusRegion,{autoFocusQuery:J,children:oe}),t[59]=J,t[60]=oe,t[61]=ae):ae=t[61];var ie;return t[62]!==q||t[63]!==Y||t[64]!==ae?(ie=c.jsx(r("CometErrorBoundary.react"),{fallback:y,children:c.jsx(r("BaseView.react"),babelHelpers.extends({},q,{id:Y,role:"dialog",xstyle:_.container,children:ae}))}),t[62]=q,t[63]=Y,t[64]=ae,t[65]=ie):ie=t[65],ie}function y(){return c.jsx("div",{})}y.displayName=y.name+" [from "+i.id+"]",l.default=h}),226);
__d("FDSCalloutImpl.react",["BaseCalloutImpl.react","FDSCallout.react","FDSCalloutContext","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e=["disableOutsideClick","onClose"],s,u=s||(s=o("react")),c=s.useContext;function d(t){var n=o("react-compiler-runtime").c(23),a=t.calloutID,i=t.calloutProps,l=t.contentID,s=t.titleID,d=c(r("FDSCalloutContext"));if(d==null||i==null)return null;var m,p,_;n[0]!==i?(p=i.disableOutsideClick,_=i.onClose,m=babelHelpers.objectWithoutPropertiesLoose(i,e),n[0]=i,n[1]=m,n[2]=p,n[3]=_):(m=n[1],p=n[2],_=n[3]);var f;n[4]!==d||n[5]!==a||n[6]!==_?(f=function(){d.removeCallout(a),_==null||_()},n[4]=d,n[5]=a,n[6]=_,n[7]=f):f=n[7];var g;n[8]!==d||n[9]!==a||n[10]!==p||n[11]!==_?(g=function(){p!==!0&&(d.removeCallout(a),_==null||_())},n[8]=d,n[9]=a,n[10]=p,n[11]=_,n[12]=g):g=n[12];var h;n[13]!==a||n[14]!==m||n[15]!==l||n[16]!==f||n[17]!==g||n[18]!==s?(h=u.jsx(r("FDSCallout.react"),babelHelpers.extends({},m,{calloutID:a,contentID:l,onClose:f,onOutsideClick:g,titleID:s})),n[13]=a,n[14]=m,n[15]=l,n[16]=f,n[17]=g,n[18]=s,n[19]=h):h=n[19];var y;return n[20]!==t||n[21]!==h?(y=u.jsx(r("BaseCalloutImpl.react"),babelHelpers.extends({},t,{children:h})),n[20]=t,n[21]=h,n[22]=y):y=n[22],y}l.default=d}),98);
__d("LogBrowserCrashReportsLowerRetentionFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("856"),s=o("FalcoLoggerInternal").create("log_browser_crash_reports_lower_retention",e),u=s;l.default=u}),98);
__d("QPLCrashResiliencePlugin",["FBLogger","QPLEvent","QPLMarkerMap","QuickPerformanceLogger","RSTLogForCrash","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(){if(r("gkx")("11050")!==!1){var e=new m().getListener();(s||(s=r("QuickPerformanceLogger"))).addListener(e)}}var c=100,d=10,m=(function(){function t(){var e=this;this.$2=!1,this.$1=new(r("QPLMarkerMap"))({totalLimit:c,perMarkerLimit:d}),o("RSTLogForCrash").logForCrashReadyPromise.getPromise().then(function(){e.$2=!0,e.$3()}).catch(function(){})}var n=t.prototype;return n.$3=function(){var e=this;(s||(s=r("QuickPerformanceLogger"))).activeMarkers.forEach(function(t,n){t.forEach(function(t,r){t.isCrashResilient&&e.$1.set(n,r,1)})}),this.$4()},n.$4=function(){if(this.$2){var e=this.$1.toString();o("RSTLogForCrash").isValidStringValue(e)||(e="{}",r("FBLogger")("qpl-crash-resilience-js").warn("Exceeded RST log limit")),o("RSTLogForCrash").logForCrash("active_qpls",e,o("RSTLogForCrash").RSTLogMode.VALID_UNTIL_NEXT_WRITE,{immediateFlush:!0})}},n.getListener=function(){var e=this,t=this;return{onMarkerStarted:function(n,r,o,a){t.onMarkerStarted(n,r,o,a)},onMarkerEnd:function(n,r,o,a,i){return e.onMarkerEnd(n,r,o,a,i)},onMarkerDrop:function(n,r,o,a){t.onMarkerDrop(n,r,o,a)}}},n.onMarkerStarted=function(n,r,a,i){var t,l=(t=i.isCrashResilient)!=null?t:!1;l&&(this.$1.set((e||(e=o("QPLEvent"))).getMarkerId(n),r,1),this.$4())},n.onMarkerEnd=function(n,r,a,i,l){var t,s=(t=l.isCrashResilient)!=null?t:!1;!l.passesSampling||!s||(this.$1.delete((e||(e=o("QPLEvent"))).getMarkerId(r),a),this.$4())},n.onMarkerDrop=function(n,r,a,i){var t,l=(t=i.isCrashResilient)!=null?t:!1;!i.passesSampling||!l||(this.$1.delete((e||(e=o("QPLEvent"))).getMarkerId(n),r),this.$4())},t})();l.startQPLCrashResilience=u}),98);
__d("RSTAdsManagerUtilsMainThread",["requireWeak"],(function(t,n,r,o,a,i,l){"use strict";var e=null;r("requireWeak")("AdsAccountStore",function(t){e=t});var s=null;r("requireWeak")("AdsPERouterHelper",function(e){s=e});function u(){try{var e,t,n,r,o,a=(e=(t=s)==null||(t=t.getRouter())==null?void 0:t.getQueryParams())!=null?e:{},i=a.selected_ad_ids,l=a.selected_adset_ids,u=a.selected_campaign_ids,c=(n=i==null?void 0:i.toArray())!=null?n:[],d=(r=l==null?void 0:l.toArray())!=null?r:[],m=(o=u==null?void 0:u.toArray())!=null?o:[];return{adIds:c.map(function(e){return String(e)}),adsetIds:d.map(function(e){return String(e)}),campaignIds:m.map(function(e){return String(e)})}}catch(e){return{adIds:[],adsetIds:[],campaignIds:[]}}}function c(){var t,n;return(t=(n=e)==null?void 0:n.getSelectedAccountID())!=null?t:"0"}function d(){var t,n;return(t=(n=e)==null?void 0:n.getSelectedBusinessID())!=null?t:"0"}function m(){return{}}l.getAdEntityIds=u,l.getAdAccountID=c,l.getBusinessID=d,l.getAdsAnnotations=m}),98);
__d("RSTExternalLoggingDataStoreMainThread",["FBLogger","RSTConfig","RSTLogForCrash","getErrorSafe","nextCrashLoggingSpanId"],(function(t,n,r,o,a,i,l){var e=500,s=5e3,u=500,c=(function(){function t(){this.$5=!1,this.$1=new Map,this.$2=new Map,this.$3=new Map,this.$4=new Map}var n=t.prototype;return n.isValidValue=function(t){return t==null||t.length<=s},n.$6=function(n,o,a){return n.length>e||!this.isValidValue(o)?(this.$5||r("FBLogger")("responsive-tracker").warn(a,n,o),this.$5=!0,!1):this.totalStoredPairCount()>u?(this.$5||r("FBLogger")("responsive-tracker").warn("Too many key-value pairs for external span logging data (ignored)"),this.$5=!0,!1):!0},n.logSpanEnd=function(t){this.$4.delete(t)},n.logSpanStart=function(t,n){if(n===void 0&&(n=null),!this.$6(t,n,"Invalid key or annotation for external logging data (ignored), key: %s, annotation: %s"))return-1;var e=this.$7(t,n),r=o("nextCrashLoggingSpanId").nextCrashLoggingSpanId();return this.$4.set(r,{id:r,name:t,start:Date.now(),annotation:e}),r},n.log=function(t,n,a){if(!this.$6(t,n,"Invalid key or value for external logging data (ignored), key: %s, value: %s"))return!1;var e=!1;if(a===o("RSTLogForCrash").RSTLogMode.VALID_UNTIL_NEXT_HEARTBEAT)e=this.$8(this.$2,t,n),this.$2.set(t,n);else if(a===o("RSTLogForCrash").RSTLogMode.VALID_UNTIL_NEXT_WRITE)e=this.$8(this.$1,t,n),this.$1.set(t,n);else if(a===o("RSTLogForCrash").RSTLogMode.VALID_FOR_5_SECONDS||a===o("RSTLogForCrash").RSTLogMode.VALID_FOR_2_MINUTES){var i;e=!0,this.$3.set(t,{value:n,createTime:Date.now(),expirationTime:(i=o("RSTLogForCrash").getExpirationTime(a))!=null?i:Date.now()})}else r("FBLogger")("responsive-tracker").warn("Invalid logMode");return e},n.$8=function(t,n,r){return!t.has(n)||t.get(n)!==r},n.totalStoredPairCount=function(){return this.$1.size+this.$2.size+this.$3.size+this.$4.size},n.get=function(t){if(this.$2.has(t))return this.$2.get(t)||null;if(this.$1.has(t))return this.$1.get(t)||null;var e=this.$3.get(t);if(e!=null){if(Date.now()<e.expirationTime)return e.value;this.$3.delete(t)}return null},n.clear=function(){this.$1.clear(),this.clearNextHeartbeatStore()},n.clearNextHeartbeatStore=function(){this.$2.clear()},n.clearSpanStore=function(){this.$4.clear()},n.getAllSpanData=function(){var e={};return this.$4.forEach(function(t,n){e[""+n]=t}),e},n.$9=function(){var e=Date.now();for(var t of this.$3){var n=t[0],r=t[1];e>=r.expirationTime&&this.$3.delete(n)}},n.getTimedStoreData=function(){return this.$9(),Object.fromEntries(Array.from(this.$3.entries()).map(function(e){var t=e[0],n=e[1];return[t,n.value]}))},n.getAll=function(){return babelHelpers.extends({},this.getTimedStoreData(),Object.fromEntries(this.$1),Object.fromEntries(this.$2))},n.$7=function(t,n){var e=r("RSTConfig").logSpanAnnotationsMapping.get(t);if(e!=null)try{return e(t,n)}catch(e){r("FBLogger")("responsive-tracker").catching(r("getErrorSafe")(e)).warn("Failed to attach built-in annotations for key %s",t)}return n},t})(),d=new c;l.loggingDataStore=d}),98);
__d("RSTClearExternalLoggingDataStoreMainThread",["RSTEvents","RSTEventsMessageQueue","RSTExternalLoggingDataStoreMainThread"],(function(t,n,r,o,a,i,l){"use strict";function e(){o("RSTExternalLoggingDataStoreMainThread").loggingDataStore.clearNextHeartbeatStore()}function s(){o("RSTEventsMessageQueue").subscribe(o("RSTEvents").RSTEvent.HEART_BEAT,e),o("RSTEventsMessageQueue").subscribe(o("RSTEvents").RSTEvent.BROWSER_TAB_BACKGROUND,e),o("RSTEventsMessageQueue").subscribe(o("RSTEvents").RSTEvent.BROWSER_TAB_FOREGROUND,e)}l.registerClearExternalLoggingData=s}),98);
__d("RSTUtilsMainThread",["CurrentUser","RSTConfig"],(function(t,n,r,o,a,i,l){"use strict";var e=new Map;function s(t){if(e.has(t)){var n,r=(n=e.get(t))!=null?n:0;return r<=0?(e.delete(t),!1):(e.set(t,r-1),!0)}return e.set(t,Math.floor(Math.random()*10)),!0}var u=r("CurrentUser").getAppID();function c(e){switch(e){case""+0x6c6c24b58878:return"Ads";case""+0x7e36f3fcc43bc:return"Comet";case""+0x770a46dafb86b:return"Business";default:return"(Unset-in-RST)"}}var d=new Set([0x6c6c24b58878,0x770a46dafb86b,514771569228061].map(function(e){return""+e})),m=u!=null&&d.has(u),p=c(u);function _(e){if(e==null)return null;for(var t of e)if(!r("RSTConfig").isReactComponentNameBlocked(t))return t;return null}function f(e,t,n){if(n===void 0&&(n=r("RSTConfig").DEFAULT_REACT_COMPONENT_CONTEXT_SIZE),e==null)return null;var o=new Set,a=[];for(var i of e){if(a.length>=n)break;!o.has(i)&&!t(i)&&(a.push(i),o.add(i))}return a}l.shouldSkipProcessingIncident=s,l.isMonetizationApp=m,l.appName=p,l.getAllowListedComponentName=_,l.getReactComponentContext=f}),98);
__d("RSTIncidentLoggingMainThread",["Env","InteractionTracingConfigDefault","QPLEvent","RSTConfig","RSTConstants","RSTEvents","RSTEventsMessageQueue","RSTUtils","RSTUtilsMainThread","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=r("requireDeferred")("LogBrowserCrashReportsLowerRetentionFalcoEvent").__setRef("RSTIncidentLoggingMainThread"),c=new Set;function d(){return c}function m(e){var t,n,a,i,l,s,u,c,d,m,_=e.unresponsiveEvent,h=_!=null?Date.now()-(_==null?void 0:_.detectTime):0,y=_==null?void 0:_.lastHeartBeatMetadata,C=(y==null?void 0:y.brsid)!=null?String(y.brsid):null,b=(t=y==null?void 0:y.cpp)!=null?t:null,v=(n=y==null?void 0:y.ccrt)!=null?n:null,S=(a=y==null?void 0:y.cr)!=null?a:null,R=(i=y==null?void 0:y.annotations)!=null?i:{},L=(l=y==null?void 0:y.spans)!=null?l:{},E=e.isRecoverable?r("RSTConstants").reportReason.recoverable:(_==null?void 0:_.incidentType)!==r("RSTConstants").incidentType.unexpectedExit?r("RSTConstants").reportReason.unrecoverable:r("RSTConstants").reportReason.unexpectedExit,k=_==null?void 0:_.traces,I=g(k),T=I.qplMarkerId,D=I.tracePolicy,x=f(_==null?void 0:_.lastTrace);return{application_name:o("RSTUtilsMainThread").appName,reason:E,url:o("RSTUtils").sanitizeURL(y==null?void 0:y.url),age:String(h),brsid:C,qpl_event_marker_id:o("RSTUtils").intToString(T),trace_policy:D,last_qpl_event_marker_id:o("RSTUtils").intToString(x.qplMarkerId),last_trace_policy:x.tracePolicy,ad_account_id:(s=y==null?void 0:y.i2)!=null?s:"0",business_id:(u=y==null?void 0:y.i3)!=null?u:"0",canonical_route:v,client_push_phase:b,client_revision:S,freeze_time_in_ms:String((c=_==null?void 0:_.unrecoverLastsForMs)!=null?c:0),normalized_component_stack:(d=y==null?void 0:y.rcs)!=null?d:[],session_start_timestamp_in_ms:String((m=y==null?void 0:y.st)!=null?m:""),rst_annotations:p(R,L,_)}}function p(e,t,n){var o,a=[];for(var i of Object.keys(e))a.push(i+":"+e[i]);var l=n==null?void 0:n.detectTime;for(var u of Object.keys(t)){var c,d=t[u],m=l!=null?l-d.start:0;a.push("span:"+d.name+":"+((c=d.annotation)!=null?c:"")+":"+m)}return a.push("processingBrsid:"+((o=(s||(s=r("Env"))).brsid)!=null?o:"")),_(a,n),a}function _(e,t){if(!r("RSTConfig").shouldCollectAdditionalMetadata())return e;var n=t==null?void 0:t.lastTrace,o=n==null?void 0:n.endTimestamp,a=t==null?void 0:t.detectTime;o!=null&&a!=null&&e.push("msSinceLastInteractionEnds:"+(a-o));var i=t!=null?t:{},l=i.incidentID;return l!=null&&e.push("incidentID:"+l),(t==null?void 0:t.isFirstUnrecoverable)===!0&&e.push("isFirstUnrecoverable:true"),(t==null?void 0:t.hasOverlappingResponsiveIndicents)===!0&&e.push("hasOverlappingResponsiveIndicents:true"),(t==null?void 0:t.hasDecryptionError)===!0&&e.push("hasDecryptionError:true"),e}function f(t){if(t==null)return{qplMarkerId:null,tracePolicy:null};if(t.qplEvent==null)return{qplMarkerId:null,tracePolicy:null};var n=(e||(e=o("QPLEvent"))).getMarkerId(t.qplEvent),r=t.tracePolicy;return{qplMarkerId:n,tracePolicy:r}}function g(e){if(e==null)return{qplMarkerId:null,tracePolicy:null};var t=0,n=null;return e.forEach(function(e){(e==null?void 0:e.qplEvent)==null||e.tracePolicy===o("InteractionTracingConfigDefault").DEFAULT_TRACING_CONFIG.defaultTracePolicy||e.startTime>t&&(t=e.startTime,n=e)}),f(n)}function h(e,t){u.onReady(function(n){var r=n.log;r(function(){return m({unresponsiveEvent:e,isRecoverable:t})})})}function y(){r("RSTConfig").SHOULD_SAMPLE_RECOVERABLE&&o("RSTEventsMessageQueue").subscribe(o("RSTEvents").RSTEvent.RECOVERABLE_UNRESPONSIVENESS,function(e){var t=e.unresponsiveEventRecord;t==null||c.has(t.incidentID)||(c.add(t.incidentID),o("RSTUtils").debugLogImportant("logging recoverable unresponsiveness event"),h(t,!0))}),o("RSTEventsMessageQueue").subscribe(o("RSTEvents").RSTEvent.CRASH_INCIDENT,function(e){var t=e.unresponsiveEventRecord;if(t==null||c.has(t.incidentID)){o("RSTUtils").debugLogImportant("not logging incident because it was already logged");return}if(r("RSTConfig").ONE_UNRECOVERABLE_INCIDENT_PER_SESSION&&t.isFirstUnrecoverable!==!0){var n,a=(n=t.incidentType)!=null?n:"";o("RSTUtils").debugLogImportant("not logging unrecoverable "+a+" event (because it's not the first incident in the session)");return}c.add(t.incidentID),o("RSTUtils").debugLogImportant("logging unrecoverable unresponsiveness event:"),h(t,!1)})}l.getLoggedIncidentIDs=d,l.registerIncidentLogging=y}),98);
__d("RSTLocalStorageMainThread",["FBLogger","WebStorage","fb-error"],(function(t,n,r,o,a,i,l){"use strict";var e,s="RSTData",u=200,c=2880*60*1e3,d=(function(){function t(){this.$2=!0,this.$1=(e||(e=r("WebStorage"))).getLocalStorage(),this.probeAndInit()}var n=t.prototype;return n.$3=function(t,n){var e=r("fb-error").getErrorSafe(t);r("FBLogger")("responsive-tracker").catching(e).warn("%s error in RSTLocalStorage",n)},n.$4=function(){if(!this.$2)return{};try{var e,t=(e=this.$1)==null?void 0:e.getItem(s),n=t!=null?JSON.parse(t):{};return typeof n=="object"&&n!==null?n:{}}catch(e){return this.$3(e,"readStore"),{}}},n.$5=function(t){if(this.$2)try{var e;(e=this.$1)==null||e.setItem(s,JSON.stringify(t))}catch(e){this.$3(e,"writeStore");return}},n.probeAndInit=function(){if(this.$1==null){this.$2=!1;return}var e=this.$1;try{var t=e.getItem(s);if(t!=null)return;e.setItem(s,"{}")}catch(e){this.$3(e,"probeAndInit"),this.$2=!1}},n.cleanUpExpiredEntries=function(){if(this.$2)try{var e=this.$6(this.$4());this.$5(e)}catch(e){this.$3(e,"cleanUpExpiredEntries");return}},n.$6=function(t){var e=Date.now();for(var n of Object.entries(t)){var r=n[0],o=n[1];(e-o.lastWriteTime>c||typeof o.lastWriteTime!="number")&&delete t[r]}return t},n.$7=function(t){var e=Object.entries(t);if(e.length<=u)return t;e.sort(function(e,t){return e[1].lastWriteTime-t[1].lastWriteTime});var n=e.slice(e.length-u);return Object.fromEntries(n)},n.set=function(t,n){if(this.$2){var e=this.$4();e=this.$6(e),e[t]={value:n,lastWriteTime:Date.now()},e=this.$7(e),this.$5(e)}},n.get=function(t){if(!this.$2)return null;var e=this.$4(),n=e[t];return n?n.value:null},n.delete=function(t){try{if(!this.$2)return;var e=this.$4();delete e[t],this.$5(e)}catch(e){this.$3(e,"delete");return}},n.has=function(t){if(!this.$2)return!1;var e=this.$4(),n=e[t];return n?Date.now()-n.lastWriteTime<=c:!1},n.clear=function(){this.$2&&this.$5({})},n.keys=function(){if(!this.$2)return[];var e=this.$6(this.$4());return Object.keys(e)},n.entries=function(){if(!this.$2)return[];var e=this.$6(this.$4());return Object.entries(e).map(function(e){var t=e[0],n=e[1];return[t,n.value]})},t})(),m=new d,p=m;l.default=p}),98);
__d("RSTMarkFirstUnrecoverableMainThread",["FBLogger","RSTLocalStorageMainThread","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e="rst-first-unrecoverable-marking";async function s(t){var n=t.incidentID,o=t.sessionID,a=o+":first-unrecoverable";try{"locks"in navigator&&await navigator.locks.request(e,function(){r("RSTLocalStorageMainThread").has(a)||(r("RSTLocalStorageMainThread").set(a,n),t.isFirstUnrecoverable=!0)})}catch(e){r("FBLogger")("responsive-tracker").catching(r("getErrorSafe")(e)).warn("Failed to acquire lock for marking first unrecoverable incident")}}l.markFirstUnrecoverableIncident=s}),98);
__d("RSTSessionID",["Env","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e,s=null;function u(){if(s!=null)return s;var t=(e||(e=r("Env"))).brsid!=null?""+(e||(e=r("Env"))).brsid:r("uuidv4")(),n="rst-"+Date.now();return s=n+"-"+t,s}l.getSessionID=u}),98);
__d("ResponsiveTrackerMainThread",["ClientServiceWorkerMessage","FBLogger","RSTCloseObserver","RSTConfig","RSTConstants","RSTEvents","RSTEventsMessageQueue","RSTEventsRegisterUseCasesMainThread","RSTIncidentLoggingMainThread","RSTIndexedDBSafe","RSTLocalStorageMainThread","RSTMarkFirstUnrecoverableMainThread","RSTMetadataCollectorMainThread","RSTMetadataMainThread","RSTSessionID","RSTUtils","RSTUtilsMainThread","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";r("RSTEventsRegisterUseCasesMainThread")();var e=(function(){function e(){this.$1=null,this.$2=new Set,this.$3=!1,this.$4=!1}var t=e.prototype;return t.init=function(t){this.$1=t,this.startLoggingUnresponsiveEvents(),this.startSendingHeartBeatToWorker(),this.startMonitorPageHiding(),this.startMonitoringPageUnload(),o("RSTMetadataCollectorMainThread").start(),r("RSTLocalStorageMainThread").probeAndInit(),r("RSTIndexedDBSafe").maybeClearObsoleteIncidents()},t.startLoggingUnresponsiveEvents=function(){var e=this;this.logAndDeleteUnresponsiveEvents(),window.setInterval(function(){e.logAndDeleteUnresponsiveEvents()},r("RSTConfig").MAIN_THREAD_LOGGING_INTERVAL_MS)},t.startSendingHeartBeatToWorker=function(){var e=this;window.setInterval(function(){e.postEvent(o("RSTEvents").RSTEvent.HEART_BEAT)},r("RSTConfig").HEART_BEAT_INTERVAL_MS)},t.startMonitorPageHiding=function(){var e=this;document.addEventListener("visibilitychange",function(){document.hidden?e.postEvent(o("RSTEvents").RSTEvent.BROWSER_TAB_BACKGROUND):e.postEvent(o("RSTEvents").RSTEvent.BROWSER_TAB_FOREGROUND)})},t.startMonitoringPageUnload=function(){o("RSTCloseObserver").initPageCloseObserver()},t.postEvent=function(t,n){n===void 0&&(n=o("RSTMetadataMainThread").getMainThreadMetadata());var e={type:r("RSTConfig").MESSAGE_TYPE,event:t,eventTime:Date.now(),DOMData:{hidden:document.hidden},sessionID:o("RSTSessionID").getSessionID(),metadata:n};o("RSTEventsMessageQueue").notify(t,{mainToWorkerMessage:e}),this.$5(e),this.$6(e)},t.postEventLightweight=function(t,n){n===void 0&&(n=o("RSTMetadataMainThread").getMainThreadMetadataWithExternalAnnotationsOnly());var e={type:r("RSTConfig").MESSAGE_TYPE,event:t,eventTime:Date.now(),DOMData:{hidden:document.hidden},sessionID:o("RSTSessionID").getSessionID(),metadata:n};o("RSTEventsMessageQueue").notify(t,{mainToWorkerMessage:e}),this.$5(e),this.$6(e)},t.$6=function(t){try{var e;(e=this.$1)==null||e.postMessage(t)}catch(e){var n;if(this.$4)return;var o=r("getErrorSafe")(e);r("FBLogger")("responsive-tracker").catching(o).warn((n=o.message)!=null?n:"Failed to post message to web worker"),this.$4=!0}},t.$5=function(t){if(r("RSTConfig").ENABLE_SERVICE_WORKER)try{new(r("ClientServiceWorkerMessage"))(r("RSTConfig").MESSAGE_TYPE,t).sendViaController()}catch(t){var e;if(this.$3)return;var n=r("getErrorSafe")(t);r("FBLogger")("responsive-tracker").catching(n).warn((e=n.message)!=null?e:"Failed to post message to service worker"),this.$3=!0}},t.$7=function(t){var e;return Date.now()-((e=t.remoteLoggerProposeTime)!=null?e:0)>r("RSTConfig").INCIDENT_PROPOSED_PROCESSOR_OWNERSHIP_EXPIRE_MS},t.$8=async function(t,n){if(t!=null){var e=t.incidentID;if(o("RSTIncidentLoggingMainThread").getLoggedIncidentIDs().has(e)){n.add(e);return}var a=t.sessionID===o("RSTSessionID").getSessionID();if(a){t.hasRecovered=!0,o("RSTEventsMessageQueue").notify(o("RSTEvents").RSTEvent.RECOVERABLE_UNRESPONSIVENESS,{unresponsiveEventRecord:t}),n.add(e);return}var i=Date.now()-t.lastHeartBeatTimeStamp;if(!(i<r("RSTConfig").WAIT_MS_FOR_OTHER_SESSION_BEFORE_PROCESSING)){if(i>r("RSTConfig").OBSOLETE_PENDING_INCIDENT_THRESHOLD_MS){if(o("RSTUtilsMainThread").shouldSkipProcessingIncident(e))return;o("RSTUtils").debugLogImportant("pending incident "+e+" cleaned"),n.add(e);return}var l=t.remoteLoggerSessionID==null||this.$7(t);if(l){await r("RSTIndexedDBSafe").updateIncidentInDB(function(t){return t.incidentID!==e?!1:(o("RSTUtils").debugLogImportant("propose as logger for incident "+t.incidentID),t.remoteLoggerSessionID=o("RSTSessionID").getSessionID(),t.remoteLoggerProposeTime=Date.now(),!0)});return}if(t.remoteLoggerSessionID===o("RSTSessionID").getSessionID()&&!this.$7(t))if(o("RSTUtils").debugLogImportant("act as logger for incident "+e),t.hasRecovered)o("RSTEventsMessageQueue").notify(o("RSTEvents").RSTEvent.RECOVERABLE_UNRESPONSIVENESS,{unresponsiveEventRecord:t}),n.add(e);else{if(t.incidentType!==r("RSTConstants").incidentType.unexpectedExit&&t.unrecoverLastsForMs<r("RSTConfig").UNRECOVER_LASTS_THRESHOLD_MS)return;!r("RSTConfig").ONE_UNRECOVERABLE_INCIDENT_PER_SESSION||!this.$2.has(t.sessionID)?(await o("RSTMarkFirstUnrecoverableMainThread").markFirstUnrecoverableIncident(t),o("RSTEventsMessageQueue").notify(o("RSTEvents").RSTEvent.CRASH_INCIDENT,{unresponsiveEventRecord:t}),this.$2.add(t.sessionID)):o("RSTUtils").debugLogImportant("skip logging unrecoverable incident "+e+" "+("from session "+t.sessionID+" since it has been logged")),n.add(e)}}}},t.logAndDeleteUnresponsiveEvents=async function(){try{o("RSTEventsMessageQueue").notify(o("RSTEvents").RSTEvent.CHECKING_INDEXDB_FOR_EVENTS,{});var e=await r("RSTIndexedDBSafe").readEventsFromDB(),t=new Set;for(var n of e)try{await o("RSTUtils").scheduleYield(),await this.$8(n,t)}catch(e){var a,i=r("getErrorSafe")(e);r("FBLogger")("responsive-tracker").catching(i).warn((a=i.message)!=null?a:"Failed to process incident")}await r("RSTIndexedDBSafe").clearIncidentFromDB(t)}catch(e){var l,s=r("getErrorSafe")(e);r("FBLogger")("responsive-tracker").catching(s).warn((l=s.message)!=null?l:"Failed to log incidents")}},e})(),s=new e,u=s;l.default=u}),98);
__d("RSTDebugConsoleMainThread",["RSTEvents","RSTEventsMessageQueue","RSTUtils"],(function(t,n,r,o,a,i,l){"use strict";function e(){}l.registerDebugConsole=e}),98);
__d("RSTEventsRegisterUseCasesMainThread",["RSTClearExternalLoggingDataStoreMainThread","RSTClearInteractionDataMainThread","RSTDebugConsoleMainThread","RSTIncidentLoggingMainThread"],(function(t,n,r,o,a,i,l){"use strict";function e(){o("RSTDebugConsoleMainThread").registerDebugConsole(),o("RSTIncidentLoggingMainThread").registerIncidentLogging(),o("RSTClearInteractionDataMainThread").registerClearInteractionData(),o("RSTClearExternalLoggingDataStoreMainThread").registerClearExternalLoggingData()}l.default=e}),98);
__d("RSTClearInteractionDataMainThread",["RSTEvents","RSTEventsMessageQueue","RSTInteractionDataMainThread"],(function(t,n,r,o,a,i,l){"use strict";function e(){o("RSTEventsMessageQueue").subscribe(o("RSTEvents").RSTEvent.HEART_BEAT,o("RSTInteractionDataMainThread").clearInteractionData),o("RSTEventsMessageQueue").subscribe(o("RSTEvents").RSTEvent.BROWSER_TAB_BACKGROUND,o("RSTInteractionDataMainThread").clearInteractionData),o("RSTEventsMessageQueue").subscribe(o("RSTEvents").RSTEvent.BROWSER_TAB_FOREGROUND,o("RSTInteractionDataMainThread").clearInteractionData)}l.registerClearInteractionData=e}),98);
__d("RSTInteractionTrackingMainThread",["RSTConfig","RSTEvents","RSTMetadataMainThread","ResponsiveTrackerMainThread","one-trace"],(function(t,n,r,o,a,i,l){"use strict";var e=new Set(["RESPONSIVENESS","INP","LONGTASK","UNKNOWN"]);function s(){r("RSTConfig").SHOULD_CAPTURE_INTERACTION_DATA&&(r("one-trace").subscribe("trace-policy-set",function(t){if(!e.has(t.traceType)){var n=o("RSTMetadataMainThread").getMainThreadMetadata();r("ResponsiveTrackerMainThread").postEvent(o("RSTEvents").RSTEvent.TRACE_POLICY_SET,babelHelpers.extends({trace:babelHelpers.extends({},t)},n))}}),r("one-trace").subscribe("trace-end",function(t){if(!e.has(t.traceType)){var n=o("RSTMetadataMainThread").getMainThreadMetadata();r("ResponsiveTrackerMainThread").postEvent(o("RSTEvents").RSTEvent.TRACE_END,babelHelpers.extends({trace:babelHelpers.extends({},t,{endTimestamp:Date.now()})},n))}}))}l.start=s}),98);
__d("RSTRecoverableUnresponsivenessTrackingMainThread",["RSTConfig","one-trace","performanceNow"],(function(t,n,r,o,a,i,l){"use strict";var e,s=new Set(["INP","LONGTASK"]);function u(){r("one-trace").subscribe("trace-end",function(e){s.has(e.traceType)&&d.getInstance().addEvent(babelHelpers.extends({},e))})}function c(){return d.getInstance().getStats()}var d=(function(){function t(){this.WINDOW_MS=r("RSTConfig").TRACE_STATS_WINDOW_SIZE_MS,this.MAX_EVENTS=r("RSTConfig").TRACE_STATS_MAX_QUEUE_SIZE,this.eventQueue=[]}t.getInstance=function(){return t.instance||(t.instance=new t),t.instance};var n=t.prototype;return n.addEvent=function(t){if(!(t.startTime==null||t.endTime==null)){var e={traceType:t.traceType,startTime:t.startTime,duration:t.endTime-t.startTime,endTime:t.endTime};this.eventQueue.push(e),this.cleanupOldEvents(),this.eventQueue.length>=this.MAX_EVENTS&&this.eventQueue.shift()}},n.getStats=function(){this.cleanupOldEvents();var e={};this.eventQueue.forEach(function(t){t.traceType in e?(e[t.traceType].count++,e[t.traceType].totalDurationMs+=t.duration):e[t.traceType]={count:1,totalDurationMs:t.duration,averageDurationMs:0}});for(var t of Object.keys(e)){var n=e[t].totalDurationMs/e[t].count;e[t].averageDurationMs=Math.floor(n)}return e},n.cleanupOldEvents=function(){for(var t=(e||(e=r("performanceNow")))();this.eventQueue.length>0;){var n=this.eventQueue[0];if(n.endTime>=t-this.WINDOW_MS)break;this.eventQueue.shift()}},t})();d.instance=null,l.start=u,l.getStats=c}),98);
__d("RSTMetadataCollectorMainThread",["FBLogger","QPLCrashResiliencePlugin","RSTInteractionTrackingMainThread","RSTRecoverableUnresponsivenessTrackingMainThread","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e=!1;function s(){if(!e)try{o("RSTInteractionTrackingMainThread").start(),o("RSTRecoverableUnresponsivenessTrackingMainThread").start(),o("QPLCrashResiliencePlugin").startQPLCrashResilience(),e=!0}catch(e){r("FBLogger")("responsive-tracker").catching(r("getErrorSafe")(e)).warn("Failed to start RST metadata collector")}}l.start=s}),98);
__d("RSTCloseObserver",["FBLogger","RSTConfig","RSTEvents","RSTSessionID","ResponsiveTrackerMainThread","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";function e(e){if(r("RSTConfig").ENABLE_SERVICE_WORKER){var t=e.persisted?o("RSTEvents").RSTEvent.BROWSER_TAB_BACKGROUND:o("RSTEvents").RSTEvent.BROWSER_TAB_CLOSED,n={type:r("RSTConfig").MESSAGE_TYPE,event:t,eventTime:Date.now(),DOMData:{hidden:!1},sessionID:o("RSTSessionID").getSessionID(),metadata:null};try{if("serviceWorker"in navigator){var a;(a=navigator.serviceWorker)==null||(a=a.controller)==null||a.postMessage({command:"responsiveness",data:n})}}catch(e){r("FBLogger")("responsive-tracker").catching(r("getErrorSafe")(e)).warn("Failed to send quick browser tab close event to worker")}try{r("ResponsiveTrackerMainThread").postEvent(t)}catch(e){r("FBLogger")("responsive-tracker").catching(r("getErrorSafe")(e)).mustfix("Failed to send browser tab close/background event to worker")}}}function s(){window.addEventListener("pagehide",e)}l.initPageCloseObserver=s}),98);
__d("RSTInteractionDataMainThread",["ALChannel","AdsALReactUtils","FBLogger","RSTConfig","RSTEvents","RSTMetadataMainThread","RSTUtilsMainThread","ResponsiveTrackerMainThread","getErrorSafe","getReactComponentStackFromDOMElement_THIS_CAN_BREAK"],(function(t,n,r,o,a,i,l){"use strict";var e=5,s=[],u=100,c=10,d=[];function m(t){s.push(t),s.length>e&&s.shift(),d.push(t),d.length>u&&d.shift()}function p(){s.length=0}function _(){var e=s;return e[e.length-1]}function f(){return[].concat(s)}function g(e){return e===void 0&&(e=c),d.slice(-1*e)}function h(e,t){var n=e!=null?e:{},a=n.context,i=n.name,l=n.stack;(i!=null||l!=null)&&m({componentName:i,componentStack:l,componentContext:a,eventType:"click",eventTime:Date.now(),componentText:t});try{var s=o("RSTMetadataMainThread").getMainThreadMetadata();r("ResponsiveTrackerMainThread").postEvent(o("RSTEvents").RSTEvent.INTERACTION_DATA,babelHelpers.extends({},s))}catch(e){r("FBLogger")("responsive-tracker").catching(r("getErrorSafe")(e)).mustfix("Failed to send interaction data to worker")}}y();function y(){r("RSTConfig").SHOULD_CAPTURE_INTERACTION_DATA&&(o("RSTUtilsMainThread").isMonetizationApp?b():C())}function C(){window.addEventListener("click",function(e){var t=e.target;if(t instanceof Element)try{var n=r("getReactComponentStackFromDOMElement_THIS_CAN_BREAK")(t),a={name:o("RSTUtilsMainThread").getAllowListedComponentName(n),stack:n!=null?n:[],context:o("RSTUtilsMainThread").getReactComponentContext(n,r("RSTConfig").isReactComponentNameBlocked)},i=v(t,a);h(a,i)}catch(e){r("FBLogger")("responsive-tracker").catching(r("getErrorSafe")(e)).mustfix("Failed to get react component stack from Shim")}},!0)}function b(){r("ALChannel").addListener("al_ui_event_capture",function(e){if(e.event==="click")try{var t,n={name:e.reactComponentName,stack:(t=e.reactComponentStack)!=null?t:[],context:o("RSTUtilsMainThread").getReactComponentContext(e.reactComponentStack,o("AdsALReactUtils").isComponentNameBlocked)},a=e.targetElement,i=v(a,n);h(n,i)}catch(e){r("FBLogger")("responsive-tracker").catching(r("getErrorSafe")(e)).mustfix("Failed to get react component stack from AL")}})}function v(e,t){var n;if(!r("RSTConfig").SHOULD_CAPTURE_INTERACTION_ELEMENT_TEXT||(t==null?void 0:t.stack)==null)return null;for(var o of t.stack)if(r("RSTConfig").isReactComponentTextBlocked(o))return null;var a=(n=e==null?void 0:e.textContent)!=null?n:null;if(typeof a=="string"){a=a.trim();var i=r("RSTConfig").ELEMENT_TEXT_SIZE_LIMIT;a.length>i&&(a=a.substr(0,i)+("... ("+(a.length-i)+" code units omitted)"))}return a===""?null:a}l.clearInteractionData=p,l.getLastInteractionDataSinceLastMessageToWorker=_,l.getInteractionDataSinceLastMessageToWorker=f,l.getInteractionHistory=g}),98);
__d("RSTMetadataMainThread",["CurrentCanonicalRoute","CurrentUser","Env","MemoryUtils","RSTAdsManagerUtilsMainThread","RSTConfig","RSTExternalLoggingDataStoreMainThread","RSTInteractionDataMainThread","RSTRecoverableUnresponsivenessTrackingMainThread","RSTUtils","SiteData","performance"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(){var e=Date.now(),t=babelHelpers.extends({},o("RSTAdsManagerUtilsMainThread").getAdsAnnotations());m(t);var n=Date.now();return t.rstAnnotationsCollectedInMs=""+(n-e),t}function c(){var e=babelHelpers.extends({},o("RSTAdsManagerUtilsMainThread").getAdsAnnotations());return r("RSTConfig").shouldCollectAdditionalMetadata()&&y(e),e}function d(){return r("RSTConfig").shouldCollectAdditionalMetadata()?o("RSTExternalLoggingDataStoreMainThread").loggingDataStore.getAllSpanData():{}}function m(e){r("RSTConfig").shouldCollectAdditionalMetadata()&&(g(e),C(e),b(e),y(e),p(e),h(e))}function p(e){var t=o("RSTAdsManagerUtilsMainThread").getAdEntityIds();e.selectedAdIds=t.adIds.join(","),e.selectedAdSetIds=t.adsetIds.join(","),e.selectedCampaignIds=t.campaignIds.join(",")}function _(){try{var e,t=(e=o("RSTInteractionDataMainThread").getLastInteractionDataSinceLastMessageToWorker())==null?void 0:e.componentStack;return t!=null?t:[]}catch(e){return[]}}function f(){try{var e,t=(e=o("RSTInteractionDataMainThread").getLastInteractionDataSinceLastMessageToWorker())==null?void 0:e.componentContext;return t!=null?t:[]}catch(e){return[]}}function g(e){if(r("RSTConfig").SHOULD_COLLECT_RST_ANNOTATIONS_INTERACTION_DATA){var t=o("RSTInteractionDataMainThread").getInteractionDataSinceLastMessageToWorker().map(function(e){return e.componentName}).filter(function(e){return e!=null}).join(",");t!==""&&(e.interactedComponentsSinceLastResponsiveState=t);var n=f();n.length>0&&(e.interactedComponentContextSinceLastResponsiveState=n.join(" < "));var a=o("RSTInteractionDataMainThread").getInteractionHistory().map(function(e){return e.componentName}).filter(function(e){return e!=null}).join(",");a!==""&&(e.interactedComponentHistory=a);var i=o("RSTInteractionDataMainThread").getInteractionHistory().map(function(e){return o("RSTUtils").getInteractionDetail(e)}).filter(function(e){return e!=null}).join(",");i!==""&&(e.interactionDetailHistory=i)}}function h(e){e.crashDataOncall=r("RSTConfig").PROJECT_ONCALL,e.crashLogger=r("RSTConfig").PROJECT_NAME}function y(e){if(r("RSTConfig").SHOULD_COLLECT_RST_ANNOTATIONS_LOG_FOR_CRASH){var t=o("RSTExternalLoggingDataStoreMainThread").loggingDataStore.getAll(),n=function(a){r("RSTConfig").BLOCKED_ANNOTATION_KEYS.some(function(e){return e.test(a)})||(e[o("RSTUtils").getExternalAnnotationKey(a)]=t[a])};for(var a of Object.keys(t))n(a)}}function C(e){var t=o("MemoryUtils").getCurrentMemory({runGC:!1}),n=t.jsHeapSizeLimit,r=t.totalJSHeapSize,a=t.usedJSHeapSize;n!=null&&(e.js_heap_size_limit=n.toString()),a!=null&&(e.used_js_heap_size=a.toString()),r!=null&&(e.total_js_heap_size=r.toString())}function b(e){var t=o("RSTRecoverableUnresponsivenessTrackingMainThread").getStats();if(t!=null)for(var n of Object.keys(t)){var r=t[n];if(r!=null){var a=n.toLowerCase();for(var i of Object.keys(r)){var l=r[i];l!=null&&(e[a+"-"+i]=l.toString())}}}}function v(){var t=document.URL,n=(e||(e=r("Env"))).brsid;try{var a,i,l,c;return{url:t,brsid:n,i1:(a=r("CurrentUser").getID())!=null?a:"0",i2:(i=o("RSTAdsManagerUtilsMainThread").getAdAccountID())!=null?i:"0",i3:(l=o("RSTAdsManagerUtilsMainThread").getBusinessID())!=null?l:"0",cpp:(c=r("SiteData").push_phase)!=null?c:"unknown",cr:""+r("SiteData").client_revision,rcs:_(),st:Math.floor(Date.now()-(s||(s=r("performance"))).now()),annotations:u(),spans:d(),ccrt:o("CurrentCanonicalRoute").getForGlobalLoggingOnly()}}catch(e){return{url:t,brsid:n,i1:"0",i2:"0",i3:"0"}}}function S(){var t=document.URL,n=(e||(e=r("Env"))).brsid;try{var a,i,l;return{url:t,brsid:n,i1:(a=r("CurrentUser").getID())!=null?a:"0",i2:(i=o("RSTAdsManagerUtilsMainThread").getAdAccountID())!=null?i:"0",i3:(l=o("RSTAdsManagerUtilsMainThread").getBusinessID())!=null?l:"0",externalAnnotations:c(),spans:d(),isLightweight:!0}}catch(e){return{url:t,brsid:n,i1:"0",i2:"0",i3:"0"}}}l.getMainThreadMetadata=v,l.getMainThreadMetadataWithExternalAnnotationsOnly=S}),98);
__d("RSTWebWorkerClientMainThreadImpl",["ErrorGuard","FBLogger","RSTConfig","RSTUtils","ResponsiveTrackerMainThread","Run","WorkerMessagePort","getErrorSafe","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("gkx")("4909"),u=(function(){function t(e){this.$1=null,this.$2=!1,this.$3=e}var n=t.prototype;return n.$4=function(){return this.$1==null&&(this.$1=this.$3()),this.$1},n.startRSTFromMainThread=function(t){var e,n=this;if(t===void 0&&(t={}),!(!s||this.$2||!o("RSTUtils").isIndexedDBSupported())){var a=Math.max((e=t.extraDelayInMs)!=null?e:0,r("RSTConfig").START_RST_FROM_MAIN_THREAD_EXTRA_DELAY_IN_MS);window.setTimeout(function(){try{var e=n.$4(),t=new(o("WorkerMessagePort")).WorkerSyncedMessagePort(e,"RSTWorkerClient");r("ResponsiveTrackerMainThread").init(t),n.$2=!0}catch(e){var a=r("getErrorSafe")(e);r("FBLogger")("responsive-tracker").catching(a).warn("Failed to start worker: "+a.message)}},a)}},n.startRSTAfterPageLoadFromMainThread=function(n){var t=this;n===void 0&&(n={});var a=o("Run").onAfterLoad(function(){(e||(e=r("ErrorGuard"))).applyWithGuard(function(){return t.startRSTFromMainThread(n)},null,[])})},t})();l.default=u}),98);
__d("RSTWebWorkerClientMainThreadSwitch",["cr:22916"],(function(t,n,r,o,a,i,l){"use strict";l.default=n("cr:22916")}),98);
__d("RSTWebWorkerClientMainThreadV2",["RSTWebV2WorkerResource","RSTWebWorkerClientMainThreadImpl","WebWorkerV2Resource"],(function(t,n,r,o,a,i,l){"use strict";var e=new(r("RSTWebWorkerClientMainThreadImpl"))(function(){return o("WebWorkerV2Resource").createDedicatedV2WebWorker(r("RSTWebV2WorkerResource"),"RSTWebWorker").worker}),s=e;l.default=s}),98);
__d("WebPerfDeviceInfoLogFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("1871697"),s=o("FalcoLoggerInternal").create("web_perf_device_info_log",e),u=s;l.default=u}),98);
__d("XDeviceClassRealtimeControllerRouteBuilder",["jsRouteBuilder"],(function(t,n,r,o,a,i,l){var e=r("jsRouteBuilder")("/web_perf/get_perf_level/",Object.freeze({}),void 0),s=e;l.default=s}),98);
__d("WebDevicePerfInfoLogging",["AsyncTypedRequest","JSScheduler","WebDevicePerfInfoData","WebPerfDeviceInfoLogFalcoEvent","XDeviceClassRealtimeControllerRouteBuilder"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e){var t=document.createElement("canvas"),n=t.getContext("webgl")||t.getContext("experimental-webgl");if(n){var r=n.getExtension("WEBGL_debug_renderer_info");if(r){var o=n.getParameter(r.UNMASKED_RENDERER_WEBGL),a=n.getParameter(r.UNMASKED_VENDOR_WEBGL);e.gpu_vendor=a,e.gpu_renderer=o}}}function u(){var e=window.navigator,t={};return e&&e.hardwareConcurrency!==void 0&&(t.cpu_cores=e.hardwareConcurrency),e&&e.deviceMemory!==void 0&&(t.ram=e.deviceMemory),r("WebDevicePerfInfoData").needsFullUpdate&&s(t),t}function c(){var e=u();r("WebPerfDeviceInfoLogFalcoEvent").log(function(){var t,n,r,o;return{cpu_cores:(t=e.cpu_cores)!=null?t:null,ram:(n=e.ram)!=null?n:null,gpu_renderer:(r=e.gpu_renderer)!=null?r:null,gpu_vendor:(o=e.gpu_vendor)!=null?o:null}})}async function d(){var e=u(),t=await new(r("AsyncTypedRequest"))(r("XDeviceClassRealtimeControllerRouteBuilder").buildURL({})).setData(e).promisePayload();return t.devicePerfClassLevel}function m(){(r("WebDevicePerfInfoData").needsFullUpdate||r("WebDevicePerfInfoData").needsPartialUpdate)&&(e||(e=o("JSScheduler"))).scheduleSpeculativeCallback(c)}function p(){return new Promise(function(t,n){r("WebDevicePerfInfoData").needsFullUpdate||r("WebDevicePerfInfoData").needsPartialUpdate?(e||(e=o("JSScheduler"))).scheduleSpeculativeCallback(function(){d().then(t).catch(n)}):t()})}l.doLog=m,l.doLogPromise=p}),98);/*FB_PKG_DELIM*/
__d("BizInboxUnifiedThreadsQuery.graphql",["relay-runtime"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={defaultValue:null,kind:"LocalArgument",name:"before"},t={defaultValue:[],kind:"LocalArgument",name:"businessAssets"},n={defaultValue:!1,kind:"LocalArgument",name:"getShouldUnifyConfigQueries"},r={defaultValue:480,kind:"LocalArgument",name:"height"},o={defaultValue:null,kind:"LocalArgument",name:"ig_params"},a={defaultValue:!0,kind:"LocalArgument",name:"includeDeliveryReceipts"},i={defaultValue:!1,kind:"LocalArgument",name:"includeSeqID"},l={defaultValue:!1,kind:"LocalArgument",name:"isDependencyOfRemovePageDependencyEnabledTool"},s={defaultValue:!1,kind:"LocalArgument",name:"isWorkUser"},u={defaultValue:!1,kind:"LocalArgument",name:"is_work_teamwork_not_putting_muted_in_unreads"},c={defaultValue:null,kind:"LocalArgument",name:"item_after"},d={defaultValue:null,kind:"LocalArgument",name:"item_limit"},m={defaultValue:!1,kind:"LocalArgument",name:"loadThreadItems"},p={defaultValue:!0,kind:"LocalArgument",name:"loadThreads"},_={defaultValue:!1,kind:"LocalArgument",name:"load_delivery_receipts"},f={defaultValue:!0,kind:"LocalArgument",name:"load_items"},g={defaultValue:!0,kind:"LocalArgument",name:"load_messages"},h={defaultValue:!0,kind:"LocalArgument",name:"load_read_receipts"},y={defaultValue:null,kind:"LocalArgument",name:"message_limit"},C={defaultValue:null,kind:"LocalArgument",name:"msgr_params"},b={defaultValue:null,kind:"LocalArgument",name:"msgr_pending_params"},v={defaultValue:null,kind:"LocalArgument",name:"page_id"},S={defaultValue:null,kind:"LocalArgument",name:"selected_item_id"},R={defaultValue:!1,kind:"LocalArgument",name:"shouldSkipMessage"},L={defaultValue:!1,kind:"LocalArgument",name:"shouldSkipPageQuery"},E={defaultValue:!1,kind:"LocalArgument",name:"shouldUnifyContextCardQueries"},k={defaultValue:null,kind:"LocalArgument",name:"source"},I={defaultValue:!1,kind:"LocalArgument",name:"threadlistViewFieldsOnly"},T={defaultValue:null,kind:"LocalArgument",name:"wa_params"},D={defaultValue:null,kind:"LocalArgument",name:"wa_pending_params"},x={defaultValue:480,kind:"LocalArgument",name:"width"},$={alias:"unused",args:[{kind:"Variable",name:"string",variableName:"source"}],kind:"ScalarField",name:"xfb_returns_zero_make_parameter_used",storageKey:null},P=[{kind:"Variable",name:"ig_params",variableName:"ig_params"},{kind:"Variable",name:"msgr_params",variableName:"msgr_params"},{kind:"Variable",name:"selected_item_id",variableName:"selected_item_id"},{kind:"Variable",name:"wa_params",variableName:"wa_params"}],N={alias:null,args:null,kind:"ScalarField",name:"sync_sequence_id",storageKey:null},M={condition:"includeSeqID",kind:"Condition",passingValue:!0,selections:[N]},w={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},A={alias:null,args:null,kind:"ScalarField",name:"thread_fbid",storageKey:null},F={alias:null,args:null,concreteType:"MessageThreadKey",kind:"LinkedField",name:"thread_key",plural:!1,selections:[A,{alias:null,args:null,kind:"ScalarField",name:"other_user_id",storageKey:null}],storageKey:null},O={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},B=[{kind:"Literal",name:"last",value:1}],W={alias:null,args:null,kind:"ScalarField",name:"snippet",storageKey:null},q=[w],U={alias:null,args:null,kind:"ScalarField",name:"timestamp_precise",storageKey:null},V={alias:null,args:null,kind:"ScalarField",name:"commerce_message_type",storageKey:null},H={alias:null,args:null,kind:"ScalarField",name:"legacy_attachment_id",storageKey:null},G={alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},z=[G],j={alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"description",plural:!1,selections:z,storageKey:null},K={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},Q={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},X={alias:null,args:null,kind:"ScalarField",name:"action_url",storageKey:null},Y={alias:null,args:null,kind:"ScalarField",name:"native_url",storageKey:null},J=[K,Q,X,Y,{alias:null,args:null,kind:"ScalarField",name:"target_id",storageKey:null}],Z={alias:null,args:null,concreteType:"MessengerGenericXMATemplateExtraFields",kind:"LinkedField",name:"messenger_generic_xma_template_extra_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"media_owner_profile_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"media_owner_profile_pic_uri",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"favicon_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"favicon_url_fallback",storageKey:null},{alias:null,args:null,concreteType:"MessengerGenericXMATemplateCTA",kind:"LinkedField",name:"default_cta",plural:!1,selections:J,storageKey:null},{alias:null,args:null,concreteType:"MessengerGenericXMATemplateCTA",kind:"LinkedField",name:"cta1",plural:!1,selections:J,storageKey:null},{alias:null,args:null,concreteType:"MessengerGenericXMATemplateCTA",kind:"LinkedField",name:"cta2",plural:!1,selections:J,storageKey:null},{alias:null,args:null,concreteType:"MessengerGenericXMATemplateCTA",kind:"LinkedField",name:"cta3",plural:!1,selections:J,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"list_item_id_1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"list_item_contact_url_list_1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"list_item_contact_url_expiration_timestamp_list_1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"list_item_contact_url_fallback_list_1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"list_item_title_text_1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"list_item_accessibility_text_1",storageKey:null}],storageKey:null},ee={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},te=[{kind:"Literal",name:"height",value:240},{kind:"Literal",name:"width",value:240}],ne={alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null},re=[ne],oe=[{kind:"Literal",name:"height",value:120},{kind:"Literal",name:"width",value:120}],ae={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},ie={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},le={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null},se=[w,{alias:null,args:null,concreteType:"StickerPack",kind:"LinkedField",name:"pack",plural:!1,selections:q,storageKey:null},ee,{alias:null,args:null,kind:"ScalarField",name:"frame_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"frame_rate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"frames_per_row",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"frames_per_column",storageKey:null},{alias:"sprite_image_2x",args:te,concreteType:"Image",kind:"LinkedField",name:"sprite_image",plural:!1,selections:re,storageKey:"sprite_image(height:240,width:240)"},{alias:null,args:oe,concreteType:"Image",kind:"LinkedField",name:"sprite_image",plural:!1,selections:re,storageKey:"sprite_image(height:120,width:120)"},{alias:null,args:oe,concreteType:"Image",kind:"LinkedField",name:"padded_sprite_image",plural:!1,selections:re,storageKey:"padded_sprite_image(height:120,width:120)"},{alias:"padded_sprite_image_2x",args:te,concreteType:"Image",kind:"LinkedField",name:"padded_sprite_image",plural:!1,selections:re,storageKey:"padded_sprite_image(height:240,width:240)"},ae,ie,le],ue={kind:"InlineFragment",selections:se,type:"Sticker",abstractKey:null},ce=[ne,ie,le],de={alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"animated_image",plural:!1,selections:ce,storageKey:null},me={kind:"Literal",name:"sizing",value:"contain-fit"},pe=[me],_e={alias:null,args:pe,concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:ce,storageKey:'image(sizing:"contain-fit")'},fe={alias:null,args:null,kind:"ScalarField",name:"playable_duration_in_ms",storageKey:null},ge={alias:null,args:null,kind:"ScalarField",name:"is_playable",storageKey:null},he={alias:null,args:null,kind:"ScalarField",name:"playable_url",storageKey:null},ye={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media",plural:!1,selections:[ue,de,_e,fe,ge,he],storageKey:null},Ce={alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"source",plural:!1,selections:z,storageKey:null},be={alias:null,args:null,kind:"ScalarField",name:"style_list",storageKey:null},ve={alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"title_with_entities",plural:!1,selections:z,storageKey:null},Se={alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},Re={alias:null,args:null,concreteType:"AttachmentProperty",kind:"LinkedField",name:"properties",plural:!0,selections:[Se,{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"value",plural:!1,selections:z,storageKey:null}],storageKey:null},Le={alias:"url",args:null,kind:"ScalarField",name:"messenger_dot_com_url",storageKey:null},Ee={alias:null,args:null,kind:"ScalarField",name:"deduplication_key",storageKey:null},ke={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"action_links",plural:!0,selections:[Q,ae],storageKey:null},Ie={alias:null,args:null,concreteType:"MessagingAttribution",kind:"LinkedField",name:"messaging_attribution",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"attribution_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"attribution_id",storageKey:null},O,{alias:null,args:null,kind:"ScalarField",name:"icon_url",storageKey:null}],storageKey:null},Te={alias:"action_link",args:null,kind:"ScalarField",name:"action_url",storageKey:null},De={alias:null,args:null,kind:"ScalarField",name:"action_open_type",storageKey:null},xe={alias:null,args:null,kind:"ScalarField",name:"preview_title",storageKey:null},$e={alias:null,args:null,kind:"ScalarField",name:"preview_subtitle",storageKey:null},Pe={alias:null,args:null,kind:"ScalarField",name:"target_display",storageKey:null},Ne={alias:null,args:null,kind:"ScalarField",name:"image_url",storageKey:null},Me={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"action_objects",plural:!0,selections:[{kind:"InlineFragment",selections:[w,xe,$e,Pe,Ne],type:"MessengerPlatformEntPreview",abstractKey:"__isMessengerPlatformEntPreview"}],storageKey:null},we={alias:"title",args:null,kind:"ScalarField",name:"action_title",storageKey:null},Ae={alias:null,args:null,concreteType:"MessengerCTAUserConfirmation",kind:"LinkedField",name:"user_confirmation",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cancel_button_label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"continue_button_label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"confirmation_message",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"confirmation_title",storageKey:null}],storageKey:null},Fe={alias:null,args:null,kind:"ScalarField",name:"is_disabled",storageKey:null},Oe={alias:null,args:null,kind:"ScalarField",name:"is_mutable_by_server",storageKey:null},Be={alias:null,args:null,kind:"ScalarField",name:"logging_token",storageKey:null},We={alias:"render_style",args:null,kind:"ScalarField",name:"cta_render_style",storageKey:null},qe={alias:null,args:null,concreteType:"MessengerPlatformWebviewMetadata",kind:"LinkedField",name:"webview_metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"fallback_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"messenger_extensions",storageKey:null},{alias:"webview_height_ratio",args:null,kind:"ScalarField",name:"height_ratio",storageKey:null},{alias:"webview_share_button",args:null,kind:"ScalarField",name:"hide_share_button",storageKey:null}],storageKey:null},Ue={alias:null,args:null,kind:"ScalarField",name:"page_id",storageKey:null},Ve={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"feedback_form_current_screen_index",storageKey:null},{alias:null,args:null,concreteType:"MessengerFeedbackFormScreenObject",kind:"LinkedField",name:"feedback_form_first_screen",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerFeedbackQuestionObject",kind:"LinkedField",name:"feedback_questions",plural:!0,selections:[w,Q,K,{alias:null,args:null,kind:"ScalarField",name:"score_label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"left_score_label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"right_score_label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score_option",storageKey:null},{alias:null,args:null,concreteType:"MessengerFeedBackQuestionFollowup",kind:"LinkedField",name:"follow_up",plural:!1,selections:[K,{alias:null,args:null,kind:"ScalarField",name:"placeholder",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"feedback_form_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"feedback_form_num_screens",storageKey:null},{alias:null,args:null,concreteType:"MessengerFeedbackBusinessPrivacyObject",kind:"LinkedField",name:"feedback_form_privacy_policy",plural:!1,selections:[G,ee,ae],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"feedback_form_state",storageKey:null}],type:"MessengerFeedbackFormOpenCallToActionData",abstractKey:null},He={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"cta_data",plural:!1,selections:[Ve],storageKey:null},Ge={alias:null,args:null,kind:"ScalarField",name:"is_high_confidence",storageKey:null},ze={alias:null,args:null,concreteType:"MessengerCallToAction",kind:"LinkedField",name:"messenger_call_to_actions",plural:!0,selections:[Te,De,Me,we,Ae,w,Fe,Oe,Be,We,qe,Ue,He,Ge,Y],storageKey:null},je={alias:null,args:null,concreteType:"XMALayoutInfo",kind:"LinkedField",name:"xma_layout_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"layout_type",storageKey:null}],storageKey:null},Ke={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},Qe={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"listing_type",storageKey:null},{alias:null,args:null,concreteType:"CrisisListingCategoryWrapper",kind:"LinkedField",name:"listing_category",plural:!1,selections:[{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"offer_image",plural:!1,selections:re,storageKey:null},{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"request_image",plural:!1,selections:re,storageKey:null}],storageKey:null},{alias:null,args:[{kind:"Literal",name:"height",value:315},{kind:"Literal",name:"width",value:851}],concreteType:"Image",kind:"LinkedField",name:"map_image",plural:!1,selections:re,storageKey:"map_image(height:315,width:851)"}],type:"CrisisListing",abstractKey:null},Xe={alias:null,args:null,kind:"ScalarField",name:"filename",storageKey:null},Ye={alias:null,args:null,kind:"ScalarField",name:"url_shimhash",storageKey:null},Je={alias:null,args:null,kind:"ScalarField",name:"extension",storageKey:null},Ze={alias:null,args:null,kind:"ScalarField",name:"filesize",storageKey:null},et={alias:null,args:null,kind:"ScalarField",name:"duration",storageKey:null},tt={alias:"transfer_id",args:null,kind:"ScalarField",name:"id",storageKey:null},nt={alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:re,storageKey:null},rt=[w,{alias:"name",args:null,kind:"ScalarField",name:"short_name",storageKey:null},{alias:"full_name",args:null,kind:"ScalarField",name:"name",storageKey:null},nt,ae],ot={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"sender",plural:!1,selections:rt,storageKey:null},at={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"receiver",plural:!1,selections:rt,storageKey:null},it={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},lt={alias:null,args:null,kind:"ScalarField",name:"length",storageKey:null},st={alias:"actionDatas",args:null,concreteType:"PaymentActivityActionData",kind:"LinkedField",name:"action_datas",plural:!0,selections:[Ke,{alias:"additionalInfo",args:null,concreteType:"PaymentActivityActionDataAdditionalInfo",kind:"LinkedField",name:"additional_info",plural:!0,selections:[Se,it],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"category",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"identifier",storageKey:null},{alias:"inputType",args:null,kind:"ScalarField",name:"input_type",storageKey:null},lt,{alias:null,args:null,kind:"ScalarField",name:"optional",storageKey:null},{alias:"placeholderText",args:null,kind:"ScalarField",name:"placeholder_text",storageKey:null}],storageKey:null},ut={alias:"actionIdentifier",args:null,kind:"ScalarField",name:"action_identifier",storageKey:null},ct={alias:null,args:null,kind:"ScalarField",name:"style",storageKey:null},dt={alias:null,args:null,kind:"ScalarField",name:"subtitle",storageKey:null},mt={alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"title",plural:!1,selections:z,storageKey:null},pt={kind:"InlineFragment",selections:[{alias:"receiptView",args:null,concreteType:"PaymentReceiptView",kind:"LinkedField",name:"receipt_view",plural:!1,selections:[{alias:"additionalInstruction",args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"additional_instruction",plural:!1,selections:z,storageKey:null},w,{alias:"otherParticipant",args:null,concreteType:"PaymentActivityParticipantView",kind:"LinkedField",name:"other_participant",plural:!1,selections:[{alias:"imageUrl",args:null,kind:"ScalarField",name:"image_url",storageKey:null},dt,Q],storageKey:null},{alias:null,args:null,concreteType:"PaymentActivityViewSection",kind:"LinkedField",name:"sections",plural:!0,selections:[{alias:"preferredPosition",args:null,kind:"ScalarField",name:"preferred_position",storageKey:null}],storageKey:null},mt],storageKey:null}],type:"P2POpenReceiptActionButton",abstractKey:null},_t={alias:null,args:null,kind:"ScalarField",name:"amount",storageKey:null},ft={alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},gt=[_t,ft,{alias:"formattedAmount",args:null,kind:"ScalarField",name:"formatted_amount",storageKey:null}],ht={alias:"amount",args:null,concreteType:"CurrencyAmount",kind:"LinkedField",name:"currency_amount",plural:!1,selections:gt,storageKey:null},yt=[Ke,st,ut,ct,Q,pt,{kind:"InlineFragment",selections:[{alias:"moneyTransfer",args:null,concreteType:null,kind:"LinkedField",name:"generic_money_transfer",plural:!1,selections:[tt,ot,at,ht],storageKey:null}],type:"P2PPaymentActionButtonWithTransfer",abstractKey:null}],Ct={alias:"componentType",args:null,kind:"ScalarField",name:"component_type",storageKey:null},bt={alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null},vt={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"CurrencyAmount",kind:"LinkedField",name:"amount",plural:!1,selections:gt,storageKey:null},bt],type:"P2PBubbleAmountComponent",abstractKey:null},St=[{alias:"dimensionlessCacheKey",args:null,kind:"ScalarField",name:"dimensionless_cache_key",storageKey:null},ie,{alias:"isSilhouette",args:null,kind:"ScalarField",name:"is_silhouette",storageKey:null},{alias:"mimeType",args:null,kind:"ScalarField",name:"mime_type",storageKey:null},O,{alias:null,args:null,kind:"ScalarField",name:"scale",storageKey:null},ne,le],Rt={kind:"InlineFragment",selections:[{alias:"aspectRatio",args:null,kind:"ScalarField",name:"aspect_ratio",storageKey:null},{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:St,storageKey:null}],type:"P2PBubbleImageComponent",abstractKey:null},Lt={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"alignment",storageKey:null},bt,{alias:"facepileUsers",args:null,concreteType:"User",kind:"LinkedField",name:"facepile_users",plural:!0,selections:[w,{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:St,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"images",plural:!0,selections:St,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"size",storageKey:null},G],type:"P2PBubbleTextComponent",abstractKey:null},Et={alias:"iconCurrencyCode",args:null,kind:"ScalarField",name:"icon_currency_code",storageKey:null},kt={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"P2PBubbleView",kind:"LinkedField",name:"bubble_view",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actions",plural:!0,selections:yt,storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"components",plural:!0,selections:[Ct,vt,Rt,Lt],storageKey:null},{alias:null,args:null,concreteType:"P2PBubbleRobotext",kind:"LinkedField",name:"robotext",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"action",plural:!1,selections:yt,storageKey:null},bt,Et,G],storageKey:null},{alias:"rootAction",args:null,concreteType:null,kind:"LinkedField",name:"root_action",plural:!1,selections:yt,storageKey:null}],storageKey:null}],type:"PaymentViewData",abstractKey:"__isPaymentViewData"},It={alias:null,args:null,kind:"ScalarField",name:"short_name",storageKey:null},Tt={kind:"InlineFragment",selections:[It,ae],type:"User",abstractKey:null},Dt={alias:null,args:null,concreteType:"CurrencyAmount",kind:"LinkedField",name:"transaction_amount",plural:!1,selections:[_t,{alias:null,args:null,kind:"ScalarField",name:"formatted_amount",storageKey:null}],storageKey:null},xt={alias:null,args:null,kind:"ScalarField",name:"transfer_status",storageKey:null},$t={alias:"completedTime",args:null,kind:"ScalarField",name:"completed_time",storageKey:null},Pt={alias:"updatedTime",args:null,kind:"ScalarField",name:"updated_time",storageKey:null},Nt={alias:"creationTime",args:null,kind:"ScalarField",name:"creation_time",storageKey:null},Mt={alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:re,storageKey:null},wt=[Mt],At={alias:null,args:null,concreteType:"MessengerPayTheme",kind:"LinkedField",name:"transfer_theme",plural:!1,selections:q,storageKey:null},Ft={alias:null,args:null,kind:"ScalarField",name:"formatted",storageKey:null},Ot=[Ft],Bt={alias:null,args:null,concreteType:"CurrencyQuantity",kind:"LinkedField",name:"amount_fb_discount",plural:!1,selections:Ot,storageKey:null},Wt={alias:null,args:null,kind:"ScalarField",name:"funds_availability",storageKey:null},qt={alias:null,args:null,kind:"ScalarField",name:"group_thread_fbid",storageKey:null},Ut={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},Vt={alias:null,args:null,kind:"ScalarField",name:"status_description",storageKey:null},Ht={alias:null,args:null,concreteType:"CurrencyAmount",kind:"LinkedField",name:"currency_amount",plural:!1,selections:[ft],storageKey:null},Gt={alias:null,args:null,kind:"ScalarField",name:"memo_text",storageKey:null},zt=[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"sender",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"P2PSenderReceiver"}],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"receiver_profile",plural:!1,selections:[w,O,nt,Tt],storageKey:null},Dt,xt,tt,$t,Pt,Nt,{alias:null,args:null,concreteType:"PeerToPeerTransferContext",kind:"LinkedField",name:"transfer_context",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageImage",kind:"LinkedField",name:"memo_images",plural:!0,selections:wt,storageKey:null},At],storageKey:null},Bt,Wt,qt,{alias:null,args:null,concreteType:"PeerToPeerPlatformSoldItemDetail",kind:"LinkedField",name:"platform_item",plural:!1,selections:[O,Ut,{alias:null,args:null,concreteType:"Photo",kind:"LinkedField",name:"photos",plural:!0,selections:wt,storageKey:null},ae],storageKey:null},w,Vt,Ht,Gt,kt],jt={alias:null,args:null,concreteType:"CurrencyQuantity",kind:"LinkedField",name:"amount",plural:!1,selections:[Ft,ft],storageKey:null},Kt={alias:null,args:null,concreteType:"CurrencyAmount",kind:"LinkedField",name:"transaction_amount",plural:!1,selections:[_t],storageKey:null},Qt=[O,w,nt,Tt],Xt={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"requester",plural:!1,selections:Qt,storageKey:null},Yt={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"requestee",plural:!1,selections:Qt,storageKey:null},Jt={alias:null,args:null,kind:"ScalarField",name:"request_status",storageKey:null},Zt={alias:null,args:null,concreteType:"MessengerPayTheme",kind:"LinkedField",name:"request_theme",plural:!1,selections:q,storageKey:null},en={alias:null,args:null,concreteType:"PeerToPeerTransfer",kind:"LinkedField",name:"transfer",plural:!1,selections:zt,storageKey:null},tn={alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null},nn={alias:null,args:null,kind:"ScalarField",name:"updated_time",storageKey:null},rn={alias:"message",args:null,kind:"ScalarField",name:"snippet",storageKey:null},on=[Te,De,Me,we,Ae,w,Fe,Oe,Be,We,qe,Ue,He],an={alias:null,args:null,concreteType:"MessengerCallToAction",kind:"LinkedField",name:"call_to_actions",plural:!0,selections:on,storageKey:null},ln={alias:null,args:null,kind:"ScalarField",name:"image_aspect_ratio",storageKey:null},sn={alias:null,args:null,kind:"ScalarField",name:"first_metaline",storageKey:null},un={alias:null,args:null,kind:"ScalarField",name:"source_name",storageKey:null},cn={alias:null,args:null,kind:"ScalarField",name:"target_url",storageKey:null},dn={alias:null,args:null,concreteType:"MessengerCallToAction",kind:"LinkedField",name:"default_action",plural:!1,selections:on,storageKey:null},mn=[w,{alias:"large_preview",args:null,concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:ce,storageKey:null}],pn={kind:"InlineFragment",selections:mn,type:"MessageImage",abstractKey:null},_n={kind:"InlineFragment",selections:mn,type:"Photo",abstractKey:null},fn={kind:"Literal",name:"media_type",value:"image/gif"},gn={alias:null,args:[fn],concreteType:"Image",kind:"LinkedField",name:"animated_image",plural:!1,selections:ce,storageKey:'animated_image(media_type:"image/gif")'},hn={alias:"preview_image",args:[{kind:"Literal",name:"height",value:206},fn,{kind:"Literal",name:"width",value:206}],concreteType:"Image",kind:"LinkedField",name:"animated_image",plural:!1,selections:ce,storageKey:'animated_image(height:206,media_type:"image/gif",width:206)'},yn={kind:"InlineFragment",selections:[gn,hn,{alias:"large_preview",args:[{kind:"Literal",name:"height",value:420},me,{kind:"Literal",name:"width",value:420}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:ce,storageKey:'image(height:420,sizing:"contain-fit",width:420)'}],type:"MessageAnimatedImage",abstractKey:null},Cn={alias:null,args:null,concreteType:"Application",kind:"LinkedField",name:"attribution_app",plural:!1,selections:[w,O,{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"square_logo",plural:!1,selections:re,storageKey:null}],storageKey:null},bn={alias:null,args:null,kind:"ScalarField",name:"attribution_metadata",storageKey:null},vn=[ie,le,ne],Sn=[{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null}],Rn={alias:null,args:null,concreteType:"Vect2",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:Sn,storageKey:null},Ln={kind:"InlineFragment",selections:[Cn,bn,Xe,he,{alias:"chat_image",args:[{kind:"Literal",name:"height",value:200},me,{kind:"Literal",name:"width",value:168}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:vn,storageKey:'image(height:200,sizing:"contain-fit",width:168)'},H,{alias:null,args:null,kind:"ScalarField",name:"video_type",storageKey:null},Rn,fe,{alias:"large_image",args:[{kind:"Literal",name:"height",value:640},me,{kind:"Literal",name:"width",value:640}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:vn,storageKey:'image(height:640,sizing:"contain-fit",width:640)'},{alias:"inbox_image",args:[{kind:"Literal",name:"height",value:450},me,{kind:"Literal",name:"width",value:450}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:vn,storageKey:'image(height:450,sizing:"contain-fit",width:450)'}],type:"MessageVideo",abstractKey:null},En={kind:"InlineFragment",selections:[le,ie,w,he],type:"Video",abstractKey:null},kn=[{alias:null,args:null,concreteType:"MessengerRetailItem",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,Ut,ln,Ne,sn,O,un,cn,dn,an,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media_blob_attachments",plural:!0,selections:[Ke,pn,_n,yn,Ln,En],storageKey:null}],storageKey:null}],In={kind:"InlineFragment",selections:[{alias:"video_id",args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Video",abstractKey:null},Tn={alias:null,args:null,kind:"ScalarField",name:"expiration_time",storageKey:null},Dn={alias:null,args:null,kind:"ScalarField",name:"latitude",storageKey:null},xn={alias:null,args:null,kind:"ScalarField",name:"longitude",storageKey:null},$n=[Dn,xn],Pn={kind:"InlineFragment",selections:[{alias:"live_location_id",args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_expired",storageKey:null},Tn,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"sender",plural:!1,selections:q,storageKey:null},{alias:null,args:null,concreteType:"Coordinate",kind:"LinkedField",name:"coordinate",plural:!1,selections:$n,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"location_title",storageKey:null},{alias:null,args:null,concreteType:"LiveLocationDestination",kind:"LinkedField",name:"sender_destination",plural:!1,selections:[Dn,xn,ee],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"stop_reason",storageKey:null}],type:"MessageLiveLocation",abstractKey:null},Nn={alias:null,args:null,concreteType:"MessagingParticipant",kind:"LinkedField",name:"kept_by",plural:!1,selections:q,storageKey:null},Mn={alias:null,args:null,kind:"ScalarField",name:"kept_at",storageKey:null},wn={alias:null,args:null,kind:"ScalarField",name:"is_keep_disabled",storageKey:null},An={alias:null,args:null,kind:"ScalarField",name:"blob_media_type",storageKey:null},Fn=[he,ae,Mt],On={kind:"InlineFragment",selections:Fn,type:"MessageVideo",abstractKey:null},Bn={kind:"InlineFragment",selections:Fn,type:"MessageImage",abstractKey:null},Wn={alias:null,args:null,kind:"ScalarField",name:"montage_container_id",storageKey:null},qn={alias:null,args:null,kind:"ScalarField",name:"story_id",storageKey:null},Un={alias:null,args:null,kind:"ScalarField",name:"calendar_sync_type",storageKey:null},Vn={alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"page",plural:!1,selections:[w,Un,{alias:null,args:null,concreteType:"ServicesVerticalPageBasedInfo",kind:"LinkedField",name:"services_vertical_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_eligible_for_appointment_calendar",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_eligible_for_mbs_calendar",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_page_sp_enabled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"time_zone_name",storageKey:null}],storageKey:null}],storageKey:null},Hn={alias:null,args:null,kind:"ScalarField",name:"message_bubble_type",storageKey:null},Gn={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:q,storageKey:null},zn={alias:null,args:null,kind:"ScalarField",name:"ls_xma_title",storageKey:null},jn={alias:null,args:null,kind:"ScalarField",name:"ls_xma_subtitle",storageKey:null},Kn={alias:"availability",args:null,kind:"ScalarField",name:"user_availability",storageKey:null},Qn={alias:null,args:null,kind:"ScalarField",name:"request_flow_type",storageKey:null},Xn={alias:null,args:null,kind:"ScalarField",name:"service_general_info",storageKey:null},Yn={alias:null,args:null,kind:"ScalarField",name:"has_saved_to_calendar",storageKey:null},Jn=[w,O,nt],Zn={alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"page",plural:!1,selections:Jn,storageKey:null},er={alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},tr={alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null},nr=[er,tr],rr={alias:null,args:null,concreteType:"TimeRange",kind:"LinkedField",name:"suggested_time_range",plural:!1,selections:nr,storageKey:null},or={alias:"duration",args:null,kind:"ScalarField",name:"duration_in_seconds",storageKey:null},ar={alias:null,args:null,kind:"ScalarField",name:"duration_type",storageKey:null},ir=[{kind:"Literal",name:"first",value:1}],lr={alias:null,args:[{kind:"Literal",name:"sizing",value:"cover-fill-cropped"}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:re,storageKey:'image(sizing:"cover-fill-cropped")'},sr={alias:"price",args:null,kind:"ScalarField",name:"display_price",storageKey:null},ur={alias:null,args:null,kind:"ScalarField",name:"requested_time",storageKey:null},cr={alias:null,args:null,kind:"ScalarField",name:"special_request",storageKey:null},dr={alias:null,args:null,kind:"ScalarField",name:"booking_status_value",storageKey:null},mr={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},pr={alias:null,args:null,kind:"ScalarField",name:"archived_status",storageKey:null},_r={alias:null,args:null,kind:"ScalarField",name:"reminder_bubble_text",storageKey:null},fr={alias:null,args:null,kind:"ScalarField",name:"request_admin_approval_type",storageKey:null},gr={alias:null,args:null,concreteType:"JobApplication",kind:"LinkedField",name:"job_application",plural:!1,selections:q,storageKey:null},hr={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[w,It,nt],storageKey:null},yr={alias:null,args:null,concreteType:"ServicesNativeBookingRequestAdditionalInfoField",kind:"LinkedField",name:"additional_info",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"field_key",storageKey:null},it,ee],storageKey:null},Cr={alias:null,args:null,concreteType:"PhoneNumber",kind:"LinkedField",name:"consumer_phone_number",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"display_number",storageKey:null}],storageKey:null},br={alias:null,args:null,kind:"ScalarField",name:"recur_message",storageKey:null},vr=[w,O],Sr=[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"messaging_actor",plural:!1,selections:vr,storageKey:null}],Rr={alias:"eventID",args:null,kind:"ScalarField",name:"id",storageKey:null},Lr={alias:"guestStatus",args:null,kind:"ScalarField",name:"viewer_guest_status",storageKey:null},Er={alias:"canViewerJoin",args:null,kind:"ScalarField",name:"can_viewer_join",storageKey:null},kr={alias:"timeString",args:null,kind:"ScalarField",name:"start_time_sentence",storageKey:null},Ir=[O],Tr={alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"social_context",plural:!1,selections:z,storageKey:null},Dr={alias:"watchStatus",args:null,kind:"ScalarField",name:"viewer_watch_status",storageKey:null},xr={alias:null,args:null,kind:"ScalarField",name:"connection_style",storageKey:null},$r={alias:"canViewerWatch",args:null,kind:"ScalarField",name:"can_viewer_watch",storageKey:null},Pr={alias:null,args:[{kind:"Literal",name:"width",value:300}],concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:re,storageKey:"profile_picture(width:300)"},Nr={alias:null,args:null,kind:"ScalarField",name:"start_timestamp",storageKey:null},Mr={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"application_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"artist_names",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"audio_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"duration_ms",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"music_title",storageKey:null}],type:"ExternalSong",abstractKey:null},wr={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"lwa_state",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lwa_type",storageKey:null}],type:"LightweightAction",abstractKey:null},Ar={alias:"desc",args:null,kind:"ScalarField",name:"description",storageKey:null},Fr={alias:"thumb_url",args:null,kind:"ScalarField",name:"image_url",storageKey:null},Or={alias:"item_url",args:null,kind:"ScalarField",name:"target_url",storageKey:null},Br={alias:"source",args:null,kind:"ScalarField",name:"source_name",storageKey:null},Wr={alias:null,args:null,kind:"ScalarField",name:"second_metaline",storageKey:null},qr={alias:null,args:null,kind:"ScalarField",name:"third_metaline",storageKey:null},Ur={alias:"total_cost",args:null,kind:"ScalarField",name:"formated_price",storageKey:null},Vr={alias:"merchant_name",args:null,kind:"ScalarField",name:"seller_info",storageKey:null},Hr={alias:"raw_amount",args:null,kind:"ScalarField",name:"price_amount",storageKey:null},Gr={alias:null,args:null,concreteType:"MessengerCommercePayment",kind:"LinkedField",name:"payment",plural:!1,selections:q,storageKey:null},zr={alias:null,args:null,kind:"ScalarField",name:"price_currency",storageKey:null},jr={alias:null,args:null,kind:"ScalarField",name:"price_amount",storageKey:null},Kr={alias:null,args:null,kind:"ScalarField",name:"can_donate",storageKey:null},Qr={alias:null,args:null,kind:"ScalarField",name:"has_viewer_donated",storageKey:null},Xr={alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"fundraiser_detailed_progress_text",plural:!1,selections:z,storageKey:null},Yr={alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"fundraiser_subtitle_text",plural:!1,selections:z,storageKey:null},Jr=[ne,le,ie],Zr={alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:Jr,storageKey:null},eo={alias:null,args:null,kind:"ScalarField",name:"recipient_name",storageKey:null},to={alias:null,args:null,kind:"ScalarField",name:"merchant_name",storageKey:null},no={alias:null,args:null,kind:"ScalarField",name:"account_holder_name",storageKey:null},ro={alias:null,args:null,kind:"ScalarField",name:"receipt_id",storageKey:null},oo={alias:null,args:null,kind:"ScalarField",name:"shipping_method",storageKey:null},ao={alias:null,args:null,kind:"ScalarField",name:"order_payment_method",storageKey:null},io={alias:null,args:null,kind:"ScalarField",name:"receipt_url",storageKey:null},lo={alias:null,args:null,kind:"ScalarField",name:"cancellation_url",storageKey:null},so={alias:null,args:null,kind:"ScalarField",name:"receipient_address",storageKey:null},uo={alias:null,args:null,kind:"ScalarField",name:"streets",storageKey:null},co={alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},mo={alias:null,args:null,kind:"ScalarField",name:"country",storageKey:null},po={alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},_o={alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null},fo={alias:null,args:null,concreteType:"MessengerCommerceBusinessLocation",kind:"LinkedField",name:"structured_address",plural:!1,selections:[uo,co,mo,po,_o],storageKey:null},go={alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null},ho={alias:null,args:null,kind:"ScalarField",name:"tax",storageKey:null},yo={alias:null,args:null,kind:"ScalarField",name:"shipping_cost",storageKey:null},Co={alias:null,args:null,kind:"ScalarField",name:"subtotal",storageKey:null},bo={alias:null,args:null,kind:"ScalarField",name:"bubble_type",storageKey:null},vo={alias:null,args:null,kind:"ScalarField",name:"order_time_for_display",storageKey:null},So={alias:null,args:null,concreteType:"RetailReceiptAdjustment",kind:"LinkedField",name:"retail_adjustments",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"adjustment_amount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"adjustment_type",storageKey:null}],storageKey:null},Ro={alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"partner_logo",plural:!1,selections:re,storageKey:null},Lo={alias:null,args:null,kind:"ScalarField",name:"payment_modules_client",storageKey:null},Eo={alias:null,args:null,kind:"ScalarField",name:"is_viewer_seller",storageKey:null},ko={alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"payment_snippet",plural:!1,selections:z,storageKey:null},Io={alias:null,args:null,kind:"ScalarField",name:"item_id",storageKey:null},To={alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"subtitle",plural:!1,selections:z,storageKey:null},Do=[_t,ft],xo={alias:null,args:null,concreteType:"CurrencyAmount",kind:"LinkedField",name:"unit_price",plural:!1,selections:Do,storageKey:null},$o={alias:null,args:oe,concreteType:"Image",kind:"LinkedField",name:"images",plural:!0,selections:re,storageKey:"images(height:120,width:120)"},Po={alias:null,args:null,kind:"ScalarField",name:"quantity",storageKey:null},No={alias:null,args:null,concreteType:"PaymentPlatformAttachmentComponent",kind:"LinkedField",name:"components",plural:!0,selections:[mt,To,{alias:null,args:oe,concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:re,storageKey:"image(height:120,width:120)"}],storageKey:null},Mo=[_o,{alias:null,args:null,kind:"ScalarField",name:"action_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"action_detail",storageKey:null},{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"label",plural:!1,selections:z,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"checkmark",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"extra_data",storageKey:null}],wo={alias:null,args:null,concreteType:"PaymentPlatformAttachmentCallToAction",kind:"LinkedField",name:"payment_call_to_actions",plural:!0,selections:Mo,storageKey:null},Ao={alias:null,args:null,concreteType:"PaymentPlatformAttachmentCallToAction",kind:"LinkedField",name:"click_action",plural:!1,selections:Mo,storageKey:null},Fo={alias:null,args:null,concreteType:"PaymentPlatformAttachmentCallToAction",kind:"LinkedField",name:"summary_action",plural:!1,selections:Mo,storageKey:null},Oo={alias:null,args:null,kind:"ScalarField",name:"invoicer_id",storageKey:null},Bo={alias:null,args:null,kind:"ScalarField",name:"is_last_attachment",storageKey:null},Wo={alias:null,args:null,concreteType:"CurrencyAmount",kind:"LinkedField",name:"payment_total",plural:!1,selections:Do,storageKey:null},qo={alias:null,args:null,kind:"ScalarField",name:"product_detail",storageKey:null},Uo={alias:null,args:null,concreteType:"PaymentPlatformAttachmentIcon",kind:"LinkedField",name:"payment_status_icon",plural:!1,selections:[mr],storageKey:null},Vo={alias:null,args:null,kind:"ScalarField",name:"user_facing_payment_status",storageKey:null},Ho={alias:null,args:null,kind:"ScalarField",name:"payment_sub_statuses",storageKey:null},Go={alias:null,args:null,kind:"ScalarField",name:"should_show_new_xma",storageKey:null},zo={alias:null,args:null,kind:"ScalarField",name:"buyer_name",storageKey:null},jo={alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"group_commerce_item_description",plural:!1,selections:z,storageKey:null},Ko={alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"formatted_price",plural:!1,selections:z,storageKey:null},Qo={alias:null,args:null,kind:"ScalarField",name:"group_commerce_item_title",storageKey:null},Xo={alias:null,args:pe,concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:re,storageKey:'image(sizing:"contain-fit")'},Yo={alias:"primary_photo",args:null,concreteType:null,kind:"LinkedField",name:"primary_listing_photo",plural:!1,selections:[Xo],storageKey:null},Jo={alias:null,args:null,concreteType:"StreetAddress",kind:"LinkedField",name:"address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"single_line_full_address",storageKey:null}],storageKey:null},Zo={alias:null,args:null,kind:"ScalarField",name:"top_category_name",storageKey:null},ea={alias:null,args:null,concreteType:"FocusedPhoto",kind:"LinkedField",name:"cover_photo",plural:!1,selections:[{alias:null,args:null,concreteType:"Photo",kind:"LinkedField",name:"photo",plural:!1,selections:[w,{alias:null,args:[{kind:"Literal",name:"height",value:720},me,{kind:"Literal",name:"width",value:720}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:Jr,storageKey:'image(height:720,sizing:"contain-fit",width:720)'}],storageKey:null}],storageKey:null},ta={alias:null,args:null,concreteType:"Location",kind:"LinkedField",name:"location",plural:!1,selections:$n,storageKey:null},na={alias:null,args:null,concreteType:"Rating",kind:"LinkedField",name:"overall_star_rating",plural:!1,selections:[it],storageKey:null},ra={alias:null,args:null,kind:"ScalarField",name:"price_range_description",storageKey:null},oa={alias:null,args:null,kind:"ScalarField",name:"event_title",storageKey:null},aa={alias:null,args:null,kind:"ScalarField",name:"time",storageKey:null},ia={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"is_active",storageKey:null},oa,aa],type:"MessengerEventReminder",abstractKey:null},la={alias:null,args:null,kind:"ScalarField",name:"tracking_number",storageKey:null},sa={alias:null,args:null,kind:"ScalarField",name:"shipdate_for_display",storageKey:null},ua={alias:null,args:null,kind:"ScalarField",name:"estimated_delivery_time_for_display",storageKey:null},ca={alias:null,args:null,kind:"ScalarField",name:"timezone",storageKey:null},da=[mo,co,po,xn,Dn,_o,uo,ca],ma={alias:null,args:null,concreteType:"MessengerCommerceBusinessLocation",kind:"LinkedField",name:"commerce_origin",plural:!1,selections:da,storageKey:null},pa={alias:null,args:null,concreteType:"MessengerCommerceBusinessLocation",kind:"LinkedField",name:"commerce_destination",plural:!1,selections:da,storageKey:null},_a={alias:null,args:null,concreteType:"RetailShipmentItemsConnection",kind:"LinkedField",name:"retail_shipment_items",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerRetailItem",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,O,Ar,Fr,Or,Br,ln,sn,Wr,qr,an],storageKey:null}],storageKey:null},fa={alias:null,args:null,kind:"ScalarField",name:"carrier_tracking_url",storageKey:null},ga=[le,ie,ne],ha={alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"logo",plural:!1,selections:ga,storageKey:null},ya={alias:null,args:null,concreteType:"MessengerRetailCarrier",kind:"LinkedField",name:"retail_carrier",plural:!1,selections:[O,fa,ha],storageKey:null},Ca={alias:null,args:null,concreteType:"MessengerCommerceBusinessLocation",kind:"LinkedField",name:"messenger_commerce_location",plural:!1,selections:da,storageKey:null},ba={alias:null,args:null,concreteType:"RetailShipmentTrackingEventsConnection",kind:"LinkedField",name:"shipment_tracking_events",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerRetailShipmentTrackingEvent",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,Ca],storageKey:null}],storageKey:null},va={alias:null,args:null,kind:"ScalarField",name:"tracking_event_time_for_display",storageKey:null},Sa={alias:null,args:null,kind:"ScalarField",name:"shipment_tracking_event_type",storageKey:null},Ra={alias:null,args:null,kind:"ScalarField",name:"tracking_event_description",storageKey:null},La={alias:null,args:null,concreteType:"MessengerRetailCarrier",kind:"LinkedField",name:"retail_carrier",plural:!1,selections:[O,fa,ha,{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"legal_terms_of_service_text",plural:!1,selections:z,storageKey:null}],storageKey:null},Ea={alias:null,args:null,concreteType:"RetailShipmentTrackingEventsConnection",kind:"LinkedField",name:"shipment_tracking_events",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerRetailShipmentTrackingEvent",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,Sa,Ca],storageKey:null}],storageKey:null},ka={alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"cover_image",plural:!1,selections:Jr,storageKey:null},Ia={alias:null,args:null,kind:"ScalarField",name:"headline",storageKey:null},Ta={alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"page",plural:!1,selections:vr,storageKey:null},Da={alias:null,args:null,concreteType:"LeadGenUserInfoField",kind:"LinkedField",name:"field_data",plural:!0,selections:[ee,O,{alias:null,args:null,kind:"ScalarField",name:"values",storageKey:null}],storageKey:null},xa=[G,K],$a={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"sender_wec_number",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sender_wec_number_formated",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sender_wec_number_fbid",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sender_wec_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"wec_referral_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"wec_referral_body",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"wec_referral_headline",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"wec_referral_media",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"wec_referral_media_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"wec_referral_has_admin_text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"wec_sticker_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templated_message_body",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templated_message_footer",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templated_message_header_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templated_message_header_text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templated_message_header_media",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templated_message_btn1_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templated_message_btn1_text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templated_message_btn2_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templated_message_btn2_text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templated_message_btn3_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templated_message_btn3_text",storageKey:null},{alias:null,args:null,concreteType:"XFBWATemplatedMessageButtonShape",kind:"LinkedField",name:"templated_message_buttons",plural:!0,selections:xa,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templated_message_offer_text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templated_message_offer_has_expiration",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templated_message_offer_expiration_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templated_message_offer_is_offer_code_personalized",storageKey:null},{alias:null,args:null,concreteType:"XFBWATemplatedMessageCardShape",kind:"LinkedField",name:"templated_message_cards",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"title_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sample_handle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"body",storageKey:null},{alias:null,args:null,concreteType:"XFBWATemplatedMessageButtonShape",kind:"LinkedField",name:"button",plural:!1,selections:xa,storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templated_message_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templated_message_name",storageKey:null}],type:"WECMessage",abstractKey:null},Pa={alias:null,args:null,kind:"ScalarField",name:"is_malicious",storageKey:null},Na={alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"thumbnail_image",plural:!1,selections:ce,storageKey:null},Ma={alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null},wa={alias:null,args:null,kind:"ScalarField",name:"ad_id",storageKey:null},Aa={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"ice_breaker_title",storageKey:null},{alias:null,args:null,concreteType:"IceBreakerMessage",kind:"LinkedField",name:"ice_breaker_messages",plural:!0,selections:[Ma,{alias:null,args:null,kind:"ScalarField",name:"message_key",storageKey:null}],storageKey:null},wa],type:"IceBreakerMessageAttachment",abstractKey:null},Fa={kind:"Literal",name:"height",value:280},Oa={kind:"Literal",name:"width",value:280},Ba=[Fa,Oa],Wa={alias:"preview",args:Ba,concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:ce,storageKey:"image(height:280,width:280)"},qa={kind:"Literal",name:"height",value:480},Ua={kind:"Literal",name:"width",value:480},Va={alias:"large_preview",args:[qa,Ua],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:ce,storageKey:"image(height:480,width:480)"},Ha={alias:null,args:null,kind:"ScalarField",name:"module_name",storageKey:null},Ga={alias:null,args:null,kind:"ScalarField",name:"program_name",storageKey:null},za={alias:null,args:null,kind:"ScalarField",name:"curriculum_message",storageKey:null},ja={alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null},Ka={alias:null,args:null,kind:"ScalarField",name:"step_count",storageKey:null},Qa={alias:null,args:null,kind:"ScalarField",name:"total_steps",storageKey:null},Xa={alias:null,args:null,concreteType:"MentorshipProgram",kind:"LinkedField",name:"mentorship_program",plural:!1,selections:[w,{alias:null,args:null,concreteType:"MentorshipCurriculum",kind:"LinkedField",name:"curriculum",plural:!1,selections:q,storageKey:null}],storageKey:null},Ya={alias:null,args:null,kind:"ScalarField",name:"topics",storageKey:null},Ja=[It],Za={alias:null,args:null,kind:"ScalarField",name:"xma_type",storageKey:null},ei={alias:null,args:null,kind:"ScalarField",name:"xma_title",storageKey:null},ti={alias:null,args:null,kind:"ScalarField",name:"xma_body",storageKey:null},ni={alias:null,args:null,kind:"ScalarField",name:"offset",storageKey:null},ri={alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"title",plural:!1,selections:[G,{alias:null,args:null,concreteType:"EntityAtRange",kind:"LinkedField",name:"ranges",plural:!0,selections:[lt,ni],storageKey:null}],storageKey:null},oi={alias:null,args:null,kind:"ScalarField",name:"block_type",storageKey:null},ai={alias:null,args:null,kind:"ScalarField",name:"data",storageKey:null},ii={alias:null,args:null,kind:"ScalarField",name:"depth",storageKey:null},li={alias:null,args:null,concreteType:"InlineStyleAtRange",kind:"LinkedField",name:"inline_style_ranges",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"inline_style",storageKey:null},lt,ni],storageKey:null},si={alias:null,args:null,kind:"ScalarField",name:"comment_count_reduced",storageKey:null},ui={alias:null,args:null,concreteType:"TopLevelCommentsConnection",kind:"LinkedField",name:"top_level_comments",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"total_count",storageKey:null}],storageKey:null},ci={alias:null,args:null,kind:"ScalarField",name:"reaction_count_reduced",storageKey:null},di={kind:"Literal",name:"first",value:3},mi=[di,{kind:"Literal",name:"orderby",value:["COUNT_DESC","REACTION_TYPE"]}],pi={alias:null,args:null,kind:"ScalarField",name:"reaction_type",storageKey:null},_i={alias:null,args:null,kind:"ScalarField",name:"post_id",storageKey:null},fi={alias:"description",args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"message",plural:!1,selections:z,storageKey:null},gi={kind:"InlineFragment",selections:Ja,type:"User",abstractKey:null},hi=[ae],yi={kind:"InlineFragment",selections:hi,type:"Entity",abstractKey:"__isEntity"},Ci={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actors",plural:!0,selections:[Ke,O,w,gi,yi,{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:ce,storageKey:null}],storageKey:null},bi={alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:ce,storageKey:null},vi={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media",plural:!1,selections:[ge,bi],storageKey:null},Si={alias:"title",args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"title_with_entities",plural:!1,selections:z,storageKey:null},Ri=[di],Li={alias:null,args:null,kind:"ScalarField",name:"count",storageKey:null},Ei=[{kind:"Literal",name:"if_style",value:"file_upload"}],ki={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media",plural:!1,selections:wt,storageKey:null},Ii=[{kind:"Literal",name:"if_style",value:"photo"}],Ti={alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"message",plural:!1,selections:z,storageKey:null},Di={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actors",plural:!0,selections:[Ke,O,w,gi,yi],storageKey:null},xi={alias:null,args:null,concreteType:"Photo",kind:"LinkedField",name:"photo",plural:!1,selections:wt,storageKey:null},$i={alias:null,args:null,concreteType:"FocusedPhoto",kind:"LinkedField",name:"cover_photo",plural:!1,selections:[xi],storageKey:null},Pi={alias:null,args:null,kind:"ScalarField",name:"job_title",storageKey:null},Ni={alias:null,args:null,concreteType:"WorkUserInfo",kind:"LinkedField",name:"work_info",plural:!1,selections:[Pi],storageKey:null},Mi={alias:null,args:null,kind:"ScalarField",name:"subscribe_status",storageKey:null},wi={alias:null,args:null,kind:"ScalarField",name:"visibility",storageKey:null},Ai={alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"visibility_sentence",plural:!1,selections:z,storageKey:null},Fi={alias:null,args:null,kind:"ScalarField",name:"viewer_join_state",storageKey:null},Oi={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"group_general_chat",plural:!1,selections:q,storageKey:null},Bi={alias:null,args:null,kind:"ScalarField",name:"attachment_type_name",storageKey:null},Wi={alias:null,args:null,kind:"ScalarField",name:"privacy_status",storageKey:null},qi={alias:null,args:null,kind:"ScalarField",name:"file_type_category",storageKey:null},Ui={alias:null,args:null,kind:"ScalarField",name:"app_integration_type",storageKey:null},Vi={alias:null,args:[{kind:"Literal",name:"size",value:"D32"}],concreteType:"Image",kind:"LinkedField",name:"logo",plural:!1,selections:re,storageKey:'logo(size:"D32")'},Hi={alias:null,args:null,kind:"ScalarField",name:"viewer_auth_link",storageKey:null},Gi={alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"attachment_icon",plural:!1,selections:re,storageKey:null},zi={alias:null,args:null,kind:"ScalarField",name:"content_uri",storageKey:null},ji={alias:null,args:null,kind:"ScalarField",name:"format",storageKey:null},Ki={alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},Qi={alias:null,args:null,kind:"ScalarField",name:"referral_offer_link",storageKey:null},Xi={alias:null,args:null,kind:"ScalarField",name:"cta_title",storageKey:null},Yi={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"action_prefill",storageKey:null},wa,Xi,{alias:null,args:null,kind:"ScalarField",name:"customer_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"index",storageKey:null},Ue,{alias:null,args:null,kind:"ScalarField",name:"reply_image_uri",storageKey:null}],type:"InThreadMultiphotoItemCTAData",abstractKey:null},Ji={alias:null,args:null,kind:"ScalarField",name:"viewer_id",storageKey:null},Zi={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"payment_confirmation_status",storageKey:null}],type:"XFBPaymentInvoiceMediaMessageDetection",abstractKey:null},el={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"target",plural:!1,selections:[Ke,Qe,{kind:"InlineFragment",selections:[w,Xe,he,Ye,Je,Ze,et],type:"WECMessageAudio",abstractKey:null},{kind:"InlineFragment",selections:[tt,ot,at,kt],type:"MoneyTransfer",abstractKey:null},{kind:"InlineFragment",selections:zt,type:"PeerToPeerTransfer",abstractKey:null},{kind:"InlineFragment",selections:[jt,Kt,Xt,Yt,Jt,Zt,w,Gt,en,tn,qt,nn,Vt,kt,{alias:null,args:null,concreteType:"PeerToPeerPaymentRequest",kind:"LinkedField",name:"individual_requests",plural:!0,selections:[jt,Kt,Xt,Yt,Jt,Zt,w,Gt,en,tn,qt,nn,Vt,kt],storageKey:null}],type:"PeerToPeerPaymentRequest",abstractKey:null},kt,{kind:"InlineFragment",selections:[rn,an,{alias:null,args:null,concreteType:"RetailPromotionItemsConnection",kind:"LinkedField",name:"promotion_items",plural:!1,selections:kn,storageKey:null}],type:"MessengerRetailPromotion",abstractKey:null},{kind:"InlineFragment",selections:[rn,an,{alias:null,args:null,concreteType:"MessengerBusinessMessageItemsConnection",kind:"LinkedField",name:"business_items",plural:!1,selections:kn,storageKey:null}],type:"MessengerBusinessMessage",abstractKey:null},In,Pn,{kind:"InlineFragment",selections:[w,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"invite_sender",plural:!1,selections:q,storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"invite_recipient",plural:!1,selections:q,storageKey:null}],type:"QuickInvite",abstractKey:null},{kind:"InlineFragment",selections:[Nn,Mn,wn,An,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"blob_media",plural:!1,selections:[On,Bn],storageKey:null}],type:"MontageDirect",abstractKey:null},{kind:"InlineFragment",selections:[w,Wn,W,qn],type:"MontageShare",abstractKey:null},{kind:"InlineFragment",selections:[w,Vn,Hn,Gn,zn,jn,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"native_component_flow_request",plural:!1,selections:[{kind:"InlineFragment",selections:[Kn,Qn,Xn,w,Un,Yn,Zn,rr,{alias:null,args:null,concreteType:"NativeComponentFlowBookingRequestServicesProductItemsConnection",kind:"LinkedField",name:"services_product_items",plural:!1,selections:[{alias:null,args:null,concreteType:"ServicesProductItem",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,O,Ut,or,ar,{alias:null,args:ir,concreteType:"ProductImage",kind:"LinkedField",name:"images",plural:!0,selections:[lr],storageKey:"images(first:1)"},sr],storageKey:null}],storageKey:null},ur,cr,dr,mr,pr,_r,fr,gr,hr,yr,Cr,zn,jn,br],type:"NativeComponentFlowBookingRequest",abstractKey:null}],storageKey:null}],type:"PagesPlatformBookingMessage",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"MessagingParticipant",kind:"LinkedField",name:"genie_sender",plural:!1,selections:Sr,storageKey:null},{alias:null,args:null,concreteType:"StoryAttachment",kind:"LinkedField",name:"story_attachment",plural:!1,selections:[j,Z,ye,Ce,be,ve,Re,Le,Ee,ke,Ie,ze,je],storageKey:null}],type:"GenieMessage",abstractKey:null},{kind:"InlineFragment",selections:[Rr,Lr,Er,kr,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"event_place",plural:!1,selections:Ir,storageKey:null},Tr,Dr,xr,$r,Pr,O,Nr],type:"Event",abstractKey:null},Mr,wr,{kind:"InlineFragment",selections:[w,O,Ar,Fr,Or,Br,ln,sn,Wr,qr,dn,an],type:"MessengerRetailItem",abstractKey:null},{kind:"InlineFragment",selections:[w,Ar,Ur,Vr,cn,Fr,Hr,Gr,zr,jr,O],type:"AgentItemSuggestion",abstractKey:null},{kind:"InlineFragment",selections:[w,Kr,Qr,Xr,Yr,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"FundraiserCoverPhoto",kind:"LinkedField",name:"focused_cover_photo",plural:!1,selections:[{alias:null,args:null,concreteType:"Photo",kind:"LinkedField",name:"photo",plural:!1,selections:[Zr],storageKey:null}],storageKey:null}],type:"FundraiserWithPresence",abstractKey:"__isFundraiserWithPresence"}],type:"Fundraiser",abstractKey:"__isFundraiser"},{kind:"InlineFragment",selections:[w,eo,to,no,ro,oo,ao,io,lo,so,fo,mr,go,ho,yo,Co,{alias:null,args:null,concreteType:"RetailReceiptItemsConnection",kind:"LinkedField",name:"retail_items",plural:!1,selections:kn,storageKey:null},bo,vo,So,Ro],type:"MessengerRetailReceipt",abstractKey:null},{kind:"InlineFragment",selections:[Lo,Eo,ko,{alias:null,args:null,concreteType:"PaymentInvoiceProduct",kind:"LinkedField",name:"item_list",plural:!0,selections:[Io,O,To,Ut,xo,$o,Po],storageKey:null},No,wo,Ao,Fo,Oo,Bo,Wo,qo,Uo,Vo,Ho,Go,zo],type:"PaymentPlatformAttachment",abstractKey:null},{kind:"InlineFragment",selections:q,type:"JobApplication",abstractKey:null},{kind:"InlineFragment",selections:[jo,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"group_commerce_item_seller",plural:!1,selections:q,storageKey:null},Ko,Qo,Yo,ae],type:"GroupCommerceProductItem",abstractKey:null},{kind:"InlineFragment",selections:[Ko,Yo],type:"MarketplaceListingRenderable",abstractKey:"__isMarketplaceListingRenderable"},{kind:"InlineFragment",selections:[Jo,Zo,ea,ta,O,na,w,ra],type:"Page",abstractKey:null},ia,{kind:"InlineFragment",selections:[w,{alias:null,args:null,concreteType:"MessengerRetailShipment",kind:"LinkedField",name:"shipment",plural:!1,selections:[w,la,sa,ua,ma,pa,_a,ya,ba],storageKey:null},va,Sa,Ca,Ra,bo],type:"MessengerRetailShipmentTrackingEvent",abstractKey:null},{kind:"InlineFragment",selections:[w,la,sa,ua,ma,pa,_a,La,Ea,{alias:null,args:null,concreteType:"MessengerRetailReceipt",kind:"LinkedField",name:"receipt",plural:!1,selections:[ro],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"recipient",plural:!1,selections:Ir,storageKey:null},bo],type:"MessengerRetailShipment",abstractKey:null},{kind:"InlineFragment",selections:[w,ka,Ia,O,Ta],type:"LeadGenDeepLinkData",abstractKey:null},{kind:"InlineFragment",selections:[w,Da],type:"UserLeadGenInfo",abstractKey:null},$a,{kind:"InlineFragment",selections:[w,O,Pa,ne,Je,Ze],type:"WECMessageFile",abstractKey:null},{kind:"InlineFragment",selections:[w,he,Ye,Je,Ze,Xe,ie,Na,le],type:"WECMessageVideo",abstractKey:null},Aa,{kind:"InlineFragment",selections:[w,Je,Wa,Va],type:"WECMessageImage",abstractKey:null},{kind:"InlineFragment",selections:[w,Ha,Ga,za,ja,Ka,Qa,Xa],type:"MentorshipMessengerCurriculumStep",abstractKey:null},{kind:"InlineFragment",selections:[w,Ya],type:"MentorshipMessengerDiscussionTopicSet",abstractKey:null},{kind:"InlineFragment",selections:[w,{alias:null,args:null,concreteType:"MentorshipProgram",kind:"LinkedField",name:"mentorship_program",plural:!1,selections:[w,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"other_member",plural:!1,selections:Ja,storageKey:null}],storageKey:null},Za],type:"MentorshipMessengerLeavePrompt",abstractKey:null},{kind:"InlineFragment",selections:[w,Za],type:"MentorshipMessengerReminder",abstractKey:null},{kind:"InlineFragment",selections:[w,Za,ei,ti],type:"MentorshipMessengerProgressTracker",abstractKey:null},{kind:"InlineFragment",selections:[ri,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"message_richtext",plural:!0,selections:[oi,ai,ii,{alias:null,args:null,concreteType:"ComposedEntityAtRange",kind:"LinkedField",name:"entity_ranges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"entity",plural:!1,selections:[Ke],storageKey:null},lt,ni],storageKey:null},li,G],storageKey:null},{alias:null,args:null,concreteType:"Feedback",kind:"LinkedField",name:"feedback",plural:!1,selections:[si,ui,ci,{alias:null,args:mi,concreteType:"TopReactionsConnection",kind:"LinkedField",name:"top_reactions",plural:!1,selections:[{alias:null,args:null,concreteType:"FeedbackReactionInfo",kind:"LinkedField",name:"nodes",plural:!0,selections:[pi],storageKey:null}],storageKey:'top_reactions(first:3,orderby:["COUNT_DESC","REACTION_TYPE"])'}],storageKey:null},_i,tn,fi,Ci,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"to",plural:!1,selections:[Ke,O,gi,yi],storageKey:null},{alias:null,args:null,concreteType:"StoryAttachment",kind:"LinkedField",name:"attachments",plural:!0,selections:[be,ae,Ce,j,vi,Si,{alias:null,args:Ri,concreteType:"SubattachmentsConnection",kind:"LinkedField",name:"all_subattachments",plural:!1,selections:[Li,{alias:"files",args:Ei,concreteType:"StoryAttachment",kind:"LinkedField",name:"nodes",plural:!0,selections:[Si,ki],storageKey:'nodes(if_style:"file_upload")'},{alias:"images",args:Ii,concreteType:"StoryAttachment",kind:"LinkedField",name:"nodes",plural:!0,selections:[ki],storageKey:'nodes(if_style:"photo")'}],storageKey:"all_subattachments(first:3)"}],storageKey:null},{alias:null,args:null,concreteType:"Story",kind:"LinkedField",name:"attached_story",plural:!1,selections:[Ti,Di,{alias:null,args:null,concreteType:"StoryAttachment",kind:"LinkedField",name:"attachments",plural:!0,selections:[vi],storageKey:null}],storageKey:null}],type:"Story",abstractKey:null},{kind:"InlineFragment",selections:[w,O,nt,$i,Ni,Mi],type:"User",abstractKey:null},{kind:"InlineFragment",selections:[w,O,wi,Ai,Fi,$i,Oi,{alias:null,args:null,concreteType:"GroupsSyncMetadata",kind:"LinkedField",name:"work_groups_sync_metadata",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"messenger_group",plural:!1,selections:q,storageKey:null}],storageKey:null}],type:"Group",abstractKey:null},{kind:"InlineFragment",selections:[w,Bi,Wi,qi,{alias:null,args:null,concreteType:"AppIntegration",kind:"LinkedField",name:"app_integration",plural:!1,selections:[Ui,O,Vi,Hi],storageKey:null},Gi,zi,{alias:null,args:null,concreteType:"AppContentAdditionalData",kind:"LinkedField",name:"link_preview_additional_data",plural:!0,selections:[Q,G,bt,ji,Ki,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"profiles",plural:!0,selections:[nt,O],storageKey:null}],storageKey:null}],type:"AppContent",abstractKey:null},{kind:"InlineFragment",selections:q,type:"OfferItem",abstractKey:null},{kind:"InlineFragment",selections:[dn],type:"CommerceProductItemShare",abstractKey:null},{kind:"InlineFragment",selections:[w,Qi],type:"ApplicationReferralXMA",abstractKey:null},Yi,{kind:"InlineFragment",selections:[w,Ji],type:"XFBP2MXMA",abstractKey:null},Zi],storageKey:null},tl={alias:null,args:null,concreteType:"StoryAttachment",kind:"LinkedField",name:"story_attachment",plural:!1,selections:[j,Z,ye,Ce,be,ve,Re,Le,Ee,ke,Ie,ze,je,el,{alias:null,args:null,concreteType:"StoryAttachment",kind:"LinkedField",name:"subattachments",plural:!0,selections:[j,Z,ye,Ce,be,ve,Re,Le,Ee,ke,Ie,ze,je,el],storageKey:null}],storageKey:null},nl={kind:"InlineFragment",selections:q,type:"Node",abstractKey:"__isNode"},rl={alias:null,args:null,concreteType:"ExtensibleMessageAttachment",kind:"LinkedField",name:"extensible_attachment",plural:!1,selections:[H,tl,{alias:"genie_attachment",args:null,concreteType:"StoryAttachment",kind:"LinkedField",name:"story_attachment",plural:!1,selections:[{alias:"genie_message",args:null,concreteType:null,kind:"LinkedField",name:"target",plural:!1,selections:[{kind:"InlineFragment",selections:[w,{alias:null,args:null,concreteType:"MessagingParticipant",kind:"LinkedField",name:"genie_sender",plural:!1,selections:[w,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"messaging_actor",plural:!1,selections:[nl,O],storageKey:null}],storageKey:null},tl],type:"GenieMessage",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null},ol={alias:null,args:null,concreteType:"Sticker",kind:"LinkedField",name:"sticker",plural:!1,selections:se,storageKey:null},al={kind:"Literal",name:"sizing",value:"cover-fill"},il={alias:null,args:null,kind:"ScalarField",name:"projection_type",storageKey:null},ll={kind:"InlineFragment",selections:[Cn,bn,Xe,{alias:"preview",args:[Fa,al,Oa],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:ce,storageKey:'image(height:280,sizing:"cover-fill",width:280)'},{alias:"large_preview",args:[qa,al,Ua],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:ce,storageKey:'image(height:480,sizing:"cover-fill",width:480)'},{alias:"thumbnail",args:[{kind:"Literal",name:"height",value:38},{kind:"Literal",name:"width",value:58}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:re,storageKey:"image(height:38,width:58)"},{alias:null,args:null,concreteType:"PhotoEncoding",kind:"LinkedField",name:"photo_encodings",plural:!0,selections:[w,le,ie,il,{alias:null,args:null,kind:"ScalarField",name:"cdn_uri",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_tile_level",storageKey:null},{alias:null,args:[{kind:"Literal",name:"thumbnail_dimensions",value:[{height:280,width:280},{height:480,width:480}]}],concreteType:"SphericalPhotoThumbnail",kind:"LinkedField",name:"thumbnails",plural:!0,selections:ga,storageKey:'thumbnails(thumbnail_dimensions:[{"height":280,"width":280},{"height":480,"width":480}])'},{alias:null,args:[{kind:"Literal",name:"tile_levels",value:[0]}],concreteType:"PhotoTile",kind:"LinkedField",name:"tiles",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"level",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"face",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"col",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"row",storageKey:null},ne],storageKey:"tiles(tile_levels:[0])"},{alias:null,args:null,concreteType:"PhotosphereMetadata",kind:"LinkedField",name:"spherical_metadata",plural:!1,selections:[il,{alias:null,args:null,kind:"ScalarField",name:"full_pano_width_pixels",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"full_pano_height_pixels",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cropped_area_image_width_pixels",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cropped_area_image_height_pixels",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cropped_area_left_pixels",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cropped_area_top_pixels",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"initial_view_heading_degrees",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"initial_view_pitch_degrees",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"initial_view_vertical_fov_degrees",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"initial_view_roll_degrees",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"pose_heading_degrees",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"pose_pitch_degrees",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"pose_roll_degrees",storageKey:null}],storageKey:null}],storageKey:null},H,Rn,{alias:null,args:null,kind:"ScalarField",name:"original_extension",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"render_as_sticker",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"blurred_image_uri",storageKey:null}],type:"MessageImage",abstractKey:null},sl={kind:"InlineFragment",selections:[Cn,bn,Xe,gn,{alias:null,args:null,kind:"ScalarField",name:"animated_image_caption",storageKey:null},H,hn,Rn],type:"MessageAnimatedImage",abstractKey:null},ul={alias:null,args:null,kind:"ScalarField",name:"url_skipshim",storageKey:null},cl={kind:"InlineFragment",selections:[Cn,bn,Xe,he,fe,{alias:null,args:null,kind:"ScalarField",name:"is_voicemail",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"audio_type",storageKey:null},Ye,ul],type:"MessageAudio",abstractKey:null},dl={alias:null,args:null,kind:"ScalarField",name:"content_type",storageKey:null},ml={kind:"InlineFragment",selections:[Cn,bn,Xe,ae,{alias:null,args:null,kind:"ScalarField",name:"mimetype",storageKey:null},dl,Pa,{alias:null,args:null,kind:"ScalarField",name:"message_file_fbid",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"preview_url",storageKey:null},Ye,ul,{alias:"preview",args:null,concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:re,storageKey:null}],type:"MessageFile",abstractKey:null},pl=[Ke,ll,sl,cl,Ln,ml],_l={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"blob_attachments",plural:!0,selections:pl,storageKey:null},fl={alias:null,args:null,kind:"ScalarField",name:"extensible_message_admin_text_type",storageKey:null},gl={alias:null,args:null,concreteType:"Application",kind:"LinkedField",name:"game",plural:!1,selections:q,storageKey:null},hl={kind:"InlineFragment",selections:[gl],type:"InstantGameUpdateExtensibleMessageAdminText",abstractKey:null},yl={alias:null,args:null,kind:"ScalarField",name:"platform_xmd_encoded",storageKey:null},Cl={alias:null,args:null,kind:"ScalarField",name:"message_unsendability_status",storageKey:null},bl={alias:"last_message",args:B,concreteType:"MessagesOfThreadConnection",kind:"LinkedField",name:"messages",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"nodes",plural:!0,selections:[W,{alias:null,args:null,concreteType:"MessagingParticipant",kind:"LinkedField",name:"message_sender",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"messaging_actor",plural:!1,selections:q,storageKey:null}],storageKey:null},U,V,{kind:"InlineFragment",selections:[rl,ol,_l],type:"UserMessage",abstractKey:null},{kind:"InlineFragment",selections:[fl,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"extensible_message_admin_text",plural:!1,selections:[hl],storageKey:null}],type:"GenericAdminTextMessage",abstractKey:null},yl,Cl],storageKey:null}],storageKey:"messages(last:1)"},vl={alias:null,args:null,concreteType:"ThreadConnectivityData",kind:"LinkedField",name:"thread_connectivity_data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"connectivity_status",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"first_sender_id",storageKey:null}],storageKey:null},Sl={alias:null,args:null,kind:"ScalarField",name:"job_status",storageKey:null},Rl={alias:null,args:null,kind:"ScalarField",name:"should_show_jobs_feature",storageKey:null},Ll={alias:null,args:null,kind:"ScalarField",name:"should_show_schdule_interview_dialog",storageKey:null},El={alias:null,args:null,concreteType:"JobApplicationsFromThreadConnection",kind:"LinkedField",name:"thread_associated_job_applications",plural:!1,selections:[{alias:null,args:null,concreteType:"JobApplication",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,{alias:null,args:null,concreteType:"JobOpening",kind:"LinkedField",name:"job_opening",plural:!1,selections:[Sl,{alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"employer",plural:!1,selections:[Rl,Ll],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},kl={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"thread_associated_page_admin",plural:!1,selections:Jn,storageKey:null},Il={alias:null,args:null,kind:"ScalarField",name:"unread_count",storageKey:null},Tl={condition:"is_work_teamwork_not_putting_muted_in_unreads",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"unread_mentions_count",storageKey:null}]},Dl={alias:null,args:null,kind:"ScalarField",name:"messages_count",storageKey:null},xl={alias:null,args:[{kind:"Literal",name:"size",value:60}],concreteType:"Image",kind:"LinkedField",name:"square_image",plural:!1,selections:re,storageKey:"square_image(size:60)"},$l={alias:null,args:null,kind:"ScalarField",name:"updated_time_precise",storageKey:null},Pl={alias:null,args:null,kind:"ScalarField",name:"mute_until",storageKey:null},Nl={alias:null,args:null,kind:"ScalarField",name:"is_pin_protected",storageKey:null},Ml={alias:null,args:null,kind:"ScalarField",name:"is_pinned",storageKey:null},wl={alias:null,args:null,kind:"ScalarField",name:"is_viewer_subscribed",storageKey:null},Al={alias:null,args:null,kind:"ScalarField",name:"is_other_recipient_page",storageKey:null},Fl={alias:null,args:null,kind:"ScalarField",name:"thread_queue_enabled",storageKey:null},Ol={alias:null,args:null,kind:"ScalarField",name:"folder",storageKey:null},Bl={alias:null,args:null,kind:"ScalarField",name:"has_viewer_archived",storageKey:null},Wl={alias:null,args:null,kind:"ScalarField",name:"is_page_follow_up",storageKey:null},ql={alias:null,args:null,kind:"ScalarField",name:"is_page_unresponded_thread",storageKey:null},Ul={alias:null,args:null,kind:"ScalarField",name:"cannot_reply_reason",storageKey:null},Vl={alias:null,args:null,kind:"ScalarField",name:"can_viewer_report",storageKey:null},Hl={alias:null,args:null,kind:"ScalarField",name:"composer_input_disabled",storageKey:null},Gl={alias:null,args:null,kind:"ScalarField",name:"ephemeral_ttl_mode",storageKey:null},zl={alias:null,args:null,kind:"ScalarField",name:"emoji",storageKey:null},jl={alias:null,args:null,kind:"ScalarField",name:"participant_id",storageKey:null},Kl={alias:null,args:null,kind:"ScalarField",name:"nickname",storageKey:null},Ql={alias:null,args:null,concreteType:"MessageThreadParticipantCustomization",kind:"LinkedField",name:"participant_customizations",plural:!0,selections:[jl,Kl],storageKey:null},Xl={alias:null,args:null,kind:"ScalarField",name:"outgoing_bubble_color",storageKey:null},Yl={alias:null,args:null,concreteType:"MessageThreadCustomization",kind:"LinkedField",name:"customization_info",plural:!1,selections:[zl,Ql,Xl],storageKey:null},Jl={alias:null,args:null,kind:"ScalarField",name:"fallback_color",storageKey:null},Zl={alias:null,args:null,kind:"ScalarField",name:"accessibility_label",storageKey:null},es={alias:null,args:null,kind:"ScalarField",name:"reverse_gradients_for_radial",storageKey:null},ts={alias:null,args:null,kind:"ScalarField",name:"gradient_colors",storageKey:null},ns={alias:null,args:null,kind:"ScalarField",name:"keyframe_asset_uri",storageKey:null},rs={alias:null,args:null,kind:"ScalarField",name:"reaction_name",storageKey:null},os={alias:null,args:null,kind:"ScalarField",name:"reaction_emoji",storageKey:null},as={alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"static_asset",plural:!1,selections:re,storageKey:null},is={alias:null,args:null,concreteType:"MessengerThreadTheme",kind:"LinkedField",name:"thread_theme",plural:!1,selections:[w,Jl,Zl,es,ts,{alias:null,args:null,concreteType:"MessengerReactionPack",kind:"LinkedField",name:"reaction_pack",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerReactionPackReactionAssetsConnection",kind:"LinkedField",name:"reaction_assets",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerReactionAsset",kind:"LinkedField",name:"nodes",plural:!0,selections:[ns,rs,os,as],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},ls={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"thread_admins",plural:!0,selections:q,storageKey:null},ss={alias:"approval_mode",args:null,kind:"ScalarField",name:"group_approval_mode",storageKey:null},us={alias:null,args:null,concreteType:"MessageThreadJoinableMode",kind:"LinkedField",name:"joinable_mode",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"mode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null}],storageKey:null},cs={alias:null,args:null,concreteType:"GroupApprovalQueueConnection",kind:"LinkedField",name:"group_approval_queue",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerGroupRequesterInfo",kind:"LinkedField",name:"nodes",plural:!0,selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"requester",plural:!1,selections:q,storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"inviter",plural:!1,selections:q,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"request_source",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"request_timestamp",storageKey:null}],storageKey:null}],storageKey:null},ds=[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"nodes",plural:!0,selections:q,storageKey:null}],ms={alias:null,args:null,concreteType:"ApprovalRequestsOfThreadConnection",kind:"LinkedField",name:"approval_requests",plural:!1,selections:ds,storageKey:null},ps={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"thread_queue_metadata",plural:!1,selections:[ms],storageKey:null},_s={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"lightweight_event_creator",plural:!1,selections:q,storageKey:null},fs={alias:null,args:null,kind:"ScalarField",name:"lightweight_event_type",storageKey:null},gs={alias:null,args:null,kind:"ScalarField",name:"location_name",storageKey:null},hs={alias:null,args:null,concreteType:"Location",kind:"LinkedField",name:"location_coordinates",plural:!1,selections:$n,storageKey:null},ys={alias:null,args:null,concreteType:"StreetAddress",kind:"LinkedField",name:"address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"full_address",storageKey:null}],storageKey:null},Cs={alias:null,args:null,kind:"ScalarField",name:"lightweight_event_status",storageKey:null},bs={alias:null,args:null,kind:"ScalarField",name:"note",storageKey:null},vs={alias:null,args:null,kind:"ScalarField",name:"repeat_mode",storageKey:null},Ss={alias:null,args:null,kind:"ScalarField",name:"message_id",storageKey:null},Rs={alias:null,args:null,kind:"ScalarField",name:"seconds_to_notify_before",storageKey:null},Ls={alias:null,args:null,kind:"ScalarField",name:"allows_rsvp",storageKey:null},Es={alias:null,args:null,concreteType:"Event",kind:"LinkedField",name:"related_event",plural:!1,selections:q,storageKey:null},ks={alias:null,args:null,concreteType:"MessengerEventReminderMembersConnection",kind:"LinkedField",name:"event_reminder_members",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerEventReminderMembersEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:q,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"guest_list_state",storageKey:null}],storageKey:null}],storageKey:null},Is={alias:null,args:ir,concreteType:"MessengerEventRemindersOfThreadConnection",kind:"LinkedField",name:"event_reminders",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerEventReminder",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,_s,aa,fs,gs,hs,{alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"location_page",plural:!1,selections:[ys],storageKey:null},Cs,bs,vs,oa,{alias:null,args:null,concreteType:"UserMessage",kind:"LinkedField",name:"trigger_message",plural:!1,selections:[Ss],storageKey:null},Rs,Ls,Es,ks],storageKey:null}],storageKey:"event_reminders(first:1)"},Ts={alias:null,args:null,concreteType:"MessageThread",kind:"LinkedField",name:"montage_thread",plural:!1,selections:q,storageKey:null},Ds=[U],xs={alias:"last_read_receipt",args:B,concreteType:"MessagingReadReceiptsOfThreadConnection",kind:"LinkedField",name:"read_receipts",plural:!1,selections:[{alias:null,args:null,concreteType:"MessagingReadReceipt",kind:"LinkedField",name:"nodes",plural:!0,selections:Ds,storageKey:null}],storageKey:"read_receipts(last:1)"},$s={alias:"is_flagged",args:[{kind:"Literal",name:"page_message_tag",value:"FLAG"}],kind:"ScalarField",name:"has_tag",storageKey:'has_tag(page_message_tag:"FLAG")'},Ps={alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"page",plural:!1,selections:q,storageKey:null},Ns={alias:null,args:null,kind:"ScalarField",name:"label_color",storageKey:null},Ms={alias:null,args:null,kind:"ScalarField",name:"data_silo",storageKey:null},ws={alias:null,args:null,kind:"ScalarField",name:"label_source",storageKey:null},As={alias:null,args:null,kind:"ScalarField",name:"is_ad_response_label",storageKey:null},Fs={alias:null,args:null,concreteType:"PageMessageThreadCustomThreadLabelsConnection",kind:"LinkedField",name:"custom_thread_labels",plural:!1,selections:[{alias:null,args:null,concreteType:"BusinessPresenceCustomLabel",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,O,Ns,Ms,ws,As],storageKey:null}],storageKey:null},Os=[w,O,bt],Bs={alias:null,args:null,concreteType:"PageMessageThreadCustomTagsConnection",kind:"LinkedField",name:"custom_thread_tags",plural:!1,selections:[{alias:null,args:null,concreteType:"PageCustomTag",kind:"LinkedField",name:"nodes",plural:!0,selections:Os,storageKey:null}],storageKey:null},Ws={alias:null,args:null,kind:"ScalarField",name:"is_ai_label",storageKey:null},qs={alias:null,args:null,kind:"ScalarField",name:"is_ai_handoff_label",storageKey:null},Us={alias:null,args:null,concreteType:"PageMessageThreadCorpThreadLabelsConnection",kind:"LinkedField",name:"corp_thread_labels",plural:!1,selections:[{alias:null,args:null,concreteType:"BusinessPresenceCorporationLabel",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,O,Ns,ws,Ms,Ws,qs,As],storageKey:null}],storageKey:null},Vs={alias:null,args:null,concreteType:"PageMessageThread",kind:"LinkedField",name:"related_page_thread",plural:!1,selections:[$s,Ps,Fs,Bs,Us],storageKey:null},Hs={alias:null,args:null,kind:"ScalarField",name:"call_state",storageKey:null},Gs={alias:null,args:null,kind:"ScalarField",name:"server_info_data",storageKey:null},zs={alias:null,args:null,concreteType:"RtcCallData",kind:"LinkedField",name:"rtc_call_data",plural:!1,selections:[Hs,Gs,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"initiator",plural:!1,selections:q,storageKey:null}],storageKey:null},js={alias:null,args:null,concreteType:"Location",kind:"LinkedField",name:"location",plural:!1,selections:[{alias:null,args:null,concreteType:"ReverseGeocodeData",kind:"LinkedField",name:"reverse_geocode",plural:!1,selections:[co,_o],storageKey:null}],storageKey:null},Ks={alias:null,args:null,kind:"ScalarField",name:"inventory_count",storageKey:null},Qs={alias:null,args:null,kind:"ScalarField",name:"delivery_types",storageKey:null},Xs={alias:null,args:null,kind:"ScalarField",name:"c2c_shipping_eligible",storageKey:null},Ys={alias:null,args:null,kind:"ScalarField",name:"is_pending",storageKey:null},Js={alias:null,args:null,kind:"ScalarField",name:"is_shipping_offered",storageKey:null},Zs={alias:null,args:null,kind:"ScalarField",name:"is_sold",storageKey:null},eu={alias:null,args:null,concreteType:"ProductItem",kind:"LinkedField",name:"product_item",plural:!1,selections:[w,{alias:null,args:null,kind:"ScalarField",name:"is_commerce_post_item",storageKey:null}],storageKey:null},tu={alias:null,args:[{kind:"Literal",name:"site",value:"www"}],kind:"ScalarField",name:"url",storageKey:'url(site:"www")'},nu={alias:null,args:null,concreteType:"MarketplaceRatingState",kind:"LinkedField",name:"rating_state",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_eligible_to_rate",storageKey:null}],storageKey:null},ru={alias:null,args:null,kind:"ScalarField",name:"is_eligible",storageKey:null},ou={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"MarketplaceC2CShippingSeller",kind:"LinkedField",name:"marketplace_c2c_shipping_seller",plural:!1,selections:[ru],storageKey:null}],type:"User",abstractKey:null},au={alias:null,args:null,kind:"ScalarField",name:"label_type",storageKey:null},iu={alias:null,args:null,concreteType:"MarketplaceThreadLabel",kind:"LinkedField",name:"seller_added_labels",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label_string",storageKey:null},au],storageKey:null},lu={alias:null,args:null,concreteType:"MarketplaceThreadData",kind:"LinkedField",name:"marketplace_thread_data",plural:!1,selections:[{alias:null,args:null,concreteType:"GroupCommerceProductItem",kind:"LinkedField",name:"for_sale_item",plural:!1,selections:[w,qn,Qo,Ko,js,Ks,Qs,Xs,Ys,Js,Zs,{alias:"primary_photo",args:null,concreteType:null,kind:"LinkedField",name:"primary_listing_photo",plural:!1,selections:wt,storageKey:null},eu,tu],storageKey:null},nu,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"buyer",plural:!1,selections:q,storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"seller",plural:!1,selections:[w,ou],storageKey:null},iu],storageKey:null},su={alias:"action_link",args:null,kind:"ScalarField",name:"url",storageKey:null},uu={alias:"room_type",args:null,kind:"ScalarField",name:"time_spent_room_type",storageKey:null},cu={alias:null,args:null,kind:"ScalarField",name:"privacy_mode",storageKey:null},du={alias:null,args:null,kind:"ScalarField",name:"approval_mode_toggleable",storageKey:null},mu={alias:null,args:null,concreteType:"MentorshipProgram",kind:"LinkedField",name:"mentorship_program",plural:!1,selections:vr,storageKey:null},pu=[Li],_u={alias:null,args:null,concreteType:"GroupSavesConnection",kind:"LinkedField",name:"group_saves",plural:!1,selections:pu,storageKey:null},fu={alias:null,args:[{kind:"Literal",name:"external_ref",value:"messenger"}],kind:"ScalarField",name:"verse_group_link",storageKey:'verse_group_link(external_ref:"messenger")'},gu={kind:"InlineFragment",selections:[O,Jo],type:"Page",abstractKey:null},hu={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"associated_object",plural:!1,selections:[{kind:"InlineFragment",selections:[su,w,O,nt,Oi,uu,cu,du,mu,_u,fu],type:"Group",abstractKey:null},{kind:"InlineFragment",selections:[su,w,O,nt,uu,cu,du,Nr,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"event_place",plural:!1,selections:[gu],storageKey:null}],type:"Event",abstractKey:null}],storageKey:null},yu={alias:null,args:null,kind:"ScalarField",name:"reactions_mute_mode",storageKey:null},Cu={alias:null,args:null,kind:"ScalarField",name:"mentions_mute_mode",storageKey:null},bu={alias:null,args:null,kind:"ScalarField",name:"customization_enabled",storageKey:null},vu={alias:null,args:null,kind:"ScalarField",name:"thread_type",storageKey:null},Su={alias:null,args:null,kind:"ScalarField",name:"group_thread_subtype",storageKey:null},Ru={alias:null,args:null,kind:"ScalarField",name:"participant_add_mode_as_string",storageKey:null},Lu={alias:null,args:null,kind:"ScalarField",name:"is_canonical_neo_user",storageKey:null},Eu={alias:null,args:null,concreteType:"MessageThreadParticipantEventStatusInfo",kind:"LinkedField",name:"participants_event_status",plural:!0,selections:[jl,{alias:null,args:null,kind:"ScalarField",name:"event_status",storageKey:null}],storageKey:null},ku={alias:null,args:null,kind:"ScalarField",name:"comm_status",storageKey:null},Iu={alias:null,args:null,kind:"ScalarField",name:"comm_source_id",storageKey:null},Tu={alias:null,args:null,kind:"ScalarField",name:"is_priority",storageKey:null},Du={alias:null,args:null,kind:"ScalarField",name:"biz_inbox_tags",storageKey:null},xu={alias:null,args:null,kind:"ScalarField",name:"priority_score",storageKey:null},$u={alias:null,args:null,kind:"ScalarField",name:"trigger_id",storageKey:null},Pu=[{alias:null,args:null,kind:"ScalarField",name:"suggestion_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"suggestion_content",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"triggered_timestamp",storageKey:null},$u],Nu={alias:null,args:null,concreteType:"SuggestedReplyData",kind:"LinkedField",name:"biz_inbox_suggested_reply",plural:!1,selections:Pu,storageKey:null},Mu={alias:null,args:null,kind:"ScalarField",name:"is_thread_currently_handled_by_ai_agent",storageKey:null},wu=[w,O,{alias:null,args:[{kind:"Literal",name:"height",value:20},{kind:"Literal",name:"width",value:20}],concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:re,storageKey:"profile_picture(height:20,width:20)"}],Au={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"admin",plural:!1,selections:wu,storageKey:null},Fu={alias:null,args:null,kind:"ScalarField",name:"comm_icon_type",storageKey:null},Ou={alias:null,args:null,concreteType:"PageCommItem",kind:"LinkedField",name:"page_comm_item",plural:!1,selections:[w,ku,Iu,Tu,Du,xu,Nu,Mu,{alias:null,args:null,concreteType:"PageCommItemToPageCommItemOwnersConnection",kind:"LinkedField",name:"comm_item_owners",plural:!1,selections:[{alias:null,args:null,concreteType:"PageCommItemOwner",kind:"LinkedField",name:"nodes",plural:!0,selections:[Au],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"subtitle",plural:!1,selections:[{alias:null,args:null,concreteType:"ImageAtRange",kind:"LinkedField",name:"image_ranges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"entity_with_image",plural:!1,selections:wt,storageKey:null},lt,ni],storageKey:null},li,G],storageKey:null},Fu],storageKey:null},Bu={alias:null,args:null,kind:"ScalarField",name:"admin_model_status_string",storageKey:null},Wu={alias:null,args:null,kind:"ScalarField",name:"groups_sync_status_string",storageKey:null},qu={alias:null,args:null,concreteType:"GroupsSyncMetadata",kind:"LinkedField",name:"groups_sync_metadata",plural:!1,selections:[{alias:null,args:null,concreteType:"Group",kind:"LinkedField",name:"fb_group",plural:!1,selections:hi,storageKey:null}],storageKey:null},Uu={alias:null,args:null,kind:"ScalarField",name:"pinning_time",storageKey:null},Vu={alias:null,args:null,concreteType:"OmniMActionLite",kind:"LinkedField",name:"m_suggestions",plural:!0,selections:[w,ee,K,{alias:null,args:null,concreteType:"OmniMActionDataLite",kind:"LinkedField",name:"data",plural:!1,selections:[{alias:null,args:null,concreteType:"OmniMActionReminderDataLite",kind:"LinkedField",name:"reminder",plural:!1,selections:[Ki,{alias:null,args:null,kind:"ScalarField",name:"topic",storageKey:null}],storageKey:null}],storageKey:null},Tn],storageKey:null},Hu={alias:null,args:null,kind:"ScalarField",name:"offline_threading_id",storageKey:null},Gu={alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},zu={alias:null,args:null,concreteType:"MessagingParticipant",kind:"LinkedField",name:"message_sender",plural:!1,selections:[w,Gu],storageKey:null},ju={alias:null,args:null,kind:"ScalarField",name:"ttl",storageKey:null},Ku={alias:null,args:null,kind:"ScalarField",name:"unread",storageKey:null},Qu={alias:null,args:null,kind:"ScalarField",name:"is_sponsored",storageKey:null},Xu={alias:null,args:null,kind:"ScalarField",name:"ad_client_token",storageKey:null},Yu={alias:null,args:null,concreteType:"MessageCustomization",kind:"LinkedField",name:"customizations",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"customization_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"customization_value",storageKey:null}],storageKey:null},Ju={alias:null,args:null,kind:"ScalarField",name:"tags_list",storageKey:null},Zu={alias:null,args:null,concreteType:"MessageSourceData",kind:"LinkedField",name:"message_source_data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"message_source",storageKey:null}],storageKey:null},ec={alias:null,args:null,concreteType:"MontageReplyData",kind:"LinkedField",name:"montage_reply_data",plural:!1,selections:[Ss,{alias:null,args:null,kind:"ScalarField",name:"reply_action",storageKey:null},W],storageKey:null},tc={alias:null,args:null,kind:"ScalarField",name:"reaction",storageKey:null},nc={alias:null,args:null,concreteType:"MessageReaction",kind:"LinkedField",name:"message_reactions",plural:!0,selections:[tc,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"user",plural:!1,selections:q,storageKey:null}],storageKey:null},rc={alias:null,args:null,kind:"ScalarField",name:"unsent_timestamp_precise",storageKey:null},oc={alias:null,args:null,concreteType:"MessagingParticipant",kind:"LinkedField",name:"unsender",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"messaging_actor",plural:!1,selections:[w,O,gi],storageKey:null}],storageKey:null},ac={alias:null,args:null,kind:"ScalarField",name:"verse_group_role_xmd",storageKey:null},ic={alias:null,args:null,kind:"ScalarField",name:"secondary_language_body",storageKey:null},lc={kind:"InlineFragment",selections:q,type:"Profile",abstractKey:"__isProfile"},sc={kind:"InlineFragment",selections:q,type:"MessengerViewerGroupThread",abstractKey:null},uc={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"MessageThreadKey",kind:"LinkedField",name:"thread_key",plural:!1,selections:[A],storageKey:null}],type:"MessageThread",abstractKey:null},cc={alias:null,args:null,kind:"ScalarField",name:"message_profile_range_type",storageKey:null},dc={alias:null,args:null,concreteType:"MetaAtRange",kind:"LinkedField",name:"meta_ranges",plural:!0,selections:[lt,ni,K,ai],storageKey:null},mc={alias:null,args:null,concreteType:"MessagePageAdminSender",kind:"LinkedField",name:"page_admin_sender",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"admin_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sender_type",storageKey:null},O,au,Ue,{alias:null,args:null,kind:"ScalarField",name:"profile_uri",storageKey:null}],storageKey:null},pc={kind:"InlineFragment",selections:[ic,{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"message",plural:!1,selections:[G,{alias:null,args:null,concreteType:"EntityAtRange",kind:"LinkedField",name:"ranges",plural:!0,selections:[lt,ni,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"entity",plural:!1,selections:[Ke,lc,sc,uc],storageKey:null},cc],storageKey:null}],storageKey:null},dc,rl,ol,_l,mc],type:"UserMessage",abstractKey:null},_c={alias:null,args:null,kind:"ScalarField",name:"answered",storageKey:null},fc={kind:"InlineFragment",selections:[_c,W],type:"VoiceCallMessage",abstractKey:null},gc=[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:pl,storageKey:null}],hc={kind:"InlineFragment",selections:[_c,W,{alias:null,args:null,concreteType:"VideoCallMessageToCaptureAttachmentsConnection",kind:"LinkedField",name:"call_capture_attachments",plural:!1,selections:[Li,{alias:null,args:null,concreteType:"VideoCallMessageToCaptureAttachmentsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:gc,storageKey:null}],storageKey:null}],type:"VideoCallMessage",abstractKey:null},yc={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"thread_name",storageKey:null},W],type:"ThreadNameMessage",abstractKey:null},Cc={alias:"preview",args:Ba,concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:re,storageKey:"image(height:280,width:280)"},bc={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"MessageImage",kind:"LinkedField",name:"image_with_metadata",plural:!1,selections:[Cc,H,Rn],storageKey:null},W],type:"ThreadImageMessage",abstractKey:null},vc={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"MessagingParticipant",kind:"LinkedField",name:"participants_added",plural:!0,selections:q,storageKey:null},W],type:"ParticipantsAddedMessage",abstractKey:null},Sc={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"MessagingParticipant",kind:"LinkedField",name:"participants_removed",plural:!0,selections:q,storageKey:null},W],type:"ParticipantLeftMessage",abstractKey:null},Rc={alias:null,args:null,kind:"ScalarField",name:"viewer_has_voted",storageKey:null},Lc={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"event_type",storageKey:null},{alias:"total_count",args:null,kind:"ScalarField",name:"option_count",storageKey:null},{alias:null,args:null,concreteType:"Question",kind:"LinkedField",name:"question",plural:!1,selections:[w,G,Rc,{alias:null,args:[{kind:"Literal",name:"orderby",value:"creation_time"}],concreteType:"QuestionOptionsConnection",kind:"LinkedField",name:"options",plural:!1,selections:[{alias:null,args:null,concreteType:"QuestionOption",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,G,Rc,{alias:null,args:null,concreteType:"QuestionOptionVotersConnection",kind:"LinkedField",name:"voters",plural:!1,selections:ds,storageKey:null}],storageKey:null}],storageKey:'options(orderby:"creation_time")'}],storageKey:null}],type:"GroupPollExtensibleMessageAdminText",abstractKey:null},Ec={alias:null,args:null,kind:"ScalarField",name:"display_name",storageKey:null},kc={alias:null,args:null,concreteType:"MessengerEventReminder",kind:"LinkedField",name:"event_reminder",plural:!1,selections:[w,aa,oa,{alias:null,args:null,kind:"ScalarField",name:"end_time",storageKey:null},gs,fs,Ls,Rs,_s,{alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"location_page",plural:!1,selections:q,storageKey:null},hs,{alias:null,args:null,concreteType:"TimezoneInfo",kind:"LinkedField",name:"timezone_id",plural:!1,selections:[Ec,ca,{alias:null,args:null,kind:"ScalarField",name:"timezone_id",storageKey:null}],storageKey:null},ks],storageKey:null},Ic=[kc],Tc={kind:"InlineFragment",selections:Ic,type:"LightweightEventCreateExtensibleMessageAdminText",abstractKey:null},Dc={kind:"InlineFragment",selections:Ic,type:"LightweightEventDeleteExtensibleMessageAdminText",abstractKey:null},xc={kind:"InlineFragment",selections:Ic,type:"LightweightEventNotifyBeforeEventExtensibleMessageAdminText",abstractKey:null},$c={kind:"InlineFragment",selections:Ic,type:"LightweightEventNotifyExtensibleMessageAdminText",abstractKey:null},Pc={kind:"InlineFragment",selections:Ic,type:"LightweightEventUpdateExtensibleMessageAdminText",abstractKey:null},Nc={kind:"InlineFragment",selections:Ic,type:"LightweightEventUpdateLocationExtensibleMessageAdminText",abstractKey:null},Mc={kind:"InlineFragment",selections:Ic,type:"LightweightEventUpdateTimeExtensibleMessageAdminText",abstractKey:null},wc={kind:"InlineFragment",selections:Ic,type:"LightweightEventUpdateTitleExtensibleMessageAdminText",abstractKey:null},Ac={alias:null,args:null,kind:"ScalarField",name:"guest_id",storageKey:null},Fc={kind:"InlineFragment",selections:[Ac,{alias:null,args:null,kind:"ScalarField",name:"guest_status",storageKey:null},kc],type:"LightweightEventRSVPExtensibleMessageAdminText",abstractKey:null},Oc={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"theme_color",storageKey:null}],type:"ThemeColorExtensibleMessageAdminText",abstractKey:null},Bc={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"thread_icon",storageKey:null}],type:"ThreadIconExtensibleMessageAdminText",abstractKey:null},Wc={kind:"InlineFragment",selections:[Kl,{alias:"participant_id",args:null,kind:"ScalarField",name:"target_id",storageKey:null}],type:"ThreadNicknameExtensibleMessageAdminText",abstractKey:null},qc={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"accepter_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"requester_id",storageKey:null}],type:"AcceptPendingThreadExtensibleMessageAdminText",abstractKey:null},Uc={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"contact_added_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"contact_adder_id",storageKey:null}],type:"AddContactExtensibleMessageAdminText",abstractKey:null},Vc={alias:null,args:null,kind:"ScalarField",name:"event",storageKey:null},Hc={kind:"InlineFragment",selections:[Vc,{alias:null,args:null,kind:"ScalarField",name:"is_video_call",storageKey:null},Gs],type:"RtcCallLogExtensibleMessageAdminText",abstractKey:null},Gc={alias:null,args:null,kind:"ScalarField",name:"update_type",storageKey:null},zc={alias:null,args:null,kind:"ScalarField",name:"collapsed_text",storageKey:null},jc={alias:null,args:null,kind:"ScalarField",name:"expanded_text",storageKey:null},Kc={alias:null,args:null,kind:"ScalarField",name:"cta_url",storageKey:null},Qc={alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null},Xc={alias:null,args:null,kind:"ScalarField",name:"leaderboard_json",storageKey:null},Yc={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"game_type",storageKey:null}],type:"GameScoreExtensibleMessageAdminText",abstractKey:null},Jc={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"parties_user_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"parties_invite_type",storageKey:null}],type:"PartiesInviteExtensibleMessageAdminText",abstractKey:null},Zc={alias:null,args:null,kind:"ScalarField",name:"icebreaker_type",storageKey:null},ed={alias:null,args:null,kind:"ScalarField",name:"icebreaker_title",storageKey:null},td={alias:null,args:null,kind:"ScalarField",name:"icebreaker_subtitle",storageKey:null},nd={alias:null,args:null,kind:"ScalarField",name:"vote_buttons_with_icons",storageKey:null},rd={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"friend_request_recipient",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"friend_request_sender",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"friend_request_subtype",storageKey:null},Zc,ed,td,nd],type:"ConfirmFriendRequestExtensibleMessageAdminText",abstractKey:null},od={alias:null,args:null,kind:"ScalarField",name:"sender_id",storageKey:null},ad={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"bump_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"recipient_id",storageKey:null},od,Q,Ut,{alias:null,args:null,kind:"ScalarField",name:"icon_uri",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"image_uri",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"facepile_ids",storageKey:null},Xi,{alias:null,args:null,kind:"ScalarField",name:"cta_uri",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"admin_message_string",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"banner_uri",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_two_way",storageKey:null}],type:"MessengerGrowthGenericExtensibleMessageAdminText",abstractKey:null},id={alias:null,args:null,kind:"ScalarField",name:"primary_text",storageKey:null},ld={kind:"InlineFragment",selections:[id,{alias:null,args:null,kind:"ScalarField",name:"ios_uri",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"activity_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_redesign",storageKey:null}],type:"BizInboxDetectedOutcomesActivityAdminTextExtensibleMessageAdminText",abstractKey:null},sd={alias:null,args:null,kind:"ScalarField",name:"cta_text",storageKey:null},ud={kind:"InlineFragment",selections:[id,sd,Kc,{alias:null,args:null,kind:"ScalarField",name:"async_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"www_is_async_url",storageKey:null}],type:"LinkCTAExtensibleMessageAdminText",abstractKey:null},cd={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"referer_uri",storageKey:null}],type:"MessengerLiveChatPluginURLUpdateAdminText",abstractKey:null},dd={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"fb_user_name",storageKey:null}],type:"MessengerLiveChatPluginFBUserStartChatAdminText",abstractKey:null},md={kind:"InlineFragment",selections:[Tn],type:"MessengerLiveChatPluginGuestUserStartChatAdminText",abstractKey:null},pd={kind:"InlineFragment",selections:[sd,Kc,Ss,{alias:null,args:null,kind:"ScalarField",name:"recipient_is_the_sender",storageKey:null}],type:"WorkChatReminderLinkCTAExtensibleMessageAdminText",abstractKey:null},_d={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"post_uri",storageKey:null}],type:"PostSharedFromGroupExtensibleMessageAdminText",abstractKey:null},fd={alias:null,args:null,kind:"ScalarField",name:"ad_url",storageKey:null},gd={kind:"InlineFragment",selections:[fd],type:"MessengerAdContextAdminText",abstractKey:null},hd={kind:"InlineFragment",selections:[Xu,wa,{alias:null,args:null,kind:"ScalarField",name:"ad_preferences_link",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ad_properties",storageKey:null}],type:"AdExtensibleMessageAdminText",abstractKey:null},yd={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"page_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"start_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"user_name",storageKey:null}],type:"AppointmentReminderExtensibleMessageAdminText",abstractKey:null},Cd=[Ue],bd={kind:"InlineFragment",selections:Cd,type:"GraphQLServicesAppointmentsOptOutExtensibleMessageAdminText",abstractKey:null},vd={kind:"InlineFragment",selections:Cd,type:"ServicesLeadGenSurveyExtensibleMessageAdminText",abstractKey:null},Sd={kind:"InlineFragment",selections:Cd,type:"ServicesLeadGenSurveyEditExtensibleMessageAdminText",abstractKey:null},Rd={alias:null,args:null,kind:"ScalarField",name:"caller_id",storageKey:null},Ld={alias:null,args:null,kind:"ScalarField",name:"callee_id",storageKey:null},Ed={alias:null,args:null,kind:"ScalarField",name:"conference_name",storageKey:null},kd={alias:null,args:null,kind:"ScalarField",name:"server_info",storageKey:null},Id={alias:null,args:null,kind:"ScalarField",name:"video",storageKey:null},Td={alias:null,args:null,kind:"ScalarField",name:"call_duration",storageKey:null},Dd={alias:null,args:null,kind:"ScalarField",name:"rating",storageKey:null},xd={kind:"InlineFragment",selections:[Zc,ed,td,{alias:null,args:null,kind:"ScalarField",name:"votes_cast",storageKey:null},nd],type:"MessengerIcebreakerVoteCastExtensibleMessageAdminText",abstractKey:null},$d={alias:null,args:null,kind:"ScalarField",name:"user_id",storageKey:null},Pd={alias:null,args:null,kind:"ScalarField",name:"currency_code",storageKey:null},Nd=[Ue,$d,{alias:null,args:null,kind:"ScalarField",name:"receipt_photo_id",storageKey:null},Pd,{alias:null,args:null,kind:"ScalarField",name:"detection_type",storageKey:null}],Md={kind:"InlineFragment",selections:Nd,type:"PagesMarkAsPaidExtensibleMessageAdminText",abstractKey:null},wd={kind:"InlineFragment",selections:Nd,type:"PagesMarkAsPaidNewExtensibleMessageAdminText",abstractKey:null},Ad={alias:null,args:null,kind:"ScalarField",name:"interaction_id",storageKey:null},Fd={kind:"InlineFragment",selections:[Ue,$d,{alias:null,args:null,kind:"ScalarField",name:"interaction_type",storageKey:null},Ad,{alias:null,args:null,kind:"ScalarField",name:"should_show_cta",storageKey:null}],type:"PageThreadActionSystemAddDetailsXMAT",abstractKey:null},Od={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"bot_page",plural:!1,selections:q,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"show_landing_page",storageKey:null}],type:"WorkBotInstalledExtensibleMessageAdminText",abstractKey:null},Bd={kind:"InlineFragment",selections:[fd,{alias:null,args:null,kind:"ScalarField",name:"should_show_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"results_url",storageKey:null}],type:"AdReplyMessageAdminText",abstractKey:null},Wd={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"new_magic_word_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"magic_word",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"emoji_effect",storageKey:null}],type:"MagicWordsExtensibleMessageAdminText",abstractKey:null},qd={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"token_ent_id_string",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"user_action_type",storageKey:null}],type:"NotificationMessagesAdminText",abstractKey:null},Ud={alias:null,args:null,kind:"ScalarField",name:"admin_assigner_name",storageKey:null},Vd={kind:"InlineFragment",selections:[Ud,{alias:null,args:null,kind:"ScalarField",name:"assigned_admin_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"assign_conversation",storageKey:null}],type:"BizInboxAssignAdminAdminText",abstractKey:null},Hd={kind:"InlineFragment",selections:[Ud,{alias:null,args:null,kind:"ScalarField",name:"note_input",storageKey:null}],type:"BizInboxAdminAssignmentNoteAdminText",abstractKey:null},Gd={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"email_thread_id",storageKey:null}],type:"BizInboxOmnichannelEmailSentAdminText",abstractKey:null},zd={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"user_subscription_management_action_type",storageKey:null}],type:"InstantGameBotMessageSubscriptionManagementAdminText",abstractKey:null},jd={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"user_mute_management_action_type",storageKey:null}],type:"InstantGameCustomUpdateMuteManagementAdminText",abstractKey:null},Kd={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"extensible_message_admin_text",plural:!1,selections:[Ke,Lc,Tc,Dc,xc,$c,Pc,Nc,Mc,wc,Fc,Oc,Bc,Wc,qc,Uc,Hc,{kind:"InlineFragment",selections:[gl,Gc,zc,jc,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"instant_game_update_data",plural:!1,selections:[{kind:"InlineFragment",selections:[Kc,Xi,xi,Qc],type:"InstantGameXMATCustomMessageClientData",abstractKey:null}],storageKey:null},Xc],type:"InstantGameUpdateExtensibleMessageAdminText",abstractKey:null},Yc,Jc,rd,ad,ld,ud,cd,dd,md,pd,_d,gd,hd,yd,bd,vd,Sd,{kind:"InlineFragment",selections:[Rd,Ld,Ed,Vc,kd,Id,Td,Dd,{alias:null,args:null,concreteType:"MessengerCallLogExtensibleMessageAdminTextCallCaptureAttachmentsConnection",kind:"LinkedField",name:"call_capture_attachments",plural:!1,selections:[Li,{alias:null,args:null,concreteType:"MessengerCallLogExtensibleMessageAdminTextCallCaptureAttachmentsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:gc,storageKey:null}],storageKey:null}],type:"MessengerCallLogExtensibleMessageAdminText",abstractKey:null},xd,Md,wd,Fd,Od,Bd,Wd,qd,Vd,Hd,Gd,zd,jd],storageKey:null},fl,W],type:"GenericAdminTextMessage",abstractKey:null},Qd=[{alias:null,args:null,kind:"ScalarField",name:"transfer_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"message_type",storageKey:null},{alias:null,args:null,concreteType:"CurrencyQuantity",kind:"LinkedField",name:"amount",plural:!1,selections:Ot,storageKey:null},{alias:null,args:null,concreteType:"MessagingParticipant",kind:"LinkedField",name:"p2p_sender",plural:!1,selections:q,storageKey:null},{alias:null,args:null,concreteType:"MessagingParticipant",kind:"LinkedField",name:"p2p_receiver",plural:!1,selections:q,storageKey:null},W],Xd={kind:"InlineFragment",selections:Qd,type:"P2PPaymentRequestMessage",abstractKey:null},Yd={kind:"InlineFragment",selections:Qd,type:"P2PPaymentMessage",abstractKey:null},Jd=[Vu,Ke,Ss,Hu,zu,ju,U,Ku,Qu,wa,Xu,V,Yu,Ju,yl,Zu,ec,nc,rc,oc,ac,Cl,pc,fc,hc,yc,bc,vc,Sc,Kd,Xd,Yd,{alias:null,args:null,concreteType:"RepliedToMessage",kind:"LinkedField",name:"replied_to_message",plural:!1,selections:[mr,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"message",plural:!1,selections:[Vu,Ke,Ss,Hu,zu,ju,U,Ku,Qu,wa,Xu,V,Yu,Ju,yl,Zu,ec,nc,rc,oc,ac,Cl,pc,fc,hc,yc,bc,vc,Sc,Kd,Xd,Yd],storageKey:null}],storageKey:null}],Zd={alias:null,args:null,concreteType:"PinnedMessageData",kind:"LinkedField",name:"pinned_messages",plural:!0,selections:[Ss,Uu,{condition:"threadlistViewFieldsOnly",kind:"Condition",passingValue:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"message",plural:!1,selections:Jd,storageKey:null}]}],storageKey:null},em={alias:null,args:null,kind:"ScalarField",name:"is_default_child_group",storageKey:null},tm={alias:null,args:null,kind:"ScalarField",name:"emoji_codepoints",storageKey:null},nm={alias:null,args:null,concreteType:"GroupsSyncMetadata",kind:"LinkedField",name:"work_groups_sync_metadata",plural:!1,selections:[{alias:null,args:null,concreteType:"Group",kind:"LinkedField",name:"fb_group",plural:!1,selections:[ae,w,O,wi,em,nt,_u,{alias:null,args:null,concreteType:"MultiBackgroundIcon",kind:"LinkedField",name:"group_icon",plural:!1,selections:[tm],storageKey:null}],storageKey:null}],storageKey:null},rm={condition:"threadlistViewFieldsOnly",kind:"Condition",passingValue:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"saved_messages",plural:!0,selections:Jd,storageKey:null}]},om={alias:null,args:null,kind:"ScalarField",name:"joinable_link",storageKey:null},am={alias:null,args:null,kind:"ScalarField",name:"is_fuss_red_page",storageKey:null},im={alias:null,args:null,concreteType:"Group",kind:"LinkedField",name:"program_group",plural:!1,selections:[w,{alias:null,args:[{kind:"Literal",name:"height",value:24},{kind:"Literal",name:"width",value:24}],concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:re,storageKey:"profile_picture(height:24,width:24)"}],storageKey:null},lm={alias:null,args:null,concreteType:"Group",kind:"LinkedField",name:"mentorship_group",plural:!1,selections:vr,storageKey:null},sm={alias:null,args:null,kind:"ScalarField",name:"banner_title",storageKey:null},um={alias:null,args:null,kind:"ScalarField",name:"banner_subtitle",storageKey:null},cm={alias:null,args:ir,concreteType:"MessengerMentorshipProgramOfThreadConnection",kind:"LinkedField",name:"linked_mentorship_programs",plural:!1,selections:[{alias:null,args:null,concreteType:"MentorshipProgram",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,im,lm,{alias:null,args:ir,concreteType:"MentorshipProgramToMentorshipMessengerCurriculumStepOrderByStepCountConnection",kind:"LinkedField",name:"messenger_curriculum_steps",plural:!1,selections:[{alias:null,args:null,concreteType:"MentorshipMessengerCurriculumStep",kind:"LinkedField",name:"nodes",plural:!0,selections:[sm,um],storageKey:null}],storageKey:"messenger_curriculum_steps(first:1)"}],storageKey:null}],storageKey:"linked_mentorship_programs(first:1)"},dm={alias:null,args:null,kind:"ScalarField",name:"thread_unsendability_status",storageKey:null},mm={alias:null,args:null,kind:"ScalarField",name:"thread_pin_timestamp",storageKey:null},pm={alias:null,args:null,kind:"ScalarField",name:"is_business_page_active",storageKey:null},_m={alias:null,args:null,concreteType:"ConversionDetectionData",kind:"LinkedField",name:"conversion_detection_data",plural:!1,selections:[ru,{alias:null,args:null,kind:"ScalarField",name:"conversion_type",storageKey:null},Pd,{alias:null,args:null,kind:"ScalarField",name:"currency_amount",storageKey:null},{alias:"timestamp",args:null,kind:"ScalarField",name:"timestamp_graphql_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"page_reply",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"icebreaker_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"icebreaker_message",storageKey:null},$u,{alias:null,args:null,kind:"ScalarField",name:"shipping_provider",storageKey:null},la,{alias:null,args:null,kind:"ScalarField",name:"ctx_ad_info",storageKey:null}],storageKey:null},fm={alias:null,args:null,concreteType:"SuggestedReplyData",kind:"LinkedField",name:"suggested_reply_data",plural:!1,selections:Pu,storageKey:null},gm={alias:null,args:null,kind:"ScalarField",name:"admin_type",storageKey:null},hm={alias:null,args:null,kind:"ScalarField",name:"gender",storageKey:null},ym={alias:"big_image_src",args:[{kind:"Literal",name:"height",value:60},{kind:"Literal",name:"width",value:60}],concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:re,storageKey:"profile_picture(height:60,width:60)"},Cm={alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},bm={alias:null,args:null,kind:"ScalarField",name:"is_viewer_friend",storageKey:null},vm={alias:null,args:null,kind:"ScalarField",name:"is_messenger_user",storageKey:null},Sm={alias:null,args:null,kind:"ScalarField",name:"is_message_blocked_by_viewer",storageKey:null},Rm={alias:null,args:null,kind:"ScalarField",name:"is_viewer_coworker",storageKey:null},Lm={alias:null,args:null,kind:"ScalarField",name:"is_employee",storageKey:null},Em={alias:null,args:null,kind:"ScalarField",name:"is_aloha_proxy_confirmed",storageKey:null},km={alias:null,args:null,kind:"ScalarField",name:"message_capabilities2_str",storageKey:null},Im={alias:null,args:null,kind:"ScalarField",name:"messenger_account_status_category",storageKey:null},Tm={alias:null,args:null,concreteType:"WorkUserInfo",kind:"LinkedField",name:"work_info",plural:!1,selections:[{alias:null,args:null,concreteType:"Group",kind:"LinkedField",name:"work_community",plural:!1,selections:Ir,storageKey:null},Pi],storageKey:null},Dm={kind:"InlineFragment",selections:[hm,ae,ym,It,bm,vm,Sm,{alias:null,args:null,kind:"ScalarField",name:"is_viewer_managing_parent",storageKey:null}],type:"NeoApprovedUser",abstractKey:null},xm={kind:"InlineFragment",selections:[ae,ym,Cm,{alias:null,args:null,kind:"ScalarField",name:"accepts_messenger_user_feedback",storageKey:null},vm,{alias:null,args:null,kind:"ScalarField",name:"is_messenger_platform_bot",storageKey:null},Sm,{alias:null,args:null,kind:"ScalarField",name:"is_viewer_subscribed_to_message_updates",storageKey:null},{alias:null,args:null,concreteType:"InstantGameChannelInfo",kind:"LinkedField",name:"instant_game_channel",plural:!1,selections:[{alias:null,args:null,concreteType:"Application",kind:"LinkedField",name:"application",plural:!1,selections:q,storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"verification_status",storageKey:null}],type:"Page",abstractKey:null},$m=[ae,ym,Sm],Pm={kind:"InlineFragment",selections:$m,type:"SmsMessagingParticipant",abstractKey:null},Nm={kind:"InlineFragment",selections:[ym,Sm],type:"InstagramMessagingUser",abstractKey:null},Mm=[ym],wm={kind:"InlineFragment",selections:Mm,type:"LiveChatOnlyPerson",abstractKey:null},Am={kind:"InlineFragment",selections:$m,type:"UnavailableMessagingActor",abstractKey:null},Fm={kind:"InlineFragment",selections:Mm,type:"UnifiedMessagingInstagramUser",abstractKey:null},Om={alias:null,args:null,kind:"ScalarField",name:"is_blocked_by_viewer",storageKey:null},Bm=[ae,ym,Cm],Wm={kind:"InlineFragment",selections:Bm,type:"Group",abstractKey:null},qm={kind:"InlineFragment",selections:Bm,type:"Event",abstractKey:null},Um={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"WorkForeignEntityInfo",kind:"LinkedField",name:"work_foreign_entity_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"detail",storageKey:null},ee,K],storageKey:null}],type:"WorkForeignEntity",abstractKey:"__isWorkForeignEntity"},Vm=[ae,ym,It,Sm],Hm={kind:"InlineFragment",selections:Vm,type:"XFBWorkroomsBaseUser",abstractKey:"__isXFBWorkroomsBaseUser"},Gm={kind:"InlineFragment",selections:Vm,type:"XFBWorkroomsSystemUser",abstractKey:null},zm={kind:"InlineFragment",selections:Mm,type:"MessengerCallGuestUser",abstractKey:null},jm={kind:"InlineFragment",selections:Mm,type:"WorkVCEndpointUser",abstractKey:null},Km={kind:"InlineFragment",selections:Mm,type:"WECMailboxAccount",abstractKey:null},Qm={kind:"InlineFragment",selections:Mm,type:"WECCustomer",abstractKey:null},Xm={alias:null,args:null,kind:"ScalarField",name:"wec_group_creation_time",storageKey:null},Ym={alias:null,args:null,kind:"ScalarField",name:"wec_group_invite_link",storageKey:null},Jm={alias:null,args:null,concreteType:"MessagingParticipant",kind:"LinkedField",name:"nodes",plural:!0,selections:Sr,storageKey:null},Zm={alias:null,args:null,concreteType:"AllMessagingParticipantsOfThreadConnection",kind:"LinkedField",name:"all_participants",plural:!1,selections:[{alias:null,args:null,concreteType:"AllMessagingParticipantsOfThreadEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[gm,{alias:null,args:null,concreteType:"MessagingParticipant",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"messaging_actor",plural:!1,selections:[w,Ke,O,{kind:"InlineFragment",selections:[hm,ae,ym,It,Cm,bm,vm,Sm,Rm,Lm,Em,km,Im,Tm],type:"User",abstractKey:null},Dm,xm,Pm,Nm,wm,Am,Fm,{kind:"InlineFragment",selections:[ae,ym,Cm,Om,Sm,Tm],type:"ReducedMessagingActor",abstractKey:null},Wm,qm,Um,Hm,Gm,zm,jm,Km,Qm,{kind:"InlineFragment",selections:[ym,Xm,Ym,{alias:null,args:null,concreteType:"WECGroupParticipantsConnection",kind:"LinkedField",name:"wec_group_participants",plural:!1,selections:[Jm,Li],storageKey:null},{alias:null,args:null,concreteType:"WECGroupAdminsConnection",kind:"LinkedField",name:"wec_group_admins",plural:!1,selections:[Jm],storageKey:null}],type:"WECGroupRecipient",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},ep={alias:"watermark",args:null,kind:"ScalarField",name:"timestamp_precise",storageKey:null},tp={alias:"action",args:null,kind:"ScalarField",name:"action_timestamp_precise",storageKey:null},np={alias:null,args:null,concreteType:"MessagingReadReceiptsOfThreadConnection",kind:"LinkedField",name:"read_receipts",plural:!1,selections:[{alias:null,args:null,concreteType:"MessagingReadReceipt",kind:"LinkedField",name:"nodes",plural:!0,selections:[ep,tp,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actor",plural:!1,selections:q,storageKey:null}],storageKey:null}],storageKey:null},rp=[{alias:null,args:null,concreteType:"MessagingDeliveryReceiptsOfThreadConnection",kind:"LinkedField",name:"delivery_receipts",plural:!1,selections:[{alias:null,args:null,concreteType:"MessagingDeliveryReceipt",kind:"LinkedField",name:"nodes",plural:!0,selections:Ds,storageKey:null}],storageKey:null}],op={condition:"includeDeliveryReceipts",kind:"Condition",passingValue:!0,selections:rp},ap=[M,{alias:null,args:null,concreteType:"MessageThread",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,F,O,bl,vl,El,kl,Il,Tl,Dl,xl,Mt,$l,Pl,Nl,Ml,wl,Al,Fl,Ol,Bl,Wl,ql,Ul,Vl,Hl,Gl,Yl,is,ls,ss,us,cs,ps,Is,Ts,xs,Vs,zs,lu,hu,cu,yu,Cu,bu,vu,Su,Ru,Lu,Eu,Ou,Bu,Wu,qu,Zd,nm,rm,Ut,om,am,cm,dm,mm,pm,_m,fm,Zm,np,op],storageKey:null}],ip={alias:null,args:null,kind:"ScalarField",name:"instagram_user_id",storageKey:null},lp=[ip,nt],sp={alias:null,args:null,kind:"ScalarField",name:"unseen_count",storageKey:null},up={alias:null,args:null,kind:"ScalarField",name:"token",storageKey:null},cp={alias:null,args:null,kind:"ScalarField",name:"thread_id",storageKey:null},dp={alias:null,args:null,kind:"ScalarField",name:"thread_v2_id",storageKey:null},mp={alias:null,args:null,kind:"ScalarField",name:"instagram_message_thread_type",storageKey:null},pp={alias:null,args:null,kind:"ScalarField",name:"thread_title",storageKey:null},_p={alias:null,args:null,kind:"ScalarField",name:"is_group",storageKey:null},fp={alias:null,args:null,kind:"ScalarField",name:"last_activity_at",storageKey:null},gp={alias:null,args:null,concreteType:"IGThreadLastSeenUser",kind:"LinkedField",name:"last_seen_at",plural:!0,selections:[Io,Ki,$d],storageKey:null},hp={alias:null,args:null,kind:"ScalarField",name:"media_type",storageKey:null},yp={alias:null,args:null,concreteType:"IGThreadDirectStoryData",kind:"LinkedField",name:"direct_story",plural:!1,selections:[sp,hp],storageKey:null},Cp={alias:null,args:null,concreteType:"InstagramMessageThreadThreadLabelsConnection",kind:"LinkedField",name:"thread_labels",plural:!1,selections:[{alias:null,args:null,concreteType:"BusinessPresenceCustomLabel",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,O,Ns,Ms,ws],storageKey:null}],storageKey:null},bp={alias:null,args:null,concreteType:"InstagramMessageThreadThreadCorpLabelsConnection",kind:"LinkedField",name:"thread_corp_labels",plural:!1,selections:[{alias:null,args:null,concreteType:"BusinessPresenceCorporationLabel",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,O,Ns,Ms],storageKey:null}],storageKey:null},vp={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"assigned_admin",plural:!1,selections:wu,storageKey:null},Sp={alias:null,args:null,kind:"ScalarField",name:"is_follow_up",storageKey:null},Rp={alias:null,args:null,kind:"ScalarField",name:"is_read",storageKey:null},Lp={alias:null,args:null,kind:"ScalarField",name:"business_thread_folder",storageKey:null},Ep={alias:null,args:null,concreteType:"IGThreadUserNodesData",kind:"LinkedField",name:"thread_users",plural:!1,selections:[{alias:null,args:null,concreteType:"IGThreadUserData",kind:"LinkedField",name:"nodes",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"eimu_id",storageKey:null},ip,Cm,O,{alias:null,args:null,concreteType:"IGThreadUserProfilePic",kind:"LinkedField",name:"profile_picture",plural:!1,selections:re,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"blocking",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_verified",storageKey:null}],storageKey:null}],storageKey:null},kp={alias:null,args:null,kind:"ScalarField",name:"input_mode",storageKey:null},Ip={alias:null,args:null,kind:"ScalarField",name:"is_partnership",storageKey:null},Tp={alias:null,args:null,kind:"ScalarField",name:"time_stamp",storageKey:null},Dp={alias:null,args:null,kind:"ScalarField",name:"ig_item_type",storageKey:null},xp={alias:null,args:null,kind:"ScalarField",name:"client_context",storageKey:null},$p={alias:null,args:null,concreteType:"IGThreadItemPlaceHolderSource",kind:"LinkedField",name:"ig_placeholder",plural:!1,selections:[Q,Ma],storageKey:null},Pp=[{kind:"Variable",name:"height",variableName:"height"},{kind:"Variable",name:"width",variableName:"width"}],Np={alias:null,args:Pp,concreteType:"Image",kind:"LinkedField",name:"image_source",plural:!1,selections:re,storageKey:null},Mp={alias:null,args:Pp,concreteType:"IGThreadItemVideoSource",kind:"LinkedField",name:"video_source",plural:!1,selections:Jr,storageKey:null},wp={alias:null,args:null,kind:"ScalarField",name:"expiring_at",storageKey:null},Ap=[ip,Cm,O,nt],Fp={alias:null,args:null,concreteType:"InstagramUserV2",kind:"LinkedField",name:"media_owner",plural:!1,selections:Ap,storageKey:null},Op={alias:null,args:null,concreteType:"IGMessageThreadItemRavenMedia",kind:"LinkedField",name:"raven_media",plural:!1,selections:[hp,{alias:null,args:null,kind:"ScalarField",name:"seen_user_ids",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"view_mode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"seen_count",storageKey:null},{alias:null,args:null,concreteType:"IGMessageThreadItemMedia",kind:"LinkedField",name:"media",plural:!0,selections:[Np,Mp,wp],storageKey:null}],storageKey:null},Bp={alias:null,args:null,concreteType:"InstagramUserV2",kind:"LinkedField",name:"user",plural:!1,selections:Ap,storageKey:null},Wp={alias:null,args:Pp,concreteType:"Image",kind:"LinkedField",name:"image_source",plural:!1,selections:Jr,storageKey:null},qp={kind:"InlineFragment",selections:z,type:"IGMessageThreadItemMediaShare",abstractKey:null},Up={alias:null,args:null,kind:"ScalarField",name:"story_type",storageKey:null},Vp={kind:"InlineFragment",selections:[Up,G,K],type:"IGMessageThreadItemReelShare",abstractKey:null},Hp={kind:"InlineFragment",selections:[Up,Ma,Q,G],type:"IGMessageThreadItemStoryShare",abstractKey:null},Gp={kind:"InlineFragment",selections:[Q,G],type:"IGMessageThreadItemFelixShare",abstractKey:null},zp={kind:"InlineFragment",selections:[Q,dt,G,{alias:null,args:null,kind:"ScalarField",name:"current_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"full_price",storageKey:null},ne],type:"IGMessageThreadItemProductShare",abstractKey:null},jp={alias:null,args:null,kind:"ScalarField",name:"likes_count",storageKey:null},Kp={alias:null,args:null,kind:"ScalarField",name:"emojis",storageKey:null},Qp={alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"media",plural:!0,selections:Jr,storageKey:null},Xp={alias:null,args:null,concreteType:"IGThreadItemActionLogSource",kind:"LinkedField",name:"action_log",plural:!1,selections:[Ut,{alias:null,args:null,concreteType:"IGThreadItemActionLogBoldSource",kind:"LinkedField",name:"bold",plural:!0,selections:nr,storageKey:null},{alias:null,args:null,concreteType:"IGThreadItemActionLogTextAttributesSource",kind:"LinkedField",name:"text_attributes",plural:!0,selections:[er,tr,bt,{alias:null,args:null,kind:"ScalarField",name:"intent",storageKey:null}],storageKey:null}],storageKey:null},Yp={alias:null,args:null,concreteType:"IGThreadItemLinkSource",kind:"LinkedField",name:"link_source",plural:!1,selections:[xp,G,{alias:null,args:null,concreteType:"IGThreadItemLinkContextSource",kind:"LinkedField",name:"link_context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"link_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link_title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link_summary",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link_image_url",storageKey:null}],storageKey:null}],storageKey:null},Jp={alias:null,args:null,concreteType:"IGThreadItemVideoSource",kind:"LinkedField",name:"animated_media",plural:!1,selections:ga,storageKey:null},Zp={alias:null,args:null,concreteType:"IGThreadItemVoiceMediaSource",kind:"LinkedField",name:"voice_media",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"audio_src",storageKey:null},et],storageKey:null},e_=[hp,Wp],t_={alias:null,args:null,concreteType:"IGMessageThreadItemMedia",kind:"LinkedField",name:"media",plural:!1,selections:e_,storageKey:null},n_={alias:null,args:null,concreteType:"IGMessageThreadItemHScrollShareItem",kind:"LinkedField",name:"hscroll_share",plural:!0,selections:[Q,dt,ne,t_],storageKey:null},r_={alias:null,args:null,kind:"ScalarField",name:"header_title",storageKey:null},o_={alias:null,args:null,kind:"ScalarField",name:"header_subtitle",storageKey:null},a_={alias:null,args:null,kind:"ScalarField",name:"header_icon_url",storageKey:null},i_={alias:null,args:null,concreteType:"IGMessageThreadItemCollectionShare",kind:"LinkedField",name:"shops_collection_share",plural:!1,selections:[r_,o_,a_,Q,dt,cn,t_],storageKey:null},l_={alias:null,args:null,concreteType:"IGMessageThreadItemAppointmentBooking",kind:"LinkedField",name:"appointment_booking",plural:!1,selections:[Q,{alias:null,args:null,kind:"ScalarField",name:"max_title_num_of_lines",storageKey:null},dt,{alias:null,args:null,kind:"ScalarField",name:"max_subtitle_num_of_lines",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"header_title_text",storageKey:null},{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"header_icon_url_info",plural:!1,selections:Jr,storageKey:null},t_,{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"preview_extra_urls_info",plural:!0,selections:Jr,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"preview_layout_type",storageKey:null},cn,{alias:null,args:null,concreteType:"IGXMAMessageCTAButton",kind:"LinkedField",name:"cta_buttons",plural:!0,selections:[X,Q],storageKey:null}],storageKey:null},s_={alias:null,args:null,concreteType:"IGMessageThreadItemShopShare",kind:"LinkedField",name:"shop_share",plural:!1,selections:[r_,o_,a_,{alias:null,args:null,concreteType:"IGMessageThreadItemMedia",kind:"LinkedField",name:"medias",plural:!0,selections:e_,storageKey:null},cn],storageKey:null},u_={alias:null,args:null,concreteType:"IGMessageThreadItemGenericXMA",kind:"LinkedField",name:"generic_xma",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"xma_template_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"xma_layout_type",storageKey:null},Q,{alias:null,args:null,kind:"ScalarField",name:"sub_title",storageKey:null},{alias:null,args:null,concreteType:"GenericXMACTAButton",kind:"LinkedField",name:"cta_buttons",plural:!0,selections:[Q,X],storageKey:null},{alias:null,args:null,concreteType:"IGMessageThreadItemMedia",kind:"LinkedField",name:"preview_url_info",plural:!1,selections:e_,storageKey:null}],storageKey:null},c_={alias:null,args:null,kind:"ScalarField",name:"send_attribution",storageKey:null},d_={alias:null,args:null,concreteType:"IGMessageThreadItemRepliedToMessage",kind:"LinkedField",name:"replied_to_message",plural:!1,selections:[G,Ss,Ki,$d],storageKey:null},m_={alias:null,args:null,kind:"ScalarField",name:"end_cursor",storageKey:null},p_={alias:null,args:null,kind:"ScalarField",name:"has_next_page",storageKey:null},__={alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"page_info",plural:!1,selections:[m_,p_],storageKey:null},f_=[{alias:null,args:null,concreteType:"InstagramMessageThreadItem",kind:"LinkedField",name:"nodes",plural:!0,selections:[up,Io,od,Tp,Dp,G,xp,$p,{alias:null,args:null,concreteType:"IGMessageThreadItemMedia",kind:"LinkedField",name:"ig_thread_item_media",plural:!1,selections:[hp,Np,Mp,wp,Fp],storageKey:null},Op,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"share",plural:!1,selections:[Bp,{alias:null,args:null,concreteType:"IGMessageThreadItemMedia",kind:"LinkedField",name:"media",plural:!0,selections:[hp,Wp,Mp,wp,Fp],storageKey:null},qp,Vp,Hp,Gp,zp],storageKey:null},{alias:null,args:null,concreteType:"IGThreadItemReactions",kind:"LinkedField",name:"ig_reaction",plural:!1,selections:[jp,{alias:null,args:null,concreteType:"InstagramUserV2",kind:"LinkedField",name:"likes",plural:!0,selections:lp,storageKey:null},Kp],storageKey:null},{alias:null,args:Pp,concreteType:"IGThreadItemProfileShareSource",kind:"LinkedField",name:"profileshare",plural:!1,selections:[Bp,Qp],storageKey:null},Xp,Yp,Jp,Zp,n_,i_,l_,s_,u_,c_,d_],storageKey:null},__],g_={alias:null,args:null,kind:"ScalarField",name:"selected_thread_type",storageKey:null},h_=[{kind:"Variable",name:"after",variableName:"item_after"},{kind:"Variable",name:"first",variableName:"item_limit"}],y_=[{kind:"Variable",name:"before_time_precise",variableName:"before"},{kind:"Variable",name:"last",variableName:"message_limit"}],C_={alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"page_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"has_previous_page",storageKey:null}],storageKey:null},b_={condition:"load_delivery_receipts",kind:"Condition",passingValue:!0,selections:rp},v_={kind:"Variable",name:"page_id",variableName:"page_id"},S_=[v_],R_={alias:null,args:null,kind:"ScalarField",name:"business_id",storageKey:null},L_={kind:"RootArgument",name:"page_id"},E_={kind:"Variable",name:"business_assets",variableName:"businessAssets"},k_={condition:"getShouldUnifyConfigQueries",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"XFBBizInboxSelectedThread",kind:"LinkedField",name:"selected_thread",plural:!1,selections:[{alias:null,args:[E_,v_],concreteType:"BizInboxFeatureConfigWrapper",kind:"LinkedField",name:"selected_thread_biz_inbox_feature_config",plural:!1,selections:[{alias:null,args:null,concreteType:"BizInboxGatingConfig",kind:"LinkedField",name:"gating_config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"show_commerce_invoice_button_in_composer",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"show_product_picker_button_in_composer",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"show_send_availability_button_in_composer",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"show_create_appointment_button_in_composer",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"show_customer_feedback_button_on_move_to_done",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"show_form_builder_in_composer",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"show_send_inthread_forms_in_composer",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"show_marketing_messages_in_composer",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"marketing_messages_in_composer_state",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"show_gcash_id_share_and_copy_button",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"show_calling_in_composer",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"show_calling_live_in_composer",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"show_biz_ai_in_composer",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"BizInboxCommerceInvoiceButtonConfig",kind:"LinkedField",name:"commerce_invoice_button_config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"show_confirm_payment",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"show_payment_onboarding",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"show_request_payment",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"commerce_invoice_button_icon",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},I_=[sp],T_={alias:"xfb_unified_thread_list_pending",args:[{kind:"Variable",name:"msgr_params",variableName:"msgr_pending_params"},{kind:"Variable",name:"wa_params",variableName:"wa_pending_params"}],concreteType:"XFBBizInboxUnifiedThreadList",kind:"LinkedField",name:"xfb_biz_inbox_unified_thread_list",plural:!1,selections:[{condition:"isWorkUser",kind:"Condition",passingValue:!1,selections:[{alias:"wa_pending_threads",args:null,concreteType:"ViewerMessageThreadsConnection",kind:"LinkedField",name:"wa_threads",plural:!1,selections:I_,storageKey:null},{alias:"msg_pending_threads",args:null,concreteType:"ViewerMessageThreadsConnection",kind:"LinkedField",name:"msgr_threads",plural:!1,selections:I_,storageKey:null}]}],storageKey:null},D_={alias:null,args:S_,concreteType:"BizCRMContactCardConfig",kind:"LinkedField",name:"selected_biz_crm_contact_card_config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"can_add_activities",storageKey:null}],storageKey:null},x_=[E_],$_=[Ke,w],P_={kind:"InlineFragment",selections:q,type:"DynamicFeedAdAttachmentMedia",abstractKey:null},N_={kind:"InlineFragment",selections:q,type:"GenericAttachmentMedia",abstractKey:null},M_={kind:"InlineFragment",selections:q,type:"MontageImage",abstractKey:null},w_={kind:"InlineFragment",selections:q,type:"MontageVideo",abstractKey:null},A_={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media",plural:!1,selections:[Ke,ue,de,_e,fe,ge,he,nl,P_,N_,M_,w_],storageKey:null},F_={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"action_links",plural:!0,selections:[Ke,Q,ae],storageKey:null},O_={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"action_objects",plural:!0,selections:[Ke,w,{kind:"InlineFragment",selections:[xe,$e,Pe,Ne],type:"MessengerPlatformEntPreview",abstractKey:"__isMessengerPlatformEntPreview"}],storageKey:null},B_={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"cta_data",plural:!1,selections:[Ke,Ve],storageKey:null},W_={alias:null,args:null,concreteType:"MessengerCallToAction",kind:"LinkedField",name:"messenger_call_to_actions",plural:!0,selections:[Te,De,O_,we,Ae,w,Fe,Oe,Be,We,qe,Ue,B_,Ge,Y],storageKey:null},q_=[Ke,{kind:"TypeDiscriminator",abstractKey:"__isPaymentActivityAction"},st,ut,ct,Q,pt,{kind:"InlineFragment",selections:[{alias:"moneyTransfer",args:null,concreteType:null,kind:"LinkedField",name:"generic_money_transfer",plural:!1,selections:[Ke,tt,ot,at,ht,w],storageKey:null}],type:"P2PPaymentActionButtonWithTransfer",abstractKey:null}],U_={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"P2PBubbleView",kind:"LinkedField",name:"bubble_view",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actions",plural:!0,selections:q_,storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"components",plural:!0,selections:[Ke,Ct,vt,Rt,Lt],storageKey:null},{alias:null,args:null,concreteType:"P2PBubbleRobotext",kind:"LinkedField",name:"robotext",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"action",plural:!1,selections:q_,storageKey:null},bt,Et,G],storageKey:null},{alias:"rootAction",args:null,concreteType:null,kind:"LinkedField",name:"root_action",plural:!1,selections:q_,storageKey:null}],storageKey:null}],type:"PaymentViewData",abstractKey:"__isPaymentViewData"},V_={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"receiver_profile",plural:!1,selections:[Ke,w,O,nt,Tt],storageKey:null},H_=[Mt,w],G_={alias:null,args:null,concreteType:"PeerToPeerTransferContext",kind:"LinkedField",name:"transfer_context",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageImage",kind:"LinkedField",name:"memo_images",plural:!0,selections:H_,storageKey:null},At,w],storageKey:null},z_={alias:null,args:null,concreteType:"PeerToPeerPlatformSoldItemDetail",kind:"LinkedField",name:"platform_item",plural:!1,selections:[O,Ut,{alias:null,args:null,concreteType:"Photo",kind:"LinkedField",name:"photos",plural:!0,selections:H_,storageKey:null},ae,w],storageKey:null},j_=[Ke,O,w,nt,Tt],K_={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"requester",plural:!1,selections:j_,storageKey:null},Q_={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"requestee",plural:!1,selections:j_,storageKey:null},X_={alias:null,args:null,concreteType:"PeerToPeerTransfer",kind:"LinkedField",name:"transfer",plural:!1,selections:[ot,V_,Dt,xt,tt,$t,Pt,Nt,G_,Bt,Wt,qt,z_,w,Vt,Ht,Gt,U_],storageKey:null},Y_=[Te,De,O_,we,Ae,w,Fe,Oe,Be,We,qe,Ue,B_],J_={alias:null,args:null,concreteType:"MessengerCallToAction",kind:"LinkedField",name:"call_to_actions",plural:!0,selections:Y_,storageKey:null},Z_={alias:null,args:null,concreteType:"MessengerCallToAction",kind:"LinkedField",name:"default_action",plural:!1,selections:Y_,storageKey:null},ef=[{alias:null,args:null,concreteType:"MessengerRetailItem",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,Ut,ln,Ne,sn,O,un,cn,Z_,J_,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media_blob_attachments",plural:!0,selections:[Ke,pn,_n,yn,Ln,En,nl,P_,N_,M_,w_],storageKey:null}],storageKey:null}],tf=[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"messaging_actor",plural:!1,selections:[Ke,w,O],storageKey:null},w],nf={alias:"primary_photo",args:null,concreteType:null,kind:"LinkedField",name:"primary_listing_photo",plural:!1,selections:[Ke,Xo,w],storageKey:null},rf={alias:null,args:null,concreteType:"RetailShipmentItemsConnection",kind:"LinkedField",name:"retail_shipment_items",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerRetailItem",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,O,Ar,Fr,Or,Br,ln,sn,Wr,qr,J_],storageKey:null}],storageKey:null},of=[O,w],af={kind:"InlineFragment",selections:q,type:"XFBTopicTag",abstractKey:null},lf={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media",plural:!1,selections:[Ke,ge,bi,nl,P_,N_,M_,w_],storageKey:null},sf={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media",plural:!1,selections:[Ke,Mt,nl,P_,N_,M_,w_],storageKey:null},uf={alias:null,args:null,concreteType:"Photo",kind:"LinkedField",name:"photo",plural:!1,selections:H_,storageKey:null},cf={alias:null,args:null,concreteType:"FocusedPhoto",kind:"LinkedField",name:"cover_photo",plural:!1,selections:[uf],storageKey:null},df={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"group_general_chat",plural:!1,selections:$_,storageKey:null},mf={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"target",plural:!1,selections:[Ke,w,Qe,{kind:"InlineFragment",selections:[Xe,he,Ye,Je,Ze,et],type:"WECMessageAudio",abstractKey:null},{kind:"InlineFragment",selections:[tt,ot,at,U_],type:"MoneyTransfer",abstractKey:null},{kind:"InlineFragment",selections:[ot,V_,Dt,xt,tt,$t,Pt,Nt,G_,Bt,Wt,qt,z_,Vt,Ht,Gt,U_],type:"PeerToPeerTransfer",abstractKey:null},{kind:"InlineFragment",selections:[jt,Kt,K_,Q_,Jt,Zt,Gt,X_,tn,qt,nn,Vt,{alias:null,args:null,concreteType:"PeerToPeerPaymentRequest",kind:"LinkedField",name:"individual_requests",plural:!0,selections:[jt,Kt,K_,Q_,Jt,Zt,w,Gt,X_,tn,qt,nn,Vt,U_],storageKey:null},U_],type:"PeerToPeerPaymentRequest",abstractKey:null},U_,{kind:"InlineFragment",selections:[rn,J_,{alias:null,args:null,concreteType:"RetailPromotionItemsConnection",kind:"LinkedField",name:"promotion_items",plural:!1,selections:ef,storageKey:null}],type:"MessengerRetailPromotion",abstractKey:null},{kind:"InlineFragment",selections:[rn,J_,{alias:null,args:null,concreteType:"MessengerBusinessMessageItemsConnection",kind:"LinkedField",name:"business_items",plural:!1,selections:ef,storageKey:null}],type:"MessengerBusinessMessage",abstractKey:null},In,Pn,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"invite_sender",plural:!1,selections:$_,storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"invite_recipient",plural:!1,selections:$_,storageKey:null}],type:"QuickInvite",abstractKey:null},{kind:"InlineFragment",selections:[Nn,Mn,wn,An,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"blob_media",plural:!1,selections:[Ke,On,Bn,nl],storageKey:null}],type:"MontageDirect",abstractKey:null},{kind:"InlineFragment",selections:[Wn,W,qn],type:"MontageShare",abstractKey:null},{kind:"InlineFragment",selections:[Vn,Hn,Gn,zn,jn,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"native_component_flow_request",plural:!1,selections:[Ke,w,{kind:"InlineFragment",selections:[Kn,Qn,Xn,Un,Yn,Zn,rr,{alias:null,args:null,concreteType:"NativeComponentFlowBookingRequestServicesProductItemsConnection",kind:"LinkedField",name:"services_product_items",plural:!1,selections:[{alias:null,args:null,concreteType:"ServicesProductItem",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,O,Ut,or,ar,{alias:null,args:ir,concreteType:"ProductImage",kind:"LinkedField",name:"images",plural:!0,selections:[lr,w],storageKey:"images(first:1)"},sr],storageKey:null}],storageKey:null},ur,cr,dr,mr,pr,_r,fr,gr,hr,yr,Cr,zn,jn,br],type:"NativeComponentFlowBookingRequest",abstractKey:null}],storageKey:null}],type:"PagesPlatformBookingMessage",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"MessagingParticipant",kind:"LinkedField",name:"genie_sender",plural:!1,selections:tf,storageKey:null},{alias:null,args:null,concreteType:"StoryAttachment",kind:"LinkedField",name:"story_attachment",plural:!1,selections:[j,Z,A_,Ce,be,ve,Re,Le,Ee,F_,Ie,W_,je],storageKey:null}],type:"GenieMessage",abstractKey:null},{kind:"InlineFragment",selections:[Rr,Lr,Er,kr,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"event_place",plural:!1,selections:[Ke,O,nl],storageKey:null},Tr,Dr,xr,$r,Pr,O,Nr],type:"Event",abstractKey:null},Mr,wr,{kind:"InlineFragment",selections:[O,Ar,Fr,Or,Br,ln,sn,Wr,qr,Z_,J_],type:"MessengerRetailItem",abstractKey:null},{kind:"InlineFragment",selections:[Ar,Ur,Vr,cn,Fr,Hr,Gr,zr,jr,O],type:"AgentItemSuggestion",abstractKey:null},{kind:"InlineFragment",selections:[Kr,Qr,Xr,Yr,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"FundraiserCoverPhoto",kind:"LinkedField",name:"focused_cover_photo",plural:!1,selections:[{alias:null,args:null,concreteType:"Photo",kind:"LinkedField",name:"photo",plural:!1,selections:[Zr,w],storageKey:null}],storageKey:null}],type:"FundraiserWithPresence",abstractKey:"__isFundraiserWithPresence"}],type:"Fundraiser",abstractKey:"__isFundraiser"},{kind:"InlineFragment",selections:[eo,to,no,ro,oo,ao,io,lo,so,fo,mr,go,ho,yo,Co,{alias:null,args:null,concreteType:"RetailReceiptItemsConnection",kind:"LinkedField",name:"retail_items",plural:!1,selections:ef,storageKey:null},bo,vo,So,Ro],type:"MessengerRetailReceipt",abstractKey:null},{kind:"InlineFragment",selections:[Lo,Eo,ko,{alias:null,args:null,concreteType:"PaymentInvoiceProduct",kind:"LinkedField",name:"item_list",plural:!0,selections:[Io,O,To,Ut,xo,$o,Po,w],storageKey:null},No,wo,Ao,Fo,Oo,Bo,Wo,qo,Uo,Vo,Ho,Go,zo],type:"PaymentPlatformAttachment",abstractKey:null},{kind:"InlineFragment",selections:[jo,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"group_commerce_item_seller",plural:!1,selections:$_,storageKey:null},Ko,Qo,nf,ae],type:"GroupCommerceProductItem",abstractKey:null},{kind:"InlineFragment",selections:[Ko,nf],type:"MarketplaceListingRenderable",abstractKey:"__isMarketplaceListingRenderable"},{kind:"InlineFragment",selections:[Jo,Zo,ea,ta,O,na,ra],type:"Page",abstractKey:null},ia,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"MessengerRetailShipment",kind:"LinkedField",name:"shipment",plural:!1,selections:[w,la,sa,ua,ma,pa,rf,ya,ba],storageKey:null},va,Sa,Ca,Ra,bo],type:"MessengerRetailShipmentTrackingEvent",abstractKey:null},{kind:"InlineFragment",selections:[la,sa,ua,ma,pa,rf,La,Ea,{alias:null,args:null,concreteType:"MessengerRetailReceipt",kind:"LinkedField",name:"receipt",plural:!1,selections:[ro,w],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"recipient",plural:!1,selections:of,storageKey:null},bo],type:"MessengerRetailShipment",abstractKey:null},{kind:"InlineFragment",selections:[ka,Ia,O,Ta],type:"LeadGenDeepLinkData",abstractKey:null},{kind:"InlineFragment",selections:[Da],type:"UserLeadGenInfo",abstractKey:null},$a,{kind:"InlineFragment",selections:[O,Pa,ne,Je,Ze],type:"WECMessageFile",abstractKey:null},{kind:"InlineFragment",selections:[he,Ye,Je,Ze,Xe,ie,Na,le],type:"WECMessageVideo",abstractKey:null},Aa,{kind:"InlineFragment",selections:[Je,Wa,Va],type:"WECMessageImage",abstractKey:null},{kind:"InlineFragment",selections:[Ha,Ga,za,ja,Ka,Qa,Xa],type:"MentorshipMessengerCurriculumStep",abstractKey:null},{kind:"InlineFragment",selections:[Ya],type:"MentorshipMessengerDiscussionTopicSet",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"MentorshipProgram",kind:"LinkedField",name:"mentorship_program",plural:!1,selections:[w,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"other_member",plural:!1,selections:[Ke,It,w],storageKey:null}],storageKey:null},Za],type:"MentorshipMessengerLeavePrompt",abstractKey:null},{kind:"InlineFragment",selections:[Za],type:"MentorshipMessengerReminder",abstractKey:null},{kind:"InlineFragment",selections:[Za,ei,ti],type:"MentorshipMessengerProgressTracker",abstractKey:null},{kind:"InlineFragment",selections:[ri,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"message_richtext",plural:!0,selections:[Ke,oi,ai,ii,{alias:null,args:null,concreteType:"ComposedEntityAtRange",kind:"LinkedField",name:"entity_ranges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"entity",plural:!1,selections:[Ke,nl,af],storageKey:null},lt,ni],storageKey:null},li,G],storageKey:null},{alias:null,args:null,concreteType:"Feedback",kind:"LinkedField",name:"feedback",plural:!1,selections:[si,ui,ci,{alias:null,args:mi,concreteType:"TopReactionsConnection",kind:"LinkedField",name:"top_reactions",plural:!1,selections:[{alias:null,args:null,concreteType:"FeedbackReactionInfo",kind:"LinkedField",name:"nodes",plural:!0,selections:[pi,w],storageKey:null}],storageKey:'top_reactions(first:3,orderby:["COUNT_DESC","REACTION_TYPE"])'},w],storageKey:null},_i,tn,fi,Ci,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"to",plural:!1,selections:[Ke,O,gi,yi,w],storageKey:null},{alias:null,args:null,concreteType:"StoryAttachment",kind:"LinkedField",name:"attachments",plural:!0,selections:[be,ae,Ce,j,lf,Si,{alias:null,args:Ri,concreteType:"SubattachmentsConnection",kind:"LinkedField",name:"all_subattachments",plural:!1,selections:[Li,{alias:"files",args:Ei,concreteType:"StoryAttachment",kind:"LinkedField",name:"nodes",plural:!0,selections:[Si,sf],storageKey:'nodes(if_style:"file_upload")'},{alias:"images",args:Ii,concreteType:"StoryAttachment",kind:"LinkedField",name:"nodes",plural:!0,selections:[sf],storageKey:'nodes(if_style:"photo")'}],storageKey:"all_subattachments(first:3)"}],storageKey:null},{alias:null,args:null,concreteType:"Story",kind:"LinkedField",name:"attached_story",plural:!1,selections:[Ti,Di,{alias:null,args:null,concreteType:"StoryAttachment",kind:"LinkedField",name:"attachments",plural:!0,selections:[lf],storageKey:null},w],storageKey:null}],type:"Story",abstractKey:null},{kind:"InlineFragment",selections:[O,nt,cf,Ni,Mi],type:"User",abstractKey:null},{kind:"InlineFragment",selections:[O,wi,Ai,Fi,cf,df,{alias:null,args:null,concreteType:"GroupsSyncMetadata",kind:"LinkedField",name:"work_groups_sync_metadata",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"messenger_group",plural:!1,selections:$_,storageKey:null}],storageKey:null}],type:"Group",abstractKey:null},{kind:"InlineFragment",selections:[Bi,Wi,qi,{alias:null,args:null,concreteType:"AppIntegration",kind:"LinkedField",name:"app_integration",plural:!1,selections:[Ui,O,Vi,Hi,w],storageKey:null},Gi,zi,{alias:null,args:null,concreteType:"AppContentAdditionalData",kind:"LinkedField",name:"link_preview_additional_data",plural:!0,selections:[Q,G,bt,ji,Ki,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"profiles",plural:!0,selections:[nt,O,w],storageKey:null}],storageKey:null}],type:"AppContent",abstractKey:null},{kind:"InlineFragment",selections:[Z_],type:"CommerceProductItemShare",abstractKey:null},{kind:"InlineFragment",selections:[Qi],type:"ApplicationReferralXMA",abstractKey:null},Yi,{kind:"InlineFragment",selections:[Ji],type:"XFBP2MXMA",abstractKey:null},Zi],storageKey:null},pf={alias:null,args:null,concreteType:"StoryAttachment",kind:"LinkedField",name:"story_attachment",plural:!1,selections:[j,Z,A_,Ce,be,ve,Re,Le,Ee,F_,Ie,W_,je,mf,{alias:null,args:null,concreteType:"StoryAttachment",kind:"LinkedField",name:"subattachments",plural:!0,selections:[j,Z,A_,Ce,be,ve,Re,Le,Ee,F_,Ie,W_,je,mf],storageKey:null}],storageKey:null},_f={alias:null,args:null,concreteType:"ExtensibleMessageAttachment",kind:"LinkedField",name:"extensible_attachment",plural:!1,selections:[H,pf,{alias:"genie_attachment",args:null,concreteType:"StoryAttachment",kind:"LinkedField",name:"story_attachment",plural:!1,selections:[{alias:"genie_message",args:null,concreteType:null,kind:"LinkedField",name:"target",plural:!1,selections:[Ke,w,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"MessagingParticipant",kind:"LinkedField",name:"genie_sender",plural:!1,selections:[w,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"messaging_actor",plural:!1,selections:[Ke,O,w,{kind:"TypeDiscriminator",abstractKey:"__isNode"}],storageKey:null}],storageKey:null},pf],type:"GenieMessage",abstractKey:null}],storageKey:null}],storageKey:null},w],storageKey:null},ff=[Ke,{kind:"TypeDiscriminator",abstractKey:"__isMessageBlobAttachment"},ll,sl,cl,Ln,ml,nl],gf={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"blob_attachments",plural:!0,selections:ff,storageKey:null},hf={alias:"last_message",args:B,concreteType:"MessagesOfThreadConnection",kind:"LinkedField",name:"messages",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"nodes",plural:!0,selections:[Ke,W,{alias:null,args:null,concreteType:"MessagingParticipant",kind:"LinkedField",name:"message_sender",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"messaging_actor",plural:!1,selections:$_,storageKey:null},w],storageKey:null},U,V,yl,Cl,w,{kind:"InlineFragment",selections:[_f,ol,gf],type:"UserMessage",abstractKey:null},{kind:"InlineFragment",selections:[fl,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"extensible_message_admin_text",plural:!1,selections:[Ke,hl],storageKey:null}],type:"GenericAdminTextMessage",abstractKey:null}],storageKey:null}],storageKey:"messages(last:1)"},yf={alias:null,args:null,concreteType:"JobApplicationsFromThreadConnection",kind:"LinkedField",name:"thread_associated_job_applications",plural:!1,selections:[{alias:null,args:null,concreteType:"JobApplication",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,{alias:null,args:null,concreteType:"JobOpening",kind:"LinkedField",name:"job_opening",plural:!1,selections:[Sl,{alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"employer",plural:!1,selections:[Rl,Ll,w],storageKey:null},w],storageKey:null}],storageKey:null}],storageKey:null},Cf={alias:null,args:null,concreteType:"MessageThreadCustomization",kind:"LinkedField",name:"customization_info",plural:!1,selections:[zl,Ql,Xl,w],storageKey:null},bf={alias:null,args:null,concreteType:"MessengerThreadTheme",kind:"LinkedField",name:"thread_theme",plural:!1,selections:[w,Jl,Zl,es,ts,{alias:null,args:null,concreteType:"MessengerReactionPack",kind:"LinkedField",name:"reaction_pack",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerReactionPackReactionAssetsConnection",kind:"LinkedField",name:"reaction_assets",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerReactionAsset",kind:"LinkedField",name:"nodes",plural:!0,selections:[ns,rs,os,as,w],storageKey:null}],storageKey:null},w],storageKey:null}],storageKey:null},vf={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"thread_admins",plural:!0,selections:$_,storageKey:null},Sf={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"thread_queue_metadata",plural:!1,selections:[Ke,ms,w],storageKey:null},Rf={alias:null,args:ir,concreteType:"MessengerEventRemindersOfThreadConnection",kind:"LinkedField",name:"event_reminders",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerEventReminder",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,_s,aa,fs,gs,hs,{alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"location_page",plural:!1,selections:[ys,w],storageKey:null},Cs,bs,vs,oa,{alias:null,args:null,concreteType:"UserMessage",kind:"LinkedField",name:"trigger_message",plural:!1,selections:[Ss,w],storageKey:null},Rs,Ls,Es,ks],storageKey:null}],storageKey:"event_reminders(first:1)"},Lf={alias:null,args:null,concreteType:"PageMessageThread",kind:"LinkedField",name:"related_page_thread",plural:!1,selections:[$s,Ps,Fs,Bs,Us,w],storageKey:null},Ef={alias:null,args:null,concreteType:"RtcCallData",kind:"LinkedField",name:"rtc_call_data",plural:!1,selections:[Hs,Gs,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"initiator",plural:!1,selections:$_,storageKey:null}],storageKey:null},kf={alias:null,args:null,concreteType:"MarketplaceThreadData",kind:"LinkedField",name:"marketplace_thread_data",plural:!1,selections:[{alias:null,args:null,concreteType:"GroupCommerceProductItem",kind:"LinkedField",name:"for_sale_item",plural:!1,selections:[w,qn,Qo,Ko,js,Ks,Qs,Xs,Ys,Js,Zs,{alias:"primary_photo",args:null,concreteType:null,kind:"LinkedField",name:"primary_listing_photo",plural:!1,selections:[Ke,Mt,w],storageKey:null},eu,tu],storageKey:null},nu,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"buyer",plural:!1,selections:$_,storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"seller",plural:!1,selections:[Ke,w,ou],storageKey:null},iu],storageKey:null},If={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"associated_object",plural:!1,selections:[Ke,w,{kind:"InlineFragment",selections:[su,O,nt,df,uu,cu,du,mu,_u,fu],type:"Group",abstractKey:null},{kind:"InlineFragment",selections:[su,O,nt,uu,cu,du,Nr,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"event_place",plural:!1,selections:[Ke,gu,nl],storageKey:null}],type:"Event",abstractKey:null}],storageKey:null},Tf={alias:null,args:null,concreteType:"PageCommItem",kind:"LinkedField",name:"page_comm_item",plural:!1,selections:[w,ku,Iu,Tu,Du,xu,Nu,Mu,{alias:null,args:null,concreteType:"PageCommItemToPageCommItemOwnersConnection",kind:"LinkedField",name:"comm_item_owners",plural:!1,selections:[{alias:null,args:null,concreteType:"PageCommItemOwner",kind:"LinkedField",name:"nodes",plural:!0,selections:[Au,w],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"subtitle",plural:!1,selections:[{alias:null,args:null,concreteType:"ImageAtRange",kind:"LinkedField",name:"image_ranges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"entity_with_image",plural:!1,selections:[Ke,Mt,nl,{kind:"InlineFragment",selections:q,type:"CatalogMarketplaceEnhancementTransformedImage",abstractKey:null},{kind:"InlineFragment",selections:q,type:"XFBBasicMarketplaceImage",abstractKey:null}],storageKey:null},lt,ni],storageKey:null},li,G],storageKey:null},Fu],storageKey:null},Df={alias:null,args:null,concreteType:"GroupsSyncMetadata",kind:"LinkedField",name:"groups_sync_metadata",plural:!1,selections:[{alias:null,args:null,concreteType:"Group",kind:"LinkedField",name:"fb_group",plural:!1,selections:[ae,w],storageKey:null}],storageKey:null},xf={kind:"TypeDiscriminator",abstractKey:"__isMessage"},$f={alias:null,args:null,concreteType:"MessageReaction",kind:"LinkedField",name:"message_reactions",plural:!0,selections:[tc,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"user",plural:!1,selections:$_,storageKey:null}],storageKey:null},Pf={alias:null,args:null,concreteType:"MessagingParticipant",kind:"LinkedField",name:"unsender",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"messaging_actor",plural:!1,selections:[Ke,w,O,gi],storageKey:null},w],storageKey:null},Nf={kind:"InlineFragment",selections:[ic,{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"message",plural:!1,selections:[G,{alias:null,args:null,concreteType:"EntityAtRange",kind:"LinkedField",name:"ranges",plural:!0,selections:[lt,ni,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"entity",plural:!1,selections:[Ke,lc,sc,uc,nl,af],storageKey:null},cc],storageKey:null}],storageKey:null},dc,_f,ol,gf,mc],type:"UserMessage",abstractKey:null},Mf=[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:ff,storageKey:null}],wf={kind:"InlineFragment",selections:[_c,W,{alias:null,args:null,concreteType:"VideoCallMessageToCaptureAttachmentsConnection",kind:"LinkedField",name:"call_capture_attachments",plural:!1,selections:[Li,{alias:null,args:null,concreteType:"VideoCallMessageToCaptureAttachmentsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:Mf,storageKey:null}],storageKey:null}],type:"VideoCallMessage",abstractKey:null},Af={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"MessageImage",kind:"LinkedField",name:"image_with_metadata",plural:!1,selections:[Cc,H,Rn,w],storageKey:null},W],type:"ThreadImageMessage",abstractKey:null},Ff={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"extensible_message_admin_text",plural:!1,selections:[Ke,Lc,Tc,Dc,xc,$c,Pc,Nc,Mc,wc,Fc,Oc,Bc,Wc,qc,Uc,Hc,{kind:"InlineFragment",selections:[gl,Gc,zc,jc,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"instant_game_update_data",plural:!1,selections:[Ke,{kind:"InlineFragment",selections:[Kc,Xi,uf,Qc],type:"InstantGameXMATCustomMessageClientData",abstractKey:null}],storageKey:null},Xc],type:"InstantGameUpdateExtensibleMessageAdminText",abstractKey:null},Yc,Jc,rd,ad,ld,ud,cd,dd,md,pd,_d,gd,hd,yd,bd,vd,Sd,{kind:"InlineFragment",selections:[Rd,Ld,Ed,Vc,kd,Id,Td,Dd,{alias:null,args:null,concreteType:"MessengerCallLogExtensibleMessageAdminTextCallCaptureAttachmentsConnection",kind:"LinkedField",name:"call_capture_attachments",plural:!1,selections:[Li,{alias:null,args:null,concreteType:"MessengerCallLogExtensibleMessageAdminTextCallCaptureAttachmentsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:Mf,storageKey:null}],storageKey:null}],type:"MessengerCallLogExtensibleMessageAdminText",abstractKey:null},xd,Md,wd,Fd,Od,Bd,Wd,qd,Vd,Hd,Gd,zd,jd],storageKey:null},fl,W],type:"GenericAdminTextMessage",abstractKey:null},Of=[Ke,xf,Vu,Ss,Hu,zu,ju,U,Ku,Qu,wa,Xu,V,Yu,Ju,yl,Zu,ec,$f,rc,Pf,ac,Cl,{alias:null,args:null,concreteType:"RepliedToMessage",kind:"LinkedField",name:"replied_to_message",plural:!1,selections:[mr,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"message",plural:!1,selections:[Ke,xf,Vu,Ss,Hu,zu,ju,U,Ku,Qu,wa,Xu,V,Yu,Ju,yl,Zu,ec,$f,rc,Pf,ac,Cl,w,Nf,fc,wf,yc,Af,vc,Sc,Ff,Xd,Yd],storageKey:null}],storageKey:null},w,Nf,fc,wf,yc,Af,vc,Sc,Ff,Xd,Yd],Bf={alias:null,args:null,concreteType:"PinnedMessageData",kind:"LinkedField",name:"pinned_messages",plural:!0,selections:[Ss,Uu,{condition:"threadlistViewFieldsOnly",kind:"Condition",passingValue:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"message",plural:!1,selections:Of,storageKey:null}]}],storageKey:null},Wf={alias:null,args:null,concreteType:"GroupsSyncMetadata",kind:"LinkedField",name:"work_groups_sync_metadata",plural:!1,selections:[{alias:null,args:null,concreteType:"Group",kind:"LinkedField",name:"fb_group",plural:!1,selections:[ae,w,O,wi,em,nt,_u,{alias:null,args:null,concreteType:"MultiBackgroundIcon",kind:"LinkedField",name:"group_icon",plural:!1,selections:[tm,w],storageKey:null}],storageKey:null}],storageKey:null},qf={alias:null,args:ir,concreteType:"MessengerMentorshipProgramOfThreadConnection",kind:"LinkedField",name:"linked_mentorship_programs",plural:!1,selections:[{alias:null,args:null,concreteType:"MentorshipProgram",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,im,lm,{alias:null,args:ir,concreteType:"MentorshipProgramToMentorshipMessengerCurriculumStepOrderByStepCountConnection",kind:"LinkedField",name:"messenger_curriculum_steps",plural:!1,selections:[{alias:null,args:null,concreteType:"MentorshipMessengerCurriculumStep",kind:"LinkedField",name:"nodes",plural:!0,selections:[sm,um,w],storageKey:null}],storageKey:"messenger_curriculum_steps(first:1)"}],storageKey:null}],storageKey:"linked_mentorship_programs(first:1)"},Uf={alias:null,args:null,concreteType:"WorkUserInfo",kind:"LinkedField",name:"work_info",plural:!1,selections:[{alias:null,args:null,concreteType:"Group",kind:"LinkedField",name:"work_community",plural:!1,selections:of,storageKey:null},Pi],storageKey:null},Vf={alias:null,args:null,concreteType:"MessagingParticipant",kind:"LinkedField",name:"nodes",plural:!0,selections:tf,storageKey:null},Hf={alias:null,args:null,concreteType:"AllMessagingParticipantsOfThreadConnection",kind:"LinkedField",name:"all_participants",plural:!1,selections:[{alias:null,args:null,concreteType:"AllMessagingParticipantsOfThreadEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[gm,{alias:null,args:null,concreteType:"MessagingParticipant",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"messaging_actor",plural:!1,selections:[Ke,{kind:"TypeDiscriminator",abstractKey:"__isMessagingActor"},w,O,{kind:"InlineFragment",selections:[hm,ae,ym,It,Cm,bm,vm,Sm,Rm,Lm,Em,km,Im,Uf],type:"User",abstractKey:null},Dm,xm,Pm,Nm,wm,Am,Fm,{kind:"InlineFragment",selections:[ae,ym,Cm,Om,Sm,Uf],type:"ReducedMessagingActor",abstractKey:null},Wm,qm,Um,Hm,Gm,zm,jm,Km,Qm,{kind:"InlineFragment",selections:[ym,Xm,Ym,{alias:null,args:null,concreteType:"WECGroupParticipantsConnection",kind:"LinkedField",name:"wec_group_participants",plural:!1,selections:[Vf,Li],storageKey:null},{alias:null,args:null,concreteType:"WECGroupAdminsConnection",kind:"LinkedField",name:"wec_group_admins",plural:!1,selections:[Vf],storageKey:null}],type:"WECGroupRecipient",abstractKey:null}],storageKey:null},w],storageKey:null}],storageKey:null}],storageKey:null},Gf={alias:null,args:null,concreteType:"MessagingReadReceiptsOfThreadConnection",kind:"LinkedField",name:"read_receipts",plural:!1,selections:[{alias:null,args:null,concreteType:"MessagingReadReceipt",kind:"LinkedField",name:"nodes",plural:!0,selections:[ep,tp,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actor",plural:!1,selections:$_,storageKey:null}],storageKey:null}],storageKey:null},zf={condition:"threadlistViewFieldsOnly",kind:"Condition",passingValue:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"saved_messages",plural:!0,selections:Of,storageKey:null}]},jf=[{alias:null,args:null,concreteType:"MessageThread",kind:"LinkedField",name:"nodes",plural:!0,selections:[w,F,O,hf,vl,yf,kl,Il,Dl,xl,Mt,$l,Pl,Nl,Ml,wl,Al,Fl,Ol,Bl,Wl,ql,Ul,Vl,Hl,Gl,Cf,bf,vf,ss,us,cs,Sf,Rf,Ts,xs,Lf,Ef,kf,If,cu,yu,Cu,bu,vu,Su,Ru,Lu,Eu,Tf,Bu,Wu,Df,Bf,Wf,Ut,om,am,qf,dm,mm,pm,_m,fm,Hf,Gf,Tl,zf,op],storageKey:null},M],Kf=[ip,nt,w],Qf=[ip,Cm,O,nt,w],Xf={alias:null,args:null,concreteType:"InstagramUserV2",kind:"LinkedField",name:"media_owner",plural:!1,selections:Qf,storageKey:null},Yf={alias:null,args:null,concreteType:"InstagramUserV2",kind:"LinkedField",name:"user",plural:!1,selections:Qf,storageKey:null},Jf=[{alias:null,args:null,concreteType:"InstagramMessageThreadItem",kind:"LinkedField",name:"nodes",plural:!0,selections:[up,Io,od,Tp,Dp,G,xp,$p,{alias:null,args:null,concreteType:"IGMessageThreadItemMedia",kind:"LinkedField",name:"ig_thread_item_media",plural:!1,selections:[hp,Np,Mp,wp,Xf],storageKey:null},Op,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"share",plural:!1,selections:[Ke,Yf,{alias:null,args:null,concreteType:"IGMessageThreadItemMedia",kind:"LinkedField",name:"media",plural:!0,selections:[hp,Wp,Mp,wp,Xf],storageKey:null},qp,Vp,Hp,Gp,zp],storageKey:null},{alias:null,args:null,concreteType:"IGThreadItemReactions",kind:"LinkedField",name:"ig_reaction",plural:!1,selections:[jp,{alias:null,args:null,concreteType:"InstagramUserV2",kind:"LinkedField",name:"likes",plural:!0,selections:Kf,storageKey:null},Kp],storageKey:null},{alias:null,args:Pp,concreteType:"IGThreadItemProfileShareSource",kind:"LinkedField",name:"profileshare",plural:!1,selections:[Yf,Qp],storageKey:null},Xp,Yp,Jp,Zp,n_,i_,l_,s_,u_,c_,d_,w],storageKey:null},__],Zf={alias:null,args:null,kind:"ScalarField",name:"page_contact_id",storageKey:null},eg=[{kind:"Literal",name:"height",value:52},{kind:"Literal",name:"width",value:52}],tg=[{kind:"Literal",name:"first",value:20}],ng={alias:null,args:null,kind:"ScalarField",name:"contact_count",storageKey:null},rg={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},og={kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"__id",storageKey:null}]},ag={alias:null,args:null,kind:"ScalarField",name:"unit_type",storageKey:null},ig=[{kind:"Literal",name:"first",value:4},{kind:"Literal",name:"message_shared_media_type",value:"PHOTO_AND_VIDEO"}],lg={alias:"fbid",args:null,kind:"ScalarField",name:"legacy_attachment_id",storageKey:null},sg={alias:"dim",args:null,concreteType:"Vect2",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:Sn,storageKey:null},ug={alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"page_info",plural:!1,selections:[p_,m_],storageKey:null},cg=[{kind:"Literal",name:"first",value:400}],dg={alias:null,args:null,kind:"ScalarField",name:"is_custom_event_reportable",storageKey:null},mg={alias:null,args:null,kind:"ScalarField",name:"is_synced_with_smb",storageKey:null},pg={alias:null,args:null,kind:"ScalarField",name:"has_wa_contact",storageKey:null},_g=[{kind:"Literal",name:"first",value:2}],fg=[{alias:null,args:null,kind:"ScalarField",name:"nux_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"nux_content_text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"nux_ui_type",storageKey:null}],gg=[{alias:null,args:null,kind:"ScalarField",name:"passes_gk",storageKey:null}],hg={alias:null,args:[{kind:"Literal",name:"tab",value:"data_sharing"}],kind:"ScalarField",name:"settings_uri_in_business_view",storageKey:'settings_uri_in_business_view(tab:"data_sharing")'},yg={alias:null,args:null,kind:"ScalarField",name:"__token",storageKey:null},Cg=[{kind:"Literal",name:"first",value:5},{kind:"Literal",name:"types",value:["BUSINESS_ORDER"]}],bg={alias:null,args:null,kind:"ScalarField",name:"is_auto_detected",storageKey:null},vg={alias:null,args:null,kind:"ScalarField",name:"should_show_automated_activity_redesigned_nux",storageKey:null},Sg={alias:null,args:null,kind:"ScalarField",name:"is_classic_page",storageKey:null},Rg={alias:null,args:null,kind:"ScalarField",name:"is_detected_outcomes_label",storageKey:null},Lg={alias:null,args:cg,concreteType:"CustomLabelsConnection",kind:"LinkedField",name:"custom_labels",plural:!1,selections:[{alias:null,args:null,concreteType:"CustomLabelsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"BusinessPresenceCustomLabel",kind:"LinkedField",name:"node",plural:!1,selections:[w,O,Ns,ng,Ms,ws,As,dg,Rg,mg,pg,{alias:null,args:null,kind:"ScalarField",name:"is_immutable",storageKey:null},Ke],storageKey:null},rg],storageKey:null},__],storageKey:"custom_labels(first:400)"},Eg={alias:null,args:cg,filters:null,handle:"connection",key:"BizKitContextCardLabelsSection_custom_labels",kind:"LinkedHandle",name:"custom_labels"},kg={alias:null,args:cg,filters:null,handle:"connection",key:"BizKitContextCardLabelsSection_corp_labels",kind:"LinkedHandle",name:"corp_labels"},Ig={alias:null,args:null,concreteType:"BusinessPresenceNode",kind:"LinkedField",name:"business_presence_node",plural:!1,selections:q,storageKey:null},Tg=[{kind:"Literal",name:"gk_name",value:"mcom_kbank_integration_rollout"}],Dg=[{alias:"passes",args:null,kind:"ScalarField",name:"passes_gk",storageKey:null}],xg=[{kind:"Literal",name:"gk_name",value:"ctm_www_tas_order_integration_gk"}],$g=[{alias:"is_order_integration_enabled",args:null,kind:"ScalarField",name:"passes_gk",storageKey:null}],Pg=[{kind:"Literal",name:"gk_name",value:"ctm_www_tas_timeline_actions_gk"}],Ng=[{alias:"showTimelineActions",args:null,kind:"ScalarField",name:"passes_gk",storageKey:null}];return{fragment:{argumentDefinitions:[e,t,n,r,o,a,i,l,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T,D,x],kind:"Fragment",metadata:null,name:"BizInboxUnifiedThreadsQuery",selections:[$,{alias:null,args:P,concreteType:"XFBBizInboxUnifiedThreadList",kind:"LinkedField",name:"xfb_biz_inbox_unified_thread_list",plural:!1,selections:[{alias:null,args:null,concreteType:"ViewerMessageThreadsConnection",kind:"LinkedField",name:"msgr_threads",plural:!1,selections:ap,storageKey:null},{alias:null,args:null,concreteType:"ViewerMessageThreadsConnection",kind:"LinkedField",name:"wa_threads",plural:!1,selections:ap,storageKey:null},{alias:null,args:null,concreteType:"InstagramMessageThreadsConnection",kind:"LinkedField",name:"ig_threads",plural:!1,selections:[{alias:null,args:null,concreteType:"InstagramUserV2",kind:"LinkedField",name:"ig_user",plural:!1,selections:lp,storageKey:null},N,sp,{condition:"loadThreads",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"InstagramMessageThread",kind:"LinkedField",name:"nodes",plural:!0,selections:[up,cp,dp,mp,pp,_p,fp,gp,yp,Cp,bp,vp,Sp,Rp,Lp,Ep,kp,Ip,Du,xu,{condition:"loadThreadItems",kind:"Condition",passingValue:!0,selections:[{alias:null,args:ir,concreteType:"InstagramMessageThreadItemsConnection",kind:"LinkedField",name:"thread_items",plural:!1,selections:f_,storageKey:"thread_items(first:1)"}]}],storageKey:null},__]}],storageKey:null},{alias:null,args:null,concreteType:"XFBBizInboxSelectedThread",kind:"LinkedField",name:"selected_thread",plural:!1,selections:[g_,{alias:null,args:null,concreteType:"InstagramMessageThread",kind:"LinkedField",name:"selected_ig_thread",plural:!1,selections:[up,cp,dp,mp,pp,_p,fp,gp,yp,Cp,bp,vp,Sp,Rp,Lp,Ep,kp,Ip,Du,xu,{condition:"load_items",kind:"Condition",passingValue:!0,selections:[{alias:null,args:h_,concreteType:"InstagramMessageThreadItemsConnection",kind:"LinkedField",name:"thread_items",plural:!1,selections:f_,storageKey:null}]}],storageKey:null},{alias:null,args:null,concreteType:"MessageThread",kind:"LinkedField",name:"selected_message_thread",plural:!1,selections:[w,F,O,bl,vl,El,kl,Il,Tl,Dl,xl,Mt,$l,Pl,Nl,Ml,wl,Al,Fl,Ol,Bl,Wl,ql,Ul,Vl,Hl,Gl,Yl,is,ls,ss,us,cs,ps,Is,Ts,xs,Vs,zs,lu,hu,cu,yu,Cu,bu,vu,Su,Ru,Lu,Eu,Ou,Bu,Wu,qu,Zd,nm,rm,Ut,om,am,cm,dm,mm,pm,_m,fm,Zm,{condition:"load_messages",kind:"Condition",passingValue:!0,selections:[{alias:null,args:y_,concreteType:"MessagesOfThreadConnection",kind:"LinkedField",name:"messages",plural:!1,selections:[C_,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"nodes",plural:!0,selections:Jd,storageKey:null}],storageKey:null}]},{condition:"load_read_receipts",kind:"Condition",passingValue:!0,selections:[np]},b_],storageKey:null},{condition:"shouldUnifyContextCardQueries",kind:"Condition",passingValue:!0,selections:[{kind:"InlineDataFragmentSpread",name:"BizKitContextCardContainerDetailsFrag_selectedContact",selections:[{alias:null,args:S_,concreteType:"BizCRMContact",kind:"LinkedField",name:"selected_biz_crm_contact",plural:!1,selections:[{alias:null,args:null,concreteType:"BizCRMContactIdentity",kind:"LinkedField",name:"identity",plural:!1,selections:[R_],storageKey:null},{args:null,kind:"FragmentSpread",name:"BizKitContextCardContainer_contact"}],storageKey:null},{alias:null,args:S_,concreteType:"BizCRMContactCardConfig",kind:"LinkedField",name:"selected_biz_crm_contact_card_config",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"BizKitContextCard_config"}],storageKey:null}],args:null,argumentDefinitions:[L_]}]}],storageKey:null},k_],storageKey:null},T_,{condition:"shouldUnifyContextCardQueries",kind:"Condition",passingValue:!0,selections:[{kind:"InlineDataFragmentSpread",name:"BizKitContextCardActivitySectionFrag_activitiesquery",selections:[{alias:null,args:P,concreteType:"XFBBizInboxUnifiedThreadList",kind:"LinkedField",name:"xfb_biz_inbox_unified_thread_list",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBBizInboxSelectedThread",kind:"LinkedField",name:"selected_thread",plural:!1,selections:[{alias:null,args:S_,concreteType:"BizCRMContact",kind:"LinkedField",name:"selected_biz_crm_contact",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"BizKitContextCardActivitySection_contact"},{args:null,kind:"FragmentSpread",name:"BizKitContextCardActivityDropDown_contact"},{args:null,kind:"FragmentSpread",name:"BizKitContextCardActivityNuxForAutoDetected_contact"}],storageKey:null},D_],storageKey:null},{condition:"isDependencyOfRemovePageDependencyEnabledTool",kind:"Condition",passingValue:!1,selections:[{alias:null,args:S_,concreteType:"Page",kind:"LinkedField",name:"selected_page",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"BizKitContextCardActivityDropDown_page"},{args:null,kind:"FragmentSpread",name:"BizKitContextCardActivityListItem_page"}],storageKey:null}]}],storageKey:null},{condition:"isDependencyOfRemovePageDependencyEnabledTool",kind:"Condition",passingValue:!0,selections:[{alias:null,args:x_,concreteType:"XFBMBSBusinessAssets",kind:"LinkedField",name:"xfb_mbs_business_assets",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"BizKitContextCardActivityDropDown_mbsBusinessAssets"},{args:null,kind:"FragmentSpread",name:"BizKitContextCardActivityListItem_mbsBusinessAssets"}],storageKey:null}]}],args:null,argumentDefinitions:[{kind:"RootArgument",name:"businessAssets"},{kind:"RootArgument",name:"ig_params"},{kind:"RootArgument",name:"isDependencyOfRemovePageDependencyEnabledTool"},{kind:"RootArgument",name:"msgr_params"},L_,{kind:"RootArgument",name:"selected_item_id"},{kind:"RootArgument",name:"wa_params"}]}]}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[s,a,i,u,I,k,x,r,p,m,S,o,C,T,b,D,y,e,g,h,_,d,c,f,v,n,L,R,E,l,t],kind:"Operation",name:"BizInboxUnifiedThreadsQuery",selections:[$,{alias:null,args:P,concreteType:"XFBBizInboxUnifiedThreadList",kind:"LinkedField",name:"xfb_biz_inbox_unified_thread_list",plural:!1,selections:[{alias:null,args:null,concreteType:"ViewerMessageThreadsConnection",kind:"LinkedField",name:"msgr_threads",plural:!1,selections:jf,storageKey:null},{alias:null,args:null,concreteType:"ViewerMessageThreadsConnection",kind:"LinkedField",name:"wa_threads",plural:!1,selections:jf,storageKey:null},{alias:null,args:null,concreteType:"InstagramMessageThreadsConnection",kind:"LinkedField",name:"ig_threads",plural:!1,selections:[{alias:null,args:null,concreteType:"InstagramUserV2",kind:"LinkedField",name:"ig_user",plural:!1,selections:Kf,storageKey:null},N,sp,{condition:"loadThreads",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"InstagramMessageThread",kind:"LinkedField",name:"nodes",plural:!0,selections:[up,cp,dp,mp,pp,_p,fp,gp,yp,Cp,bp,vp,Sp,Rp,Lp,Ep,kp,Ip,Du,xu,{condition:"loadThreadItems",kind:"Condition",passingValue:!0,selections:[{alias:null,args:ir,concreteType:"InstagramMessageThreadItemsConnection",kind:"LinkedField",name:"thread_items",plural:!1,selections:Jf,storageKey:"thread_items(first:1)"}]},w],storageKey:null},__]}],storageKey:null},{alias:null,args:null,concreteType:"XFBBizInboxSelectedThread",kind:"LinkedField",name:"selected_thread",plural:!1,selections:[g_,{alias:null,args:null,concreteType:"InstagramMessageThread",kind:"LinkedField",name:"selected_ig_thread",plural:!1,selections:[up,cp,dp,mp,pp,_p,fp,gp,yp,Cp,bp,vp,Sp,Rp,Lp,Ep,kp,Ip,Du,xu,{condition:"load_items",kind:"Condition",passingValue:!0,selections:[{alias:null,args:h_,concreteType:"InstagramMessageThreadItemsConnection",kind:"LinkedField",name:"thread_items",plural:!1,selections:Jf,storageKey:null}]},w],storageKey:null},{alias:null,args:null,concreteType:"MessageThread",kind:"LinkedField",name:"selected_message_thread",plural:!1,selections:[w,F,O,hf,vl,yf,kl,Il,Dl,xl,Mt,$l,Pl,Nl,Ml,wl,Al,Fl,Ol,Bl,Wl,ql,Ul,Vl,Hl,Gl,Cf,bf,vf,ss,us,cs,Sf,Rf,Ts,xs,Lf,Ef,kf,If,cu,yu,Cu,bu,vu,Su,Ru,Lu,Eu,Tf,Bu,Wu,Df,Bf,Wf,Ut,om,am,qf,dm,mm,pm,_m,fm,Hf,Tl,zf,{condition:"load_messages",kind:"Condition",passingValue:!0,selections:[{alias:null,args:y_,concreteType:"MessagesOfThreadConnection",kind:"LinkedField",name:"messages",plural:!1,selections:[C_,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"nodes",plural:!0,selections:Of,storageKey:null}],storageKey:null}]},{condition:"load_read_receipts",kind:"Condition",passingValue:!0,selections:[Gf]},b_],storageKey:null},{condition:"shouldUnifyContextCardQueries",kind:"Condition",passingValue:!0,selections:[{alias:null,args:S_,concreteType:"BizCRMContact",kind:"LinkedField",name:"selected_biz_crm_contact",plural:!1,selections:[{alias:null,args:null,concreteType:"BizCRMContactIdentity",kind:"LinkedField",name:"identity",plural:!1,selections:[R_,K,{alias:null,args:null,kind:"ScalarField",name:"contact_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sub_business_id",storageKey:null}],storageKey:null},w,{alias:null,args:null,concreteType:"BizCRMContactSharedAttributes",kind:"LinkedField",name:"shared_attributes",plural:!1,selections:[Zf,{alias:null,args:null,concreteType:"BizCRMContactProfile",kind:"LinkedField",name:"profile",plural:!1,selections:[Ac,{alias:null,args:null,kind:"ScalarField",name:"first_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"full_name",storageKey:null},{alias:null,args:null,concreteType:"PageContactProfileURI",kind:"LinkedField",name:"profile_uris",plural:!0,selections:re,storageKey:null},{alias:null,args:eg,concreteType:"PageContactProfilePhotoURI",kind:"LinkedField",name:"profile_photo_uris_prefetch",plural:!0,selections:re,storageKey:"profile_photo_uris_prefetch(height:52,width:52)"},{alias:null,args:null,kind:"ScalarField",name:"last_name",storageKey:null},{alias:"profile_photo_uri_about_section",args:[{kind:"Literal",name:"height",value:100},{kind:"Literal",name:"width",value:100}],concreteType:"PageContactProfilePhotoURI",kind:"LinkedField",name:"profile_photo_uris",plural:!0,selections:re,storageKey:"profile_photo_uris(height:100,width:100)"},{alias:null,args:null,kind:"ScalarField",name:"address",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"city_name",storageKey:null},Gu,{alias:"phone",args:null,concreteType:"PhoneNumber",kind:"LinkedField",name:"phone_number",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"region_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"national_number",storageKey:null},{alias:"phoneNumber",args:null,kind:"ScalarField",name:"display_number",storageKey:null}],storageKey:null},_o,{alias:null,args:null,kind:"ScalarField",name:"zip_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null},{alias:null,args:null,concreteType:"PageContactBirthday",kind:"LinkedField",name:"birthday",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"day",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"month",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"formatted_birthday",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"suggested_email_address",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fallback_phone_number",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"city_state",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ban_action_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_banned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_blocked",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_wec_blocked",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_onsite_user",storageKey:null},Tu,{alias:null,args:tg,concreteType:"BizCRMContactSharedAttributesCorpLabelListConnection",kind:"LinkedField",name:"corp_label_list",plural:!1,selections:[{alias:null,args:null,concreteType:"BizCRMContactSharedAttributesCorpLabelListEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"BusinessPresenceCorporationLabel",kind:"LinkedField",name:"node",plural:!1,selections:[w,O,Ns,ws,ng,Ms,Ws,qs,As,Ke],storageKey:null},rg],storageKey:null},__,og],storageKey:"corp_label_list(first:20)"},{alias:null,args:tg,filters:null,handle:"connection",key:"BizKitContextCard_corp_label_list",kind:"LinkedHandle",name:"corp_label_list"},{alias:null,args:tg,concreteType:"BizCRMContactSharedAttributesSuggestedLabelsConnection",kind:"LinkedField",name:"suggested_labels",plural:!1,selections:[{alias:null,args:null,concreteType:"BizCRMContactSharedAttributesSuggestedLabelsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[Ke,w,O,Ns,{kind:"InlineFragment",selections:[Ec,dl,{alias:null,args:null,kind:"ScalarField",name:"upsell",storageKey:null}],type:"BusinessPresenceDerivedLabel",abstractKey:null}],storageKey:null},rg],storageKey:null},__,og],storageKey:"suggested_labels(first:20)"},{alias:null,args:tg,filters:null,handle:"connection",key:"BizKitContextCard_suggested_labels",kind:"LinkedHandle",name:"suggested_labels"},{alias:null,args:null,kind:"ScalarField",name:"is_guest_chat",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBBizCRMContactIGIDs",kind:"LinkedField",name:"ig_ids",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ig_id_v2",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ig_eimu_id",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"BizCRMContactIGAttributes",kind:"LinkedField",name:"ig_attributes",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ig_user_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ig_thread_id",storageKey:null},{alias:null,args:null,concreteType:"BizCRMContactIGUserProfileUnit",kind:"LinkedField",name:"profile_units",plural:!0,selections:[ag,G],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"BizCRMContactFBAttributes",kind:"LinkedField",name:"fb_attributes",plural:!1,selections:[$d,{alias:null,args:null,concreteType:"BizCRMContactFBUserProfileUnit",kind:"LinkedField",name:"profile_units",plural:!0,selections:[{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,concreteType:"EntityAtRange",kind:"LinkedField",name:"ranges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"entity",plural:!1,selections:[Ke,ae,nl,af],storageKey:null},lt,ni],storageKey:null},G],storageKey:null},ag],storageKey:null},{alias:null,args:null,concreteType:"BizCRMContactMessengerThreadAttribute",kind:"LinkedField",name:"messenger_thread",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageThread",kind:"LinkedField",name:"one_to_one_thread",plural:!1,selections:[{alias:"sharedMedia",args:ig,concreteType:"MessageSharedMediaConnection",kind:"LinkedField",name:"message_shared_media",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageSharedMediaEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[Ke,{kind:"TypeDiscriminator",abstractKey:"__isMessageSharedMedia"},nl,{kind:"InlineFragment",selections:[lg,Mt,sg],type:"MessageImage",abstractKey:null},{kind:"InlineFragment",selections:[lg,Mt,sg,he],type:"MessageVideo",abstractKey:null}],storageKey:null},rg],storageKey:null},ug],storageKey:'message_shared_media(first:4,message_shared_media_type:"PHOTO_AND_VIDEO")'},{alias:"sharedMedia",args:ig,filters:["message_shared_media_type"],handle:"connection",key:"BizKitContextCardSharedPhotos_sharedMedia",kind:"LinkedHandle",name:"message_shared_media"},w],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"BizCRMContactBusinessAttributes",kind:"LinkedField",name:"business_attributes",plural:!1,selections:[{alias:null,args:null,concreteType:"BizCRMContactCommunicationPreference",kind:"LinkedField",name:"communication_preference",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email_subscription_status",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"BizCRMContactMessageLabelAttribute",kind:"LinkedField",name:"customer_labels",plural:!1,selections:[{alias:null,args:cg,concreteType:"BizCRMContactMessageLabelAttributeLabelListConnection",kind:"LinkedField",name:"label_list",plural:!1,selections:[{alias:null,args:null,concreteType:"BizCRMContactMessageLabelAttributeLabelListEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"BusinessPresenceCustomLabel",kind:"LinkedField",name:"node",plural:!1,selections:[w,O,Ns,ng,Ms,ws,As,dg,mg,pg,Ke],storageKey:null},rg],storageKey:null},__,og],storageKey:"label_list(first:400)"},{alias:null,args:cg,filters:null,handle:"connection",key:"Contact_customer_label_list",kind:"LinkedHandle",name:"label_list"},{alias:null,args:null,concreteType:"BizCRMContactMessageLabelAttributeCustomerCustomTagsConnection",kind:"LinkedField",name:"customer_custom_tags",plural:!1,selections:[{alias:null,args:null,concreteType:"BizCRMContactMessageLabelAttributeCustomerCustomTagsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PageCustomTag",kind:"LinkedField",name:"node",plural:!1,selections:Os,storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"BizCRMContactAdminNotesAttribute",kind:"LinkedField",name:"admin_notes",plural:!1,selections:[{alias:null,args:_g,concreteType:"BizCRMContactAdminNotesAttributeNotesListConnection",kind:"LinkedField",name:"notes_list",plural:!1,selections:[{alias:null,args:null,concreteType:"BizCRMContactAdminNotesAttributeNotesListEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PageAdminNote",kind:"LinkedField",name:"node",plural:!1,selections:[w,{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"body",plural:!1,selections:z,storageKey:null},Ki,{alias:null,args:null,kind:"ScalarField",name:"note_label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"action_source_type",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"underlying_admin_creator",plural:!1,selections:[Ke,O,w],storageKey:null},Ke],storageKey:null},rg],storageKey:null},ug,og],storageKey:"notes_list(first:2)"},{alias:null,args:_g,filters:null,handle:"connection",key:"BizKitContextCard_notes_list",kind:"LinkedHandle",name:"notes_list"}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"BizCRMContactWAAttributes",kind:"LinkedField",name:"wa_attributes",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"wa_customer_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"opt_in_status",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"should_enable_ads_consent_in_ctwa",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"should_show_wa_automated_label_nux",storageKey:null},{alias:"adsDataSharingLabelsNUX",args:[{kind:"Literal",name:"mbs_ads_event_sharing_event_type",value:"LABEL_CREATION_WA"}],concreteType:"XFBMBSAdsEventSharingNux",kind:"LinkedField",name:"mbs_ads_event_sharing_eligible_nux_types",plural:!0,selections:fg,storageKey:'mbs_ads_event_sharing_eligible_nux_types(mbs_ads_event_sharing_event_type:"LABEL_CREATION_WA")'},{alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"page",plural:!1,selections:[{alias:null,args:[{kind:"Literal",name:"gk_name",value:"ctm_custom_label_reporting_pages"}],concreteType:"EntGKCheck",kind:"LinkedField",name:"gk_check",plural:!1,selections:gg,storageKey:'gk_check(gk_name:"ctm_custom_label_reporting_pages")'},hg,w,{alias:null,args:null,kind:"ScalarField",name:"is_p2m_lite_payment_onboarded",storageKey:null},{alias:null,args:[{kind:"Literal",name:"tab",value:"DATA_SHARING"}],kind:"ScalarField",name:"wa_settings_uri_in_business_view",storageKey:'wa_settings_uri_in_business_view(tab:"DATA_SHARING")'},{alias:null,args:null,concreteType:"WhatsAppBusinessAccount",kind:"LinkedField",name:"linked_whatsapp_business_account",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"has_consented_to_ctwa_data_sharing",storageKey:null},w],storageKey:null}],storageKey:null},yg,{alias:null,args:null,concreteType:"BizCRMContactBusinessActions",kind:"LinkedField",name:"business_actions",plural:!1,selections:[{alias:null,args:Cg,concreteType:"BizCRMContactBusinessActionsActionsConnection",kind:"LinkedField",name:"actions",plural:!1,selections:[{alias:null,args:null,concreteType:"BizCRMContactBusinessActionsActionsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[Ke,{alias:null,args:null,concreteType:"BizCRMContactAction3DWrapper",kind:"LinkedField",name:"wrapper",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"contact_action",plural:!1,selections:[Ke,Ki,mt,K,To,{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"descriptions",plural:!0,selections:z,storageKey:null},Ne,{alias:null,args:null,kind:"ScalarField",name:"click_url",storageKey:null},ct,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"invoice_id",storageKey:null},Ad,bg],type:"BizCRMContactAdAction",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Story",kind:"LinkedField",name:"story",plural:!1,selections:q,storageKey:null}],type:"BizCRMContactFacebookActionWithStory",abstractKey:null},{kind:"InlineFragment",selections:[Ad,Ms,bg,{alias:null,args:null,kind:"ScalarField",name:"show_ad_icon",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"data_silo_auto_detected_activity",storageKey:null}],type:"BizCRMContactCustomAction",abstractKey:null},{kind:"InlineFragment",selections:[Ms],type:"BizCRMContactBusinessOrderAction",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null},rg],storageKey:null},ug],storageKey:'actions(first:5,types:["BUSINESS_ORDER"])'},{alias:null,args:Cg,filters:["types"],handle:"connection",key:"BizKitContextCardOrders__actions",kind:"LinkedHandle",name:"actions"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"should_show_mbs_ads_consent_upsell_in_inbox_at_thread_entry",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"should_show_mbs_ads_event_sharing_consent_at_thread_entry",storageKey:null},{alias:null,args:null,concreteType:"XFBMBSAdsEventSharingSettings",kind:"LinkedField",name:"mbs_ads_event_sharing_settings",plural:!1,selections:[w,{alias:null,args:null,kind:"ScalarField",name:"ads_event_sharing_business_opt_in_status",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ads_event_sharing_consumer_opt_in_status",storageKey:null}],storageKey:null},{alias:null,args:[{kind:"Literal",name:"mbs_ads_event_sharing_event_type",value:"DETECTED_ACTIVITY_ON_THREAD_ENTRY"}],concreteType:"XFBMBSAdsEventSharingNux",kind:"LinkedField",name:"mbs_ads_event_sharing_eligible_nux_types",plural:!0,selections:fg,storageKey:'mbs_ads_event_sharing_eligible_nux_types(mbs_ads_event_sharing_event_type:"DETECTED_ACTIVITY_ON_THREAD_ENTRY")'},vg,{alias:null,args:null,kind:"ScalarField",name:"has_consented_to_contact_card_tos",storageKey:null},{condition:"isDependencyOfRemovePageDependencyEnabledTool",kind:"Condition",passingValue:!1,selections:[{alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"page",plural:!1,selections:[Sg],storageKey:null}]},{condition:"isDependencyOfRemovePageDependencyEnabledTool",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"XFBMBSBusinessAssets",kind:"LinkedField",name:"mbs_business_assets",plural:!1,selections:[Sg,w],storageKey:null}]},{condition:"shouldSkipMessage",kind:"Condition",passingValue:!1,selections:[{alias:null,args:null,concreteType:"BizCRMContactSharedAttributes",kind:"LinkedField",name:"shared_attributes",plural:!1,selections:[{alias:null,args:null,concreteType:"BizCRMContactProfile",kind:"LinkedField",name:"profile",plural:!1,selections:[{alias:null,args:eg,concreteType:"PageContactProfilePhotoURI",kind:"LinkedField",name:"profile_photo_uris",plural:!0,selections:re,storageKey:"profile_photo_uris(height:52,width:52)"}],storageKey:null},{alias:null,args:null,concreteType:"PageContactCTAType",kind:"LinkedField",name:"contact_ctas",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"cta_type",storageKey:null}],storageKey:null}],storageKey:null}]},{condition:"shouldSkipPageQuery",kind:"Condition",passingValue:!1,selections:[{alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"page",plural:!1,selections:[Lg,Eg,{alias:null,args:cg,concreteType:"PageCorpLabelsConnection",kind:"LinkedField",name:"corp_labels",plural:!1,selections:[{alias:null,args:null,concreteType:"PageCorpLabelsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"BusinessPresenceCorporationLabel",kind:"LinkedField",name:"node",plural:!1,selections:[w,O,Ns,ws,ng,Ms,Ws,qs,As,Rg,Ke],storageKey:null},rg],storageKey:null},__],storageKey:"corp_labels(first:400)"},kg,{alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"if_viewer_can_manage_permissions",plural:!1,selections:$_,storageKey:null},Ig,{alias:"is_in_kbank_rollout",args:Tg,concreteType:"EntGKCheck",kind:"LinkedField",name:"gk_check",plural:!1,selections:Dg,storageKey:'gk_check(gk_name:"mcom_kbank_integration_rollout")'},{alias:"show_payment_onboarding_context_card",args:[{kind:"Literal",name:"gk_name",value:"messenger_p2m_lite_merchant_onboarding"}],concreteType:"EntGKCheck",kind:"LinkedField",name:"gk_check",plural:!1,selections:gg,storageKey:'gk_check(gk_name:"messenger_p2m_lite_merchant_onboarding")'}],storageKey:null},{condition:"isDependencyOfRemovePageDependencyEnabledTool",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"XFBMBSBusinessAssets",kind:"LinkedField",name:"mbs_business_assets",plural:!1,selections:[Lg,Eg,{alias:null,args:cg,concreteType:"XFBMBSBusinessAssetsCorpLabelsConnection",kind:"LinkedField",name:"corp_labels",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBMBSBusinessAssetsCorpLabelsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"BusinessPresenceCorporationLabel",kind:"LinkedField",name:"node",plural:!1,selections:[w,O,Ns,ng,Ms,ws,Ws,qs,As,Rg,Ke],storageKey:null},rg],storageKey:null},__],storageKey:"corp_labels(first:400)"},kg,{alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"page_if_viewer_can_manage_permissions",plural:!1,selections:$_,storageKey:null},Ig,{alias:"is_in_kbank_rollout",args:Tg,concreteType:"EntGKCheck",kind:"LinkedField",name:"gk_check_page",plural:!1,selections:Dg,storageKey:'gk_check_page(gk_name:"mcom_kbank_integration_rollout")'}],storageKey:null}]}]}],storageKey:null},{alias:null,args:S_,concreteType:"BizCRMContactCardConfig",kind:"LinkedField",name:"selected_biz_crm_contact_card_config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"sections",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"permission",storageKey:null}],storageKey:null}]}],storageKey:null},k_],storageKey:null},T_,{condition:"shouldUnifyContextCardQueries",kind:"Condition",passingValue:!0,selections:[{alias:null,args:P,concreteType:"XFBBizInboxUnifiedThreadList",kind:"LinkedField",name:"xfb_biz_inbox_unified_thread_list",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBBizInboxSelectedThread",kind:"LinkedField",name:"selected_thread",plural:!1,selections:[{alias:null,args:S_,concreteType:"BizCRMContact",kind:"LinkedField",name:"selected_biz_crm_contact",plural:!1,selections:[{alias:null,args:null,concreteType:"BizCRMContactAllActions",kind:"LinkedField",name:"all_actions",plural:!1,selections:[{alias:null,args:_g,concreteType:"BizCRMContactAllActionsActionsConnection",kind:"LinkedField",name:"actions",plural:!1,selections:[{alias:null,args:null,concreteType:"BizCRMContactAllActionsActionsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[Ke,{alias:"codeSplitWrapper",args:null,concreteType:"BizCRMContactAction3DWrapper",kind:"LinkedField",name:"wrapper",plural:!1,selections:[{args:null,documentName:"BizKitContextCardActivityListItem3DWrapper_BizCRMContactAction3DWrapper",fragmentName:"BizKitContextCardActivityListItem_node",fragmentPropName:"node",kind:"ModuleImport"}],storageKey:null}],storageKey:null},rg],storageKey:null},ug,og],storageKey:"actions(first:2)"},{alias:null,args:_g,filters:null,handle:"connection",key:"BizKitContextCardActivityList_actions",kind:"LinkedHandle",name:"actions"},{alias:"interaction_count",args:null,concreteType:"BizCRMContactAllActionsActionsConnection",kind:"LinkedField",name:"actions",plural:!1,selections:pu,storageKey:null}],storageKey:null},w,yg,{alias:null,args:null,concreteType:"BizCRMContactFBAttributes",kind:"LinkedField",name:"fb_attributes",plural:!1,selections:[$d],storageKey:null},{alias:null,args:null,concreteType:"BizCRMContactSharedAttributes",kind:"LinkedField",name:"shared_attributes",plural:!1,selections:[Zf],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"should_show_automated_activity_nux",storageKey:null},vg,{alias:"adsDataSharingActivityNUX",args:[{kind:"Literal",name:"mbs_ads_event_sharing_event_type",value:"ACTIVITY"}],concreteType:"XFBMBSAdsEventSharingNux",kind:"LinkedField",name:"mbs_ads_event_sharing_eligible_nux_types",plural:!0,selections:fg,storageKey:'mbs_ads_event_sharing_eligible_nux_types(mbs_ads_event_sharing_event_type:"ACTIVITY")'},{alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"page",plural:!1,selections:[hg,w,{alias:"two_step_do_nux_tour_gk",args:[{kind:"Literal",name:"gk_name",value:"two_step_do_nux_tour"}],concreteType:"EntGKCheck",kind:"LinkedField",name:"gk_check",plural:!1,selections:gg,storageKey:'gk_check(gk_name:"two_step_do_nux_tour")'}],storageKey:null},{alias:"adsDataSharingDetectedActivityNUX",args:[{kind:"Literal",name:"mbs_ads_event_sharing_event_type",value:"DETECTED_ACTIVITY"}],concreteType:"XFBMBSAdsEventSharingNux",kind:"LinkedField",name:"mbs_ads_event_sharing_eligible_nux_types",plural:!0,selections:fg,storageKey:'mbs_ads_event_sharing_eligible_nux_types(mbs_ads_event_sharing_event_type:"DETECTED_ACTIVITY")'}],storageKey:null},D_],storageKey:null},{condition:"isDependencyOfRemovePageDependencyEnabledTool",kind:"Condition",passingValue:!1,selections:[{alias:null,args:S_,concreteType:"Page",kind:"LinkedField",name:"selected_page",plural:!1,selections:[{alias:"ctm_www_tas_order_integration_gk",args:xg,concreteType:"EntGKCheck",kind:"LinkedField",name:"gk_check",plural:!1,selections:$g,storageKey:'gk_check(gk_name:"ctm_www_tas_order_integration_gk")'},{alias:"translationFix",args:[{kind:"Literal",name:"qe_universe",value:"tas_bizweb_translation_fix_universe"}],concreteType:"QECheck",kind:"LinkedField",name:"qe_check",plural:!1,selections:[{alias:"is_enabled",args:[{kind:"Literal",name:"bool_default",value:!1},{kind:"Literal",name:"param_name",value:"has_string_translation"}],kind:"ScalarField",name:"bool",storageKey:'bool(bool_default:false,param_name:"has_string_translation")'}],storageKey:'qe_check(qe_universe:"tas_bizweb_translation_fix_universe")'},{alias:"timelineActionsCheck",args:Pg,concreteType:"EntGKCheck",kind:"LinkedField",name:"gk_check",plural:!1,selections:Ng,storageKey:'gk_check(gk_name:"ctm_www_tas_timeline_actions_gk")'},w],storageKey:null}]}],storageKey:null},{condition:"isDependencyOfRemovePageDependencyEnabledTool",kind:"Condition",passingValue:!0,selections:[{alias:null,args:x_,concreteType:"XFBMBSBusinessAssets",kind:"LinkedField",name:"xfb_mbs_business_assets",plural:!1,selections:[{alias:"ctm_www_tas_order_integration_gk",args:xg,concreteType:"EntGKCheck",kind:"LinkedField",name:"gk_check_page",plural:!1,selections:$g,storageKey:'gk_check_page(gk_name:"ctm_www_tas_order_integration_gk")'},{alias:"timelineActionsCheck",args:Pg,concreteType:"EntGKCheck",kind:"LinkedField",name:"gk_check_page",plural:!1,selections:Ng,storageKey:'gk_check_page(gk_name:"ctm_www_tas_timeline_actions_gk")'},w],storageKey:null}]}]}]},params:{id:"25558570493812019",metadata:{},name:"BizInboxUnifiedThreadsQuery",operationKind:"query",text:null}}})();n("relay-runtime").PreloadableQueryRegistry.set(e.params.id,e),a.exports=e}),null);/*FB_PKG_DELIM*/
__d("CometTahoeCustomVideoAreaContext",["emptyFunction","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e,c=u.useMemo,d=u.useState,m=s.createContext({customVideoAreaHidden:!0,setCustomVideoAreaHidden:r("emptyFunction")});function p(e){var t=o("react-compiler-runtime").c(5),n=e.children,r=d(!0),a=r[0],i=r[1],l;t[0]!==a?(l={customVideoAreaHidden:a,setCustomVideoAreaHidden:i},t[0]=a,t[1]=l):l=t[1];var u=l,c;return t[2]!==n||t[3]!==u?(c=s.jsx(m.Provider,{value:u,children:n}),t[2]=n,t[3]=u,t[4]=c):c=t[4],c}l.CometTahoeCustomVideoAreaContext=m,l.CometTahoeCustomVideoAreaContextProvider=p}),98);
__d("CometTahoeSidePaneContext",["react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u={rightRailExpanded:!1,rightRailHidden:!1,setRightRailExpanded:function(){},setRightRailHidden:function(){}},c=s.createContext(u);l.default=c}),98);
__d("CometVideoPictureInPictureManager.react",["CometSetWatchAndScrollVideoContext","CometVideoPictureInPictureManagerContext","CometWatchAndScrollVideoContext","XCometWatchControllerRouteBuilder","clearTimeout","gkx","react","requireDeferred","setTimeout","useCometRouterDispatcher","useMinifiedProductAttribution"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e,c=u.useCallback,d=u.useContext,m=u.useEffect,p=u.useMemo,_=u.useRef,f=u.useState,g=r("requireDeferred")("VideoHomeTypedLiteLogger").__setRef("CometVideoPictureInPictureManager.react"),h=r("gkx")("22889"),y=50,C=["286211568997787","214604021960500","108677131037"],b=window.document.pictureInPictureEnabled;function v(e){var t=e.children,n=e.isPipEnabled,a=r("useCometRouterDispatcher")(),i=n,l=f(null),u=l[0],C=l[1],v=f(!1),S=v[0],R=v[1],L=f(!1),E=L[0],k=L[1],I=_(!1),T=c(function(e){I.current=e},[]),D=p(function(){return{hasNextChainedVideo:E,isPipEnabled:i,setHasNextChainedVideo:k,setSkippedFromPipPlayer:R,skippedFromPipPlayer:S}},[S,R,E,k,i]),x=f(null),$=x[0],P=x[1],N=d(r("CometWatchAndScrollVideoContext")),M=d(r("CometSetWatchAndScrollVideoContext")),w=_(null),A=_(null),F=r("useMinifiedProductAttribution")(),O=c(function(e){e===void 0&&(e=null),g.onReady(function(t){t.log({attribution_id_v2:F,click_point:e,event:"click"})})},[]),B=c(function(){var e=N==null?void 0:N.videoID,t=N==null?void 0:N.videoUrl;if(e!=null&&t!=null){var n=N==null?void 0:N.routeTracePolicy,o=N==null?void 0:N.subOrigin,i=h?t:r("XCometWatchControllerRouteBuilder").buildURL({v:e});a&&(a.go(i,{passthroughProps:{portableVideoID:$,portalingRouteTracePolicy:n,portalingSubOrigin:o}}),M(null))}},[a,N,$,M]),W=c(function(){u!=null&&(w.current=r("setTimeout")(function(){var e=u.getCurrentState(),t=e.lastPauseReason,n=e.paused;I.current||(i&&(n===!1||n===!0&&t==="product_initiated")?(B(),O("control_pip_player_return_to_tab")):window.document.pictureInPictureElement===null&&(M(null),O("control_pip_player_close")))},y))},[u,i,B,M,O]),q=c(function(){u!=null&&(I.current||(window.navigator.mediaSession.setActionHandler("play",null),window.navigator.mediaSession.setActionHandler("pause",null),window.navigator.mediaSession.setActionHandler("pause",function(){u.pause("product_initiated")})),E||window.navigator.mediaSession.setActionHandler("nexttrack",null))},[u,E,O,T]),U=c(function(e){e.requestPictureInPicture(),X(!1);var t=e.internal_getVideoElement();A.current=t==null?void 0:t.currentSrc},[]),V=c(function(){if(u!=null){var e=u.getIsDesktopPictureInPicture();if(e){u.exitPictureInPicture();return}U(u)}},[U,u]),H=c(function(e){C(e)},[C]),G=c(function(e){e!=null&&P(e)},[P]),z=p(function(){return{openPipPlayer:V,setController:H,setPipPortableVideoID:G}},[V,H,G]),j=_(!1),K=f(!1),Q=K[0],X=K[1];return m(function(){var e=null;if(b&&u!=null&&window.document.pictureInPictureElement){var t=u.internal_getVideoElement(),n=t==null?void 0:t.currentSrc,r=!1,o=!1;e=u.subscribe(function(){var e=u.getCurrentState(),t=e.playing,n=e.isDesktopPictureInPicture;!r&&t&&j.current&&!I.current&&(j.current=!1,X(!0)),o&&!n&&W(),!o&&n&&q(),r=t,o=n}),n!==A.current?Q?U(u):(u.play("user_initiated"),j.current=!0):i&&(q(),A.current=n)}return function(){e!=null&&e.remove()}},[U,u,V,E,q,W,i,Q]),m(function(){return function(){w.current!=null&&(r("clearTimeout")(w.current),w.current=null)}},[]),s.jsx(o("CometVideoPictureInPictureManagerContext").CometVideoPictureInPictureManagerContext.Provider,{value:D,children:s.jsx(o("CometVideoPictureInPictureManagerContext").CometVideoPictureInPictureManagerAPIContext.Provider,{value:z,children:t})})}v.displayName=v.name+" [from "+i.id+"]",l.EXCLUDED_PROVIDERS=C,l.CometVideoPictureInPictureManager=v}),98);
__d("useLiveCostreamerTagSubscription_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="33268408866139223"}),null);
__d("useLiveCostreamerTagSubscription.graphql",["VideoPlayerRelay_video$normalization.graphql","useLiveCostreamerTagSubscription_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{kind:"Variable",name:"data",variableName:"input"}],r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},o=[r],a={alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"tagged_page",plural:!1,selections:[r,{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"currently_live_video",plural:!1,selections:o,storageKey:null}],storageKey:null},i={args:null,documentName:"useLiveCostreamerTagSubscription",fragmentName:"VideoPlayerCostreamingControl_video",fragmentPropName:"video",kind:"ModuleImport"},l={alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"video",plural:!1,selections:[r,{alias:null,args:null,concreteType:"VideoLiveCostreamingStreamersConnection",kind:"LinkedField",name:"live_costreaming_streamers",plural:!1,selections:[{alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"nodes",plural:!0,selections:o,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"count",storageKey:null}],storageKey:null}],storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},u=[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"useLiveCostreamerTagSubscription",selections:[{alias:null,args:t,concreteType:"LiveVideoTagSubscribeResponsePayload",kind:"LinkedField",name:"live_video_tag_subscribe",plural:!1,selections:[a,{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"tagged_video",plural:!1,selections:[r,{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"if_viewer_can_see_costreaming_tools",plural:!1,selections:[i],storageKey:null},{alias:null,args:null,concreteType:"VideoLiveCostreamingStreamersConnection",kind:"LinkedField",name:"live_costreaming_streamers",plural:!1,selections:[{alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"nodes",plural:!0,selections:[{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"currently_live_video",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"CometVideoPlayerCostreamingThumbnailRowInner_video"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},l],storageKey:null}],type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"useLiveCostreamerTagSubscription",selections:[{alias:null,args:t,concreteType:"LiveVideoTagSubscribeResponsePayload",kind:"LinkedField",name:"live_video_tag_subscribe",plural:!1,selections:[a,{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"tagged_video",plural:!1,selections:[r,{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"if_viewer_can_see_costreaming_tools",plural:!1,selections:[i,r],storageKey:null},{alias:null,args:null,concreteType:"VideoLiveCostreamingStreamersConnection",kind:"LinkedField",name:"live_costreaming_streamers",plural:!1,selections:[{alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"nodes",plural:!0,selections:[{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"currently_live_video",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"video_channel",plural:!1,selections:[s,r],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"owner",plural:!1,selections:[s,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:u,storageKey:null},r],storageKey:null},{args:null,fragment:n("VideoPlayerRelay_video$normalization.graphql"),kind:"FragmentSpread"},{alias:null,args:null,concreteType:"VideoThumbnail",kind:"LinkedField",name:"preferred_thumbnail",plural:!1,selections:[{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:u,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"image_preview_payload",storageKey:null},r],storageKey:null}],storageKey:null},r],storageKey:null}],storageKey:null}],storageKey:null},l],storageKey:null}]},params:{id:n("useLiveCostreamerTagSubscription_facebookRelayOperation"),metadata:{subscriptionName:"live_video_tag_subscribe"},name:"useLiveCostreamerTagSubscription",operationKind:"subscription",text:null}}})();a.exports=e}),null);
__d("useLiveCostreamerTagSubscription.react",["CometRelay","react","react-compiler-runtime","useLiveCostreamerTagSubscription.graphql","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(s||(s=o("react"))).useMemo;function c(t,a,i){var l=o("react-compiler-runtime").c(8),s;l[0]===Symbol.for("react.memo_cache_sentinel")?(s=e!==void 0?e:e=n("useLiveCostreamerTagSubscription.graphql"),l[0]=s):s=l[0];var u=s,c;l[1]===Symbol.for("react.memo_cache_sentinel")?(c=r("uuidv4")(),l[1]=c):c=l[1];var m;l[2]!==t||l[3]!==a?(m={input:{client_subscription_id:c,tagged_page_id:t,tagged_video_id:a}},l[2]=t,l[3]=a,l[4]=m):m=l[4];var p=m,_;l[5]!==i||l[6]!==p?(_={onNext:i,subscription:u,updater:d,variables:p},l[5]=i,l[6]=p,l[7]=_):_=l[7];var f=_;o("CometRelay").useSubscription(f)}function d(e){var t,n=e.getRootField("live_video_tag_subscribe"),r=n==null||(t=n.getLinkedRecord("tagged_page"))==null?void 0:t.getLinkedRecord("currently_live_video"),o=n==null?void 0:n.getLinkedRecord("tagged_video");r==null&&o!=null&&o.setValue(null,"if_viewer_can_see_costreaming_tools")}l.default=c}),98);
__d("LiveCostreamerTagSubscription.react",["useLiveCostreamerTagSubscription.react"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.onNext,n=e.pageID,o=e.videoID;return r("useLiveCostreamerTagSubscription.react")(n,o,t),null}l.default=e}),98);
__d("LiveVideoLatencyMenuContextProvider_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"LiveVideoLatencyMenuContextProvider_video",selections:[{kind:"RequiredField",field:{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"if_viewer_can_use_latency_menu",plural:!1,selections:[{args:null,documentName:"LiveVideoLatencyMenuContextProvider_video_if_viewer_can_use_latency_menu",fragmentName:"VideoPlayerSettingsMenuLatencyPane_video",fragmentPropName:"video",kind:"ModuleImport"}],storageKey:null},action:"NONE",path:"if_viewer_can_use_latency_menu"},{kind:"RequiredField",field:{alias:"if_viewer_can_use_latency_menu_toggle",args:null,concreteType:"Video",kind:"LinkedField",name:"if_viewer_can_use_latency_menu",plural:!1,selections:[{args:null,documentName:"LiveVideoLatencyMenuContextProvider_video_if_viewer_can_use_latency_menu_toggle",fragmentName:"VideoPlayerSettingsMenuLatencyPaneToggle_video",fragmentPropName:"video",kind:"ModuleImport"}],storageKey:null},action:"NONE",path:"if_viewer_can_use_latency_menu_toggle"}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("LiveVideoLatencyMenu.react",["fbt","CometRelay","FBLogger","LiveVideoLatencyMenuContextProvider_video.graphql","VideoPlayerHooks","react","react-compiler-runtime","useSelectedLatencySetting"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c,d=u||(u=o("react")),m=u.useMemo,p=s._(/*BTDS*/"Latency"),_=[g("low"),g("normal")],f=d.createContext({liveVideoLatencyMenuPaneMatchPointer:null,liveVideoLatencyMenuPaneToggleMatchPointer:null});function g(e){switch(e){case"low":return{description:s._(/*BTDS*/"A near-realtime experience."),title:s._(/*BTDS*/"Low latency"),value:e};case"normal":return{description:s._(/*BTDS*/"Best for performance and slower connections."),title:s._(/*BTDS*/"Normal"),value:e};case"ultra-low":return{description:s._(/*BTDS*/"Best for interactive broadcasts."),title:s._(/*BTDS*/"Ultra-low"),value:e};default:return r("FBLogger")("gaming_video").mustfix("Setting %s is not valid",e),{description:s._(/*BTDS*/"Error"),title:s._(/*BTDS*/"Error"),value:e}}}function h(e,t){var n=o("react-compiler-runtime").c(10),a=(c||(c=o("VideoPlayerHooks"))).useController(),i=c.useLatencyLevel(),l=r("useSelectedLatencySetting")(e,t),s=l[1],u;n[0]!==i?(u=g(i),n[0]=i,n[1]=u):u=n[1];var d=u,m=d.title,p;n[2]!==a||n[3]!==i||n[4]!==s?(p=function(t){i!==t&&(s(t),a.setLatencyLevel(t))},n[2]=a,n[3]=i,n[4]=s,n[5]=p):p=n[5];var _=p,f;return n[6]!==i||n[7]!==_||n[8]!==m?(f={selectedLatencySetting:i,selectedLatencySettingTitle:m,setSelectedLatencySetting:_},n[6]=i,n[7]=_,n[8]=m,n[9]=f):f=n[9],f}var y=e!==void 0?e:e=n("LiveVideoLatencyMenuContextProvider_video.graphql");function C(e){var t=o("react-compiler-runtime").c(7),n=e.children,r=e.video,a=o("CometRelay").useFragment(y,r),i;e:{if(a==null){var l;t[0]===Symbol.for("react.memo_cache_sentinel")?(l={liveVideoLatencyMenuPaneMatchPointer:null,liveVideoLatencyMenuPaneToggleMatchPointer:null},t[0]=l):l=t[0],i=l;break e}var s;t[1]!==a.if_viewer_can_use_latency_menu||t[2]!==a.if_viewer_can_use_latency_menu_toggle?(s={liveVideoLatencyMenuPaneMatchPointer:a.if_viewer_can_use_latency_menu,liveVideoLatencyMenuPaneToggleMatchPointer:a.if_viewer_can_use_latency_menu_toggle},t[1]=a.if_viewer_can_use_latency_menu,t[2]=a.if_viewer_can_use_latency_menu_toggle,t[3]=s):s=t[3],i=s}var u=i,c;return t[4]!==n||t[5]!==u?(c=d.jsx(f.Provider,{value:u,children:n}),t[4]=n,t[5]=u,t[6]=c):c=t[6],c}l.LATENCY_MENU_TITLE=p,l.LATENCY_SETTING_OPTIONS=_,l.LiveVideoLatencyMenuContext=f,l.getLiveVideoLatencySettingToInfoMapping=g,l.useLatencySettingState=h,l.LiveVideoLatencyMenuContextProvider=C}),226);
__d("VideoPlayerCaptionsControl_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoPlayerCaptionsControl_video",selections:[{alias:null,args:null,kind:"ScalarField",name:"captions_url",storageKey:null},{args:null,kind:"FragmentSpread",name:"useVideoPlayerAvailableCaptionsLocalesFromRelay_video"}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("VideoPlayerCaptionsMenu.react",["fbt","$InternalEnum","CometKeys","VideoPlayerCaptionsMenuCaptionsDisplayMainPane.react","VideoPlayerCaptionsMenuCaptionsDisplayPane.react","VideoPlayerCaptionsMenuMainPane.react","VideoPlayerHooks","react","react-compiler-runtime","useLayerKeyCommands"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=e||(e=o("react")),d=e,m=d.useCallback,p=d.useEffect,_=d.useMemo,f=d.useRef,g=d.useState,h=n("$InternalEnum")({CAPTIONS_BG_COLOR:"captionsBackgroundColor",CAPTIONS_BG_OPACITY:"captionsBackgroundOpacity",CAPTIONS_DISPLAY_MAIN:"captionsDisplayMain",CAPTIONS_TEXT_COLOR:"captionsTextColor",CAPTIONS_TEXT_SIZE:"captionsTextSize",CAPTIONS_MAIN:"captionsMain"});function y(e){var t=o("react-compiler-runtime").c(36),n=e.availableCaptionsLocales,a=e.captionsListExpanded,i=e.children,l=e.onClose,d=e.onPressLog,m=e.selectedCaptionsLocale,_=e.setCaptionsListExpanded,y=e.setSelectedCaptionsLocale,C=i===void 0?null:i,b=(u||(u=o("VideoPlayerHooks"))).useCaptionDisplayStyle(),v=g(h.CAPTIONS_MAIN),S=v[0],R=v[1],L=f(null),E=f(null),k;t[0]!==l?(k=function(t){var e=L.current,n=E.current,r=t.target;e!=null&&n!=null&&r instanceof HTMLElement&&document.contains(r)&&!e.contains(r)&&n.contains(r)&&l()},t[0]=l,t[1]=k):k=t[1];var I=k,T,D;t[2]!==I?(T=function(){return document.addEventListener("click",I),(function(){document.removeEventListener("click",I)})},D=[I],t[2]=I,t[3]=T,t[4]=D):(T=t[3],D=t[4]),p(T,D);var x,$;t[5]===Symbol.for("react.memo_cache_sentinel")?(x={key:r("CometKeys").ESCAPE},$=s._(/*BTDS*/"Close captions menu"),t[5]=x,t[6]=$):(x=t[5],$=t[6]);var P;t[7]!==l?(P=[{command:x,description:$,handler:function(){l()}}],t[7]=l,t[8]=P):P=t[8];var N=P;r("useLayerKeyCommands")(N);var M;t[9]!==n||t[10]!==a||t[11]!==C||t[12]!==d||t[13]!==m||t[14]!==_||t[15]!==y?(M=c.jsx(o("VideoPlayerCaptionsMenuMainPane.react").VideoPlayerCaptionsMenuMainPane,{availableCaptionsLocales:n,captionsListExpanded:a,onPressLog:d,selectedCaptionsLocale:m,setCaptionsListExpanded:_,setPane:R,setSelectedCaptionsLocale:y,children:C}),t[9]=n,t[10]=a,t[11]=C,t[12]=d,t[13]=m,t[14]=_,t[15]=y,t[16]=M):M=t[16];var w=M;e:switch(S){case h.CAPTIONS_MAIN:break e;case h.CAPTIONS_DISPLAY_MAIN:{var A;t[17]!==b||t[18]!==d?(A=c.jsx(o("VideoPlayerCaptionsMenuCaptionsDisplayMainPane.react").VideoPlayerCaptionsMenuCaptionsDisplayMainPane,{currentCaptionsDisplay:b,onPressLog:d,setPane:R}),t[17]=b,t[18]=d,t[19]=A):A=t[19],w=A;break e}case h.CAPTIONS_BG_COLOR:{var F;t[20]!==b||t[21]!==d?(F=c.jsx(o("VideoPlayerCaptionsMenuCaptionsDisplayPane.react").VideoPlayerCaptionsMenuCaptionsDisplayPane,{captionsDisplayOption:"captionsBackgroundColor",currentCaptionsDisplay:b,onPressLog:d,setPane:R}),t[20]=b,t[21]=d,t[22]=F):F=t[22],w=F;break e}case h.CAPTIONS_BG_OPACITY:{var O;t[23]!==b||t[24]!==d?(O=c.jsx(o("VideoPlayerCaptionsMenuCaptionsDisplayPane.react").VideoPlayerCaptionsMenuCaptionsDisplayPane,{captionsDisplayOption:"captionsBackgroundOpacity",currentCaptionsDisplay:b,onPressLog:d,setPane:R}),t[23]=b,t[24]=d,t[25]=O):O=t[25],w=O;break e}case h.CAPTIONS_TEXT_SIZE:{var B;t[26]!==b?(B=c.jsx(o("VideoPlayerCaptionsMenuCaptionsDisplayPane.react").VideoPlayerCaptionsMenuCaptionsDisplayPane,{captionsDisplayOption:"captionsTextSize",currentCaptionsDisplay:b,setPane:R}),t[26]=b,t[27]=B):B=t[27],w=B;break e}case h.CAPTIONS_TEXT_COLOR:{var W;t[28]!==b||t[29]!==d?(W=c.jsx(o("VideoPlayerCaptionsMenuCaptionsDisplayPane.react").VideoPlayerCaptionsMenuCaptionsDisplayPane,{captionsDisplayOption:"captionsTextColor",currentCaptionsDisplay:b,onPressLog:d,setPane:R}),t[28]=b,t[29]=d,t[30]=W):W=t[30],w=W}}var q;t[31]!==w?(q=c.jsx("div",{ref:L,children:w}),t[31]=w,t[32]=q):q=t[32];var U;t[33]===Symbol.for("react.memo_cache_sentinel")?(U=c.jsx("div",{className:"x5yr21d x1o0tod xixxii4 x13vifvy xh8yej3 x8knxv4","data-testid":void 0,ref:E}),t[33]=U):U=t[33];var V;return t[34]!==q?(V=c.jsxs(c.Fragment,{children:[q,U]}),t[34]=q,t[35]=V):V=t[35],V}l.VideoPlayerCaptionsMenuPaneType=h,l.VideoPlayerCaptionsMenu=y}),226);
__d("VideoPlayerCaptionsMenuCaptionsDisplayMainPane.react",["fbt","ix","CometImage.react","CometPressable.react","FocusRegion.react","VideoPlayerCaptionsMenu.react","focusScopeQueries","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s,u){"use strict";var e,c=e||(e=o("react")),d=e.useCallback,m={menuOptionRow:{color:"x14ctfv",display:"x1lliihq",outline:"x1a2a7pz",paddingTop:"x1y1aw1k",paddingInlineEnd:"xyri2b",paddingBottom:"xwib8y2",paddingInlineStart:"x1c1uobl",textAlign:"x1yc453h",width:"xafpxmx",$$css:!0},pressableOption:{width:"xh8yej3",$$css:!0}},p={captionsBackgroundColor:{Black:"BLACK",Blue:"BLUE",Cyan:"CYAN",Green:"GREEN",Magenta:"MAGENTA",Red:"RED",White:"WHITE",Yellow:"YELLOW"},captionsBackgroundOpacity:{"0%":"TRANSPARENT","25%":"LIGHT","45%":"DEFAULT","75%":"DARK","100%":"OPAQUE"},captionsTextColor:{Black:"BLACK",Blue:"BLUE",Cyan:"CYAN",Green:"GREEN",Magenta:"MAGENTA",Red:"RED",White:"WHITE",Yellow:"YELLOW"},captionsTextSize:{"(50%)":"SMALLEST","(75%)":"SMALL","(100%)":"DEFAULT","(125%)":"MEDIUM","(150%)":"BIG","(175%)":"BIGGER","(200%)":"BIGGEST"}},_={"Background Color":{ftbLabel:s._(/*BTDS*/"Background Color"),name:"captionsBackgroundColor"},"Background Opacity":{ftbLabel:s._(/*BTDS*/"Background Opacity"),name:"captionsBackgroundOpacity"},"Text Color":{ftbLabel:s._(/*BTDS*/"Text Color"),name:"captionsTextColor"},"Text Size":{ftbLabel:s._(/*BTDS*/"Text Size"),name:"captionsTextSize"}},f={Black:s._(/*BTDS*/"Black"),Blue:s._(/*BTDS*/"Blue"),Cyan:s._(/*BTDS*/"Cyan"),Green:s._(/*BTDS*/"Green"),Magenta:s._(/*BTDS*/"Magenta"),Red:s._(/*BTDS*/"Red"),White:s._(/*BTDS*/"White"),Yellow:s._(/*BTDS*/"Yellow")};function g(e){var t=null,n=null;switch(e){case"(50%)":t=s._(/*BTDS*/"Small"),n="X-";break;case"(75%)":t=s._(/*BTDS*/"Small");break;case"(125%)":t=s._(/*BTDS*/"Large");break;case"(150%)":t=s._(/*BTDS*/"Large"),n="X-";break;case"(175%)":t=s._(/*BTDS*/"Large"),n="XX-";break;case"(200%)":t=s._(/*BTDS*/"Large"),n="XXX-";break;case"(100%)":t=s._(/*BTDS*/"Medium")}return c.jsxs("span",{children:[n!=null&&n,t,e]})}g.displayName=g.name+" [from "+i.id+"]";var h={captionsBackgroundColor:o("VideoPlayerCaptionsMenu.react").VideoPlayerCaptionsMenuPaneType.CAPTIONS_BG_COLOR,captionsBackgroundOpacity:o("VideoPlayerCaptionsMenu.react").VideoPlayerCaptionsMenuPaneType.CAPTIONS_BG_OPACITY,captionsTextColor:o("VideoPlayerCaptionsMenu.react").VideoPlayerCaptionsMenuPaneType.CAPTIONS_TEXT_COLOR,captionsTextSize:o("VideoPlayerCaptionsMenu.react").VideoPlayerCaptionsMenuPaneType.CAPTIONS_TEXT_SIZE};function y(e){var t=o("react-compiler-runtime").c(26),n=e.onPressLog,a=e.option,i=e.optionVal,l=e.setPane,s=_[a].name,d;t[0]!==s||t[1]!==n||t[2]!==a||t[3]!==l?(d=function(){l(h[s]),n&&n("captions_display_main_menu",a)},t[0]=s,t[1]=n,t[2]=a,t[3]=l,t[4]=d):d=t[4];var p=d,y=null;e:switch(s){case"captionsTextColor":case"captionsBackgroundColor":{i in f&&(y=f[i]);break e}default:y=i}var C;t[5]!==a?(C=a.replace(" ",""),t[5]=a,t[6]=C):C=t[6];var b=C,v="video-player-captions-menu-captions-display-main-"+b,S;t[7]===Symbol.for("react.memo_cache_sentinel")?(S={className:"x1ypdohk x1rg5ohu x1nxh6w3 x1s688f x1uncgzr"},t[7]=S):S=t[7];var R=_[a],L;t[8]===Symbol.for("react.memo_cache_sentinel")?(L={className:"x1nxh6w3 xo1l8bm"},t[8]=L):L=t[8];var E;t[9]!==s||t[10]!==i||t[11]!==y?(E=s==="captionsTextSize"?g(i):y,t[9]=s,t[10]=i,t[11]=y,t[12]=E):E=t[12];var k;t[13]!==E||t[14]!==v?(k=c.jsx("div",babelHelpers.extends({},L,{"data-testid":void 0,children:E})),t[13]=E,t[14]=v,t[15]=k):k=t[15];var I;t[16]!==R.ftbLabel||t[17]!==k?(I=c.jsxs("div",babelHelpers.extends({},S,{children:[R.ftbLabel,k]})),t[16]=R.ftbLabel,t[17]=k,t[18]=I):I=t[18];var T,D,x;t[19]===Symbol.for("react.memo_cache_sentinel")?(x={className:"x1rg5ohu"},T={className:"x1lliihq"},D={display:"table-cell"},t[19]=T,t[20]=D,t[21]=x):(T=t[19],D=t[20],x=t[21]);var $;t[22]===Symbol.for("react.memo_cache_sentinel")?($=c.jsx("div",babelHelpers.extends({},x,{children:c.jsx("div",babelHelpers.extends({},T,{children:c.jsx("div",{style:D,children:c.jsx(r("CometImage.react"),{isDecorative:!0,src:u("480588")})})}))})),t[22]=$):$=t[22];var P;return t[23]!==p||t[24]!==I?(P=c.jsxs(r("CometPressable.react"),{onPress:p,xstyle:m.menuOptionRow,children:[I,$]}),t[23]=p,t[24]=I,t[25]=P):P=t[25],P}function C(e){var t=o("react-compiler-runtime").c(17),n=e.currentCaptionsDisplay,a=e.onPressLog,i=e.setPane,l;t[0]!==i?(l=function(){i(o("VideoPlayerCaptionsMenu.react").VideoPlayerCaptionsMenuPaneType.CAPTIONS_MAIN)},t[0]=i,t[1]=l):l=t[1];var d=l,f;t[2]===Symbol.for("react.memo_cache_sentinel")?(f={className:"x6s0dn4 x14ctfv x1ypdohk x78zum5 x1s688f x1lku1pv"},t[2]=f):f=t[2];var g;t[3]===Symbol.for("react.memo_cache_sentinel")?(g={className:"x6s0dn4 x3nfvp2"},t[3]=g):g=t[3];var h,C;t[4]===Symbol.for("react.memo_cache_sentinel")?(h=c.jsx("span",babelHelpers.extends({},g,{children:c.jsx(r("CometImage.react"),{isDecorative:!0,src:u("480580")})})),C=c.jsx("span",{className:"x1nxh6w3 x1s688f x1diwwjn",children:s._(/*BTDS*/"Subtitle Options")}),t[4]=h,t[5]=C):(h=t[4],C=t[5]);var v;t[6]!==d?(v=c.jsx("div",babelHelpers.extends({},f,{children:c.jsxs(r("CometPressable.react"),{onPress:d,xstyle:m.pressableOption,children:[h,C]})})),t[6]=d,t[7]=v):v=t[7];var S;t[8]===Symbol.for("react.memo_cache_sentinel")?(S={className:"x1anpbxc"},t[8]=S):S=t[8];var R;t[9]===Symbol.for("react.memo_cache_sentinel")?(R=Object.keys(_),t[9]=R):R=t[9];var L;t[10]!==n||t[11]!==a||t[12]!==i?(L=c.jsx("div",babelHelpers.extends({},S,{"data-testid":void 0,children:R.map(function(e){var t=_[e].name,r=p[t],o=Object.fromEntries(Object.entries(r).map(b)),l=n!=null?o[n[t]]:"";return c.jsx(y,{onPressLog:a,option:e,optionVal:l,setPane:i},e)})})),t[10]=n,t[11]=a,t[12]=i,t[13]=L):L=t[13];var E;return t[14]!==v||t[15]!==L?(E=c.jsxs(o("FocusRegion.react").FocusRegion,{autoFocusQuery:o("focusScopeQueries").headerFirstTabbableSecondScopeQuery,recoverFocusQuery:o("focusScopeQueries").headerFirstTabbableSecondScopeQuery,children:[v,L]}),t[14]=v,t[15]=L,t[16]=E):E=t[16],E}function b(e){var t=e[0],n=e[1];return[n,t]}l.captionsDisplayOptionsMap=p,l.colorsFBTMap=f,l.getFontSizeDivWithFBTLabel=g,l.VideoPlayerCaptionsMenuCaptionsDisplayMainPane=C}),226);
__d("VideoPlayerCaptionsSettingMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="8917695971664599"}),null);
__d("VideoPlayerCaptionsSettingMutation.graphql",["VideoPlayerCaptionsSettingMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"VideoPlayerCaptionsSettingResponsePayload",kind:"LinkedField",name:"video_player_captions_setting",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"success",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"VideoPlayerCaptionsSettingMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"VideoPlayerCaptionsSettingMutation",selections:t},params:{id:n("VideoPlayerCaptionsSettingMutation_facebookRelayOperation"),metadata:{},name:"VideoPlayerCaptionsSettingMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("VideoPlayerCaptionsSettingMutation",["CometRelay","VideoPlayerCaptionsSettingMutation.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e!==void 0?e:e=n("VideoPlayerCaptionsSettingMutation.graphql");function u(e,t,n){return o("CometRelay").commitMutation(e,{mutation:s,onCompleted:n&&n.onCompleted,onError:n&&n.onError,optimisticResponse:{video_captions_setting:{success:!0}},variables:{input:{captions_background_color:t.captions_background_color,captions_background_opacity:t.captions_background_opacity,captions_text_color:t.captions_text_color,captions_text_size:t.captions_text_size,client_mutation_id:"www_captions_settings"}}})}l.commit=u}),98);
__d("VideoPlayerCaptionsMenuCaptionsDisplayPane.react",["fbt","ix","CometImage.react","CometPressable.react","CometRelay","FDSIcon.react","FocusRegion.react","VideoPlayerCaptionsMenu.react","VideoPlayerCaptionsMenuCaptionsDisplayMainPane.react","VideoPlayerCaptionsSettingMutation","VideoPlayerHooks","fbicon","focusScopeQueries","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s,u){"use strict";var e,c,d=e||(e=o("react")),m=e.useCallback,p={menuOptionRow:{color:"x14ctfv",display:"x1lliihq",outline:"x1a2a7pz",paddingTop:"x1y1aw1k",paddingInlineEnd:"xyri2b",paddingBottom:"xwib8y2",paddingInlineStart:"x1c1uobl",textAlign:"x1yc453h",$$css:!0},pressableOption:{width:"xh8yej3",$$css:!0}},_={captionsBackgroundColor:s._(/*BTDS*/"Background Color"),captionsBackgroundOpacity:s._(/*BTDS*/"Background Opacity"),captionsTextColor:s._(/*BTDS*/"Text Color"),captionsTextSize:s._(/*BTDS*/"Text Size")},f=function(t){return{captions_background_color:t.captionsBackgroundColor,captions_background_opacity:t.captionsBackgroundOpacity,captions_text_color:t.captionsTextColor,captions_text_size:t.captionsTextSize}};function g(e){var t=e.captionsDisplayOption,n=e.currentCaptionsDisplay,a=e.onPressLog,i=e.option,l=e.selected,s=e.setPane,_=(c||(c=o("VideoPlayerHooks"))).useController(),g=l,h=o("VideoPlayerCaptionsMenuCaptionsDisplayMainPane.react").captionsDisplayOptionsMap[t],y=null;switch(t){case"captionsTextColor":case"captionsBackgroundColor":y=o("VideoPlayerCaptionsMenuCaptionsDisplayMainPane.react").colorsFBTMap[i];break;default:y=i}var C="video-player-captions-menu-captions-display-pane-"+t+"-"+i,b=m(function(){if(g=!0,n!=null&&i in h){var e=h[i];n[t]=e,_.setCaptionsDisplayStyle(babelHelpers.extends({},n));var r=f(n);o("VideoPlayerCaptionsSettingMutation").commit(v,r)}s(o("VideoPlayerCaptionsMenu.react").VideoPlayerCaptionsMenuPaneType.CAPTIONS_DISPLAY_MAIN),a&&a(t)},[n,h,t,_,i]),v=o("CometRelay").useRelayEnvironment();return d.jsxs(r("CometPressable.react"),{"aria-pressed":g,onPress:b,testid:void 0,xstyle:p.menuOptionRow,children:[d.jsx("div",{className:"x1rg5ohu x1849jeq",children:g&&d.jsx("div",{"data-testid":void 0,children:d.jsx(r("FDSIcon.react"),{color:"white",icon:o("fbicon")._(u("477813"),16)})})}),t==="captionsTextSize"?o("VideoPlayerCaptionsMenuCaptionsDisplayMainPane.react").getFontSizeDivWithFBTLabel(i):d.jsx("div",{className:"x1ypdohk x1rg5ohu",children:y})]})}g.displayName=g.name+" [from "+i.id+"]";function h(e){var t=o("react-compiler-runtime").c(25),n=e.captionsDisplayOption,a=e.currentCaptionsDisplay,i=e.onPressLog,l=e.setPane,c=_[n],m=o("VideoPlayerCaptionsMenuCaptionsDisplayMainPane.react").captionsDisplayOptionsMap[n],f=a!=null?a[n]:null,h;t[0]!==l?(h=function(){l(o("VideoPlayerCaptionsMenu.react").VideoPlayerCaptionsMenuPaneType.CAPTIONS_DISPLAY_MAIN)},t[0]=l,t[1]=h):h=t[1];var y=h,C="video-player-captions-menu-captions-display-pane-"+n,b;t[2]===Symbol.for("react.memo_cache_sentinel")?(b={className:"x6s0dn4 x14ctfv x1ypdohk x78zum5 x1nxh6w3 x1s688f x1lku1pv"},t[2]=b):b=t[2];var v=C+"-topBar",S;t[3]===Symbol.for("react.memo_cache_sentinel")?(S={className:"x6s0dn4 x3nfvp2 x1849jeq"},t[3]=S):S=t[3];var R;t[4]===Symbol.for("react.memo_cache_sentinel")?(R=d.jsx("span",babelHelpers.extends({},S,{children:d.jsx(r("CometImage.react"),{alt:s._(/*BTDS*/"Back"),src:u("480580")})})),t[4]=R):R=t[4];var L;t[5]!==y||t[6]!==c||t[7]!==v?(L=d.jsx("div",babelHelpers.extends({},b,{children:d.jsxs(r("CometPressable.react"),{onPress:y,testid:void 0,xstyle:p.pressableOption,children:[R,c]})})),t[5]=y,t[6]=c,t[7]=v,t[8]=L):L=t[8];var E;t[9]===Symbol.for("react.memo_cache_sentinel")?(E={className:"x1nxh6w3 xo1l8bm x1anpbxc"},t[9]=E):E=t[9];var k;t[10]!==m?(k=Object.entries(m),t[10]=m,t[11]=k):k=t[11];var I;t[12]!==f||t[13]!==n||t[14]!==a||t[15]!==i||t[16]!==l||t[17]!==k?(I=k.map(function(e){var t=e[0],r=e[1],o=f===r;return d.jsx(g,{captionsDisplayOption:n,currentCaptionsDisplay:a,onPressLog:i,option:t,selected:o,setPane:l},t)}),t[12]=f,t[13]=n,t[14]=a,t[15]=i,t[16]=l,t[17]=k,t[18]=I):I=t[18];var T;t[19]!==I||t[20]!==C?(T=d.jsx("div",babelHelpers.extends({},E,{"data-testid":void 0,children:I})),t[19]=I,t[20]=C,t[21]=T):T=t[21];var D;return t[22]!==T||t[23]!==L?(D=d.jsxs(o("FocusRegion.react").FocusRegion,{autoFocusQuery:o("focusScopeQueries").headerFirstTabbableSecondScopeQuery,recoverFocusQuery:o("focusScopeQueries").headerFirstTabbableSecondScopeQuery,children:[L,T]}),t[22]=T,t[23]=L,t[24]=D):D=t[24],D}l.VideoPlayerCaptionsMenuCaptionsDisplayPane=h}),226);
__d("VideoPlayerCaptionsMenuMainPane.react",["fbt","ix","CometPressable.react","CometScrollableArea.react","FDSIcon.react","FocusRegion.react","VideoPlayerCaptionsMenuTopBar.react","VideoPlayerHooks","fbicon","focusScopeQueries","isTruthy","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s,u){"use strict";var e,c,d=e||(e=o("react")),m=e,p=m.useEffect,_=m.useRef,f={menuOptionRow:{color:"x14ctfv",display:"x1lliihq",fontSize:"x1nxh6w3",fontWeight:"xo1l8bm",minWidth:"xfvyar9",outline:"x1a2a7pz",paddingTop:"x1y1aw1k",paddingInlineEnd:"xyri2b",paddingBottom:"xwib8y2",paddingInlineStart:"x1c1uobl",textAlign:"x1yc453h",":hover_backgroundColor":"xx8nu07",$$css:!0}},g=5;function h(e){var t,n=o("react-compiler-runtime").c(27),a=e.captions,i=e.captionsVisible,l=e.controller,m=e.focused,p=e.onPressLog,_=e.setSelectedCaptionsLocale,g=(c||(c=o("VideoPlayerHooks"))).useIsVideoBroadcast(),h=a.localizedCreationMethod!=null||g,y="video-player-captions-menu-language-list-item-"+((t=a.localizedLanguage)!=null?t:""),C;n[0]!==a.captionsUrl||n[1]!==a.locale||n[2]!==a.localizedLanguage||n[3]!==i||n[4]!==l||n[5]!==p||n[6]!==_?(C=function(){var e;a.locale!=null&&_(a.locale),i||l.setCaptionsVisible(!0),a.captionsUrl!=null&&l.setCaptionsUrl(a.captionsUrl),p&&p("captions_language_selector",(e=a.localizedLanguage)!=null?e:"")},n[0]=a.captionsUrl,n[1]=a.locale,n[2]=a.localizedLanguage,n[3]=i,n[4]=l,n[5]=p,n[6]=_,n[7]=C):C=n[7];var b;n[8]===Symbol.for("react.memo_cache_sentinel")?(b={className:"x1rg5ohu xw4jnvo"},n[8]=b):b=n[8];var v;n[9]!==m||n[10]!==y?(v=m&&d.jsx("div",{"data-testid":void 0,children:d.jsx(r("FDSIcon.react"),{color:"white",icon:o("fbicon")._(u("477813"),16)})}),n[9]=m,n[10]=y,n[11]=v):v=n[11];var S;n[12]!==v?(S=d.jsx("div",babelHelpers.extends({},b,{children:v})),n[12]=v,n[13]=S):S=n[13];var R;n[14]===Symbol.for("react.memo_cache_sentinel")?(R={className:"x1ypdohk x1rg5ohu x1hm9lzh xzjbwwf"},n[14]=R):R=n[14];var L=r("isTruthy")(a.localizedCountry)?" "+a.localizedCountry:null,E;n[15]!==h?(E=!h&&d.jsxs(d.Fragment,{children:[" ",s._(/*BTDS*/"(Provided by Author)")]}),n[15]=h,n[16]=E):E=n[16];var k;n[17]!==a.localizedLanguage||n[18]!==L||n[19]!==E?(k=d.jsxs("div",babelHelpers.extends({},R,{children:[a.localizedLanguage,L,E]})),n[17]=a.localizedLanguage,n[18]=L,n[19]=E,n[20]=k):k=n[20];var I;return n[21]!==m||n[22]!==C||n[23]!==S||n[24]!==k||n[25]!==y?(I=d.jsxs(r("CometPressable.react"),{"aria-pressed":m,onPress:C,testid:void 0,xstyle:f.menuOptionRow,children:[S,k]}),n[21]=m,n[22]=C,n[23]=S,n[24]=k,n[25]=y,n[26]=I):I=n[26],I}var y="Toggle On";function C(e){var t=o("react-compiler-runtime").c(66),n=e.availableCaptionsLocales,a=e.captionsListExpanded,i=e.children,l=e.onPressLog,m=e.selectedCaptionsLocale,C=e.setCaptionsListExpanded,b=e.setPane,v=e.setSelectedCaptionsLocale,S=(c||(c=o("VideoPlayerHooks"))).useController(),R=c.useCaptionsVisible(),L=n!=null?n.length:0,E=_(!1),k,I;if(t[0]!==L||t[1]!==R||t[2]!==v?(k=function(){R||v(""),R&&L===0&&!E.current&&(E.current=!0,v(y))},I=[R,v,L],t[0]=L,t[1]=R,t[2]=v,t[3]=k,t[4]=I):(k=t[3],I=t[4]),p(k,I),n==null)return null;var T;t[5]!==n||t[6]!==l||t[7]!==b?(T=d.jsx(r("VideoPlayerCaptionsMenuTopBar.react"),{availableCaptionsLocales:n,onPressLog:l,setPane:b}),t[5]=n,t[6]=l,t[7]=b,t[8]=T):T=t[8];var D;t[9]===Symbol.for("react.memo_cache_sentinel")?(D={className:"x1anpbxc x15eivr9"},t[9]=D):D=t[9];var x;t[10]!==L||t[11]!==S||t[12]!==m||t[13]!==v?(x=L===0&&d.jsxs(r("CometPressable.react"),{"aria-pressed":m===y,onPress:function(){v(y),S.setCaptionsVisible(!0)},xstyle:f.menuOptionRow,children:[d.jsx("div",{className:"x1rg5ohu xw4jnvo",children:m===y&&d.jsx(r("FDSIcon.react"),{color:"white",icon:o("fbicon")._(u("477813"),16)})}),d.jsx("div",{className:"x1ypdohk x1rg5ohu x1hm9lzh xzjbwwf",children:s._(/*BTDS*/"On")})]}),t[10]=L,t[11]=S,t[12]=m,t[13]=v,t[14]=x):x=t[14];var $=m==="",P;t[15]!==S||t[16]!==v?(P=function(){v(""),S.setCaptionsVisible(!1)},t[15]=S,t[16]=v,t[17]=P):P=t[17];var N;t[18]===Symbol.for("react.memo_cache_sentinel")?(N={className:"x1rg5ohu xw4jnvo"},t[18]=N):N=t[18];var M;t[19]!==m?(M=m===""&&d.jsx(r("FDSIcon.react"),{color:"white",icon:o("fbicon")._(u("477813"),16)}),t[19]=m,t[20]=M):M=t[20];var w;t[21]!==M?(w=d.jsx("div",babelHelpers.extends({},N,{children:M})),t[21]=M,t[22]=w):w=t[22];var A;t[23]===Symbol.for("react.memo_cache_sentinel")?(A=d.jsx("div",{className:"x1ypdohk x1rg5ohu x1hm9lzh xzjbwwf",children:s._(/*BTDS*/"Off")}),t[23]=A):A=t[23];var F;t[24]!==w||t[25]!==$||t[26]!==P?(F=d.jsxs(r("CometPressable.react"),{"aria-pressed":$,onPress:P,xstyle:f.menuOptionRow,children:[w,A]}),t[24]=w,t[25]=$,t[26]=P,t[27]=F):F=t[27];var O;if(t[28]!==n||t[29]!==R||t[30]!==S||t[31]!==l||t[32]!==m||t[33]!==v){var B;t[35]!==R||t[36]!==S||t[37]!==l||t[38]!==m||t[39]!==v?(B=function(t){var e=t.locale===m;return t.localizedLanguage!=null?d.jsx(h,{captions:t,captionsVisible:R,controller:S,focused:e,onPressLog:l,setSelectedCaptionsLocale:v},t.locale):null},t[35]=R,t[36]=S,t[37]=l,t[38]=m,t[39]=v,t[40]=B):B=t[40],O=n.slice(0,4).map(B),t[28]=n,t[29]=R,t[30]=S,t[31]=l,t[32]=m,t[33]=v,t[34]=O}else O=t[34];var W;t[41]!==L||t[42]!==a||t[43]!==C?(W=L>=g&&!a&&d.jsx(r("CometPressable.react"),{onPress:function(){C(!0)},xstyle:f.menuOptionRow,children:d.jsx("div",{className:"x1ypdohk x1rg5ohu x9pbi5e",children:s._(/*BTDS*/"See more")})}),t[41]=L,t[42]=a,t[43]=C,t[44]=W):W=t[44];var q;t[45]!==n||t[46]!==a||t[47]!==R||t[48]!==S||t[49]!==m||t[50]!==v?(q=a&&n.slice(4).map(function(e){var t=e.locale===m;return e.localizedLanguage!=null?d.jsx(h,{captions:e,captionsVisible:R,controller:S,focused:t,setSelectedCaptionsLocale:v},e.locale):null}),t[45]=n,t[46]=a,t[47]=R,t[48]=S,t[49]=m,t[50]=v,t[51]=q):q=t[51];var U;t[52]!==a||t[53]!==C?(U=a&&d.jsx(r("CometPressable.react"),{onPress:function(){C(!1)},xstyle:f.menuOptionRow,children:d.jsx("div",{className:"x1ypdohk x1rg5ohu x9pbi5e",children:s._(/*BTDS*/"See less")})}),t[52]=a,t[53]=C,t[54]=U):U=t[54];var V;t[55]!==F||t[56]!==O||t[57]!==W||t[58]!==q||t[59]!==U||t[60]!==x?(V=d.jsx(r("CometScrollableArea.react"),{hideScrollbar:!0,children:d.jsxs("div",babelHelpers.extends({},D,{"data-testid":void 0,children:[x,F,O,W,q,U]}))}),t[55]=F,t[56]=O,t[57]=W,t[58]=q,t[59]=U,t[60]=x,t[61]=V):V=t[61];var H;return t[62]!==i||t[63]!==V||t[64]!==T?(H=d.jsx(o("FocusRegion.react").FocusRegion,{autoFocusQuery:o("focusScopeQueries").headerFirstTabbableSecondScopeQuery,recoverFocusQuery:o("focusScopeQueries").headerFirstTabbableSecondScopeQuery,children:d.jsxs("div",{"data-testid":void 0,children:[T,i,V]})}),t[62]=i,t[63]=V,t[64]=T,t[65]=H):H=t[65],H}l.VideoPlayerCaptionsMenuMainPane=C}),226);
__d("VideoPlayerCaptionsMenuTopBar.react",["fbt","ix","CometImage.react","CometPressable.react","VideoPlayerCaptionsMenu.react","VideoPlayerHooks","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s,u){"use strict";var e,c,d=e||(e=o("react")),m=e.useCallback,p={pressableOption:{width:"xh8yej3",$$css:!0}};function _(e){var t=o("react-compiler-runtime").c(18),n=e.availableCaptionsLocales,a=e.onPressLog,i=e.setPane,l;t[0]!==a||t[1]!==i?(l=function(){i(o("VideoPlayerCaptionsMenu.react").VideoPlayerCaptionsMenuPaneType.CAPTIONS_DISPLAY_MAIN),a&&a("captions_main_menu_top_bar")},t[0]=a,t[1]=i,t[2]=l):l=t[2];var m=l,_=(c||(c=o("VideoPlayerHooks"))).useIsLive(),g=c.useIsVideoBroadcast(),h=g&&!_,y;t[3]!==n||t[4]!==h?(y=(n==null?void 0:n.some(f))||h,t[3]=n,t[4]=h,t[5]=y):y=t[5];var C=y,b;t[6]===Symbol.for("react.memo_cache_sentinel")?(b={className:"x14ctfv x78zum5 x1jzhcrs"},t[6]=b):b=t[6];var v,S,R;t[7]===Symbol.for("react.memo_cache_sentinel")?(v=d.jsx("div",{className:"x1nxh6w3 x1s688f",children:s._(/*BTDS*/"Subtitles")}),S={className:"x6s0dn4 x14ctfv x1ypdohk x3nfvp2 x1bhwmg6 x13a6bvl xymharo"},R={className:"x3nfvp2"},t[7]=v,t[8]=S,t[9]=R):(v=t[7],S=t[8],R=t[9]);var L;t[10]===Symbol.for("react.memo_cache_sentinel")?(L=d.jsxs("div",babelHelpers.extends({},S,{children:[d.jsx("span",babelHelpers.extends({},R,{children:d.jsx(r("CometImage.react"),{isDecorative:!0,src:u("492300")})})),d.jsx("div",{className:"x3nfvp2 xo1l8bm xdzw4kq",children:s._(/*BTDS*/"Options")})]})),t[10]=L):L=t[10];var E;t[11]!==m?(E=d.jsx("div",babelHelpers.extends({},b,{children:d.jsxs(r("CometPressable.react"),{onPress:m,testid:void 0,xstyle:p.pressableOption,children:[v,L]})})),t[11]=m,t[12]=E):E=t[12];var k;t[13]!==C?(k=C!=null&&C&&d.jsx("div",{className:"x1nxh6w3 x1k4tb9n",children:s._(/*BTDS*/"Auto-generated")}),t[13]=C,t[14]=k):k=t[14];var I;return t[15]!==E||t[16]!==k?(I=d.jsxs("div",{children:[E,k]}),t[15]=E,t[16]=k,t[17]=I):I=t[17],I}function f(e){return e.localizedCreationMethod!=null}l.default=_}),226);
__d("VideoPlayerCaptionsControl.react",["fbt","ix","CometRelay","IntlCurrentLocale","VideoPlayerCaptionsControl_video.graphql","VideoPlayerCaptionsMenu.react","VideoPlayerControlIcon.react","VideoPlayerDefaultControlsProperties","VideoPlayerHooks","VideoPlayerLoggingSuboriginContext","VideoPlayerUserInteractionCounter","fbicon","react","requireDeferred","useMinifiedProductAttribution","usePlayerOriginRouteTracePolicy","useVideoPlayerAvailableCaptionsLocalesFromRelay"],(function(t,n,r,o,a,i,l,s,u){"use strict";var e,c,d,m=c||(c=o("react")),p=c,_=p.useCallback,f=p.useContext,g=p.useEffect,h=p.useMemo,y=p.useRef,C=p.useState,b=r("requireDeferred")("VideoHomeTypedLiteLogger").__setRef("VideoPlayerCaptionsControl.react"),v="asr",S=function(t){return t.length<2?null:t.substr(0,2)};function R(t){var a=t.alignMenuToIcon,i=a===void 0?!1:a,l=t.availableCaptionsLocales,c=t.captionsVisible,p=t.children,R=p===void 0?null:p,L=t.compactMenu,E=t.icon,k=t.initialCaptionsUrl,I=t.menuOpened,T=t.onMenuOpen,D=t.onUserInteraction,x=t.setMenuOpened,$=t.video,P=s._(/*BTDS*/"Captions");o("VideoPlayerUserInteractionCounter").useVideoPlayerUserInteraction("video_captions_menu",I===o("VideoPlayerDefaultControlsProperties").VideoMenuType.VIDEO_CAPTIONS_MENU,D);var N=o("CometRelay").useFragment(e!==void 0?e:e=n("VideoPlayerCaptionsControl_video.graphql"),$),M=(d||(d=o("VideoPlayerHooks"))).useMuted(),w=d.useController(),A=r("usePlayerOriginRouteTracePolicy")(),F=r("useVideoPlayerAvailableCaptionsLocalesFromRelay")(N),O=h(function(){var e;return((e=l!=null?l:F)!=null?e:[]).slice().sort(function(e,t){var n,r;return((n=e.localizedLanguage)!=null?n:"")>((r=t.localizedLanguage)!=null?r:"")?1:-1})},[l,F]),B=k!=null?k:N==null?void 0:N.captions_url,W=C(""),q=W[0],U=W[1],V=y(null),H=y(null);g(function(){O.forEach(function(e){e.captionsUrl===B&&e.locale!=null&&(V.current==null&&(V.current=e.locale),U(e.locale))})},[O,B]);var G=r("IntlCurrentLocale").code;g(function(){var e,t=S((e=V.current)!=null?e:"");V.current!==v&&t!=null&&t!==S(G)&&H.current===null?(w.setCaptionsVisible(!1),H.current=!1):M&&!c&&q!==""&&H.current===null?(H.current=!0,w.setCaptionsVisible(!0)):!M&&H.current===!0&&(w.setCaptionsVisible(!1),H.current=!1)},[c,w,M,G,q]);var z=I===o("VideoPlayerDefaultControlsProperties").VideoMenuType.VIDEO_CAPTIONS_MENU,j=C(!1),K=j[0],Q=j[1],X=f(r("VideoPlayerLoggingSuboriginContext")),Y=r("useMinifiedProductAttribution")(),J=_(function(e,t){e===void 0&&(e=null),t===void 0&&(t=null),b.onReady(function(n){n.log({attribution_id_v2:Y,click_point:e,event:"click",event_target_info:A,event_target_sub_type:t,player_suborigin:X})})},[Y,A,X]);return m.jsxs("div",babelHelpers.extends({},{0:{className:"x1rg5ohu x1k70j0n xbelrpt xzueoph xdzw4kq"},1:{className:"x1rg5ohu x1k70j0n xbelrpt xzueoph xdzw4kq x1n2onr6 xuxw1ft"}}[(i===!0)<<0],{"data-testid":void 0,children:[z&&m.jsx("div",babelHelpers.extends({role:"dialog"},{0:{className:"x1av4zun xjwep3j x1t39747 x1wcsgtt x1pczhz8 xacj9c0 x14ctfv x89ytp0 x1hdnelj xgmxx4u xyamay9 xv54qhq x1l90r2v xf7dkkf x10l6tqk xk6ci0l x1602a87"},2:{className:"x1av4zun xjwep3j x1t39747 x1wcsgtt x1pczhz8 xacj9c0 x14ctfv x89ytp0 x1hdnelj xgmxx4u xyamay9 xv54qhq x1l90r2v xf7dkkf x10l6tqk x1602a87 xwjie4w"},1:{className:"x1av4zun xjwep3j x1t39747 x1wcsgtt x1pczhz8 xacj9c0 x14ctfv x89ytp0 x1hdnelj xgmxx4u xyamay9 xv54qhq x1l90r2v xf7dkkf x10l6tqk x1602a87 x1g75g36"},3:{className:"x1av4zun xjwep3j x1t39747 x1wcsgtt x1pczhz8 xacj9c0 x14ctfv x89ytp0 x1hdnelj xgmxx4u xyamay9 xv54qhq x1l90r2v xf7dkkf x10l6tqk x1602a87 x1g75g36"}}[(L===!0)<<1|(i===!0)<<0],{children:m.jsx(o("VideoPlayerCaptionsMenu.react").VideoPlayerCaptionsMenu,{availableCaptionsLocales:O,captionsListExpanded:K,onClose:function(){x!=null&&x(null)},onPressLog:J,selectedCaptionsLocale:q,setCaptionsListExpanded:Q,setSelectedCaptionsLocale:U,children:R})})),m.jsx(r("VideoPlayerControlIcon.react"),{icon:E==null?c?o("fbicon")._(u("662652"),20):o("fbicon")._(u("662655"),20):E,label:P,onPress:function(){x!=null&&x(z?null:o("VideoPlayerDefaultControlsProperties").VideoMenuType.VIDEO_CAPTIONS_MENU),!z&&T!=null&&T(),J("closed_captions_button")},tooltip:P})]}))}R.displayName=R.name+" [from "+i.id+"]",l.default=R}),226);
__d("VideoPlayerCastControlShimImpl.modern.react",["deferredLoadComponent","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e=r("deferredLoadComponent")(r("requireDeferred")("VideoPlayerCastControl.react").__setRef("VideoPlayerCastControlShimImpl.modern.react"));l.default=e}),98);
__d("VideoPlayerCastControlShim.react",["CometPlaceholder.react","VideoPlayerCastControlShimImpl.modern.react","VideoPlayerControlsGroups.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e=["isVisible"],s,u=s||(s=o("react"));function c(t){var n=o("react-compiler-runtime").c(8),a,l;n[0]!==t?(a=t.isVisible,l=babelHelpers.objectWithoutPropertiesLoose(t,e),n[0]=t,n[1]=a,n[2]=l):(a=n[1],l=n[2]);var s;n[3]!==l?(s=u.jsx(r("CometPlaceholder.react"),{fallback:null,name:i.id,children:u.jsx(r("VideoPlayerCastControlShimImpl.modern.react"),babelHelpers.extends({},l))}),n[3]=l,n[4]=s):s=n[4];var c;return n[5]!==a||n[6]!==s?(c=u.jsx(o("VideoPlayerControlsGroups.react").Contracted,{isVisible:a,noPaddingEnd:!0,noPaddingStart:!0,children:s}),n[5]=a,n[6]=s,n[7]=c):c=n[7],c}l.default=c}),98);
__d("VideoPlayerDefaultControlsImplLive_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoPlayerDefaultControlsImplLive_video",selections:[{args:null,kind:"FragmentSpread",name:"VideoPlayerLiveVideoControls_video"}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("VideoPlayerExpandSidePanelControl.react",["fbt","ix","CometTahoeSidePaneContext","VideoPlayerControlIcon.react","fbicon","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s,u){"use strict";var e,c=e||(e=o("react")),d=e.useContext;function m(){var e=o("react-compiler-runtime").c(12),t=d(r("CometTahoeSidePaneContext")),n=t.rightRailExpanded,a=t.setRightRailExpanded,i;e[0]!==n?(i=n?s._(/*BTDS*/"Collapse comments"):s._(/*BTDS*/"Expand comments"),e[0]=n,e[1]=i):i=e[1];var l=i,m;e[2]===Symbol.for("react.memo_cache_sentinel")?(m={className:"x1rg5ohu x1k70j0n xbelrpt xzueoph xdzw4kq"},e[2]=m):m=e[2];var p;e[3]!==n?(p=n?o("fbicon")._(u("557039"),20):o("fbicon")._(u("557052"),20),e[3]=n,e[4]=p):p=e[4];var _;e[5]!==n||e[6]!==a?(_=function(){a(!n)},e[5]=n,e[6]=a,e[7]=_):_=e[7];var f;return e[8]!==l||e[9]!==p||e[10]!==_?(f=c.jsx("div",babelHelpers.extends({},m,{children:c.jsx(r("VideoPlayerControlIcon.react"),{icon:p,label:l,onPress:_,tooltip:l})})),e[8]=l,e[9]=p,e[10]=_,e[11]=f):f=e[11],f}l.default=m}),226);
__d("VideoPlayerLiveVideoControls_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoPlayerLiveVideoControls_video",selections:[e,{alias:null,args:null,kind:"ScalarField",name:"is_clipping_enabled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"live_rewind_enabled",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"owner",plural:!1,selections:[e],storageKey:null},{args:null,kind:"FragmentSpread",name:"VideoPlayerWatchAndScrollControl_video"},{args:null,kind:"FragmentSpread",name:"LiveVideoLatencyMenuContextProvider_video"},{args:null,kind:"FragmentSpread",name:"VideoPlayerCaptionsControl_video"},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"if_viewer_can_see_community_moderation_tools",plural:!1,selections:[{args:null,documentName:"VideoPlayerLiveVideoControls_video",fragmentName:"VideoPlayerModeratorControl_video",fragmentPropName:"video",kind:"ModuleImport"}],storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"if_viewer_can_use_live_rewind",plural:!1,selections:[{args:null,documentName:"VideoPlayerLiveVideoControls_video_if_viewer_can_use_live_rewind",fragmentName:"VideoPlayerLiveRewindControlsGroup_video",fragmentPropName:"video",kind:"ModuleImport"}],storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"if_viewer_can_use_clipping",plural:!1,selections:[{args:null,documentName:"VideoPlayerLiveVideoControls_video_if_viewer_can_use_clipping",fragmentName:"VideoPlayerClipVideoControl_video",fragmentPropName:"video",kind:"ModuleImport"}],storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"if_viewer_can_see_costreaming_tools",plural:!1,selections:[{args:null,documentName:"VideoPlayerLiveVideoControls_video_if_viewer_can_see_costreaming_tools",fragmentName:"VideoPlayerCostreamingControl_video",fragmentPropName:"video",kind:"ModuleImport"}],storageKey:null}],type:"Video",abstractKey:null}})();a.exports=e}),null);
__d("VideoPlayerQuietModeControl.react",["fbt","ix","CometTahoeSidePaneContext","VideoPlayerControlIcon.react","fbicon","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s,u){"use strict";var e,c=e||(e=o("react")),d=e.useContext;function m(){var e=o("react-compiler-runtime").c(12),t=d(r("CometTahoeSidePaneContext")),n=t.rightRailHidden,a=t.setRightRailHidden,i;e[0]!==n?(i=n?s._(/*BTDS*/"Show comments and reactions"):s._(/*BTDS*/"Hide comments and reactions"),e[0]=n,e[1]=i):i=e[1];var l=i,m;e[2]===Symbol.for("react.memo_cache_sentinel")?(m={className:"x1rg5ohu x1k70j0n xbelrpt xzueoph xdzw4kq"},e[2]=m):m=e[2];var p;e[3]!==n?(p=n?o("fbicon")._(u("942218"),20):o("fbicon")._(u("942221"),20),e[3]=n,e[4]=p):p=e[4];var _;e[5]!==n||e[6]!==a?(_=function(){a(!n)},e[5]=n,e[6]=a,e[7]=_):_=e[7];var f;return e[8]!==l||e[9]!==p||e[10]!==_?(f=c.jsx("div",babelHelpers.extends({},m,{children:c.jsx(r("VideoPlayerControlIcon.react"),{icon:p,label:l,onPress:_,tooltip:l})})),e[8]=l,e[9]=p,e[10]=_,e[11]=f):f=e[11],f}l.default=m}),226);
__d("VideoPlayerSettingsMenuQualityPaneToggle.react",["fbt","ix","CometImage.react","CometPressable.react","VideoPlayerSettingsMenu.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s,u){"use strict";var e,c=e||(e=o("react")),d={pressableOption:{width:"xh8yej3",$$css:!0}};function m(e){var t=o("react-compiler-runtime").c(14),n=e.selectedVideoQuality,a=e.setPane,i=e.targetVideoQuality,l;t[0]!==a?(l=function(){a(o("VideoPlayerSettingsMenu.react").VideoPlayerSettingsMenuPaneType.QUALITY)},t[0]=a,t[1]=l):l=t[1];var m,p;t[2]===Symbol.for("react.memo_cache_sentinel")?(m=c.jsx("div",{className:"x1ypdohk x1s688f",children:s._(/*BTDS*/"Quality")}),p={className:"x6s0dn4 x14ctfv x1ypdohk x78zum5 x1bhwmg6 x13a6bvl x13fj5qh x450l9j"},t[2]=m,t[3]=p):(m=t[2],p=t[3]);var _;t[4]!==n||t[5]!==i?(_=n==="notselected"?c.jsx("span",{"data-testid":void 0,children:"\xA0"}):n==="auto"?c.jsxs(c.Fragment,{children:[c.jsx("span",{"data-testid":void 0,children:s._(/*BTDS*/"Auto")}),i!=null?c.jsxs(c.Fragment,{children:[c.jsx("span",{children:"\xA0"}),c.jsx("span",{"data-testid":void 0,children:i})]}):null]}):c.jsx("span",{"data-testid":void 0,children:n}),t[4]=n,t[5]=i,t[6]=_):_=t[6];var f;t[7]===Symbol.for("react.memo_cache_sentinel")?(f={className:"x3nfvp2 xmgb6t1 xwklpps"},t[7]=f):f=t[7];var g;t[8]===Symbol.for("react.memo_cache_sentinel")?(g=c.jsx("span",babelHelpers.extends({},f,{children:c.jsx(r("CometImage.react"),{isDecorative:!0,src:u("480587")})})),t[8]=g):g=t[8];var h;t[9]!==_?(h=c.jsxs("div",babelHelpers.extends({},p,{children:[_,g]})),t[9]=_,t[10]=h):h=t[10];var y;return t[11]!==l||t[12]!==h?(y=c.jsxs(r("CometPressable.react"),{onPress:l,testid:void 0,xstyle:d.pressableOption,children:[m,h]}),t[11]=l,t[12]=h,t[13]=y):y=t[13],y}l.default=m}),226);
__d("VideoPlayerSettingsMenu.react",["fbt","$InternalEnum","CometAudioLanguageUtils","CometErrorBoundary.react","CometKeys","CometPlaceholder.react","CometRelay","FBLogger","LiveVideoLatencyMenu.react","PlaybackSpeedExperiments","VideoPlayerHooks","VideoPlayerSettingsMenuAudioTrackPane.react","VideoPlayerSettingsMenuMainPane.react","VideoPlayerSettingsMenuPlaybackSpeedPane.react","VideoPlayerSettingsMenuQualityPane.react","react","react-compiler-runtime","useLayerKeyCommands","useVideoPlayerControllerSubscription"],(function(t,n,r,o,a,i,l,s){"use strict";var e=["label"],u,c,d=u||(u=o("react")),m=u,p=m.useCallback,_=m.useContext,f=m.useEffect,g=m.useMemo,h=m.useRef,y=m.useState,C=n("$InternalEnum")({LATENCY:"latency",MAIN:"main",PLAYBACK_SPEED:"playbackSpeed",QUALITY:"quality",AUDIO:"audio"});function b(e){var t=o("react-compiler-runtime").c(60),n=e.children,a=e.disableDubbing,l=e.dubTrackMapping,u=e.forceShowPlaybackRateControl,m=e.onClose,p=e.videoID,g=n===void 0?null:n,b=a===void 0?!1:a,S=(c||(c=o("VideoPlayerHooks"))).useCaptionsLoaded(),R=c.useCaptionsVisible(),L=c.useSelectedVideoQuality(),E=c.useController(),k;t[0]!==E?(k=function(){return E.getCurrentState().availableAudioTracks},t[0]=E,t[1]=k):k=t[1];var I=r("useVideoPlayerControllerSubscription")(k),T;t[2]!==E?(T=function(){return E.getCurrentState().targetAudioTrack},t[2]=E,t[3]=T):T=t[3];var D=r("useVideoPlayerControllerSubscription")(T),x=o("CometAudioLanguageUtils").useGetAllAvailableTracks(I,l),$;t[4]!==x.allAvailableTracks?($=x.allAvailableTracks.map(v),t[4]=x.allAvailableTracks,t[5]=$):$=t[5];var P=$,N=c.useInbandCaptionsAutogenerated(),M=c.useTargetVideoQuality(),w=y(C.MAIN),A=w[0],F=w[1],O=y(R),B=O[0],W=O[1],q=c.usePlaybackRate(),U=c.useIsLive(),V=c.useIsLiveRewindActive(),H=_(o("LiveVideoLatencyMenu.react").LiveVideoLatencyMenuContext),G=H.liveVideoLatencyMenuPaneMatchPointer,z=c.useShouldShowPlaybackRateControl(),j;t[6]!==u||t[7]!==z?(j=u===!0||o("PlaybackSpeedExperiments").enableCometPlaybackSpeedControl()&&z,t[6]=u,t[7]=z,t[8]=j):j=t[8];var K=j,Q,X;t[9]!==U||t[10]!==V||t[11]!==A?(Q=function(){U&&!V&&A===C.PLAYBACK_SPEED&&F(C.MAIN)},X=[V,F,U,A],t[9]=U,t[10]=V,t[11]=A,t[12]=Q,t[13]=X):(Q=t[12],X=t[13]),f(Q,X);var Y;t[14]!==P.length||t[15]!==A?(Y=function(){P.length<=1&&A===C.AUDIO&&F(C.MAIN)},t[14]=P.length,t[15]=A,t[16]=Y):Y=t[16];var J;t[17]!==P||t[18]!==A?(J=[P,A],t[17]=P,t[18]=A,t[19]=J):J=t[19],f(Y,J);var Z=h(null),ee=h(null),te;t[20]!==m?(te=function(t){var e=Z.current,n=ee.current,r=t.target;e!=null&&n!=null&&r instanceof HTMLElement&&document.contains(r)&&!e.contains(r)&&n.contains(r)&&m()},t[20]=m,t[21]=te):te=t[21];var ne=te,re,oe;t[22]!==ne?(re=function(){return document.addEventListener("click",ne),(function(){document.removeEventListener("click",ne)})},oe=[ne],t[22]=ne,t[23]=re,t[24]=oe):(re=t[23],oe=t[24]),f(re,oe);var ae,ie;t[25]===Symbol.for("react.memo_cache_sentinel")?(ae={key:r("CometKeys").ESCAPE},ie=s._(/*BTDS*/"Close video settings menu"),t[25]=ae,t[26]=ie):(ae=t[25],ie=t[26]);var le;t[27]!==m?(le=[{command:ae,description:ie,handler:function(){m()}}],t[27]=m,t[28]=le):le=t[28];var se=le;r("useLayerKeyCommands")(se);var ue=D!=null?D:null,ce;t[29]!==P||t[30]!==S||t[31]!==B||t[32]!==g||t[33]!==b||t[34]!==N||t[35]!==U||t[36]!==q||t[37]!==L||t[38]!==K||t[39]!==ue||t[40]!==M?(ce=d.jsx(r("VideoPlayerSettingsMenuMainPane.react"),{availableAudioTracks:P,captionsLoaded:S,captionsVisibleOptimistic:B,disableDubbing:b,inbandCaptionsAutogenerated:N,isLive:U,playbackRate:q,selectedVideoQuality:L,setIsCaptionsVisible:W,setPane:F,shouldEnablePlaybackRateSupport:K,targetAudioTrack:ue,targetVideoQuality:M,children:g}),t[29]=P,t[30]=S,t[31]=B,t[32]=g,t[33]=b,t[34]=N,t[35]=U,t[36]=q,t[37]=L,t[38]=K,t[39]=ue,t[40]=M,t[41]=ce):ce=t[41];var de=ce;e:switch(A){case C.LATENCY:{if(G==null){r("FBLogger")("gaming_video").mustfix("Latency components should not be null");break e}var me;t[42]===Symbol.for("react.memo_cache_sentinel")?(me={setPane:F},t[42]=me):me=t[42];var pe;t[43]!==G?(pe=d.jsx(r("CometErrorBoundary.react"),{children:d.jsx(r("CometPlaceholder.react"),{fallback:null,name:i.id,children:d.jsx(o("CometRelay").MatchContainer,{match:G,props:me})})}),t[43]=G,t[44]=pe):pe=t[44],de=pe;break e}case C.MAIN:break e;case C.PLAYBACK_SPEED:{var _e;t[45]!==q?(_e=d.jsx(r("VideoPlayerSettingsMenuPlaybackSpeedPane.react"),{playbackRate:q,setPane:F}),t[45]=q,t[46]=_e):_e=t[46],de=_e;break e}case C.QUALITY:{var fe;t[47]!==L?(fe=d.jsx(r("VideoPlayerSettingsMenuQualityPane.react"),{selectedVideoQuality:L,setPane:F}),t[47]=L,t[48]=fe):fe=t[48],de=fe;break e}case C.AUDIO:{var ge;if(t[49]!==x.originalLanguage||t[50]!==P||t[51]!==U||t[52]!==D||t[53]!==p){var he;ge=!U&&P.length>1?d.jsx(r("VideoPlayerSettingsMenuAudioTrackPane.react"),{availableAudioTracks:P,originalVideoLanguage:(he=x.originalLanguage)!=null?he:null,setPane:F,targetAudioTrack:D!=null?D:null,videoID:p!=null?p:null}):null,t[49]=x.originalLanguage,t[50]=P,t[51]=U,t[52]=D,t[53]=p,t[54]=ge}else ge=t[54];de=ge}}var ye;t[55]!==de?(ye=d.jsx("div",{ref:Z,children:de}),t[55]=de,t[56]=ye):ye=t[56];var Ce;t[57]===Symbol.for("react.memo_cache_sentinel")?(Ce=d.jsx("div",{className:"xjbqb8w x5yr21d x1o0tod xg6iff7 x1g81zrj xixxii4 x13vifvy xh8yej3 x8knxv4","data-testid":void 0,ref:ee}),t[57]=Ce):Ce=t[57];var be;return t[58]!==ye?(be=d.jsxs(d.Fragment,{children:[ye,Ce]}),t[58]=ye,t[59]=be):be=t[59],be}function v(t){var n=t.label,r=babelHelpers.objectWithoutPropertiesLoose(t,e);return r}l.VideoPlayerSettingsMenuPaneType=C,l.VideoPlayerSettingsMenu=b}),226);
__d("VideoPlayerSettingsMenuAudioTrackPane.react",["ix","AutoDubbingConsumptionFalcoEvent","CometAudioLanguageMenuItemsMutation","CometFeedStoryMetaSectionMiddot.react","CometImage.react","CometPressable.react","CometRelay","CometVideoPlayerAutoDubbingWWWStrings","CurrentLocale","FDSTextPairing.react","FocusRegion.react","VideoPlayerAudioTrackUtils","VideoPlayerHooks","VideoPlayerSettingsMenu.react","focusScopeQueries","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=e||(e=o("react")),d=e,m=d.useEffect,p=d.useRef,_={menuOptionRow:{color:"x14ctfv",display:"x1lliihq",minWidth:"xfvyar9",outline:"x1a2a7pz",paddingTop:"xyqdw3p",paddingInlineEnd:"xyri2b",paddingBottom:"xg8j3zb",paddingInlineStart:"x1c1uobl",textAlign:"x1yc453h",$$css:!0},pressableOption:{width:"xh8yej3",$$css:!0}};function f(e){var t=o("react-compiler-runtime").c(31),n=e.availableAudioTracks,a=e.originalVideoLanguage,i=e.setPane,l=e.targetAudioTrack,d=e.videoID,f=(u||(u=o("VideoPlayerHooks"))).useController(),g=o("CometRelay").useMutation(o("CometAudioLanguageMenuItemsMutation").setUserPreferredAudioLanguageDataMutation),h=g[0],y;t[0]!==h?(y=function(t){t!=null&&h({variables:{input:{language_code:t}}})},t[0]=h,t[1]=y):y=t[1];var C=y,b;t[2]!==d?(b=function(t,n,o,a,i){var e={client_extra_data:{dubbing_type_from:o==null?"original":o,dubbing_type_to:a==null?"original":a,lang_from:t!=null?t:"original",lang_to:n!=null?n:"original"},event:i,video_id:d!=null?d:""};r("AutoDubbingConsumptionFalcoEvent").log(function(){return e})},t[2]=d,t[3]=b):b=t[3];var v=b,S;t[4]!==a?(S=function(t){var e,n=(e=t==null?void 0:t.lang)!=null?e:null;return(t==null?void 0:t.lang)===null&&t.role==null&&(n=a!=null?a:null),n},t[4]=a,t[5]=S):S=t[5];var R=S,L=p(null),E=function(t){var e=R(t),n=R(l);f.selectVideoVariant({lang:t.lang,role:t.role}),C(e),v(n,e,l==null?void 0:l.role,t.role,"fb_reel_auto_dub_consumption_preferred_language_changed"),L.current!=null&&L.current.remove(),L.current=f.subscribe(function(){var r;if(((r=f.getCurrentState().targetAudioTrack)==null?void 0:r.id)===t.id){var o;v(n,e,l==null?void 0:l.role,t.role,"fb_reel_auto_dub_consumption"),(o=L.current)==null||o.remove()}})},k;t[6]!==f?(k=[f],t[6]=f,t[7]=k):k=t[7],m(function(){return function(){var e;(e=L.current)==null||e.remove()}},k);var I;t[8]!==a?(I=function(t){var e=t==null?void 0:t.lang;e==null&&(t==null?void 0:t.role)==null&&(e=a!=null?a:null);var n=o("VideoPlayerAudioTrackUtils").getIntlDisplayName(r("CurrentLocale").get(),e),i=null;return t.role==null?i=n==null?c.jsx("div",{children:o("CometVideoPlayerAutoDubbingWWWStrings").ORIGINAL_AUDIO_LABEL}):c.jsxs("div",{children:[o("CometVideoPlayerAutoDubbingWWWStrings").getLanguageLabel(n),c.jsx(r("CometFeedStoryMetaSectionMiddot.react"),{}),o("CometVideoPlayerAutoDubbingWWWStrings").ORIGINAL_AUDIO_LABEL]}):n!=null&&(i=o("CometVideoPlayerAutoDubbingWWWStrings").getLanguageLabel(n)),i},t[8]=a,t[9]=I):I=t[9];var T=I,D=o("FocusRegion.react").FocusRegion,x=o("focusScopeQueries").headerFirstTabbableSecondScopeQuery,$=o("focusScopeQueries").headerFirstTabbableSecondScopeQuery,P="VideoPlayerSettingsMenu/changeAudioTrackPane",N;t[10]===Symbol.for("react.memo_cache_sentinel")?(N={className:"x6s0dn4 x14ctfv x1ypdohk x78zum5 x1s688f x1lku1pv"},t[10]=N):N=t[10];var M;t[11]!==i?(M=function(){return i(o("VideoPlayerSettingsMenu.react").VideoPlayerSettingsMenuPaneType.MAIN)},t[11]=i,t[12]=M):M=t[12];var w;t[13]===Symbol.for("react.memo_cache_sentinel")?(w={className:"x6s0dn4 x3nfvp2 xmgb6t1 x165d6jo"},t[13]=w):w=t[13];var A;t[14]===Symbol.for("react.memo_cache_sentinel")?(A=c.jsx("span",babelHelpers.extends({},w,{children:c.jsx(r("CometImage.react"),{src:s("480579")})})),t[14]=A):A=t[14];var F;t[15]!==M?(F=c.jsx("div",babelHelpers.extends({},N,{children:c.jsxs(r("CometPressable.react"),{onPress:M,testid:void 0,xstyle:_.pressableOption,children:[A,o("CometVideoPlayerAutoDubbingWWWStrings").VOD_TRANSLATIONS_MENU_ITEM]})})),t[15]=M,t[16]=F):F=t[16];var O,B;t[17]===Symbol.for("react.memo_cache_sentinel")?(O=c.jsx("div",{className:"x1j9u4d2 xyamay9",children:c.jsx(r("FDSTextPairing.react"),{body:o("CometVideoPlayerAutoDubbingWWWStrings").VOD_TRANSLATIONS_DESCRIPTION,bodyColor:"white",level:4})}),B={className:"x1hm9lzh x1anpbxc xn80e1m"},t[17]=O,t[18]=B):(O=t[17],B=t[18]);var W="VideoPlayerSettingsMenu/changeAudioTrackPaneList",q=n.map(function(e){var t=(l==null?void 0:l.id)===e.id,n=T(e);if(n!=null)return c.jsx("div",{children:c.jsxs(r("CometPressable.react"),{onPress:function(){return E(e)},testid:void 0,xstyle:_.menuOptionRow,children:[c.jsx("div",{className:"xiakxrv x1rgw4pv x1vjm0to xnqoqkk x16lu3ki x1rg5ohu xmgb6t1 x1sa5p1d x1yrsyyn x1icxu4v x10b6aqq x25sj25",children:t&&c.jsx("div",{className:"x14hiurz x13t61ll x1kchd1x x1u0fnx4 xbxn0j6 x1rg5ohu xqu0tyb xe9ewy2 x1kgmq87 x10l6tqk x51ohtg","data-testid":void 0})}),c.jsx("div",babelHelpers.extends({},{0:{className:"x1ypdohk x1rg5ohu"},1:{className:"x1ypdohk x1rg5ohu x1s688f"}}[!!t<<0],{"data-testid":void 0,children:n}))]})},e.id)}),U;t[19]!==B||t[20]!==q?(U=c.jsx("div",babelHelpers.extends({},B,{"data-testid":void 0,children:q})),t[19]=B,t[20]=q,t[21]=U):U=t[21];var V;t[22]!==F||t[23]!==O||t[24]!==U?(V=c.jsxs("div",{"data-testid":void 0,children:[F,O,U]}),t[22]=F,t[23]=O,t[24]=U,t[25]=V):V=t[25];var H;return t[26]!==D||t[27]!==V||t[28]!==x||t[29]!==$?(H=c.jsx(D,{autoFocusQuery:x,recoverFocusQuery:$,children:V}),t[26]=D,t[27]=V,t[28]=x,t[29]=$,t[30]=H):H=t[30],H}l.default=f}),98);
__d("VideoPlayerSettingsMenuMainPane.react",["CometErrorBoundary.react","CometPlaceholder.react","CometRelay","FocusRegion.react","LiveVideoLatencyMenu.react","VideoPlayerSettingsMenuPlaybackPaneToggle.react","VideoPlayerSettingsMenuQualityPaneToggle.react","deferredLoadComponent","focusScopeQueries","gkx","react","react-compiler-runtime","requireDeferredForDisplay"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e.useContext,c=r("deferredLoadComponent")(r("requireDeferredForDisplay")("VideoPlayerSettingsMenuAudioTrackPaneToggle.react").__setRef("VideoPlayerSettingsMenuMainPane.react"));function d(e){var t=o("react-compiler-runtime").c(23),n=e.availableAudioTracks,a=e.children,l=e.disableDubbing,d=e.isLive,m=e.playbackRate,p=e.selectedVideoQuality,_=e.setPane,f=e.shouldEnablePlaybackRateSupport,g=e.targetAudioTrack,h=e.targetVideoQuality,y=l===void 0?!1:l,C=u(o("LiveVideoLatencyMenu.react").LiveVideoLatencyMenuContext),b=C.liveVideoLatencyMenuPaneToggleMatchPointer,v=!y&&!d&&n.length>1?r("gkx")("24336"):!1,S;t[0]===Symbol.for("react.memo_cache_sentinel")?(S={className:"x14ctfv x78zum5 x1hoihq8 x1lku1pv"},t[0]=S):S=t[0];var R;t[1]!==p||t[2]!==_||t[3]!==h?(R=s.jsx("div",babelHelpers.extends({},S,{children:s.jsx(r("VideoPlayerSettingsMenuQualityPaneToggle.react"),{selectedVideoQuality:p,setPane:_,targetVideoQuality:h})})),t[1]=p,t[2]=_,t[3]=h,t[4]=R):R=t[4];var L;t[5]!==_||t[6]!==v||t[7]!==g?(L=v&&s.jsx("div",{className:"x14ctfv x78zum5 x1hoihq8 x1lku1pv",children:s.jsx(c,{setPane:_,targetAudioTrack:g})}),t[5]=_,t[6]=v,t[7]=g,t[8]=L):L=t[8];var E;t[9]===Symbol.for("react.memo_cache_sentinel")?(E={className:"x14ctfv x78zum5 x1hoihq8 x1lku1pv"},t[9]=E):E=t[9];var k;t[10]!==m||t[11]!==_||t[12]!==f?(k=s.jsx("div",babelHelpers.extends({},E,{children:s.jsx(r("VideoPlayerSettingsMenuPlaybackPaneToggle.react"),{playbackRate:m,setPane:_,shouldEnablePlaybackRateSupport:f})})),t[10]=m,t[11]=_,t[12]=f,t[13]=k):k=t[13];var I;t[14]!==b||t[15]!==_?(I=b!=null&&s.jsx("div",{className:"x14ctfv x78zum5 x1hoihq8 x1lku1pv",children:s.jsx(r("CometErrorBoundary.react"),{children:s.jsx(r("CometPlaceholder.react"),{fallback:null,name:i.id,children:s.jsx(o("CometRelay").MatchContainer,{match:b,props:{setPane:_}})})})}),t[14]=b,t[15]=_,t[16]=I):I=t[16];var T;return t[17]!==a||t[18]!==R||t[19]!==L||t[20]!==k||t[21]!==I?(T=s.jsx(o("FocusRegion.react").FocusRegion,{autoFocusQuery:o("focusScopeQueries").headerFirstTabbableSecondScopeQuery,recoverFocusQuery:o("focusScopeQueries").headerFirstTabbableSecondScopeQuery,children:s.jsxs("div",{"data-testid":void 0,children:[R,L,k,I,a]})}),t[17]=a,t[18]=R,t[19]=L,t[20]=k,t[21]=I,t[22]=T):T=t[22],T}l.default=d}),98);
__d("VideoPlayerSettingsMenuPlaybackPaneToggle.react",["fbt","ix","CometImage.react","CometPressable.react","VideoPlayerSettingsMenu.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s,u){"use strict";var e,c=e||(e=o("react")),d={pressableOption:{width:"xh8yej3",$$css:!0}};function m(e){var t=o("react-compiler-runtime").c(13),n=e.playbackRate,a=e.setPane,i=e.shouldEnablePlaybackRateSupport;if(!i)return null;var l;t[0]!==a?(l=function(){a(o("VideoPlayerSettingsMenu.react").VideoPlayerSettingsMenuPaneType.PLAYBACK_SPEED)},t[0]=a,t[1]=l):l=t[1];var m,p;t[2]===Symbol.for("react.memo_cache_sentinel")?(m=c.jsx("div",{className:"x1ypdohk x1s688f",children:s._(/*BTDS*/"Playback Speed")}),p={className:"x6s0dn4 x14ctfv x1ypdohk x78zum5 x1bhwmg6 x13a6bvl x13fj5qh x450l9j"},t[2]=m,t[3]=p):(m=t[2],p=t[3]);var _;t[4]!==n?(_=c.jsx("span",{"data-testid":void 0,children:n}),t[4]=n,t[5]=_):_=t[5];var f;t[6]===Symbol.for("react.memo_cache_sentinel")?(f={className:"x3nfvp2 xmgb6t1 xwklpps"},t[6]=f):f=t[6];var g;t[7]===Symbol.for("react.memo_cache_sentinel")?(g=c.jsx("span",babelHelpers.extends({},f,{children:c.jsx(r("CometImage.react"),{isDecorative:!0,src:u("480587")})})),t[7]=g):g=t[7];var h;t[8]!==_?(h=c.jsxs("div",babelHelpers.extends({},p,{children:[_,g]})),t[8]=_,t[9]=h):h=t[9];var y;return t[10]!==l||t[11]!==h?(y=c.jsxs(r("CometPressable.react"),{onPress:l,testid:void 0,xstyle:d.pressableOption,children:[m,h]}),t[10]=l,t[11]=h,t[12]=y):y=t[12],y}l.default=m}),226);
__d("VideoPlayerSettingsMenuPlaybackSpeedPane.react",["fbt","ix","CometImage.react","CometPressable.react","FocusRegion.react","VideoPlayerHooks","VideoPlayerSettingsMenu.react","focusScopeQueries","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s,u){"use strict";var e,c,d=e||(e=o("react")),m={menuOptionRow:{color:"x14ctfv",display:"x1lliihq",minWidth:"xfvyar9",outline:"x1a2a7pz",paddingTop:"xyqdw3p",paddingInlineEnd:"xyri2b",paddingBottom:"xg8j3zb",paddingInlineStart:"x1c1uobl",textAlign:"x1yc453h",$$css:!0},pressableOption:{width:"xh8yej3",$$css:!0}};function p(e){var t=o("react-compiler-runtime").c(15),n=e.playbackRate,a=e.setPane,i=(c||(c=o("VideoPlayerHooks"))).useController(),l;t[0]===Symbol.for("react.memo_cache_sentinel")?(l={className:"x6s0dn4 x14ctfv x1ypdohk x78zum5 x1s688f x1lku1pv"},t[0]=l):l=t[0];var p;t[1]!==a?(p=function(){return a(o("VideoPlayerSettingsMenu.react").VideoPlayerSettingsMenuPaneType.MAIN)},t[1]=a,t[2]=p):p=t[2];var _;t[3]===Symbol.for("react.memo_cache_sentinel")?(_={className:"x3nfvp2 xmgb6t1 x165d6jo"},t[3]=_):_=t[3];var f,g;t[4]===Symbol.for("react.memo_cache_sentinel")?(f=d.jsx("span",babelHelpers.extends({},_,{children:d.jsx(r("CometImage.react"),{isDecorative:!0,src:u("480579")})})),g=s._(/*BTDS*/"Playback Speed"),t[4]=f,t[5]=g):(f=t[4],g=t[5]);var h;t[6]!==p?(h=d.jsx("div",babelHelpers.extends({},l,{children:d.jsxs(r("CometPressable.react"),{onPress:p,testid:void 0,xstyle:m.pressableOption,children:[" ",f,g]})})),t[6]=p,t[7]=h):h=t[7];var y;t[8]===Symbol.for("react.memo_cache_sentinel")?(y={className:"x1hm9lzh x1anpbxc"},t[8]=y):y=t[8];var C;t[9]!==i||t[10]!==n?(C=d.jsx("div",babelHelpers.extends({},y,{"data-testid":void 0,children:[.5,.75,1,1.25,1.5,1.75,2].map(function(e){var t=n===e,o=t?s._(/*BTDS*/"Set the playback speed to {playback_rate_option}, selected",[s._param("playback_rate_option",e)]):s._(/*BTDS*/"Set the playback speed to {playback_rate_option}",[s._param("playback_rate_option",e)]);return d.jsx("div",{children:d.jsxs(r("CometPressable.react"),{"aria-checked":t,"aria-label":o,onPress:function(){i.setPlaybackRate(e)},testid:void 0,xstyle:m.menuOptionRow,children:[d.jsx("div",{className:"x17j41np x1rgw4pv x1vjm0to xnqoqkk x16lu3ki x1rg5ohu xmgb6t1 x1sa5p1d x1yrsyyn x1icxu4v x10b6aqq x25sj25",children:t&&d.jsx("div",{className:"x14hiurz x13t61ll x1kchd1x x1u0fnx4 xbxn0j6 x1rg5ohu xqu0tyb xe9ewy2 x1kgmq87 x10l6tqk x51ohtg","data-testid":void 0})}),d.jsx("div",babelHelpers.extends({},{0:{className:"x1ypdohk x1rg5ohu"},1:{className:"x1ypdohk x1rg5ohu x1s688f"}}[!!t<<0],{"data-testid":void 0,children:e}))]})},e)})})),t[9]=i,t[10]=n,t[11]=C):C=t[11];var b;return t[12]!==h||t[13]!==C?(b=d.jsx(o("FocusRegion.react").FocusRegion,{autoFocusQuery:o("focusScopeQueries").headerFirstTabbableSecondScopeQuery,recoverFocusQuery:o("focusScopeQueries").headerFirstTabbableSecondScopeQuery,children:d.jsxs("div",{"data-testid":void 0,children:[h,C]})}),t[12]=h,t[13]=C,t[14]=b):b=t[14],b}l.default=p}),226);
__d("VideoPlayerSettingsMenuQualityPane.react",["fbt","ix","CometImage.react","CometPressable.react","FocusRegion.react","VideoPlayerHooks","VideoPlayerSettingsMenu.react","focusScopeQueries","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s,u){"use strict";var e,c,d=e||(e=o("react")),m={menuOptionRow:{color:"x14ctfv",display:"x1lliihq",minWidth:"xfvyar9",outline:"x1a2a7pz",paddingTop:"xyqdw3p",paddingInlineEnd:"xyri2b",paddingBottom:"xg8j3zb",paddingInlineStart:"x1c1uobl",textAlign:"x1yc453h",$$css:!0},pressableOption:{width:"xh8yej3",$$css:!0}};function p(e){var t=o("react-compiler-runtime").c(26),n=e.selectedVideoQuality,a=e.setPane,i=(c||(c=o("VideoPlayerHooks"))).useAvailableVideoQualities(),l=c.useIsAbrEnabled(),p=c.useController(),_;t[0]===Symbol.for("react.memo_cache_sentinel")?(_={className:"x6s0dn4 x14ctfv x1ypdohk x78zum5 x1s688f x1lku1pv"},t[0]=_):_=t[0];var f;t[1]!==a?(f=function(){return a(o("VideoPlayerSettingsMenu.react").VideoPlayerSettingsMenuPaneType.MAIN)},t[1]=a,t[2]=f):f=t[2];var g;t[3]===Symbol.for("react.memo_cache_sentinel")?(g={className:"x6s0dn4 x3nfvp2 xmgb6t1 x165d6jo"},t[3]=g):g=t[3];var h,y;t[4]===Symbol.for("react.memo_cache_sentinel")?(h=d.jsx("span",babelHelpers.extends({},g,{children:d.jsx(r("CometImage.react"),{isDecorative:!0,src:u("480579")})})),y=s._(/*BTDS*/"Quality"),t[4]=h,t[5]=y):(h=t[4],y=t[5]);var C;t[6]!==f?(C=d.jsx("div",babelHelpers.extends({},_,{children:d.jsxs(r("CometPressable.react"),{onPress:f,testid:void 0,xstyle:m.pressableOption,children:[h,y]})})),t[6]=f,t[7]=C):C=t[7];var b;t[8]===Symbol.for("react.memo_cache_sentinel")?(b={className:"x1hm9lzh x1anpbxc"},t[8]=b):b=t[8];var v;t[9]!==p||t[10]!==l||t[11]!==n?(v=l?d.jsx("div",{children:d.jsxs(r("CometPressable.react"),{onPress:function(){p.selectVideoQuality("auto")},testid:void 0,xstyle:m.menuOptionRow,children:[d.jsx("div",{className:"xiakxrv x1rgw4pv x1vjm0to xnqoqkk x16lu3ki x1rg5ohu xmgb6t1 x1sa5p1d x1yrsyyn x1icxu4v x10b6aqq x25sj25",children:n==="auto"&&d.jsx("div",{className:"x14hiurz x13t61ll x1kchd1x x1u0fnx4 xbxn0j6 x1rg5ohu xqu0tyb xe9ewy2 x1kgmq87 x10l6tqk x51ohtg","data-testid":void 0})}),d.jsx("div",babelHelpers.extends({},{0:{className:"x1ypdohk x1rg5ohu"},1:{className:"x1ypdohk x1rg5ohu x1s688f"}}[(n==="auto")<<0],{"data-testid":void 0,children:s._(/*BTDS*/"Auto")}))]})},"auto"):null,t[9]=p,t[10]=l,t[11]=n,t[12]=v):v=t[12];var S;if(t[13]!==i||t[14]!==p||t[15]!==n){var R;t[17]!==p||t[18]!==n?(R=function(t){var e=n===t;return d.jsx("div",{children:d.jsxs(r("CometPressable.react"),{onPress:function(){p.selectVideoQuality(t)},testid:void 0,xstyle:m.menuOptionRow,children:[d.jsx("div",{className:"xiakxrv x1rgw4pv x1vjm0to xnqoqkk x16lu3ki x1rg5ohu xmgb6t1 x1sa5p1d x1yrsyyn x1icxu4v x10b6aqq x25sj25",children:e&&d.jsx("div",{className:"x14hiurz x13t61ll x1kchd1x x1u0fnx4 xbxn0j6 x1rg5ohu xqu0tyb xe9ewy2 x1kgmq87 x10l6tqk x51ohtg","data-testid":void 0})}),d.jsx("div",babelHelpers.extends({},{0:{className:"x1ypdohk x1rg5ohu"},1:{className:"x1ypdohk x1rg5ohu x1s688f"}}[!!e<<0],{"data-testid":void 0,children:t}))]})},t)},t[17]=p,t[18]=n,t[19]=R):R=t[19],S=i.map(R).reverse(),t[13]=i,t[14]=p,t[15]=n,t[16]=S}else S=t[16];var L;t[20]!==v||t[21]!==S?(L=d.jsxs("div",babelHelpers.extends({},b,{"data-testid":void 0,children:[v,S]})),t[20]=v,t[21]=S,t[22]=L):L=t[22];var E;return t[23]!==L||t[24]!==C?(E=d.jsx(o("FocusRegion.react").FocusRegion,{autoFocusQuery:o("focusScopeQueries").headerFirstTabbableSecondScopeQuery,recoverFocusQuery:o("focusScopeQueries").headerFirstTabbableSecondScopeQuery,children:d.jsxs("div",{"data-testid":void 0,children:[C,L]})}),t[23]=L,t[24]=C,t[25]=E):E=t[25],E}l.default=p}),226);
__d("VideoPlayerSettingsControl.react",["fbt","ix","VideoPlayerContexts","VideoPlayerControlIcon.react","VideoPlayerDefaultControlsProperties","VideoPlayerSettingsMenu.react","VideoPlayerUserInteractionCounter","fbicon","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s,u){"use strict";var e,c,d=e||(e=o("react")),m=e,p=m.useContext,_=m.useState;function f(e){var t=o("react-compiler-runtime").c(30),n=e.alignMenuToIcon,a=e.children,i=e.compactMenu,l=e.dubTrackMapping,m=e.forceShowPlaybackRateControl,f=e.icon,g=e.menuOpened,h=e.onMenuOpen,y=e.onUserInteraction,C=e.ref,b=e.setMenuOpened,v=e.videoID,S=n===void 0?!1:n,R=a===void 0?null:a,L=_(!1),E=L[0],k=L[1],I=p((c||(c=o("VideoPlayerContexts"))).DisableDubbingContext),T;t[0]===Symbol.for("react.memo_cache_sentinel")?(T=s._(/*BTDS*/"Settings"),t[0]=T):T=t[0];var D=T,x=b!=null;o("VideoPlayerUserInteractionCounter").useVideoPlayerUserInteraction("video_settings_menu",x?g===o("VideoPlayerDefaultControlsProperties").VideoMenuType.VIDEO_SETTINGS_MENU:E,y);var $=x?g===o("VideoPlayerDefaultControlsProperties").VideoMenuType.VIDEO_SETTINGS_MENU:E,P;t[1]!==S?(P={0:{className:"x1rg5ohu x1k70j0n xbelrpt xzueoph xdzw4kq"},1:{className:"x1rg5ohu x1k70j0n xbelrpt xzueoph xdzw4kq x1n2onr6 xuxw1ft"}}[(S===!0)<<0],t[1]=S,t[2]=P):P=t[2];var N;t[3]!==S||t[4]!==R||t[5]!==i||t[6]!==I||t[7]!==l||t[8]!==m||t[9]!==x||t[10]!==$||t[11]!==b||t[12]!==v?(N=$&&d.jsx("div",babelHelpers.extends({},{0:{className:"xjb1437 xacj9c0 x14ctfv x89ytp0 x889kno x1x5flf6 x1a8lsjc xwn43p0 x10l6tqk x1fwd5yv"},2:{className:"xjb1437 xacj9c0 x14ctfv x89ytp0 x889kno x1x5flf6 x1a8lsjc xwn43p0 x10l6tqk xwjie4w"},1:{className:"xjb1437 xacj9c0 x14ctfv x89ytp0 x889kno x1x5flf6 x1a8lsjc xwn43p0 x10l6tqk x3m8u43"},3:{className:"xjb1437 xacj9c0 x14ctfv x89ytp0 x889kno x1x5flf6 x1a8lsjc xwn43p0 x10l6tqk x3m8u43"}}[(i===!0)<<1|(S===!0)<<0],{children:d.jsx(o("VideoPlayerSettingsMenu.react").VideoPlayerSettingsMenu,{disableDubbing:I,dubTrackMapping:l,forceShowPlaybackRateControl:m,onClose:function(){x?b!=null&&b(null):k(!1)},videoID:v!=null?v:null,children:R})})),t[3]=S,t[4]=R,t[5]=i,t[6]=I,t[7]=l,t[8]=m,t[9]=x,t[10]=$,t[11]=b,t[12]=v,t[13]=N):N=t[13];var M;t[14]!==f?(M=f==null?o("fbicon")._(u("497567"),20):f,t[14]=f,t[15]=M):M=t[15];var w;t[16]!==x||t[17]!==$||t[18]!==E||t[19]!==h||t[20]!==b?(w=function(){x?b!=null&&b($?null:o("VideoPlayerDefaultControlsProperties").VideoMenuType.VIDEO_SETTINGS_MENU):k(!E),!$&&h!=null&&h()},t[16]=x,t[17]=$,t[18]=E,t[19]=h,t[20]=b,t[21]=w):w=t[21];var A;t[22]!==M||t[23]!==w?(A=d.jsx(r("VideoPlayerControlIcon.react"),{icon:M,label:D,onPress:w,tooltip:D}),t[22]=M,t[23]=w,t[24]=A):A=t[24];var F;return t[25]!==C||t[26]!==P||t[27]!==N||t[28]!==A?(F=d.jsxs("div",babelHelpers.extends({},P,{ref:C,children:[N,A]})),t[25]=C,t[26]=P,t[27]=N,t[28]=A,t[29]=F):F=t[29],F}f.displayName="VideoPlayerSettingsControl",l.default=f}),226);
__d("VideoPlayerWatchAndScrollControl_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoPlayerWatchAndScrollControl_video",selections:[e,{alias:null,args:null,kind:"ScalarField",name:"playable_duration_in_ms",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"owner",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"has_professional_features_for_watch",storageKey:null}],type:"VideoOwner",abstractKey:"__isVideoOwner"},e],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_huddle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],type:"Video",abstractKey:null}})();a.exports=e}),null);
__d("useVideoPlayerWatchAndScrollControlNUXQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="29450006731309811"}),null);
__d("useVideoPlayerWatchAndScrollControlNUXQuery.graphql",["useVideoPlayerWatchAndScrollControlNUXQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{kind:"Literal",name:"nux_id",value:9347}],t={alias:null,args:null,kind:"ScalarField",name:"should_show",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useVideoPlayerWatchAndScrollControlNUXQuery",selections:[{alias:null,args:e,concreteType:null,kind:"LinkedField",name:"nux",plural:!1,selections:[t],storageKey:"nux(nux_id:9347)"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"useVideoPlayerWatchAndScrollControlNUXQuery",selections:[{alias:null,args:e,concreteType:null,kind:"LinkedField",name:"nux",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:"nux(nux_id:9347)"}]},params:{id:n("useVideoPlayerWatchAndScrollControlNUXQuery_facebookRelayOperation"),metadata:{},name:"useVideoPlayerWatchAndScrollControlNUXQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("useVideoPlayerWatchAndScrollControlNUX",["fbt","CometRelay","CometWatchAndScrollTriggerContext","FBLogger","react","react-compiler-runtime","requireDeferred","useFDSCallout","useVideoPlayerWatchAndScrollControlNUXQuery.graphql"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=u||(u=o("react")),d=c.useCallback,m=c.useContext,p=c.useEffect,_=c.useState,f=r("requireDeferred")("CometDismissFBNuxMutation").__setRef("useVideoPlayerWatchAndScrollControlNUX"),g=r("requireDeferred")("CometLogImpressionFBNuxMutation").__setRef("useVideoPlayerWatchAndScrollControlNUX"),h={nux:{maxWidth:"xw5ewwj",$$css:!0}},y=9347,C=e!==void 0?e:e=n("useVideoPlayerWatchAndScrollControlNUXQuery.graphql");function b(e){var t=o("react-compiler-runtime").c(19),n=m(r("CometWatchAndScrollTriggerContext")),a=n.setIsTriggerDisabled,i=_(null),l=i[0],u=i[1],c=o("CometRelay").useRelayEnvironment(),d;t[0]!==c||t[1]!==a?(d=function(){a!=null&&a(!0),u(!1),f.onReady(function(e){e.commit(c,y)})},t[0]=c,t[1]=a,t[2]=d):d=t[2];var b=d,R,L;t[3]!==e||t[4]!==c||t[5]!==l?(R=function(){if(e&&l===null){var t=o("CometRelay").fetchQuery(c,C,{},{fetchPolicy:"store-or-network"}).subscribe({next:function(n){var t,r=(n==null||(t=n.nux)==null?void 0:t.should_show)||!1;u(r),r&&e&&g.onReady(function(e){e.commit(c,y,S,v)})}});return(function(){t.unsubscribe()})}},L=[c,e,l],t[3]=e,t[4]=c,t[5]=l,t[6]=R,t[7]=L):(R=t[6],L=t[7]),p(R,L);var E;t[8]===Symbol.for("react.memo_cache_sentinel")?(E=s._(/*BTDS*/"Watch and scroll feature tooltip"),t[8]=E):E=t[8];var k;t[9]===Symbol.for("react.memo_cache_sentinel")?(k=s._(/*BTDS*/"Continue watching while you browse Facebook."),t[9]=k):k=t[9];var I;t[10]!==b?(I=function(){b()},t[10]=b,t[11]=I):I=t[11];var T;t[12]===Symbol.for("react.memo_cache_sentinel")?(T=function(){u(!1)},t[12]=T):T=t[12];var D;t[13]!==I?(D={align:"end","aria-label":E,arrowStyle:"inset",content:k,disableAutoFlip:!0,hasCloseButton:!0,onClose:I,onHide:T,position:"below",type:"accent",xstyle:h.nux},t[13]=I,t[14]=D):D=t[14];var x=r("useFDSCallout")(D,l===!0&&e||!1),$=x.anchorRef,P;return t[15]!==$||t[16]!==b||t[17]!==l?(P={handleDismissNUX:b,nuxRef:$,shouldShowNUX:l},t[15]=$,t[16]=b,t[17]=l,t[18]=P):P=t[18],P}function v(){r("FBLogger")("watch_www_and_off_platform").mustfix("logimpression fb nux mutation failed for video player watch and scroll control.")}function S(){}l.default=b}),226);
__d("VideoPlayerWatchAndScrollControl.react",["fbt","ix","CastingStateHooks","CometPictureInPictureExpContext","CometRelay","CometRouteRenderType","CometVideoPictureInPictureManager.react","CometVideoPictureInPictureManagerContext","CometWatchAndScrollControlNUXContext","CometWatchAndScrollTriggerContext","JSResourceForInteraction","StoryAttachmentContext","VideoPlayerControlIcon.react","VideoPlayerHooks","VideoPlayerInstreamAdsStateHooks","VideoPlayerWatchAndScrollControl_video.graphql","VideoPlayerWithWatchAndScrollTrigger.react","emptyFunction","fbicon","gkx","react","react-compiler-runtime","requireDeferred","useCometLazyDialog","useCometRouterDispatcher","useCometRouterState","useIsVideoHomePlayerOriginFromTracePolicy","useMinifiedProductAttribution","usePlayerOriginRouteTracePolicy","useVideoPlayerWatchAndScrollControlNUX","useWatchAndScrollTrigger"],(function(t,n,r,o,a,i,l,s,u){"use strict";var e,c,d,m=c||(c=o("react")),p=c,_=p.useCallback,f=p.useContext,g=p.useEffect,h=p.useState,y=r("requireDeferred")("VideoHomeTypedLiteLogger").__setRef("VideoPlayerWatchAndScrollControl.react"),C=r("JSResourceForInteraction")("CometCastingStopWatchAndScrollDialog.react").__setRef("VideoPlayerWatchAndScrollControl.react"),b=6e4,v=window.document.pictureInPictureEnabled;function S(t){var a,i,l,c,p=o("react-compiler-runtime").c(56),_=t.subOrigin,S=t.video,R=f(r("CometWatchAndScrollTriggerContext")),L=R.isControlShown,E=R.setIsControlShown,k=o("CometRouteRenderType").useIsPushView(),I=(d||(d=o("VideoPlayerHooks"))).useIsFullscreen(),T=r("useCometRouterDispatcher")(),D=r("useCometRouterState")(),x=(a=D==null?void 0:D.main.route.tabKey)!=null?a:"undefined",$=o("CometRelay").useFragment(e!==void 0?e:e=n("VideoPlayerWatchAndScrollControl_video.graphql"),S),P=$==null?void 0:$.id,N=(i=$==null?void 0:$.playable_duration_in_ms)!=null?i:0,M=$==null?void 0:$.is_huddle,w=$==null?void 0:$.url,A,F;p[0]!==E?(A=function(){E!=null&&E(!0)},F=[E],p[0]=E,p[1]=A,p[2]=F):(A=p[1],F=p[2]),g(A,F);var O=r("usePlayerOriginRouteTracePolicy")(),B=r("useIsVideoHomePlayerOriginFromTracePolicy")(O),W=($==null||(l=$.owner)==null?void 0:l.has_professional_features_for_watch)===!0&&N>=b&&L&&!B,q=d.usePlaying(),U=d.useController(),V=d.useCurrentTimeThrottled(200),H=V>=10,G=h(!1),z=G[0],j=G[1],K=h(!1),Q=K[0],X=K[1],Y=h(!1),J=Y[0],Z=Y[1],ee=o("VideoPlayerInstreamAdsStateHooks").useInstreamAdsStateValue(),te=ee==="STARTING_INDICATOR"||ee==="PLAY_NI_VIDEO"||ee==="START_AD"||ee==="PLAY_LONGER_AD",ne=r("useMinifiedProductAttribution")(),re,oe;p[3]!==H||p[4]!==q?(re=function(){q&&H&&j(!0)},oe=[H,q],p[3]=H,p[4]=q,p[5]=re,p[6]=oe):(re=p[5],oe=p[6]),g(re,oe);var ae=o("CastingStateHooks").useIsCastingAnyVideo(),ie=r("useCometLazyDialog")(C),le=ie[0],se=!te&&z&&W,ue=r("useVideoPlayerWatchAndScrollControlNUX")(se),ce=ue.handleDismissNUX,de=ue.nuxRef,me=ue.shouldShowNUX,pe=me===!0&&se,_e=f(r("CometWatchAndScrollControlNUXContext")),fe=_e.setIsVideoPlayerWatchAndScrollControlNUXVisible,ge=f(r("CometPictureInPictureExpContext")),he,ye;p[7]!==pe||p[8]!==fe?(he=function(){fe&&fe(pe)},ye=[pe,fe],p[7]=pe,p[8]=fe,p[9]=he,p[10]=ye):(he=p[9],ye=p[10]),g(he,ye);var Ce=o("StoryAttachmentContext").useStoryAttachmentContext(),be=Ce.videoPlayerSessionID,ve=o("useWatchAndScrollTrigger").useWatchAndScrollTrigger(_,o("VideoPlayerWithWatchAndScrollTrigger.react").WatchAndScrollTriggerType.WNS_CONTROL,P,w,be),Se=d.useIsPremiumMusicVideo(),Re=$==null||(c=$.owner)==null?void 0:c.id,Le;p[11]!==Se||p[12]!==Re||p[13]!==ge?(Le=function(){var e=o("CometVideoPictureInPictureManagerContext").isInPictureInPictureExp(),t=o("CometVideoPictureInPictureManagerContext").isInPictureInPictureExpControlGroup();ge.setPictureInPictureExpConfig({isInPictureInPictureExp:e,isInPictureInPictureExpControlGroup:t,isSkipAndChainingDisabled:!1}),v&&e&&X(!0);var n=(e||t)&&(Se||Re!=null&&o("CometVideoPictureInPictureManager.react").EXCLUDED_PROVIDERS.includes(Re));n&&Z(!0)},p[11]=Se,p[12]=Re,p[13]=ge,p[14]=Le):Le=p[14];var Ee=Le,ke=O==="comet.videos.tahoe",Ie;p[15]!==ae||p[16]!==ve||p[17]!==le||p[18]!==P?(Ie=function(){ae&&P!=null?le({onContinue:ve,startingVideoType:"wns"},r("emptyFunction")):ve()},p[15]=ae,p[16]=ve,p[17]=le,p[18]=P,p[19]=Ie):Ie=p[19];var Te=Ie,De;p[20]!==U||p[21]!==T||p[22]!==ce||p[23]!==Q||p[24]!==pe||p[25]!==Te||p[26]!==ne||p[27]!==O||p[28]!==_||p[29]!==x?(De=function(){Te(),Q?(y.onReady(function(e){e.log({attribution_id_v2:ne,click_point:"control_picture_in_picture",event:"click",event_target_info:O,player_suborigin:_})}),U.requestPictureInPicture()):y.onReady(function(e){e.log({attribution_id_v2:ne,click_point:"control_watch_and_scroll",event:"click",event_target_info:x})}),pe===!0&&ce(),T&&T.popPushView()},p[20]=U,p[21]=T,p[22]=ce,p[23]=Q,p[24]=pe,p[25]=Te,p[26]=ne,p[27]=O,p[28]=_,p[29]=x,p[30]=De):De=p[30];var xe=De,$e=_==="live_producer",Pe;p[31]!==U||p[32]!==T||p[33]!==ke||p[34]!==ce||p[35]!==Q||p[36]!==I||p[37]!==pe||p[38]!==Te||p[39]!==ne||p[40]!==$e||p[41]!==O||p[42]!==_||p[43]!==x?(Pe=function(){Te(),Q?(y.onReady(function(e){e.log({attribution_id_v2:ne,click_point:"control_picture_in_picture",event:"click",event_target_info:O,player_suborigin:_})}),U.requestPictureInPicture()):y.onReady(function(e){e.log({attribution_id_v2:ne,click_point:"control_watch_and_scroll",event:"click",event_target_info:x})}),pe===!0&&ce(),I&&U.requestSetIsFullscreen(!1),T!=null&&($e||ke)&&T.go("/",{})},p[31]=U,p[32]=T,p[33]=ke,p[34]=ce,p[35]=Q,p[36]=I,p[37]=pe,p[38]=Te,p[39]=ne,p[40]=$e,p[41]=O,p[42]=_,p[43]=x,p[44]=Pe):Pe=p[44];var Ne=Pe,Me=k?xe:Ne,we;if(r("gkx")("20836")){var Ae;p[45]===Symbol.for("react.memo_cache_sentinel")?(Ae=s._(/*BTDS*/"Continue watching while you use Workplace"),p[45]=Ae):Ae=p[45],we=Ae}else if(M===!0){var Fe;p[46]===Symbol.for("react.memo_cache_sentinel")?(Fe=s._(/*BTDS*/"Continue listening while you browse Facebook."),p[46]=Fe):Fe=p[46],we=Fe}else{var Oe;p[47]===Symbol.for("react.memo_cache_sentinel")?(Oe=s._(/*BTDS*/"Continue watching while you browse Facebook."),p[47]=Oe):Oe=p[47],we=Oe}if(Q){var Be;p[48]===Symbol.for("react.memo_cache_sentinel")?(Be=s._(/*BTDS*/"Enter Picture in Picture Mode"),p[48]=Be):Be=p[48],we=Be}var We;return p[49]!==J||p[50]!==pe||p[51]!==we||p[52]!==de||p[53]!==Ee||p[54]!==Me?(We=J?null:m.jsx("div",{onMouseEnter:Ee,ref:de,children:m.jsx(r("VideoPlayerControlIcon.react"),{color:"white",icon:o("fbicon")._(u("150489"),20),label:we,onPress:Me,tooltip:pe?null:we})}),p[49]=J,p[50]=pe,p[51]=we,p[52]=de,p[53]=Ee,p[54]=Me,p[55]=We):We=p[55],We}l.default=S}),226);
__d("VideoPlayerLiveVideoControls.react",["CometPlaceholder.react","CometRelay","CometTahoeCustomVideoAreaContext","CometTahoeSidePaneContext","CometTrackingNodeProvider.react","LiveCostreamerTagSubscription.react","LiveVideoLatencyMenu.react","VideoPlayerCaptionsControl.react","VideoPlayerCastControlShim.react","VideoPlayerControlsBottomRowAddOnContext","VideoPlayerControlsContainerOverlay.react","VideoPlayerControlsGroups.react","VideoPlayerExpandSidePanelControl.react","VideoPlayerHooks","VideoPlayerLiveVideoControls_video.graphql","VideoPlayerPlaybackControl.react","VideoPlayerQuietModeControl.react","VideoPlayerSettingsControl.react","VideoPlayerVolumeControl.react","VideoPlayerWatchAndScrollControl.react","gkx","react","react-compiler-runtime","useVideoPlayerBigPlayButtonOverlay"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=s||(s=o("react")),d=s,m=d.useContext,p=d.useState,_=e!==void 0?e:e=n("VideoPlayerLiveVideoControls_video.graphql");function f(e){var t,n,a=o("react-compiler-runtime").c(85),l=o("CometRelay").useFragment(_,e.video),s=(u||(u=o("VideoPlayerHooks"))).useEnded(),d=u.useIsFullscreen(),f=m(o("VideoPlayerControlsBottomRowAddOnContext").VideoPlayerControlsBottomRowAddOnContext),g=m(r("CometTahoeSidePaneContext")),h=g.rightRailHidden,y=r("useVideoPlayerBigPlayButtonOverlay")(),C=y.bigPlayButtonIsVisible,b=u.useCaptionsLoaded(),v=u.useCaptionsVisible(),S=p(null),R=S[0],L=S[1],E=m(o("CometTahoeCustomVideoAreaContext").CometTahoeCustomVideoAreaContext),k=E.customVideoAreaHidden;if(s)return null;var I=e.disablePlaybackControls,T=e.expandControl,D=e.isControlsVisible,x=e.isExpandControlVisible,$=e.isVolumeControlVisible,P=e.isWatchAndScrollControlVisible,N=e.onUserInteraction,M=e.shouldRenderCaptionsControl,w=e.shouldRenderCostreamControl,A=e.shouldRenderModeratorControl,F=e.subOrigin,O=x===void 0?!1:x,B=P===void 0?!1:P,W=M===void 0?!0:M,q=w===void 0?!1:w,U=A===void 0?!1:A,V=l==null?void 0:l.id,H=l==null||(t=l.owner)==null?void 0:t.id,G=l==null?void 0:l.if_viewer_can_see_costreaming_tools,z=G!=null,j=l==null?void 0:l.if_viewer_can_use_clipping,K=(l==null?void 0:l.is_clipping_enabled)===!0,Q=l==null?void 0:l.if_viewer_can_see_community_moderation_tools,X=Q!=null,Y=l==null?void 0:l.if_viewer_can_use_live_rewind,J=((n=l==null?void 0:l.live_rewind_enabled)!=null?n:!1)&&e.shouldHideRewindControls!==!0,Z=O||D||I===!0&&!C,ee=B||D||I===!0&&!C,te;a[0]!==T||a[1]!==Z?(te=c.jsx(o("VideoPlayerControlsGroups.react").Contracted,{isVisible:Z,noPaddingEnd:!0,noPaddingStart:!0,children:T}),a[0]=T,a[1]=Z,a[2]=te):te=a[2];var ne=te,re;a[3]!==e.shouldRenderWatchAndScrollControl||a[4]!==ee||a[5]!==F||a[6]!==l?(re=e.shouldRenderWatchAndScrollControl===!0&&F!=null&&l!=null?c.jsx(o("VideoPlayerControlsGroups.react").Contracted,{isVisible:ee,children:c.jsx(r("VideoPlayerWatchAndScrollControl.react"),{subOrigin:F,video:l})}):null,a[3]=e.shouldRenderWatchAndScrollControl,a[4]=ee,a[5]=F,a[6]=l,a[7]=re):re=a[7];var oe=re,ae=F==="watch_scroll",ie=r("gkx")("24335")?W===!0:!ae,le;a[8]!==Y||a[9]!==I||a[10]!==D||a[11]!==J||a[12]!==N||a[13]!==e.shouldRenderPauseControl?(le=J?c.jsx(o("CometRelay").MatchContainer,{match:Y,props:{isControlsVisible:D&&!I,onUserInteraction:N,video:Y}}):c.jsxs(c.Fragment,{children:[e.shouldRenderPauseControl?c.jsx(o("VideoPlayerControlsGroups.react").Contracted,{isVisible:D&&!I,children:c.jsx(r("VideoPlayerPlaybackControl.react"),{})}):null,c.jsx(o("VideoPlayerControlsGroups.react").Expanded,{children:c.jsx(c.Fragment,{})})]}),a[8]=Y,a[9]=I,a[10]=D,a[11]=J,a[12]=N,a[13]=e.shouldRenderPauseControl,a[14]=le):le=a[14];var se;a[15]!==H||a[16]!==V?(se=H!=null&&V!=null&&c.jsx(r("LiveCostreamerTagSubscription.react"),{pageID:H,videoID:V}),a[15]=H,a[16]=V,a[17]=se):se=a[17];var ue;a[18]!==z||a[19]!==G||a[20]!==d||a[21]!==q||a[22]!==V?(ue=z&&q&&V!=null&&!d&&c.jsx(r("CometPlaceholder.react"),{fallback:null,name:i.id,children:c.jsx(o("CometRelay").MatchContainer,{match:G,props:{video:G}})}),a[18]=z,a[19]=G,a[20]=d,a[21]=q,a[22]=V,a[23]=ue):ue=a[23];var ce;a[24]!==d||a[25]!==e.shouldRenderQuietModeControl?(ce=e.shouldRenderQuietModeControl===!0&&!d&&c.jsx(o("VideoPlayerControlsGroups.react").Contracted,{isVisible:!0,noPaddingEnd:!0,children:c.jsx(r("VideoPlayerQuietModeControl.react"),{})}),a[24]=d,a[25]=e.shouldRenderQuietModeControl,a[26]=ce):ce=a[26];var de;a[27]!==d||a[28]!==e.shouldRenderExpandSidePanelControl||a[29]!==h?(de=e.shouldRenderExpandSidePanelControl===!0&&!d&&!h&&c.jsx(r("VideoPlayerExpandSidePanelControl.react"),{}),a[27]=d,a[28]=e.shouldRenderExpandSidePanelControl,a[29]=h,a[30]=de):de=a[30];var me;a[31]!==j||a[32]!==K||a[33]!==V?(me=K&&V!=null&&c.jsx(o("CometRelay").MatchContainer,{match:j,props:{video:j,videoID:V}}),a[31]=j,a[32]=K,a[33]=V,a[34]=me):me=a[34];var pe;a[35]!==X||a[36]!==Q||a[37]!==U||a[38]!==V?(pe=X&&U?c.jsx(r("CometPlaceholder.react"),{fallback:null,name:i.id,children:c.jsx(o("CometRelay").MatchContainer,{match:Q,props:{video:Q,videoID:V}})}):null,a[35]=X,a[36]=Q,a[37]=U,a[38]=V,a[39]=pe):pe=a[39];var _e;a[40]!==f||a[41]!==I||a[42]!==R||a[43]!==N||a[44]!==l?(_e=I===!0?null:c.jsx(r("CometTrackingNodeProvider.react"),{trackingNode:257,children:c.jsx(o("LiveVideoLatencyMenu.react").LiveVideoLatencyMenuContextProvider,{video:l,children:c.jsx(r("VideoPlayerSettingsControl.react"),{alignMenuToIcon:(f==null?void 0:f.getBottomRowAddOn())!=null,menuOpened:R,onUserInteraction:N,setMenuOpened:L})})}),a[40]=f,a[41]=I,a[42]=R,a[43]=N,a[44]=l,a[45]=_e):_e=a[45];var fe;a[46]!==f||a[47]!==b||a[48]!==v||a[49]!==ie||a[50]!==D||a[51]!==R||a[52]!==N||a[53]!==l?(fe=b&&ie?c.jsx(o("VideoPlayerControlsGroups.react").Contracted,{isVisible:D,children:c.jsx(r("VideoPlayerCaptionsControl.react"),{alignMenuToIcon:(f==null?void 0:f.getBottomRowAddOn())!=null,captionsVisible:v,menuOpened:R,onUserInteraction:N,setMenuOpened:L,video:l})}):null,a[46]=f,a[47]=b,a[48]=v,a[49]=ie,a[50]=D,a[51]=R,a[52]=N,a[53]=l,a[54]=fe):fe=a[54];var ge;a[55]!==I||a[56]!==D||a[57]!==e.shouldRenderCastControl||a[58]!==F||a[59]!==l?(ge=e.shouldRenderCastControl===!0&&F!=null&&l!=null?c.jsx(r("VideoPlayerCastControlShim.react"),{isVisible:D&&!I,subOrigin:F}):null,a[55]=I,a[56]=D,a[57]=e.shouldRenderCastControl,a[58]=F,a[59]=l,a[60]=ge):ge=a[60];var he;a[61]!==D||a[62]!==ce||a[63]!==de||a[64]!==me||a[65]!==pe||a[66]!==_e||a[67]!==fe||a[68]!==ge||a[69]!==se||a[70]!==ue?(he=c.jsxs(o("VideoPlayerControlsGroups.react").Contracted,{isVisible:D,children:[se,ue,ce,de,me,pe,_e,fe,ge]}),a[61]=D,a[62]=ce,a[63]=de,a[64]=me,a[65]=pe,a[66]=_e,a[67]=fe,a[68]=ge,a[69]=se,a[70]=ue,a[71]=he):he=a[71];var ye;a[72]!==N?(ye=c.jsx(r("CometTrackingNodeProvider.react"),{trackingNode:114,children:c.jsx(r("VideoPlayerVolumeControl.react"),{onUserInteraction:N})}),a[72]=N,a[73]=ye):ye=a[73];var Ce;a[74]!==$||a[75]!==ye?(Ce=c.jsx(o("VideoPlayerControlsGroups.react").Contracted,{isVisible:$,noPaddingStart:!0,children:ye}),a[74]=$,a[75]=ye,a[76]=Ce):Ce=a[76];var be;return a[77]!==k||a[78]!==ne||a[79]!==D||a[80]!==he||a[81]!==Ce||a[82]!==le||a[83]!==oe?(be=c.jsxs(r("VideoPlayerControlsContainerOverlay.react"),{isBackgroundVisible:D,isVisible:k,children:[le,he,ne,oe,Ce]}),a[77]=k,a[78]=ne,a[79]=D,a[80]=he,a[81]=Ce,a[82]=le,a[83]=oe,a[84]=be):be=a[84],be}function g(e){var t=o("react-compiler-runtime").c(2),n;return t[0]!==e?(n=c.jsx(r("CometPlaceholder.react"),{fallback:null,name:i.id,children:c.jsx(f,babelHelpers.extends({},e))}),t[0]=e,t[1]=n):n=t[1],n}l.default=g}),98);
__d("VideoPlayerDefaultControlsImplLive.react",["CometRelay","VideoPlayerDefaultControlsImplLive_video.graphql","VideoPlayerLiveVideoControls.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=s||(s=o("react"));function c(t){var a=o("react-compiler-runtime").c(16),i=t.expandControl,l=t.isControlsVisible,s=t.isVolumeControlVisible,c=t.onUserInteraction,d=t.shouldHideRewindControls,m=t.shouldRenderCaptionsControl,p=t.shouldRenderCostreamControl,_=t.shouldRenderExpandSidePanelControl,f=t.shouldRenderModeratorControl,g=t.shouldRenderPauseControl,h=t.shouldRenderQuietModeControl,y=t.shouldRenderWatchAndScrollControl,C=t.subOrigin,b=t.video,v=t.videoTahoeUrl,S=o("CometRelay").useFragment(e!==void 0?e:e=n("VideoPlayerDefaultControlsImplLive_video.graphql"),b),R;return a[0]!==i||a[1]!==l||a[2]!==s||a[3]!==c||a[4]!==d||a[5]!==m||a[6]!==p||a[7]!==_||a[8]!==f||a[9]!==g||a[10]!==h||a[11]!==y||a[12]!==C||a[13]!==S||a[14]!==v?(R=u.jsx(r("VideoPlayerLiveVideoControls.react"),{expandControl:i,isControlsVisible:l,isVolumeControlVisible:s,onUserInteraction:c,shouldHideRewindControls:d,shouldRenderCaptionsControl:m,shouldRenderCostreamControl:p,shouldRenderExpandSidePanelControl:_,shouldRenderModeratorControl:f,shouldRenderPauseControl:g,shouldRenderQuietModeControl:h,shouldRenderWatchAndScrollControl:y,subOrigin:C,video:S,videoTahoeUrl:v}),a[0]=i,a[1]=l,a[2]=s,a[3]=c,a[4]=d,a[5]=m,a[6]=p,a[7]=_,a[8]=f,a[9]=g,a[10]=h,a[11]=y,a[12]=C,a[13]=S,a[14]=v,a[15]=R):R=a[15],R}l.default=c}),98);
__d("VideoPlayerDefaultControlsImplNotLive_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoPlayerDefaultControlsImplNotLive_video",selections:[{fragment:{kind:"InlineFragment",selections:[{kind:"Defer",selections:[{args:null,kind:"FragmentSpread",name:"CometAudioLanguageUtils_dubtrackMapping"}]}],type:"Video",abstractKey:null},kind:"AliasedInlineFragmentSpread",name:"CometAudioLanguageUtils_dubtrackMapping"},{args:null,kind:"FragmentSpread",name:"VideoPlayerScrubberWithPreview_video"},{args:null,kind:"FragmentSpread",name:"VideoPlayerWatchAndScrollControl_video"},{args:null,kind:"FragmentSpread",name:"VideoPlayerCaptionsControl_video"},{args:null,kind:"FragmentSpread",name:"useVideoPlayerAvailableCaptionsLocalesFromRelay_video"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"if_viewer_can_use_clipping",plural:!1,selections:[{args:null,documentName:"VideoPlayerDefaultControlsImplNotLive_video_if_viewer_can_use_clipping",fragmentName:"VideoPlayerClipVideoControl_video",fragmentPropName:"video",kind:"ModuleImport"}],storageKey:null}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("VideoPlayerScrubberWithPreview_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoPlayerScrubberWithPreview_video",selections:[{args:null,kind:"FragmentSpread",name:"VideoPlayerScrubberPreview_video"},{args:null,kind:"FragmentSpread",name:"VideoPlayerScrubberRenderer_video"}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("VideoPlayerScrubberWithPreview.react",["CometRelay","VideoPlayerScrubber.react","VideoPlayerScrubberPreview.react","VideoPlayerScrubberRenderer.react","VideoPlayerScrubberWithPreview_video.graphql","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=s||(s=o("react"));function c(t){var a=o("react-compiler-runtime").c(11),i=t.onUserInteraction,l=t.timelinePlayedXStyle,s=t.video,c=t.videoChapters,d=o("CometRelay").useFragment(e!==void 0?e:e=n("VideoPlayerScrubberWithPreview_video.graphql"),s),m;a[0]!==l||a[1]!==d||a[2]!==c?(m=function(t){return u.jsx(r("VideoPlayerScrubberRenderer.react"),{scrubberProps:babelHelpers.extends({},t,{timelinePlayedXStyle:l}),video:d,videoChapters:c})},a[0]=l,a[1]=d,a[2]=c,a[3]=m):m=a[3];var p;a[4]!==d||a[5]!==c?(p=function(t){return u.jsx(r("VideoPlayerScrubberPreview.react"),{timestampSec:t,video:d,videoChapters:c})},a[4]=d,a[5]=c,a[6]=p):p=a[6];var _;return a[7]!==i||a[8]!==m||a[9]!==p?(_=u.jsx(r("VideoPlayerScrubber.react"),{onUserInteraction:i,renderScrubber:m,renderTooltip:p}),a[7]=i,a[8]=m,a[9]=p,a[10]=_):_=a[10],_}l.default=c}),98);
__d("VideoPlayerDefaultControlsImplNotLive.react",["CometAudioLanguageUtils","CometRelay","CometTahoeSidePaneContext","VideoPlayerCaptionsControl.react","VideoPlayerControlsBottomRowAddOnContext","VideoPlayerControlsContainerOverlay.react","VideoPlayerControlsGroups.react","VideoPlayerDefaultControlsImplNotLive_video.graphql","VideoPlayerExpandSidePanelControl.react","VideoPlayerHooks","VideoPlayerPlaybackControl.react","VideoPlayerPlaybackTimer.react","VideoPlayerQuietModeControl.react","VideoPlayerScrubberWithPreview.react","VideoPlayerSettingsControl.react","VideoPlayerVolumeControl.react","VideoPlayerWatchAndScrollControl.react","gkx","react","react-compiler-runtime","useVideoPlayerAvailableCaptionsLocalesFromRelay"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=s||(s=o("react")),d=s,m=d.useContext,p=d.useState;function _(t){var a,i=o("react-compiler-runtime").c(72),l=t.availableCaptionsLocales,s=t.expandControl,d=t.initialCaptionsUrl,_=t.isControlsVisible,f=t.isVolumeControlVisible,g=t.onUserInteraction,h=t.scrubberTimelinePlayedXStyle,y=t.shouldRenderCaptionsControl,C=t.shouldRenderExpandSidePanelControl,b=t.shouldRenderQuietModeControl,v=t.shouldRenderWatchAndScrollControl,S=t.skipControl,R=t.subOrigin,L=t.video,E=t.videoChapters,k=y===void 0?!0:y,I=C===void 0?!1:C,T=b===void 0?!1:b,D=o("CometRelay").useFragment(e!==void 0?e:e=n("VideoPlayerDefaultControlsImplNotLive_video.graphql"),L),x=(u||(u=o("VideoPlayerHooks"))).useIsFullscreen(),$=o("CometAudioLanguageUtils").useGetDubTrackMapping(D==null?void 0:D.CometAudioLanguageUtils_dubtrackMapping),P=D==null?void 0:D.id,N=D==null?void 0:D.if_viewer_can_use_clipping,M=m(o("VideoPlayerControlsBottomRowAddOnContext").VideoPlayerControlsBottomRowAddOnContext),w=m(r("CometTahoeSidePaneContext")),A=w.rightRailHidden,F;i[0]!==_||i[1]!==x||i[2]!==T?(F=T===!0&&!x?c.jsx(o("VideoPlayerControlsGroups.react").Contracted,{isVisible:_,noPaddingEnd:!0,children:c.jsx(r("VideoPlayerQuietModeControl.react"),{})}):null,i[0]=_,i[1]=x,i[2]=T,i[3]=F):F=i[3];var O=F,B;i[4]!==_||i[5]!==x||i[6]!==A||i[7]!==I?(B=I===!0&&!x&&!A&&c.jsx(o("VideoPlayerControlsGroups.react").Contracted,{isVisible:_,noPaddingEnd:!0,children:c.jsx(r("VideoPlayerExpandSidePanelControl.react"),{})}),i[4]=_,i[5]=x,i[6]=A,i[7]=I,i[8]=B):B=i[8];var W=B,q;i[9]!==N||i[10]!==_||i[11]!==O||i[12]!==P?(q=N!=null&&P!=null&&c.jsx(o("VideoPlayerControlsGroups.react").Contracted,{isVisible:_,noPaddingEnd:!0,noPaddingStart:O!=null,children:c.jsx(o("CometRelay").MatchContainer,{match:N,props:{video:N,videoID:P}})}),i[9]=N,i[10]=_,i[11]=O,i[12]=P,i[13]=q):q=i[13];var U=q,V=p(null),H=V[0],G=V[1],z=O!=null||U!=null,j;i[14]!==M?(j=M==null?void 0:M.getBottomRowAddOn(),i[14]=M,i[15]=j):j=i[15];var K=j!=null,Q;i[16]!==$||i[17]!==H||i[18]!==g||i[19]!==K?(Q=c.jsx(r("VideoPlayerSettingsControl.react"),{alignMenuToIcon:K,dubTrackMapping:$,menuOpened:H,onUserInteraction:g,setMenuOpened:G}),i[16]=$,i[17]=H,i[18]=g,i[19]=K,i[20]=Q):Q=i[20];var X;i[21]!==_||i[22]!==Q||i[23]!==z?(X=c.jsx(o("VideoPlayerControlsGroups.react").Contracted,{isVisible:_,noPaddingEnd:!0,noPaddingStart:z,children:Q}),i[21]=_,i[22]=Q,i[23]=z,i[24]=X):X=i[24];var Y=X,J;i[25]!==_||i[26]!==v||i[27]!==R||i[28]!==D?(J=v===!0&&R!=null&&D!=null?c.jsx(o("VideoPlayerControlsGroups.react").Contracted,{isVisible:_,children:c.jsx(r("VideoPlayerWatchAndScrollControl.react"),{subOrigin:R,video:D})}):null,i[25]=_,i[26]=v,i[27]=R,i[28]=D,i[29]=J):J=i[29];var Z=J,ee;i[30]!==s||i[31]!==_?(ee=c.jsx(o("VideoPlayerControlsGroups.react").Contracted,{isVisible:_,noPaddingEnd:!0,children:s}),i[30]=s,i[31]=_,i[32]=ee):ee=i[32];var te=ee,ne;i[33]!==g?(ne=c.jsx(r("VideoPlayerVolumeControl.react"),{onUserInteraction:g}),i[33]=g,i[34]=ne):ne=i[34];var re;i[35]!==f||i[36]!==ne?(re=c.jsx(o("VideoPlayerControlsGroups.react").Contracted,{isVisible:f,noPaddingStart:!0,children:ne}),i[35]=f,i[36]=ne,i[37]=re):re=i[37];var oe=re,ae;i[38]!==g||i[39]!==h||i[40]!==D||i[41]!==E?(ae=c.jsx(r("VideoPlayerScrubberWithPreview.react"),{onUserInteraction:g,timelinePlayedXStyle:h,video:D,videoChapters:E}),i[38]=g,i[39]=h,i[40]=D,i[41]=E,i[42]=ae):ae=i[42];var ie;i[43]!==_||i[44]!==ae?(ie=c.jsx(o("VideoPlayerControlsGroups.react").Expanded,{isVisible:_,children:ae}),i[43]=_,i[44]=ae,i[45]=ie):ie=i[45];var le=ie,se;i[46]===Symbol.for("react.memo_cache_sentinel")?(se=c.jsx(r("VideoPlayerPlaybackControl.react"),{}),i[46]=se):se=i[46];var ue;i[47]===Symbol.for("react.memo_cache_sentinel")?(ue=c.jsx(r("VideoPlayerPlaybackTimer.react"),{}),i[47]=ue):ue=i[47];var ce;i[48]!==_||i[49]!==S?(ce=c.jsxs(o("VideoPlayerControlsGroups.react").Contracted,{isVisible:_,children:[se,S,ue]}),i[48]=_,i[49]=S,i[50]=ce):ce=i[50];var de=ce,me=r("gkx")("21034")?!1:r("gkx")("24335")?k===!0:R!=="watch_scroll",pe=u.useCaptionsLoaded(),_e=u.useCaptionsVisible(),fe=r("useVideoPlayerAvailableCaptionsLocalesFromRelay")(D),ge=l!=null?l:fe,he=pe||((a=ge==null?void 0:ge.length)!=null?a:0)>0,ye=me&&he,Ce;i[51]!==ge||i[52]!==_e||i[53]!==d||i[54]!==_||i[55]!==H||i[56]!==g||i[57]!==ye||i[58]!==D?(Ce=ye?c.jsx(o("VideoPlayerControlsGroups.react").Contracted,{isVisible:_,children:c.jsx(r("VideoPlayerCaptionsControl.react"),{availableCaptionsLocales:ge,captionsVisible:_e,initialCaptionsUrl:d,menuOpened:H,onUserInteraction:g,setMenuOpened:G,video:D})}):null,i[51]=ge,i[52]=_e,i[53]=d,i[54]=_,i[55]=H,i[56]=g,i[57]=ye,i[58]=D,i[59]=Ce):Ce=i[59];var be=Ce,ve;return i[60]!==be||i[61]!==U||i[62]!==W||i[63]!==_||i[64]!==de||i[65]!==O||i[66]!==te||i[67]!==le||i[68]!==Y||i[69]!==oe||i[70]!==Z?(ve=c.jsxs(r("VideoPlayerControlsContainerOverlay.react"),{isBackgroundVisible:_,children:[de,le,O,W,U,Y,be,Z,te,oe]}),i[60]=be,i[61]=U,i[62]=W,i[63]=_,i[64]=de,i[65]=O,i[66]=te,i[67]=le,i[68]=Y,i[69]=oe,i[70]=Z,i[71]=ve):ve=i[71],ve}l.default=_}),98);/*FB_PKG_DELIM*/
__d("IDGWLoggingContext",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum")({STREAM_GROUP_COMPONENT:"WebStreamGroup",GROUPED_STREAM_COMPONENT:"GroupedWebStream",WEBSOCKET_TRANSPORT_COMPONENT:"WebSocketTransport",ACK_MANAGER_COMPONENT:"WebStreamAckManager",CODEC_COMPONENT:"WebCodec",RAW_CLIENT:"RAWDGWClient",PINGER:"DGWPinger"}),l=n("$InternalEnum")({STREAM_LIFECYCLE:"stream_lifecycle",STREAM_GROUP_TRANSPORT:"stream_group_transport"}),s=n("$InternalEnum")({SUCCESS:"success",FAIL:"fail"});i.DGWLoggingComponent=e,i.QPLEvent=l,i.QPLResult=s}),66);
__d("DGWAckManager",["IDGWLoggingContext","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e,t,n){var r=this;this.$3=n,this.sendId=e,this.$2=t,this.handleAckReceived=function(){r.stopTracking(!0)},this.$1=window.setTimeout(function(){r.stopTracking(!1)},t)}var t=e.prototype;return t.stopTracking=function(t){window.clearTimeout(this.$1),this.$3(t)},e})(),s=(function(){function t(e){this.$1=new Map,this.$2=e}var n=t.prototype;return n.waitForAck=async function(n,a){this.$2.bumpODSKey(o("IDGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_expected");var t=this.$1;try{var i=await new Promise(function(r,o){t.set(n,new e(n,a,r))});return i===!0?this.$2.logEvent(o("IDGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"Received ACK","sendId:"+n,!0):(this.$2.bumpODSKey(o("IDGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_timeout"),this.$2.logWarn(o("IDGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ACK timeout","Request "+n+" timed out after "+a+"ms")),t.delete(n),i}catch(e){var l=r("getErrorSafe")(e);throw this.$2.bumpODSKey(o("IDGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_error"),t.delete(n),l}},n.handleAckReceived=function(t){this.$2.bumpODSKey(o("IDGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_received");var e=this.$1.get(t);if(e===void 0){this.$2.bumpODSKey(o("IDGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_received.not_tracked"),this.$2.logWarn(o("IDGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"untracked ACK","Received ACK for ackId "+t+" which was not being tracked");return}e.handleAckReceived()},n.clearPendingAcks=function(){var e=this;this.$2.logEvent(o("IDGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"Clearing pending acks","ACKs cleared size: "+this.$1.size),this.$1.forEach(function(t,n,r){e.$2.logEvent(o("IDGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"Clearing pending ACK with ackId "+t.sendId,null,!0),t.stopTracking(!1),r.delete(n)})},t})();l.DGWAckManager=s}),98);
__d("DGWAuth",["$InternalEnum","err"],(function(t,n,r,o,a,i,l){"use strict";var e=n("$InternalEnum")({TEST:"0:0",FACEBOOK:"1:0",INTERNALFB:"2:0",OCULUS:"3:0",ENTERPRISEFB:"7:0",RECRUITINGFB:"8:0",INSTAGRAM:"6:0",HORIZON_WEB:"12:0",SPARK_WEB:"13:0",ABRA:"15:0",GUEST:"19:0"});function s(t){if(t==="TEST")return e.TEST;if(t==="FACEBOOK")return e.FACEBOOK;if(t==="INTERNALFB")return e.INTERNALFB;if(t==="OCULUS")return e.OCULUS;if(t==="ENTERPRISEFB")return e.ENTERPRISEFB;if(t==="RECRUITINGFB")return e.RECRUITINGFB;if(t==="INSTAGRAM")return e.INSTAGRAM;if(t==="HORIZON_WEB")return e.HORIZON_WEB;if(t==="SPARK_WEB")return e.SPARK_WEB;if(t==="ABRA")return e.ABRA;if(t==="GUEST")return e.GUEST;throw r("err")("failed to convert string to DGWAuth Type")}function u(t){if(t===e.TEST)return"TEST";if(t===e.FACEBOOK)return"FACEBOOK";if(t===e.INTERNALFB)return"INTERNALFB";if(t===e.OCULUS)return"OCULUS";if(t===e.ENTERPRISEFB)return"ENTERPRISEFB";if(t===e.RECRUITINGFB)return"RECRUITINGFB";if(t===e.INSTAGRAM)return"INSTAGRAM";if(t===e.HORIZON_WEB)return"HORIZON_WEB";if(t===e.SPARK_WEB)return"SPARK_WEB";if(t===e.ABRA)return"ABRA";if(t===e.GUEST)return"GUEST";throw r("err")("failed to convert DGWAuth to string")}l.DGWAuth=e,l.fromStringToDGWAuth=s,l.fromDGWAuthToString=u}),98);
__d("DGWGlobalLogger",["gkx","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(){var e=this;this.tabID=r("uuidv4")(),this.isTabClosed=!1,this.otherTabs=new Map,this.thisTab={realtime:0,lightspeed:0},this.broadcastChannel=this.$1("DGWGlobalLogger"),this.broadcastChannel.onmessage=function(t){var n=JSON.parse(String(t.data)),r=!e.otherTabs.has(n.key);n.event==="DELETE"?e.otherTabs.delete(n.key):n.event==="UPDATE"&&n.value!=null&&(e.otherTabs.set(n.key,n.value),r&&e.$2())}}var t=e.prototype;return t.$1=function(t){return window.BroadcastChannel!=null?new BroadcastChannel(t):{onmessage:function(t){},postMessage:function(t){}}},t.streamRequested=function(t){switch(t){case"realtime":this.thisTab.realtime++;break;case"lightspeed":this.thisTab.lightspeed++;break}this.$2()},t.streamClosed=function(t){switch(t){case"realtime":this.thisTab.realtime=Math.max(0,this.thisTab.realtime-1);break;case"lightspeed":this.thisTab.lightspeed=Math.max(0,this.thisTab.lightspeed-1);break}this.$2()},t.tabClosed=function(){if(!this.isTabClosed){this.isTabClosed=!0;var e={key:this.tabID,event:"DELETE"};this.broadcastChannel.postMessage(JSON.stringify(e))}},t.getGlobalState=function(){var e={realtime:this.thisTab.realtime,lightspeed:this.thisTab.lightspeed};return this.otherTabs.forEach(function(t){e.realtime+=t.realtime,e.lightspeed+=t.lightspeed}),e},t.$2=function(){var e={key:this.tabID,event:"UPDATE",value:this.thisTab};this.broadcastChannel.postMessage(JSON.stringify(e))},e})(),s=r("gkx")("4337")?new e:{streamRequested:function(){},streamClosed:function(){},tabClosed:function(){},getGlobalState:function(){return{realtime:-1,lightspeed:-1}}},u=function(){return s};l.getInstance=u}),98);
__d("DgwClientFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("1755537"),s=o("FalcoLoggerInternal").create("dgw_client",e),u=s;l.default=u}),98);
__d("DGWLoggingContext",["DGWGlobalLogger","DgwClientFalcoEvent","IDGWLoggingContext","NetworkStatus","ODS","QuickPerformanceLogger","Random","qpl"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u="dgw_client",c=r("qpl")._(701242292,"2919"),d=r("qpl")._(701238781,"3037"),m={VERBOSE:-1,INFO:0,WARNING:1,ERROR:2,FATAL:3};function p(e){switch(e){case o("IDGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT:case o("IDGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT:return!0;default:return!1}}var _=(function(){function t(e,t,n,r,o,a,i){a===void 0&&(a=!1),i===void 0&&(i=!1),this.$5=""+e,this.$1=t,this.$4=n,this.$3=r,this.sgTransportId=o,this.$2=a,this.$6=i}var n=t.prototype;return n.getGlobalLogger=function(){return o("DGWGlobalLogger").getInstance()},t.bumpODSKey=function(t,n,r){if(r===void 0&&(r=1),!!o("Random").coinflip(r)){var e=t+"."+n;(s||(s=o("ODS"))).bumpEntityKey(3589,"dgw_web_client",e,r)}},n.bumpODSKey=function(t,n,r){if(r===void 0&&(r=1),!!o("Random").coinflip(r)){var e=this.$4+"."+t+"."+n;(s||(s=o("ODS"))).bumpEntityKey(3589,"dgw_web_client",e,r)}},n.logEvent=function(t,n,r,o,a){o===void 0&&(o=!1),this.$2||this.$7(t,n,null,m.INFO,r,o,a)},n.$7=function(t,n,o,a,i,l,s){var e=this;l===void 0&&(l=!1),!(l&&!this.$6)&&(p(t)&&this.$1!=null||!p(t)&&this.sgTransportId!=null)&&r("DgwClientFalcoEvent").log(function(){return{event:n,logging_id:s!=null?s:e.$1,dgw_version:e.$5,message:o,severity:a,uuid:e.$3,dgw_component:t,extra_info:i,destination_tier:e.$4,sg_transport_id:e.sgTransportId,source:2}})},n.logError=function(t,n,o,a,i,l,s){if(i===void 0&&(i=!1),s===void 0&&(s=!1),!this.$2){var e=a;if(s){var u="onLine:"+String(r("NetworkStatus").isOnline());e=a!=null&&a!==""?a+", "+u:u}this.$7(t,n,o,m.ERROR,e,i,l)}},n.logWarn=function(t,n,r,o,a){a===void 0&&(a=!1),this.$2||this.$7(t,n,r,m.WARNING,o,a)},n.$8=function(t){switch(t){case o("IDGWLoggingContext").QPLEvent.STREAM_LIFECYCLE:return c;case o("IDGWLoggingContext").QPLEvent.STREAM_GROUP_TRANSPORT:return d}},n.qplMarkerStart=function(n,o){(e||(e=r("QuickPerformanceLogger"))).markerStart(this.$8(n),o)},n.qplMarkerEnd=function(n,a,i){var t=a===o("IDGWLoggingContext").QPLResult.SUCCESS?2:3;(e||(e=r("QuickPerformanceLogger"))).markerEnd(this.$8(n),t,i)},n.qplMarkerPoint=function(n,o,a){(e||(e=r("QuickPerformanceLogger"))).markerPoint(this.$8(n),o,{instanceKey:a})},n.qplMarkerAnnotate=function(n,o,a){(e||(e=r("QuickPerformanceLogger"))).markerAnnotate(this.$8(n),o,{instanceKey:a})},t})();l.DGWLoggingComponent=o("IDGWLoggingContext").DGWLoggingComponent,l.QPLEvent=o("IDGWLoggingContext").QPLEvent,l.QPLResult=o("IDGWLoggingContext").QPLResult,l.DGW_MODULE=u,l.DGWLoggingContext=_}),98);
__d("DGWCppBridge",[],(function(t,n,r,o,a,i){var e=(function(){var e=typeof document!="undefined"&&document.currentScript?document.currentScript.src:void 0;return(function(t){t=t||{};var t=typeof t!="undefined"?t:{},n=(function(){function e(){}function t(e,t){return function(){e.apply(t,arguments)}}function n(e){if(!(this instanceof n))throw new TypeError("Promises must be constructed via new");if(typeof e!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(e,this)}function r(e,t){for(;e._state===3;)e=e._value;if(e._state===0){e._deferreds.push(t);return}e._handled=!0,n._immediateFn(function(){var n=e._state===1?t.onFulfilled:t.onRejected;if(n===null){(e._state===1?o:a)(t.promise,e._value);return}var r;try{r=n(e._value)}catch(e){a(t.promise,e);return}o(t.promise,r)})}function o(e,r){try{if(r===e)throw new TypeError("A promise cannot be resolved with itself.");if(r&&(typeof r=="object"||typeof r=="function")){var o=r.then;if(r instanceof n){e._state=3,e._value=r,i(e);return}else if(typeof o=="function"){s(t(o,r),e);return}}e._state=1,e._value=r,i(e)}catch(t){a(e,t)}}function a(e,t){e._state=2,e._value=t,i(e)}function i(e){e._state===2&&e._deferreds.length===0&&n._immediateFn(function(){e._handled||n._unhandledRejectionFn(e._value)});for(var t=0,o=e._deferreds.length;t<o;t++)r(e,e._deferreds[t]);e._deferreds=null}function l(e,t,n){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.promise=n}function s(e,t){var n=!1;try{e(function(e){n||(n=!0,o(t,e))},function(e){n||(n=!0,a(t,e))})}catch(e){if(n)return;n=!0,a(t,e)}}return n.prototype.catch=function(e){return this.then(null,e)},n.prototype.then=function(t,n){var o=new this.constructor(e);return r(this,new l(t,n,o)),o},n.all=function(e){return new n(function(t,n){if(!Array.isArray(e))return n(new TypeError("Promise.all accepts an array"));var r=Array.prototype.slice.call(e);if(r.length===0)return t([]);var o=r.length;function a(e,i){try{if(i&&(typeof i=="object"||typeof i=="function")){var l=i.then;if(typeof l=="function"){l.call(i,function(t){a(e,t)},n);return}}r[e]=i,--o===0&&t(r)}catch(e){n(e)}}for(var i=0;i<r.length;i++)a(i,r[i])})},n.resolve=function(e){return e&&typeof e=="object"&&e.constructor===n?e:new n(function(t){t(e)})},n.reject=function(e){return new n(function(t,n){n(e)})},n.race=function(e){return new n(function(t,r){if(!Array.isArray(e))return r(new TypeError("Promise.race accepts an array"));for(var o=0,a=e.length;o<a;o++)n.resolve(e[o]).then(t,r)})},n._immediateFn=typeof setImmediate=="function"&&function(e){setImmediate(e)}||function(e){setTimeout(e,0)},n._unhandledRejectionFn=function(t){},n})(),r,o;t.ready=new n(function(e,t){r=e,o=t});var a={},i;for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(a[i]=t[i]);var l=[],s="./this.program",u=function(t,n){throw n},c=!0,d=!1,m="";function p(e){return t.locateFile?t.locateFile(e,m):m+e}var _,f,g,h;typeof document!="undefined"&&document.currentScript&&(m=document.currentScript.src),e&&(m=e),m.indexOf("blob:")!==0?m=m.substr(0,m.lastIndexOf("/")+1):m="",_=function(t){try{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText}catch(e){var n=ge(t);if(n)return pe(n);throw e}},f=function(t,n,r){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=function(){if(e.status==200||e.status==0&&e.response){n(e.response);return}var o=ge(t);if(o){n(o.buffer);return}r()},e.onerror=r,e.send(null)},h=function(t){document.title=t};var y=t.print||console.log.bind(console),C=t.printErr||console.warn.bind(console);for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i]);a=null,t.arguments&&(l=t.arguments),t.thisProgram&&(s=t.thisProgram),t.quit&&(u=t.quit);var b;t.wasmBinary&&(b=t.wasmBinary);var v=t.noExitRuntime||!0,S={Memory:function(t){this.buffer=new ArrayBuffer(t.initial*65536)},Module:function(t){},Instance:function(t,n){this.exports=(function(t){function e(e){return e.set=function(e,t){this[e]=t},e.get=function(e){return this[e]},e}for(var n,r=new Uint8Array(123),o=25;o>=0;--o)r[48+o]=52+o,r[65+o]=o,r[97+o]=26+o;r[43]=62,r[47]=63;function a(e,t,n){for(var o,a,i=0,l=t,s=n.length,u=t+(s*3>>2)-(n[s-2]=="=")-(n[s-1]=="=");i<s;i+=4)o=r[n.charCodeAt(i+1)],a=r[n.charCodeAt(i+2)],e[l++]=r[n.charCodeAt(i)]<<2|o>>4,l<u&&(e[l++]=o<<4|a>>2),l<u&&(e[l++]=a<<6|r[n.charCodeAt(i+3)])}function i(e){a(n,1024,"U3Q5dHlwZV9pbmZvAAAAAOAEAAAABAAATjEwX19jeHhhYml2MTE2X19zaGltX3R5cGVfaW5mb0UAAAAACAUAABgEAAAQBAAATjEwX19jeHhhYml2MTE3X19jbGFzc190eXBlX2luZm9FAAAACAUAAEgEAAA8BAAATjEwX19jeHhhYml2MTE3X19wYmFzZV90eXBlX2luZm9FAAAACAUAAHgEAAA8BAAATjEwX19jeHhhYml2MTE5X19wb2ludGVyX3R5cGVfaW5mb0UACAUAAKgEAACcBAAAAAAAAGwEAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAAAAABQBQAAAQAAAAkAAAADAAAABAAAAAUAAAAKAAAACwAAAAwAAABOMTBfX2N4eGFiaXYxMjBfX3NpX2NsYXNzX3R5cGVfaW5mb0UAAAAACAUAACgFAABsBA=="),a(n,1372,"gAkQ")}function l(t){var r=t.a,o=r.buffer;r.grow=Le;var a=new Int8Array(o),l=new Int16Array(o),s=new Int32Array(o),u=new Uint8Array(o),c=new Uint16Array(o),d=new Uint32Array(o),m=new Float32Array(o),p=new Float64Array(o),_=Math.imul,f=Math.fround,g=Math.abs,h=Math.clz32,y=Math.min,C=Math.max,b=Math.floor,v=Math.ceil,S=Math.trunc,R=Math.sqrt,L=t.abort,E=NaN,k=1/0,I=t.b,T=1051008,D=0;function x(e,t,n,r,o,i){e=e|0,t=t|0,n=n|0,r=r|0,o=o|0,i=i|0;var m=0,p=0,f=0;m=T-80|0,T=m,s[m+72>>2]=e,s[m+68>>2]=t,s[m+64>>2]=n,s[m+60>>2]=r,s[m+56>>2]=o,s[m+52>>2]=i;e:{if(!s[m+52>>2]||!s[m+56>>2]|(!s[m+72>>2]|!s[m+68>>2]|(!s[m+64>>2]|!s[m+60>>2]))){s[m+76>>2]=5;break e}s[s[m+64>>2]>>2]=0,s[s[m+60>>2]>>2]=0,t=s[m+68>>2],n=s[m+56>>2],r=s[m+52>>2],e=T+-64|0,T=e,s[e+56>>2]=s[m+72>>2],s[e+52>>2]=t,s[e+48>>2]=n,s[e+44>>2]=r,s[e+40>>2]=0,s[e+36>>2]=s[e+56>>2];t:{n:{r:{for(;;){if(!s[e+52>>2])break n;if(s[e+32>>2]=s[e+36>>2],a[e+31|0]=u[s[e+36>>2]],s[e+52>>2]=s[e+52>>2]-1,s[e+36>>2]=s[e+36>>2]+1,u[e+31|0]==10||u[e+31|0]==2|u[e+31|0]==4|u[e+31|0]==9){s[e+40>>2]=s[e+40>>2]+1;continue}if(s[e+24>>2]=1,J(u[e+31|0])&1){if(p=e,f=ee(u[e+31|0])&1,a[p+23|0]=f,s[e+16>>2]=a[e+23|0]&1?1:2,d[e+52>>2]<d[e+16>>2]){s[s[e+48>>2]>>2]=s[e+32>>2],s[s[e+44>>2]>>2]=s[e+52>>2]+s[e+24>>2];break t}if(s[e+52>>2]=s[e+52>>2]-s[e+16>>2],s[e+24>>2]=s[e+16>>2]+s[e+24>>2],s[e+36>>2]=s[e+16>>2]+s[e+36>>2],!(u[e+31|0]!=14&&u[e+31|0]!=8)){s[e+40>>2]=s[e+40>>2]+1;continue}}if(d[e+52>>2]<3)break r;if(s[e+12>>2]=0,t=s[e+36>>2],n=u[t|0]|u[t+1|0]<<8,a[e+12|0]=n,a[e+13|0]=n>>>8,a[e+14|0]=u[t+2|0],s[e+52>>2]=s[e+52>>2]-3,s[e+24>>2]=s[e+24>>2]+3,s[e+36>>2]=s[e+36>>2]+3,d[e+12>>2]<=d[e+52>>2]){s[e+40>>2]=s[e+40>>2]+1,s[e+36>>2]=s[e+12>>2]+s[e+36>>2],s[e+52>>2]=s[e+52>>2]-s[e+12>>2];continue}break}s[s[e+48>>2]>>2]=s[e+32>>2],s[s[e+44>>2]>>2]=s[e+52>>2]+s[e+24>>2];break t}s[s[e+48>>2]>>2]=s[e+32>>2],s[s[e+44>>2]>>2]=s[e+52>>2]+s[e+24>>2];break t}s[s[e+44>>2]>>2]=s[e+52>>2]}if(s[e+60>>2]=s[e+40>>2],T=e- -64|0,s[m+48>>2]=s[e+60>>2],!s[m+48>>2]){s[m+76>>2]=0;break e}if(p=m,f=$(_(s[m+48>>2],20)),s[p+44>>2]=f,!s[m+44>>2]){s[m+76>>2]=3;break e}for(s[m+40>>2]=s[m+44>>2],s[m+36>>2]=s[m+72>>2],s[m+32>>2]=s[m+68>>2]-s[s[m+52>>2]>>2],s[m+28>>2]=0;;){if(d[m+28>>2]<d[m+48>>2]){if(d[m+32>>2]<1){V(s[m+44>>2],s[m+28>>2]),s[m+76>>2]=1;break e}a[m+27|0]=u[s[m+36>>2]],s[m+36>>2]=s[m+36>>2]+1,s[m+32>>2]=s[m+32>>2]-1;t:{if(!u[m+27|0]|u[m+27|0]==1|(u[m+27|0]==2|u[m+27|0]==3)|(u[m+27|0]==4|u[m+27|0]==9|u[m+27|0]==10)||J(u[m+27|0])&1)break t;V(s[m+44>>2],s[m+28>>2]),s[m+76>>2]=6;break e}e=s[m+40>>2],s[e>>2]=u[m+27|0]&15|s[e>>2]&-16;t:{if(u[m+27|0]==10||u[m+27|0]==2|u[m+27|0]==4|u[m+27|0]==9){e=s[m+40>>2],s[e>>2]=s[e>>2]&-268435441,s[m+40>>2]=s[m+40>>2]+20;break t}if(J(u[m+27|0])&1){e=T-48|0,T=e,s[e+40>>2]=s[m+40>>2],s[e+36>>2]=m+36,s[e+32>>2]=m+32;n:{if(!(J(s[s[e+40>>2]>>2]&15)&1)){s[e+44>>2]=1;break n}if(p=e,f=ee(s[s[e+40>>2]>>2]&15)&1,a[p+31|0]=f,s[e+24>>2]=a[e+31|0]&1?1:2,d[s[e+32>>2]>>2]<d[e+24>>2]){s[e+44>>2]=1;break n}if(ae(s[e+40>>2]+4|0,s[s[e+36>>2]>>2],s[e+24>>2]),t=s[e+36>>2],s[t>>2]=s[e+24>>2]+s[t>>2],t=s[e+32>>2],s[t>>2]=s[t>>2]-s[e+24>>2],(s[s[e+40>>2]>>2]&15)==8){t=s[e+40>>2],s[t>>2]=s[t>>2]&-268435441,s[e+44>>2]=0;break n}if((s[s[e+40>>2]>>2]&15)==14){t=s[e+40>>2],s[t>>2]=s[t>>2]&-268435441,s[e+44>>2]=0;break n}if(d[s[e+32>>2]>>2]<3){s[e+44>>2]=11;break n}if(s[e+20>>2]=0,t=s[s[e+36>>2]>>2],n=u[t|0]|u[t+1|0]<<8,a[e+20|0]=n,a[e+21|0]=n>>>8,a[e+22|0]=u[t+2|0],t=s[e+36>>2],s[t>>2]=s[t>>2]+3,t=s[e+32>>2],s[t>>2]=s[t>>2]-3,t=s[e+40>>2],s[t>>2]=s[t>>2]&-268435441|(s[e+20>>2]&16777215)<<4,d[s[e+32>>2]>>2]<d[e+20>>2]){s[e+44>>2]=11;break n}if((s[s[e+40>>2]>>2]&15)==15){if(s[s[e+40>>2]+12>>2]=s[e+20>>2],t=$(s[e+20>>2]),s[s[e+40>>2]+8>>2]=t,!s[s[e+40>>2]+8>>2]){s[e+44>>2]=3;break n}ae(s[s[e+40>>2]+8>>2],s[s[e+36>>2]>>2],s[e+20>>2]),t=s[e+36>>2],s[t>>2]=s[e+20>>2]+s[t>>2],t=s[e+32>>2],s[t>>2]=s[t>>2]-s[e+20>>2],s[e+44>>2]=0;break n}if((s[s[e+40>>2]>>2]&15)==5){if(s[s[e+40>>2]+12>>2]=s[e+20>>2],t=$(s[e+20>>2]),s[s[e+40>>2]+8>>2]=t,!s[s[e+40>>2]+8>>2]){s[e+44>>2]=3;break n}ae(s[s[e+40>>2]+8>>2],s[s[e+36>>2]>>2],s[e+20>>2]),t=s[e+36>>2],s[t>>2]=s[e+20>>2]+s[t>>2],t=s[e+32>>2],s[t>>2]=s[t>>2]-s[e+20>>2],s[e+44>>2]=0;break n}r:{if(!((s[s[e+40>>2]>>2]&15)!=6&&(s[s[e+40>>2]>>2]&15)!=7)){if(p=e,f=G(s[e+36>>2],s[e+32>>2],e+19|0,e+18|0),s[p+12>>2]=f,s[e+12>>2]){s[e+44>>2]=s[e+12>>2];break n}break r}if(!((s[s[e+40>>2]>>2]&15)!=13&&(s[s[e+40>>2]>>2]&15)!=12)){n=s[e+32>>2],t=T-32|0,s[t+24>>2]=s[e+36>>2],s[t+20>>2]=n,s[t+16>>2]=e+19,s[t+12>>2]=e+16,l[t+10>>1]=0;o:{if(d[s[t+20>>2]>>2]<2){s[t+28>>2]=1;break o}n=s[s[t+24>>2]>>2],n=u[n|0]|u[n+1|0]<<8,a[t+10|0]=n,a[t+11|0]=n>>>8,n=s[t+24>>2],s[n>>2]=s[n>>2]+2,n=s[t+20>>2],s[n>>2]=s[n>>2]-2,a[s[t+16>>2]]=(c[t+10>>1]&32768)==32768,l[s[t+12>>2]>>1]=c[t+10>>1]&32767,s[t+28>>2]=0}if(s[e+12>>2]=s[t+28>>2],s[e+12>>2]){s[e+44>>2]=s[e+12>>2];break n}}}if((s[s[e+40>>2]>>2]&15)==12){t=s[e+40>>2],l[t+8>>1]=l[t+8>>1]&1|c[e+16>>1]<<1,s[e+44>>2]=0;break n}if((s[s[e+40>>2]>>2]&15)==7){t=s[e+40>>2],a[t+8|0]=a[t+8|0]&1|u[e+18|0]<<1,s[e+44>>2]=0;break n}if((s[s[e+40>>2]>>2]&15)==13){n=s[e+32>>2],r=s[e+20>>2],o=s[e+40>>2]+12|0,i=s[e+40>>2],t=T-32|0,T=t,s[t+24>>2]=s[e+36>>2],s[t+20>>2]=n,s[t+16>>2]=r,s[t+12>>2]=o,s[t+8>>2]=i+16;r:{if(d[t+16>>2]<2){s[t+28>>2]=9;break r}if(s[s[t+8>>2]>>2]=s[t+16>>2]-2,d[s[t+20>>2]>>2]<d[s[t+8>>2]>>2]){s[t+28>>2]=1;break r}if(n=$(s[s[t+8>>2]>>2]),s[s[t+12>>2]>>2]=n,!s[s[t+12>>2]>>2]){s[t+28>>2]=3;break r}ae(s[s[t+12>>2]>>2],s[s[t+24>>2]>>2],s[s[t+8>>2]>>2]),n=s[t+24>>2],s[n>>2]=s[s[t+8>>2]>>2]+s[n>>2],n=s[t+20>>2],s[n>>2]=s[n>>2]-s[s[t+8>>2]>>2],s[t+28>>2]=0}if(T=t+32|0,s[e+8>>2]=s[t+28>>2],s[e+8>>2]){s[e+44>>2]=s[e+8>>2];break n}t=s[e+40>>2],l[t+8>>1]=a[e+19|0]&1|c[t+8>>1]&65534,t=s[e+40>>2],l[t+8>>1]=l[t+8>>1]&1|c[e+16>>1]<<1,s[e+44>>2]=0;break n}if((s[s[e+40>>2]>>2]&15)==6){if(p=e,f=q(s[e+36>>2],s[e+32>>2],s[e+20>>2],s[e+40>>2]+12|0,s[e+40>>2]+16|0),s[p+4>>2]=f,s[e+4>>2]){s[e+44>>2]=s[e+4>>2];break n}t=s[e+40>>2],a[t+8|0]=a[e+19|0]&1|u[t+8|0]&254,t=s[e+40>>2],a[t+8|0]=a[t+8|0]&1|u[e+18|0]<<1,s[e+44>>2]=0;break n}s[e+44>>2]=1}if(T=e+48|0,s[m+20>>2]=s[e+44>>2],!s[m+20>>2]){s[m+40>>2]=s[m+40>>2]+20;break t}V(s[m+44>>2],s[m+28>>2]),s[m+76>>2]=s[m+20>>2];break e}if(s[m+16>>2]=0,d[m+32>>2]<3){V(s[m+44>>2],s[m+28>>2]),s[m+76>>2]=1;break e}if(e=s[m+36>>2],t=u[e|0]|u[e+1|0]<<8,a[m+16|0]=t,a[m+17|0]=t>>>8,a[m+18|0]=u[e+2|0],s[m+36>>2]=s[m+36>>2]+3,s[m+32>>2]=s[m+32>>2]-3,!(s[m+16>>2]==1|u[m+27|0]!=1)){V(s[m+44>>2],s[m+28>>2]),s[m+76>>2]=7;break e}if(e=s[m+40>>2],s[e>>2]=s[e>>2]&-268435441|(s[m+16>>2]&16777215)<<4,u[m+27|0]==3){if(s[m+16>>2]!=1){V(s[m+44>>2],s[m+28>>2]),s[m+76>>2]=10;break e}if(a[m+15|0]=0,d[m+32>>2]<1){O(s[m+44>>2]),s[m+76>>2]=1;break e}a[m+15|0]=u[s[m+36>>2]],s[m+36>>2]=s[m+36>>2]+1,s[m+32>>2]=s[m+32>>2]-1;n:{if(u[m+15|0]<=4){a[s[m+40>>2]+4|0]=u[m+15|0];break n}a[s[m+40>>2]+4|0]=4}s[m+40>>2]=s[m+40>>2]+20;break t}if(p=m,f=G(m+36|0,m+32|0,m+14|0,m+13|0),s[p+8>>2]=f,s[m+8>>2]){V(s[m+44>>2],s[m+28>>2]),s[m+76>>2]=s[m+8>>2];break e}if(u[m+27|0]==1){e=s[m+40>>2],a[e+4|0]=a[e+4|0]&1|u[m+13|0]<<1,s[m+40>>2]=s[m+40>>2]+20;break t}if(!u[m+27|0]){if(p=m,f=q(m+36|0,m+32|0,s[m+16>>2],s[m+40>>2]+8|0,s[m+40>>2]+12|0),s[p+4>>2]=f,s[m+4>>2]){V(s[m+44>>2],s[m+28>>2]),s[m+76>>2]=s[m+4>>2];break e}e=s[m+40>>2],a[e+4|0]=a[m+14|0]&1|u[e+4|0]&254,e=s[m+40>>2],a[e+4|0]=a[e+4|0]&1|u[m+13|0]<<1,s[m+40>>2]=s[m+40>>2]+20}}s[m+28>>2]=s[m+28>>2]+1;continue}break}if(s[m+32>>2]){V(s[m+44>>2],s[m+48>>2]),s[m+76>>2]=1;break e}s[s[m+64>>2]>>2]=s[m+44>>2],s[s[m+60>>2]>>2]=s[m+48>>2],s[m+76>>2]=0}return T=m+80|0,s[m+76>>2]}function $(e){var t=0,n=0,r=0,o=0,a=0,i=0,l=0,u=0,c=0,d=0,m=0;c=8;e:{t:{if(e>>>0>4294967239)break t;for(;;){c=c>>>0>8?c:8,n=s[603],a=n,o=s[602],l=o,e=e>>>0>8?e+3&-4:8;n:{if(e>>>0<=127){i=(e>>>3|0)-1|0;break n}if(r=h(e),i=((e>>>29-r^4)-(r<<2)|0)+110|0,e>>>0<=4095)break n;r=((e>>>30-r^2)-(r<<1)|0)+71|0,i=r>>>0<63?r:63}if(t=i,r=t&31,(t&63)>>>0>=32?(t=0,n=n>>>r|0):(t=n>>>r|0,n=((1<<r)-1&n)<<32-r|l>>>r),r=t,n|t){for(;;){a=n,t=r;n:{if(t|n){o=t-1|0,u=o+1|0,l=o,o=n-1|0,l=(o|0)!=-1?u:l,o=h(n^o)+32|0,n=h(t^l),n=(n|0)==32?o:n,t=63-n|0,D=0-(n>>>0>63)|0;break n}D=0,t=64}o=t,t=o,n=t&31,(t&63)>>>0>=32?(t=0,l=r>>>n|0):(t=r>>>n|0,l=((1<<n)-1&r)<<32-n|a>>>n),r=t,i=o+i|0,a=i<<4,t=s[a+1384>>2],o=a+1376|0;n:{if((t|0)!=(o|0)){if(n=F(t,c,e),n)break t;n=s[t+4>>2],s[n+8>>2]=s[t+8>>2],s[s[t+8>>2]+4>>2]=n,s[t+8>>2]=o,n=a+1380|0,s[t+4>>2]=s[n>>2],s[n>>2]=t,s[s[t+4>>2]+8>>2]=t,i=i+1|0,n=(r&1)<<31|l>>>1,r=r>>>1|0;break n}d=s[603],t=i,u=t&63,n=u,a=n&31,n>>>0>=32?(n=0,o=-1>>>a|0):(n=-1>>>a|0,o=(1<<a)-1<<32-a|-1>>>a),o=o&-2,a=u&31,u>>>0>=32?(n=o<<a,u=0):(n=(1<<a)-1&o>>>32-a|n<<a,u=o<<a),a=n,o=0-t&63,n=o,t=n&31,n>>>0>=32?(n=-1<<t,t=0):(n=(1<<t)-1&-1>>>32-t|-1<<t,t=-1<<t),m=t&-2,t=o&31,o>>>0>=32?(o=0,t=n>>>t|0):(o=n>>>t|0,t=((1<<t)-1&n)<<32-t|m>>>t),n=t|u,D=a|o,s[602]=s[602]&n,s[603]=D&d,n=l^1}if(!(n|r))break}o=s[602],a=s[603]}n:{if(a|o){r=h(a),r=63-((r|0)==32?h(o)+32|0:r)<<4,t=r+1376|0,r=s[r+1384>>2];r:{if(!a&o>>>0<1073741824||(i=98,(t|0)==(r|0)))break r;for(;;){if(n=F(r,c,e),n)break t;if(r=s[r+8>>2],!i)break r;if(i=i-1|0,(t|0)==(r|0))break}}if(M(e+48|0))break n;if(!r|(t|0)==(r|0))break e;for(;;){if(n=F(r,c,e),n)break t;if(r=s[r+8>>2],(t|0)==(r|0))break}break e}if(!M(e+48|0))break e}if(n=0,e>>>0>4294967239)break t;for(r=c,t=0;;){if(i=t,r){r=r-1&r,t=t+1|0;continue}break}if(!(i>>>0<=1))break}}return n}return 0}function P(e,t,n,r,o,i,m){e=e|0,t=t|0,n=n|0,r=r|0,o=o|0,i=i|0,m=m|0;var p=0,_=0,f=0;p=T-32|0,T=p,l[p+26>>1]=e,s[p+20>>2]=t,s[p+16>>2]=n,a[p+15|0]=r,l[p+12>>1]=o,s[p+8>>2]=i,s[p+4>>2]=m;e:{if(!(!(a[p+15|0]&1)|c[p+12>>1]<=32767)){s[p+28>>2]=4;break e}t=s[p+20>>2],n=s[p+16>>2],r=s[p+8>>2],o=s[p+4>>2],i=a[p+15|0]&1,e=T+-64|0,T=e,s[e+56>>2]=p+26,s[e+52>>2]=t,s[e+48>>2]=n,s[e+44>>2]=r,s[e+40>>2]=o,a[e+39|0]=2,a[e+38|0]=13,s[e+32>>2]=p+12,a[e+31|0]=i,a[e+30|0]=2;t:{n:{if(!(!s[e+52>>2]|(!s[e+44>>2]|!s[e+40>>2]))&&d[e+48>>2]<=16777215)break n;s[e+60>>2]=5;break t}if(s[e+24>>2]=s[e+48>>2]+(u[e+39|0]+(u[e+30|0]+4|0)|0),_=e,f=$(s[e+24>>2]),s[_+20>>2]=f,!s[e+20>>2]){s[e+60>>2]=3;break t}if(s[e+16>>2]=s[e+20>>2],a[s[e+16>>2]]=u[e+38|0],s[e+16>>2]=s[e+16>>2]+1,ae(s[e+16>>2],s[e+56>>2],u[e+30|0]),s[e+16>>2]=u[e+30|0]+s[e+16>>2],s[e+12>>2]=u[e+39|0]+s[e+48>>2],d[e+12>>2]<d[e+48>>2]){O(s[e+20>>2]),s[e+60>>2]=9;break t}if(t=s[e+16>>2],n=u[e+12|0]|u[e+13|0]<<8,a[t|0]=n,a[t+1|0]=n>>>8,a[t+2|0]=u[e+14|0],s[e+16>>2]=s[e+16>>2]+3,a[e+31|0]&1)n:{if(u[e+38|0]==6){t=s[e+32>>2],a[t|0]=u[t|0]|128;break n}r:{if(u[e+38|0]==13){t=s[e+32>>2],l[t>>1]=c[t>>1]|32768;break r}O(s[e+20>>2]),s[e+60>>2]=1;break t}}ae(s[e+16>>2],s[e+32>>2],u[e+39|0]),s[e+16>>2]=u[e+39|0]+s[e+16>>2],ae(s[e+16>>2],s[e+52>>2],s[e+48>>2]),s[s[e+44>>2]>>2]=s[e+20>>2],s[s[e+40>>2]>>2]=s[e+24>>2],s[e+60>>2]=0}T=e- -64|0,s[p+28>>2]=s[e+60>>2]}return T=p+32|0,s[p+28>>2]}function N(e,t,n,r,o){e=e|0,t=t|0,n=n|0,r=r|0,o=o|0;var i=0,c=0,m=0;i=T-32|0,T=i,l[i+30>>1]=e,s[i+24>>2]=t,s[i+20>>2]=n,s[i+16>>2]=r,s[i+12>>2]=o,t=s[i+24>>2],n=s[i+20>>2],r=s[i+16>>2],o=s[i+12>>2],e=T-48|0,T=e,s[e+40>>2]=i+30,s[e+36>>2]=t,s[e+32>>2]=n,s[e+28>>2]=r,s[e+24>>2]=o,a[e+23|0]=2,a[e+22|0]=15;e:{if(!(s[e+24>>2]&&s[e+28>>2])){s[e+44>>2]=5;break e}if(s[s[e+28>>2]>>2]=0,s[s[e+24>>2]>>2]=0,!(d[e+32>>2]<=16777215&&s[e+36>>2])){s[e+44>>2]=5;break e}if(s[e+16>>2]=s[e+32>>2]+(u[e+23|0]+4|0),c=e,m=$(s[e+16>>2]),s[c+12>>2]=m,!s[e+12>>2]){s[e+44>>2]=3;break e}s[e+8>>2]=s[e+12>>2],a[s[e+8>>2]]=u[e+22|0],s[e+8>>2]=s[e+8>>2]+1,ae(s[e+8>>2],s[e+40>>2],u[e+23|0]),s[e+8>>2]=u[e+23|0]+s[e+8>>2],t=s[e+8>>2],n=u[e+32|0]|u[e+33|0]<<8,a[t|0]=n,a[t+1|0]=n>>>8,a[t+2|0]=u[e+34|0],s[e+8>>2]=s[e+8>>2]+3,ae(s[e+8>>2],s[e+36>>2],s[e+32>>2]),s[e+8>>2]=s[e+32>>2]+s[e+8>>2],s[s[e+28>>2]>>2]=s[e+12>>2],s[s[e+24>>2]>>2]=s[e+16>>2],s[e+44>>2]=0}return T=e+48|0,T=i+32|0,s[e+44>>2]}function M(e){var t=0,n=0,r=0,o=0,i=0,l=0;r=s[343],n=e+3&-4,t=r+n|0;e:{t:{if(t>>>0<=r>>>0&&n||t>>>0>Re()<<16>>>0&&!(I(t|0)|0))break t;s[343]=t;break e}s[604]=48,r=-1}if((r|0)!=-1){n=e+r|0,t=n-16|0,s[t+12>>2]=16,s[t>>2]=16,e=s[600],e?l=s[e+8>>2]:l=0;e:{t:{if((l|0)==(r|0)){if(o=r-(s[r-4>>2]&-2)|0,i=s[o-4>>2],s[e+8>>2]=n,e=o-(i&-2)|0,n=-16,!(a[(e+s[e>>2]|0)-4|0]&1))break t;n=s[e+4>>2],s[n+8>>2]=s[e+8>>2],s[s[e+8>>2]+4>>2]=n,t=t-e|0,s[e>>2]=t;break e}s[r+12>>2]=16,s[r>>2]=16,s[r+8>>2]=n,s[r+4>>2]=e,s[600]=r,n=16}e=r+n|0,t=t-e|0,s[e>>2]=t}s[((t&-4)+e|0)-4>>2]=t|1,l=e,o=s[e>>2]-8|0;e:{if(o>>>0<=127){t=(o>>>3|0)-1|0;break e}if(i=h(o),t=((o>>>29-i^4)-(i<<2)|0)+110|0,o>>>0<=4095)break e;t=((o>>>30-i^2)-(i<<1)|0)+71|0,t=t>>>0<63?t:63}n=t<<4,s[l+4>>2]=n+1376,n=n+1384|0,s[e+8>>2]=s[n>>2],s[n>>2]=e,s[s[e+8>>2]+4>>2]=e,n=s[603],e=t&31,(t&63)>>>0>=32?(t=1<<e,e=0):(t=(1<<e)-1&1>>>32-e,e=1<<e),s[602]=e|s[602],s[603]=t|n}return(r|0)!=-1}function w(e,t,n,r){e=e|0,t=t|0,n=n|0,r=r|0;var o=0,i=0,d=0;o=T-16|0,T=o,l[o+10>>1]=e,l[o+8>>1]=t,s[o+4>>2]=n,s[o>>2]=r;e:{if(c[o+8>>1]>32767){s[o+12>>2]=4;break e}t=s[o+4>>2],n=s[o>>2],e=T-48|0,T=e,s[e+40>>2]=o+10,s[e+36>>2]=t,s[e+32>>2]=n,a[e+31|0]=2,a[e+30|0]=12,s[e+24>>2]=o+8,a[e+23|0]=2;t:{if(!(s[e+32>>2]&&s[e+36>>2])){s[e+44>>2]=5;break t}if(s[e+16>>2]=u[e+31|0]+(u[e+23|0]+4|0),i=e,d=$(s[e+16>>2]),s[i+12>>2]=d,!s[e+12>>2]){s[e+44>>2]=3;break t}s[e+8>>2]=s[e+12>>2],a[s[e+8>>2]]=u[e+30|0],s[e+8>>2]=s[e+8>>2]+1,ae(s[e+8>>2],s[e+40>>2],u[e+23|0]),s[e+8>>2]=u[e+23|0]+s[e+8>>2],s[e+4>>2]=u[e+31|0],t=s[e+8>>2],n=u[e+4|0]|u[e+5|0]<<8,a[t|0]=n,a[t+1|0]=n>>>8,a[t+2|0]=u[e+6|0],s[e+8>>2]=s[e+8>>2]+3,ae(s[e+8>>2],s[e+24>>2],u[e+31|0]),s[s[e+32>>2]>>2]=s[e+16>>2],s[s[e+36>>2]>>2]=s[e+12>>2],s[e+44>>2]=0}T=e+48|0,s[o+12>>2]=s[e+44>>2]}return T=o+16|0,s[o+12>>2]}function A(e,t,n){e=e|0,t=t|0,n=n|0;var r=0,o=0,a=0,i=0,l=0;a=T+-64|0,T=a,o=1;e:{if(j(e,t,0)||(o=0,!t))break e;r=T+-64|0,T=r,o=s[t>>2],i=s[o-4>>2],l=s[o-8>>2],s[r+20>>2]=0,s[r+16>>2]=1084,s[r+12>>2]=t,s[r+8>>2]=1132,o=0,ie(r+24|0,39),t=t+l|0;t:{if(j(i,1132,0)){s[r+56>>2]=1,Se[s[s[i>>2]+20>>2]](i,r+8|0,t,t,1,0),o=s[r+32>>2]==1?t:0;break t}Se[s[s[i>>2]+24>>2]](i,r+8|0,t,1,0);n:switch(s[r+44>>2]){case 0:o=s[r+48>>2]==1&&s[r+36>>2]==1&&s[r+40>>2]==1?s[r+28>>2]:0;break t;case 1:break n;default:break t}if(s[r+48>>2]|s[r+36>>2]!=1|s[r+40>>2]!=1&&s[r+32>>2]!=1)break t;o=s[r+24>>2]}if(T=r- -64|0,t=o,o=0,!t)break e;ie(a+8|4,52),s[a+56>>2]=1,s[a+20>>2]=-1,s[a+16>>2]=e,s[a+8>>2]=t,Se[s[s[t>>2]+28>>2]](t,a+8|0,s[n>>2],1),e=s[a+32>>2],(e|0)==1&&(s[n>>2]=s[a+24>>2]),o=(e|0)==1}return e=o,T=a- -64|0,e|0}function F(e,t,n){var r=0,o=0,a=0,i=0;if(r=e+4|0,o=(r+t|0)-1&0-t,t=s[e>>2],o+n>>>0<=(t+e|0)-4>>>0){a=s[e+4>>2],s[a+8>>2]=s[e+8>>2],s[s[e+8>>2]+4>>2]=a,(r|0)!=(o|0)&&(o=o-r|0,a=e-(s[e-4>>2]&-2)|0,r=o+s[a>>2]|0,s[a>>2]=r,s[(a+(r&-4)|0)-4>>2]=r,e=e+o|0,t=t-o|0,s[e>>2]=t);e:{if(n+24>>>0<=t>>>0){r=(e+n|0)+8|0,t=(t-n|0)-8|0,s[r>>2]=t,s[(r+(t&-4)|0)-4>>2]=t|1,i=r,a=s[r>>2]-8|0;t:{if(a>>>0<=127){o=(a>>>3|0)-1|0;break t}if(t=h(a),o=((a>>>29-t^4)-(t<<2)|0)+110|0,a>>>0<=4095)break t;t=((a>>>30-t^2)-(t<<1)|0)+71|0,o=t>>>0<63?t:63}t=o,o=t<<4,s[i+4>>2]=o+1376,o=o+1384|0,s[r+8>>2]=s[o>>2],s[o>>2]=r,s[s[r+8>>2]+4>>2]=r,o=s[603],r=t&31,(t&63)>>>0>=32?(t=1<<r,i=0):(t=(1<<r)-1&1>>>32-r,i=1<<r),s[602]=i|s[602],s[603]=t|o,t=n+8|0,s[e>>2]=t,s[((t&-4)+e|0)-4>>2]=t;break e}s[(e+t|0)-4>>2]=t}e=e+4|0}else e=0;return e}function O(e){var t=0,n=0,r=0,o=0,a=0;if(e){n=e-4|0,o=s[n>>2],r=o,t=n,a=s[e-8>>2],e=a&-2,(e|0)!=(a|0)&&(t=n-e|0,r=s[t+4>>2],s[r+8>>2]=s[t+8>>2],s[s[t+8>>2]+4>>2]=r,r=e+o|0),e=n+o|0,n=s[e>>2],(n|0)!=s[(e+n|0)-4>>2]&&(o=s[e+4>>2],s[o+8>>2]=s[e+8>>2],s[s[e+8>>2]+4>>2]=o,r=r+n|0),s[t>>2]=r,s[((r&-4)+t|0)-4>>2]=r|1,a=t,r=s[t>>2]-8|0;e:{if(r>>>0<=127){e=(r>>>3|0)-1|0;break e}if(o=h(r),e=((r>>>29-o^4)-(o<<2)|0)+110|0,r>>>0<=4095)break e;e=((r>>>30-o^2)-(o<<1)|0)+71|0,e=e>>>0<63?e:63}n=e<<4,s[a+4>>2]=n+1376,n=n+1384|0,s[t+8>>2]=s[n>>2],s[n>>2]=t,s[s[t+8>>2]+4>>2]=t,n=s[603],t=e&31,(e&63)>>>0>=32?(e=1<<t,t=0):(e=(1<<t)-1&1>>>32-t,t=1<<t),s[602]=t|s[602],s[603]=e|n}}function B(e,t,n){e=e|0,t=t|0,n=n|0;var r=0,o=0,i=0;r=T-48|0,T=r,s[r+40>>2]=e,s[r+36>>2]=t,s[r+32>>2]=n;e:{if(!(s[r+32>>2]&&s[r+36>>2])){s[r+44>>2]=5;break e}if(d[r+40>>2]>4){s[r+44>>2]=8;break e}if(s[r+28>>2]=5,o=r,i=$(s[r+28>>2]),s[o+24>>2]=i,!s[r+24>>2]){s[r+44>>2]=3;break e}s[r+20>>2]=s[r+24>>2],a[r+19|0]=3,a[s[r+20>>2]]=u[r+19|0],s[r+20>>2]=s[r+20>>2]+1,s[r+12>>2]=1,e=s[r+20>>2],t=u[r+12|0]|u[r+13|0]<<8,a[e|0]=t,a[e+1|0]=t>>>8,a[e+2|0]=u[r+14|0],s[r+20>>2]=s[r+20>>2]+3,a[r+11|0]=s[r+40>>2],a[s[r+20>>2]]=u[r+11|0],s[s[r+36>>2]>>2]=s[r+24>>2],s[s[r+32>>2]>>2]=s[r+28>>2],s[r+44>>2]=0}return T=r+48|0,s[r+44>>2]}function W(e,t,n,r,o){if(e=e|0,t=t|0,n=n|0,r=r|0,o=o|0,j(e,s[t+8>>2],o)){se(t,n,r);return}e:{if(j(e,s[t>>2],o)){if(!(s[t+20>>2]!=(n|0)&&s[t+16>>2]!=(n|0))){if((r|0)!=1)break e;s[t+32>>2]=1;return}s[t+32>>2]=r;t:{if(s[t+44>>2]==4)break t;if(l[t+52>>1]=0,e=s[e+8>>2],Se[s[s[e>>2]+20>>2]](e,t,n,n,1,o),u[t+53|0]){if(s[t+44>>2]=3,!u[t+52|0])break t;break e}s[t+44>>2]=4}if(s[t+20>>2]=n,s[t+40>>2]=s[t+40>>2]+1,s[t+36>>2]!=1|s[t+24>>2]!=2)break e;a[t+54|0]=1;return}e=s[e+8>>2],Se[s[s[e>>2]+24>>2]](e,t,n,r,o)}}function q(e,t,n,r,o){var a=0;a=T-32|0,T=a,s[a+24>>2]=e,s[a+20>>2]=t,s[a+16>>2]=n,s[a+12>>2]=r,s[a+8>>2]=o;e:{if(d[a+16>>2]<1){s[a+28>>2]=9;break e}if(s[s[a+8>>2]>>2]=s[a+16>>2]-1,d[s[a+20>>2]>>2]<d[s[a+8>>2]>>2]){s[a+28>>2]=1;break e}if(e=$(s[s[a+8>>2]>>2]),s[s[a+12>>2]>>2]=e,!s[s[a+12>>2]>>2]){s[a+28>>2]=3;break e}ae(s[s[a+12>>2]>>2],s[s[a+24>>2]>>2],s[s[a+8>>2]>>2]),e=s[a+24>>2],s[e>>2]=s[s[a+8>>2]>>2]+s[e>>2],e=s[a+20>>2],s[e>>2]=s[e>>2]-s[s[a+8>>2]>>2],s[a+28>>2]=0}return T=a+32|0,s[a+28>>2]}function U(e,t,n){e=e|0,t=t|0,n=n|0;var r=0,o=0,i=0;r=T-32|0,T=r,l[r+26>>1]=e,s[r+20>>2]=t,s[r+16>>2]=n,s[s[r+16>>2]>>2]=3,o=r,i=$(s[s[r+16>>2]>>2]),s[o+12>>2]=i;e:{if(!s[r+12>>2]){s[r+28>>2]=3;break e}s[s[r+20>>2]>>2]=s[r+12>>2],a[r+11|0]=14,a[s[r+12>>2]]=u[r+11|0],s[r+12>>2]=s[r+12>>2]+1,e=s[r+12>>2],t=u[r+26|0]|u[r+27|0]<<8,a[e|0]=t,a[e+1|0]=t>>>8,s[r+28>>2]=0}return T=r+32|0,s[r+28>>2]}function V(e,t){var n=0;for(n=T-16|0,T=n,s[n+12>>2]=e,s[n+8>>2]=t,s[n+4>>2]=0;;){if(d[n+4>>2]<d[n+8>>2]){s[n>>2]=s[n+12>>2]+_(s[n+4>>2],20);e:{if(!(s[s[n>>2]>>2]&15)){O(s[s[n>>2]+8>>2]);break e}t:{if((s[s[n>>2]>>2]&15)==5){O(s[s[n>>2]+8>>2]);break t}(s[s[n>>2]>>2]&15)==6&&O(s[s[n>>2]+12>>2])}}s[n+4>>2]=s[n+4>>2]+1;continue}break}O(s[n+12>>2]),T=n+16|0}function H(e,t,n,r){a[e+53|0]=1;e:{if(s[e+4>>2]!=(n|0))break e;if(a[e+52|0]=1,n=s[e+16>>2],!n){if(s[e+36>>2]=1,s[e+24>>2]=r,s[e+16>>2]=t,(r|0)!=1|s[e+48>>2]!=1)break e;a[e+54|0]=1;return}if((t|0)==(n|0)){if(n=s[e+24>>2],(n|0)==2&&(s[e+24>>2]=r,n=r),s[e+48>>2]!=1|(n|0)!=1)break e;a[e+54|0]=1;return}a[e+54|0]=1,s[e+36>>2]=s[e+36>>2]+1}}function G(e,t,n,r){var o=0;o=T-32|0,s[o+24>>2]=e,s[o+20>>2]=t,s[o+16>>2]=n,s[o+12>>2]=r,a[o+11|0]=0;e:{if(d[s[o+20>>2]>>2]<1){s[o+28>>2]=1;break e}a[o+11|0]=u[s[s[o+24>>2]>>2]],e=s[o+24>>2],s[e>>2]=s[e>>2]+1,e=s[o+20>>2],s[e>>2]=s[e>>2]-1,a[s[o+16>>2]]=(u[o+11|0]&128)==128,a[s[o+12>>2]]=u[o+11|0]&127,s[o+28>>2]=0}return s[o+28>>2]}function z(e,t,n,r,o){if(e=e|0,t=t|0,n=n|0,r=r|0,o=o|0,j(e,s[t+8>>2],o)){se(t,n,r);return}e:{if(!j(e,s[t>>2],o))break e;if(!(s[t+20>>2]!=(n|0)&&s[t+16>>2]!=(n|0))){if((r|0)!=1)break e;s[t+32>>2]=1;return}s[t+20>>2]=n,s[t+32>>2]=r,s[t+40>>2]=s[t+40>>2]+1,s[t+36>>2]!=1|s[t+24>>2]!=2||(a[t+54|0]=1),s[t+44>>2]=4}}function j(e,t,n){var r=0;if(!n)return s[e+4>>2]==s[t+4>>2];if((e|0)==(t|0))return 1;n=s[e+4>>2],e=u[n|0],t=s[t+4>>2],r=u[t|0];e:{if(!e|(r|0)!=(e|0))break e;for(;;){if(r=u[t+1|0],e=u[n+1|0],!e)break e;if(t=t+1|0,n=n+1|0,(e|0)!=(r|0))break}}return(e|0)==(r|0)}function K(e,t){e=e|0,t=t|0;var n=0,r=0,o=0;n=T-32|0,T=n,s[n+24>>2]=e,s[n+20>>2]=t,r=n,o=$(1),s[r+16>>2]=o;e:{if(!s[n+16>>2]){s[n+28>>2]=3;break e}a[n+15|0]=9,a[s[n+16>>2]]=u[n+15|0],s[s[n+24>>2]>>2]=s[n+16>>2],s[s[n+20>>2]>>2]=1,s[n+28>>2]=0}return T=n+32|0,s[n+28>>2]}function Q(e,t){e=e|0,t=t|0;var n=0,r=0,o=0;n=T-32|0,T=n,s[n+24>>2]=e,s[n+20>>2]=t,r=n,o=$(1),s[r+16>>2]=o;e:{if(!s[n+16>>2]){s[n+28>>2]=3;break e}a[n+15|0]=10,a[s[n+16>>2]]=u[n+15|0],s[s[n+24>>2]>>2]=s[n+16>>2],s[s[n+20>>2]>>2]=1,s[n+28>>2]=0}return T=n+32|0,s[n+28>>2]}function X(e,t){e=e|0,t=t|0;var n=0,r=0,o=0;n=T-32|0,T=n,s[n+24>>2]=e,s[n+20>>2]=t,r=n,o=$(1),s[r+16>>2]=o;e:{if(!s[n+16>>2]){s[n+28>>2]=3;break e}a[n+15|0]=2,a[s[n+16>>2]]=u[n+15|0],s[s[n+24>>2]>>2]=s[n+16>>2],s[s[n+20>>2]>>2]=1,s[n+28>>2]=0}return T=n+32|0,s[n+28>>2]}function Y(e,t){e=e|0,t=t|0;var n=0,r=0,o=0;n=T-32|0,T=n,s[n+24>>2]=e,s[n+20>>2]=t,r=n,o=$(1),s[r+16>>2]=o;e:{if(!s[n+16>>2]){s[n+28>>2]=3;break e}a[n+15|0]=4,a[s[n+16>>2]]=u[n+15|0],s[s[n+24>>2]>>2]=s[n+16>>2],s[s[n+20>>2]>>2]=1,s[n+28>>2]=0}return T=n+32|0,s[n+28>>2]}function J(e){var t=0;t=T-16|0,T=t,s[t+12>>2]=e,e=1;e:{if(ee(s[t+12>>2])&1||(e=1,s[t+12>>2]==15)||(e=1,s[t+12>>2]==13)||(e=1,s[t+12>>2]==12))break e;e=s[t+12>>2]==14}return T=t+16|0,e}function Z(e,t,n){var r=0;if(r=s[e+16>>2],!r){s[e+36>>2]=1,s[e+24>>2]=n,s[e+16>>2]=t;return}e:{if((t|0)==(r|0)){if(s[e+24>>2]!=2)break e;s[e+24>>2]=n;return}a[e+54|0]=1,s[e+24>>2]=2,s[e+36>>2]=s[e+36>>2]+1}}function ee(e){var t=0;t=T-16|0,s[t+12>>2]=e,e=1;e:{if(s[t+12>>2]==5||(e=1,s[t+12>>2]==6)||(e=1,s[t+12>>2]==7))break e;e=s[t+12>>2]==8}return e}function te(e,t,n,r,o,a){if(e=e|0,t=t|0,n=n|0,r=r|0,o=o|0,a=a|0,j(e,s[t+8>>2],a)){H(t,n,r,o);return}e=s[e+8>>2],Se[s[s[e>>2]+20>>2]](e,t,n,r,o,a)}function ne(){for(var e=0,t=0,n=0;t=e<<4,n=t+1376|0,s[t+1380>>2]=n,s[t+1384>>2]=n,e=e+1|0,(e|0)!=64;);M(48)}function re(e,t,n,r){if(e=e|0,t=t|0,n=n|0,r=r|0,j(e,s[t+8>>2],0)){Z(t,n,r);return}e=s[e+8>>2],Se[s[s[e>>2]+28>>2]](e,t,n,r)}function oe(e,t,n,r,o,a){e=e|0,t=t|0,n=n|0,r=r|0,o=o|0,a=a|0,j(e,s[t+8>>2],a)&&H(t,n,r,o)}function ae(e,t,n){if(n)for(;a[e|0]=u[t|0],e=e+1|0,t=t+1|0,n=n-1|0,!!n;);}function ie(e,t){if(t)for(;a[e|0]=0,e=e+1|0,t=t-1|0,!!t;);}function le(e,t,n,r){e=e|0,t=t|0,n=n|0,r=r|0,j(e,s[t+8>>2],0)&&Z(t,n,r)}function se(e,t,n){s[e+28>>2]==1|s[e+4>>2]!=(t|0)||(s[e+28>>2]=n)}function ue(e,t){return e=e|0,t=t|0,_(t,20)+e|0}function ce(e){return e=e|0,c[e+8>>1]>>>1|0}function de(e){return e=e|0,l[e+8>>1]&1}function me(e){return e=e|0,s[e+12>>2]}function pe(e){return e=e|0,s[e>>2]&15}function _e(e){return e=e|0,s[e+16>>2]}function fe(e){return e=e|0,c[e+4>>1]}function ge(e){return e=e|0,s[e+8>>2]}function he(e){return e=e|0,u[e+4|0]}function ye(e){return e=e|0,e|0}function Ce(e){return $(e)}function be(e){e=e|0,O(e)}function ve(e){e=e|0}n=u,i(t);var Se=e([null,ye,be,ve,ve,A,oe,z,le,be,te,W,re]);function Re(){return o.byteLength/65536|0}function Le(e){e=e|0;var t=Re()|0,i=t+e|0;if(t<i&&i<65536){var f=new ArrayBuffer(_(i,65536)),g=new Int8Array(f);g.set(a),a=new Int8Array(f),l=new Int16Array(f),s=new Int32Array(f),u=new Uint8Array(f),c=new Uint16Array(f),d=new Uint32Array(f),m=new Float32Array(f),p=new Float64Array(f),o=f,r.buffer=o,n=u}return t}return{c:ne,d:Ce,e:be,f:X,g:Y,h:B,i:N,j:U,k:P,l:w,m:K,n:Q,o:x,p:pe,q:he,r:ue,s:fe,t:ge,u:me,v:me,w:_e,x:ce,y:de,z:ce,A:Se}}return l(t)})(he)},instantiate:function(t,n){return{then:function(n){var e=new S.Module(t);n({instance:new S.Instance(e)})}}},RuntimeError:Error};b=[],typeof S!="object"&&ne("no native wasm support detected");var R,L=!1,E;function k(e,t){e||ne("Assertion failed: "+t)}function I(e,t){return e%t>0&&(e+=t-e%t),e}var T,D,x,$,P,N,M,w,A;function F(e){T=e,t.HEAP8=D=new Int8Array(e),t.HEAP16=$=new Int16Array(e),t.HEAP32=N=new Int32Array(e),t.HEAPU8=x=new Uint8Array(e),t.HEAPU16=P=new Uint16Array(e),t.HEAPU32=M=new Uint32Array(e),t.HEAPF32=w=new Float32Array(e),t.HEAPF64=A=new Float64Array(e)}var O=t.INITIAL_MEMORY||2097152;t.wasmMemory?R=t.wasmMemory:R=new S.Memory({initial:O/65536,maximum:32768}),R&&(T=R.buffer),O=T.byteLength,F(T);var B,W=[],q=[],U=[],V=!1;function H(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)j(t.preRun.shift());ue(W)}function G(){V=!0,ue(q)}function z(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)Q(t.postRun.shift());ue(U)}function j(e){W.unshift(e)}function K(e){q.unshift(e)}function Q(e){U.unshift(e)}if((!Math.imul||Math.imul(4294967295,5)!==-5)&&(Math.imul=function(t,n){var e=t>>>16,r=t&65535,o=n>>>16,a=n&65535;return r*a+(e*a+r*o<<16)|0}),!Math.fround){var X=new Float32Array(1);Math.fround=function(e){return X[0]=e,X[0]}}Math.clz32||(Math.clz32=function(e){var t=32,n=e>>16;return n&&(t-=16,e=n),n=e>>8,n&&(t-=8,e=n),n=e>>4,n&&(t-=4,e=n),n=e>>2,n&&(t-=2,e=n),n=e>>1,n?t-2:t-e}),Math.trunc||(Math.trunc=function(e){return e<0?Math.ceil(e):Math.floor(e)});var Y=0,J=null,Z=null;function ee(e){Y++,t.monitorRunDependencies&&t.monitorRunDependencies(Y)}function te(e){if(Y--,t.monitorRunDependencies&&t.monitorRunDependencies(Y),Y==0&&(J!==null&&(clearInterval(J),J=null),Z)){var n=Z;Z=null,n()}}t.preloadedImages={},t.preloadedAudios={};function ne(e){t.onAbort&&t.onAbort(e),e+="",C(e),L=!0,E=1,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.";var n=new S.RuntimeError(e);throw o(n),n}var re="data:application/octet-stream;base64,";function oe(e){return e.startsWith(re)}var ae="dgwcppbridge.wasm";oe(ae)||(ae=p(ae));function ie(e){try{if(e==ae&&b)return new Uint8Array(b);var t=ge(e);if(t)return t;if(g)return g(e);throw"both async and sync fetching of the wasm failed"}catch(e){ne(e)}}function le(){return!b&&(c||d)&&typeof fetch=="function"?fetch(ae,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+ae+"'";return e.arrayBuffer()}).catch(function(){return ie(ae)}):n.resolve().then(function(){return ie(ae)})}function se(){var e={a:he};function n(e,n){var r=e.exports;t.asm=r,B=t.asm.A,K(t.asm.c),te("wasm-instantiate")}ee("wasm-instantiate");function r(e){n(e.instance)}function a(t){return le().then(function(t){var n=S.instantiate(t,e);return n}).then(t,function(e){C("failed to asynchronously prepare wasm: "+e),ne(e)})}function i(){return!b&&typeof S.instantiateStreaming=="function"&&!oe(ae)&&typeof fetch=="function"?fetch(ae,{credentials:"same-origin"}).then(function(t){var n=S.instantiateStreaming(t,e);return n.then(r,function(e){return C("wasm streaming compile failed: "+e),C("falling back to ArrayBuffer instantiation"),a(r)})}):a(r)}if(t.instantiateWasm)try{var l=t.instantiateWasm(e,n);return l}catch(e){return C("Module.instantiateWasm callback failed with error: "+e),!1}return i().catch(o),{}}function ue(e){for(;e.length>0;){var n=e.shift();if(typeof n=="function"){n(t);continue}var r=n.func;typeof r=="number"?n.arg===void 0?B.get(r)():B.get(r)(n.arg):r(n.arg===void 0?null:n.arg)}}function ce(e){try{return R.grow(e-T.byteLength+65535>>>16),F(R.buffer),1}catch(e){}}function de(e){var t=x.length;e=e>>>0;var n=2147483648;if(e>n)return!1;for(var r=1;r<=4;r*=2){var o=t*(1+.2/r);o=Math.min(o,e+100663296);var a=Math.min(n,I(Math.max(e,o),65536)),i=ce(a);if(i)return!0}return!1}var me=!1;function pe(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];r>255&&(r&=255),t.push(String.fromCharCode(r))}return t.join("")}var _e=typeof atob=="function"?atob:function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="",r,o,a,i,l,s,u,c=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do i=t.indexOf(e.charAt(c++)),l=t.indexOf(e.charAt(c++)),s=t.indexOf(e.charAt(c++)),u=t.indexOf(e.charAt(c++)),r=i<<2|l>>4,o=(l&15)<<4|s>>2,a=(s&3)<<6|u,n=n+String.fromCharCode(r),s!==64&&(n=n+String.fromCharCode(o)),u!==64&&(n=n+String.fromCharCode(a));while(c<e.length);return n};function fe(e){try{for(var t=_e(e),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t.charCodeAt(r);return n}catch(e){throw new Error("Converting base64 string to bytes failed.")}}function ge(e){if(oe(e))return fe(e.slice(re.length))}var he={b:de,a:R},ye=se(),Ce=t.___wasm_call_ctors=function(){return(Ce=t.___wasm_call_ctors=t.asm.c).apply(null,arguments)},be=t.__malloc=function(){return(be=t.__malloc=t.asm.d).apply(null,arguments)},ve=t.__free=function(){return(ve=t.__free=t.asm.e).apply(null,arguments)},Se=t.__DgwCodecEncodeEmpty=function(){return(Se=t.__DgwCodecEncodeEmpty=t.asm.f).apply(null,arguments)},Re=t.__DgwCodecEncodeDeauth=function(){return(Re=t.__DgwCodecEncodeDeauth=t.asm.g).apply(null,arguments)},Le=t.__DgwCodecEncodeDrain=function(){return(Le=t.__DgwCodecEncodeDrain=t.asm.h).apply(null,arguments)},Ee=t.__DgwCodecEncodeStreamGroup_EstabStream=function(){return(Ee=t.__DgwCodecEncodeStreamGroup_EstabStream=t.asm.i).apply(null,arguments)},ke=t.__DgwCodecEncodeStreamGroup_EndOfData=function(){return(ke=t.__DgwCodecEncodeStreamGroup_EndOfData=t.asm.j).apply(null,arguments)},Ie=t.__DgwCodecEncodeStreamGroup_Data=function(){return(Ie=t.__DgwCodecEncodeStreamGroup_Data=t.asm.k).apply(null,arguments)},Te=t.__DgwCodecEncodeStreamGroup_Ack=function(){return(Te=t.__DgwCodecEncodeStreamGroup_Ack=t.asm.l).apply(null,arguments)},De=t.__DgwCodecEncodePing=function(){return(De=t.__DgwCodecEncodePing=t.asm.m).apply(null,arguments)},xe=t.__DgwCodecEncodePong=function(){return(xe=t.__DgwCodecEncodePong=t.asm.n).apply(null,arguments)},$e=t.__DgwCodecDecode=function(){return($e=t.__DgwCodecDecode=t.asm.o).apply(null,arguments)},Pe=t.__getFrameType=function(){return(Pe=t.__getFrameType=t.asm.p).apply(null,arguments)},Ne=t.__getDrainReasonFromDrainFrame=function(){return(Ne=t.__getDrainReasonFromDrainFrame=t.asm.q).apply(null,arguments)},Me=t.__getDGWFramePtr=function(){return(Me=t.__getDGWFramePtr=t.asm.r).apply(null,arguments)},we=t.__getStreamIdFromStreamGroupFrame=function(){return(we=t.__getStreamIdFromStreamGroupFrame=t.asm.s).apply(null,arguments)},Ae=t.__getEncodedParamsFromEstablishStreamFrame=function(){return(Ae=t.__getEncodedParamsFromEstablishStreamFrame=t.asm.t).apply(null,arguments)},Fe=t.__getEncodedParamsSizeFromEstablishStreamFrame=function(){return(Fe=t.__getEncodedParamsSizeFromEstablishStreamFrame=t.asm.u).apply(null,arguments)},Oe=t.__getDataFromGroupedStreamDataFrame=function(){return(Oe=t.__getDataFromGroupedStreamDataFrame=t.asm.v).apply(null,arguments)},Be=t.__getDataSizeFromGroupedStreamDataFrame=function(){return(Be=t.__getDataSizeFromGroupedStreamDataFrame=t.asm.w).apply(null,arguments)},We=t.__getAckIdFromGroupedStreamDataFrame=function(){return(We=t.__getAckIdFromGroupedStreamDataFrame=t.asm.x).apply(null,arguments)},qe=t.__getRequiresAckFromGroupedStreamDataFrame=function(){return(qe=t.__getRequiresAckFromGroupedStreamDataFrame=t.asm.y).apply(null,arguments)},Ue=t.__getAckIdFromGroupedStreamAckFrame=function(){return(Ue=t.__getAckIdFromGroupedStreamAckFrame=t.asm.z).apply(null,arguments)},Ve;Z=function e(){Ve||He(),Ve||(Z=e)};function He(e){if(e=e||l,Y>0||(H(),Y>0))return;function n(){Ve||(Ve=!0,t.calledRun=!0,!L&&(G(),r(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),z()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),n()},1)):n()}if(t.run=He,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return He(),t.ready})})();typeof i=="object"&&typeof a=="object"?a.exports=e:typeof define=="function"&&define.amd?define([],function(){return e}):typeof i=="object"&&(i.Module=e)}),null);
__d("DGWUtils",["Base64","DGWConstants","DGWCppBridge","IDGWLoggingContext","Random","URI","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e,s=4;function u(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=o("Random").random()*16|0,n=e==="x"?t:t&3|8;return n.toString(16)})}function c(e){var t=new TextDecoder,n=t.decode(e),o=r("Base64").encode(n),a=o.replace(/\+/gi,"-").replace(/\//gi,"_").replace(/=/gi,"");return a}var d=null,m=null;function p(){return m==null&&(m=Promise.resolve().then(function(){return r("DGWCppBridge")()}).then(function(e){d=e})),m}var _=(function(){function t(){}return t.initialize=async function(){return p()},t.constructConnectUrl=function(n){var t,a,i=n.appId,l=n.appVersion,s=n.authToken,u=n.authType,d=n.deviceId,m=n.dgwVersion,p=n.endpoint,_=n.establishStreamFrame,f=n.fbId,g=n.headers,h=n.loggingId,y=n.regionHint,C=n.serviceId,b=n.tier,v=n.trafficTracing,S=(t={},t[(a=o("DGWConstants")).HEADER_CONSTANTS.HEADER_APPID]=i,t[a.HEADER_CONSTANTS.HEADER_APPVERSION]=l,t[a.HEADER_CONSTANTS.HEADER_AUTHTYPE]=u,t[a.HEADER_CONSTANTS.HEADER_DGW_VERSION]=""+m,t[a.HEADER_CONSTANTS.HEADER_UUID]=f,t[a.HEADER_CONSTANTS.HEADER_TARGET_TIER]=b,t);_!==void 0&&(S[o("DGWConstants").HEADER_CONSTANTS.HEADER_ESTABLISH_STREAM_FRAME_BASE64]=c(_)),h!==void 0&&(S[o("DGWConstants").HEADER_CONSTANTS.HEADER_LOGGING_ID]=h),y!==void 0&&(S[o("DGWConstants").HEADER_CONSTANTS.HEADER_REGIONHINT]=y),d!==void 0&&(S[o("DGWConstants").HEADER_CONSTANTS.HEADER_DEVICE_ID]=d),v!==void 0&&(S[o("DGWConstants").HEADER_CONSTANTS.TRAFFIC_TRACING]="debug:"+v),s!==void 0&&(S[o("DGWConstants").HEADER_CONSTANTS.HEADER_AUTHTOKEN]=s),Object.keys(g).forEach(function(e){var t=o("DGWConstants").HEADER_CONSTANTS.APPHEADER_PREFIX+e;Object.prototype.hasOwnProperty.call(S,t)||(S[t]=g[e])});var R=new(e||(e=r("URI")))(p);return R.setQueryData(S),R.setPath(R.getPath()+"/"+C),R.toString().length>2e3&&(delete S[o("DGWConstants").HEADER_CONSTANTS.HEADER_ESTABLISH_STREAM_FRAME_BASE64],R.setQueryData(S)),R.toStringRawQuery()},t})(),f=(function(){function e(e,t,n){this.$1=null,this.$2=e,this.$3=t,this.$4=n}e.initialize=async function(){return p()};var t=e.prototype;return t.malloc=function(t){try{var e=d.__malloc(t);if(e===0){var n;return(n=this.$2)==null||n.logError(o("IDGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"wasm malloc failure","malloc returned 0"),-1}return e}catch(e){var a;return(a=this.$2)==null||a.logError(o("IDGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"wasm malloc failure","exception during malloc",r("getErrorSafe")(e).message),-1}},t.free=function(t){d.__free(t)},t.append=function(t){if(this.$1==null){this.$1=t;return}var e=this.$1.length,n=new Uint8Array(e+t.length);n.set(this.$1,0),n.set(t,e),this.$1=n},t.processData=function(){var e=this;if(this.$1!=null){var t=this.$1.length,n=this.malloc(t);if(n!==-1){var r=d.HEAPU8.subarray(n,n+t);if(this.$1)for(var a=0;a<r.length;++a)r[a]=this.$1[a];var i=this.malloc(s*4);if(i!==-1){var l=i,u=l+s,c=u+s,m=c+s,p=d.__DgwCodecDecode(n,t,l,u,c,m);if(this.free(n),p!==o("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var _;this.free(i),(_=this.$2)==null||_.logError(o("IDGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Codec Decode Failure","Failed to decode Frame(s). Received error code "+o("DGWConstants").DgwCodecReturnCodeToString(p));return}var f=d.HEAPU32.subarray(m/s,m/s+1)[0];if(this.$1==null){this.free(i);return}var g=this.$1.length-f;if(this.$1&&this.$1.length>g){var h;this.$1=new Uint8Array(((h=this.$1)==null?void 0:h.subarray(g))||[])}else this.$1=null;for(var y=d.HEAPU32.subarray(u/s,u/s+1)[0],C=d.HEAPU32.subarray(l/s,l/s+1)[0],b=[],v=function(){var t=d.__getDGWFramePtr(C,S),n=d.__getFrameType(t);switch(n){case o("DGWConstants").DgwFrameType.DgwFrameType_Drain:{var r,a=d.__getDrainReasonFromDrainFrame(t),i=o("DGWConstants").drainReasonToDrainReasonString(a);(r=e.$2)==null||r.logEvent(o("IDGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Received Drain Frame from server","DrainReason: "+i),b.push(function(){var t;return(t=e.$3)==null?void 0:t.receivedDrainSignal(i)});break}case o("DGWConstants").DgwFrameType.DgwFrameType_StreamGroup_EstabStream:{var l=d.__getStreamIdFromStreamGroupFrame(t),s=d.__getEncodedParamsFromEstablishStreamFrame(t),u=new Uint8Array(d.HEAPU8.subarray(s,s+d.__getEncodedParamsSizeFromEstablishStreamFrame(t)));e.free(s),b.push(function(){var t;return(t=e.$3)==null?void 0:t.onGroupedStreamEstablishStreamReceived(l,u)});break}case o("DGWConstants").DgwFrameType.DgwFrameType_StreamGroup_Data:{var c=d.__getStreamIdFromStreamGroupFrame(t),m=d.__getDataFromGroupedStreamDataFrame(t),p=new Uint8Array(d.HEAPU8.subarray(m,m+d.__getDataSizeFromGroupedStreamDataFrame(t)));e.free(m);var _=d.__getRequiresAckFromGroupedStreamDataFrame(t)?d.__getAckIdFromGroupedStreamDataFrame(t):null;b.push(function(){var t;return(t=e.$3)==null?void 0:t.onGroupedStreamDataReceived(c,p,_)});break}case o("DGWConstants").DgwFrameType.DgwFrameType_StreamGroup_Ack:{var f=d.__getStreamIdFromStreamGroupFrame(t),g=d.__getAckIdFromGroupedStreamAckFrame(t);b.push(function(){var t;return(t=e.$3)==null?void 0:t.onGroupedStreamAckReceived(f,g)});break}case o("DGWConstants").DgwFrameType.DgwFrameType_StreamGroup_EndOfData:{var h=d.__getStreamIdFromStreamGroupFrame(t);b.push(function(){var t;return(t=e.$3)==null?void 0:t.onGroupedStreamEndOfDataReceived(h)});break}case o("DGWConstants").DgwFrameType.DgwFrameType_Ping:{b.push(function(){var t;return(t=e.$3)==null?void 0:t.onPingReceived()});break}case o("DGWConstants").DgwFrameType.DgwFrameType_Pong:{b.push(function(){var t;return(t=e.$3)==null?void 0:t.onPongReceived()});break}default:break}e.free(t)},S=0;S<y;++S)v();this.free(i);for(var R=0;R<b.length;R++)b[R]()}}}},t.encodeData=function(t,n,r,a){var e=this.malloc(t.length);if(e===-1)return null;for(var i=d.HEAPU8.subarray(e,e+t.length),l=0;l<i.length;++l)i[l]=t[l];var u=this.malloc(s*2),c=u,m=u+s,p=d.__DgwCodecEncodeStreamGroup_Data(a,e,i.length,n,r,c,m);if(this.free(e),p!==o("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var _;return(_=this.$2)==null||_.logError(o("IDGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Data Frame encode failure","Failed to decode DGW Data Frame. Received error code "+o("DGWConstants").DgwCodecReturnCodeToString(p)),null}var f=d.HEAPU32.subarray(c/s,c/s+1)[0],g=d.HEAPU32.subarray(m/s,m/s+1)[0],h=new Uint8Array(d.HEAPU8.subarray(f,f+g));return this.free(f),this.free(u),h},t.encodeAck=function(t,n){var e=this.malloc(s*2);if(e===-1)return null;var r=e,a=e+s,i=d.__DgwCodecEncodeStreamGroup_Ack(n,t,r,a);if(i!==o("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var l;return(l=this.$2)==null||l.logError(o("IDGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"ACK Frame encode failure","Failed to encode ACK Frame. Received error code "+o("DGWConstants").DgwCodecReturnCodeToString(i)),null}var u=d.HEAPU32.subarray(r/s,r/s+1)[0],c=d.HEAPU32.subarray(a/s,a/s+1)[0],m=new Uint8Array(d.HEAPU8.subarray(u,u+c));return this.free(u),this.free(e),m},t.encodeDrain=function(t){var e=this.malloc(s*2);if(e===-1)return null;var n=e,r=e+s,a=d.__DgwCodecEncodeDrain(t,n,r);if(a!==o("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var i;return(i=this.$2)==null||i.logError(o("IDGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Drain Frame encode failure","Failed to encode Drain Frame. Received error code "+o("DGWConstants").DgwCodecReturnCodeToString(a)),null}var l=d.HEAPU32.subarray(n/s,n/s+1)[0],u=d.HEAPU32.subarray(r/s,r/s+1)[0],c=new Uint8Array(d.HEAPU8.subarray(l,l+u));return this.free(l),this.free(e),c},t.encodeEstablishStream=function(t,n){var e=this.malloc(n.length);if(e===-1)return null;for(var r=d.HEAPU8.subarray(e,e+n.length),a=0;a<n.length;++a)r[a]=n[a];var i=this.malloc(s*2),l=i,u=i+s,c=d.__DgwCodecEncodeStreamGroup_EstabStream(t,e,n.length,l,u);if(this.free(e),c!==o("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var m;return(m=this.$2)==null||m.logError(o("IDGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"EstablishStream Frame encode failure","Failed to encode EstablishStream Frame. Received error code "+o("DGWConstants").DgwCodecReturnCodeToString(c)+" for StreamId "+t),null}var p=d.HEAPU32.subarray(l/s,l/s+1)[0],_=d.HEAPU32.subarray(u/s,u/s+1)[0],f=new Uint8Array(d.HEAPU8.subarray(p,p+_));return this.free(p),this.free(i),f},t.encodeEndOfData=function(t){var e=this.malloc(s*2);if(e===-1)return null;var n=e,r=e+s,a=d.__DgwCodecEncodeStreamGroup_EndOfData(t,n,r);if(a!==o("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var i;return(i=this.$2)==null||i.logError(o("IDGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"EndOfData Frame encode failure","Failed to encode EndOfData Frame. Received error code "+o("DGWConstants").DgwCodecReturnCodeToString(a)),null}var l=d.HEAPU32.subarray(n/s,n/s+1)[0],u=d.HEAPU32.subarray(r/s,r/s+1)[0],c=new Uint8Array(d.HEAPU8.subarray(l,l+u));return this.free(l),this.free(e),c},t.encodePing=function(){var e=this.malloc(s*2);if(e===-1)return null;var t=e,n=e+s,r=d.__DgwCodecEncodePing(t,n);if(r!==o("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var a;return(a=this.$2)==null||a.logError(o("IDGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Ping Frame encode failure","Failed to encode Ping Frame. Received error code "+o("DGWConstants").DgwCodecReturnCodeToString(r)),null}var i=d.HEAPU32.subarray(t/s,t/s+1)[0],l=d.HEAPU32.subarray(n/s,n/s+1)[0],u=new Uint8Array(d.HEAPU8.subarray(i,i+l));return this.free(i),this.free(e),u},t.encodePong=function(){if(this.$5!=null)return this.$5;var e=this.malloc(s*2);if(e===-1)return null;var t=e,n=e+s,r=d.__DgwCodecEncodePong(t,n);if(r!==o("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var a;return(a=this.$2)==null||a.logError(o("IDGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Pong Frame encode failure","Failed to encode Pong Frame. Received error code "+o("DGWConstants").DgwCodecReturnCodeToString(r)),null}var i=d.HEAPU32.subarray(t/s,t/s+1)[0],l=d.HEAPU32.subarray(n/s,n/s+1)[0],u=new Uint8Array(d.HEAPU8.subarray(i,i+l));return this.free(i),this.free(e),this.$5=u,u},e})();l.uuidv4=u,l.Uint8ArrayToBase64UrlStr=c,l.DGWUtils=_,l.DGWCodec=f}),98);
__d("DGWExponentialBackoff",[],(function(t,n,r,o,a,i){"use strict";var e={maxRetries:5,baseRetryInterval:1e3,backoffFactor:Math.sqrt(2)},l=(function(e){function t(t,n){var r;return r=e.call(this,t)||this,r.errors=n,r}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error));async function s(t,n){n===void 0&&(n=e);try{return await u(t,n)}catch(e){throw e.errors[e.errors.length-1]}}async function u(e,t){for(var n=0,r=[],o=t.baseRetryInterval,a=t.backoffFactor;n<=t.maxRetries;){try{var i=await e();return i}catch(e){r.push(e)}await c(o*Math.pow(a,n)),++n}throw new l("Max call count exceeded",r)}async function c(e){await new Promise(function(t){return window.setTimeout(t,e)})}i.callWithExponentialBackoff=s}),66);
__d("DGWPinger",["IDGWLoggingContext"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e,t,n,r){this.$1=e,this.$4=t,this.$5=n,this.$6=r,this.$3=!1}var t=e.prototype;return t.$7=function(){var e=this;this.$3?(this.$6.bumpODSKey(o("IDGWLoggingContext").DGWLoggingComponent.PINGER,"timeout_fired.reset"),this.$3=!1,this.$4(),this.$6.bumpODSKey(o("IDGWLoggingContext").DGWLoggingComponent.PINGER,"timeout.newtimeout"),this.$2=window.setTimeout(function(){e.$7()},this.$1)):(this.$6.bumpODSKey(o("IDGWLoggingContext").DGWLoggingComponent.PINGER,"timeout_fired.disconnect"),this.$5())},t.reset=function(){var e=this;this.$3=!0,this.$2&&(this.$6.bumpODSKey(o("IDGWLoggingContext").DGWLoggingComponent.PINGER,"reset"),window.clearTimeout(this.$2),this.$2=null),this.$1>0&&(this.$6.bumpODSKey(o("IDGWLoggingContext").DGWLoggingComponent.PINGER,"reset.newtimeout"),this.$2=window.setTimeout(function(){e.$7()},this.$1))},t.cancel=function(){this.$2&&(this.$6.bumpODSKey(o("IDGWLoggingContext").DGWLoggingComponent.PINGER,"canceled"),window.clearTimeout(this.$2),this.$2=null)},e})();l.DGWPinger=e}),98);
__d("DGWStreamGroupCallbacks",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum")({TRANSPORT_SERVER_INTERNAL_ERROR:0,TRANSPORT_ABNORMAL_CLOSURE:1,TRANSPORT_GOING_AWAY:2,TRANSPORT_UNKNOWN_ERROR:3,TRANSPORT_KEEPALIVE_TIMEOUT:4,TRANSPORT_UNAUTHORIZED:5,TRANSPORT_REJECTED:6,TRANSPORT_BAD_REQUEST:7,TRANSPORT_DGW_SERVER_ERROR:8,TRANSPORT_NORMAL_CLOSURE:9});function l(t){switch(t){case e.TRANSPORT_SERVER_INTERNAL_ERROR:return"TRANSPORT_SERVER_INTERNAL_ERROR";case e.TRANSPORT_ABNORMAL_CLOSURE:return"TRANSPORT_ABNORMAL_CLOSURE";case e.TRANSPORT_GOING_AWAY:return"TRANSPORT_GOING_AWAY";case e.TRANSPORT_UNKNOWN_ERROR:return"TRANSPORT_UNKNOWN_ERROR";case e.TRANSPORT_KEEPALIVE_TIMEOUT:return"TRANSPORT_KEEPALIVE_TIMEOUT";case e.TRANSPORT_UNAUTHORIZED:return"TRANSPORT_UNAUTHORIZED";case e.TRANSPORT_REJECTED:return"TRANSPORT_REJECTED";case e.TRANSPORT_BAD_REQUEST:return"TRANSPORT_BAD_REQUEST";case e.TRANSPORT_DGW_SERVER_ERROR:return"TRANSPORT_DGW_SERVER_ERROR";case e.TRANSPORT_NORMAL_CLOSURE:return"TRANSPORT_NORMAL_CLOSURE"}}function s(t){switch(t){case e.TRANSPORT_UNAUTHORIZED:return!1;default:return!0}}var u=(function(){function e(){}var t=e.prototype;return t.onStreamGroupError=function(){},t.onStreamGroupMustDrain=function(){},t.onStreamGroupTransportClose=function(){},e})();i.DGWStreamGroupError=e,i.dgwStreamGroupErrorToString=l,i.isRetryableError=s,i.NoOpDGWStreamGroupCallbacks=u}),66);
__d("DGWTransportEvents",["IDGWLoggingContext"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.$3=e}var t=e.prototype;return t.transportEstablished=function(t){this.$3.logEvent(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"open",t),this.$2=Date.now(),this.$3.bumpODSKey(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_group_establishment_success")},t.transportPingSent=function(t){this.$3.logEvent(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Ping Frame Sent",t,!0)},t.transportPongReceived=function(t){this.$3.logEvent(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Pong Frame Received",t,!0)},t.transportEstablishmentPending=function(){this.$1=Date.now(),this.$3.logEvent(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"transportPending",null,!0),this.$3.bumpODSKey(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_group_establishment_pending")},t.transportClosed=function(t,n,r){this.$4=Date.now(),t?(this.$3.bumpODSKey(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"transport_close_graceful"),this.$3.logEvent(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Transport closed gracefully",null,!0)):(this.$3.bumpODSKey(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"transport_close_with_error"),this.$3.logError(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Transport closed abnormally",n,r))},t.transportEstablishmentFailure=function(t){this.$3.logError(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"WebSocket transport establishment failure","WebSocket close code: "+t.code+" reason: "+t.reason+" wasClean: "+String(t.wasClean)),this.$3.bumpODSKey(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_group_establishment_failure")},t.streamEstablishmentTimeout=function(t,n,r){this.$3.logError(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Grouped Stream establishment timeout",t,"streamId:"+n,!1,r,!0),this.$3.bumpODSKey(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_establishment_timeout")},t.streamEstablishmentPending=function(t,n){this.$3.logEvent(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Grouped Stream establishment pending","streamId:"+t,!0,n),this.$3.bumpODSKey(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_establishment_pending")},t.streamEstablishmentSuccess=function(t,n){this.$3.logEvent(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Grouped Stream establishment success","streamId:"+t,!0,n),this.$3.bumpODSKey(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_establishment_success")},t.transportError=function(t,n,r){this.$3.logError(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,t,n,r)},t.receivedFrameForInactiveStream=function(t,n,r){this.$3.logWarn(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Frame received for inactive stream","frameType: "+t+", streamID: "+n,r)},t.ranOutOfStreamIds=function(t){this.$3.logWarn(o("IDGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Hit max StreamId limit","Hit max StreamId limit",t)},e})();l.DGWTransportEvents=e}),98);
__d("DGWWebSocketTransport",[],(function(t,n,r,o,a,i){"use strict";function e(e){var t=new WebSocket(e);return t.binaryType="arraybuffer",t.onopen=function(){},t.onclose=function(){},t.onerror=function(){},t}i.getWebSocketConnection=e}),66);
__d("DGWStreamEvents",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(e,t,n){this.$4=new Map,this.$5=new Map,this.$6=e,this.$1=t,n!=null&&(this.$8="streamId:"+n+"::")}var t=e.prototype;return t.dataSent=function(t,n,r){var e,o=n?"sendWithAckRequested":"sendWithoutAckRequested";this.$6.logEvent(this.$1,o,((e=this.$8)!=null?e:"")+"sendId:"+r+", payloadSize:"+t,!0),this.$4.set(r,{ackRequested:n,payloadSize:t,sendTimestamp:Date.now()})},t.ackReceived=function(t){var e;this.$6.logEvent(this.$1,"AckReceived",((e=this.$8)!=null?e:"")+"sendId:"+t,!0),this.$6.bumpODSKey(this.$1,"ack_received");var n=this.$4.get(t);n!=null&&(n.ackReceivedTimestamp=Date.now())},t.ackSent=function(t){var e;this.$6.bumpODSKey(this.$1,"ack_sent"),this.$6.logEvent(this.$1,"ACK sent",((e=this.$8)!=null?e:"")+"ackId:"+t,!0)},t.drainSent=function(t){var e;this.$6.logEvent(this.$1,"Drain sent",((e=this.$8)!=null?e:"")+"drainReason: "+t)},t.dataReceived=function(t,n,r){var e;this.$6.bumpODSKey(this.$1,"data_received"),this.$6.logEvent(this.$1,"Data received",((e=this.$8)!=null?e:"")+"sendId:"+(r!=null?r:"null")+", ackRequested:"+n.toString()+", payloadSize:"+t,!0),r!=null&&this.$5.set(r,{ackRequested:n,payloadSize:t,receiveTimestamp:Date.now()})},t.endOfDataReceived=function(){this.$6.bumpODSKey(this.$1,"end_of_data_received"),this.$6.logEvent(this.$1,"EndOfDataReceived",this.$8,!0)},t.endOfDataSent=function(){this.$6.bumpODSKey(this.$1,"end_of_data_sent"),this.$6.logEvent(this.$1,"EndOfDataSent",this.$8,!0)},t.streamClosed=function(t,n){this.$7=Date.now();var e=this.$9();if(t){var r;this.$6.bumpODSKey(this.$1,"stream_closed_gracefully"),this.$6.logEvent(this.$1,"Stream closed gracefully",""+((r=this.$8)!=null?r:"")+e)}else{var o;this.$6.bumpODSKey(this.$1,"stream_closed_with_error"),this.$6.logError(this.$1,"Stream closed abnormally",n,""+((o=this.$8)!=null?o:"")+e)}},t.connectionEstablishmentFailure=function(t){this.$6.logEvent(this.$1,"WebSocket connection establishment failure","WebSocket close code: "+t)},t.streamEstablishmentFailure=function(t,n){var e;this.$6.logError(this.$1,"Failed to establish DGW Stream","Last seen error: "+t.toString(),""+((e=this.$8)!=null?e:"")+n),this.$6.bumpODSKey(this.$1,"stream_establishment_failure")},t.error=function(t,n){var e={msg:n,state:this.$9()};this.$6.logError(this.$1,t,JSON.stringify(e),this.$8)},t.$9=function(){var e={currentNetworkCondition:window.navigator&&window.navigator.onLine===!0,establishRequestTimestamp:this.$2,establishedTimestamp:this.$3,streamClosedTimestamp:this.$7,sendHistory:JSON.stringify(Array.from(this.$4.entries())),receiveHistory:JSON.stringify(Array.from(this.$5.entries()))};return JSON.stringify(e)},e})();i.DGWStreamEvents=e}),66);
__d("GroupedStream",["DGWAckManager","DGWConstants","DGWStream","DGWStreamEvents","IDGWLoggingContext","Random"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e,t,n,r,a,i,l){this.$1=e,this.$3=!1,this.$4=!1,this.$5=!1,this.$6=t,this.$7=n,this.$8=r,this.$2=i,this.$9=a,this.$10=new(o("DGWAckManager")).DGWAckManager(this.$9),this.$12=new(o("DGWStreamEvents")).DGWStreamEvents(this.$9,o("IDGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,this.$1),this.$11=0,this.$13=l,this.$14=Date.now()+(Math.round(o("Random").random()*1e4)+1e4),this.$9.qplMarkerStart(o("IDGWLoggingContext").QPLEvent.STREAM_LIFECYCLE,this.$14)}var t=e.prototype;return t.send=async function(t,n){var e=this.$11++%o("DGWConstants").MAX_ACK_ID,r=this.$15(t,!0,e);if(!this.$16(r,!0,e))return!1;var a=await this.$10.waitForAck(e,n!=null?n:o("DGWConstants").DEFAULT_ACK_TIMEOUT_MS);return a},t.sendFrame=async function(t,n,r){var e=this.$11++%o("DGWConstants").MAX_ACK_ID,a=this.$15(n,!0,e);if(a==null)return!1;var i=new Uint8Array(t.length+a.length);if(i.set(t),i.set(a,t.length),!this.$16(i,!0,e))return!1;var l=await this.$10.waitForAck(e,r!=null?r:o("DGWConstants").DEFAULT_ACK_TIMEOUT_MS);return this.__markerPoint(l?"ack_recevied":"ack_timeout"),l||(this.__endMarker(o("IDGWLoggingContext").QPLResult.FAIL),Promise.reject(o("DGWStream").StreamError.ACK_TIMEOUT))},t.sendAndForget=function(t){var e=this.$15(t,!1,0);return this.$16(e,!1,0)},t.sendFrameAndForget=function(t,n){var e=this.$15(n,!1,0);if(e==null)return!1;var r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),this.$16(r,!1,0)},t.close=function(){var e=this.$2.encodeEndOfData(this.$1);if(e==null){this.$9.logError(o("IDGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to encode EndOfData","streamId: "+this.$1);return}var t=this.$8.send(e);if(!t){this.$9.logError(o("IDGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to send EndOfData","streamId: "+this.$1+". StreamGroupTransport not open during send");return}this.$12.endOfDataSent(),this.$5=!0,this.$4&&this.$17()},t.loggingContext=function(){return this.$9},t.__sendDrain=function(t){var e=o("DGWConstants").drainReasonToDrainReasonString(t);if(this.$5)return!1;var n=this.$2.encodeDrain(t);if(n==null)return!1;this.$12.drainSent(e);var r=this.$8.send(n);return r},t.__transportCloseHook=function(t){this.$13(),this.$10.clearPendingAcks(),t?(this.$12.error("Received StreamError","StreamErrorType: "+t),this.$6.onError(t)):this.$5&&this.$4?this.$17():(this.$12.streamClosed(!1,"Stream closed: ClosedLocally: "+this.$5.toString()+", EndOfDataReceived: "+this.$4.toString()),this.$6.onError(o("DGWStream").StreamError.PREMATURE_CLOSE))},t.$17=function(){this.$13(),this.$12.streamClosed(!0,"Graceful close"),this.$6.onClose(this)},t.__dataReceivedHook=function(t,n){this.$12.dataReceived(t.length,n!=null,n),n!=null&&this.$18(n),this.$6.onDataReceived(t)},t.__ackReceivedHook=function(t){this.$12.ackReceived(t),this.$10.handleAckReceived(t)},t.__drainReceivedHook=function(t){this.$3===!1&&(this.$6.onStreamMustDrain(this,t),this.$3=!0)},t.__endOfDataHook=function(){this.$12.endOfDataReceived(),this.$4=!0,this.$5?this.$17():this.$6.onServerHasFinishedSendingData(this)},t.__markerPoint=function(t){this.$9.qplMarkerPoint(o("IDGWLoggingContext").QPLEvent.STREAM_LIFECYCLE,t,this.$14)},t.__markerAnnotate=function(t){this.$9.qplMarkerAnnotate(o("IDGWLoggingContext").QPLEvent.STREAM_LIFECYCLE,t,this.$14)},t.__endMarker=function(t){this.$9.qplMarkerEnd(o("IDGWLoggingContext").QPLEvent.STREAM_LIFECYCLE,t,this.$14)},t.$15=function(t,n,r){return this.$2.encodeData(t,n,r,this.$1)},t.$16=function(t,n,r){if(this.__markerPoint("send_data_start"),this.$5)return this.$9.logError(o("IDGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to send data","Stream closed locally"),!1;if(t==null)return!1;var e=this.$8.send(t);return e?(this.__markerPoint("send_data_end"),this.$12.dataSent(t.length,n,r),!0):(this.$9.logError(o("IDGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to send data","ClosedLocally: "+this.$5.toString()),!1)},t.$18=function(t){var e=this.$2.encodeAck(t,this.$1);if(e==null)return this.$9.logError(o("IDGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to encode ACK","ackId: "+t),!1;var n=this.$8.send(e);return n?(this.$12.ackSent(t),!0):(this.$9.logError(o("IDGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to send ACK","ackId: "+t),!1)},e})();l.GroupedStream=e}),98);
__d("NoOpDGWLoggingContext",["IDGWLoggingContext"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(){}var t=e.prototype;return t.streamRequested=function(t){},t.streamClosed=function(t){},t.tabClosed=function(){},t.getGlobalState=function(){return{realtime:0,lightspeed:0}},e})(),s=new e,u=(function(){function e(){this.sgTransportId=null}var t=e.prototype;return t.getGlobalLogger=function(){return s},t.bumpODSKey=function(t,n,r){},t.logEvent=function(t,n,r,o,a){},t.logError=function(t,n,r,o,a,i,l){},t.logWarn=function(t,n,r,o,a){},t.qplMarkerStart=function(t,n){},t.qplMarkerEnd=function(t,n,r){},t.qplMarkerPoint=function(t,n,r){},t.qplMarkerAnnotate=function(t,n,r){},e})();l.DGWLoggingComponent=o("IDGWLoggingContext").DGWLoggingComponent,l.QPLEvent=o("IDGWLoggingContext").QPLEvent,l.QPLResult=o("IDGWLoggingContext").QPLResult,l.NoOpDGWLoggingContext=u,l.DGWLoggingContext=u}),98);
__d("StreamIdGenerator",["err"],(function(t,n,r,o,a,i,l){"use strict";var e=65535,s=(function(){function t(){this.$1=new Set,this.$2=0}var n=t.prototype;return n.getNextStreamId=function(){var t;if(!this.streamIdAvailable())throw r("err")("Max number of stream IDs reached");if(this.$2<=e)return this.$2++;var n=(t=this.$1.values().next().value)!=null?t:0;return this.$1.delete(n),n},n.putBackStreamId=function(t){this.$1.add(t)},n.streamIdAvailable=function(){return this.$1.size>0||this.$2<=e},t})();l.MAX_STREAM_ID=e,l.StreamIdGeneratorImpl=s}),98);
__d("StreamGroupWebSocketTransport",["DGWConstants","DGWExponentialBackoff","DGWPinger","DGWStream","DGWStreamGroupCallbacks","DGWTransportEvents","DGWUtils","DGWWebSocketTransport","GroupedStream","IDGWLoggingContext","NoOpDGWLoggingContext","Random","Run","StreamIdGenerator","err","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e=!1,s=function(t,n,r,a,i){var e=this;this.groupedStream=t,this.$1=window.setTimeout(function(){r(o("DGWStream").StreamError.ESTABLISHMENT_TIMEOUT)},a),this.handleEstablishFrameReceived=function(){window.clearTimeout(e.$1),n(e.groupedStream)},this.abortStream=function(e){i(),r(e)}},u=(function(){function e(t,n,a,i,l,s,u,c,d){var m=this,p;this.$18=-1,this.$15=l,this.$17=this.__getStreamIdGenerator(),this.$5=new Map,this.$6=new Map,this.$7=i.keepAliveMs,this.$8=!1,this.$9=!1,this.$3=!0,this.$4=!1,this.$20=!1,this.$21=!1,this.$13=a,this.$11=new TextEncoder,this.$12=new TextDecoder,this.$14=i;var _={onDataReceived:function(){},handleAckReceived:function(){},receivedDrainSignal:function(t){m.$9||(m.$9=!0,m.$15(),m.$13.transportClosed(!0,""),m.$14.streamGroupCallbacks.onStreamGroupMustDrain(t),m.$5.forEach(function(e){e.__drainReceivedHook(t)}),m.onClose(o("DGWConstants").WebsocketCloseCodes.GRACEFUL_CLOSE))},onGroupedStreamDataReceived:function(t,n,r){if(m.$5.has(t)){var e=m.$5.get(t);e==null||e.__dataReceivedHook(n,r)}else m.$13.receivedFrameForInactiveStream("Data",t,"sendAckID: "+(r!=null?r:"null"))},onGroupedStreamAckReceived:function(t,n){if(m.$5.has(t)){var e=m.$5.get(t);e==null||e.__ackReceivedHook(n)}else m.$13.receivedFrameForInactiveStream("ACK",t,"ackId: "+(n!=null?n:"null"))},onGroupedStreamEndOfDataReceived:function(t){if(m.$5.has(t)){var e=m.$5.get(t);e==null||e.__endOfDataHook()}else m.$13.receivedFrameForInactiveStream("EndOfData",t)},onGroupedStreamEstablishStreamReceived:function(t,n){if(m.$6.has(t)){var e=m.$6.get(t);m.$6.delete(t);var r=JSON.parse(m.$12.decode(n));(r.code===void 0||r.code!==200)&&(e==null||e.abortStream(o("DGWStream").StreamError.ABNORMAL_CLOSURE)),e==null||e.handleEstablishFrameReceived()}else m.$13.receivedFrameForInactiveStream("EstablishStream",t,"EstablishStream received for non-inflight stream")},onPingReceived:function(){var e=m.$2.encodePing();e!=null&&m.send(e)},onPongReceived:function(){m.$3=!1,m.$21||(m.$21=!0,m.__markerPoint("auth_success")),m.$13.transportPongReceived("readyState:"+m.$1.readyState+", bufferedAmount:"+m.$1.bufferedAmount)}};this.$2=new(o("DGWUtils")).DGWCodec(s,_,i.dgwVersion),this.$19=Date.now()+(Math.round(o("Random").random()*1e4)+1e4),this.$22=s.getGlobalLogger(),this.$23=(p=i.connectTimeoutMs)!=null?p:2e4,this.$24=s,this.$25=d;var f=o("Run").onUnload(function(){m.$22.tabClosed()});if(i.enableFirstStreamOnWsHandshake){var g,h,y,C;if(u===void 0)throw r("err")("Missing grouped stream options");if(c===void 0)throw r("err")("Missing grouped stream callbacks");var b=this.$17.getNextStreamId(),v=this.createEstablishStreamFrame(b,u),S=o("DGWUtils").DGWUtils.constructConnectUrl({appId:i.appId,appVersion:i.appVersion,authType:i.authType,deviceId:(g=i.deviceId)!=null?g:void 0,dgwVersion:i.dgwVersion,fbId:i.fbId,tier:i.tier,loggingId:(h=i.loggingId)!=null?h:void 0,headers:e.__prefixAppHeaders(i.headers),endpoint:i.connectEndpoint,serviceId:i.serviceId,regionHint:(y=i.regionHint)!=null?y:void 0,establishStreamFrame:v,authToken:(C=i.authToken)!=null?C:void 0});if(this.$1=n(S),!S.includes(o("DGWConstants").HEADER_CONSTANTS.HEADER_ESTABLISH_STREAM_FRAME_BASE64))return;var R=this.$25!=null?this.$25(u.loggingId,u.disableFalcoLogging):new(o("NoOpDGWLoggingContext")).NoOpDGWLoggingContext,L=this.__createGroupedStream(b,c,u,R);this.$16=this.waitForEstablishStream(b,L,u,function(e){m.$5.set(b,e)},function(){m.$17.putBackStreamId(b)})}else this.$1=n(t);this.$22.streamRequested(i.serviceId),this.$24.qplMarkerStart(o("IDGWLoggingContext").QPLEvent.STREAM_GROUP_TRANSPORT,this.$19),this.__markerAnnotate({string:{serviceId:this.$14.serviceId,streamGroupId:this.$14.loggingId}})}var t=e.prototype;return t.send=function(t){try{return this.$1.send(t),!0}catch(e){return this.$13.transportError("Failed to send over transport","readyState: "+this.$1.readyState,r("getErrorSafe")(e).message),!1}},t.close=function(){var e;this.$22.streamClosed(this.$14.serviceId),this.__markerPoint("teardown"),this.$8=!0,(e=this.$10)==null||e.cancel(),this.$1.onopen=function(e){},this.$1.onmessage=function(e){},this.$1.onerror=function(e){},this.$1.onclose=function(e){},this.$15(),this.$1.close()},t.onClose=function(t){var e;this.$22.streamClosed(this.$14.serviceId),this.__markerPoint("abort"),this.__markerAnnotate({int:{abort_code:t}}),this.$8=!0,(e=this.$10)==null||e.cancel(),this.$1.close(t)},t.abort=function(t,n,r,o,a){this.$8||(this.$22.streamClosed(this.$14.serviceId),this.$8=!0,this.$13.transportClosed(!1,o,a),this.$5.forEach(function(e){e.__transportCloseHook(n)}),this.$6.forEach(function(e){e.abortStream(n)}),this.$14.streamGroupCallbacks.onStreamGroupError(t),this.$5.clear(),this.$6.clear(),this.$15(),this.onClose(r))},e.getTransportWithInitialStream=async function(n,r,a,i,l,s,u){await o("DGWUtils").DGWCodec.initialize();var t=new(o("DGWTransportEvents")).DGWTransportEvents(i);t.transportEstablishmentPending();var c=function(){return e.$26("",a,t,l,i,n,r,u)};try{var d=await o("DGWExponentialBackoff").callWithExponentialBackoff(c,s),m=u!=null?u(n.loggingId,n.disableFalcoLogging):new(o("NoOpDGWLoggingContext")).NoOpDGWLoggingContext,p=d.$16!=null?d.$16:d.establishGroupedStream(r,n,m);return{transport:d,streamPromise:p}}catch(e){throw e}},e.getTransport_DEPRECATED=async function(n,r,a,i,l,s){await o("DGWUtils").DGWCodec.initialize();var t=new(o("DGWTransportEvents")).DGWTransportEvents(a);t.transportEstablishmentPending();var u=function(){return e.$26(n,r,t,i,a,void 0,void 0,s)};try{return await o("DGWExponentialBackoff").callWithExponentialBackoff(u,l)}catch(e){throw e}},t.establishGroupedStream=async function(t,n,a,i,l,s){var e=this;l===void 0&&(l=!0);var u=this.getStreamId(),c=this.createEstablishStreamFrame(u,n),d=this.__createGroupedStream(u,t,n,a);d.__markerAnnotate({string:{serviceId:this.$14.serviceId,streamGroupId:this.$14.loggingId,streamId:n.streamTraceId}}),s!=null&&d.__markerAnnotate(s);var m=this.waitForEstablishStream(u,d,n,function(t){e.$5.set(u,t)},function(){e.$17.putBackStreamId(u)});if(i!=null){var p;d.__markerPoint("send_payload_start"),d.__markerAnnotate({int:{establishStreamPayloadSize:i.byteLength}});var _=(p=n.ackTimeoutMs)!=null?p:3e4,f=l?await d.sendFrame(c,i,_):d.sendFrameAndForget(c,i);return f?(d.__markerPoint("send_payload_end"),d.__endMarker(o("IDGWLoggingContext").QPLResult.SUCCESS),Promise.resolve(d)):(d.__endMarker(o("IDGWLoggingContext").QPLResult.FAIL),Promise.reject("Failed to send data when establishing stream"))}if(d.__markerPoint("send_establish_stream_start"),!this.send(c))throw d.__endMarker(o("IDGWLoggingContext").QPLResult.FAIL),r("err")("Websocket connection closed before stream established");d.__markerPoint("send_establish_stream_end");var g=await m;return d.__endMarker(o("IDGWLoggingContext").QPLResult.SUCCESS),g},e.__prefixAppHeaders=function(t){return Object.keys(t).reduce(function(e,n){return e[""+o("DGWConstants").HEADER_CONSTANTS.APPHEADER_PREFIX+n]=t[n],e},{})},t.waitForEstablishStream=async function(t,n,r,o,a){var e=this;this.$13.streamEstablishmentPending(t,r.loggingId);try{var i=await new Promise(function(r,o){e.$6.set(t,new s(n,r,o,3e4,function(){e.streamEndCallback(t)}))});return o(n),this.$13.streamEstablishmentSuccess(t,r.loggingId),i}catch(e){throw a(),this.$13.streamEstablishmentTimeout("Stream establishment timeout. readyState: "+this.$1.readyState,t,r.loggingId),e}},e.$26=async function(n,r,a,i,l,s,u,c){var t=new e(n,o("DGWWebSocketTransport").getWebSocketConnection,a,r,i,l,s,u,c);t.$1.onmessage=e.$27(t),t.$1.onopen=function(){t.__markerPoint("onopen"),a.transportEstablished(n),t.$10!=null&&t.$10.cancel(),t.$7!=null&&(t.$10=new(o("DGWPinger")).DGWPinger(t.$7,function(){t.$28()},function(){t.abort(o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_KEEPALIVE_TIMEOUT,o("DGWStream").StreamError.KEEPALIVE_TIMEOUT,o("DGWConstants").WebsocketCloseCodes.KEEPALIVE_TIMEOUT,"Aborting transport because of keepalive timeout","readyState:"+t.$1.readyState+", bufferedAmount:"+t.$1.bufferedAmount)},l))},t.$1.onerror=function(){t.__markerPoint("onerror"),t.$13.transportError("onerror","readyState: "+t.$1.readyState)},t.$1.onclose=e.$29(t);var d=await e.getTransportPromise(t);return d},e.getTransportPromise=async function(t){var e,n=new Promise(function(n,r){e=window.setTimeout(function(){t.$15(),t.$13.transportClosed(!1,"TIMEOUT"),t.__markerPoint("connect_timeout"),t.close(),r(o("DGWStream").StreamError.TRANSPORT_ESTABLISHMENT_TIMEOUT)},t.$23)}),r=new Promise(function(e,n){var r=t.$1.onerror,a=t.$1.onmessage,i=t.$1.onclose;t.$1.onerror=function(){r(),t.close(),n(o("DGWStream").StreamError.ESTABLISHMENT_ERROR)},t.$1.onclose=function(e){i(e),e.code===o("DGWConstants").WebsocketCloseCodes.UNAUTHORIZED?n(o("DGWStream").StreamError.UNAUTHORIZED):n(e.code+":"+e.reason)},t.$1.onmessage=function(n){a(n),t.$3||(t.__markerPoint("connect_success"),e(t))}});try{return await Promise.race([r,n])}finally{e!=null&&window.clearTimeout(e)}},e.$27=function(t){return function(e){var n;if(t.$2==null){var r;(r=t.$13)==null||r.transportError("Codec Not Ready","Received message before codec was initialized or after close");return}if(t.$20||(t.$20=!0,t.__markerPoint("onmessage")),(n=t.$10)==null||n.reset(),!(e.data instanceof ArrayBuffer)){var o;(o=t.$13)==null||o.transportError("Incorrect Data Protocol","Received "+typeof e.data+" instead of ArrayBuffer");return}t.$2.append(new Uint8Array(e.data)),t.$2.processData()}},e.$29=function(t){return function(e){var n,r=t.$22.getGlobalState();if(t.__markerPoint("onclose"),t.__markerAnnotate({string:{reason:e.reason},int:{code:e.code,realtimeWebSockets:r.realtime,lightspeedWebSockets:r.lightspeed}}),t.__endMarker(e.code===o("DGWConstants").WebsocketCloseCodes.GRACEFUL_CLOSE?o("IDGWLoggingContext").QPLResult.SUCCESS:o("IDGWLoggingContext").QPLResult.FAIL),(n=t.$10)==null||n.cancel(),!(t.$8===!0||t.$4)){if(t.$22.streamClosed(t.$14.serviceId),t.$8=!0,t.$3===!0){t.$13.transportEstablishmentFailure(e),t.$5.clear(),t.$15();return}if(t.$15(),t.$3=!0,e.code!==o("DGWConstants").WebsocketCloseCodes.GRACEFUL_CLOSE){t.$13.transportClosed(!1,"Websocket connection failure with code: "+e.code+" reason: "+e.reason+" wasClean: "+String(e.wasClean));var a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_UNKNOWN_ERROR,i=o("DGWStream").StreamError.UNKNOWN_ERROR;switch(e.code){case o("DGWConstants").WebsocketCloseCodes.NORMAL_CLOSURE:a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_NORMAL_CLOSURE,i=o("DGWStream").StreamError.ABNORMAL_CLOSURE;break;case o("DGWConstants").WebsocketCloseCodes.ABNORMAL_CLOSURE:a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_ABNORMAL_CLOSURE,i=o("DGWStream").StreamError.ABNORMAL_CLOSURE;break;case o("DGWConstants").WebsocketCloseCodes.SERVER_INTERNAL_ERROR:a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_SERVER_INTERNAL_ERROR,i=o("DGWStream").StreamError.SERVER_INTERNAL_ERROR;break;case o("DGWConstants").WebsocketCloseCodes.GOING_AWAY:a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_GOING_AWAY,i=o("DGWStream").StreamError.GOING_AWAY;break;case o("DGWConstants").WebsocketCloseCodes.UNAUTHORIZED:a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_UNAUTHORIZED,i=o("DGWStream").StreamError.UNAUTHORIZED;break;case o("DGWConstants").WebsocketCloseCodes.REJECTED:a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_REJECTED,i=o("DGWStream").StreamError.REJECTED;break;case o("DGWConstants").WebsocketCloseCodes.BAD_REQUEST:a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_BAD_REQUEST,i=o("DGWStream").StreamError.BAD_REQUEST;break;case o("DGWConstants").WebsocketCloseCodes.DGW_SERVER_ERROR:a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_SERVER_INTERNAL_ERROR,i=o("DGWStream").StreamError.DGW_SERVER_ERROR,a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_DGW_SERVER_ERROR;break;default:a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_UNKNOWN_ERROR,i=o("DGWStream").StreamError.UNKNOWN_ERROR;break}t.$14.streamGroupCallbacks.onStreamGroupError(a),t.$5.forEach(function(e){e.__transportCloseHook(i)}),t.$6.forEach(function(e){e.abortStream(i)})}else t.$13.transportClosed(!0,""),t.$14.streamGroupCallbacks.onStreamGroupTransportClose(),t.$5.forEach(function(e){e.__transportCloseHook()}),t.$6.forEach(function(e){e.abortStream(o("DGWStream").StreamError.TRANSPORT_CLOSED_BEFORE_STREAM_INIT)});t.$5.clear(),t.$6.clear()}}},t.$28=function(){var e=this.$2.encodePing();if(e==null)throw r("err")("Failed to encode Ping Frame");var t=this.send(e);this.$18=this.$1.bufferedAmount,this.$13.transportPingSent("readyState:"+this.$1.readyState+", bufferedAmount:"+this.$18+", payloadSize:"+(e==null?void 0:e.byteLength)+", sent:"+String(t))},t.isClosedLocally=function(){return this.$3||this.$8||this.$4},t.streamEndCallback=function(t){this.$5.delete(t),this.$6.delete(t),this.$17.putBackStreamId(t)},t.canCreateGroupedStream=function(){return this.$17.streamIdAvailable()},t.createEstablishStreamFrame=function(n,a){var t=e.__prefixAppHeaders(a.groupedStreamHeaders);a.streamTraceId!=null&&(t[o("DGWConstants").HEADER_CONSTANTS.HEADER_STREAM_TRACE_ID]=a.streamTraceId);var i=this.$2.encodeEstablishStream(n,new Uint8Array(this.$11.encode(JSON.stringify(t))));if(i==null)throw this.$17.putBackStreamId(n),r("err")("Failed to encode EstablishStreamFrame");return i},t.getStreamId=function(){try{return this.$17.getNextStreamId()}catch(e){throw this.$13.ranOutOfStreamIds("inFlightGroupedStreamSize: "+this.$6.size+" groupedStreamSize: "+this.$5.size),e}},t.__createGroupedStream=function(t,n,r,a){var e=this;return new(o("GroupedStream")).GroupedStream(t,n,r,this,a,this.$2,function(){e.streamEndCallback(t)})},t.__getStreamIdGenerator=function(){return new(o("StreamIdGenerator")).StreamIdGeneratorImpl},t.__markerPoint=function(t){this.$24.qplMarkerPoint(o("IDGWLoggingContext").QPLEvent.STREAM_GROUP_TRANSPORT,t,this.$19)},t.__markerAnnotate=function(t){this.$24.qplMarkerAnnotate(o("IDGWLoggingContext").QPLEvent.STREAM_GROUP_TRANSPORT,t,this.$19)},t.__endMarker=function(t){this.$24.qplMarkerEnd(o("IDGWLoggingContext").QPLEvent.STREAM_GROUP_TRANSPORT,t,this.$19)},e})();l.StreamGroupWebSocketTransport=u}),98);
__d("StreamGroup",["DGWConstants","DGWLoggingContext","DGWUtils","StreamGroupWebSocketTransport"],(function(t,n,r,o,a,i,l){"use strict";var e={maxRetries:0,baseRetryInterval:1e3,backoffFactor:Math.sqrt(2)},s=(function(){function t(e,t,n,r,a,i,l,s,u,c){var d,m,p,_,f,g,h,y,C;this.$2=u,this.$1=u.getNewStreamGroupId();var b=(d=l.overrideUrl)!=null?d:a;this.$6=null,this.$3={appId:e,appVersion:t,authType:(m=l.authType)!=null?m:n,deviceId:l.deviceId,dgwVersion:r,headers:l.streamGroupAppHeaders,tier:(p=l.serviceTier)!=null?p:o("DGWConstants").DEFAULT_SERVICE_TIER,connectEndpoint:b,fbId:i,loggingId:l.loggingId,serviceId:l.serviceId,streamGroupCallbacks:s,keepAliveMs:l.keepAliveMs,regionHint:l.regionHint,enableFirstStreamOnWsHandshake:!1,authToken:l.authToken,connectTimeoutMs:l.connectTimeoutMs},this.$4=l,this.$5=c,this.streamGroupLoggingContext=this.$5(null,!1,(_=l.verboseLoggingEnabled)!=null?_:!1),this.$7=o("DGWUtils").DGWUtils.constructConnectUrl({appId:this.$3.appId,appVersion:this.$3.appVersion,authType:this.$3.authType,deviceId:(f=this.$3.deviceId)!=null?f:void 0,dgwVersion:this.$3.dgwVersion,fbId:this.$3.fbId,headers:babelHelpers.extends({},this.$3.headers),loggingId:(g=this.$3.loggingId)!=null?g:void 0,tier:this.$3.tier,serviceId:this.$3.serviceId,endpoint:this.$3.connectEndpoint,regionHint:(h=this.$3.regionHint)!=null?h:void 0,trafficTracing:(y=this.$4.trafficTracing)!=null?y:void 0,authToken:(C=this.$4.authToken)!=null?C:void 0})}var n=t.prototype;return n.initTransport=async function(){var e=this,t={maxRetries:0,baseRetryInterval:1e3,backoffFactor:Math.sqrt(2)};this.$6=this.$6||o("StreamGroupWebSocketTransport").StreamGroupWebSocketTransport.getTransport_DEPRECATED(this.$7,this.$3,this.streamGroupLoggingContext,function(){e.$2.removeStreamGroupAndTransport(e.$1)},t,this.$5);var n;try{n=await this.$6,this.$6=null}catch(e){throw this.$6=null,e}return this.$2.containsStreamGroup(this.$1)||this.$2.setStreamGroupAndTransport(this.$1,n),n},n.establishStream=async function(n,r,a,i,l){var t=this;if(this.$2.containsStreamGroup(this.$1)===!1)if(this.streamGroupLoggingContext.logEvent(o("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"createTransportWhenEstablishStream"),this.$3.enableFirstStreamOnWsHandshake){var u=await o("StreamGroupWebSocketTransport").StreamGroupWebSocketTransport.getTransportWithInitialStream(n,r,this.$3,this.streamGroupLoggingContext,function(){t.$2.removeStreamGroupAndTransport(t.$1)},e,this.$5);return this.$2.setStreamGroupAndTransport(this.$1,u.transport),u.streamPromise}else{this.$6=this.$6||o("StreamGroupWebSocketTransport").StreamGroupWebSocketTransport.getTransport_DEPRECATED(this.$7,this.$3,this.streamGroupLoggingContext,function(){t.$2.removeStreamGroupAndTransport(t.$1)},e,this.$5);var s;try{s=await this.$6,this.$6=null}catch(e){throw this.$6=null,e}this.$2.containsStreamGroup(this.$1)||this.$2.setStreamGroupAndTransport(this.$1,s)}return this.establishStreamWithTransport(n,r,a,i,l)},n.establishStreamWithTransport=async function(t,n,r,a,i){var e,l=t.loggingId;this.streamGroupLoggingContext.logEvent(o("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"Establishing Grouped Stream","initialData:"+String(r!=null),!0,l);var s=this.$5(l,t.disableFalcoLogging,(e=t.verboseLoggingEnabled)!=null?e:!1),u=await this.$2.getStreamGroupTransport(this.$1).establishGroupedStream(n,t,s,r,a,i);return u},n.canCreateGroupedStream=function(){var e=!0;if(this.$2.containsStreamGroup(this.$1)!==!1){var t=this.$2.getStreamGroupTransport(this.$1);e=t.canCreateGroupedStream()}return o("DGWLoggingContext").DGWLoggingContext.bumpODSKey(o("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,e?"can_create":"cannot_create"),e},n.close=function(){if(this.$2.containsStreamGroup(this.$1)){var e=this.$2.getStreamGroupTransport(this.$1);e.close()}},t})();l.StreamGroup=s}),98);
__d("StreamGroupRegistry",["Random","err"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(){this.$1=new Map,this.$2=new Set}var t=e.prototype;return t.setStreamGroupAndTransport=function(t,n){this.$1.set(t,n)},t.containsStreamGroup=function(t){return this.$1.has(t)},t.removeStreamGroupAndTransport=function(t){this.$1.delete(t)},t.getStreamGroupTransport=function(t){var e=this.$1.get(t);if(e==null)throw r("err")("No stream group transport");return e},t.getNewStreamGroupId=function(){for(var e=o("Random").uint32();this.$2.has(e);)e=o("Random").uint32();return this.$2.add(e),e},e})();l.StreamGroupRegistry=e}),98);
__d("RawDGWClient",["DGWAuth","DGWLoggingContext","DGWStream","StreamGroup","StreamGroupRegistry","isFastRefreshEnabledForCurrentDomain"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){var t=e.appId,n=e.appVersion,r=e.authToken,a=e.authType,i=e.dgwVersion,l=e.endpoint,s=e.fbId,u=e.isUserLoggedIn;this.$1=t,this.$2=n,this.$3=a,this.$5=i,this.$6=l,this.$7=s,this.$8=new(o("StreamGroupRegistry")).StreamGroupRegistry,this.$4=r,this.$9=u}var t=e.prototype;return t.$10=function(t){var e=this.$5,n=this.$7;return function(r,a,i){return new(o("DGWLoggingContext")).DGWLoggingContext(e,r,t,n,null,a!=null?a:!1,i!=null?i:!1)}},t.createStreamGroup=function(t,n){var e,r;this.handleUserChecks((e=n.authType)!=null?e:this.$3);var a=(r=n.authToken)!=null?r:this.$4;a!=null&&this.$3===o("DGWAuth").DGWAuth.GUEST&&(n.authToken=a);var i=this.$10(n.serviceId);return new(o("StreamGroup")).StreamGroup(this.$1,this.$2,this.$3,this.$5,this.$6,this.$7,n,t,this.$8,i)},t.handleUserChecks=function(t){if(!this.$9()&&o("DGWAuth").fromDGWAuthToString(t)!=="GUEST"&&!r("isFastRefreshEnabledForCurrentDomain")())throw o("DGWStream").StreamError.UNAUTHENTICATED},e})();l.RawDGWClient=e}),98);
__d("DGWClient",["CurrentUser","DGWAuth","DGWEnvUtil","DGWWebConfig","RawDGWClient","err"],(function(t,n,r,o,a,i,l){"use strict";var e=null;function s(){if(!r("DGWEnvUtil").isDGWEnvCompatible())throw r("err")("unsupported_environment_retry_with_mqtt");if(e==null){var t;e=new(o("RawDGWClient")).RawDGWClient({appId:r("DGWWebConfig").appId,appVersion:r("DGWWebConfig").appVersion,authType:o("DGWAuth").fromStringToDGWAuth((t=r("DGWEnvUtil")).getDGWAuthType()),dgwVersion:t.getDGWVersion(),endpoint:t.getDGWEndpoint(),fbId:r("DGWWebConfig").fbId,authToken:t.getDGWAuthToken(),isUserLoggedIn:function(){return r("CurrentUser").isLoggedInNow()}})}return e}l.default=s}),98);/*FB_PKG_DELIM*/
__d("CubicBezier",[],(function(t,n,r,o,a,i){var e=.005,l=(function(){function t(e,t){this.cx=3*e[0],this.bx=3*(t[0]-e[0])-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e[1],this.by=3*(t[1]-e[1])-this.cy,this.ay=1-this.cy-this.by}var n=t.prototype;return n.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},n.solve=function(t){return t=this.solveCurveX(t),((this.ay*t+this.by)*t+this.cy)*t},n.solveCurveX=function(n){var t,r,o,a,i,l;for(i=n,r=0;r<8;r++){if(l=this.sampleCurveX(i)-n,Math.abs(l)<e)return i;if(t=(3*this.ax*i+2*this.bx)*i+this.cx,Math.abs(t)<1e-6)break;i-=l/t}if(o=0,a=1,i=n,i<o)return o;if(i>a)return a;for(;o<a;){if(l=this.sampleCurveX(i),Math.abs(l-n)<e)return i;n>l?o=i:a=i,i=(a-o)/2+o}return i},t})();i.default=l}),66);
__d("FunnelAction",[],(function(t,n,r,o,a,i){"use strict";var e="name",l="payload",s="relative_time",u="tag",c=(function(){function t(t,n,r,o){this.$1={},this.$1[e]=t,this.$1[s]=n,r!==void 0&&(this.$1[u]=r),o!==void 0&&(this.$1[l]=JSON.stringify(o))}var n=t.prototype;return n.getData=function(){return this.$1},t})();i.default=c}),66);
__d("FunnelRegistry",[],(function(t,n,r,o,a,i){var e=Object.freeze({WWW_EXAMPLE_FUNNEL:!0,MSITE_EXAMPLE_FUNNEL:!0,WWW_FEED_SHARE_DIALOG_FUNNEL:!0,MSITE_FEED_SHARE_DIALOG_FUNNEL:!0,WWW_CHAT_QUICKCAM_FUNNEL:!0,PLATFORM_SHARE_DIALOG_FUNNEL:!0,WWW_CANVAS_EDITOR_FUNNEL:!0,MSITE_COMMENT_TYPING_FUNNEL:!0,MSITE_NOTE_READING_FUNNEL:!0,WWW_LISTS_COMPOSER_FUNNEL:!0,WWW_REACTIONS_LIKE_BUTTON_HOVER_FUNNEL:!0,WWW_REACTIONS_NUX_FUNNEL:!0,WWW_COMMENT_REACTIONS_NUX_FUNNEL:!0,MSITE_INLINE_REPLY_COMPOSER_FUNNEL:!0,WWW_LEAD_GEN_DESKTOP_AD_UNIT_FUNNEL:!0,WWW_LEAD_GEN_MSITE_AD_UNIT_FUNNEL:!0,WWW_LINK_PICKER_DIALOG_FUNNEL:!0,WWW_MEME_PICKER_DIALOG_FUNNEL:!0,WWW_SHOP_BUY_FUNNEL:!0,WWW_SNOWLIFT_ACTIONS_FUNNEL:!0,WWW_CANVAS_AD_CREATION_FUNNEL:!0,WWW_SEARCH_AWARENESS_LEARNING_NUX_FUNNEL:!0,WWW_CONSTITUENT_TITLE_UPSELL_FUNNEL:!0,WWW_PAGE_CREATION_FUNNEL:!0,WWW_RECRUITING_PRODUCTS_FUNNEL:!0,WWW_RECRUITING_SEARCH_FUNNEL:!0,WWW_RECRUITING_BULK_EMAIL_FUNNEL:!0,WWW_RECRUITING_LEAVE_HANDLER_FUNNEL:!0,WWW_PMT_FUNNEL:!0,WWW_PULSE_FUNNEL:!0,WWW_ORGTOOL_FUNNEL:!0,WWW_VIDEOS_CASTING_FUNNEL:!0,MSITE_PPD_FUNNEL:!0,WWW_CMS_SEARCH_FUNNEL:!0,SOCIAL_SEARCH_CONVERSION_WWW_FUNNEL:!0,SOCIAL_SEARCH_DASHBOARD_WWW_FUNNEL:!0,GAMES_QUICKSILVER_FUNNEL:!0,SRT_USER_FLOW_FUNNEL:!0,WWW_MEME_PIVOT_FUNNEL:!0,WWW_NOTIFICATION_FUNNEL:!0,MSITE_FEED_ALBUM_CTA_FUNNEL:!0,MTOUCH_COMMENT_STORIES_FUNNEL:!0,WWW_MESSENGER_SHARE_TO_FB_FUNNEL:!0,MISINFORMATION_RESHARE_ALERT_FUNNEL:!0,FACECAST_BROADCASTER_FUNNEL:!0,FACECAST_SCHEDULED_LIVE_FUNNEL:!0,SCHEDULED_WATCH_PARTY_VIEWER_FUNNEL:!0,COLLEGE_COMMUNITY_NUX_ONBOARDING_FUNNEL:!0,WWW_MESSENGER_SEARCH_SESSION_FUNNEL:!0,WWW_MESSENGER_CONTENT_SEARCH_FUNNEL:!0,WWW_LIVE_PRODUCER_FUNNEL:!0,WWW_AD_BREAKS_ONBOARDING_FUNNEL:!0,WWW_LAUNCHPAD_ONBOARDING_FUNNEL:!0,WWW_LEAD_GEN_FORM_EDITOR_FUNNEL:!0,WWW_AD_BREAK_HOME_ONBOARDING_FUNNEL:!0,WEB_MESSENGER_RTC_FUNNEL:!0,WEB_RTC_SCREEN_SHARING_FUNNEL:!0,MTOUCH_NUX_PROFILE_PIC_FUNNEL:!0,ADS_VIDEO_CAPTION_FUNNEL:!0,WWW_BUSINESS_ALERT_FUNNEL:!0,SOCIAL_VR_INTERACTIVE_THREE_SIXTY_FUNNEL:!0,WWW_DIVEBAR_RECENTS_FUNNEL:!0,UNIDASH_EDIT_WIDGET_FUNNEL:!0,MESSENGER_UNIVERSAL_SEARCH_FUNNEL:!0,WWW_BUSINESS_CREATION_FUNNEL:!0,WWW_BUSINESS_VERIFICATION_FUNNEL:!0,WWW_APP_REVIEW_BUSINESS_VERIFICATION_FUNNEL:!0,AEC_APPLICATION_FUNNEL:!0,WWW_MESSENGER_POLL_GROUP_CREATE_FUNNEL:!0,ADS_USER_REPORTING_FUNNEL:!0,MAP_WEB_FUNNEL:!0,INTERN_OOPS_FUNNEL:!0,FRX_FUNNEL:!0,WWW_ACCESSIBILITY_NOTIFICATIONS_JEWEL_TABBING_FUNNEL:!0,MTOUCH_FEED_MISSED_STORIES_FUNNEL:!0,WWW_STORYSET_FUNNEL:!0,POLYGLOT_MAIN_FUNNEL:!0,CREATIVE_STUDIO_CREATION_FUNNEL:!0,CREATIVE_STUDIO_HUB_FUNNEL:!0,CREATIVE_STUDIO_INVITE_JOIN_FUNNEL:!0,FX_PLATFORM_INVITE_JOIN_FUNNEL:!0,FX_PLATFORM_INVITE_SEND_FUNNEL:!0,WWW_LIVE_VIEWER_TIPJAR_FUNNEL:!0,WWW_FUNDRAISER_CREATION_FUNNEL:!0,WWW_FUNDRAISER_EDIT_FUNNEL:!0,WWW_FBL_FUNNEL:!0,WWW_CLUE_FUNNEL:!0,WWW_OFFERS_SIMPLE_COMPOSE_FUNNEL:!0,WWW_OFFERS_SIMPLE_COMPOSE_POST_LIKE_FUNNEL:!0,WWW_SEE_OFFERS_CTA_NUX_FUNNEL:!0,WWW_CHEVRON_FUNNEL:!0,MSITE_AD_BREAKS_ONBOARDING_FLOW_FUNNEL:!0,CASUAL_GROUP_PICKER_FUNNEL:!0,TOPICS_TO_FOLLOW_FUNNEL:!0,WWW_SPATIAL_REACTION_PRODUCTION_FUNNEL:!0,WWW_ADS_TARGETING_AUDIENCE_MANAGER_FUNNEL:!0,WWW_NEWSFEED_TAILLOAD_FUNNEL:!0,SEARCH_ADS_WWW_FUNNEL:!0,KEYFRAMES_FUNNEL:!0,WWW_NOTIFS_UP_NEXT_FUNNEL:!0,MSITE_PROFILE_PICTURE_EDIT_FUNNEL:!0,WWW_PROFILE_INTRO_CARD_EDIT_MEDIA_FUNNEL:!0,BUSINESS_PAYMENTS_MERCHANT_ONBOARDING_FUNNEL:!0,SELLER_EXPERIENCE_SHOP_INSIGHTS_NEW_FUNNEL:!0,SELLER_EXPERIENCE_ONBOARDING_NEW_FUNNEL:!0,SELLER_EXPERIENCE_PAYOUT_SETUP_NEW_FUNNEL:!0,SELLER_EXPERIENCE_SHOP_MANAGEMENT_FUNNEL:!0,CHANNEL_EDIT_FUNNEL:!0,PAYOUT_ONBOARDING_FUNNEL:!0,SERVICES_INSTANT_BOOKING_SETTINGS_FUNNEL:!0,SERVICES_FB_APPOINTMENTS_CTA_CREATION_FUNNEL:!0,SERVICES_FB_APPOINTMENTS_CTA_FULL_SETUP_FUNNEL:!0,MATCHED_MARKET_LIFT_INTERNAL_FUNNEL:!0,FB_NEO_ONBOARDING_FUNNEL:!0,FB_NEO_FRIENDING_FUNNEL:!0,SEARCH_FUNNEL:!0,SHADOW_SEARCH_FUNNEL:!0,SHADOW_EARLY_END_SEARCH_FUNNEL:!0,TEXT_DELIGHTS_OPT_OUT_NUX_FUNNEL:!0,TEXT_DELIGHTS_COMPOSER_FUNNEL:!0,PRIVATE_COMMENT_COMPOSER_FUNNEL:!0,CHECKOUT_EXPERIENCES_FUNNEL:!0,CHECKOUT_EXPERIENCES_SELLER_FUNNEL:!0,MESSENGER_SECONDARY_SEARCH_FUNNEL:!0,WWW_SERVICES_INSTANT_BOOKING_CONSUMER_FUNNEL:!0,WWW_PRESENCE_FUNNEL:!0,WWW_SERVICES_BOOK_APPOINTMENT_CONSUMER_FUNNEL:!0,WWW_SPHERICAL_DIRECTOR_FUNNEL:!0,SELLER_EXPERIENCE_MIGRATION_FUNNEL:!0,SELLER_EXPERIENCE_PAYOUT_SETUP_FUNNEL:!0,NATIVE_SUPPORT_FUNNEL:!0,PRIVACY_SHORTCUTS_FUNNEL:!0,PRIVACY_ACCESS_HUB_FUNNEL:!0,WWW_POLITICIAN_OFFICE_SETTING_FUNNEL:!0,WWW_CIVIC_ACTION_POST_INVITE_FUNNEL:!0,WWW_CIVIC_ACTION_POST_CREATION_FUNNEL:!0,NT_NFAS_EXAMPLE_FUNNEL:!0,WWW_ONCALL_VIEW_FUNNEL:!0,WWW_ESCALATION_TOOLS_NOTIFICATIONS_PAGE_FUNNEL:!0,ALL_VOICES_FUNNEL:!0,WWW_MESSENGER_SHARE_FILE_PREVIEW_FUNNEL:!0,POST_TRANSACTION_FUNNEL:!0,INSTANT_EXPERIENCES_MINDBODY_FUNNEL:!0,WWW_CTW_WHATSAPP_VERIFICATION_FLOW_FUNNEL:!0,PIE_MANAGER_HIRING_HUB_FUNNEL:!0,PIE_RECRUITING_MANAGER_HIRING_OUTREACH_FUNNEL:!0,PIE_RECRUITING_MANAGER_HIRING_REVIEW_FUNNEL:!0,IG_WEB_STORY_CREATION_FUNNEL:!0,IG_WEB_IGTV_CREATION_FUNNEL:!0,IG_WEB_ONE_TAP_REGISTRATION_FUNNEL:!0,IG_WEB_SHARE_FUNNEL:!0,IG_WEB_NUX_FUNNEL:!0,IG_WEB_OBA_FUNNEL:!0,WWW_FB_CHAT_NEW_SETTINGS_MENU_FUNNEL:!0,FLEXIBLE_STARS_WWW_FUNNEL:!0,PAYMENT_APP_FUNNEL:!0,WWW_MESSENGER_VIDEO_CHAT_LINKS_FUNNEL:!0,KAIOS_REG_CONTACT_IMPORTER_FUNNEL:!0,ONEVC_CALL_ROUTING_FUNNEL:!0,AR_HUB_UPLOAD_FUNNEL:!0,FHT_FUNNEL:!0,WWW_PCR_FUNNEL:!0,MARKETPLACE_GIFT_CARD_FUNNEL:!0,WORK_CHAT_SEARCH_FUNNEL:!0,DISCOVER_MIGRATION_FUNNEL:!0,ZERO_PLACEHOLDER_FUNNEL:!0,FOS_MON_PURCHASE_FLOW_FUNNEL:!0});i.default=e}),66);
__d("Funnel",["BinarySearch","FBLogger","FunnelAction","FunnelRegistry","sprintf"],(function(t,n,r,o,a,i,l){"use strict";var e="name",s="instance_id",u="start_time",c="tags",d="actions",m="sampling_rate",p="timeout_sec",_="beacon_id",f="beacon_session_id",g="funnel_level_beacon_id",h="funnel_level_beacon_session_id",y="is_web",C={EXPLICIT:"explicit",TIMEOUT:"timeout",SESSION_END:"session_end",RESTART:"restart",ACTIONS_FULL:"actions_full"},b={ACTION_END:"funnel_end",ACTION_WINDOW_BLUR:"window_blur",ACTION_WINDOW_FOCUS:"window_focus"},v=600,S=(function(){function t(e,t,n,o,a){if(r("FunnelRegistry")[e]!==!0)throw r("FBLogger")("comet_infra").mustfixThrow("Funnel name not registered.");this.$1=e,this.$2=t,this.$3=[],this.$4={},this.$5=n,this.$6=a,this.timeout_sec=v,this.shouldTrackFocus=!1,this.$7=o,this.$9=-1,this.$10=-1,this.$11=-1,this.$12=-1,this.$8=null,this.devModeLogger("Started funnel")}var n=t.prototype;return n.addTag=function(t){if(typeof t!="string")throw r("FBLogger")("comet_infra").mustfixThrow("Funnel tag should be a String.");return this.$4[t]=!0,this.devModeLogger("Added funnel tag %s",t),this},n.appendAction=function(t,n,a,i){var e=this;i===void 0&&(i=Date.now());var l=new(r("FunnelAction"))(t,i-this.$6,n,a),s=o("BinarySearch").leastStrictUpperBound(function(t){return e.$3[t].getData()},l.getData(),0,this.$3.length,function(e,t){return e.name==="funnel_end"?1:t.name==="funnel_end"?-1:e.relative_time-t.relative_time});return this.$3.splice(s,0,l),n?this.devModeLogger("Appended action %s with tag %s",t,n):this.devModeLogger("Appended action %s",t),this.$8=t,this},n.appendActionIfNew=function(t,n,r){return t!==this.$8&&this.appendAction(t,n,r),this},n.getLogData=function(){var t={};t[e]=this.$1,this.$2!==void 0?t[s]=this.$2:t[s]=Math.floor(Math.random()*65536),t[u]=this.$6,t[m]=this.$5,t[p]=this.timeout_sec,t[c]=[];for(var n in this.$4)this.$4[n]===!0&&t[c].push(n);if(this.$3.length>0){t[d]=[];for(var r=0;r<this.$3.length;r++)t[d].push(this.$3[r].getData())}return this.$10!==-1&&this.$9!==-1&&(t[f]=this.$10,t[_]=this.$9),this.$12!==-1&&this.$11!==-1&&(t[h]=this.$12,t[g]=this.$11),t[y]=1,t},n.devModeLogger=function(){},n.getTags=function(){return this.$4},n.getFunnelName=function(){return this.$1},n.addReliabilityStats=function(t,n){if(typeof t!="number")throw r("FBLogger")("comet_infra").mustfixThrow("SessionID of current funnel lib reliability stats should be a number.");if(typeof n!="number")throw r("FBLogger")("comet_infra").mustfixThrow("Counter of current funnel lib reliability stats should be a number.");return this.$10=t,this.$9=n,this.devModeLogger("Added funnel sessionID %d and counter %d.",t,n),this},n.addReliabilityStatsForCurFunnel=function(t,n){if(typeof t!="number")throw r("FBLogger")("comet_infra").mustfixThrow("SessionID of current funnel lib reliability stats should be a number.");if(typeof n!="number")throw r("FBLogger")("comet_infra").mustfixThrow("Counter of current funnel lib reliability stats should be a number.");return this.$12=t,this.$11=n,this.devModeLogger("Added funnel sessionID %d and counter %d.",t,n),this},t})();l.EndType=C,l.ActionType=b,l.Funnel=S}),98);
__d("FunnelLoggerConfig.experimental",["cr:27520"],(function(t,n,r,o,a,i,l){"use strict";l.default=n("cr:27520")}),98);
__d("FunnelLoggerSampler",["FunnelLoggerConfig.experimental"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=s(e);return t===0?!1:Math.random()*t<1}function s(e){var t=r("FunnelLoggerConfig.experimental").freq[e];return t===void 0&&(t=r("FunnelLoggerConfig.experimental").freq.default),t}i.exports={shouldLog:e,getSamplingRate:s}}),34);
__d("FunnelReliabilityWhitelist",[],(function(t,n,r,o,a,i){var e=["SEARCH_FUNNEL"];i.default=e}),66);
__d("FunnelReliabilityStatsCollector",["FunnelReliabilityWhitelist","MarauderLogger","WebStorage","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e,s=!1,u,c="fas_reliability_lib_stats_overall",d="fas_reliability_funnel_stats_overall",m=1800,p="funnel_analytics_data_loss",_="fas_reliability_lib_stats_wl",f="fas_reliability_funnel_stats_wl",g=0,h={};function y(){return!!r("gkx")("20977")}function C(){return s||(s=!0,u=(e||(e=r("WebStorage"))).getLocalStorage()),u}function b(){var e=C();if(!e)return null;var t=e.getItem(d);if(t)return JSON.parse(t);var n=Math.floor(Date.now()/1e3);return{startCount:0,endCount:0,cancelCount:0,prevCount:0,lastFlushTimestamp:n}}function v(e){var t=C();if(!t)return null;var n=t.getItem(f);if(n)return JSON.parse(n);var r={};return r[e]={startCount:0,endCount:0,cancelCount:0,prevCount:0},r}function S(){var e=C();if(!e)return null;var t=e.getItem(f);return t?JSON.parse(t):null}function R(t){var n=b();n&&(g+=1,n.startCount?n.startCount=parseInt(n.startCount,10)+1:n.startCount=1,(e||(e=r("WebStorage"))).setItemGuarded(localStorage,d,JSON.stringify(n)),L(t))}function L(t){var n=v(t);if(!(!n||!r("FunnelReliabilityWhitelist").includes(t))){var o=h[t]?h[t]+1:1;h[t]=o;var a=n[t];a?a.startCount?a.startCount=parseInt(a.startCount,10)+1:a.startCount=1:(a={},a.startCount=1,a.prevCount=0,a.cancelCount=0,a.endCount=0),n[t]=a,(e||(e=r("WebStorage"))).setItemGuarded(localStorage,f,JSON.stringify(n))}}function E(t){var n=b();n&&(g-=1,n.cancelCount?n.cancelCount=parseInt(n.cancelCount,10)+1:n.cancelCount=1,(e||(e=r("WebStorage"))).setItemGuarded(localStorage,d,JSON.stringify(n)),k(t))}function k(t){var n=v(t);if(!(!n||!r("FunnelReliabilityWhitelist").includes(t))){var o=h[t]?h[t]-1:0;h[t]=o;var a=n[t];a?a.cancelCount?a.cancelCount=parseInt(a.cancelCount,10)+1:a.cancelCount=1:(a={},a.startCount=0,a.prevCount=0,a.cancelCount=1,a.endCount=0),n[t]=a,(e||(e=r("WebStorage"))).setItemGuarded(localStorage,f,JSON.stringify(n))}}function I(t){var n=b();n&&(g-=1,n.endCount?n.endCount=parseInt(n.endCount,10)+1:n.endCount=1,(e||(e=r("WebStorage"))).setItemGuarded(localStorage,d,JSON.stringify(n)),T(t))}function T(t){var n=v(t);if(!(!n||!r("FunnelReliabilityWhitelist").includes(t))){var o=h[t]?h[t]-1:0;h[t]=o;var a=n[t];a?a.endCount?a.endCount=parseInt(a.endCount,10)+1:a.endCount=1:(a={},a.startCount=0,a.prevCount=0,a.cancelCount=0,a.endCount=1),n[t]=a,(e||(e=r("WebStorage"))).setItemGuarded(localStorage,f,JSON.stringify(n))}}function D(){var e=b();if(!e)return!1;if(e.lastFlushTimestamp){var t=Math.floor(Date.now()/1e3);return t-parseInt(e.lastFlushTimestamp,10)>=m}return!1}function x(t,n){var o=C();if(o){var a=Math.floor(Date.now()/1e3),i={startCount:0,endCount:0,cancelCount:0,prevCount:n,lastFlushTimestamp:a};(e||(e=r("WebStorage"))).setItemGuarded(o,d,JSON.stringify(i))}}function $(t,n){var o=C();if(!(!o||!t||Object.keys(t).length===0)){var a={};for(var i in t){var l=n[i],s={startCount:0,endCount:0,cancelCount:0,prevCount:l||0};a[i]=s}(e||(e=r("WebStorage"))).setItemGuarded(o,f,JSON.stringify(a))}}function P(e,t,n,r){var a=e.prevCount,i=e.startCount,l=e.endCount,s=e.cancelCount,u=a+i-l-s-t,c={start:i,end:l,cancel:s,prev:a,ongoing:t,loss:u},d={overall:c};if(n){var m={};for(var _ in n){var f=n[_],g=f.prevCount,h=f.startCount,y=f.endCount,C=f.cancelCount,b=r[_]?r[_]:0,v=g+h-y-C-b,S={start:h,end:y,cancel:C,prev:g,ongoing:b,loss:v};m[_]=S}d.funnel_level_data_loss=m}o("MarauderLogger").log(p,null,d)}function N(){if(D()){var e=b();if(e){x(e,g);var t=S();t&&$(t,h),P(e,g,t,h)}}}function M(){var t=C();if(!t)return null;var n=t.getItem(c),o=n?JSON.parse(n):{},a=o.counter,i=o.session;return a?(a=parseInt(a,10)+1,i=parseInt(o.session,10)):(a=1,i=Math.floor(Math.random()*65536)),(e||(e=r("WebStorage"))).setItemGuarded(t,c,JSON.stringify({counter:a,session:i})),[i,a]}function w(t){if(!r("FunnelReliabilityWhitelist").includes(t))return null;var n=C();if(!n)return null;var o=n.getItem(_),a=void 0,i={};o!=null&&o!==""&&(i=JSON.parse(o),a=i[t]);var l=a?a.counter:void 0,s=a?a.session:void 0;l!=null?(l=parseInt(l,10)+1,s=parseInt(s,10)):(l=1,s=Math.floor(Math.random()*65536));var u={};return o?(i[t]={counter:l,session:s},u=i):u[t]={counter:l,session:s},(e||(e=r("WebStorage"))).setItemGuarded(n,_,JSON.stringify(u)),[s,l]}l.passFunnelLevelStatsRolloutGK=y,l.onFunnelStart=R,l.onFunnelCancel=E,l.onFunnelEnd=I,l.maybeFlushFunnelLevelStats=N,l.increaseAndGetLibLevelStats=M,l.maybeIncreaseAndGetLibLevelStatsForCurFunnel=w}),98);
__d("FunnelLogger",["Banzai","FBLogger","Funnel","FunnelLoggerSampler","FunnelRegistry","FunnelReliabilityStatsCollector","MarauderLogger","clearTimeout","gkx","setTimeout"],(function(t,n,r,o,a,i){"use strict";var e={},l=!1,s=!0;function u(e,t){$(e,t)}function c(e,t,n){$(e,n,t)}function d(t,n){var r=N(t,n);return M(r)?e[r]:null}function m(e,t){}function p(e,t,n){n===void 0?w(e,void 0,t):n&&w(e,t,n)}function _(t,r){var o=N(t,r);M(o)&&(e[o].devModeLogger("Cancelled funnel"),F(o),e[o]=void 0,n("FunnelReliabilityStatsCollector").passFunnelLevelStatsRolloutGK()&&(n("FunnelReliabilityStatsCollector").onFunnelCancel(t),n("FunnelReliabilityStatsCollector").maybeFlushFunnelLevelStats()))}function f(e,t){P(e,t)}function g(e,t,n){P(e,n,t)}function h(e,t,n){n===void 0?O(e,void 0,String(t)):O(e,Number(t),n)}function y(e,t,n){n===void 0?B(e,void 0,!!t):B(e,Number(t),n)}function C(e,t,n){n===void 0?W(e,void 0,String(t),void 0):W(e,Number(t),n,void 0)}function b(e,t,n){n===void 0?q(e,void 0,String(t),void 0):q(e,Number(t),n,void 0)}function v(e,t,n,r){r===void 0?W(e,void 0,String(n),void 0,void 0,t):W(e,Number(n),r,void 0,void 0,t)}function S(e,t,n,r){r===void 0?W(e,void 0,String(t),n):W(e,Number(t),n,r)}function R(e,t,n,r,o){o===void 0?W(e,void 0,String(n),r,void 0,t):W(e,Number(n),r,o,void 0,t)}function L(e,t,n,r){r===void 0?q(e,void 0,String(t),n):q(e,Number(t),n,r)}function E(e,t,n,r){r===void 0?W(e,void 0,String(t),void 0,n):W(e,Number(t),String(n),void 0,r)}function k(e,t,n,r,o){o===void 0?W(e,void 0,String(n),void 0,r,t):W(e,Number(n),String(r),void 0,o,t)}function I(e,t,n,r){r===void 0?q(e,void 0,String(t),void 0,n):q(e,Number(t),String(n),void 0,r)}function T(e,t,n,r,o){o===void 0?W(e,void 0,String(t),n,r):W(e,Number(t),String(n),String(r),o)}function D(e,t,n,r,o,a){a===void 0?W(e,void 0,String(n),r,o,t):W(e,Number(n),String(r),String(o),a,t)}function x(e,t,n,r,o){o===void 0?q(e,void 0,String(t),n,r):q(e,Number(t),String(n),String(r),o)}function $(t,r,o){var a=N(t,r);j(),U(a),n("FunnelLoggerSampler").shouldLog(t)&&(e[a]=new(n("Funnel")).Funnel(t,r,n("FunnelLoggerSampler").getSamplingRate(t),!1,o!=null?o:Date.now()),A(a),n("FunnelReliabilityStatsCollector").passFunnelLevelStatsRolloutGK()&&(n("FunnelReliabilityStatsCollector").onFunnelStart(t),n("FunnelReliabilityStatsCollector").maybeFlushFunnelLevelStats()))}function P(t,r,o){var a=N(t,r);M(a)&&(e[a].appendAction(n("Funnel").ActionType.ACTION_END,n("Funnel").EndType.EXPLICIT,void 0,o),V(a))}function N(e,t){if(n("FunnelRegistry")[e]!==!0)throw n("FBLogger")("funnel_validation").blameToPreviousFile().mustfix("Funnel name `%s` not registered",e),n("FBLogger")("comet_infra").mustfixThrow("Funnel name `%s` not registered.",e);return t==null?e:e+t.toString()}function M(t){return e[t]!==void 0}function w(t,n,r){var o=N(t,n);M(o)&&(e[o].timeout_sec=r,e[o].devModeLogger("Timeout set to %s sec",r),A(o))}function A(t){F(t),e[t].timeout_handle=n("setTimeout")(function(){e[t].appendAction(n("Funnel").ActionType.ACTION_END,n("Funnel").EndType.TIMEOUT),V(t)},1e3*e[t].timeout_sec)}function F(t){e[t].timeout_handle&&n("clearTimeout")(e[t].timeout_handle)}function O(t,n,r){var o=N(t,n);M(o)&&(e[o].addTag(r),A(o))}function B(t,n,r){var o=N(t,n);M(o)&&(e[o].shouldTrackFocus=r,e[o].devModeLogger("Focus tracking %s",r?"on":"off"))}function W(t,n,r,o,a,i){var l=N(t,n);M(l)&&(e[l].appendAction(r,o,a,i),A(l))}function q(t,n,r,o,a){var i=N(t,n);M(i)&&e[i].appendActionIfNew(r,o,a)}function U(t){M(t)&&(e[t].appendAction(n("Funnel").ActionType.ACTION_END,n("Funnel").EndType.RESTART),V(t))}function V(t){if(M(t)){if(n("gkx")("20976")){var r=n("FunnelReliabilityStatsCollector").increaseAndGetLibLevelStats();if(r){var o=r[0],a=r[1];e[t].addReliabilityStats(o,a)}}var i=e[t].getFunnelName(),l=e[t].getLogData();n("MarauderLogger").log("funnel_analytics",null,l),e[t].devModeLogger("Logged: %s",JSON.stringify(l)),F(t),e[t]=void 0,n("FunnelReliabilityStatsCollector").passFunnelLevelStatsRolloutGK()&&(n("FunnelReliabilityStatsCollector").onFunnelEnd(i),n("FunnelReliabilityStatsCollector").maybeFlushFunnelLevelStats())}}function H(){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&M(t)&&(e[t].appendAction(n("Funnel").ActionType.ACTION_END,n("Funnel").EndType.SESSION_END),V(t))}function G(){if(s){s=!1;for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&M(t)&&e[t].shouldTrackFocus&&(e[t].appendAction(n("Funnel").ActionType.ACTION_WINDOW_BLUR),F(t))}}function z(){if(!s){s=!0;for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&M(t)&&e[t].shouldTrackFocus&&(e[t].appendAction(n("Funnel").ActionType.ACTION_WINDOW_FOCUS),F(t))}}function j(){l||(l=!0,window.addEventListener&&(n("Banzai").subscribe(n("Banzai").SHUTDOWN,H),window.addEventListener("blur",G),window.addEventListener("focus",z)))}a.exports={addFunnelTag:h,appendAction:C,appendActionAtTime:v,appendActionAtTimeWithPayload:k,appendActionAtTimeWithTag:R,appendActionAtTimeWithTagAndPayload:D,appendActionIfNew:b,appendActionWithPayload:E,appendActionWithPayloadIfNew:I,appendActionWithTag:S,appendActionWithTagAndPayload:T,appendActionWithTagAndPayloadIfNew:x,appendActionWithTagIfNew:L,cancelFunnel:_,endFunnel:f,endFunnelAtTime:g,getFunnelInstance:d,setFunnelTimeout:p,setFunnelTrackFocus:y,startFunnel:u,startFunnel_DEV_MODE:m,startFunnelAtTime:c}}),null);
__d("KeyframesPerformanceLog",["performanceNow"],(function(t,n,r,o,a,i,l){"use strict";var e,s=60,u=(function(){function t(e,t){this.$1=0,this.$2=-1,this.$3=-1,this.$6=e,this.$5=t,this.$6=e,this.reset()}var n=t.prototype;return n.onNextFrame=function(t){this.$7=t},n.start=function(){if(this.$2<0||this.$3>=0){var t=(e||(e=r("performanceNow")))();this.$2<0?this.$2=t:this.$3>=0&&(this.$2+=t-this.$3,this.$3=-1),this.$5&&this.$5("start")}},n.pause=function(){this.$3<0&&this.$2>=0&&(this.$3=(e||(e=r("performanceNow")))(),this.$5&&this.$5("pause"))},n.reset=function(){this.$1=0,this.$4={one:0,two:0,four:0,eight:0},this.$3=-1,this.$2=-1},n.addFrame=function(){this.$1+=1,this.$7&&(this.$7(),this.$7=null)},n.addFrameDrop=function(t){t>=8?this.$4.eight+=1:t>=4?this.$4.four+=1:t>=2?this.$4.two+=1:t>=1&&(this.$4.one+=1)},n.finish=function(){if(this.$2>=0){var t=(e||(e=r("performanceNow")))(),n=this.$3>=0?t-this.$3:0,o=Math.max(Math.floor(t-this.$2-n),1),a=this.$1?this.$1/o*1e3:s;this.$6({animation_duration:o,display_refresh_rate:s,eight_frame_drop_count:this.$4.eight,four_frame_drop_count:this.$4.four,frame_rate:a,one_frame_drop_count:this.$4.one,two_frame_drop_count:this.$4.two}),this.reset()}},t})();l.default=u}),98);
__d("KeyframesPluginLogger",["BanzaiLogger","CurrentUser"],(function(t,n,r,o,a,i,l){"use strict";var e="KeyframesFramePerfLoggerConfig",s={appid:256281040558,isemployee:r("CurrentUser").isEmployee()?1:0},u={LOAD_ATTEMPT:"plugin_load_attempt",LOAD_ATTEMPT_KF3:"plugin_load_attempt_compat"};function c(t,n){t!=null&&t.forEach(function(t){r("BanzaiLogger").log(e,babelHelpers.extends({},s,{name:n,extras:t}))})}var d={log:function(t){c(t,u.LOAD_ATTEMPT)},logCompat:function(t){c(t,u.LOAD_ATTEMPT_KF3)}};l.KeyframesPluginLogger=d}),98);
__d("KeyframesPluginsLoader",["Bootloader","KeyframesPluginLogger","Promise","flatbuffers"],(function(t,n,r,o,a,i,l){"use strict";var e,s={DynamicProperties:function(t){return r("Bootloader").loadModules(["KeyframesPluginDynamicProperties","KeyframesPluginDynamicPropertiesSchema"],t,"KeyframesPluginsLoader")},LayerName:function(t){return r("Bootloader").loadModules(["KeyframesPluginLayerName","KeyframesPluginLayerNameSchema"],t,"KeyframesPluginsLoader")},LayerTags:function(t){return r("Bootloader").loadModules(["KeyframesPluginLayerTags","KeyframesPluginLayerTagsSchema"],t,"KeyframesPluginsLoader")},RandomSubdocument:function(t){return r("Bootloader").loadModules(["KeyframesPluginRandomSubdocument","KeyframesPluginRandomSubdocumentSchema"],t,"KeyframesPluginsLoader")},Sound:function(t){return r("Bootloader").loadModules(["KeyframesPluginSound","KeyframesPluginSoundSchema"],t,"KeyframesPluginsLoader")},SubdocumentSwap:function(t){return r("Bootloader").loadModules(["KeyframesPluginSubdocumentSwap","KeyframesPluginSubdocumentSwapSchema"],t,"KeyframesPluginsLoader")},TrimPath:function(t){return r("Bootloader").loadModules(["KeyframesPluginTrimPath","KeyframesPluginTrimPathSchema"],t,"KeyframesPluginsLoader")}};function u(e,t){return s[e]?s[e](t):null}function c(t){var r=t.map(function(t){return new(e||(e=n("Promise")))(function(e,n){var r=u(t,function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e(n)});r||n("Unknown plugin "+t)})});return(e||(e=n("Promise"))).all(r)}var d=(function(){function e(e,t){this.instances=[],this.$1={},this.$2={},this.$4=e,this.$3=t}e.fromPluginTable=function(n){return o("KeyframesPluginLogger").KeyframesPluginLogger.log(n),c(n).then(function(t){return new e(n,t)})},e.getSupportedPlugins=function(){return s};var t=e.prototype;return t.getPluginTable=function(){return this.$4},t.getPluginsForLayer=function(t){return this.$1[t]},t.maybeInstantiatePluginsForLayer=function(t){var e=t.id();if(!this.$2[e]){var n=t.pluginsLength();if(n)for(var r=0;r<n;r++){var a=t.plugins(r),i=new(o("flatbuffers")).ByteBuffer(a.contentArray()),l=a.index();if(this.$3[l]){var s=this.$3[l],u=s[0],c=s[1],d="getRootAsPlugin"+this.$4[l],m=c[d](i),p=new u(m,t);this.$1[e]||(this.$1[e]=[]),this.$1[e].push(p),this.instances.push(p),p.animationDidLoad()}}this.$2[e]=!0}},e})();l.default=d}),98);
__d("KeyframesVersion",[],(function(t,n,r,o,a,i){"use strict";var e="2.0.0";function l(){return e}i.getCurrentVersion=l}),66);
__d("FBKeyframesLoggedSession",["BanzaiLogger","CurrentUser","FunnelLogger","KeyframesPerformanceLog","KeyframesPluginsLoader","KeyframesVersion","once","performanceNow","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e,s=!1,u="KEYFRAMES_FUNNEL",c="KeyframesFramePerfLoggerConfig",d=2,m=9e18,p={appid:256281040558,appversion:null,connection_class:null,country:null,deviceid:null,extras:null,isemployee:r("CurrentUser").isEmployee()?1:0,name:"keyframes_frame_perf_report",vc:null,year_class:null};function _(e){return parseInt(e.match(/[a-f0-9]+$/gi),16)}function f(){var t=(e||(e=r("performanceNow")))();return function(){return Math.floor((e||(e=r("performanceNow")))()-t)}}function g(){return{value:Date.now()}}var h=(function(){function e(t,n){var a=this;this.$2=!1,this.$3=0,this.$5=1,this.$11=o("KeyframesVersion").getCurrentVersion(),this.$15=function(t){if(a.$13("play_ended"),a.$3++,a.$3===a.$5){var n=babelHelpers.extends({},t,p,{animation_duration:String(t.animation_duration),asset_id:a.$6.assetID||null,asset_name:a.$6.assetID?null:a.$6.assetName,display_refresh_rate:String(t.display_refresh_rate),keyframes_version:a.$11,project_name:a.$6.projectName,session_id:a.$9});e.performanceLoggingMethod(n),a.$5<m&&(a.$5*=d)}},this.$16=function(e){switch(e){case"start":a.$13("play_started");return;case"pause":a.$13("play_ended");return}},this.$10=n||g(),this.$6=t,this.$9=r("uuidv4")(),this.$4=_(this.$9)}e.performanceLoggingMethod=function(t){r("BanzaiLogger").log(c,t)};var t=e.prototype;return t.startDecode=function(t){var e=this;if(!this.$1){this.$12(),this.$13("asset_decode_started",t);var n=f();this.$1=r("once")(function(t,r){e.$13("asset_decode_ended",t,{"time_since:asset_decode_started":n(),plugins_decoded:r||[]})})}return this.$1},t.error=function(t){this.$12(),this.$1?this.$14("asset_decode_failed",t):this.$14("asset_request_failed",t)},t.getUUID=function(){return this.$9},t.getInstanceID=function(){return this.$4},t.getPerformanceLogIfEnabled=function(){var e=this;if(!this.$7){var t=this.$12(),n=new(r("KeyframesPerformanceLog"))(this.$15,this.$16);n.onNextFrame(function(){return e.$13("first_frame_rendered",g(),{"time_since:session_started":t()})}),this.$7=n}return this.$7},t.$12=function(){return this.$8||(o("FunnelLogger").startFunnelAtTime(u,this.$10.value,this.$4),this.$13("session_started",this.$10,{supported_plugins:Object.keys(r("KeyframesPluginsLoader").getSupportedPlugins())}),this.$8=f()),this.$8},t.$13=function(t,n,r){n=n||g(),this.$2||o("FunnelLogger").appendActionAtTimeWithPayload(u,n.value,this.$4,t,babelHelpers.extends({},this.$17(),r))},t.$14=function(t,n){n=n||g(),this.$2||(this.$13("session_failed",n,{fail_reason:t}),o("FunnelLogger").endFunnelAtTime(u,n.value,this.$4),this.$2=!0)},t.$17=function(){return{asset_id:this.$6.assetID||null,asset_name:this.$6.assetID?null:this.$6.assetName,asset_source:"network",keyframes_version:this.$11,project_name:this.$6.projectName,session_id:this.$9}},e})();l.default=h}),98);
__d("FunnelLoggerConfigJSModuleWrapper",["FunnelLoggerConfig"],(function(t,n,r,o,a,i,l){"use strict";l.default=r("FunnelLoggerConfig")}),98);
__d("KFComponentNames",[],(function(t,n,r,o,a,i){"use strict";var e="AUDIO",l="BITMAP",s="IMAGE",u="CHILDREN",c="COMPOSITING",d="IDENTIFICATION",m="OPACITY",p="PARENT",_="RANDOM_SUBDOCUMENT",f="RANDOM_SUBDOCUMENT_CHILDREN",g="ROOT",h="SCENE",y="SHAPE",C="TIME",b="TRIM_PATH",v="TRANSFORM",S="VIDEO";i.AUDIO=e,i.BITMAP=l,i.CHILDREN=u,i.COMPOSITING=c,i.IMAGE=s,i.IDENTIFICATION=d,i.OPACITY=m,i.PARENT=p,i.RANDOM_SUBDOCUMENT=_,i.RANDOM_SUBDOCUMENT_CHILDREN=f,i.ROOT=g,i.SCENE=h,i.SHAPE=y,i.TIME=C,i.TRIM_PATH=b,i.TRANSFORM=v,i.VIDEO=S}),66);
__d("KFLoaderUtils",["KFComponentNames"],(function(t,n,r,o,a,i,l){"use strict";function e(t,n,r){for(var a=0;a<t.length;a++){var i=t[a],l=n.getComponent(i,o("KFComponentNames").CHILDREN),s=l==null?void 0:l.getChildren();s!=null&&e(s,n,r),r(i,a,t)}}function s(t,n){var r=t.getEntitiesWithComponent(o("KFComponentNames").ROOT)[0],a=t.getComponent(r,o("KFComponentNames").SCENE);if(a!=null){var i=a.getEntities();e(i,t,n)}}function u(e){var t=e==null?void 0:e.duration();return t==null||t===0?1:t*1e3}function c(e){d.traverseEntitiesAndApply(e,function(t,n,r){if(n+1!==r.length){var a=r[n+1],i=e.getComponent(a,o("KFComponentNames").COMPOSITING);if((i==null?void 0:i.isTrackMatte)===!0){var l=e.getComponent(t,o("KFComponentNames").COMPOSITING);l==null&&(l=e.addComponent(t,o("KFComponentNames").COMPOSITING)),l.trackMatteId=a.getID()}}})}var d={getDocumentDuration:u,maybeGenerateTrackMatteIDs:c,traverseEntitiesAndApply:s},m=d;l.default=m}),98);
__d("KeyframesSchema",[],(function(t,n,r,o,a,i){var e=e||{};e.keyframes=e.keyframes||{},e.keyframes.CommandType={MoveTo:0,LineTo:1,QuadTo:2,CubicTo:3},e.keyframes.CommandTypeName={0:"MoveTo",1:"LineTo",2:"QuadTo",3:"CubicTo"},e.keyframes.TweenType={Bezier:0,Linear:1,Hold:2},e.keyframes.TweenTypeName={0:"Bezier",1:"Linear",2:"Hold"},e.keyframes.VectorCompositeOrder={FillStroke:0,StrokeFill:1},e.keyframes.VectorCompositeOrderName={0:"FillStroke",1:"StrokeFill"},e.keyframes.StrokeLineCap={Butt:0,Round:1,Square:2},e.keyframes.StrokeLineCapName={0:"Butt",1:"Round",2:"Square"},e.keyframes.StrokeLineJoin={Miter:0,Round:1,Bevel:2},e.keyframes.StrokeLineJoinName={0:"Miter",1:"Round",2:"Bevel"},e.keyframes.TrackMatteType={None:0,Alpha:1,Alpha_Inverted:2},e.keyframes.TrackMatteTypeName={0:"None",1:"Alpha",2:"Alpha_Inverted"},e.keyframes.GradientType={Linear:0,Radial:1},e.keyframes.GradientTypeName={0:"Linear",1:"Radial"},e.keyframes.TextWeight={Thin:0,UltraLight:1,Light:2,Book:3,Medium:4,SemiBold:5,Bold:6,UltraBold:7,Heavy:8,UltraHeavy:9},e.keyframes.TextWeightName={0:"Thin",1:"UltraLight",2:"Light",3:"Book",4:"Medium",5:"SemiBold",6:"Bold",7:"UltraBold",8:"Heavy",9:"UltraHeavy"},e.keyframes.Size=function(){this.bb=null,this.bb_pos=0},e.keyframes.Size.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.Size.prototype.width=function(){return this.bb.readFloat32(this.bb_pos)},e.keyframes.Size.prototype.mutate_width=function(e){var t=this.bb.__offset(this.bb_pos,0);return t===0?!1:(this.bb.writeFloat32(this.bb_pos+t,e),!0)},e.keyframes.Size.prototype.height=function(){return this.bb.readFloat32(this.bb_pos+4)},e.keyframes.Size.prototype.mutate_height=function(e){var t=this.bb.__offset(this.bb_pos,4);return t===0?!1:(this.bb.writeFloat32(this.bb_pos+t,e),!0)},e.keyframes.Size.createSize=function(e,t,n){return e.prep(4,8),e.writeFloat32(n),e.writeFloat32(t),e.offset()},e.keyframes.Point=function(){this.bb=null,this.bb_pos=0},e.keyframes.Point.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.Point.getRootAsPoint=function(t,n){return(n||new e.keyframes.Point).__init(t.readInt32(t.position())+t.position(),t)},e.keyframes.Point.prototype.x=function(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readFloat32(this.bb_pos+e):0},e.keyframes.Point.prototype.mutate_x=function(e){var t=this.bb.__offset(this.bb_pos,4);return t===0?!1:(this.bb.writeFloat32(this.bb_pos+t,e),!0)},e.keyframes.Point.prototype.y=function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat32(this.bb_pos+e):0},e.keyframes.Point.prototype.mutate_y=function(e){var t=this.bb.__offset(this.bb_pos,6);return t===0?!1:(this.bb.writeFloat32(this.bb_pos+t,e),!0)},e.keyframes.Point.startPoint=function(e){e.startObject(2)},e.keyframes.Point.addX=function(e,t){e.addFieldFloat32(0,t,0)},e.keyframes.Point.addY=function(e,t){e.addFieldFloat32(1,t,0)},e.keyframes.Point.endPoint=function(e){var t=e.endObject();return t},e.keyframes.Point.createPoint=function(t,n,r){return e.keyframes.Point.startPoint(t),e.keyframes.Point.addX(t,n),e.keyframes.Point.addY(t,r),e.keyframes.Point.endPoint(t)},e.keyframes.Color=function(){this.bb=null,this.bb_pos=0},e.keyframes.Color.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.Color.getRootAsColor=function(t,n){return(n||new e.keyframes.Color).__init(t.readInt32(t.position())+t.position(),t)},e.keyframes.Color.prototype.red=function(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint8(this.bb_pos+e):0},e.keyframes.Color.prototype.mutate_red=function(e){var t=this.bb.__offset(this.bb_pos,4);return t===0?!1:(this.bb.writeUint8(this.bb_pos+t,e),!0)},e.keyframes.Color.prototype.green=function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb_pos+e):0},e.keyframes.Color.prototype.mutate_green=function(e){var t=this.bb.__offset(this.bb_pos,6);return t===0?!1:(this.bb.writeUint8(this.bb_pos+t,e),!0)},e.keyframes.Color.prototype.blue=function(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readUint8(this.bb_pos+e):0},e.keyframes.Color.prototype.mutate_blue=function(e){var t=this.bb.__offset(this.bb_pos,8);return t===0?!1:(this.bb.writeUint8(this.bb_pos+t,e),!0)},e.keyframes.Color.prototype.alpha=function(){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readUint8(this.bb_pos+e):255},e.keyframes.Color.prototype.mutate_alpha=function(e){var t=this.bb.__offset(this.bb_pos,10);return t===0?!1:(this.bb.writeUint8(this.bb_pos+t,e),!0)},e.keyframes.Color.startColor=function(e){e.startObject(4)},e.keyframes.Color.addRed=function(e,t){e.addFieldInt8(0,t,0)},e.keyframes.Color.addGreen=function(e,t){e.addFieldInt8(1,t,0)},e.keyframes.Color.addBlue=function(e,t){e.addFieldInt8(2,t,0)},e.keyframes.Color.addAlpha=function(e,t){e.addFieldInt8(3,t,255)},e.keyframes.Color.endColor=function(e){var t=e.endObject();return t},e.keyframes.Color.createColor=function(t,n,r,o,a){return e.keyframes.Color.startColor(t),e.keyframes.Color.addRed(t,n),e.keyframes.Color.addGreen(t,r),e.keyframes.Color.addBlue(t,o),e.keyframes.Color.addAlpha(t,a),e.keyframes.Color.endColor(t)},e.keyframes.ColorArray=function(){this.bb=null,this.bb_pos=0},e.keyframes.ColorArray.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.ColorArray.getRootAsColorArray=function(t,n){return(n||new e.keyframes.ColorArray).__init(t.readInt32(t.position())+t.position(),t)},e.keyframes.ColorArray.prototype.colors=function(t,n){var r=this.bb.__offset(this.bb_pos,4);return r?(n||new e.keyframes.Color).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null},e.keyframes.ColorArray.prototype.colorsLength=function(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.ColorArray.startColorArray=function(e){e.startObject(1)},e.keyframes.ColorArray.addColors=function(e,t){e.addFieldOffset(0,t,0)},e.keyframes.ColorArray.createColorsVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.ColorArray.startColorsVector=function(e,t){e.startVector(4,t,4)},e.keyframes.ColorArray.endColorArray=function(e){var t=e.endObject();return t},e.keyframes.ColorArray.createColorArray=function(t,n){return e.keyframes.ColorArray.startColorArray(t),e.keyframes.ColorArray.addColors(t,n),e.keyframes.ColorArray.endColorArray(t)},e.keyframes.Command=function(){this.bb=null,this.bb_pos=0},e.keyframes.Command.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.Command.getRootAsCommand=function(t,n){return(n||new e.keyframes.Command).__init(t.readInt32(t.position())+t.position(),t)},e.keyframes.Command.prototype.type=function(){var t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):e.keyframes.CommandType.MoveTo},e.keyframes.Command.prototype.mutate_type=function(e){var t=this.bb.__offset(this.bb_pos,4);return t===0?!1:(this.bb.writeInt8(this.bb_pos+t,e),!0)},e.keyframes.Command.prototype.point=function(t){var n=this.bb.__offset(this.bb_pos,6);return n?(t||new e.keyframes.Point).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Command.prototype.control1=function(t){var n=this.bb.__offset(this.bb_pos,8);return n?(t||new e.keyframes.Point).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Command.prototype.control2=function(t){var n=this.bb.__offset(this.bb_pos,10);return n?(t||new e.keyframes.Point).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Command.startCommand=function(e){e.startObject(4)},e.keyframes.Command.addType=function(t,n){t.addFieldInt8(0,n,e.keyframes.CommandType.MoveTo)},e.keyframes.Command.addPoint=function(e,t){e.addFieldOffset(1,t,0)},e.keyframes.Command.addControl1=function(e,t){e.addFieldOffset(2,t,0)},e.keyframes.Command.addControl2=function(e,t){e.addFieldOffset(3,t,0)},e.keyframes.Command.endCommand=function(e){var t=e.endObject();return t},e.keyframes.Command.createCommand=function(t,n,r,o,a){return e.keyframes.Command.startCommand(t),e.keyframes.Command.addType(t,n),e.keyframes.Command.addPoint(t,r),e.keyframes.Command.addControl1(t,o),e.keyframes.Command.addControl2(t,a),e.keyframes.Command.endCommand(t)},e.keyframes.Path=function(){this.bb=null,this.bb_pos=0},e.keyframes.Path.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.Path.getRootAsPath=function(t,n){return(n||new e.keyframes.Path).__init(t.readInt32(t.position())+t.position(),t)},e.keyframes.Path.prototype.commands=function(t,n){var r=this.bb.__offset(this.bb_pos,4);return r?(n||new e.keyframes.Command).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null},e.keyframes.Path.prototype.commandsLength=function(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.Path.startPath=function(e){e.startObject(1)},e.keyframes.Path.addCommands=function(e,t){e.addFieldOffset(0,t,0)},e.keyframes.Path.createCommandsVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.Path.startCommandsVector=function(e,t){e.startVector(4,t,4)},e.keyframes.Path.endPath=function(e){var t=e.endObject();return t},e.keyframes.Path.createPath=function(t,n){return e.keyframes.Path.startPath(t),e.keyframes.Path.addCommands(t,n),e.keyframes.Path.endPath(t)},e.keyframes.Tween=function(){this.bb=null,this.bb_pos=0},e.keyframes.Tween.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.Tween.getRootAsTween=function(t,n){return(n||new e.keyframes.Tween).__init(t.readInt32(t.position())+t.position(),t)},e.keyframes.Tween.prototype.type=function(){var t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):e.keyframes.TweenType.Bezier},e.keyframes.Tween.prototype.mutate_type=function(e){var t=this.bb.__offset(this.bb_pos,4);return t===0?!1:(this.bb.writeInt8(this.bb_pos+t,e),!0)},e.keyframes.Tween.prototype.control1=function(t){var n=this.bb.__offset(this.bb_pos,6);return n?(t||new e.keyframes.Point).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Tween.prototype.control2=function(t){var n=this.bb.__offset(this.bb_pos,8);return n?(t||new e.keyframes.Point).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Tween.startTween=function(e){e.startObject(3)},e.keyframes.Tween.addType=function(t,n){t.addFieldInt8(0,n,e.keyframes.TweenType.Bezier)},e.keyframes.Tween.addControl1=function(e,t){e.addFieldOffset(1,t,0)},e.keyframes.Tween.addControl2=function(e,t){e.addFieldOffset(2,t,0)},e.keyframes.Tween.endTween=function(e){var t=e.endObject();return t},e.keyframes.Tween.createTween=function(t,n,r,o){return e.keyframes.Tween.startTween(t),e.keyframes.Tween.addType(t,n),e.keyframes.Tween.addControl1(t,r),e.keyframes.Tween.addControl2(t,o),e.keyframes.Tween.endTween(t)},e.keyframes.ScalarAnimation=function(){this.bb=null,this.bb_pos=0},e.keyframes.ScalarAnimation.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.ScalarAnimation.getRootAsScalarAnimation=function(t,n){return(n||new e.keyframes.ScalarAnimation).__init(t.readInt32(t.position())+t.position(),t)},e.keyframes.ScalarAnimation.prototype.value=function(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readFloat32(this.bb_pos+e):0},e.keyframes.ScalarAnimation.prototype.mutate_value=function(e){var t=this.bb.__offset(this.bb_pos,4);return t===0?!1:(this.bb.writeFloat32(this.bb_pos+t,e),!0)},e.keyframes.ScalarAnimation.prototype.values=function(e){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readFloat32(this.bb.__vector(this.bb_pos+t)+e*4):0},e.keyframes.ScalarAnimation.prototype.valuesLength=function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.ScalarAnimation.prototype.valuesArray=function(){var e=this.bb.__offset(this.bb_pos,6);return e?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null},e.keyframes.ScalarAnimation.prototype.keyframes=function(e){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readFloat32(this.bb.__vector(this.bb_pos+t)+e*4):0},e.keyframes.ScalarAnimation.prototype.keyframesLength=function(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.ScalarAnimation.prototype.keyframesArray=function(){var e=this.bb.__offset(this.bb_pos,8);return e?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null},e.keyframes.ScalarAnimation.prototype.tweens=function(t,n){var r=this.bb.__offset(this.bb_pos,10);return r?(n||new e.keyframes.Tween).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null},e.keyframes.ScalarAnimation.prototype.tweensLength=function(){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.ScalarAnimation.startScalarAnimation=function(e){e.startObject(4)},e.keyframes.ScalarAnimation.addValue=function(e,t){e.addFieldFloat32(0,t,0)},e.keyframes.ScalarAnimation.addValues=function(e,t){e.addFieldOffset(1,t,0)},e.keyframes.ScalarAnimation.createValuesVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addFloat32(t[n]);return e.endVector()},e.keyframes.ScalarAnimation.startValuesVector=function(e,t){e.startVector(4,t,4)},e.keyframes.ScalarAnimation.addKeyframes=function(e,t){e.addFieldOffset(2,t,0)},e.keyframes.ScalarAnimation.createKeyframesVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addFloat32(t[n]);return e.endVector()},e.keyframes.ScalarAnimation.startKeyframesVector=function(e,t){e.startVector(4,t,4)},e.keyframes.ScalarAnimation.addTweens=function(e,t){e.addFieldOffset(3,t,0)},e.keyframes.ScalarAnimation.createTweensVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.ScalarAnimation.startTweensVector=function(e,t){e.startVector(4,t,4)},e.keyframes.ScalarAnimation.endScalarAnimation=function(e){var t=e.endObject();return t},e.keyframes.ScalarAnimation.createScalarAnimation=function(t,n,r,o,a){return e.keyframes.ScalarAnimation.startScalarAnimation(t),e.keyframes.ScalarAnimation.addValue(t,n),e.keyframes.ScalarAnimation.addValues(t,r),e.keyframes.ScalarAnimation.addKeyframes(t,o),e.keyframes.ScalarAnimation.addTweens(t,a),e.keyframes.ScalarAnimation.endScalarAnimation(t)},e.keyframes.ScalarArray=function(){this.bb=null,this.bb_pos=0},e.keyframes.ScalarArray.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.ScalarArray.getRootAsScalarArray=function(t,n){return(n||new e.keyframes.ScalarArray).__init(t.readInt32(t.position())+t.position(),t)},e.keyframes.ScalarArray.prototype.values=function(e){var t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readFloat32(this.bb.__vector(this.bb_pos+t)+e*4):0},e.keyframes.ScalarArray.prototype.valuesLength=function(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.ScalarArray.prototype.valuesArray=function(){var e=this.bb.__offset(this.bb_pos,4);return e?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null},e.keyframes.ScalarArray.startScalarArray=function(e){e.startObject(1)},e.keyframes.ScalarArray.addValues=function(e,t){e.addFieldOffset(0,t,0)},e.keyframes.ScalarArray.createValuesVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addFloat32(t[n]);return e.endVector()},e.keyframes.ScalarArray.startValuesVector=function(e,t){e.startVector(4,t,4)},e.keyframes.ScalarArray.endScalarArray=function(e){var t=e.endObject();return t},e.keyframes.ScalarArray.createScalarArray=function(t,n){return e.keyframes.ScalarArray.startScalarArray(t),e.keyframes.ScalarArray.addValues(t,n),e.keyframes.ScalarArray.endScalarArray(t)},e.keyframes.ScalarArrayAnimation=function(){this.bb=null,this.bb_pos=0},e.keyframes.ScalarArrayAnimation.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.ScalarArrayAnimation.getRootAsScalarArrayAnimation=function(t,n){return(n||new e.keyframes.ScalarArrayAnimation).__init(t.readInt32(t.position())+t.position(),t)},e.keyframes.ScalarArrayAnimation.prototype.value=function(t){var n=this.bb.__offset(this.bb_pos,4);return n?(t||new e.keyframes.ScalarArray).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.ScalarArrayAnimation.prototype.values=function(t,n){var r=this.bb.__offset(this.bb_pos,6);return r?(n||new e.keyframes.ScalarArray).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null},e.keyframes.ScalarArrayAnimation.prototype.valuesLength=function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.ScalarArrayAnimation.prototype.keyframes=function(e){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readFloat32(this.bb.__vector(this.bb_pos+t)+e*4):0},e.keyframes.ScalarArrayAnimation.prototype.keyframesLength=function(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.ScalarArrayAnimation.prototype.keyframesArray=function(){var e=this.bb.__offset(this.bb_pos,8);return e?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null},e.keyframes.ScalarArrayAnimation.prototype.tweens=function(t,n){var r=this.bb.__offset(this.bb_pos,10);return r?(n||new e.keyframes.Tween).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null},e.keyframes.ScalarArrayAnimation.prototype.tweensLength=function(){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.ScalarArrayAnimation.startScalarArrayAnimation=function(e){e.startObject(4)},e.keyframes.ScalarArrayAnimation.addValue=function(e,t){e.addFieldOffset(0,t,0)},e.keyframes.ScalarArrayAnimation.addValues=function(e,t){e.addFieldOffset(1,t,0)},e.keyframes.ScalarArrayAnimation.createValuesVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.ScalarArrayAnimation.startValuesVector=function(e,t){e.startVector(4,t,4)},e.keyframes.ScalarArrayAnimation.addKeyframes=function(e,t){e.addFieldOffset(2,t,0)},e.keyframes.ScalarArrayAnimation.createKeyframesVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addFloat32(t[n]);return e.endVector()},e.keyframes.ScalarArrayAnimation.startKeyframesVector=function(e,t){e.startVector(4,t,4)},e.keyframes.ScalarArrayAnimation.addTweens=function(e,t){e.addFieldOffset(3,t,0)},e.keyframes.ScalarArrayAnimation.createTweensVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.ScalarArrayAnimation.startTweensVector=function(e,t){e.startVector(4,t,4)},e.keyframes.ScalarArrayAnimation.endScalarArrayAnimation=function(e){var t=e.endObject();return t},e.keyframes.ScalarArrayAnimation.createScalarArrayAnimation=function(t,n,r,o,a){return e.keyframes.ScalarArrayAnimation.startScalarArrayAnimation(t),e.keyframes.ScalarArrayAnimation.addValue(t,n),e.keyframes.ScalarArrayAnimation.addValues(t,r),e.keyframes.ScalarArrayAnimation.addKeyframes(t,o),e.keyframes.ScalarArrayAnimation.addTweens(t,a),e.keyframes.ScalarArrayAnimation.endScalarArrayAnimation(t)},e.keyframes.PointAnimation=function(){this.bb=null,this.bb_pos=0},e.keyframes.PointAnimation.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.PointAnimation.getRootAsPointAnimation=function(t,n){return(n||new e.keyframes.PointAnimation).__init(t.readInt32(t.position())+t.position(),t)},e.keyframes.PointAnimation.prototype.value=function(t){var n=this.bb.__offset(this.bb_pos,4);return n?(t||new e.keyframes.Point).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.PointAnimation.prototype.values=function(t,n){var r=this.bb.__offset(this.bb_pos,6);return r?(n||new e.keyframes.Point).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null},e.keyframes.PointAnimation.prototype.valuesLength=function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.PointAnimation.prototype.keyframes=function(e){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readFloat32(this.bb.__vector(this.bb_pos+t)+e*4):0},e.keyframes.PointAnimation.prototype.keyframesLength=function(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.PointAnimation.prototype.keyframesArray=function(){var e=this.bb.__offset(this.bb_pos,8);return e?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null},e.keyframes.PointAnimation.prototype.tweens=function(t,n){var r=this.bb.__offset(this.bb_pos,10);return r?(n||new e.keyframes.Tween).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null},e.keyframes.PointAnimation.prototype.tweensLength=function(){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.PointAnimation.startPointAnimation=function(e){e.startObject(4)},e.keyframes.PointAnimation.addValue=function(e,t){e.addFieldOffset(0,t,0)},e.keyframes.PointAnimation.addValues=function(e,t){e.addFieldOffset(1,t,0)},e.keyframes.PointAnimation.createValuesVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.PointAnimation.startValuesVector=function(e,t){e.startVector(4,t,4)},e.keyframes.PointAnimation.addKeyframes=function(e,t){e.addFieldOffset(2,t,0)},e.keyframes.PointAnimation.createKeyframesVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addFloat32(t[n]);return e.endVector()},e.keyframes.PointAnimation.startKeyframesVector=function(e,t){e.startVector(4,t,4)},e.keyframes.PointAnimation.addTweens=function(e,t){e.addFieldOffset(3,t,0)},e.keyframes.PointAnimation.createTweensVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.PointAnimation.startTweensVector=function(e,t){e.startVector(4,t,4)},e.keyframes.PointAnimation.endPointAnimation=function(e){var t=e.endObject();return t},e.keyframes.PointAnimation.createPointAnimation=function(t,n,r,o,a){return e.keyframes.PointAnimation.startPointAnimation(t),e.keyframes.PointAnimation.addValue(t,n),e.keyframes.PointAnimation.addValues(t,r),e.keyframes.PointAnimation.addKeyframes(t,o),e.keyframes.PointAnimation.addTweens(t,a),e.keyframes.PointAnimation.endPointAnimation(t)},e.keyframes.ColorAnimation=function(){this.bb=null,this.bb_pos=0},e.keyframes.ColorAnimation.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.ColorAnimation.getRootAsColorAnimation=function(t,n){return(n||new e.keyframes.ColorAnimation).__init(t.readInt32(t.position())+t.position(),t)},e.keyframes.ColorAnimation.prototype.value=function(t){var n=this.bb.__offset(this.bb_pos,4);return n?(t||new e.keyframes.Color).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.ColorAnimation.prototype.values=function(t,n){var r=this.bb.__offset(this.bb_pos,6);return r?(n||new e.keyframes.Color).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null},e.keyframes.ColorAnimation.prototype.valuesLength=function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.ColorAnimation.prototype.keyframes=function(e){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readFloat32(this.bb.__vector(this.bb_pos+t)+e*4):0},e.keyframes.ColorAnimation.prototype.keyframesLength=function(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.ColorAnimation.prototype.keyframesArray=function(){var e=this.bb.__offset(this.bb_pos,8);return e?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null},e.keyframes.ColorAnimation.prototype.tweens=function(t,n){var r=this.bb.__offset(this.bb_pos,10);return r?(n||new e.keyframes.Tween).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null},e.keyframes.ColorAnimation.prototype.tweensLength=function(){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.ColorAnimation.startColorAnimation=function(e){e.startObject(4)},e.keyframes.ColorAnimation.addValue=function(e,t){e.addFieldOffset(0,t,0)},e.keyframes.ColorAnimation.addValues=function(e,t){e.addFieldOffset(1,t,0)},e.keyframes.ColorAnimation.createValuesVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.ColorAnimation.startValuesVector=function(e,t){e.startVector(4,t,4)},e.keyframes.ColorAnimation.addKeyframes=function(e,t){e.addFieldOffset(2,t,0)},e.keyframes.ColorAnimation.createKeyframesVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addFloat32(t[n]);return e.endVector()},e.keyframes.ColorAnimation.startKeyframesVector=function(e,t){e.startVector(4,t,4)},e.keyframes.ColorAnimation.addTweens=function(e,t){e.addFieldOffset(3,t,0)},e.keyframes.ColorAnimation.createTweensVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.ColorAnimation.startTweensVector=function(e,t){e.startVector(4,t,4)},e.keyframes.ColorAnimation.endColorAnimation=function(e){var t=e.endObject();return t},e.keyframes.ColorAnimation.createColorAnimation=function(t,n,r,o,a){return e.keyframes.ColorAnimation.startColorAnimation(t),e.keyframes.ColorAnimation.addValue(t,n),e.keyframes.ColorAnimation.addValues(t,r),e.keyframes.ColorAnimation.addKeyframes(t,o),e.keyframes.ColorAnimation.addTweens(t,a),e.keyframes.ColorAnimation.endColorAnimation(t)},e.keyframes.ColorArrayAnimation=function(){this.bb=null,this.bb_pos=0},e.keyframes.ColorArrayAnimation.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.ColorArrayAnimation.getRootAsColorArrayAnimation=function(t,n){return(n||new e.keyframes.ColorArrayAnimation).__init(t.readInt32(t.position())+t.position(),t)},e.keyframes.ColorArrayAnimation.prototype.value=function(t){var n=this.bb.__offset(this.bb_pos,4);return n?(t||new e.keyframes.ColorArray).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.ColorArrayAnimation.prototype.values=function(t,n){var r=this.bb.__offset(this.bb_pos,6);return r?(n||new e.keyframes.ColorArray).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null},e.keyframes.ColorArrayAnimation.prototype.valuesLength=function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.ColorArrayAnimation.prototype.keyframes=function(e){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readFloat32(this.bb.__vector(this.bb_pos+t)+e*4):0},e.keyframes.ColorArrayAnimation.prototype.keyframesLength=function(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.ColorArrayAnimation.prototype.keyframesArray=function(){var e=this.bb.__offset(this.bb_pos,8);return e?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null},e.keyframes.ColorArrayAnimation.prototype.tweens=function(t,n){var r=this.bb.__offset(this.bb_pos,10);return r?(n||new e.keyframes.Tween).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null},e.keyframes.ColorArrayAnimation.prototype.tweensLength=function(){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.ColorArrayAnimation.startColorArrayAnimation=function(e){e.startObject(4)},e.keyframes.ColorArrayAnimation.addValue=function(e,t){e.addFieldOffset(0,t,0)},e.keyframes.ColorArrayAnimation.addValues=function(e,t){e.addFieldOffset(1,t,0)},e.keyframes.ColorArrayAnimation.createValuesVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.ColorArrayAnimation.startValuesVector=function(e,t){e.startVector(4,t,4)},e.keyframes.ColorArrayAnimation.addKeyframes=function(e,t){e.addFieldOffset(2,t,0)},e.keyframes.ColorArrayAnimation.createKeyframesVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addFloat32(t[n]);return e.endVector()},e.keyframes.ColorArrayAnimation.startKeyframesVector=function(e,t){e.startVector(4,t,4)},e.keyframes.ColorArrayAnimation.addTweens=function(e,t){e.addFieldOffset(3,t,0)},e.keyframes.ColorArrayAnimation.createTweensVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.ColorArrayAnimation.startTweensVector=function(e,t){e.startVector(4,t,4)},e.keyframes.ColorArrayAnimation.endColorArrayAnimation=function(e){var t=e.endObject();return t},e.keyframes.ColorArrayAnimation.createColorArrayAnimation=function(t,n,r,o,a){return e.keyframes.ColorArrayAnimation.startColorArrayAnimation(t),e.keyframes.ColorArrayAnimation.addValue(t,n),e.keyframes.ColorArrayAnimation.addValues(t,r),e.keyframes.ColorArrayAnimation.addKeyframes(t,o),e.keyframes.ColorArrayAnimation.addTweens(t,a),e.keyframes.ColorArrayAnimation.endColorArrayAnimation(t)},e.keyframes.PathAnimation=function(){this.bb=null,this.bb_pos=0},e.keyframes.PathAnimation.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.PathAnimation.getRootAsPathAnimation=function(t,n){return(n||new e.keyframes.PathAnimation).__init(t.readInt32(t.position())+t.position(),t)},e.keyframes.PathAnimation.prototype.value=function(t){var n=this.bb.__offset(this.bb_pos,4);return n?(t||new e.keyframes.Path).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.PathAnimation.prototype.values=function(t,n){var r=this.bb.__offset(this.bb_pos,6);return r?(n||new e.keyframes.Path).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null},e.keyframes.PathAnimation.prototype.valuesLength=function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.PathAnimation.prototype.keyframes=function(e){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readFloat32(this.bb.__vector(this.bb_pos+t)+e*4):0},e.keyframes.PathAnimation.prototype.keyframesLength=function(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.PathAnimation.prototype.keyframesArray=function(){var e=this.bb.__offset(this.bb_pos,8);return e?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null},e.keyframes.PathAnimation.prototype.tweens=function(t,n){var r=this.bb.__offset(this.bb_pos,10);return r?(n||new e.keyframes.Tween).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null},e.keyframes.PathAnimation.prototype.tweensLength=function(){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.PathAnimation.startPathAnimation=function(e){e.startObject(4)},e.keyframes.PathAnimation.addValue=function(e,t){e.addFieldOffset(0,t,0)},e.keyframes.PathAnimation.addValues=function(e,t){e.addFieldOffset(1,t,0)},e.keyframes.PathAnimation.createValuesVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.PathAnimation.startValuesVector=function(e,t){e.startVector(4,t,4)},e.keyframes.PathAnimation.addKeyframes=function(e,t){e.addFieldOffset(2,t,0)},e.keyframes.PathAnimation.createKeyframesVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addFloat32(t[n]);return e.endVector()},e.keyframes.PathAnimation.startKeyframesVector=function(e,t){e.startVector(4,t,4)},e.keyframes.PathAnimation.addTweens=function(e,t){e.addFieldOffset(3,t,0)},e.keyframes.PathAnimation.createTweensVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.PathAnimation.startTweensVector=function(e,t){e.startVector(4,t,4)},e.keyframes.PathAnimation.endPathAnimation=function(e){var t=e.endObject();return t},e.keyframes.PathAnimation.createPathAnimation=function(t,n,r,o,a){return e.keyframes.PathAnimation.startPathAnimation(t),e.keyframes.PathAnimation.addValue(t,n),e.keyframes.PathAnimation.addValues(t,r),e.keyframes.PathAnimation.addKeyframes(t,o),e.keyframes.PathAnimation.addTweens(t,a),e.keyframes.PathAnimation.endPathAnimation(t)},e.keyframes.Gradient=function(){this.bb=null,this.bb_pos=0},e.keyframes.Gradient.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.Gradient.getRootAsGradient=function(t,n){return(n||new e.keyframes.Gradient).__init(t.readInt32(t.position())+t.position(),t)},e.keyframes.Gradient.prototype.colorStart=function(t){var n=this.bb.__offset(this.bb_pos,4);return n?(t||new e.keyframes.ColorAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Gradient.prototype.colorEnd=function(t){var n=this.bb.__offset(this.bb_pos,6);return n?(t||new e.keyframes.ColorAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Gradient.prototype.rampStart=function(t){var n=this.bb.__offset(this.bb_pos,8);return n?(t||new e.keyframes.PointAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Gradient.prototype.rampEnd=function(t){var n=this.bb.__offset(this.bb_pos,10);return n?(t||new e.keyframes.PointAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Gradient.prototype.type=function(){var t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readInt8(this.bb_pos+t):e.keyframes.GradientType.Linear},e.keyframes.Gradient.prototype.mutate_type=function(e){var t=this.bb.__offset(this.bb_pos,12);return t===0?!1:(this.bb.writeInt8(this.bb_pos+t,e),!0)},e.keyframes.Gradient.prototype.colors=function(t){var n=this.bb.__offset(this.bb_pos,14);return n?(t||new e.keyframes.ColorArrayAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Gradient.prototype.positions=function(t){var n=this.bb.__offset(this.bb_pos,16);return n?(t||new e.keyframes.ScalarArrayAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Gradient.prototype.highlightLength=function(t){var n=this.bb.__offset(this.bb_pos,18);return n?(t||new e.keyframes.ScalarAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Gradient.prototype.highlightAngle=function(t){var n=this.bb.__offset(this.bb_pos,20);return n?(t||new e.keyframes.ScalarAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Gradient.startGradient=function(e){e.startObject(9)},e.keyframes.Gradient.addColorStart=function(e,t){e.addFieldOffset(0,t,0)},e.keyframes.Gradient.addColorEnd=function(e,t){e.addFieldOffset(1,t,0)},e.keyframes.Gradient.addRampStart=function(e,t){e.addFieldOffset(2,t,0)},e.keyframes.Gradient.addRampEnd=function(e,t){e.addFieldOffset(3,t,0)},e.keyframes.Gradient.addType=function(t,n){t.addFieldInt8(4,n,e.keyframes.GradientType.Linear)},e.keyframes.Gradient.addColors=function(e,t){e.addFieldOffset(5,t,0)},e.keyframes.Gradient.addPositions=function(e,t){e.addFieldOffset(6,t,0)},e.keyframes.Gradient.addHighlightLength=function(e,t){e.addFieldOffset(7,t,0)},e.keyframes.Gradient.addHighlightAngle=function(e,t){e.addFieldOffset(8,t,0)},e.keyframes.Gradient.endGradient=function(e){var t=e.endObject();return t},e.keyframes.Gradient.createGradient=function(t,n,r,o,a,i,l,s,u,c){return e.keyframes.Gradient.startGradient(t),e.keyframes.Gradient.addColorStart(t,n),e.keyframes.Gradient.addColorEnd(t,r),e.keyframes.Gradient.addRampStart(t,o),e.keyframes.Gradient.addRampEnd(t,a),e.keyframes.Gradient.addType(t,i),e.keyframes.Gradient.addColors(t,l),e.keyframes.Gradient.addPositions(t,s),e.keyframes.Gradient.addHighlightLength(t,u),e.keyframes.Gradient.addHighlightAngle(t,c),e.keyframes.Gradient.endGradient(t)},e.keyframes.Bitmap=function(){this.bb=null,this.bb_pos=0},e.keyframes.Bitmap.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.Bitmap.getRootAsBitmap=function(t,n){return(n||new e.keyframes.Bitmap).__init(t.readInt32(t.position())+t.position(),t)},e.keyframes.Bitmap.prototype.size=function(t){var n=this.bb.__offset(this.bb_pos,4);return n?(t||new e.keyframes.Size).__init(this.bb_pos+n,this.bb):null},e.keyframes.Bitmap.prototype.content=function(e){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb.__vector(this.bb_pos+t)+e):0},e.keyframes.Bitmap.prototype.contentLength=function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.Bitmap.prototype.contentArray=function(){var e=this.bb.__offset(this.bb_pos,6);return e?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null},e.keyframes.Bitmap.prototype.name=function(e){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__string(this.bb_pos+t,e):null},e.keyframes.Bitmap.startBitmap=function(e){e.startObject(3)},e.keyframes.Bitmap.addSize=function(e,t){e.addFieldStruct(0,t,0)},e.keyframes.Bitmap.addContent=function(e,t){e.addFieldOffset(1,t,0)},e.keyframes.Bitmap.createContentVector=function(e,t){e.startVector(1,t.length,1);for(var n=t.length-1;n>=0;n--)e.addInt8(t[n]);return e.endVector()},e.keyframes.Bitmap.startContentVector=function(e,t){e.startVector(1,t,1)},e.keyframes.Bitmap.addName=function(e,t){e.addFieldOffset(2,t,0)},e.keyframes.Bitmap.endBitmap=function(e){var t=e.endObject();return t},e.keyframes.Bitmap.createBitmap=function(t,n,r,o){return e.keyframes.Bitmap.startBitmap(t),e.keyframes.Bitmap.addSize(t,n),e.keyframes.Bitmap.addContent(t,r),e.keyframes.Bitmap.addName(t,o),e.keyframes.Bitmap.endBitmap(t)},e.keyframes.Video=function(){this.bb=null,this.bb_pos=0},e.keyframes.Video.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.Video.getRootAsVideo=function(t,n){return(n||new e.keyframes.Video).__init(t.readInt32(t.position())+t.position(),t)},e.keyframes.Video.prototype.size=function(t){var n=this.bb.__offset(this.bb_pos,4);return n?(t||new e.keyframes.Size).__init(this.bb_pos+n,this.bb):null},e.keyframes.Video.prototype.length=function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb_pos+e):0},e.keyframes.Video.prototype.mutate_length=function(e){var t=this.bb.__offset(this.bb_pos,6);return t===0?!1:(this.bb.writeInt32(this.bb_pos+t,e),!0)},e.keyframes.Video.prototype.content=function(e){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb.__vector(this.bb_pos+t)+e):0},e.keyframes.Video.prototype.contentLength=function(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.Video.prototype.contentArray=function(){var e=this.bb.__offset(this.bb_pos,8);return e?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null},e.keyframes.Video.prototype.name=function(e){var t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__string(this.bb_pos+t,e):null},e.keyframes.Video.startVideo=function(e){e.startObject(4)},e.keyframes.Video.addSize=function(e,t){e.addFieldStruct(0,t,0)},e.keyframes.Video.addLength=function(e,t){e.addFieldInt32(1,t,0)},e.keyframes.Video.addContent=function(e,t){e.addFieldOffset(2,t,0)},e.keyframes.Video.createContentVector=function(e,t){e.startVector(1,t.length,1);for(var n=t.length-1;n>=0;n--)e.addInt8(t[n]);return e.endVector()},e.keyframes.Video.startContentVector=function(e,t){e.startVector(1,t,1)},e.keyframes.Video.addName=function(e,t){e.addFieldOffset(3,t,0)},e.keyframes.Video.endVideo=function(e){var t=e.endObject();return t},e.keyframes.Video.createVideo=function(t,n,r,o,a){return e.keyframes.Video.startVideo(t),e.keyframes.Video.addSize(t,n),e.keyframes.Video.addLength(t,r),e.keyframes.Video.addContent(t,o),e.keyframes.Video.addName(t,a),e.keyframes.Video.endVideo(t)},e.keyframes.Plugin=function(){this.bb=null,this.bb_pos=0},e.keyframes.Plugin.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.Plugin.getRootAsPlugin=function(t,n){return(n||new e.keyframes.Plugin).__init(t.readInt32(t.position())+t.position(),t)},e.keyframes.Plugin.prototype.index=function(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0},e.keyframes.Plugin.prototype.mutate_index=function(e){var t=this.bb.__offset(this.bb_pos,4);return t===0?!1:(this.bb.writeInt32(this.bb_pos+t,e),!0)},e.keyframes.Plugin.prototype.content=function(e){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb.__vector(this.bb_pos+t)+e):0},e.keyframes.Plugin.prototype.contentLength=function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.Plugin.prototype.contentArray=function(){var e=this.bb.__offset(this.bb_pos,6);return e?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null},e.keyframes.Plugin.prototype.optional=function(){var e=this.bb.__offset(this.bb_pos,8);return e?!!this.bb.readInt8(this.bb_pos+e):!1},e.keyframes.Plugin.prototype.mutate_optional=function(e){var t=this.bb.__offset(this.bb_pos,8);return t===0?!1:(this.bb.writeInt8(this.bb_pos+t,e),!0)},e.keyframes.Plugin.startPlugin=function(e){e.startObject(3)},e.keyframes.Plugin.addIndex=function(e,t){e.addFieldInt32(0,t,0)},e.keyframes.Plugin.addContent=function(e,t){e.addFieldOffset(1,t,0)},e.keyframes.Plugin.createContentVector=function(e,t){e.startVector(1,t.length,1);for(var n=t.length-1;n>=0;n--)e.addInt8(t[n]);return e.endVector()},e.keyframes.Plugin.startContentVector=function(e,t){e.startVector(1,t,1)},e.keyframes.Plugin.addOptional=function(e,t){e.addFieldInt8(2,+t,0)},e.keyframes.Plugin.endPlugin=function(e){var t=e.endObject();return t},e.keyframes.Plugin.createPlugin=function(t,n,r,o){return e.keyframes.Plugin.startPlugin(t),e.keyframes.Plugin.addIndex(t,n),e.keyframes.Plugin.addContent(t,r),e.keyframes.Plugin.addOptional(t,o),e.keyframes.Plugin.endPlugin(t)},e.keyframes.ProgressMarker=function(){this.bb=null,this.bb_pos=0},e.keyframes.ProgressMarker.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.ProgressMarker.getRootAsProgressMarker=function(t,n){return(n||new e.keyframes.ProgressMarker).__init(t.readInt32(t.position())+t.position(),t)},e.keyframes.ProgressMarker.prototype.name=function(e){var t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null},e.keyframes.ProgressMarker.prototype.startProgress=function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat32(this.bb_pos+e):0},e.keyframes.ProgressMarker.prototype.mutate_start_progress=function(e){var t=this.bb.__offset(this.bb_pos,6);return t===0?!1:(this.bb.writeFloat32(this.bb_pos+t,e),!0)},e.keyframes.ProgressMarker.prototype.endProgress=function(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readFloat32(this.bb_pos+e):0},e.keyframes.ProgressMarker.prototype.mutate_end_progress=function(e){var t=this.bb.__offset(this.bb_pos,8);return t===0?!1:(this.bb.writeFloat32(this.bb_pos+t,e),!0)},e.keyframes.ProgressMarker.startProgressMarker=function(e){e.startObject(3)},e.keyframes.ProgressMarker.addName=function(e,t){e.addFieldOffset(0,t,0)},e.keyframes.ProgressMarker.addStartProgress=function(e,t){e.addFieldFloat32(1,t,0)},e.keyframes.ProgressMarker.addEndProgress=function(e,t){e.addFieldFloat32(2,t,0)},e.keyframes.ProgressMarker.endProgressMarker=function(e){var t=e.endObject();return t},e.keyframes.ProgressMarker.createProgressMarker=function(t,n,r,o){return e.keyframes.ProgressMarker.startProgressMarker(t),e.keyframes.ProgressMarker.addName(t,n),e.keyframes.ProgressMarker.addStartProgress(t,r),e.keyframes.ProgressMarker.addEndProgress(t,o),e.keyframes.ProgressMarker.endProgressMarker(t)},e.keyframes.Layer=function(){this.bb=null,this.bb_pos=0},e.keyframes.Layer.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.Layer.getRootAsLayer=function(t,n){return(n||new e.keyframes.Layer).__init(t.readInt32(t.position())+t.position(),t)},e.keyframes.Layer.prototype.id=function(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0},e.keyframes.Layer.prototype.mutate_id=function(e){var t=this.bb.__offset(this.bb_pos,4);return t===0?!1:(this.bb.writeInt32(this.bb_pos+t,e),!0)},e.keyframes.Layer.prototype.sublayers=function(t,n){var r=this.bb.__offset(this.bb_pos,6);return r?(n||new e.keyframes.Layer).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null},e.keyframes.Layer.prototype.sublayersLength=function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.Layer.prototype.fromProgress=function(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readFloat32(this.bb_pos+e):0},e.keyframes.Layer.prototype.mutate_from_progress=function(e){var t=this.bb.__offset(this.bb_pos,8);return t===0?!1:(this.bb.writeFloat32(this.bb_pos+t,e),!0)},e.keyframes.Layer.prototype.toProgress=function(){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readFloat32(this.bb_pos+e):1},e.keyframes.Layer.prototype.mutate_to_progress=function(e){var t=this.bb.__offset(this.bb_pos,10);return t===0?!1:(this.bb.writeFloat32(this.bb_pos+t,e),!0)},e.keyframes.Layer.prototype.anchorPoint=function(t){var n=this.bb.__offset(this.bb_pos,12);return n?(t||new e.keyframes.PointAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Layer.prototype.xPosition=function(t){var n=this.bb.__offset(this.bb_pos,14);return n?(t||new e.keyframes.ScalarAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Layer.prototype.yPosition=function(t){var n=this.bb.__offset(this.bb_pos,16);return n?(t||new e.keyframes.ScalarAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Layer.prototype.rotation=function(t){var n=this.bb.__offset(this.bb_pos,18);return n?(t||new e.keyframes.ScalarAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Layer.prototype.scale=function(t){var n=this.bb.__offset(this.bb_pos,20);return n?(t||new e.keyframes.PointAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Layer.prototype.path=function(t){var n=this.bb.__offset(this.bb_pos,22);return n?(t||new e.keyframes.PathAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Layer.prototype.opacity=function(t){var n=this.bb.__offset(this.bb_pos,24);return n?(t||new e.keyframes.ScalarAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Layer.prototype.fillColor=function(t){var n=this.bb.__offset(this.bb_pos,26);return n?(t||new e.keyframes.ColorAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Layer.prototype.strokeColor=function(t){var n=this.bb.__offset(this.bb_pos,28);return n?(t||new e.keyframes.ColorAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Layer.prototype.strokeWidth=function(t){var n=this.bb.__offset(this.bb_pos,30);return n?(t||new e.keyframes.ScalarAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Layer.prototype.strokeLineCap=function(){var t=this.bb.__offset(this.bb_pos,32);return t?this.bb.readInt8(this.bb_pos+t):e.keyframes.StrokeLineCap.Butt},e.keyframes.Layer.prototype.mutate_stroke_line_cap=function(e){var t=this.bb.__offset(this.bb_pos,32);return t===0?!1:(this.bb.writeInt8(this.bb_pos+t,e),!0)},e.keyframes.Layer.prototype.gradient=function(t){var n=this.bb.__offset(this.bb_pos,34);return n?(t||new e.keyframes.Gradient).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Layer.prototype.strokeLineJoin=function(){var t=this.bb.__offset(this.bb_pos,36);return t?this.bb.readInt8(this.bb_pos+t):e.keyframes.StrokeLineJoin.Miter},e.keyframes.Layer.prototype.mutate_stroke_line_join=function(e){var t=this.bb.__offset(this.bb_pos,36);return t===0?!1:(this.bb.writeInt8(this.bb_pos+t,e),!0)},e.keyframes.Layer.prototype.miterLimit=function(t){var n=this.bb.__offset(this.bb_pos,38);return n?(t||new e.keyframes.ScalarAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Layer.prototype.bitmapIndex=function(){var e=this.bb.__offset(this.bb_pos,40);return e?this.bb.readInt32(this.bb_pos+e):-1},e.keyframes.Layer.prototype.mutate_bitmap_index=function(e){var t=this.bb.__offset(this.bb_pos,40);return t===0?!1:(this.bb.writeInt32(this.bb_pos+t,e),!0)},e.keyframes.Layer.prototype.subdocumentIndex=function(){var e=this.bb.__offset(this.bb_pos,42);return e?this.bb.readInt32(this.bb_pos+e):-1},e.keyframes.Layer.prototype.mutate_subdocument_index=function(e){var t=this.bb.__offset(this.bb_pos,42);return t===0?!1:(this.bb.writeInt32(this.bb_pos+t,e),!0)},e.keyframes.Layer.prototype.plugins=function(t,n){var r=this.bb.__offset(this.bb_pos,44);return r?(n||new e.keyframes.Plugin).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null},e.keyframes.Layer.prototype.pluginsLength=function(){var e=this.bb.__offset(this.bb_pos,44);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.Layer.prototype.progressOffset=function(){var e=this.bb.__offset(this.bb_pos,46);return e?this.bb.readFloat32(this.bb_pos+e):0},e.keyframes.Layer.prototype.mutate_progress_offset=function(e){var t=this.bb.__offset(this.bb_pos,46);return t===0?!1:(this.bb.writeFloat32(this.bb_pos+t,e),!0)},e.keyframes.Layer.prototype.clippingPath=function(t){var n=this.bb.__offset(this.bb_pos,48);return n?(t||new e.keyframes.PathAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Layer.prototype.position=function(t){var n=this.bb.__offset(this.bb_pos,50);return n?(t||new e.keyframes.PathAnimation).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Layer.prototype.isTrackMatte=function(){var e=this.bb.__offset(this.bb_pos,52);return e?!!this.bb.readInt8(this.bb_pos+e):!1},e.keyframes.Layer.prototype.mutate_is_track_matte=function(e){var t=this.bb.__offset(this.bb_pos,52);return t===0?!1:(this.bb.writeInt8(this.bb_pos+t,e),!0)},e.keyframes.Layer.prototype.trackMatteType=function(){var t=this.bb.__offset(this.bb_pos,54);return t?this.bb.readInt8(this.bb_pos+t):e.keyframes.TrackMatteType.None},e.keyframes.Layer.prototype.mutate_track_matte_type=function(e){var t=this.bb.__offset(this.bb_pos,54);return t===0?!1:(this.bb.writeInt8(this.bb_pos+t,e),!0)},e.keyframes.Layer.prototype.vectorCompositeOrder=function(){var t=this.bb.__offset(this.bb_pos,56);return t?this.bb.readInt8(this.bb_pos+t):e.keyframes.VectorCompositeOrder.FillStroke},e.keyframes.Layer.prototype.mutate_vector_composite_order=function(e){var t=this.bb.__offset(this.bb_pos,56);return t===0?!1:(this.bb.writeInt8(this.bb_pos+t,e),!0)},e.keyframes.Layer.prototype.text=function(e){var t=this.bb.__offset(this.bb_pos,58);return t?this.bb.__string(this.bb_pos+t,e):null},e.keyframes.Layer.prototype.textTypeface=function(e){var t=this.bb.__offset(this.bb_pos,60);return t?this.bb.__string(this.bb_pos+t,e):null},e.keyframes.Layer.prototype.textSize=function(){var e=this.bb.__offset(this.bb_pos,62);return e?this.bb.readFloat32(this.bb_pos+e):0},e.keyframes.Layer.prototype.mutate_textSize=function(e){var t=this.bb.__offset(this.bb_pos,62);return t===0?!1:(this.bb.writeFloat32(this.bb_pos+t,e),!0)},e.keyframes.Layer.prototype.textColor=function(t){var n=this.bb.__offset(this.bb_pos,64);return n?(t||new e.keyframes.Color).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Layer.prototype.textAlign=function(){var e=this.bb.__offset(this.bb_pos,66);return e?this.bb.readFloat32(this.bb_pos+e):0},e.keyframes.Layer.prototype.mutate_textAlign=function(e){var t=this.bb.__offset(this.bb_pos,66);return t===0?!1:(this.bb.writeFloat32(this.bb_pos+t,e),!0)},e.keyframes.Layer.prototype.textVAlign=function(){var e=this.bb.__offset(this.bb_pos,68);return e?this.bb.readFloat32(this.bb_pos+e):0},e.keyframes.Layer.prototype.mutate_textVAlign=function(e){var t=this.bb.__offset(this.bb_pos,68);return t===0?!1:(this.bb.writeFloat32(this.bb_pos+t,e),!0)},e.keyframes.Layer.prototype.textTracking=function(){var e=this.bb.__offset(this.bb_pos,70);return e?this.bb.readFloat32(this.bb_pos+e):0},e.keyframes.Layer.prototype.mutate_textTracking=function(e){var t=this.bb.__offset(this.bb_pos,70);return t===0?!1:(this.bb.writeFloat32(this.bb_pos+t,e),!0)},e.keyframes.Layer.prototype.textLeading=function(){var e=this.bb.__offset(this.bb_pos,72);return e?this.bb.readFloat32(this.bb_pos+e):0},e.keyframes.Layer.prototype.mutate_textLeading=function(e){var t=this.bb.__offset(this.bb_pos,72);return t===0?!1:(this.bb.writeFloat32(this.bb_pos+t,e),!0)},e.keyframes.Layer.prototype.textItalic=function(){var e=this.bb.__offset(this.bb_pos,74);return e?!!this.bb.readInt8(this.bb_pos+e):!1},e.keyframes.Layer.prototype.mutate_textItalic=function(e){var t=this.bb.__offset(this.bb_pos,74);return t===0?!1:(this.bb.writeInt8(this.bb_pos+t,e),!0)},e.keyframes.Layer.prototype.textWeight=function(){var t=this.bb.__offset(this.bb_pos,76);return t?this.bb.readInt8(this.bb_pos+t):e.keyframes.TextWeight.Thin},e.keyframes.Layer.prototype.mutate_textWeight=function(e){var t=this.bb.__offset(this.bb_pos,76);return t===0?!1:(this.bb.writeInt8(this.bb_pos+t,e),!0)},e.keyframes.Layer.prototype.textBoxSize=function(t){var n=this.bb.__offset(this.bb_pos,78);return n?(t||new e.keyframes.Size).__init(this.bb_pos+n,this.bb):null},e.keyframes.Layer.prototype.videoLevels=function(t,n){var r=this.bb.__offset(this.bb_pos,80);return r?(n||new e.keyframes.ScalarAnimation).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null},e.keyframes.Layer.prototype.videoLevelsLength=function(){var e=this.bb.__offset(this.bb_pos,80);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.Layer.prototype.videoIndex=function(){var e=this.bb.__offset(this.bb_pos,82);return e?this.bb.readInt32(this.bb_pos+e):-1},e.keyframes.Layer.prototype.mutate_video_index=function(e){var t=this.bb.__offset(this.bb_pos,82);return t===0?!1:(this.bb.writeInt32(this.bb_pos+t,e),!0)},e.keyframes.Layer.startLayer=function(e){e.startObject(40)},e.keyframes.Layer.addId=function(e,t){e.addFieldInt32(0,t,0)},e.keyframes.Layer.addSublayers=function(e,t){e.addFieldOffset(1,t,0)},e.keyframes.Layer.createSublayersVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.Layer.startSublayersVector=function(e,t){e.startVector(4,t,4)},e.keyframes.Layer.addFromProgress=function(e,t){e.addFieldFloat32(2,t,0)},e.keyframes.Layer.addToProgress=function(e,t){e.addFieldFloat32(3,t,1)},e.keyframes.Layer.addAnchorPoint=function(e,t){e.addFieldOffset(4,t,0)},e.keyframes.Layer.addXPosition=function(e,t){e.addFieldOffset(5,t,0)},e.keyframes.Layer.addYPosition=function(e,t){e.addFieldOffset(6,t,0)},e.keyframes.Layer.addRotation=function(e,t){e.addFieldOffset(7,t,0)},e.keyframes.Layer.addScale=function(e,t){e.addFieldOffset(8,t,0)},e.keyframes.Layer.addPath=function(e,t){e.addFieldOffset(9,t,0)},e.keyframes.Layer.addOpacity=function(e,t){e.addFieldOffset(10,t,0)},e.keyframes.Layer.addFillColor=function(e,t){e.addFieldOffset(11,t,0)},e.keyframes.Layer.addStrokeColor=function(e,t){e.addFieldOffset(12,t,0)},e.keyframes.Layer.addStrokeWidth=function(e,t){e.addFieldOffset(13,t,0)},e.keyframes.Layer.addStrokeLineCap=function(t,n){t.addFieldInt8(14,n,e.keyframes.StrokeLineCap.Butt)},e.keyframes.Layer.addGradient=function(e,t){e.addFieldOffset(15,t,0)},e.keyframes.Layer.addStrokeLineJoin=function(t,n){t.addFieldInt8(16,n,e.keyframes.StrokeLineJoin.Miter)},e.keyframes.Layer.addMiterLimit=function(e,t){e.addFieldOffset(17,t,0)},e.keyframes.Layer.addBitmapIndex=function(e,t){e.addFieldInt32(18,t,-1)},e.keyframes.Layer.addSubdocumentIndex=function(e,t){e.addFieldInt32(19,t,-1)},e.keyframes.Layer.addPlugins=function(e,t){e.addFieldOffset(20,t,0)},e.keyframes.Layer.createPluginsVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.Layer.startPluginsVector=function(e,t){e.startVector(4,t,4)},e.keyframes.Layer.addProgressOffset=function(e,t){e.addFieldFloat32(21,t,0)},e.keyframes.Layer.addClippingPath=function(e,t){e.addFieldOffset(22,t,0)},e.keyframes.Layer.addPosition=function(e,t){e.addFieldOffset(23,t,0)},e.keyframes.Layer.addIsTrackMatte=function(e,t){e.addFieldInt8(24,+t,0)},e.keyframes.Layer.addTrackMatteType=function(t,n){t.addFieldInt8(25,n,e.keyframes.TrackMatteType.None)},e.keyframes.Layer.addVectorCompositeOrder=function(t,n){t.addFieldInt8(26,n,e.keyframes.VectorCompositeOrder.FillStroke)},e.keyframes.Layer.addText=function(e,t){e.addFieldOffset(27,t,0)},e.keyframes.Layer.addTextTypeface=function(e,t){e.addFieldOffset(28,t,0)},e.keyframes.Layer.addTextSize=function(e,t){e.addFieldFloat32(29,t,0)},e.keyframes.Layer.addTextColor=function(e,t){e.addFieldOffset(30,t,0)},e.keyframes.Layer.addTextAlign=function(e,t){e.addFieldFloat32(31,t,0)},e.keyframes.Layer.addTextVAlign=function(e,t){e.addFieldFloat32(32,t,0)},e.keyframes.Layer.addTextTracking=function(e,t){e.addFieldFloat32(33,t,0)},e.keyframes.Layer.addTextLeading=function(e,t){e.addFieldFloat32(34,t,0)},e.keyframes.Layer.addTextItalic=function(e,t){e.addFieldInt8(35,+t,0)},e.keyframes.Layer.addTextWeight=function(t,n){t.addFieldInt8(36,n,e.keyframes.TextWeight.Thin)},e.keyframes.Layer.addTextBoxSize=function(e,t){e.addFieldStruct(37,t,0)},e.keyframes.Layer.addVideoLevels=function(e,t){e.addFieldOffset(38,t,0)},e.keyframes.Layer.createVideoLevelsVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.Layer.startVideoLevelsVector=function(e,t){e.startVector(4,t,4)},e.keyframes.Layer.addVideoIndex=function(e,t){e.addFieldInt32(39,t,-1)},e.keyframes.Layer.endLayer=function(e){var t=e.endObject();return t},e.keyframes.Layer.createLayer=function(t,n,r,o,a,i,l,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T,D,x,$,P,N,M,w,A,F,O,B,W,q){return e.keyframes.Layer.startLayer(t),e.keyframes.Layer.addId(t,n),e.keyframes.Layer.addSublayers(t,r),e.keyframes.Layer.addFromProgress(t,o),e.keyframes.Layer.addToProgress(t,a),e.keyframes.Layer.addAnchorPoint(t,i),e.keyframes.Layer.addXPosition(t,l),e.keyframes.Layer.addYPosition(t,s),e.keyframes.Layer.addRotation(t,u),e.keyframes.Layer.addScale(t,c),e.keyframes.Layer.addPath(t,d),e.keyframes.Layer.addOpacity(t,m),e.keyframes.Layer.addFillColor(t,p),e.keyframes.Layer.addStrokeColor(t,_),e.keyframes.Layer.addStrokeWidth(t,f),e.keyframes.Layer.addStrokeLineCap(t,g),e.keyframes.Layer.addGradient(t,h),e.keyframes.Layer.addStrokeLineJoin(t,y),e.keyframes.Layer.addMiterLimit(t,C),e.keyframes.Layer.addBitmapIndex(t,b),e.keyframes.Layer.addSubdocumentIndex(t,v),e.keyframes.Layer.addPlugins(t,S),e.keyframes.Layer.addProgressOffset(t,R),e.keyframes.Layer.addClippingPath(t,L),e.keyframes.Layer.addPosition(t,E),e.keyframes.Layer.addIsTrackMatte(t,k),e.keyframes.Layer.addTrackMatteType(t,I),e.keyframes.Layer.addVectorCompositeOrder(t,T),e.keyframes.Layer.addText(t,D),e.keyframes.Layer.addTextTypeface(t,x),e.keyframes.Layer.addTextSize(t,$),e.keyframes.Layer.addTextColor(t,P),e.keyframes.Layer.addTextAlign(t,N),e.keyframes.Layer.addTextVAlign(t,M),e.keyframes.Layer.addTextTracking(t,w),e.keyframes.Layer.addTextLeading(t,A),e.keyframes.Layer.addTextItalic(t,F),e.keyframes.Layer.addTextWeight(t,O),e.keyframes.Layer.addTextBoxSize(t,B),e.keyframes.Layer.addVideoLevels(t,W),e.keyframes.Layer.addVideoIndex(t,q),e.keyframes.Layer.endLayer(t)},e.keyframes.Document=function(){this.bb=null,this.bb_pos=0},e.keyframes.Document.prototype.__init=function(e,t){return this.bb_pos=e,this.bb=t,this},e.keyframes.Document.getRootAsDocument=function(t,n){return(n||new e.keyframes.Document).__init(t.readInt32(t.position())+t.position(),t)},e.keyframes.Document.bufferHasIdentifier=function(e){return e.__has_identifier("KEYF")},e.keyframes.Document.prototype.size=function(t){var n=this.bb.__offset(this.bb_pos,4);return n?(t||new e.keyframes.Size).__init(this.bb_pos+n,this.bb):null},e.keyframes.Document.prototype.frameRate=function(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat32(this.bb_pos+e):0},e.keyframes.Document.prototype.mutate_frame_rate=function(e){var t=this.bb.__offset(this.bb_pos,6);return t===0?!1:(this.bb.writeFloat32(this.bb_pos+t,e),!0)},e.keyframes.Document.prototype.duration=function(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readFloat32(this.bb_pos+e):0},e.keyframes.Document.prototype.mutate_duration=function(e){var t=this.bb.__offset(this.bb_pos,8);return t===0?!1:(this.bb.writeFloat32(this.bb_pos+t,e),!0)},e.keyframes.Document.prototype.version=function(){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt32(this.bb_pos+e):0},e.keyframes.Document.prototype.mutate_version=function(e){var t=this.bb.__offset(this.bb_pos,10);return t===0?!1:(this.bb.writeInt32(this.bb_pos+t,e),!0)},e.keyframes.Document.prototype.rootLayer=function(t){var n=this.bb.__offset(this.bb_pos,12);return n?(t||new e.keyframes.Layer).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null},e.keyframes.Document.prototype.bitmaps=function(t,n){var r=this.bb.__offset(this.bb_pos,14);return r?(n||new e.keyframes.Bitmap).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null},e.keyframes.Document.prototype.bitmapsLength=function(){var e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.Document.prototype.subdocuments=function(t,n){var r=this.bb.__offset(this.bb_pos,16);return r?(n||new e.keyframes.Document).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null},e.keyframes.Document.prototype.subdocumentsLength=function(){var e=this.bb.__offset(this.bb_pos,16);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.Document.prototype.plugins=function(e,t){var n=this.bb.__offset(this.bb_pos,18);return n?this.bb.__string(this.bb.__vector(this.bb_pos+n)+e*4,t):null},e.keyframes.Document.prototype.pluginsLength=function(){var e=this.bb.__offset(this.bb_pos,18);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.Document.prototype.id=function(){var e=this.bb.__offset(this.bb_pos,20);return e?this.bb.readInt32(this.bb_pos+e):0},e.keyframes.Document.prototype.mutate_id=function(e){var t=this.bb.__offset(this.bb_pos,20);return t===0?!1:(this.bb.writeInt32(this.bb_pos+t,e),!0)},e.keyframes.Document.prototype.manifest=function(e){var t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readUint8(this.bb.__vector(this.bb_pos+t)+e):0},e.keyframes.Document.prototype.manifestLength=function(){var e=this.bb.__offset(this.bb_pos,22);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.Document.prototype.manifestArray=function(){var e=this.bb.__offset(this.bb_pos,22);return e?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null},e.keyframes.Document.prototype.progressMarkers=function(t,n){var r=this.bb.__offset(this.bb_pos,24);return r?(n||new e.keyframes.ProgressMarker).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null},e.keyframes.Document.prototype.progressMarkersLength=function(){var e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.Document.prototype.videos=function(t,n){var r=this.bb.__offset(this.bb_pos,26);return r?(n||new e.keyframes.Video).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null},e.keyframes.Document.prototype.videosLength=function(){var e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__vector_len(this.bb_pos+e):0},e.keyframes.Document.startDocument=function(e){e.startObject(12)},e.keyframes.Document.addSize=function(e,t){e.addFieldStruct(0,t,0)},e.keyframes.Document.addFrameRate=function(e,t){e.addFieldFloat32(1,t,0)},e.keyframes.Document.addDuration=function(e,t){e.addFieldFloat32(2,t,0)},e.keyframes.Document.addVersion=function(e,t){e.addFieldInt32(3,t,0)},e.keyframes.Document.addRootLayer=function(e,t){e.addFieldOffset(4,t,0)},e.keyframes.Document.addBitmaps=function(e,t){e.addFieldOffset(5,t,0)},e.keyframes.Document.createBitmapsVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.Document.startBitmapsVector=function(e,t){e.startVector(4,t,4)},e.keyframes.Document.addSubdocuments=function(e,t){e.addFieldOffset(6,t,0)},e.keyframes.Document.createSubdocumentsVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.Document.startSubdocumentsVector=function(e,t){e.startVector(4,t,4)},e.keyframes.Document.addPlugins=function(e,t){e.addFieldOffset(7,t,0)},e.keyframes.Document.createPluginsVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.Document.startPluginsVector=function(e,t){e.startVector(4,t,4)},e.keyframes.Document.addId=function(e,t){e.addFieldInt32(8,t,0)},e.keyframes.Document.addManifest=function(e,t){e.addFieldOffset(9,t,0)},e.keyframes.Document.createManifestVector=function(e,t){e.startVector(1,t.length,1);for(var n=t.length-1;n>=0;n--)e.addInt8(t[n]);return e.endVector()},e.keyframes.Document.startManifestVector=function(e,t){e.startVector(1,t,1)},e.keyframes.Document.addProgressMarkers=function(e,t){e.addFieldOffset(10,t,0)},e.keyframes.Document.createProgressMarkersVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.Document.startProgressMarkersVector=function(e,t){e.startVector(4,t,4)},e.keyframes.Document.addVideos=function(e,t){e.addFieldOffset(11,t,0)},e.keyframes.Document.createVideosVector=function(e,t){e.startVector(4,t.length,4);for(var n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()},e.keyframes.Document.startVideosVector=function(e,t){e.startVector(4,t,4)},e.keyframes.Document.endDocument=function(e){var t=e.endObject();return t},e.keyframes.Document.finishDocumentBuffer=function(e,t){e.finish(t,"KEYF")},e.keyframes.Document.createDocument=function(t,n,r,o,a,i,l,s,u,c,d,m,p){return e.keyframes.Document.startDocument(t),e.keyframes.Document.addSize(t,n),e.keyframes.Document.addFrameRate(t,r),e.keyframes.Document.addDuration(t,o),e.keyframes.Document.addVersion(t,a),e.keyframes.Document.addRootLayer(t,i),e.keyframes.Document.addBitmaps(t,l),e.keyframes.Document.addSubdocuments(t,s),e.keyframes.Document.addPlugins(t,u),e.keyframes.Document.addId(t,c),e.keyframes.Document.addManifest(t,d),e.keyframes.Document.addProgressMarkers(t,m),e.keyframes.Document.addVideos(t,p),e.keyframes.Document.endDocument(t)},a.exports=e.keyframes}),null);
__d("KeyframesVideoUtils",["Promise"],(function(t,n,r,o,a,i){"use strict";var e,l=window.setTimeout,s=4;function u(e){var t=document.createElement("video");return t.setAttribute("webkit-playsinline",""),t.setAttribute("playsinline",""),t.autoplay=!1,t.src=e,t.currentTime=0,e.startsWith("blob:")||(t.crossOrigin="anonymous"),t}function c(t,r){return new(e||(e=n("Promise")))(function(e,n){var o=function(){t.pause(),t.currentTime=r,t.removeEventListener("canplaythrough",o),a()},a=function(){t.readyState===s?e(t):l(a,10)},i=function(r){t.removeEventListener("error",i),n(r)};t.currentTime=r,t.addEventListener("error",i),t.readyState===s?e(t):t.addEventListener("canplaythrough",o)})}i.createVideo=u,i.loadVideo=c}),66);
__d("requestIdleCallback",["cr:7387"],(function(t,n,r,o,a,i,l){l.default=n("cr:7387")}),98);
__d("KeyframesAssetDecoder",["BlobFactory","KeyframesPluginsLoader","KeyframesSchema","KeyframesVideoUtils","Promise","flatbuffers","promiseDone","requestIdleCallback"],(function(t,n,r,o,a,i){"use strict";var e,l=n("KeyframesSchema").Document,s="medium",u=t.URL||t.webkitURL||{};function c(e){var t=new(n("flatbuffers")).ByteBuffer(e);return l.bufferHasIdentifier(t)?l.getRootAsDocument(t):null}function d(t){return new(e||(e=n("Promise")))(function(e,n){var r=new Image;r.onload=function(){return e(r)},r.onerror=function(e){return n("Decode: error requesting image uri "+t)},r.src=t})}function m(e){var t=n("KeyframesVideoUtils").createVideo(e);return n("KeyframesVideoUtils").loadVideo(t,0)}function p(e,n,r){return t.createImageBitmap&&!(e instanceof VideoFrame)?e.width<n||e.height<r?f(e,n,r).then(function(e){return t.createImageBitmap(e,0,0,n,r).catch(function(t){return e})}):t.createImageBitmap(e,0,0,e.width,e.height,{resizeWidth:n,resizeHeight:r,rezizeQuality:s}).catch(function(t){return f(e,n,r)}):f(e,n,r)}function _(t,r,o){return t.width=r,t.height=o,(e||(e=n("Promise"))).resolve(t)}function f(t,r,o){return new(e||(e=n("Promise")))(function(e){var n=document.createElement("canvas");n.width=r,n.height=o;var a=n.getContext("2d");a.drawImage(t,0,0,r,o),e(n)})}function g(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r];if(!(o instanceof VideoFrame)){var a=t[r].size().width(),i=t[r].size().height();if(a!==o.width||i!==o.height){var l=document.createElement("canvas");l.width=a,l.height=i;var s=l.getContext("2d");s.drawImage(o,0,0,a,i),n.push(l)}else n.push(o)}}return n}function h(t,r,o){if(!u.createObjectURL)return(e||(e=n("Promise"))).reject("URL API not supported");var a=u.createObjectURL(t),i=d(a);return n("promiseDone")(i,function(){return n("requestIdleCallback")(function(){return u.revokeObjectURL(a)})}),i}function y(r){if(n("BlobFactory").isSupported()){var o=r.contentArray();if(!o)return(e||(e=n("Promise"))).reject("Decode: tried to decode a null bitmap");var a=n("BlobFactory").getBlob([o]),i=r.size().width(),l=r.size().height();return t.createImageBitmap?t.createImageBitmap(a,0,0,i,l).catch(function(e){return h(a,i,l)}):h(a,i,l)}return(e||(e=n("Promise"))).reject("Decode: browser does not support bitmap creation")}function C(t){if(n("BlobFactory").isSupported()){var r=t.size(),o=t.contentArray();if(!o)return(e||(e=n("Promise"))).reject("Decode: tried to decode a null video");var a=n("BlobFactory").getBlob([o]);if(!u.createObjectURL)return(e||(e=n("Promise"))).reject("URL API not supported");var i=u.createObjectURL(a),l=m(i).then(function(e){return _(e,r.width(),r.height())});return n("promiseDone")(l,function(){n("requestIdleCallback")(function(){return u.revokeObjectURL(i)})}),l}return(e||(e=n("Promise"))).reject("Decode: browser does not support video creation")}function b(e){for(var t=[],n=e.pluginsLength()-1;n>=0;n--)t.unshift(e.plugins(n));return t.length?t:null}function v(e){for(var t=[],n=e.bitmapsLength()-1;n>=0;n--)t.unshift(e.bitmaps(n));return t}function S(e){for(var t=[],n=e.videosLength()-1;n>=0;n--)t.unshift(e.videos(n));return t}function R(e){for(var t={},n=0;n<e.length;n++){var r=e[n].name();r&&(t[r]={index:n,width:e[n].size().width(),height:e[n].size().height()})}return t}function L(e){for(var t={},n=0;n<e.length;n++){var r=e[n].name();r&&(t[r]={index:n,width:e[n].size().width(),height:e[n].size().height()})}return t}function E(e){for(var t=[],n,r=e.subdocumentsLength()-1;r>=0;r--)n=e.subdocuments(r),t.unshift(n);return t}function k(t){var r=c(t);return r?I(r):(e||(e=n("Promise"))).reject("Decode: could not create flatbuffer doc")}function I(t){var r=v(t),o=L(r),a=S(t),i=R(a),l=r.filter(function(e){return e.contentLength()||!e.name()}).map(y),s=a.filter(function(e){return e.contentLength()||!e.name()}).map(C),u=E(t).map(I),c=b(t),d=c?n("KeyframesPluginsLoader").fromPluginTable(c):(e||(e=n("Promise"))).resolve(null);return(e||(e=n("Promise"))).all([e.all(l),e.all(s),d,e.all(u)]).then(function(e){var n=e[0],a=e[1],l=e[2],s=e[3];return{bitmaps:g(n,r),bitmapNames:o,videos:a,videoNames:i,doc:t,pluginsLoader:l,subassets:s}})}function T(t){return Uint8Array?(e||(e=n("Promise"))).resolve(new Uint8Array(t)):(e||(e=n("Promise"))).reject("Decode: typed arrays not supported")}function D(t,r,o){if(!t.bitmapNames[r]){var a=Object.keys(t.bitmapNames).join(",");return(e||(e=n("Promise"))).reject("Decode: missing replacement bitmap name "+r+", available names: "+a)}var i=t.bitmapNames[r],l=i.height,s=i.index,u=i.width;return p(o,u,l).then(function(e){t.bitmaps[s]=e})}function x(t,r,o){if(!t.videoNames[r]){var a=Object.keys(t.videoNames).join(",");return(e||(e=n("Promise"))).reject("Decode: missing replacement video name "+r+", available names: "+a)}var i=t.videoNames[r],l=i.height,s=i.index,u=i.width;return _(o,u,l).then(function(e){t.videos[s]=e})}function $(e){var t=babelHelpers.extends({},e);return t.bitmaps=e.bitmaps.slice(),t}var P={awaitForMap:function(r,o){var t={},a=[],i=function(){var e=l[0],r=l[1],i=o(r,e);a.push(i),n("promiseDone")(i,function(n){return t[e]=n})};for(var l of Object.entries(r))i();return(e||(e=n("Promise"))).all(a).then(function(){return t})},fromDocumentBytes:function(r){return r instanceof ArrayBuffer?T(r).then(k):r instanceof Uint8Array?k(r):(e||(e=n("Promise"))).reject("Decode: unsupported byte container passed")},replaceBitmapsWithURIs:function(t,n){return P.awaitForMap(n,function(e){return d(e)}).then(function(e){return P.replaceBitmapsWithImageSources(t,e)})},replaceBitmapsWithImageSources:function(t,n){var e=$(t);return P.awaitForMap(n,function(t,n){return D(e,n,t)}).then(function(){return e})},replaceVideosWithURIs:function(t,n){return P.awaitForMap(n,m).then(function(e){return P.replaceVideosWithVideoSources(t,e)})},replaceVideosWithVideoSources:function(t,n){var e=$(t);return P.awaitForMap(n,function(t,n){return x(e,n,t)}).then(function(){return e})}};a.exports=P}),null);
__d("KeyframesCanvasPolyfills",[],(function(t,n,r,o,a,i){"use strict";function e(e){e.getTransform===void 0&&(e.currentTransform?e.getTransform=function(){var t=e.currentTransform;return{a:t.a,b:t.b,c:t.c,d:t.d,e:t.e,f:t.f}}:e.mozCurrentTransform!==void 0?e.getTransform=function(){var t=e.mozCurrentTransform;return{a:t[0],b:t[1],c:t[2],d:t[3],e:t[4],f:t[5]}}:e.getTransform=function(){return l})}var l={a:1,b:0,c:0,d:1,e:0,f:0};i.addGetTransformPolyfill=e}),66);
__d("KeyframesCanvasPool",["KeyframesCanvasPolyfills","nullthrows"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){var t=this;this.$4=function(e){e.canvas.width=t.$1.width.physical,e.canvas.height=t.$1.height.physical,e.canvas.style.width=t.$1.width.logical+"px",e.canvas.style.height=t.$1.height.logical+"px"},this.$1=e,this.$2=[],this.$3=[]}var t=e.prototype;return t.getCanvas=function(){if(this.$2.length){var e=this.$2.pop();return this.$3.push(e),e}else{var t=document.createElement("canvas"),n=r("nullthrows")(t.getContext("2d"));o("KeyframesCanvasPolyfills").addGetTransformPolyfill(n);var a={canvas:t,ctx:n};return this.$4(a),this.$3.push(a),a}},t.clearAllAllocated=function(){var e=this;this.$3.forEach(function(t){var n=t.ctx;n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,Math.max(e.$1.width.physical,e.$1.width.intrinsic),Math.max(e.$1.height.physical,e.$1.height.intrinsic))})},t.freeAll=function(){this.$2=[].concat(this.$3,this.$2),this.$3=[]},t.resizeAll=function(){this.$2.forEach(this.$4,this),this.$3.forEach(this.$4,this)},e})();l.default=e}),98);
__d("KeyframesCanvasUtils",["invariant","KeyframesSchema"],(function(t,n,r,o,a,i,l){"use strict";var e=n("KeyframesSchema").StrokeLineCap,s=n("KeyframesSchema").CommandType,u=["miter","round","bevel"];function c(e){return"rgba("+Math.floor(e.red)+","+Math.floor(e.green)+","+Math.floor(e.blue)+","+Math.floor(e.alpha)/255+")"}function d(t){switch(t){case e.Square:return"square";case e.Round:return"round";case e.Butt:default:return"butt"}}function m(e,t){e.beginPath();for(var n of t)switch(n.type){case s.MoveTo:e.moveTo(n.point.x,n.point.y);break;case s.CubicTo:n.control1&&n.control2||l(0,2935),e.bezierCurveTo(n.control1.x,n.control1.y,n.control2.x,n.control2.y,n.point.x,n.point.y);break;case s.QuadTo:n.control1||l(0,2936),e.quadraticCurveTo(n.control1.x,n.control1.y,n.point.x,n.point.y);break;case s.LineTo:e.lineTo(n.point.x,n.point.y);break;default:throw new Error("Unrecognized path command "+n.type)}}a.exports={drawPath:m,getCanvasStyle:c,getCanvasLineCap:d,LINE_JOINS:u}}),null);
__d("KeyframesDimensions",["invariant","cr:2680"],(function(t,n,r,o,a,i,l,s){"use strict";var e=n("cr:2680").get(),u=(function(){function t(e){this.overridden=!1,this.intrinsic=e,this.$1(e)}var n=t.prototype;return n.$1=function(n){this.logical=n,this.physical=Math.floor(this.logical*e)},n.scale=function(t,n){!this.overridden||s(0,1136),this.$1(t*n)},n.override=function(t){this.overridden=!0,this.$1(t)},n.reset=function(){this.overridden=!1,this.$1(this.intrinsic)},n.getPhysicalChangeRatio=function(){return this.physical/this.intrinsic},t})(),c=(function(){function e(e,t){this.ratio=t?e/t:0,this.width=new u(e),this.height=new u(t)}var t=e.prototype;return t.setWidth=function(t){this.width.override(t),this.height.overridden||this.height.scale(t,this.ratio?1/this.ratio:0)},t.setHeight=function(t){this.height.override(t),this.width.overridden||this.width.scale(t,this.ratio)},t.reset=function(){this.height.reset(),this.width.reset()},e})();l.default=c}),98);
__d("KeyframesLoop",["Run","TimeSlice","emptyFunction","gkx","performanceNow","requestAnimationFramePolyfill"],(function(t,n,r,o,a,i,l){"use strict";var e,s=1e3,u=new Set;function c(t){var n=(e||(e=r("performanceNow")))();t.callback(Math.min(n-(t.previousTime||n),s)),t.previousTime=n,t.framesRemaining-=1,t.framesRemaining<=0&&t.cancel()}function d(e){u.size>0&&(u.forEach(c),r("requestAnimationFramePolyfill")(d))}r("gkx")("20935")||o("Run").onLeave(function(){u.forEach(function(e){return e.cancel()})}),window.addEventListener("focus",function(){u.forEach(function(t){return t.previousTime=(e||(e=r("performanceNow")))()-16.67})});var m=(function(){function t(e){this.framesRemaining=1/0,this.callback=e,this.previousTime=0}var n=t.prototype;return n.start=function(n){n===void 0&&(n=1/0),this.framesRemaining=n,this.$1||(u.size===0&&r("requestAnimationFramePolyfill")(d),u.add(this),this.previousTime=(e||(e=r("performanceNow")))(),this.$1=r("TimeSlice").getGuardedContinuation("KeyframesLoop"))},n.cancel=function(){this.$1&&(this.$1(r("emptyFunction")),this.$1=null,u.delete(this))},n.isRunning=function(){return!!this.$1},t})();l.default=m}),98);
__d("KeyframesPathUtils",[],(function(t,n,r,o,a,i){"use strict";function e(e,t,n){return(n-t)*e+t}function l(e,t,n,r,o,a,i){return o*r+2*n*e*a+t*i}function s(e,t,n,r,o,a,i,l){return o*r*n+a*3*r*e+i*3*n*t+l*t*e}a.exports={interpolateLinear:e,interpolateQuad:l,interpolateCubic:s,lerp:e}}),null);
__d("KeyframesTrackMattes",[],(function(t,n,r,o,a,i){"use strict";var e={1:"destination-in",2:"destination-out"};i.default=e}),66);
__d("KeyframesTween",["invariant","CubicBezier","KeyframesPathUtils","KeyframesSchema"],(function(t,n,r,o,a,i,l){"use strict";var e,s=n("KeyframesPathUtils").interpolateCubic,u=n("KeyframesPathUtils").interpolateLinear,c=n("KeyframesPathUtils").interpolateQuad,d=(e=n("KeyframesSchema")).Color,m=e.ColorAnimation,p=e.ColorArray,_=e.ColorArrayAnimation,f=e.Command,g=e.CommandType,h=e.Path,y=e.PathAnimation,C=e.Point,b=e.PointAnimation,v=e.ScalarAnimation,S=e.ScalarArray,R=e.ScalarArrayAnimation,L=e.TweenType;function E(e){return e}function k(e){return{x:e.x(),y:e.y()}}function I(e){return{red:e.red(),green:e.green(),blue:e.blue(),alpha:e.alpha()}}function T(e){for(var t=e.valuesLength(),n=[],r=0;r<t;r++)n.push(e.values(r));return n}function D(e){for(var t=e.colorsLength(),n=[],r=0;r<t;r++)n.push(I(e.colors(r)));return n}function x(e){var t=e.control1(),n=e.control2();return{type:e.type(),point:k(e.point()),control1:t?k(t):null,control2:n?k(n):null}}function $(e){for(var t=[],n=0;n<e.commandsLength();n++)t.push(x(e.commands(n)));return t}function P(e,t){return e>=t.keyframes(t.keyframesLength()-1)?1:e<t.keyframes(0)?-1:0}function N(e,t){if(P(e,t)!==0)return null;for(var n=0,r=t.keyframesLength()-1;n+1<r;){var o=Math.floor((r-n)/2+n);t.keyframes(o)<e?n=o:r=o}return n}function M(e,t,r){var o=t.tweens(r),a=o.type();if(a===L.Hold)return 0;var i=(e-t.keyframes(r))/(t.keyframes(r+1)-t.keyframes(r));switch(a){case L.Linear:return i;case L.Bezier:default:return new(n("CubicBezier"))([o.control1().x(),o.control1().y()],[o.control2().x(),o.control2().y()]).solve(i)}}var w=function(t,n,r){return t*(r-n)+n},A=function(t,n,r){for(var e=n.valuesLength(),o=[],a=0;a<e;a++)o.push(w(t,n.values(a),r.values(a)));return o},F=function(t,n,r){return{x:w(t,n.x(),r.x()),y:w(t,n.y(),r.y())}},O=function(t,n,r){return n&&r?F(t,n,r):null},B=function(t,n,r){return{red:w(t,n.red(),r.red()),green:w(t,n.green(),r.green()),blue:w(t,n.blue(),r.blue()),alpha:w(t,n.alpha(),r.alpha())}},W=function(t,n,r){for(var e=n.colorsLength(),o=[],a=0;a<e;a++)o.push(B(t,n.colors(a),r.colors(a)));return o},q=function(t,n,r){for(var e=[],o=0;o<n.commandsLength();o++){var a=n.commands(o),i=r.commands(o);e.push({type:a.type(),point:F(t,a.point(),i.point()),control1:O(t,a.control1(),i.control1()),control2:O(t,a.control2(),i.control2())})}return e};function U(e,t,n,r){var o=N(n,r);o!=null||l(0,2829);var a=M(n,r,o);switch(a){case 0:return t(r.values(o));case 1:return t(r.values(o+1));default:return e(a,r.values(o),r.values(o+1))}}var V=U.bind(null,w,E),H=U.bind(null,A,T),G=U.bind(null,F,k),z=U.bind(null,B,I),j=U.bind(null,W,D),K=U.bind(null,q,$);function Q(e,t,n,r){if(t.keyframesLength())switch(P(e,t)){case-1:return r(t.values(0));case 1:return r(t.values(t.valuesLength()-1));case 0:return n(e,t)}return r(t.value())}var X=function(t,n){return Q(t,n,V,E)},Y=function(t,n){return Q(t,n,H,T)},J=function(t,n){return Q(t,n,G,k)},Z=function(t,n){return Q(t,n,z,I)},ee=function(t,n){return Q(t,n,j,D)},te=function(t,n){return Q(t,n,K,$)};function ne(e,t,n){return{x:u(e,t.x,n.x),y:u(e,t.y,n.y)}}function re(e,t,n,r){var o=e*e,a=1-e,i=a*a;return{x:c(e,o,a,i,t.x,r.x,n.x),y:c(e,o,a,i,t.y,r.y,n.y)}}function oe(e,t,n,r,o){var a=e*e,i=1-e,l=i*i;return{x:s(e,a,i,l,t.x,r.x,o.x,n.x),y:s(e,a,i,l,t.y,r.y,o.y,n.y)}}function ae(e,t,n){var r=M(e,t,n),o=t.value(),a=k(o.commands(n).point()),i=x(o.commands(n+1));switch(i.type){case g.LineTo:return ne(r,a,i.point);case g.QuadTo:return i.control1||l(0,2830),re(r,a,i.point,i.control1);case g.CubicTo:return i.control1&&i.control2||l(0,2831),oe(r,a,i.point,i.control1,i.control2);default:throw new Error("Unrecognized segment type "+i.type)}}function ie(e,t){switch(P(e,t)){case-1:return k(t.value().commands(0).point());case 1:var n=t.value();return k(n.commands(n.commandsLength()-1).point());default:var r=N(e,t);return r!=null||l(0,2832),ae(e,t,r)}}var le={maybeTweenPoint2:J,maybeTweenColor:Z,maybeTweenColorArray:ee,maybeTweenScalar:X,maybeTweenScalarArray:Y,maybeTweenPath:te,tweenPointOnPath:ie};a.exports=le}),null);
__d("KeyframesVideoManager",["KeyframesVideoUtils"],(function(t,n,r,o,a,i){"use strict";var e=.2,l=100,s=[.85,1.15];a.exports=(function(){function t(e){this.$1=e,this.$3=1/e.doc.frameRate(),this.$2=d(e.doc.rootLayer(),e),this.$4=this.$5()}var r=t.prototype;return r.getVideos=function(){return this.$1.videos},r.getTimeWindows=function(){return this.$2},r.forEach=function(t){this.getVideos().forEach(t)},r.pause=function(){this.forEach(function(e){e.pause()})},r.mute=function(){this.forEach(function(e){e.muted=!0})},r.unMute=function(){this.forEach(function(e){e.muted=!1})},r.renderProgress=function(n){var t=this;this.$2.forEach(function(r,o){var a=r.video,i=c(r,n),l=u(r,n),d=t.$1.doc.duration()*l,m=Math.abs(d-a.currentTime),p=t.$1.doc.duration()*(r.toProgress-r.fromProgress);if(m>e&&a.currentTime<p&&d<p){var _=(p-a.currentTime)/(p-d);_>=s[0]&&_<=s[1]&&t.changeVideoPlaybackRate(o,_)}i&&a.paused?a.play():i==!1&&a.paused==!1&&(a.pause(),a.currentTime=0)})},r.$5=function(){return this.$2.map(function(e){var t=e.video;return p(function(e){t.playbackRate=e},l,!0)})},r.changeVideoPlaybackRate=function(t,n){this.$4[t](n)},r.seekToProgress=async function(t){var e=this,r=this.$2.map(async function(r){var o=r.video,a=0;if(c(r,t)){var i=u(r,t);a=m(e.$1.doc.duration()*i)}o.pause(),o.currentTime=a,await n("KeyframesVideoUtils").loadVideo(o,a)});await Promise.all(r)},t})();function u(e,t){return t-e.fromProgress}function c(e,t){return t>=e.fromProgress&&t<=e.toProgress}function d(e,t){var n=[],r=e.videoIndex();if(r!=-1){var o=t.videos[r],a=t.doc.videos(r);o!=null&&n.push({fromProgress:e.fromProgress(),toProgress:e.toProgress(),name:a!=null?a.name():null,video:o})}for(var i=0;i<e.sublayersLength();i++)n=n.concat(d(e.sublayers(i),t));return n}function m(e){return Math.round(e*100)/100}function p(e,t,n){t===void 0&&(t=100),n===void 0&&(n=!1);var r;return function(){for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];var l=function(){r=null,n||e.apply(void 0,a)},s=n&&!r;clearTimeout(r),r=setTimeout(l,t),s&&e.apply(void 0,a)}}}),null);
__d("KeyframesRenderer",["invariant","ErrorGuard","KFLoaderUtils","KeyframesCanvasPolyfills","KeyframesCanvasPool","KeyframesCanvasUtils","KeyframesDimensions","KeyframesLoop","KeyframesTrackMattes","KeyframesTween","KeyframesVideoManager","gkx","nullthrows","performanceNow","promiseDone"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c,d=1,m={ERROR_FRAMEDROP:"ERROR_FRAMEDROP"},p=60,_=1e3/p,f=1,g="source-over";function h(e,t){return r("gkx")("21037")?(u||(u=r("ErrorGuard"))).guard(e,{name:t}):e}var y=(function(){function e(e,t){t===void 0&&(t=100),this.$3=!1,this.$4=0,this.$1=e,this.$2=t}var t=e.prototype;return t.callOrIgnoreThrottled=function(){if((c||(c=r("performanceNow")))()>=this.$4){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.$5(t)}else this.$3=!0},t.callIfIgnored=function(){if(this.$3){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.$5(t)}},t.callImmediately=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.$5(t)},t.resetThrottling=function(){this.$4=0},t.$5=function(t){this.$3=!1,this.$4=(c||(c=r("performanceNow")))()+this.$2,this.$1.apply(null,t)},e})();function C(e,t){if(e.pluginsLoader){e.pluginsLoader.instances.forEach(t);for(var n=e.subassets.length-1;0<=n;n--)C(e.subassets[n],t)}}function b(e,t,n,r){if(e.pluginsLoader){for(var o=e.pluginsLoader.instances.length-1;0<=o;o--)e.pluginsLoader.instances[o].animationWillRenderLayer(t,n,r);for(var a=e.subassets.length-1;0<=a;a--)b(e.subassets[a],t,n,r)}}function v(e,t,n,r){e.save(),e.beginPath(),e.arc(t,n,r,0,2*Math.PI,!0),e.closePath(),e.clip(),e.clearRect(t-r,n-r,r*2,r*2),e.restore()}function S(t,n,r,a){var i,l=(e||(e=o("KeyframesTween"))).maybeTweenPoint2(t,n.rampStart()),s=e.maybeTweenPoint2(t,n.rampEnd()),u=n.colors(),c=n.positions();if(u&&c?(u=(e||(e=o("KeyframesTween"))).maybeTweenColorArray(t,u),c=e.maybeTweenScalarArray(t,c)):(u=[(e||(e=o("KeyframesTween"))).maybeTweenColor(t,n.colorStart()),e.maybeTweenColor(t,n.colorEnd())],c=[0,1]),n.type()===d){var m=n.highlightLength();m=m!==null?(e||(e=o("KeyframesTween"))).maybeTweenScalar(t,m):0;var p=n.highlightAngle();p=p!==null?(e||(e=o("KeyframesTween"))).maybeTweenScalar(t,n.highlightAngle()):0;var _=l.x,f=l.y,g=Math.sqrt(Math.pow(l.x-s.x,2)+Math.pow(l.y-s.y,2)),h=Math.acos((s.x-_)/g),y=_+g*m*Math.cos(h-p),C=f-g*m*Math.sin(h-p),b=0;m!==0&&(r.clip(),r.fillStyle=o("KeyframesCanvasUtils").getCanvasStyle(u[u.length-1]),r.fill(),v(r,_,f,g)),i=r.createRadialGradient(y,C,b,_,f,g)}else i=r.createLinearGradient(l.x,l.y,s.x,s.y);for(var S=0,R=u.length;S<R;S++)i.addColorStop(c[S],o("KeyframesCanvasUtils").getCanvasStyle(u[S]));return i}function R(t,n,a,i,l,s,u,c,d){if(d===void 0&&(d=f),!(u<Math.max(s.fromProgress(),0)||u>Math.min(s.toProgress(),1))){try{c&&c.maybeInstantiatePluginsForLayer(s)}catch(e){}var m=t,p,_=s.isTrackMatte(),h=s.trackMatteType();if(_||h!==0){var y=m.getTransform();p=n.getCanvas(),p.ctx.setTransform(y.a,y.b,y.c,y.d,y.e,y.f),p.isTrackMatte=_,p.trackMatteType=h,p.ctx.globalCompositeOperation=g,m=p.ctx}m.save();var C=s.position();if(C){var b=(e||(e=o("KeyframesTween"))).tweenPointOnPath(u,C),v=b.x,L=b.y;m.translate(v,L)}else{var E=s.xPosition();E&&m.translate((e||(e=o("KeyframesTween"))).maybeTweenScalar(u,E),0);var k=s.yPosition();k&&m.translate(0,(e||(e=o("KeyframesTween"))).maybeTweenScalar(u,k))}var I=s.rotation();I&&m.rotate((e||(e=o("KeyframesTween"))).maybeTweenScalar(u,I));var T=s.scale();if(T){var D=(e||(e=o("KeyframesTween"))).maybeTweenPoint2(u,T),x=D.x,$=D.y;m.scale(x,$)}var P=s.anchorPoint();if(P){var N=(e||(e=o("KeyframesTween"))).maybeTweenPoint2(u,P),M=N.x,w=N.y;m.translate(-M,-w)}var A=s.opacity();A=A!=null?(e||(e=o("KeyframesTween"))).maybeTweenScalar(u,A):1,m.globalAlpha=A*d;var F=!1;if(c){var O=c.getPluginsForLayer(s.id());if(O)for(var B=0;B<O.length;B++)O[B].render(m,u),F=F||O[B].rendersLayer}if(s.clippingPath()&&(o("KeyframesCanvasUtils").drawPath(m,(e||(e=o("KeyframesTween"))).maybeTweenPath(u,s.clippingPath())),m.clip()),!F&&s.path()){o("KeyframesCanvasUtils").drawPath(m,(e||(e=o("KeyframesTween"))).maybeTweenPath(u,s.path()));var W=s.gradient(),q=s.fillColor(),U=!1,V=!1;if(W?(m.fillStyle=S(u,W,m),U=!0):q&&(m.fillStyle=o("KeyframesCanvasUtils").getCanvasStyle((e||(e=o("KeyframesTween"))).maybeTweenColor(u,q)),U=!0),s.strokeWidth()){var H=(e||(e=o("KeyframesTween"))).maybeTweenScalar(u,s.strokeWidth());H>0&&(m.strokeStyle=o("KeyframesCanvasUtils").getCanvasStyle((e||(e=o("KeyframesTween"))).maybeTweenColor(u,s.strokeColor())),m.lineJoin=o("KeyframesCanvasUtils").LINE_JOINS[s.strokeLineJoin()],m.lineCap=o("KeyframesCanvasUtils").getCanvasLineCap(s.strokeLineCap()),m.lineWidth=H,V=!0)}s.vectorCompositeOrder()===0?(U&&m.fill(),V&&m.stroke()):(V&&m.stroke(),U&&m.fill())}var G=s.bitmapIndex(),z=a[G];z&&z.width!==0&&z.height!==0&&m.drawImage(z,0,0);var j=s.videoIndex(),K=i[j];K!=null&&m.drawImage(K,0,0,K.width,K.height);var Q=s.subdocumentIndex();if(l[Q]){var X=l[Q].doc.size();m.save(),m.beginPath(),m.rect(0,0,X.width(),X.height()),m.clip(),R(m,n,l[Q].bitmaps,l[Q].videos,l[Q].subassets,l[Q].doc.rootLayer(),u-s.progressOffset(),l[Q].pluginsLoader,A*d),m.restore()}for(var Y,J,Z=0;Z<s.sublayersLength();Z++){var ee=R(m,n,a,i,l,s.sublayers(Z),u,c,A*d);if(!Y&&ee&&ee.trackMatteType!==void 0)Y=ee;else if(Y&&ee&&ee.isTrackMatte!==void 0){var te=m.getTransform();m.setTransform(1,0,0,1,0,0),Y.ctx.setTransform(1,0,0,1,0,0),J=ee,Y.ctx.globalCompositeOperation=r("KeyframesTrackMattes")[Y.trackMatteType===void 0?1:Y.trackMatteType],Y.ctx.drawImage(J.canvas,0,0),m.drawImage(Y.canvas,0,0),m.setTransform(te.a,te.b,te.c,te.d,te.e,te.f),Y=void 0,J=void 0}else Y&&!ee?(m.drawImage(Y.canvas,0,0),Y=void 0,J=void 0):ee&&ee.isTrackMatte!==void 0&&(Y=void 0,J=void 0)}return m.restore(),p}}var L=(function(){function e(e,t){var n=this;this.$5=0,this.$6=0,this.$8=!1,this.$9=!1,this.$10=!1,this.$11=0,this.$16=!1,this.$17=0,this.$18=1,this.$19=1,this.$21=1,this.$22=0,this.$26=function(e){(n.$12||n.$15)&&n.$34(e),n.$16?(n.$10&&n.$32(),n.$24.renderProgress(n.$11),n.$33(n.$11),n.$11+=e/n.$5,n.$14&&n.$14.callOrIgnoreThrottled(n.$17),n.$11>=n.$21&&(n.$11%=n.$21,n.$19=Math.max(0,n.$19-1),n.$15&&n.$15.finish(),n.$19===0?n.pause():(n.$24.seekToProgress(0),n.$15&&n.$15.start(),n.$11+=n.$22),n.$13&&n.$13(n.$19),n.$30())):n.redrawIfNeeded()},this.$33=h(function(e){e>=0&&e<=1||s(0,750,e),this.$3.clearRect(0,0,this.$23.width.intrinsic,this.$23.height.intrinsic),this.$1.pluginsLoader&&b(this.$1,e,this.$16,this.$8),this.$4.clearAllAllocated(),this.$4.freeAll(),R(this.$3,this.$4,this.$1.bitmaps,this.$1.videos,this.$1.subassets,this.$20,e,this.$1.pluginsLoader),this.$17=e,this.$9=!1,this.$15&&this.$15.addFrame()},"KeyframesRenderer: _renderProgress()"),this.$32=h(function(){this.$2.width=this.$23.width.physical,this.$2.height=this.$23.height.physical,this.$2.style.width=this.$23.width.logical+"px",this.$2.style.height=this.$23.height.logical+"px",this.$3.setTransform(1,0,0,1,0,0),this.$3.scale(this.$23.width.getPhysicalChangeRatio(),this.$23.height.getPhysicalChangeRatio()),this.$4.resizeAll(),this.$10=!1,this.$9=!0},"KeyframesRenderer: _resize()"),this.$23=new(r("KeyframesDimensions"))(e.doc.size().width(),e.doc.size().height()),this.$4=new(r("KeyframesCanvasPool"))(this.$23),this.$2=document.createElement("canvas"),this.$3=r("nullthrows")(this.$2.getContext("2d")),o("KeyframesCanvasPolyfills").addGetTransformPolyfill(this.$3),this.$7=new(r("KeyframesLoop"))(this.$26),this.$15=t,this.$24=new(r("KeyframesVideoManager"))(e),this.setDecodedAsset(e),this.$27(),this.$25=Promise.resolve()}var t=e.prototype;return t.play=function(){return this.$16||(this.$16=!0,this.isFinished()&&(this.$19=this.$18,this.$11=this.$22),this.$15&&this.$15.start(),this.$7.start()),this},t.pause=function(){return this.$16&&(this.$16=!1,this.$15&&this.$15.pause(),this.$9?this.$28():(this.$7.cancel(),this.$14&&this.$14.callIfIgnored(this.$17))),this.$24.pause(),this.$29(this.$24.seekToProgress(this.$17)),b(this.$1,this.$17,this.$16,this.$8),this},t.isPlaying=function(){return this.$16},t.isFinished=function(){return this.$19===0},t.isMuted=function(){return this.$8},t.mute=function(){this.$8=!0,this.$24.mute()},t.unMute=function(){this.$8=!1,this.$24.unMute()},t.repeatCount=function(t){return this.$18=this.$19=Math.max(1,t),this},t.repeatForever=function(){return this.repeatCount(1/0)},t.getRepeatsRemaining=function(){return this.$19},t.seekToProgress=function(t){var e=this;return t>=0&&t<=1||s(0,749,t),this.$14&&this.$14.resetThrottling(),this.$17=this.$11=t,this.$29(this.$24.seekToProgress(t).then(function(){return e.$28()})),t===0&&this.$30(),this.$28(),this},t.setStartAndEndAt=function(t,n){if(t>=n)throw new Error("Cannot set the start time before the end time.");if(n<=t)throw new Error("Cannot set the end time before the start time.");return this.$22=t,this.$21=n,this},t.setStartAt=function(t){if(t>=this.$21)throw new Error("Cannot set the start time before the end time.");return this.$22=t,this},t.setEndAt=function(t){if(t<=this.$22)throw new Error("Cannot set the end time before the start time.");return this.$21=t,this},t.getDuration=function(){return this.$5},t.getFrameRate=function(){return this.$6},t.getIntrinsicSize=function(){return[this.$23.width.intrinsic,this.$23.height.intrinsic]},t.getWidth=function(){return this.$23.width.logical},t.getHeight=function(){return this.$23.height.logical},t.setWidth=function(t){return this.$23.setWidth(t),this.$27(),this},t.setHeight=function(t){return this.$23.setHeight(t),this.$27(),this},t.getDecodedAsset=function(){return babelHelpers.extends({},this.$1)},t.setDecodedAsset=function(t){return this.$1=t,this.$5=r("KFLoaderUtils").getDocumentDuration(t.doc),this.$6=t.doc.frameRate(),this.$20=t.doc.rootLayer(),this.$24=new(r("KeyframesVideoManager"))(t),this.$28(),this.$31(),this},t.resetDimensions=function(){return this.$23.reset(),this.$27(),this},t.onError=function(t){return this.$12=t,this},t.onRepeatEnd=function(t){return this.$13=t,this},t.onProgress=function(t,n){return this.$14=t&&new y(t,n),this},t.getProgress=function(){return this.$17},t.getElement=function(){return this.$2},t.hasPerformanceLogging=function(){return!!this.$15},t.redrawIfNeeded=function(){return(this.$10||this.$9)&&(this.$10&&this.$32(),this.$9&&this.$33(this.$17),this.$14&&this.$14.callImmediately(this.$17)),this},t.waitForVideoUpdate=async function(){await this.$25},t.$29=function(t){this.$25=t,r("promiseDone")(t)},t.$27=function(){this.$10=!0,this.$28()},t.$28=function(){this.$9=!0,this.$7.isRunning()||this.$7.start(1)},t.$31=function(){C(this.$1,function(e){return e.animationDidLoad()})},t.$30=function(){var e=this;C(this.$1,function(t){return t.animationWillRepeat(e.$11,e.$19)})},t.$34=function(t){var e=Math.round(t/_-1);e>0&&(this.$15&&this.$15.addFrameDrop(e),this.$12&&this.$12(m.ERROR_FRAMEDROP,e))},e})();i.exports=L}),34);
__d("requestIdleCallbackComet",["IdleCallbackImplementation"],(function(t,n,r,o,a,i,l){"use strict";var e=t.requestIdleCallback||o("IdleCallbackImplementation").requestIdleCallback;function s(n,r){return e.call(t,n,r)}l.default=s}),98);
__d("requestIdleCallbackWWW",["cr:694370"],(function(t,n,r,o,a,i,l){l.default=n("cr:694370")}),98);/*FB_PKG_DELIM*/
__d("AutoplayRulesEngine",[],(function(t,n,r,o,a,i){"use strict";var e=-2,l=-1,s=(function(){function t(t){this.$1=e,this.$2=t}var n=t.prototype;return n.evaluateAutoplay=function(t,n){var e=n(),r=l;if(t)for(var o=0;o<this.$2.length;o++){var a=this.$2[o](t);if(a!=="SKIP"){e=a,r=o;break}}return this.$1=r,e},n.getIndexOfLastWinningRule=function(){return this.$1},n.getRules=function(){return this.$2},t})();i.default=s}),66);
__d("CVCv3DisabledPlayerOrigins",[],(function(t,n,r,o,a,i){var e=Object.freeze({BEEPER:"beeper",FB_STORIES:"fb_stories"});i.default=e}),66);
__d("CVCv3DisabledPlayerSubOrigins",[],(function(t,n,r,o,a,i){var e=Object.freeze({LIVE_BEEPER:"live_beeper"});i.default=e}),66);
__d("CvcV3HttpEventFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("1856513"),s=o("FalcoLoggerInternal").create("cvc_v3_http_event",e),u=s;l.default=u}),98);
__d("CVCv3SubscriptionHelper",["CvcV3HttpEventFalcoEvent","DateConsts","guid"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e,t,n){this.$1=e,this.$2=r("guid")(),this.$3=(t!=null?t:"null")+"::"+(n!=null?n:"null"),this.$4=null,this.$5=null}var t=e.prototype;return t.isValidSubscription=function(){return!!this.$1},t.makeCVCv3StateUpdate=function(t,n,r,a){var e=null;t!=null&&!Number.isNaN(t)&&n!=null&&!Number.isNaN(n)&&(e={m:a,pf:Math.floor((n-t)*o("DateConsts").MS_PER_SEC),s:r,sa:Math.floor(t*o("DateConsts").MS_PER_SEC)});var i={pps:this.$4,ps:e,si:this.$2,so:this.$3,vi:this.$1};return this.$4=e,i},t.makeUnifiedVideoCVCUpdate=function(t,n,r,o,a){var e=this.makeCVCv3StateUpdate(t,n,r,o);return this.$5!=null&&(e.tk=this.$5),babelHelpers.extends({},e,a)},t.processUnifiedResponse=function(t){var e=t;return this.$5=e.tk,e},t.clearAnyPreviousContext=function(){this.$4=null},t.logHttpRequestSuccess=function(t){var e=this;r("CvcV3HttpEventFalcoEvent").log(function(){return{name:"http_request_success",duration_ms:t!=null?t.toString():null,countable_id:e.$1}})},t.logHttpRequestFailure=function(t,n){var e=this;r("CvcV3HttpEventFalcoEvent").log(function(){return{name:"http_request_failed",error_msg:t,duration_ms:n!=null?n.toString():null,countable_id:e.$1}})},t.logHttpRequestTimeout=function(t){var e=this;r("CvcV3HttpEventFalcoEvent").log(function(){return{name:"http_request_timeout",duration_ms:t!=null?t.toString():null,countable_id:e.$1}})},t.logHttpResponseBad=function(t,n){var e=this;r("CvcV3HttpEventFalcoEvent").log(function(){return{name:"http_response_bad",error_msg:t,duration_ms:n!=null?n.toString():null,countable_id:e.$1}})},t.logDebugInfo=function(t){var e=this;r("CvcV3HttpEventFalcoEvent").log(function(){return{name:t,countable_id:e.$1}})},e})();l.default=e}),98);
__d("CometAudioManagerHooks",["CometAudioManagerContexts","FBLogger","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useContext;function u(){var e=s(o("CometAudioManagerContexts").AudioApiContext);return e}l.useAudioApi=u}),98);
__d("makeAudioSymbol",[],(function(t,n,r,o,a,i){"use strict";function e(e,t){return t+"::"+e}i.default=e}),66);
__d("CoreVideoPlayerAudioClient.react",["CometAudioManagerContexts","CometAudioManagerHooks","CometThrottle","VideoPlayerHooks","VideoPlayerPortalingPlaceInfoProvider.react","createVideoStateHook","makeAudioSymbol","react","react-compiler-runtime","usePrevious"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=e||(e=o("react")),c=u.useContext,d=u.useEffect,m=u.useId,p=u.useMemo,_=u.useRef,f=u.useState,g=o("createVideoStateHook").createVideoStateHook(),h=g.stateHook,y=.01;function C(){var e=o("react-compiler-runtime").c(5),t=(s||(s=o("VideoPlayerHooks"))).useController(),n;e[0]!==t?(n=function(){return t.getCurrentState().volume},e[0]=t,e[1]=n):n=e[1];var r=f(n),a=r[0],i=r[1],l,u;return e[2]!==t?(l=function(){var e=t.subscribe(function(){var e=t.getCurrentState().volume;i(function(t){return e===0||e===1||Math.abs(t-e)>y?e:t})});return i(t.getCurrentState().volume),(function(){e.remove()})},u=[t],e[2]=t,e[3]=l,e[4]=u):(l=e[3],u=e[4]),d(l,u),a}function b(){"use no memo";var e=h(!1),t=e[0],n=e[1],a=m(),i=(s||(s=o("VideoPlayerHooks"))).useInstanceKey(),l=p(function(){return r("makeAudioSymbol")(a,i)},[a,i]),u=o("CometAudioManagerHooks").useAudioApi(),g=_(u);d(function(){g.current=u},[u]);var y=s.useController(),b=s.useLastPlayReason(),v=s.useLastMuteReason(),S=s.useMuted(),R=C(),L=r("usePrevious")(R),E=s.usePaused(),k=c(o("CometAudioManagerContexts").CometAudioLocalScopeContext),I=c(o("CometAudioManagerContexts").CometAudioGroupContext),T=o("VideoPlayerPortalingPlaceInfoProvider.react").useVideoPlayerPortalingPlaceInfo(),D=s.useVolumeSetting(),x=p(function(){return(I==null?void 0:I.groupID)||o("CometAudioManagerContexts").makeAudioGroupID()},[I==null?void 0:I.groupID]),$=f(!0),P=$[0],N=$[1],M=_(!0),w=_(null),A=f(function(){return r("CometThrottle")(function(e){g.current&&g.current.update(e)},50,{leading:!0,trailing:!0})}),F=A[0],O=p(function(){return{audioLocalScope:k,controller:y,groupID:x,instanceKey:i,lastMuteReason:v,lastPlayReason:b,muted:S,paused:E,previousVolume:L,symbol:l,videoPlayerPortalingPlaceInfo:T,volume:R}},[k,y,x,i,v,b,S,E,L,l,T,R]);d(function(){if(D!=null&&!t){var e=w.current!==D;(M.current||e)&&(M.current=!1,w.current=D,y.setVolume(D),n(!0))}},[y,t,n,D]);var B=p(function(){return I||{allowSound:P,groupID:x,setAllowSound:N}},[I,P,x,N]),W=_(B),q=_(!1);d(function(){if(u&&!q.current){q.current=!0;try{u.register(O,W.current)}finally{q.current=!1}}return function(){u&&u.unregister(l,x)}},[u,O,x,l]),d(function(){u&&F(O)},[u,O,F]),d(function(){return function(){F&&F.cancel&&F.cancel()}},[F]);var U=_(!1),V=_(null);return d(function(){var e=V.current!==P;if(!P&&g.current&&!U.current&&e){U.current=!0;try{y.setMuted(!0,"audio_manager_initiated"),V.current=P}finally{U.current=!1}}},[P,y]),null}l.default=b}),98);
__d("VideoPlayerAutoplayHooks",["FBLogger","VideoPlayerAutoplayContexts","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useContext;function u(){var e=s(o("VideoPlayerAutoplayContexts").AutoplayApiContext);if(e==null)throw r("FBLogger")("comet_video_player").mustfixThrow("Empty AutoplayApiContext. Are you rendering useAutoplayApi outside of VideoAutoplayManagerX?");return e}function c(){return s(o("VideoPlayerAutoplayContexts").VideoAutoplayLocalScopeContext)}l.useAutoplayApi=u,l.useVideoAutoplayLocalScope=c}),98);
__d("VideoPlayerDebugAutoplayAPI",["cr:1453865","emptyFunction"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e=n("cr:1453865"))!=null?e:{useVideoPlayerDebugAPI:r("emptyFunction").thatReturns(null),useVideoPlayerDebugAPIDefinition:r("emptyFunction"),useVideoPlayerDebugInfo:r("emptyFunction").thatReturns(null)};l.default=s}),98);
__d("evaluateVideoAutoplayDefaultAllowRule",[],(function(t,n,r,o,a,i){"use strict";function e(){return"ALLOW"}e.displayName="evaluateVideoAutoplayDefaultRule",i.default=e}),66);
__d("makeSelectedAutoplayVideoSymbol",[],(function(t,n,r,o,a,i){"use strict";function e(e,t){return t+"::"+e}i.default=e}),66);
__d("useAutoplayRulesEngine",["AutoplayRulesEngine","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.useEffect,c=s.useRef,d=s.useState;function m(e){var t=o("react-compiler-runtime").c(8),n=c(e),a;t[0]!==e?(a=function(){return new(r("AutoplayRulesEngine"))(e)},t[0]=e,t[1]=a):a=t[1];var i=d(a),l=i[0],s=i[1],m,p;t[2]!==e?(m=function(){n.current!==e&&s(function(){return new(r("AutoplayRulesEngine"))(e)})},p=[e],t[2]=e,t[3]=m,t[4]=p):(m=t[3],p=t[4]),u(m,p);var _,f;return t[5]!==l?(_=function(){n.current=l.getRules()},f=[l],t[5]=l,t[6]=_,t[7]=f):(_=t[6],f=t[7]),u(_,f),l}l.default=m}),98);
__d("VideoPlayerViewabilityHooks",["VideoPlayerHooks"],(function(t,n,r,o,a,i,l){"use strict";var e;l.useVideoPlayerExtendedPassiveViewabilityInfo=(e||(e=o("VideoPlayerHooks"))).useVideoPlayerExtendedPassiveViewabilityInfo,l.useVideoPlayerPassiveViewabilityInfo=e.useVideoPlayerPassiveViewabilityInfo,l.useVideoPlayerViewabilityInfo=e.useVideoPlayerViewabilityInfo}),98);
__d("useVideoPlayerBandwidthEstimate",["VideoPlayerOzWWWGlobalConfig","oz-player/networks/OzBandwidthEstimator","react","react-compiler-runtime","useInterval"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useState,u=5e3;function c(){var e=o("react-compiler-runtime").c(2),t=d,n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=t(),e[0]=n):n=e[0];var a=s(n),i=a[0],l=a[1],c;return e[1]===Symbol.for("react.memo_cache_sentinel")?(c=function(){return l(t())},e[1]=c):c=e[1],r("useInterval")(c,u),i}function d(){return r("oz-player/networks/OzBandwidthEstimator").getBandwidth(r("VideoPlayerOzWWWGlobalConfig"))}l.default=c}),98);
__d("useVideoAutoplayState",["HiddenSubtreePassiveContext","VideoPlayerHooks","VideoPlayerShakaGlobalConfig","VideoPlayerViewabilityHooks","react","useIsBackgrounded","useVideoPlayerBandwidthEstimate"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=e||(e=o("react")),c=u.startTransition,d=u.useContext,m=u.useEffect,p=u.useMemo,_=u.useRef,f=u.useState;function g(e){"use no memo";var t=(s||(s=o("VideoPlayerHooks"))).useAdClientToken(),n=s.useAutoplayGatingResult(),a=s.useBroadcastStatus(),i=s.useEnded(),l=s.useIsFrozenPassive(),u=s.useLastPauseReason(),g=s.useLastPlayReason(),h=s.useMuted(),y=s.usePaused(),C=d(r("HiddenSubtreePassiveContext")),b=!t,v=(e==null?void 0:e.noPauseOnBlurOrFocus)===!0||o("VideoPlayerShakaGlobalConfig").getBool("comet_www_no_pause_on_blur_or_focus_events",!1),S=r("useIsBackgrounded")({noPauseOnBlurOrFocus:v,scrollTerminatesHiddenOrBlurred:b}),R=S.isDocumentHidden,L=S.isDocumentHiddenOrBlurred,E=r("useVideoPlayerBandwidthEstimate")(),k=o("VideoPlayerViewabilityHooks").useVideoPlayerPassiveViewabilityInfo(),I=o("VideoPlayerViewabilityHooks").useVideoPlayerExtendedPassiveViewabilityInfo(),T=f(C.getCurrentState().backgrounded),D=T[0],x=T[1],$=f(C.getCurrentState().hidden),P=$[0],N=$[1];m(function(){var e=function(){c(function(){var e=C.getCurrentState();N(e.hidden),x(e.backgrounded)})},t=C.subscribeToChanges(e);return e(),function(){t.remove()}},[C,x,N]);var M=f(function(){return l.getCurrentState()}),w=M[0],A=M[1];m(function(){var e=l.subscribeToChanges(function(e){A(e)}),t=l.getCurrentState();return A(t),function(){e.remove()}},[l,A]);var F=p(function(){return{adClientToken:t,autoplayGatingResult:n,bandwidthEstimate:E,broadcastStatus:a,controllerIsFrozen:w,currentSubtreeIsBackgrounded:D,currentSubtreeIsHidden:P,ended:i,hiddenSubtreePassive:C,isDocumentHidden:R,isDocumentHiddenOrBlurred:L,isFrozenPassive:l,lastPauseReason:u,lastPlayReason:g,muted:h,paused:y,videoPlayerExtendedPassiveViewabilityInfo:I,videoPlayerPassiveViewabilityInfo:k}},[t,n,E,a,w,D,P,i,C,R,L,l,u,g,h,y,I,k]),O=f(F),B=O[0],W=O[1],q=_(B);return m(function(){q.current=B},[B]),m(function(){var e=!1,t=Object.keys(F);for(var n of t)if(F[n]!==q.current[n]){e=!0;break}e&&W(F)},[F,W]),B}l.default=g}),98);
__d("CoreVideoPlayerAutoplayClient.react",["CoreVideoPlayerAutoplayClientUtils","HiddenSubtreePassiveContext","VideoPlayerAutoplayHooks","VideoPlayerDebugAutoplayAPI","VideoPlayerHooks","VideoPlayerViewabilityConstants","WwwCometVideoAutoplayFalcoEvent","evaluateVideoAutoplayDefaultAllowRule","evaluateVideoAutoplayDefaultIgnoreRule","makeSelectedAutoplayVideoSymbol","react","react-compiler-runtime","useAutoplayRulesEngine","useConcurrentAutoplayManagementAPI","useVideoAutoplayState"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=e||(e=o("react")),c=u.useCallback,d=u.useContext,m=u.useEffect,p=u.useId,_=u.useMemo,f=u.useRef,g=u.useState;function h(){var e=o("react-compiler-runtime").c(70),t=p(),n=(s||(s=o("VideoPlayerHooks"))).useCanAutoplay(),a=s.useInstanceKey(),i;e[0]!==t||e[1]!==a?(i=r("makeSelectedAutoplayVideoSymbol")(t,a),e[0]=t,e[1]=a,e[2]=i):i=e[2];var l=i,u=f(l),c,_;e[3]!==l?(c=function(){u.current=l},_=[l],e[3]=l,e[4]=c,e[5]=_):(c=e[4],_=e[5]),m(c,_);var h=d(r("HiddenSubtreePassiveContext")),y=s.useController(),C=f(!1),b=o("useConcurrentAutoplayManagementAPI").useAutoplayControlID(),v,S;e[6]!==b||e[7]!==y?(v=function(){o("CoreVideoPlayerAutoplayClientUtils").log(u.current,"[ASSUME CONTROL] "+b),y.registerControllingComponent(b)},S=[y,b],e[6]=b,e[7]=y,e[8]=v,e[9]=S):(v=e[8],S=e[9]),m(v,S);var R=s.useVideoPlayerPassiveViewabilityInfo(),L=s.usePaused(),E=f(L),k=o("VideoPlayerAutoplayHooks").useVideoAutoplayLocalScope(),I=f(k),T,D;e[10]!==k?(T=function(){I.current=k},D=[k],e[10]=k,e[11]=T,e[12]=D):(T=e[11],D=e[12]),m(T,D);var x;e[13]!==y||e[14]!==R?(x=function(){var e=y.getCurrentState(),t=e.lastPlayReason,n=e.paused,o=E.current;E.current=n;var a=R==null?void 0:R.getCurrent();if(a){var i=a.visiblePercentage,l=!n&&n!==o,s=i<r("VideoPlayerViewabilityConstants").DEFAULT_VIEWABILITY_PERCENTAGE_FOR_PAUSE&&i>0;I.current.disableScrollBeforePlayWhenOffscreen!==!0&&l&&t==="user_initiated"&&s&&(C.current=!0)}},e[13]=y,e[14]=R,e[15]=x):x=e[15];var $=x,P=f($),N,M;e[16]!==$?(N=function(){P.current=$},M=[$],e[16]=$,e[17]=N,e[18]=M):(N=e[17],M=e[18]),m(N,M);var w,A;e[19]!==y||e[20]!==$?(w=function(){var e=y.subscribe(function(){$()});return(function(){e.remove()})},A=[y,$],e[19]=y,e[20]=$,e[21]=w,e[22]=A):(w=e[21],A=e[22]),m(w,A);var F;e[23]!==k.noPauseOnBlurOrFocus?(F={noPauseOnBlurOrFocus:k.noPauseOnBlurOrFocus},e[23]=k.noPauseOnBlurOrFocus,e[24]=F):F=e[24];var O=r("useVideoAutoplayState")(F),B=r("useAutoplayRulesEngine")(k.autoplayLocalRules),W=r(n==="allow"?"evaluateVideoAutoplayDefaultAllowRule":"evaluateVideoAutoplayDefaultIgnoreRule"),q;e[25]!==W?(q=function(){return W},e[25]=W,e[26]=q):q=e[26];var U=g(q),V=U[0],H=U[1],G=g(null),z=G[0],j=G[1],K;e[27]!==B||e[28]!==W||e[29]!==O?(K=function(){return B.evaluateAutoplay(O,W)},e[27]=B,e[28]=W,e[29]=O,e[30]=K):K=e[30];var Q=g(K),X=Q[0],Y=Q[1],J=g(null),Z=J[0],ee=J[1],te=f(X),ne=o("VideoPlayerAutoplayHooks").useAutoplayApi(),re=f(ne),oe,ae;e[31]!==ne?(oe=function(){re.current=ne},ae=[ne],e[31]=ne,e[32]=oe,e[33]=ae):(oe=e[32],ae=e[33]),m(oe,ae);var ie=n!=="dangerously_disable_autoplay_management",le,se;e[34]!==ne||e[35]!==k||e[36]!==y||e[37]!==h||e[38]!==a||e[39]!==ie||e[40]!==l?(le=function(){return ne.register(l,a,k,y,h,ie),r("WwwCometVideoAutoplayFalcoEvent").log(function(){return{autoplay_event_name:"register",autoplay_scope_id:I.current.autoplayScopeID,event_creation_time:Date.now(),initiator:u.current,initiator_type:"autoplay_component",selected_autoplay_video_symbol:ne.getAutoplayManagerDebugInfo(I.current).selectedAutoplayVideoSymbol,target:u.current,target_current_autoplay_decision:te.current}}),(function(){ne.unregister(l),r("WwwCometVideoAutoplayFalcoEvent").log(function(){return{autoplay_event_name:"unregister",autoplay_scope_id:I.current.autoplayScopeID,event_creation_time:Date.now(),initiator:u.current,initiator_type:"autoplay_component",selected_autoplay_video_symbol:ne.getAutoplayManagerDebugInfo(I.current).selectedAutoplayVideoSymbol,target:u.current,target_current_autoplay_decision:te.current}})})},se=[ne,k,y,h,a,ie,l],e[34]=ne,e[35]=k,e[36]=y,e[37]=h,e[38]=a,e[39]=ie,e[40]=l,e[41]=le,e[42]=se):(le=e[41],se=e[42]),m(le,se);var ue,ce;e[43]!==ne||e[44]!==b||e[45]!==B||e[46]!==y||e[47]!==W||e[48]!==h||e[49]!==z||e[50]!==Z||e[51]!==l||e[52]!==O||e[53]!==R?(ue=function(){var e=function(){var e=B.evaluateAutoplay(O,W);te.current=e;var t=B.getRules(),n=B.getIndexOfLastWinningRule(),a=n>=0?t[n]:W,i=R&&R.getCurrent(),s=y.getCurrentState(),c=s.paused;if((Z===null||Z!==e)&&(Y(e),ee(e)),e==="PAUSE"&&!c&&y.isControllingComponent(b)){var d=!0;if(P.current(),C.current){C.current=!1;var m=i==null?void 0:i.positionToViewport;m&&y.scrollIntoView(m.top<0),d=!1}if(d){var p="[PAUSE] via short-circuit on "+(a.displayName||a.name)+".";o("CoreVideoPlayerAutoplayClientUtils").log(u.current,p),y.pause("autoplay_initiated"),r("WwwCometVideoAutoplayFalcoEvent").log(function(){return{autoplay_event_name:"pause",autoplay_scope_id:I.current.autoplayScopeID,event_creation_time:Date.now(),initiator:u.current,initiator_type:"autoplay_component",selected_autoplay_video_symbol:ne.getAutoplayManagerDebugInfo(I.current).selectedAutoplayVideoSymbol,target:u.current,target_current_autoplay_decision:e}})}}(z===null||z!==a)&&(H(function(){return a}),j(function(){return a}),r("WwwCometVideoAutoplayFalcoEvent").log(function(){return{autoplay_event_name:"rule_changed",autoplay_scope_id:I.current.autoplayScopeID,event_creation_time:Date.now(),initiator:u.current,initiator_type:"autoplay_component",selected_autoplay_video_symbol:ne.getAutoplayManagerDebugInfo(I.current).selectedAutoplayVideoSymbol,target:u.current,target_current_autoplay_decision:e}})),o("CoreVideoPlayerAutoplayClientUtils").log(u.current,"[DECISION: "+e+"] from "+(a.displayName||a.name)),i&&ne.update(l,e,i)},t=h.subscribeToChanges(function(e){h.getCurrentState().hidden||h.getCurrentState().backgrounded?y.isControllingComponent(b)||y.unregisterControllingComponent(b):y.registerControllingComponent(b)}),n=R?R.subscribe(function(){h.getCurrentState().hidden||h.getCurrentState().backgrounded?y.isControllingComponent(b)||y.unregisterControllingComponent(b):y.registerControllingComponent(b),e()}):null;return e(),(function(){t.remove(),n&&n.remove()})},ce=[ne,b,B,y,W,h,z,Z,H,Y,j,ee,l,O,R],e[43]=ne,e[44]=b,e[45]=B,e[46]=y,e[47]=W,e[48]=h,e[49]=z,e[50]=Z,e[51]=l,e[52]=O,e[53]=R,e[54]=ue,e[55]=ce):(ue=e[54],ce=e[55]),m(ue,ce);var de,me;e[56]!==b||e[57]!==X||e[58]!==y?(de=function(){var e=y.isControllingComponent(b),t=y.getCurrentState(),n=t.paused;o("CoreVideoPlayerAutoplayClientUtils").componentShouldPause(X,te.current,n,e)&&(o("CoreVideoPlayerAutoplayClientUtils").log(u.current,"[PAUSE] the video for "+X),y.pause("autoplay_initiated"),r("WwwCometVideoAutoplayFalcoEvent").log(function(){return{autoplay_event_name:"pause",autoplay_scope_id:I.current.autoplayScopeID,event_creation_time:Date.now(),initiator:u.current,initiator_type:"autoplay_component",selected_autoplay_video_symbol:re.current.getAutoplayManagerDebugInfo(I.current).selectedAutoplayVideoSymbol,target:u.current,target_current_autoplay_decision:X}}))},me=[X,y,b],e[56]=b,e[57]=X,e[58]=y,e[59]=de,e[60]=me):(de=e[59],me=e[60]),m(de,me);var pe,_e;e[61]!==b||e[62]!==y?(pe=function(){return(function(){o("CoreVideoPlayerAutoplayClientUtils").log(u.current,"[RELEASE CONTROL] "+b),y.unregisterControllingComponent(b)})},_e=[y,b],e[61]=b,e[62]=y,e[63]=pe,e[64]=_e):(pe=e[63],_e=e[64]),m(pe,_e);var fe;return e[65]!==V||e[66]!==X||e[67]!==k||e[68]!==l?(fe={applicableRule:V,autoplayApiRef:re,autoplayDecision:X,autoplayLocalScope:k,symbol:l},e[65]=V,e[66]=X,e[67]=k,e[68]=l,e[69]=fe):fe=e[69],r("VideoPlayerDebugAutoplayAPI").useVideoPlayerDebugAPIDefinition(fe),null}l.default=h}),98);
__d("normalizeVideoPlayerLoopCount",["FBLogger"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){t===void 0&&(t=null),n===void 0&&(n=null);var o=0;if(e==null){var a=t!=null&&t&&n!=null?n:0;a===-1?o=-1:a<0||!Number.isFinite(a)||Math.floor(a)!==a?o=0:a===0&&t===!0?o=-1:o=a}else if(e===-1||e===Number.POSITIVE_INFINITY)o=-1;else{if(e<0||!Number.isFinite(e)||Math.floor(e)!==e)throw r("FBLogger")("comet_video_player").mustfixThrow("Invalid loopingCount: %s",e);o=e}return o}l.default=e}),98);
__d("CoreVideoPlayerMetaData",["VideoPlayerAudioAvailabilityInfo","normalizeVideoPlayerLoopCount"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return e!=null&&isFinite(e)&&e>0?e:0}var s=[];function u(t){var n,a,i,l,u=t.sideLoadCaptionsExpected===!0||t.sideLoadCaptionsUrl!=null,c=t.isLiveStreaming===!0;return babelHelpers.extends({},t,{audioAvailabilityInfo:(n=t.audioAvailabilityInfo)!=null?n:o("VideoPlayerAudioAvailabilityInfo").VideoPlayerAudioAvailabilityInfoDefault,autoplayGatingResult:t.autoplayGatingResult!=null?t.autoplayGatingResult:"unknown",canAutoplay:t.canAutoplay!=null?t.canAutoplay:"allow",desiredLatencyMs:(a=t.desiredLatencyMs)!=null?a:0,inbandCaptionsExpected:c,initialRepresentationIds:(i=t.initialRepresentationIds)!=null?i:s,isNCSR:!!t.isNCSR,isPremiumMusicVideo:!!t.isPremiumMusicVideo,latencyToleranceMs:(l=t.latencyToleranceMs)!=null?l:0,loopCount:r("normalizeVideoPlayerLoopCount")(t.loopCount),sideLoadCaptionsExpected:u,startTimestamp:e(t.startTimestamp)})}l.applyDefaultsToCoreVideoPlayerMetaData=u}),98);
__d("VideoPlayerViewabilityProvider.react",["VideoPlayerViewabilityContexts","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){var t=o("react-compiler-runtime").c(9),n=e.children,r=e.isDesktopPictureInPicture,a=e.isFullscreen,i=e.videoPlayerPassiveViewabilityInfo,l;t[0]!==n||t[1]!==a?(l=s.jsx(o("VideoPlayerViewabilityContexts").VideoPlayerFullscreenContext.Provider,{value:a,children:n}),t[0]=n,t[1]=a,t[2]=l):l=t[2];var u;t[3]!==r||t[4]!==l?(u=s.jsx(o("VideoPlayerViewabilityContexts").VideoPlayerDesktopPictureInPictureContext.Provider,{value:r,children:l}),t[3]=r,t[4]=l,t[5]=u):u=t[5];var c;return t[6]!==u||t[7]!==i?(c=s.jsx(o("VideoPlayerViewabilityContexts").VideoPlayerPassiveViewabilityInfoContext.Provider,{value:i,children:u}),t[6]=u,t[7]=i,t[8]=c):c=t[8],c}l.default=u}),98);
__d("useBlockCappedListItemWhenPlayingVideo",["CappedListItemContext","err","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.useContext,c=s.useEffect;function d(e,t){var n,a=o("react-compiler-runtime").c(4),i=(n=u(r("CappedListItemContext")))==null?void 0:n.registerBlocker,l,s;a[0]!==e||a[1]!==i?(l=function(){if(i){var t=null,n=null,r=function(){var r=e.getCurrentState().playing;if(r!==t&&(t=r,n&&(n(),n=null),r)){var o;n=i({reason:"playing_video",source:o})}};r();var o=e.subscribe(r);return(function(){o.remove(),n&&(n(),n=null)})}},s=[e,i],a[0]=e,a[1]=i,a[2]=l,a[3]=s):(l=a[2],s=a[3]),c(l,s)}l.default=d}),98);
__d("useDisableVirtualizationWhenPlayingVideo",["VirtualizationContext","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.useContext,c=s.useEffect;function d(e,t){var n=o("react-compiler-runtime").c(5),a=u(r("VirtualizationContext")),i,l;n[0]!==a||n[1]!==e||n[2]!==t?(i=function(){if(a!=null){var n=a.createFlag,r=a.createPin,o=null,i=null,l=function(){i==null&&(i=n("HAS_PLAYER","playerInstanceKey: "+t));var a=e.getCurrentState();a.playing||a.stalling?o||(o=r("player "+t+" is playing")):a.isFullscreen?o||(o=r("player "+t+" is fullscreen")):(o==null||o(),o=null)};l();var s=e.subscribe(l);return(function(){s.remove(),i==null||i(),i=null,o==null||o(),o=null})}},l=[e,t,a],n[0]=a,n[1]=e,n[2]=t,n[3]=i,n[4]=l):(i=n[3],l=n[4]),c(i,l)}l.default=d}),98);
__d("wrapWithContextProviders",["react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e,t){return t.reduceRight(function(e,t){return t(e)},e)}u.displayName=u.name+" [from "+i.id+"]";function c(e,t){return function(n){return s.jsx(e.Provider,{value:t,children:n})}}l.wrapWithContextProviders=u,l.makeRenderProviderFn=c}),98);
__d("VideoPlayerComponentContainer.react",["CometSSRRenderingStateHooks","CometVisualCompletionAttributes","VideoPlayerContexts","VideoPlayerHooks","VideoPlayerViewabilityProvider.react","clearTimeout","cr:6094","react","react-compiler-runtime","setTimeout","useBlockCappedListItemWhenPlayingVideo","useDisableVirtualizationWhenPlayingVideo","wrapWithContextProviders"],(function(t,n,r,o,a,i,l){"use strict";var e=["children"],s,u,c,d=s||(s=o("react")),m=s,p=m.useCallback,_=m.useEffect,f=m.useRef,g=m.useState;function h(e){var t=o("react-compiler-runtime").c(10),n=f(e),a,i;t[0]!==e?(a=function(){n.current=e},i=[e],t[0]=e,t[1]=a,t[2]=i):(a=t[1],i=t[2]),_(a,i);var l=g(!1),s=l[0],u=l[1],c;t[3]===Symbol.for("react.memo_cache_sentinel")?(c=function(){var e=null;return{cleanup:function(){e&&e()},pingNotIdle:function(){e&&e(),u(!1);var t=r("setTimeout")(function(){u(!0)},n.current);e=function(){r("clearTimeout")(t),e=null}}}},t[3]=c):c=t[3];var d=g(c),m=d[0],p=m.cleanup,h=m.pingNotIdle,y,C;t[4]!==p?(y=function(){return p},C=[p],t[4]=p,t[5]=y,t[6]=C):(y=t[5],C=t[6]),_(y,C);var b;return t[7]!==s||t[8]!==h?(b={isIdle:s,pingNotIdle:h},t[7]=s,t[8]=h,t[9]=b):b=t[9],b}function y(){var e=o("react-compiler-runtime").c(18),t=g(!1),n=t[0],r=t[1],a=h(3e3),i=a.isIdle,l=a.pingNotIdle,s;e[0]!==l?(s=function(){r(!0),l()},e[0]=l,e[1]=s):s=e[1];var u=s,c;e[2]!==l?(c=function(){r(!1),l()},e[2]=l,e[3]=c):c=e[3];var d=c,m;e[4]!==l?(m=function(){r(!0),l()},e[4]=l,e[5]=m):m=e[5];var p=m,_;e[6]!==l?(_=function(){l()},e[6]=l,e[7]=_):_=e[7];var f=_,y;e[8]!==l?(y=function(){l()},e[8]=l,e[9]=y):y=e[9];var C=y,b;return e[10]!==n||e[11]!==i||e[12]!==f||e[13]!==u||e[14]!==d||e[15]!==p||e[16]!==C?(b={isHovering:n,isIdle:i,onMouseDown:f,onMouseEnter:u,onMouseLeave:d,onMouseMove:p,onMouseUp:C},e[10]=n,e[11]=i,e[12]=f,e[13]=u,e[14]=d,e[15]=p,e[16]=C,e[17]=b):b=e[17],b}function C(e){var t=o("react-compiler-runtime").c(17),n=e.children,a=y(),i=a.isHovering,l=a.isIdle,s=a.onMouseDown,m=a.onMouseEnter,p=a.onMouseLeave,_=a.onMouseMove,f=a.onMouseUp,g=(u||(u=o("VideoPlayerHooks"))).useIsFullscreen(),h;t[0]!==g||t[1]!==l?(h={0:"x5yr21d x10l6tqk x13vifvy xh8yej3",1:"x5yr21d x10l6tqk x13vifvy xh8yej3 xjfk50j"}[!!(g&&l)<<0],t[0]=g,t[1]=l,t[2]=h):h=t[2];var C;t[3]!==n||t[4]!==l?(C=d.jsx((c||(c=o("VideoPlayerContexts"))).VideoPlayerMouseIdleContext.Provider,{value:l,children:n}),t[3]=n,t[4]=l,t[5]=C):C=t[5];var b;t[6]!==i||t[7]!==C?(b=d.jsx((c||(c=o("VideoPlayerContexts"))).VideoPlayerMouseHoverContext.Provider,{value:i,children:C}),t[6]=i,t[7]=C,t[8]=b):b=t[8];var v;return t[9]!==s||t[10]!==m||t[11]!==p||t[12]!==_||t[13]!==f||t[14]!==h||t[15]!==b?(v=d.jsx("div",babelHelpers.extends({"aria-label":"Video player",className:h,role:"group"},r("CometVisualCompletionAttributes").IGNORE,{onMouseDown:s,onMouseEnter:m,onMouseLeave:p,onMouseMove:_,onMouseUp:f,children:b})),t[9]=s,t[10]=m,t[11]=p,t[12]=_,t[13]=f,t[14]=h,t[15]=b,t[16]=v):v=t[16],v}function b(e){var t=o("react-compiler-runtime").c(3),n=e.children,a;t[0]===Symbol.for("react.memo_cache_sentinel")?(a="x5yr21d x10l6tqk x13vifvy xh8yej3",t[0]=a):a=t[0];var i;return t[1]!==n?(i=d.jsx("div",babelHelpers.extends({"aria-label":"Video player",className:a,role:"group"},r("CometVisualCompletionAttributes").IGNORE,{children:d.jsx((c||(c=o("VideoPlayerContexts"))).VideoPlayerMouseHoverContext.Provider,{value:!1,children:d.jsx(c.VideoPlayerMouseIdleContext.Provider,{value:!1,children:n})})})),t[1]=n,t[2]=i):i=t[2],i}function v(t){var a=o("react-compiler-runtime").c(3),i=t.children,l=babelHelpers.objectWithoutPropertiesLoose(t,e),s=l.implementationController,u=l.implementationExposedState,m=l.videoPlayerPassiveViewabilityInfo,p=u.activeCaptions,_=u.activeEmsgBoxes,f=u.availableAudioTracks,g=u.availableVideoQualities,h=u.availableVideoTracks,y=u.bufferEnd,v=u.captionDisplayStyle,S=u.captionsLoaded,R=u.captionsVisible,L=u.currentAudioTrackID,E=u.currentVideoQuality,k=u.currentVideoTrackID,I=u.duration,T=u.ended,D=u.error,x=u.inbandCaptionsAutogenerated,$=u.inPlayStalling,P=u.internal_coreVideoPlayerMetaData,N=u.isAbrEnabled,M=u.isDesktopPictureInPicture,w=u.isFullscreen,A=u.isLiveRewindActive,F=u.isLiveRewindAvailable,O=u.lastMuteReason,B=u.lastPauseReason,W=u.lastPlayedTimeMs,q=u.lastPlayReason,U=u.latencyLevel,V=u.loopCount,H=u.loopCurrent,G=u.muted,z=u.paused,j=u.playerInstanceKey,K=u.playerVersion,Q=u.playerViewportDimensions,X=u.playing,Y=u.seekableRanges,J=u.seeking,Z=u.selectedVideoQuality,ee=u.stalling,te=u.streamInterrupted,ne=u.targetAudioTrack,re=u.targetPlaybackRate,oe=u.targetVideoQuality,ae=u.videoFBID,ie=u.videoPixelsAspectRatio,le=u.volume,se=u.watchTimeMs,ue=P.adClientToken,ce=P.audioAvailabilityInfo,de=P.autoplayGatingResult,me=P.broadcastStatus,pe=P.canAutoplay,_e=P.disableDubbing,fe=P.initialTracePolicy,ge=P.isNCSR,he=P.isPremiumMusicVideo,ye=P.pointerTrackingEnabled,Ce=P.volumeSetting,be=ye===!1?d.jsx(b,{children:i}):d.jsx(C,{children:i});n("cr:6094")(j,{controller:s,coreVideoStates:l,videoPlayerPassiveViewabilityInfo:m});var ve=o("wrapWithContextProviders").wrapWithContextProviders(be,[o("wrapWithContextProviders").makeRenderProviderFn((c||(c=o("VideoPlayerContexts"))).VideoFBIDContext,ae),o("wrapWithContextProviders").makeRenderProviderFn(c.StallingContext,ee),o("wrapWithContextProviders").makeRenderProviderFn(c.PlayingContext,X),o("wrapWithContextProviders").makeRenderProviderFn(c.InPlayStallingContext,$),o("wrapWithContextProviders").makeRenderProviderFn(c.BufferEndContext,y),o("wrapWithContextProviders").makeRenderProviderFn(c.LastMuteReasonContext,O),o("wrapWithContextProviders").makeRenderProviderFn(c.LastPlayReasonContext,q),o("wrapWithContextProviders").makeRenderProviderFn(c.LastPauseReasonContext,B),o("wrapWithContextProviders").makeRenderProviderFn(c.PausedContext,z),o("wrapWithContextProviders").makeRenderProviderFn(c.CurrentAudioTrackIDContext,L),o("wrapWithContextProviders").makeRenderProviderFn(c.CurrentVideoTrackIDContext,k),o("wrapWithContextProviders").makeRenderProviderFn(c.CurrentVideoQualityContext,E),o("wrapWithContextProviders").makeRenderProviderFn(c.MutedContext,G),o("wrapWithContextProviders").makeRenderProviderFn(c.TargetAudioTrackContext,ne),o("wrapWithContextProviders").makeRenderProviderFn(c.VolumeContext,le),o("wrapWithContextProviders").makeRenderProviderFn(c.SelectedVideoQualityContext,Z),o("wrapWithContextProviders").makeRenderProviderFn(c.SeekingContext,J),o("wrapWithContextProviders").makeRenderProviderFn(c.DurationContext,I),o("wrapWithContextProviders").makeRenderProviderFn(c.EndedContext,T),o("wrapWithContextProviders").makeRenderProviderFn(c.ErrorContext,D),o("wrapWithContextProviders").makeRenderProviderFn(c.DimensionsContext,Q||null),o("wrapWithContextProviders").makeRenderProviderFn(c.InstanceKeyContext,j),o("wrapWithContextProviders").makeRenderProviderFn(c.ControllerContext,s),o("wrapWithContextProviders").makeRenderProviderFn(c.AvailableAudioTracksContext,f),o("wrapWithContextProviders").makeRenderProviderFn(c.AvailableVideoQualitiesContext,g),o("wrapWithContextProviders").makeRenderProviderFn(c.AvailableVideoTracksContext,h),o("wrapWithContextProviders").makeRenderProviderFn(c.PlayerVersionContext,K),o("wrapWithContextProviders").makeRenderProviderFn(c.IsAbrEnabledContext,N),o("wrapWithContextProviders").makeRenderProviderFn(c.TargetVideoQualityContext,oe),o("wrapWithContextProviders").makeRenderProviderFn(c.PlaybackRateContext,re),o("wrapWithContextProviders").makeRenderProviderFn(c.CanAutoplayContext,pe),o("wrapWithContextProviders").makeRenderProviderFn(c.VolumeSettingContext,Ce),o("wrapWithContextProviders").makeRenderProviderFn(c.AutoplayGatingResultContext,de),o("wrapWithContextProviders").makeRenderProviderFn(c.BroadcastStatusContext,me),o("wrapWithContextProviders").makeRenderProviderFn(c.LoopCountContext,V),o("wrapWithContextProviders").makeRenderProviderFn(c.LoopCurrentContext,H),o("wrapWithContextProviders").makeRenderProviderFn(c.AdClientTokenContext,ue),o("wrapWithContextProviders").makeRenderProviderFn(c.ActiveCaptionsContext,p),o("wrapWithContextProviders").makeRenderProviderFn(c.CaptionsVisibleContext,R),o("wrapWithContextProviders").makeRenderProviderFn(c.CaptionDisplayStyleContext,v),o("wrapWithContextProviders").makeRenderProviderFn(c.CaptionsLoadedContext,S),o("wrapWithContextProviders").makeRenderProviderFn(c.InbandCaptionsAutogeneratedContext,x),o("wrapWithContextProviders").makeRenderProviderFn(c.StreamInterruptedContext,te),o("wrapWithContextProviders").makeRenderProviderFn(c.WatchTimeContext,se),o("wrapWithContextProviders").makeRenderProviderFn(c.LastPlayedTimeContext,W),o("wrapWithContextProviders").makeRenderProviderFn(c.SeekableRangesContext,Y),o("wrapWithContextProviders").makeRenderProviderFn(c.LatencyLevelContext,U),o("wrapWithContextProviders").makeRenderProviderFn(c.IsLiveRewindActiveContext,A),o("wrapWithContextProviders").makeRenderProviderFn(c.IsLiveRewindAvailableContext,F),o("wrapWithContextProviders").makeRenderProviderFn(c.AudioAvailabilityInfoContext,ce),o("wrapWithContextProviders").makeRenderProviderFn(c.IsNCSRContext,ge),o("wrapWithContextProviders").makeRenderProviderFn(c.IsPremiumMusicVideoContext,he),o("wrapWithContextProviders").makeRenderProviderFn(c.InitialTracePolicyContext,fe),o("wrapWithContextProviders").makeRenderProviderFn(c.ActiveEmsgBoxesContext,_),o("wrapWithContextProviders").makeRenderProviderFn(c.VideoPixelsAspectRatioContext,ie!=null?ie:null),o("wrapWithContextProviders").makeRenderProviderFn(c.DisableDubbingContext,_e!=null?_e:!1),function(e){return d.jsx(r("VideoPlayerViewabilityProvider.react"),{isDesktopPictureInPicture:M,isFullscreen:w,videoPlayerPassiveViewabilityInfo:m,children:e})}]);r("useBlockCappedListItemWhenPlayingVideo")(s,j),r("useDisableVirtualizationWhenPlayingVideo")(s,j);var Se=o("CometSSRRenderingStateHooks").useIsServerRenderingOrHydrating(),Re=Se?void 0:j,Le;return a[0]!==ve||a[1]!==Re?(Le=d.jsx("div",{"data-instancekey":Re,"data-testid":void 0,children:ve}),a[0]=ve,a[1]=Re,a[2]=Le):Le=a[2],Le}var S=d.memo(v);l.default=S}),98);
__d("VideoPlayerFullscreenController",["CometFullScreen","FBLogger","getErrorSafe","removeFromArray"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return e.current!=null&&o("CometFullScreen").getFullScreenElement()===e.current}function s(t){var n=[];function a(){n.forEach(function(e){e()})}var i=null;return{getIsFullscreen:function(){return e(t)},requestSetIsFullscreen:function(a,i){var n=t.current;if(n==null)throw r("FBLogger")("comet_video_player").mustfixThrow("Requested full screen while the element is not present");o("CometFullScreen").isSupported()?a!==e(t)&&(a===!0?o("CometFullScreen").requestFullScreen(n).catch(function(e){r("FBLogger")("comet_video_player").catching(r("getErrorSafe")(e)).mustfix("Failed to request fullscreen")}):a===!1&&o("CometFullScreen").exitFullScreen().catch(function(e){r("FBLogger")("comet_video_player").catching(r("getErrorSafe")(e)).mustfix("Failed to exit fullscreen")})):a&&i!=null&&typeof i.webkitEnterFullScreen=="function"?i.webkitEnterFullScreen():!a&&i!=null&&typeof i.webkitExitFullScreen=="function"&&i.webkitExitFullscreen()},subscribe:function(t){return n.length===0&&i==null&&(i=o("CometFullScreen").subscribeToFullScreenChangeEvent(a)),n.push(t),{remove:function(){r("removeFromArray")(n,t),n.length===0&&i!=null&&(i(),i=null)}}}}}l.createFullscreenController=s}),98);
__d("VideoPlayerPortalingPlaceState",["FBLogger","GlobalVideoPortsContexts","GlobalVideoPortsID","getErrorSafe","gkx","react","react-compiler-runtime","usePrevious"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.useEffect,c=s.useState;function d(e,t){var n=o("react-compiler-runtime").c(5),a=r("usePrevious")(e),i,l;n[0]!==e||n[1]!==a||n[2]!==t?(i=function(){e!==a&&a!==null&&a&&!e&&t(o("GlobalVideoPortsID").makeVideoID())},l=[e,a,t],n[0]=e,n[1]=a,n[2]=t,n[3]=i,n[4]=l):(i=n[3],l=n[4]),u(i,l)}function m(e,t){var n=c(null),r=n[0],a=n[1];e!==r&&(r!==null&&r&&!e&&t(o("GlobalVideoPortsID").makeVideoID()),a(e))}var p=r("gkx")("24382")?m:d;function _(e){var t=o("react-compiler-runtime").c(11),n=e.portalingEnabled,r=e.portalingFromVideoID,a=o("GlobalVideoPortsContexts").useGlobalVideoPortsLoader(),i=o("GlobalVideoPortsContexts").useGlobalVideoPortsManager(),l=o("GlobalVideoPortsContexts").useGlobalVideoPortsState(),s=i!=null&&l!=null,d=(s||a!=null)&&(n||r!=null),m=c(h),_=m[0],y=c(g),C=y[0],b=y[1],v=d&&n&&r!=null,S=v&&r!=null?r:C;p(v,b);var R,L;t[0]!==s||t[1]!==d||t[2]!==a?(R=function(){d&&!s&&a&&a().catch(f)},L=[s,d,a],t[0]=s,t[1]=d,t[2]=a,t[3]=R,t[4]=L):(R=t[3],L=t[4]),u(R,L);var E;return t[5]!==d||t[6]!==S||t[7]!==i||t[8]!==l||t[9]!==_?(E={canBecomePortableLater:d,currentVideoID:S,globalVideoPortsManager:i,globalVideoPortsState:l,thisPlaceID:_},t[5]=d,t[6]=S,t[7]=i,t[8]=l,t[9]=_,t[10]=E):E=t[10],E}function f(e){r("FBLogger")("video_playback_www").catching(r("getErrorSafe")(e)).mustfix("GlobalVideoPortsLoader failed to load")}function g(){return o("GlobalVideoPortsID").makeVideoID()}function h(){return o("GlobalVideoPortsID").makePlaceID()}l.useRegenerateUniqueVideoID_exportedForTest=p,l.useVideoPlayerPortalingPlaceState=_}),98);
__d("VideoPlayerPortalingPlaceWithPortaling.react",["BaseContextualLayerAnchorRootContext","CoreVideoPlayerFitParentContainer.react","GlobalVideoPortsRenderers.react","deepEquals","getOwnObjectValues","gkx","react","react-compiler-runtime","shallowEqual"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e,c=u.useContext,d=u.useEffect,m=u.useRef,p=u.useState;function _(e){var t=e.coreVideoPlayerMetaData,n=e.currentVideoID,o=e.fullscreenController,a=e.globalVideoPortsManager,i=e.implementations,l=e.injectCoreVideoStatesRef,s=e.isFullscreen,u=e.portablePlaceContainer,c=e.portablePlaceMetaData,m=e.renderComponents,p=e.renderPlaceholder,_=e.thisPlaceID,f=e.trackingDataEncrypted,g=e.trackingNodes,h=e.viewportMarginsForViewability;d(function(){a.addOrUpdatePlace({coreVideoPlayerMetaData:t,fullscreenController:o,implementations:i,injectCoreVideoStatesRef:l,isFullscreen:s,portablePlaceContainer:u,portablePlaceID:_,portablePlaceMetaData:c,portableVideoID:n,renderComponents:m,renderPlaceholder:p,trackingDataEncrypted:f,trackingNodes:g,viewportMarginsForViewability:h})},[].concat(r("getOwnObjectValues")(t),[n,o,s,a,u],r("getOwnObjectValues")(c||{}),[m,p,_,f,g,h])),d(function(){return function(){a.removePlace({portablePlaceID:_})}},[a,_])}function f(e){var t=o("react-compiler-runtime").c(20),n=e.coreVideoPlayerMetaData,a=e.currentVideoID,i=e.fullscreenController,l=e.globalVideoPortsManager,s=e.implementations,u=e.injectCoreVideoStatesRef,c=e.isFullscreen,p=e.portablePlaceContainer,_=e.portablePlaceMetaData,f=e.renderComponents,g=e.renderPlaceholder,h=e.thisPlaceID,y=e.trackingDataEncrypted,C=e.trackingNodes,b=e.viewportMarginsForViewability,v=m(null),S=m(null),R;t[0]!==n||t[1]!==a||t[2]!==i||t[3]!==l||t[4]!==s||t[5]!==u||t[6]!==c||t[7]!==p||t[8]!==_||t[9]!==f||t[10]!==g||t[11]!==h||t[12]!==y||t[13]!==C||t[14]!==b?(R=function(){var e={coreVideoPlayerMetaData:n,implementations:s,isFullscreen:c,portablePlaceID:h,portablePlaceMetaData:_,portableVideoID:a,trackingDataEncrypted:y,trackingNodes:C,viewportMarginsForViewability:b},t={fullscreenController:i,injectCoreVideoStatesRef:u,portablePlaceContainer:p,renderComponents:f,renderPlaceholder:g};r("deepEquals")(e,v.current)&&r("shallowEqual")(t,S.current)||(v.current=e,S.current=t,l.addOrUpdatePlace(babelHelpers.extends({},e,t)))},t[0]=n,t[1]=a,t[2]=i,t[3]=l,t[4]=s,t[5]=u,t[6]=c,t[7]=p,t[8]=_,t[9]=f,t[10]=g,t[11]=h,t[12]=y,t[13]=C,t[14]=b,t[15]=R):R=t[15],d(R);var L,E;t[16]!==l||t[17]!==h?(L=function(){return(function(){v.current=null,S.current=null,l.removePlace({portablePlaceID:h})})},E=[l,h],t[16]=l,t[17]=h,t[18]=L,t[19]=E):(L=t[18],E=t[19]),d(L,E)}var g=r("gkx")("17097")?f:_;function h(e){var t,n,a,i,l=o("react-compiler-runtime").c(17),u=e.currentPlaceID,d=e.currentVideoID,_=e.globalVideoPortsManager,f=e.globalVideoPortsState_DEPRECATED,h=e.isFullscreen,C=e.previousPlaceMetaData,b=e.renderComponents,v=e.thisPlaceID,S=p(y),R=S[0],L=m(null),E;l[0]!==R||l[1]!==e?(E=babelHelpers.extends({},e,{injectCoreVideoStatesRef:L,portablePlaceContainer:R}),l[0]=R,l[1]=e,l[2]=E):E=l[2],g(E);var k=c(r("BaseContextualLayerAnchorRootContext")),I=m(null),T=h?I:k,D;l[3]!==R||l[4]!==v?(D=s.jsx(o("CoreVideoPlayerFitParentContainer.react").CoreVideoPlayerFitParentDOMContainer,{debugRole:null,domElement:R},v),l[3]=R,l[4]=v,l[5]=D):D=l[5];var x=f!=null?(t=(n=_.getCurrentPlaceStateForVideo(f,d))==null?void 0:n.portablePlaceID)!=null?t:null:u,$=f!=null?(a=(i=_.getPortableVideoState(f,d))==null?void 0:i.previousPlaceMetaData)!=null?a:null:C,P;l[6]!==d||l[7]!==b||l[8]!==x||l[9]!==$||l[10]!==v?(P=s.jsx(o("GlobalVideoPortsRenderers.react").GlobalVideoPortsVideoComponentsRenderer,{currentPlaceID:x,currentVideoID:d,injectCoreVideoStatesRef:L,previousPlaceMetaData:$,renderComponents:b,thisPlaceID:v}),l[6]=d,l[7]=b,l[8]=x,l[9]=$,l[10]=v,l[11]=P):P=l[11];var N;l[12]===Symbol.for("react.memo_cache_sentinel")?(N=s.jsx("div",{ref:I}),l[12]=N):N=l[12];var M;return l[13]!==T||l[14]!==D||l[15]!==P?(M=s.jsxs(r("BaseContextualLayerAnchorRootContext").Provider,{value:T,children:[D,P,N]}),l[13]=T,l[14]=D,l[15]=P,l[16]=M):M=l[16],M}function y(){return o("CoreVideoPlayerFitParentContainer.react").createFitParentContainerDiv({debugRole:null})}l.default=h}),98);
__d("VideoPlayerPortalingPlace.react",["BaseViewportMarginsContext","CometTrackingCodeContext","CometTrackingNodesContext","CoreVideoPlayer.react","CoreVideoPlayerFitParentContainer.react","FBLogger","GlobalVideoPortsID","GlobalVideoPortsRenderers.react","VideoPlayerFullscreenController","VideoPlayerPortalingPlaceInfoProvider.react","VideoPlayerPortalingPlaceState","VideoPlayerPortalingPlaceWithPortaling.react","react","react-compiler-runtime","useStable","useUnsafeRef_DEPRECATED"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=s||(s=o("react")),c=s,d=c.useContext,m=c.useEffect,p=c.useState,_={bottom:0,left:0,right:0,top:0};function f(e){var t=o("react-compiler-runtime").c(5),n=e.ref,r=e.children,a=e.debugRole,i=e.testid,l;return t[0]!==r||t[1]!==a||t[2]!==n||t[3]!==i?(l=u.jsx(o("CoreVideoPlayerFitParentContainer.react").CoreVideoPlayerFitParentContainer,{debugRole:a,ref:n,testid:void 0,children:r}),t[0]=r,t[1]=a,t[2]=n,t[3]=i,t[4]=l):l=t[4],l}function g(t){var n,a=o("react-compiler-runtime").c(69),i=t.coreVideoPlayerMetaData,l=t.implementations,s=t.portalingEnabled,c=t.portalingFromVideoID,g=t.portalingPlaceMetaData,y=t.renderComponents,C=t.renderPlaceholder,b;a[0]===Symbol.for("react.memo_cache_sentinel")?(b=[],a[0]=b):b=a[0],m(h,b);var v;a[1]!==c?(v=c!=null?o("GlobalVideoPortsID").ensureVideoID(c):null,a[1]=c,a[2]=v):v=a[2];var S=v;c!=null&&S==null&&r("FBLogger")("comet_video_player").mustfix("The provided portalingFromVideoID (%s) does not look like such an ID. The video player will not use portaling until a valid ID is provided",String(c));var R;a[3]!==s||a[4]!==S?(R={portalingEnabled:s,portalingFromVideoID:S},a[3]=s,a[4]=S,a[5]=R):R=a[5];var L=o("VideoPlayerPortalingPlaceState").useVideoPlayerPortalingPlaceState(R),E=L.canBecomePortableLater,k=L.currentVideoID,I=L.globalVideoPortsManager,T=L.globalVideoPortsState,D=L.thisPlaceID,x=d(r("BaseViewportMarginsContext")),$=(e||(e=r("useUnsafeRef_DEPRECATED")))(null),P;a[6]!==$?(P=function(){return o("VideoPlayerFullscreenController").createFullscreenController($)},a[6]=$,a[7]=P):P=a[7];var N=r("useStable")(P),M;a[8]!==N?(M=N.getIsFullscreen(),a[8]=N,a[9]=M):M=a[9];var w=p(M),A=w[0],F=w[1],O,B;a[10]!==N?(O=function(){var e=N.subscribe(function(){var e=N.getIsFullscreen();F(e)});return F(N.getIsFullscreen()),(function(){e.remove()})},B=[N,F],a[10]=N,a[11]=O,a[12]=B):(O=a[11],B=a[12]),m(O,B);var W=d(r("CometTrackingNodesContext")),q;a[13]!==W?(q=W.join(""),a[13]=W,a[14]=q):q=a[14];var U=q,V=d(r("CometTrackingCodeContext")),H=(n=V.encrypted_tracking[0])!=null?n:"",G=A?_:x,z="comet-video-player-place"+(i.videoFBID!=null?"-vid-"+i.videoFBID:"");if(!E){var j;a[15]!==i||a[16]!==G||a[17]!==N||a[18]!==l||a[19]!==A||a[20]!==y||a[21]!==H||a[22]!==U?(j=u.jsx(r("CoreVideoPlayer.react"),{coreVideoPlayerMetaData:i,fullscreenController:N,implementations:l,isFullscreen:A,renderWithCoreVideoStates:y,trackingDataEncrypted:H,trackingNodes:U,viewportMarginsForViewability:G}),a[15]=i,a[16]=G,a[17]=N,a[18]=l,a[19]=A,a[20]=y,a[21]=H,a[22]=U,a[23]=j):j=a[23];var K;a[24]!==k||a[25]!==j||a[26]!==D?(K=u.jsx(o("VideoPlayerPortalingPlaceInfoProvider.react").VideoPlayerPortalingPlaceInfoProvider,{currentPlaceID:D,currentVideoID:k,portalingEnabled:!1,previousPlaceMetaData:null,thisPlaceID:D,children:j}),a[24]=k,a[25]=j,a[26]=D,a[27]=K):K=a[27];var Q;return a[28]!==K||a[29]!==z||a[30]!==$?(Q=u.jsx(f,{debugRole:null,ref:$,testid:void 0,children:K}),a[28]=K,a[29]=z,a[30]=$,a[31]=Q):Q=a[31],Q}if(I&&T){var X;if(a[32]!==k||a[33]!==I||a[34]!==T){var Y,J;X=(Y=(J=I.getCurrentPlaceStateForVideo(T,k))==null?void 0:J.portablePlaceID)!=null?Y:null,a[32]=k,a[33]=I,a[34]=T,a[35]=X}else X=a[35];var Z;if(a[36]!==k||a[37]!==I||a[38]!==T){var ee,te;Z=(ee=(te=I.getPortableVideoState(T,k))==null?void 0:te.previousPlaceMetaData)!=null?ee:null,a[36]=k,a[37]=I,a[38]=T,a[39]=Z}else Z=a[39];var ne;a[40]!==i||a[41]!==k||a[42]!==G||a[43]!==N||a[44]!==I||a[45]!==l||a[46]!==A||a[47]!==g||a[48]!==y||a[49]!==C||a[50]!==Z||a[51]!==X||a[52]!==D||a[53]!==H||a[54]!==U?(ne=u.jsx(r("VideoPlayerPortalingPlaceWithPortaling.react"),{coreVideoPlayerMetaData:i,currentPlaceID:X,currentVideoID:k,fullscreenController:N,globalVideoPortsManager:I,globalVideoPortsState_DEPRECATED:null,implementations:l,isFullscreen:A,portablePlaceMetaData:g,previousPlaceMetaData:Z,renderComponents:y,renderPlaceholder:C,thisPlaceID:D,trackingDataEncrypted:H,trackingNodes:U,viewportMarginsForViewability:G}),a[40]=i,a[41]=k,a[42]=G,a[43]=N,a[44]=I,a[45]=l,a[46]=A,a[47]=g,a[48]=y,a[49]=C,a[50]=Z,a[51]=X,a[52]=D,a[53]=H,a[54]=U,a[55]=ne):ne=a[55];var re;return a[56]!==ne||a[57]!==z||a[58]!==$?(re=u.jsx(f,{debugRole:null,ref:$,testid:void 0,children:ne}),a[56]=ne,a[57]=z,a[58]=$,a[59]=re):re=a[59],re}else{var oe,ae=(oe=i.videoPixelsAspectRatio)!=null?oe:null,ie;a[60]!==k||a[61]!==C||a[62]!==ae||a[63]!==D?(ie=u.jsx(o("GlobalVideoPortsRenderers.react").GlobalVideoPortsPlaceholderRenderer,{currentPlaceID:null,currentVideoID:k,previousPlaceMetaData:null,renderPlaceholder:C,thisPlaceID:D,videoPixelsAspectRatio:ae}),a[60]=k,a[61]=C,a[62]=ae,a[63]=D,a[64]=ie):ie=a[64];var le;return a[65]!==ie||a[66]!==z||a[67]!==$?(le=u.jsx(f,{debugRole:null,ref:$,testid:void 0,children:ie}),a[65]=ie,a[66]=z,a[67]=$,a[68]=le):le=a[68],le}}function h(){return y}function y(){}l.default=g}),98);
__d("VideoPlayerTracePolicyContext",["react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e.useContext,c={initialTracePolicy:null,routeTracePolicy:null},d=s.createContext(c);function m(){return u(d)}l.VideoPlayerTracePolicyContext=d,l.useVideoPlayerTracePolicy=m}),98);
__d("VideoPlayerTracePolicyProvider.react",["VideoPlayerTracePolicyContext","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){var t=o("react-compiler-runtime").c(6),n=e.children,r=e.initialTracePolicy,a=e.routeTracePolicy,i=r,l=a,u;t[0]!==i||t[1]!==l?(u={initialTracePolicy:i,routeTracePolicy:l},t[0]=i,t[1]=l,t[2]=u):u=t[2];var c;return t[3]!==n||t[4]!==u?(c=s.jsx(o("VideoPlayerTracePolicyContext").VideoPlayerTracePolicyContext.Provider,{value:u,children:n}),t[3]=n,t[4]=u,t[5]=c):c=t[5],c}l.default=u}),98);
__d("CoreVideoPlayerWithComponents.react",["VideoPlayerComponentContainer.react","VideoPlayerPortalingPlace.react","VideoPlayerTracePolicyProvider.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e.useCallback;function c(e){var t=o("react-compiler-runtime").c(14),n=e.children,a=e.coreVideoPlayerMetaData,i=e.implementations,l=e.portalingEnabled,u=e.portalingFromVideoID,c=e.portalingPlaceMetaData,d=e.portalingRenderPlaceholder,m;t[0]!==n?(m=function(t){return s.jsx(r("VideoPlayerComponentContainer.react"),babelHelpers.extends({},t,{children:n}))},t[0]=n,t[1]=m):m=t[1];var p=m,_;t[2]!==a||t[3]!==i||t[4]!==l||t[5]!==u||t[6]!==c||t[7]!==d||t[8]!==p?(_=s.jsx(r("VideoPlayerPortalingPlace.react"),{coreVideoPlayerMetaData:a,implementations:i,portalingEnabled:l,portalingFromVideoID:u,portalingPlaceMetaData:c,renderComponents:p,renderPlaceholder:d}),t[2]=a,t[3]=i,t[4]=l,t[5]=u,t[6]=c,t[7]=d,t[8]=p,t[9]=_):_=t[9];var f;return t[10]!==a.initialTracePolicy||t[11]!==a.routeTracePolicy||t[12]!==_?(f=s.jsx(r("VideoPlayerTracePolicyProvider.react"),{initialTracePolicy:a.initialTracePolicy,routeTracePolicy:a.routeTracePolicy,children:_}),t[10]=a.initialTracePolicy,t[11]=a.routeTracePolicy,t[12]=_,t[13]=f):f=t[13],f}l.default=c}),98);
__d("GraphQLVideoAutoplayGatingResult",[],(function(t,n,r,o,a,i){"use strict";function e(e,t,n){var r=e!=null?e:"unknown",o=t||null;return{autoplayGatingResult:r,autoplaySetting:o,canAutoplay:n!=null?n:!1}}i.makeGraphQLVideoAutoplayGatingResult=e}),66);
__d("XVideoUnifiedCVCControllerRouteBuilder",["jsRouteBuilder"],(function(t,n,r,o,a,i,l){var e=r("jsRouteBuilder")("/video/unified_cvc/",Object.freeze({}),void 0),s=e;l.default=s}),98);
__d("UnifiedVideoCVCSubscription",["CVCv3DisabledPlayerOrigins","CVCv3DisabledPlayerSubOrigins","CVCv3SubscriptionHelper","DateConsts","XVideoUnifiedCVCControllerRouteBuilder","clearTimeout","cometAsyncFetch","promiseDone","setTimeout"],(function(t,n,r,o,a,i,l){"use strict";var e=Object.values(r("CVCv3DisabledPlayerOrigins")),s=Object.values(r("CVCv3DisabledPlayerSubOrigins")),u=10,c=(function(){function t(t,n,o,a,i,l){var u=this;this.$1=new(r("CVCv3SubscriptionHelper"))(t,n,o),this.$5=i,this.$6=null,this.$9=null,this.$10=!this.$1.isValidSubscription(),this.$3=null,this.$2=null;var c=n!=null?e.includes(n):!1,d=o!=null?s.includes(o):!1;!c&&!d&&(this.$3=a,this.$11=l,this.$4=a.subscribe(function(){if(u.$3==null){u.$1.logDebugInfo("empty_video_controller");return}var e=u.$3.getCurrentState();e.playing?u.$12(e):u.$13()}))}var n=t.prototype;return n.$12=function(t){if(this.$3==null){this.$1.logDebugInfo("empty_video_controller");return}if(t.playing){if(this.$2==null){var e=this.$3.getPlayheadPosition();e>=0&&(this.$2=e)}}else this.$2=null;this.$14(0)},n.stopUnifiedCVC=function(){this.$13()},n.destroy=function(){this.$13(),this.$4!=null&&this.$4.remove(),this.$4=null,this.$3=null},n.$13=function(){r("clearTimeout")(this.$8),r("clearTimeout")(this.$7),this.$8=null,this.$7=null,this.$2=null,this.$1.clearAnyPreviousContext(),this.$9=null},n.$15=function(){r("clearTimeout")(this.$7),this.$7=null},n.$16=function(){this.$9=null,this.$15(),this.$14(0)},n.$14=function(t){var e=this;this.$3==null||this.$8!=null||this.$9!=null||this.$10||(this.$8=r("setTimeout")(function(){e.$8=null;var t=e.$17();if(t==null){e.$1.logDebugInfo("empty_request");return}e.$9=t;var n=Date.now(),a=!1;r("promiseDone")(t,function(r){if(t===e.$9)if(e.$9=null,r!=null){var o=e.$1.processUnifiedResponse(r);e.$18(o,n)}else e.$1.logHttpResponseBad("null payload",Date.now()-n)},function(t){a=!0,e.$1.logHttpRequestFailure(t!=null?JSON.stringify(t):null,Date.now()-n)}),e.$7=r("setTimeout")(function(){a||e.$1.logHttpRequestTimeout(Date.now()-n),e.$16()},u*o("DateConsts").MS_PER_SEC)},t))},n.$18=function(t,n){this.$15();var e=Date.now()-n;if(t.d!=null?(this.$1.logHttpRequestSuccess(e),this.$11!=null&&this.$11(t.d)):this.$1.logHttpResponseBad("no data field",e),t.a!=null){var r=t.a.t;switch(r){case"p":var a=t.a.pi;a==null&&(a=u),this.$14(a*o("DateConsts").MS_PER_SEC);break;case"s":this.$10=!0;break}}},n.$17=function(){var e=this.$19();if(e==null)return null;var t={d:JSON.stringify(e)};return r("cometAsyncFetch")(r("XVideoUnifiedCVCControllerRouteBuilder").buildURL({}),{data:t,method:"POST"})},n.$19=function(){var e=this.$3;if(e==null)return null;var t={};this.$6!=null&&(t.lc=this.$6),this.$5&&(t.ls=!0);var n=0,r=0;this.$2!=null&&(n=this.$2,r=e.getPlayheadPosition());var o=e.getCurrentState(),a=this.$1.makeUnifiedVideoCVCUpdate(n,r,this.$20(o),o.muted,t);return a},n.$20=function(t){return t.playing||t.seeking?"playing":t.ended?"ended":t.paused?"paused":"unknown"},n.testing_setLastStartPosition=function(t){this.$2=t},n.testing_makeUnifiedStateUpdate=function(){return this.$19()},n.testing_handleUnifiedResponse=function(t){return this.$18(t,Date.now())},t})();l.default=c}),98);
__d("VideoPlayerCaptionsAreaDeferred.react",["deferredLoadComponent","requireDeferredForDisplay"],(function(t,n,r,o,a,i,l){"use strict";var e=r("deferredLoadComponent")(r("requireDeferredForDisplay")("VideoPlayerCaptionsArea.react").__setRef("VideoPlayerCaptionsAreaDeferred.react"));l.default=e}),98);
__d("VideoPlayerCaptionsDisplayConfigContext",["react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.createContext({liveCaptionsTextAlignment:null,textSizeMapping:null});l.default=u}),98);
__d("VideoPlayerErrorBoundary.react",["FBLogger","getErrorSafe","oz-player/utils/OzErrorUtils","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.state={error:null},t.suppressReactDefaultErrorLoggingIUnderstandThisWillMakeBugsHarderToFindAndFix=!0,babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}babelHelpers.inheritsLoose(t,e),t.getDerivedStateFromError=function(t){return{error:r("getErrorSafe")(t)}};var n=t.prototype;return n.componentDidCatch=function(t,n){var e=n.componentStack,a=r("getErrorSafe")(t);a.componentStack=e;var i=this.props,l=i.description,s=i.onError,u=i.project,c=o("oz-player/utils/OzErrorUtils").isOzError(t)?t.getType():t!=null&&typeof t.name=="string"?t.name:a.name;try{a.name=c}catch(e){}var d="VideoPlayerErrorBoundary caught an "+c;l!=null&&(d=d+" ("+l+")");var m=["OZ_NETWORK","BUFFERING_TIMEOUT","MEDIA_ERR_DECODE","OZ_NETWORK_REQUEST_STREAM_RETRY_HANDLER_ERROR"],p=["Network failure:","Network failure.","HTTP error.","Bad URL timestamp","URL signature expired","No license for com.widevine.alpha","OZ_DRM_MANAGER: Endpoint returned error: DEVICE_CERTIFICATE_REVOKED"],_=m.every(function(e){return a.name!==e})&&p.every(function(e){return!a.message.startsWith(e)}),f=r("FBLogger")(u==null?"comet_video_player":u).catching(a);["OZ_DRM_MANAGER","OZ_JAVASCRIPT_NATIVE","OZ_INITIALIZATION"].includes(a.name)&&(f=f.addToCategoryKey(a.message)),_?f.fatal(d):f.warn(d),s!=null&&s(a)},n.render=function(){var e=this.props,t=e.children,n=e.fallback,r=this.state.error;return r?typeof n=="function"?n(r):n:t},t})(s.PureComponent);l.default=u}),98);
__d("VideoPlayerFallbackLearnMoreLink.react",["fbt","CometFacebookHelpURLConstants","FDSLink.react","FDSText.react","gkx","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react"));function c(){var e=o("react-compiler-runtime").c(2),t=r("gkx")("20836")?"/help/work/1876956335887765/i-cant-view-or-play-videos-on-workplace":o("CometFacebookHelpURLConstants").FACEBOOK_HELP_BASE_URL+"/396404120401278/list",n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=s._(/*BTDS*/"Learn more about video playback issues"),e[0]=n):n=e[0];var a;return e[1]===Symbol.for("react.memo_cache_sentinel")?(a=u.jsx(r("FDSText.react"),{color:"primaryOnMedia",type:"headlineEmphasized3",children:u.jsx(r("FDSLink.react"),{"aria-label":n,href:t,target:"_blank",children:s._(/*BTDS*/"Learn more")})}),e[1]=a):a=e[1],a}l.default=c}),226);
__d("VideoPlayerFallbackCoverImplWithoutRetry.react",["FDSText.react","VideoPlayerFallbackLearnMoreLink.react","cr:2324","cr:4149","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){var t=o("react-compiler-runtime").c(21),a=e.background,i=e.debugError,l=e.message,u=e.showDebugWithoutError,c=e.showLearnMoreLink,d=u===void 0?!0:u,m=c===void 0?!0:c,p;t[0]===Symbol.for("react.memo_cache_sentinel")?(p={className:"x6s0dn4 xatbrnm x9f619 x78zum5 x5yr21d xl56j7k x6ikm8r x10wlt62 x889kno x2vl965 x1a8lsjc xe2zdcy x1n2onr6 xh8yej3"},t[0]=p):p=t[0];var _;t[1]!==a?(_={0:{className:"x6s0dn4 x78zum5 xdt5ytf x3es6ox"},1:{className:"x6s0dn4 x78zum5 xdt5ytf x3es6ox x1vjfegm"}}[(a!=null)<<0],t[1]=a,t[2]=_):_=t[2];var f;t[3]===Symbol.for("react.memo_cache_sentinel")?(f={className:"x6s0dn4 x78zum5 xdt5ytf x193iq5w"},t[3]=f):f=t[3];var g;t[4]!==l?(g=s.jsx("div",babelHelpers.extends({},f,{children:s.jsx(r("FDSText.react"),{align:"center",color:"primaryOnMedia",type:"bodyLink3",children:l})})),t[4]=l,t[5]=g):g=t[5];var h;t[6]!==m?(h=m&&s.jsx("div",{className:"x6s0dn4 x78zum5 xdt5ytf xw7yly9 x193iq5w",children:s.jsx(r("VideoPlayerFallbackLearnMoreLink.react"),{})}),t[6]=m,t[7]=h):h=t[7];var y;t[8]!==i||t[9]!==d?(y=(i!=null||d)&&s.jsxs(s.Fragment,{children:[n("cr:4149")?s.jsx(n("cr:4149"),{error:i}):null,n("cr:2324")?s.jsx(n("cr:2324"),{error:i}):null]}),t[8]=i,t[9]=d,t[10]=y):y=t[10];var C;t[11]!==_||t[12]!==g||t[13]!==h||t[14]!==y?(C=s.jsxs("div",babelHelpers.extends({},_,{children:[g,h,y]})),t[11]=_,t[12]=g,t[13]=h,t[14]=y,t[15]=C):C=t[15];var b;t[16]!==a?(b=a!=null&&s.jsx("div",{className:"x1ey2m1c xtijo5x x1o0tod x10l6tqk x13vifvy",children:a}),t[16]=a,t[17]=b):b=t[17];var v;return t[18]!==b||t[19]!==C?(v=s.jsxs("div",babelHelpers.extends({},p,{children:[C,b]})),t[18]=b,t[19]=C,t[20]=v):v=t[20],v}l.default=u}),98);
__d("VideoPlayerFallbackCover.react",["fbt","VideoPlayerFallbackCoverImplWithoutRetry.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react"));function c(e){var t=o("react-compiler-runtime").c(8),n=e.background,a=e.debugError,i=e.message,l=e.showDebugWithoutError,c=e.showLearnMoreLink,d;t[0]!==i?(d=i!=null?i:s._(/*BTDS*/"Sorry, we're having trouble playing this video."),t[0]=i,t[1]=d):d=t[1];var m=d,p;return t[2]!==n||t[3]!==a||t[4]!==m||t[5]!==l||t[6]!==c?(p=u.jsx(r("VideoPlayerFallbackCoverImplWithoutRetry.react"),{background:n,debugError:a,message:m,showDebugWithoutError:l,showLearnMoreLink:c}),t[2]=n,t[3]=a,t[4]=m,t[5]=l,t[6]=c,t[7]=p):p=t[7],p}l.default=c}),226);
__d("VideoPlayerFullscreenControl.react",["fbt","ix","VideoPlayerControlIcon.react","VideoPlayerHooks","fbicon","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s,u){"use strict";var e,c,d=e||(e=o("react"));function m(e){var t=o("react-compiler-runtime").c(18),n=e.onPress,a=e.onUserInteraction,i=e.shouldUnmute,l=e.showTooltip,m=e.useOutlineIcons,p=l===void 0?!0:l,_=m===void 0?!1:m,f=(c||(c=o("VideoPlayerHooks"))).useController(),g=c.useIsFullscreen(),h=c.useLastMuteReason(),y;t[0]!==g?(y=g?s._(/*BTDS*/"Exit fullscreen"):s._(/*BTDS*/"Enter fullscreen"),t[0]=g,t[1]=y):y=t[1];var C=y,b;t[2]!==f||t[3]!==g||t[4]!==h||t[5]!==n||t[6]!==a||t[7]!==i?(b=function(){n&&n(),f.requestSetIsFullscreen(!g),i===!0&&h!=="user_initiated"&&f.setMuted(!1,"product_initiated"),a&&a({name:"video_fullscreen_button",type:"happened"})},t[2]=f,t[3]=g,t[4]=h,t[5]=n,t[6]=a,t[7]=i,t[8]=b):b=t[8];var v=b,S;t[9]!==_?(S=_?o("fbicon")._(u("528442"),20):o("fbicon")._(u("517758"),20),t[9]=_,t[10]=S):S=t[10];var R=S,L;t[11]!==_?(L=_?o("fbicon")._(u("595830"),20):o("fbicon")._(u("517763"),20),t[11]=_,t[12]=L):L=t[12];var E=L,k=g?R:E,I=p?C:null,T;return t[13]!==C||t[14]!==v||t[15]!==k||t[16]!==I?(T=d.jsx(r("VideoPlayerControlIcon.react"),{icon:k,label:C,onPress:v,tooltip:I}),t[13]=C,t[14]=v,t[15]=k,t[16]=I,t[17]=T):T=t[17],T}l.default=m}),226);
__d("VideoPlayerIMFMetadataContext",["FBLogger","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e.useContext,c={imfExpectedFromEmsg:!1,specInlineJson:null},d=s.createContext(c);d.displayName="VideoPlayerIMFMetadataContext";var m=d.Provider;function p(){var e=u(d);if(e===c)throw r("FBLogger")("comet_video_player").mustfixThrow("useVideoPlayerIMFMetadata is not called from a component nested under VideoPlayerRelay/VideoPlayerX.");return e}l.VideoPlayerIMFMetadataContextProvider=m,l.useVideoPlayerIMFMetadataFromContext=p}),98);
__d("VideoPlayerProgressiveImplementationData",["err"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return/\.mpd(\?|$)/.test(e)}function s(t){var n=t.hdSrc,o=t.hdSrcPreferred,a=t.mediaStream,i=t.sdSrc;if(a!=null)return{hdSrc:null,hdSrcPreferred:o,mediaStream:a,sdSrc:null};if(n==null&&i==null){var l=r("err")("Both HD and SD browser-native URLs are not available");return l.name="GotNoBrowserNativeURLs",l}var s=i!=null&&e(i),u=n!=null&&e(n);if(s||u){var c=r("err")("HD or SD browser-native URL points to a DASH manifest");return c.name="GotBrowserNativeURLsPointToDASH",c}return{hdSrc:n,hdSrcPreferred:o,mediaStream:null,sdSrc:i}}l.makeProgressiveImplementationData=s}),98);
__d("VideoPlayerProgressiveImplementationEngineExtrasAPI",["gkx"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return e!==null&&e.indexOf(".m3u8")!==-1}function s(t){var n=t.getPlayingVideoInfo,o=t.setUserSelectedVideoQuality;function a(){var t=n(),r="progressive_SD",o="progressive_HD";return t==null||e(t.hdSrc)||e(t.sdSrc)?null:t.hdSrc!=null&&t.playingSrc===t.hdSrc?o:t.sdSrc!=null&&t.playingSrc===t.sdSrc?r:null}return{getApproximateFBLSToPlayerDisplayLatency:function(){return null},getAvailableAudioTracks:function(){var e,t;return(e=(t=n())==null?void 0:t.availableAudioTracks)!=null?e:[]},getAvailableVideoQualities:function(){var e,t;return(e=(t=n())==null?void 0:t.availableQualities)!=null?e:[]},getAvailableVideoTracks:function(){var e,t;return(e=(t=n())==null?void 0:t.availableVideoTracks)!=null?e:[]},getCurrentAudioRepresentation:function(){return null},getCurrentPlayingAudioRepresentationID:function(){return r("gkx")("440")?a():null},getCurrentPlayingAudioTrackID:function(){var e,t;return(e=(t=n())==null?void 0:t.playingAudioTrackID)!=null?e:null},getCurrentPlayingVideoQuality:function(){var e,t;return(e=(t=n())==null?void 0:t.targetQuality)!=null?e:""},getCurrentPlayingVideoRepresentationID:function(){return r("gkx")("440")?a():"oep_hd"},getCurrentTargetVideoQuality:function(){var e,t;return(e=(t=n())==null?void 0:t.targetQuality)!=null?e:""},getCurrentVideoRepresentation:function(){return null},getEstimatedBandwidth:function(){return null},getInbandCaptionsAutogeneratedFromManifest:function(){return!1},getInbandCaptionsExpectedFromManifest:function(){return!1},getManifestIdentifier:function(){return null},getMpdValidationErrors:function(){return null},getPerfLoggerProvider:function(){return null},getRepresentationCaptionsExpectedFromManifest:function(){return!1},getStreamType:function(){var t=n();return t==null?"progressive":e(t.hdSrc)||e(t.sdSrc)?"hls":"progressive"},getTargetAudioTrack:function(){return null},getUserSelectedVideoQuality:function(){var e,t;return(e=(t=n())==null?void 0:t.selectedQuality)!=null?e:"notselected"},getUserSelectedVideoVariant:function(){return null},getVideoProjectionType:function(){return"cubemap"},getVideoRepresentations:function(){return null},isDrm:function(){var e;return((e=n())==null?void 0:e.graphQLVideoDRMInfo)!=null},isFBIsLiveTemplated:function(){return!1},isFBMS:function(){return!1},isFBWasLive:function(){return!1},isLiveRewindAvailable:function(){return!1},isMixedCodecManifest:function(){return!1},isPredictiveDash:function(){return!1},setDimensions:function(t){},setEnableLiveheadCatchup:function(){},setLatencyLevel:function(){},setUserSelectedVideoQuality:o,setUserSelectedVideoVariant:function(t){}}}l.createVideoPlayerProgressiveImplementationEngineExtrasAPI=s}),98);
__d("VideoPlayerProgressiveImplementationEngineUtils",[],(function(t,n,r,o,a,i){"use strict";var e="hd",l="sd",s="mediastream";function u(t,n,r){return t?n!=null?e:l:r!=null?l:n!=null?e:l}function c(t){var n,r=(n=t.mediaStream)!=null?n:null,o=[];r!=null?o.push(s):(t.sdSrc!=null&&o.push(l),t.hdSrc!=null&&o.push(e));var a=[],i=[],c=r!=null?s:u(t.hdSrcPreferred,t.hdSrc,t.sdSrc);return babelHelpers.extends({},t,{availableAudioTracks:a,availableQualities:o,availableVideoTracks:i,playingAudioTrackID:null,playingMediaStream:r,playingQuality:null,playingSrc:null,selectedQuality:c,targetQuality:c,targetSrc:null})}function d(t,n){if(t.playingMediaStream!=null)return t;var r=t.hdSrc,o=t.sdSrc,a,i;return n==="notselected"||n==="auto"?(a=o!=null?l:r!=null?e:l,i=o!=null?o:r!=null?r:null):n===e&&r!=null?(a=e,i=r):n===l&&o!=null?(a=l,i=o):(a=l,i=null),i===""&&(i=null),babelHelpers.extends({},t,{selectedQuality:n,targetQuality:a,targetSrc:i})}function m(e,t,n){return babelHelpers.extends({},e,{playingQuality:t,playingSrc:n})}i.createResolvedVideoInfoProgressive=c,i.updatePlayingVideoInfoProgressiveWithUserSelectedQuality=d,i.updatePlayingVideoInfoProgressiveWithCurrentPlayingQuality=m}),66);
__d("VideoPlayerProgressiveImplementationEngine",["FBLogger","Promise","UserAgent","VideoPlayerImplementationEngineAPI","VideoPlayerImplementationEngineVideoElementAPI","VideoPlayerImplementationErrors","VideoPlayerODS","VideoPlayerProgressiveImplementationEngineExtrasAPI","VideoPlayerProgressiveImplementationEngineUtils","assignMediaStream","cr:1680308","cr:7276","err","getErrorNameFromMediaErrorCode","getErrorSafe","getMoreGranularErrorNameFromHTMLVideoElementErrorMessage","gkx","promiseDone","videoUrlUtils"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e,t,n){var r=typeof e=="object"&&e!=null&&typeof e.name=="string"?e.name:null;return o("VideoPlayerImplementationErrors").createVideoPlayerErrorFromGenericError(["PROGRESSIVE_JAVASCRIPT_NATIVE",r].filter(Boolean).join("/"),e,t,n)}function u(t){var a=t.initialProps,i={current:null},l={current:null},u={current:null},p={current:null},_=a.loggingMetaData.instanceKey,f=function(){var t=L(),i=l.current;if(!(t==null||i==null)){t.addEventListener("error",function(o){var i=t.error,l=i==null?void 0:i.code,s=r("getErrorNameFromMediaErrorCode")(l),u=i==null?void 0:i.message,c=u==null||u===""?"Unknown media error":u,d=[],m=u!=null?r("getMoreGranularErrorNameFromHTMLVideoElementErrorMessage")(u):null,p=t.src;if(!i&&t.poster!=null&&t.poster!==""&&(c+="(possible_poster_load_failure)"),p!==""){var _=null;(e||(e=n("Promise"))).resolve().then(function(){return a.coreVideoPlayerMetaData.crossOrigin_DO_NOT_USE_UNLESS_YOU_KNOW_WHAT_YOURE_DOING==="use-credentials"&&r("gkx")("19391")?window.fetch(p,{credentials:"include",method:"GET"}):window.fetch(p)}).then(function(e){var t,n=e.status,r=(t=e.headers.get("Content-Type"))!=null?t:"unknown";if(c=c+". Fetched video content with Status:"+n+" Content-Type:"+r,_="URL_RESPONSE_HTTP_"+n,n<200||n>=300)return e.text().then(function(e){d.push(e.length.toString()),c+=" Body:%s:"+e.substr(0,200)+(e.length>200?"...":"")},function(){})}).catch(function(e){typeof e=="object"&&e!=null&&typeof e.name=="string"&&typeof e.message=="string"?(_=_!=null?_:"URL_RESPONSE_FETCH_FAILED/"+e.name,c=c+". Failed fetching video content with error: "+e.name+" "+e.message):(_=_!=null?_:"URL_RESPONSE_FETCH_FAILED",c=c+". Failed fetching video content with unknown error")}).finally(function(){var e=r("err").apply(void 0,[c].concat(d));e.name=[s,m,_].filter(Boolean).join("/"),k(e,"progressive_implementation_error_with_more_info")})}else{var f=r("err").apply(void 0,[c].concat(d));f.name=[s,m,"VIDEO_ELEMENT_SRC_EMPTY"].filter(Boolean).join("/"),k(f,"progressive_implementation_error_with_empty_src")}});try{var s,c=i.graphQLVideoDRMInfo,d=i.videoFBID,m=c&&(s=c.fairplayCert)!=null?s:null;if(n("cr:1680308")&&c&&m!=null&&d!=null)if(p.current=n("cr:1680308").newIfSupported(m,t,d,c.videoLicenseUriMap),p.current==null){var _=r("err")("Fairplay not supported");k(_,"progressive_player_fairplay_handler_missing")}else p.current.addListener("error",function(e){var t=r("err")(e.error);k(t,"progressive_player_fairplay_handler_error")});var f=r("gkx")("18183")?o("VideoPlayerImplementationEngineAPI").ensureVideoElementAPI(T):T.current=o("VideoPlayerImplementationEngineVideoElementAPI").createVideoPlayerImplementationEngineVideoElementAPI(t);u.current=i;{var g=R();E({inbandCaptionsAutogeneratedFromManifest:y.getInbandCaptionsAutogeneratedFromManifest(),inbandCaptionsExpectedFromManifest:y.getInbandCaptionsExpectedFromManifest(),inbandCaptionsExpectedFromProps:g==null?void 0:g.inbandCaptionsExpectedFromProps,representationCaptionsExpectedFromManifest:y.getRepresentationCaptionsExpectedFromManifest(),sideLoadCaptionsExpectedFromProps:g==null?void 0:g.sideLoadCaptionsExpectedFromProps,sideLoadCaptionsUrlFromProps:g==null?void 0:g.sideLoadCaptionsUrlFromProps})}I.dispatch({payload:{selectedVideoQuality:y.getUserSelectedVideoQuality(),streamingFormat:y.getStreamType()},type:"implementation_engine_initialized"});var h=function(){f.setPlayheadPosition(a.coreVideoPlayerMetaData.startTimestamp)};r("UserAgent").isBrowser("IE11")?r("promiseDone")(f.getDOMLoadedMetadataPromise().then(h)):h()}catch(e){k(e,"progressive_player_create_exception")}}},g=function(t,n){if(n==null)return!0;if(t.videoFBID!==n.videoFBID){var e=14;return o("VideoPlayerODS").bumpEntityKey("comet_video_player","ProgressiveImplementation.video_fbid_changed",e),!1}else if(t.hdSrc!==n.hdSrc||t.sdSrc!==n.sdSrc){var r=14;return o("VideoPlayerODS").bumpEntityKey("comet_video_player","ProgressiveImplementation.src_changed",r),!1}else return!1},h=function(t){var e,n,a,s,u={audioOnly:t.coreVideoPlayerMetaData.audioOnly,graphQLVideoDRMInfo:(e=t.coreVideoPlayerMetaData.graphQLVideoDRMInfo)!=null?e:null,hdSrc:t.hdSrc===""?null:(n=t.hdSrc)!=null?n:null,hdSrcPreferred:t.hdSrcPreferred,mediaStream:(a=t.mediaStream)!=null?a:null,sdSrc:t.sdSrc===""?null:(s=t.sdSrc)!=null?s:null,videoFBID:t.coreVideoPlayerMetaData.videoFBID};if(!g(u,i.current))return!1;var c=u.mediaStream!=null;if(!c&&u.hdSrc==null&&u.sdSrc==null)throw r("FBLogger")("comet_video_player").mustfixThrow("Empty hdSrc, sdSrc, and mediaStream");return i.current=u,l.current=o("VideoPlayerProgressiveImplementationEngineUtils").createResolvedVideoInfoProgressive(u),f(),!0},y=o("VideoPlayerProgressiveImplementationEngineExtrasAPI").createVideoPlayerProgressiveImplementationEngineExtrasAPI({getPlayingVideoInfo:function(){if(r("gkx")("440")){var e,t=u.current;if(!t)return null;var n=(e=T.current)==null?void 0:e.getUnderlyingVideoElement().currentSrc;return babelHelpers.extends({},t,{playingSrc:n!=null&&n!==""?n:null})}else return u.current},setUserSelectedVideoQuality:function(t){var e=u.current;if(!e)throw r("FBLogger")("comet_video_player").mustfixThrow("Attempt to switch quality when playingVideoInfo does not exist");var n=o("VideoPlayerImplementationEngineAPI").ensureVideoElementAPI(T),i=n.getUnderlyingVideoElement();if(e.mediaStream!=null){m(i,e.mediaStream),I.dispatch({payload:{},type:"representation_changed"});return}u.current=o("VideoPlayerProgressiveImplementationEngineUtils").updatePlayingVideoInfoProgressiveWithUserSelectedQuality(e,t);var l=u.current.targetSrc;if(l===null){r("FBLogger")("comet_video_player").addMetadata("COMET_VIDEO","VIDEO_ID",a.coreVideoPlayerMetaData.videoFBID).warn("Received null targetSrc from setUserSelectedVideoQuality, selectedQuality: %s",String(t));return}c(l,a.coreVideoPlayerMetaData.expiredVideoUrlRefreshHandler).then(function(e){var t,o,s;if(((t=u.current)==null?void 0:t.targetSrc)===l){d(i,{crossOrigin:(o=a.coreVideoPlayerMetaData.crossOrigin_DO_NOT_USE_UNLESS_YOU_KNOW_WHAT_YOURE_DOING)!=null?o:a.coreVideoPlayerMetaData.isSpherical===!0?"anonymous":null},e);var c=(s=I.getCurrentState().uncontrolledState.videoElementPlayheadPosition)!=null?s:0;if(c>0&&n.setPlayheadPosition(c),I.getCurrentState().controlledState.playbackState==="playing"){var m;(m=n.play())==null||m.catch(function(e){r("FBLogger")("video_playback_www").catching(r("getErrorSafe")(e)).warn("Failed to play video after quality change")})}I.dispatch({payload:{},type:"representation_changed"})}}).catch(function(e){var t;if(((t=u.current)==null?void 0:t.targetSrc)===l){var n=r("getErrorSafe")(e);r("FBLogger")("comet_video_player").addMetadata("COMET_VIDEO","VIDEO_ID",a.coreVideoPlayerMetaData.videoFBID).catching(n).warn("Failed refreshing video URL with original error: %s",String(n))}})}}),C=function(){p.current&&(p.current.destroy(),p.current=null)},b=o("VideoPlayerImplementationEngineAPI").createVideoPlayerImplementationEngine({createDebugAPI:function(t){var e=t.getVideoElementAPI,r=t.loggerToVPL;return n("cr:7276")?n("cr:7276").createVideoPlayerImplementationDebugAPI({engineExtrasAPI:y,getVideoElementAPI:e,loggerToVPL:r}):null},createVideoPlayerError:function(t,n){var e;return s(t,n,(e=u.current)==null?void 0:e.targetSrc)},destroyEngineParts:function(){C()},engineCreateArgs:t,engineExtrasAPI:y,engineMetadata:{isAbrEnabled:!1,playerInstanceKey:_,playerVersion:"comet_progressive",streamingFormat:"progressive"},handleVideoElementChanged:function(t){t!=null&&f()},handleVideoInfoChange:h}),v=b.debugLog,S=b.engine,R=b.getCaptionsInfo,L=b.getVideoElement,E=b.handleCaptionsInfoChange,k=b.handleFatalImplementationError,I=b.machine,T=b.videoElementAPIRef;return S}function c(t,a){return a&&o("videoUrlUtils").isCdnUrlExpired(t)?a(t).then(function(t){var o;return(o=t.refreshedUrl)!=null?o:(e||(e=n("Promise"))).reject(r("err")("Failed refreshing URL"+(t.reason!==null?" with reason: "+t.reason:"")))}):(e||(e=n("Promise"))).resolve(t)}function d(e,t,n){var r=t.crossOrigin;if(n==null||n==="")e.removeAttribute("src");else{var o=e.playbackRate;e.setAttribute("src",n);var a=null;if(r!=null){try{a=new URL(n).origin}catch(e){}if(a!=null&&location.origin!==a)switch(r){case"anonymous":case"use-credentials":e.setAttribute("crossOrigin",r);break;default:e.removeAttribute("crossOrigin");break}}e.playbackRate=o}}function m(e,t){r("assignMediaStream")(e,t)}l.createVideoPlayerProgressiveImplementationEngine=u,l.internal_setHTMLVideoElementSrc=d,l.internal_setHTMLVideoElementSrcObject=m}),98);
__d("VideoPlayerProgressiveImplementationV2.react",["VideoPlayerImplementationEngineAPI","VideoPlayerProgressiveImplementationEngine"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=o("VideoPlayerImplementationEngineAPI").useVideoPlayerImplementationEngine(e,o("VideoPlayerProgressiveImplementationEngine").createVideoPlayerProgressiveImplementationEngine),n=t.reactVideoFrameAndComponents;return n}l.default=e}),98);
__d("WebSessionExtender",["WebSession","clearInterval","cr:13141","cr:913","setInterval"],(function(t,n,r,o,a,i,l){"use strict";var e=2e4,s=new Set,u=null;function c(t,a){a===void 0&&(a="extender"),s.add(t),u==null&&(o("WebSession").extend(Date.now()+e+2e3),n("cr:13141")==null||n("cr:13141").extend(),u=r("setInterval")(function(){o("WebSession").extend(Date.now()+e+2e3),n("cr:13141")==null||n("cr:13141").extend(),n("cr:913")&&new(n("cr:913"))().setClientTime(Date.now()).setWebsessionID(o("WebSession").getId()).setReason(a).log()},e))}function d(e){s.delete(e);var t=s.size;t===0&&u!=null&&(r("clearInterval")(u),u=null)}l.subscribe=c,l.unsubscribe=d}),98);
__d("VideoPlayerWebSessionExtender.react",["VideoPlayerHooks","WebSessionExtender","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=e||(e=o("react")),c=u.useEffect,d=u.useId;function m(){var e=o("react-compiler-runtime").c(4),t=(s||(s=o("VideoPlayerHooks"))).usePlaying(),n=d(),r,a;return e[0]!==t||e[1]!==n?(r=function(){if(t)return o("WebSessionExtender").subscribe(n,"video"),(function(){o("WebSessionExtender").unsubscribe(n)})},a=[t,n],e[0]=t,e[1]=n,e[2]=r,e[3]=a):(r=e[2],a=e[3]),c(r,a),null}l.default=m}),98);
__d("useVideoPlayerDefaultLoadingIndicatorsLogic",["VideoPlayerHooks","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){var t=o("react-compiler-runtime").c(4),n=(e||(e=o("VideoPlayerHooks"))).useStalling(),r=e.useStreamInterrupted(),a=e.useIsLiveRewindActive(),i=r&&!a,l=n,s=i?"live_video_interrupted_overlay":l?"spinner":"none",u;return t[0]!==i||t[1]!==s||t[2]!==l?(u={liveVideoInterruptedOverlayVisible:i,loadingIndicatorType:s,spinnerVisible:l},t[0]=i,t[1]=s,t[2]=l,t[3]=u):u=t[3],u}l.default=s}),98);
__d("useVideoPlayerDefaultLoadingIndicators",["CometPlaceholder.react","deferredLoadComponent","once","react","react-compiler-runtime","requireDeferred","requireDeferredForDisplay","useVideoPlayerDefaultLoadingIndicatorsLogic"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=r("deferredLoadComponent")(r("requireDeferredForDisplay")("VideoPlayerSpinner.react").__setRef("useVideoPlayerDefaultLoadingIndicators")),c=r("deferredLoadComponent")(r("requireDeferred")("VideoPlayerWithLiveVideoInterruptedOverlay.react").__setRef("useVideoPlayerDefaultLoadingIndicators")),d=r("once")(function(){return s.jsx(r("CometPlaceholder.react"),{fallback:null,name:i.id,children:s.jsx(c,{})})});function m(){var e=o("react-compiler-runtime").c(6),t=r("useVideoPlayerDefaultLoadingIndicatorsLogic")(),n=t.loadingIndicatorType,a=t.spinnerVisible,i;e[0]!==a?(i=s.jsx(u,{isVisible:a}),e[0]=a,e[1]=i):i=e[1];var l=i,c;e:switch(n){case"spinner":{c=l;break e}case"live_video_interrupted_overlay":{var m;e[2]===Symbol.for("react.memo_cache_sentinel")?(m=d(),e[2]=m):m=e[2],c=m;break e}case"none":default:c=l}var p;return e[3]!==c||e[4]!==n?(p={loadingIndicatorElement:c,loadingIndicatorType:n},e[3]=c,e[4]=n,e[5]=p):p=e[5],p}l.default=m}),98);
__d("useVideoPlayerUnifiedCVCProvider",["CvcV3HttpEventFalcoEvent","UnifiedVideoCVCSubscription","VideoPlayerHooks","createVideoStateHook","getPlayerFormatForLogData","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(e||(e=o("react"))).useEffect,c=o("createVideoStateHook").createVideoStateHook(null),d=c.setterHook,m=o("createVideoStateHook").createVideoStateHook(null),p=m.setterHook,_=m.valueHook;function f(e){var t=o("react-compiler-runtime").c(12),n=e.disableSubscription,a=e.playerFormat,i=e.subOrigin,l=e.videoFBID,c=(s||(s=o("VideoPlayerHooks"))).useIsLive(),m=s.useIsFullscreen(),_=s.useIsDesktopPictureInPicture(),f=s.useController(),g=d(),h=p(),y,C;t[0]!==n||t[1]!==_||t[2]!==m||t[3]!==c||t[4]!==a||t[5]!==h||t[6]!==g||t[7]!==i||t[8]!==f||t[9]!==l?(y=function(){if(n===!0){r("CvcV3HttpEventFalcoEvent").log(function(){return{countable_id:l,name:"disable_subscription"}});return}var e=new(r("UnifiedVideoCVCSubscription"))(l,r("getPlayerFormatForLogData")({isDesktopPictureInPicture:_,isFullscreen:m},a),i,f,c,function(e){h(e)});return g(e),(function(){e.destroy()})},C=[_,m,c,n,a,h,g,i,f,l],t[0]=n,t[1]=_,t[2]=m,t[3]=c,t[4]=a,t[5]=h,t[6]=g,t[7]=i,t[8]=f,t[9]=l,t[10]=y,t[11]=C):(y=t[10],C=t[11]),u(y,C)}var g=_;l.useVideoPlayerUnifiedCVCProvider=f,l.useVideoPlayerUnifiedCVCData=g}),98);
__d("VideoPlayerXImplSurface.react",["CoreVideoPlayerAudioClient.react","CoreVideoPlayerAutoplayClient.react","VideoPlayerCaptionsAreaDeferred.react","VideoPlayerHooks","VideoPlayerIMFMetadataContext","VideoPlayerInteractionOverlay.react","VideoPlayerPortalingPlaceInfoProvider.react","VideoPlayerWebSessionExtender.react","cr:1222","cr:1954434","cr:7266","gkx","react","react-compiler-runtime","useVideoPlayerDefaultLoadingIndicators","useVideoPlayerUnifiedCVCProvider"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=s||(s=o("react")),d=s.useImperativeHandle,m=(e=n("cr:7266"))==null?void 0:e.VideoPlayerWithDebugOverlay;function p(e){var t=o("react-compiler-runtime").c(26),a=e.apiRef,i=e.children,l=e.disableCVCSubscription,s=e.disableLoadingIndicator,p=e.disableLogging,_=e.instreamVideoAdBreaksPlayer,f=e.playerFormat,g=e.subOrigin,h=e.videoFBID,y=e.videoPlayerIMFFromVideoMetadata,C=e.videoPlayerSpherical,b=s===void 0?!1:s,v=(u||(u=o("VideoPlayerHooks"))).useController(),S=o("VideoPlayerPortalingPlaceInfoProvider.react").useVideoPlayerPortalingPlaceInfo(),R,L;t[0]!==v||t[1]!==S?(R=function(){return{controller:v,portalingPlaceInfo:S}},L=[v,S],t[0]=v,t[1]=S,t[2]=R,t[3]=L):(R=t[2],L=t[3]),d(typeof a=="function"?a:null,R,L);var E=p===!0||l===!0,k;t[4]!==f||t[5]!==g||t[6]!==E||t[7]!==h?(k={disableSubscription:E,playerFormat:f,subOrigin:g,videoFBID:h},t[4]=f,t[5]=g,t[6]=E,t[7]=h,t[8]=k):k=t[8],o("useVideoPlayerUnifiedCVCProvider").useVideoPlayerUnifiedCVCProvider(k);var I=r("useVideoPlayerDefaultLoadingIndicators")(),T=I.loadingIndicatorElement,D=y!=null?y:null,x=b?null:T,$,P;t[9]===Symbol.for("react.memo_cache_sentinel")?($=r("gkx")("24328")?c.jsx(o("VideoPlayerInteractionOverlay.react").VideoPlayerInteractionOverlay,{}):null,P=n("cr:1222")!=null?c.jsx(n("cr:1222"),{}):null,t[9]=$,t[10]=P):($=t[9],P=t[10]);var N;t[11]!==i||t[12]!==_?(N=c.jsxs(r("VideoPlayerCaptionsAreaDeferred.react"),{children:[i,_]}),t[11]=i,t[12]=_,t[13]=N):N=t[13];var M,w,A;t[14]===Symbol.for("react.memo_cache_sentinel")?(M=c.jsx(r("CoreVideoPlayerAutoplayClient.react"),{}),w=c.jsx(r("CoreVideoPlayerAudioClient.react"),{}),A=n("cr:1954434")?c.jsx(n("cr:1954434"),{}):null,t[14]=M,t[15]=w,t[16]=A):(M=t[14],w=t[15],A=t[16]);var F;t[17]!==g?(F=m?c.jsx(m,{subOrigin:g}):null,t[17]=g,t[18]=F):F=t[18];var O;t[19]===Symbol.for("react.memo_cache_sentinel")?(O=c.jsx(r("VideoPlayerWebSessionExtender.react"),{}),t[19]=O):O=t[19];var B;return t[20]!==N||t[21]!==F||t[22]!==D||t[23]!==x||t[24]!==C?(B=c.jsxs(o("VideoPlayerIMFMetadataContext").VideoPlayerIMFMetadataContextProvider,{value:D,children:[C,x,$,P,N,M,w,A,F,O]}),t[20]=N,t[21]=F,t[22]=D,t[23]=x,t[24]=C,t[25]=B):B=t[25],B}l.default=p}),98);
__d("VideoPlayerXImpl.react",["CoreVideoPlayerMetaData","CoreVideoPlayerWithComponents.react","VideoPlayerXImplSurface.react","react","react-compiler-runtime","usePlayerOriginRouteTracePolicy","useRouteProductAttribution"],(function(t,n,r,o,a,i,l){"use strict";var e=["apiRef","children","disableLoadingIndicator","implementations","instreamVideoAdBreaksPlayer","portalingEnabled","portalingFromVideoID","portalingPlaceMetaData","portalingRenderPlaceholder","videoPlayerIMFFromVideoMetadata","videoPlayerSpherical"],s,u=s||(s=o("react"));function c(t){var n=o("react-compiler-runtime").c(20),a=t.apiRef,i=t.children,l=t.disableLoadingIndicator,s=t.implementations,c=t.instreamVideoAdBreaksPlayer,d=t.portalingEnabled,m=t.portalingFromVideoID,p=t.portalingPlaceMetaData,_=t.portalingRenderPlaceholder,f=t.videoPlayerIMFFromVideoMetadata,g=t.videoPlayerSpherical,h=babelHelpers.objectWithoutPropertiesLoose(t,e),y=r("usePlayerOriginRouteTracePolicy")(),C=r("useRouteProductAttribution")();C||(C=h.productAttribution);var b=o("CoreVideoPlayerMetaData").applyDefaultsToCoreVideoPlayerMetaData(babelHelpers.extends({},h,{productAttribution:C,routeTracePolicy:y})),v;n[0]!==a||n[1]!==i||n[2]!==b.loggingConfig.disableCVCSubscription||n[3]!==b.loggingConfig.disableLogging||n[4]!==b.playerFormat||n[5]!==b.subOrigin||n[6]!==b.videoFBID||n[7]!==l||n[8]!==c||n[9]!==f||n[10]!==g?(v=u.jsx(r("VideoPlayerXImplSurface.react"),{apiRef:a,children:i,disableCVCSubscription:b.loggingConfig.disableCVCSubscription,disableLoadingIndicator:l,disableLogging:b.loggingConfig.disableLogging,instreamVideoAdBreaksPlayer:c,playerFormat:b.playerFormat,subOrigin:b.subOrigin,videoFBID:b.videoFBID,videoPlayerIMFFromVideoMetadata:f,videoPlayerSpherical:g}),n[0]=a,n[1]=i,n[2]=b.loggingConfig.disableCVCSubscription,n[3]=b.loggingConfig.disableLogging,n[4]=b.playerFormat,n[5]=b.subOrigin,n[6]=b.videoFBID,n[7]=l,n[8]=c,n[9]=f,n[10]=g,n[11]=v):v=n[11];var S;return n[12]!==b||n[13]!==s||n[14]!==d||n[15]!==m||n[16]!==p||n[17]!==_||n[18]!==v?(S=u.jsx(r("CoreVideoPlayerWithComponents.react"),{coreVideoPlayerMetaData:b,implementations:s,portalingEnabled:d,portalingFromVideoID:m,portalingPlaceMetaData:p,portalingRenderPlaceholder:_,children:v}),n[12]=b,n[13]=s,n[14]=d,n[15]=m,n[16]=p,n[17]=_,n[18]=v,n[19]=S):S=n[19],S}l.default=c}),98);
__d("defaultErrorBoundaryFallback",["VideoPlayerFallbackCover.react","getVideoPlayerUserFacingErrorMessageFromError","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){var t=r("getVideoPlayerUserFacingErrorMessageFromError")(e);return s.jsx(r("VideoPlayerFallbackCover.react"),{debugError:e,message:t})}u.displayName=u.name+" [from "+i.id+"]",l.default=u}),98);
__d("getVideoPlayerAutoplayProps",[],(function(t,n,r,o,a,i){"use strict";function e(e,t,n){var r=t!=null?t:"respect_user_settings",o=r==="dangerously_always_autoplay",a=n!=null?n:"unknown",i=e.autoplaySetting||"default_autoplay",l=i==="off",s=o||r==="respect_user_settings"&&!l&&e.canAutoplay,u=r==="do_not_autoplay"?a:e.autoplayGatingResult,c=s?"allow":r==="dangerously_disable_autoplay_management"?"dangerously_disable_autoplay_management":"deny";return{autoplayGatingResult:u,autoplaySetting:i,canAutoplay:c}}i.default=e}),66);/*FB_PKG_DELIM*/
__d("AudioSettingsVolumeSetting",[],(function(t,n,r,o,a,i){var e=Object.freeze({DEFAULT:"default",QUIET:"quiet"});i.default=e}),66);
__d("CometVideoPlayerNextgendashAvailability",[],(function(t,n,r,o,a,i){var e=Object.freeze({AVAILABLE:"AVAILABLE",UNAVAILABLE_NEXTGENDASH_GK:"UNAVAILABLE_NEXTGENDASH_GK",UNAVAILABLE_OZ_PLAYER_AVAILABILITY:"UNAVAILABLE_OZ_PLAYER_AVAILABILITY",UNAVAILABLE_TEMPORARY_FOR_THIS_KIND_OF_VIDEO:"UNAVAILABLE_TEMPORARY_FOR_THIS_KIND_OF_VIDEO",UNAVAILABLE_TEMPORARY_FOR_THIS_KIND_OF_VIDEO_1:"UNAVAILABLE_TEMPORARY_FOR_THIS_KIND_OF_VIDEO_1",UNAVAILABLE_TEMPORARY_FOR_THIS_KIND_OF_VIDEO_2:"UNAVAILABLE_TEMPORARY_FOR_THIS_KIND_OF_VIDEO_2",UNAVAILABLE_TEMPORARY_FOR_THIS_KIND_OF_VIDEO_3:"UNAVAILABLE_TEMPORARY_FOR_THIS_KIND_OF_VIDEO_3",UNAVAILABLE_TEMPORARY_FOR_THIS_KIND_OF_VIDEO_4:"UNAVAILABLE_TEMPORARY_FOR_THIS_KIND_OF_VIDEO_4",UNAVAILABLE_TEMPORARY_FOR_THIS_KIND_OF_VIDEO_5:"UNAVAILABLE_TEMPORARY_FOR_THIS_KIND_OF_VIDEO_5",UNAVAILABLE_FROM_JS_OZ_PLAYER_AVAILABILITY:"UNAVAILABLE_FROM_JS_OZ_PLAYER_AVAILABILITY",UNAVAILABLE_FROM_JS_NO_INFO_FROM_SERVER:"UNAVAILABLE_FROM_JS_NO_INFO_FROM_SERVER",UNAVAILABLE_FROM_JS_NEXTGENDASH_GK:"UNAVAILABLE_FROM_JS_NEXTGENDASH_GK",UNAVAILABLE_FROM_JS_NOT_DESIRED:"UNAVAILABLE_FROM_JS_NOT_DESIRED"});i.default=e}),66);
__d("CometVideoPlayerVideoDeliveryResponse",["emptyFunction","fb-error"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t={quality:"SD"};return{ok:!0,value:{dash_manifest_urls:[],dash_manifests:[],hls_playlist_urls:[],progressive_urls:[{failure_reason:e!=null&&e!==""?null:{message_format:"makeVideoDeliveryResponseResultFromSingleProgressiveUrl received empty value",message_params:[],type:"from_js_progressive_url_is_empty"},metadata:t,progressive_url:e!=null&&e!==""?e:null}]}}}function s(e,t){t===void 0&&(t=!1);var n=null,o=null,a=null,i=null,l=[],s=[],c=[],d=[],m=[];if(e.ok!==!0){var p=r("fb-error").err("VideoDeliveryResponse API failed: %s",JSON.stringify(e.errors.map(function(e){try{return JSON.stringify(e),e}catch(t){return String(e)}})));p.name="VideoDeliveryResponseAPIFailed",l.push(p)}else{var _,f,g,h,y=e.value,C=u(s,"dash_manifests","DashManifest",y.dash_manifests,r("emptyFunction").thatReturnsTrue,function(e){return e.manifest_xml!=null&&e.manifest_xml!==""?e:null})[0],b=u(c,"dash_manifest_urls","DashManifestURL",y.dash_manifest_urls,r("emptyFunction").thatReturnsTrue,function(e){return e.manifest_url!=null&&e.manifest_url!==""?e:null})[0],v=u(d,"progressive_urls","ProgressiveURLHD",y.progressive_urls,function(e){var t;return((t=e.metadata)==null?void 0:t.quality)==="HD"},function(e){return e.progressive_url!=null?e:null})[0],S=u(d,"progressive_urls","ProgressiveURLSD",y.progressive_urls,function(e){var t;return((t=e.metadata)==null?void 0:t.quality)==="SD"},function(e){return e.progressive_url!=null?e:null})[0];if(n=(_=C==null?void 0:C.manifest_xml)!=null?_:null,o=(f=b==null?void 0:b.manifest_url)!=null?f:null,a=(g=v==null?void 0:v.progressive_url)!=null?g:null,i=(h=S==null?void 0:S.progressive_url)!=null?h:null,a==null&&i==null&&t){var R,L=u(m,"hls_playlist_urls","HLSPlaylistURL",y.hls_playlist_urls,r("emptyFunction").thatReturnsTrue,function(e){return e.hls_playlist_url!=null?e:null})[0];a=null,i=(R=L==null?void 0:L.hls_playlist_url)!=null?R:null}}return{browserNativeHdUrl:a,browserNativeSdUrl:i,dashManifestDeliveryFailures:s,dashManifestUrl:o,dashManifestUrlDeliveryFailures:c,dashManifestXmlString:n,hlsDeliveryFailures:m,progressiveDeliveryFailures:d,videoDeliveryResponseAPIFailures:l}}function u(e,t,n,r,o,a){var i=r.filter(o),l=i.map(function(e){return e.failure_reason==null?a(e):null}).filter(Boolean);if(i.length===0)e.push(d(t,n,r));else if(l.length===0){var s=i.filter(function(e){return e.failure_reason!=null});s.length===0?e.push(m(t,n,r)):e.push.apply(e,s.map(function(e){return e.failure_reason!=null?c(t,n,e.failure_reason,e.metadata):null}).filter(Boolean))}return l}function c(e,t,n,o){var a;try{var i;a=(i=JSON.stringify(o))!=null?i:String(o)}catch(e){a=String(o)}var l=r("fb-error").err.apply(r("fb-error"),["VideoDeliveryResponse "+e+" failure for "+t+": "+n.type+"; metadata=%s"+(n.message_format!=null&&n.message_format!==""?"; "+n.message_format:""),a].concat(n.message_params));return l.name="VideoDeliveryResponseFailureReason/"+e+"("+t+")/"+n.type,l}function d(e,t,n){var o;try{var a;o=(a=JSON.stringify(n))!=null?a:"N/A"}catch(e){o="N/A"}var i=r("fb-error").err("VideoDeliveryResponse "+e+" failure for "+t+": no matching items; all items: %s",o);return i.name="VideoDeliveryResponseContractViolation/"+e+"("+t+")/no_matching",i}function m(e,t,n){var o;try{var a;o=(a=JSON.stringify(n))!=null?a:"N/A"}catch(e){o="N/A"}var i=r("fb-error").err("VideoDeliveryResponse "+e+" failure for "+t+": no succeeded or failed items; all items: %s",o);return i.name="VideoDeliveryResponseContractViolation/"+e+"("+t+")/no_success_and_failure",i}l.makeVideoDeliveryResponseResultFromSingleProgressiveUrl=e,l.processVideoDeliveryResponseResult=s,l.extractVideoDeliveryResponseSuccessAndFailures=u}),98);
__d("CometVideoPlayerVideoDeliveryResponseRelayFragment_video_delivery_response.graphql",["cr:9059"],(function(t,n,r,o,a,i,l){"use strict";i.exports=n("cr:9059")}),34);
__d("CometVideoPlayerVideoDeliveryResponseRelayFragment",["CometRelay","CometVideoPlayerVideoDeliveryResponseRelayFragment_video_delivery_response.graphql","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(s||(s=o("react"))).useMemo,c=e!==void 0?e:e=n("CometVideoPlayerVideoDeliveryResponseRelayFragment_video_delivery_response.graphql");function d(e){var t=o("react-compiler-runtime").c(4),n=e!=null&&e.ok&&e.value!=null?e.value:null,r=o("CometRelay").useFragment(c,n),a;return t[0]!==n||t[1]!==r||t[2]!==e?(a=e==null||n==null||r==null?null:e.ok?{ok:!0,value:r}:{errors:e.errors,ok:!1},t[0]=n,t[1]=r,t[2]=e,t[3]=a):a=t[3],a}l.CometVideoPlayerVideoDeliveryResponseRelayFragment=c,l.useCometVideoPlayerVideoDeliveryResponseResultFromRelay=d}),98);
__d("CometVideoPlayerVideoDeliveryResponseRelayFragment_video_delivery_response.facebook.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={alias:null,args:null,concreteType:"XFBVideoDeliveryFailureReason",kind:"LinkedField",name:"failure_reason",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"message_format",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"message_params",storageKey:null}],storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:{throwOnFieldError:!0},name:"CometVideoPlayerVideoDeliveryResponseRelayFragment_video_delivery_response",selections:[{alias:null,args:null,concreteType:"XFBDashManifestResponse",kind:"LinkedField",name:"dash_manifests",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"manifest_xml",storageKey:null},e],storageKey:null},{alias:null,args:null,concreteType:"XFBDashManifestUrlResponse",kind:"LinkedField",name:"dash_manifest_urls",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"manifest_url",storageKey:null},e],storageKey:null},{alias:null,args:null,concreteType:"XFBProgressiveUrlResponse",kind:"LinkedField",name:"progressive_urls",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"progressive_url",storageKey:null},e,{alias:null,args:null,concreteType:"XFBProgressiveUrlMetadata",kind:"LinkedField",name:"metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"quality",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBHlsPlaylistUrlResponse",kind:"LinkedField",name:"hls_playlist_urls",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"hls_playlist_url",storageKey:null},e],storageKey:null}],type:"XFBVideoDeliveryResponse",abstractKey:null}})();a.exports=e}),null);
__d("FBNucleusResizeUpFilled20Icon.react",["react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){return s.jsxs("svg",babelHelpers.extends({viewBox:"0 0 20 20",width:"1em",height:"1em",fill:"currentColor"},e,{children:[e.title!=null&&s.jsx("title",{children:e.title}),e.children!=null&&s.jsx("defs",{children:e.children}),s.jsx("path",{d:"M16 5.414V8a1 1 0 1 0 2 0V4a2 2 0 0 0-2-2h-4a1 1 0 1 0 0 2h2.586l-3.293 3.293a1 1 0 0 0 1.414 1.414L16 5.414zM3 11a1 1 0 0 1 1 1v2.586l3.293-3.293a1 1 0 0 1 1.414 1.414L5.414 16H8a1 1 0 1 1 0 2H4a2 2 0 0 1-2-2v-4a1 1 0 0 1 1-1z"})]}))}u.displayName=u.name+" [from "+i.id+"]",u._size=20,u._isSVG=!0;var c=u;l.default=c}),98);
__d("FBUnifiedVideoFeedConnectionIDContext",["react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u={connectionID:""},c=s.createContext(u);l.default=c}),98);
__d("FBUnifiedVideoHideReelContext",["react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u={addHiddenReel:function(t){},hiddenReels:null,lastHiddenReel:null,lastHiddenReelIndex:null,removeHiddenReel:function(t){}},c=s.createContext(u);l.default=c}),98);
__d("FbShortsSingleVideoClickFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("1369"),s=o("FalcoLoggerInternal").create("fb_shorts_single_video_click",e),u=s;l.default=u}),98);
__d("GraphQLVideoDRMInfo",["isEmptyObject"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.fairplay_cert,n=e.graph_api_video_license_uri,o=e.video_license_uri_map,a=e.widevine_cert,i={fairplayCert:t,graphApiVideoLicenseUri:n!=null?n:null,videoLicenseUriMap:o,widevineCert:a};return i.graphApiVideoLicenseUri===null&&r("isEmptyObject")(i.videoLicenseUriMap)?null:i}l.makeGraphQLVideoDRMInfo=e}),98);
__d("GraphQLVideoP2PSettings",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["HiveJava","HiveJS","StatsJS"]);function l(t){var n;return(n=e.cast(t))!=null?n:null}i.HiveTechOrder=e,i.hiveTechOrderOrNull=l}),66);
__d("InstreamVideoAdBreaksPlayer_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"InstreamVideoAdBreaksPlayer_video",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,concreteType:"InstreamExtraConfig",kind:"LinkedField",name:"instream_extra_config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"instream_halo_delay_time_seconds",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"InstreamVideoAdBreaks",kind:"LinkedField",name:"instream_video_ad_breaks_comet",plural:!1,selections:[{args:null,documentName:"InstreamVideoAdBreaksPlayer_video_instream_video_ad_breaks_comet",fragmentName:"InstreamVideoAdBreaksPlayerImpl_adBreaks",fragmentPropName:"adBreaks",kind:"ModuleImport"}],storageKey:null}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("InstreamVideoAdBreaksPlayer.react",["CometPlaceholder.react","CometRelay","InstreamVideoAdBreaksPlayer_video.graphql","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=s||(s=o("react"));function c(t){var a=o("react-compiler-runtime").c(11),l=t.playerFormat,s=t.subOrigin,c=t.video,d=o("CometRelay").useFragment(e!==void 0?e:e=n("InstreamVideoAdBreaksPlayer_video.graphql"),c),m=d.id,p=d.instream_extra_config,_=d.instream_video_ad_breaks_comet,f=p==null?void 0:p.instream_halo_delay_time_seconds,g;a[0]!==f?(g={instreamHaloDelayTimeSeconds:f},a[0]=f,a[1]=g):g=a[1];var h;a[2]!==_||a[3]!==l||a[4]!==s||a[5]!==g||a[6]!==m?(h={instreamExtraConfig:g,instreamVideoAdBreaksComet:_,playerFormat:l,subOrigin:s,videoFBID:m},a[2]=_,a[3]=l,a[4]=s,a[5]=g,a[6]=m,a[7]=h):h=a[7];var y;return a[8]!==_||a[9]!==h?(y=u.jsx(r("CometPlaceholder.react"),{fallback:null,name:i.id,children:u.jsx(o("CometRelay").MatchContainer,{match:_,props:h})}),a[8]=_,a[9]=h,a[10]=y):y=a[10],y}l.default=c}),98);
__d("LatencySensitiveType",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum")({NORMAL:0,LOW:1,ULTRA_LOW:2}),l=e;i.default=l}),66);
__d("getAvailableMimeCodecsFromDashManifest",[],(function(t,n,r,o,a,i){"use strict";function e(e){var t=/^(audio|video)\/.*$/;return t.test(e)}function l(t,n){var r=[],o=n?window.ManagedMediaSource:window.MediaSource;if(t!=null){for(var a=/mimeType=\"([^\"]*)\"[^\>]*codecs=\"([^\"]*)\"/g,i=/codecs=\"([^\"]*)\"[^\>]*mimeType=\"([^\"]*)\"/g,l,s=[];l=a.exec(t);)s.push([l[1],l[2]]);for(;l=i.exec(t);)s.push([l[2],l[1]]);for(var u of s){var c=u[0],d=u[1],m=c+'; codecs="'+d+'"',p=c.startsWith("audio")?"audio":c.startsWith("video")?"video":"other",_=!0,f=!1;e(m)&&(f=!0,_=o?o.isTypeSupported(m):!1),r.push({codecs:d,isRequiredForPlayback:f,isTypeSupported:_,mimeCodec:m,mimeType:c,representationType:p})}}return r}i.default=l}),66);
__d("VideoPlayerOzImplementationData",["err","getAvailableMimeCodecsFromDashManifest"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.canUseOz,n=e.dashManifestUrl,o=e.dashManifestUrlOverride_DO_NOT_USE,a=e.dashManifestXmlString,i=e.experimentationConfig,l=e.initialAudioUserPreferredLanguage,s=e.initiateLivePlaybackFromStart,u=e.minQualityPreference,c=e.skipManifestPrevalidation;if(t!==!0){var d=r("err")("canUseOz="+String(t));return d.name="GotCanUseOz/"+String(t),d}var m=o!=null||a==null||a===""?null:a,p=o!=null?o:n==null||n===""?null:n;if(m==null&&p==null){var _=r("err")("Got no manifest XML and no URL to it");return _.name="GotNoManifestOrURL",_}var f=i.getBool("enable_managed_media_source",!1);if(f){if(!window.ManagedMediaSource){var g=r("err")("window.ManagedMediaSource is missing");return g.name="GotMissingManagedMediaSourceAPI",g}}else if(!window.MediaSource){var h=r("err")("window.MediaSource is missing");return h.name="GotMissingMediaSourceAPI",h}if(m!=null&&c!==!0){var y=r("getAvailableMimeCodecsFromDashManifest")(m,f).filter(function(e){return e.isRequiredForPlayback}),C=y.filter(function(e){return!e.isTypeSupported});if(C.length>0){var b=r("err")("%s out of %s codecs in DASH manifest required for playback are unsupported: %s",String(C.length),String(y.length),y.map(function(e){return e.mimeType+"/"+e.codecs+"="+(e.isTypeSupported?"yes":"no")}).join(", "));return b.name="GotManifestWithUnsupportedCodecs",b}}return{experimentationConfig:i,initialAudioUserPreferredLanguage:l!=null?l:null,initialVideoVariant:{lang:l!=null?l:null,role:null},initiateLivePlaybackFromStart:s!=null?s:!1,manifest:m,manifestUrl:p,minQualityPreference:u!=null?u:null}}l.makeOzImplementationData=e}),98);
__d("VideoPlayerNextgendashEngineData",["VideoPlayerOzImplementationData","err"],(function(t,n,r,o,a,i,l){"use strict";var e=["nextgendashAvailability"];function s(t){var n=t.nextgendashAvailability,a=babelHelpers.objectWithoutPropertiesLoose(t,e);if(n!=="AVAILABLE"){var i=r("err")("nextgendashAvailability="+n);return i.name="GotNextgendashAvailability/"+n,i}var l=o("VideoPlayerOzImplementationData").makeOzImplementationData(a);return l}l.makeNextgendashEngineData=s}),98);
__d("VideoPlayerNextgendashImplementation.react",["VideoPlayerImplementationEngineAPI","VideoPlayerNextgendashEngine"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=o("VideoPlayerImplementationEngineAPI").useVideoPlayerImplementationEngine(e,o("VideoPlayerNextgendashEngine").createVideoPlayerNextgendashEngine),n=t.reactVideoFrameAndComponents;return n}l.default=e}),98);
__d("VideoPlayerOzImplementationDefaultConditional.react",["cr:1195"],(function(t,n,r,o,a,i,l){"use strict";l.default=n("cr:1195")}),98);
__d("VideoPlayerOzWWWConfig",[],(function(t,n,r,o,a,i){"use strict";var e="oz_www_",l=(function(){function t(e){this.$1=e}var n=t.prototype;return n.getBool=function(n,r){return this.$1.getBool(e+n,r)},n.getNumber=function(n,r){return this.$1.getNumber(e+n,r)},n.getString=function(n,r){return this.$1.getString(e+n,r)},n.setContext=function(t,n){this.$1.setContext(t,n)},n.getAllContexts=function(){return this.$1.getAllContexts()},t})();i.default=l}),66);
__d("VideoPlayerRelayFragmentRefetchQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="25000055016339993"}),null);
__d("VideoPlayerRelayFragmentRefetchQuery.graphql",["VideoPlayerRelay_video$normalization.graphql","VideoPlayerRelayFragmentRefetchQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={defaultValue:null,kind:"LocalArgument",name:"id"},t={defaultValue:null,kind:"LocalArgument",name:"playerOrigin"},r={defaultValue:null,kind:"LocalArgument",name:"playerSuborigin"},o=[{kind:"Variable",name:"id",variableName:"id"}];return{fragment:{argumentDefinitions:[e,t,r],kind:"Fragment",metadata:null,name:"VideoPlayerRelayFragmentRefetchQuery",selections:[{alias:null,args:o,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[{kind:"Variable",name:"playerOrigin",variableName:"playerOrigin"},{kind:"Variable",name:"playerSuborigin",variableName:"playerSuborigin"}],kind:"FragmentSpread",name:"VideoPlayerRelay_video"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,r,e],kind:"Operation",name:"VideoPlayerRelayFragmentRefetchQuery",selections:[{alias:null,args:o,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{args:[{kind:"Variable",name:"VideoPlayerRelay_video$playerOrigin",variableName:"playerOrigin"},{kind:"Variable",name:"VideoPlayerRelay_video$playerSuborigin",variableName:"playerSuborigin"}],fragment:n("VideoPlayerRelay_video$normalization.graphql"),kind:"FragmentSpread"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:n("VideoPlayerRelayFragmentRefetchQuery_facebookRelayOperation"),metadata:{},name:"VideoPlayerRelayFragmentRefetchQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("VideoPlayerRelay_video.graphql",["VideoPlayerRelayFragmentRefetchQuery.graphql"],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"playerOrigin"},{defaultValue:null,kind:"LocalArgument",name:"playerSuborigin"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:n("VideoPlayerRelayFragmentRefetchQuery.graphql"),identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"VideoPlayerRelay_video",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"animated_image_caption",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"broadcaster_origin",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"broadcast_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"broadcast_status",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_live_streaming",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_live_trace_enabled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_looping",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_video_broadcast",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_podcast_video",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"loop_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_spherical",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_spherical_enabled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"unsupported_browser_message",storageKey:null},{alias:null,args:null,concreteType:"MusicVideoMetadata",kind:"LinkedField",name:"pmv_metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"LatencySensitiveConfig",kind:"LinkedField",name:"latency_sensitive_config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"broadcast_latency_sensitivity",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"LivePlaybackInstrumentationConfigParams",kind:"LinkedField",name:"live_playback_instrumentation_configs",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_client_triggered_trace_enabled",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_ncsr",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"permalink_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"captions_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"seo_web_crawler_lookaside_url",storageKey:null},{alias:null,args:[{kind:"Variable",name:"player_origin",variableName:"playerOrigin"},{kind:"Variable",name:"player_suborigin",variableName:"playerSuborigin"}],kind:"ScalarField",name:"dash_prefetch_experimental",storageKey:null},{args:null,kind:"FragmentSpread",name:"useVideoPlayerAvailableCaptionsLocalesFromRelay_video"},{args:null,kind:"FragmentSpread",name:"useVideoPlayerVideoStatusRelayWithFallbackCover_video"},{args:null,kind:"FragmentSpread",name:"useVideoImplementationsParamsRelayImpl_video"},{args:null,kind:"FragmentSpread",name:"useVideoPlayerShakaConfig_video"},{args:null,kind:"FragmentSpread",name:"useVideoPlayerShakaPerformanceLoggerRelayImpl_video"},{args:null,kind:"FragmentSpread",name:"useVideoPlayerShakaPerformanceLoggerBuilder_video"},{args:null,kind:"FragmentSpread",name:"useGraphQLVideoAutoplayGatingResult_video"},{args:null,kind:"FragmentSpread",name:"useGraphQLVideoDRMInfo_video"},{args:null,kind:"FragmentSpread",name:"useGraphQLVideoP2PSettings_video"},{args:null,kind:"FragmentSpread",name:"useVideoPlayerAudioSettings_video"},{args:null,kind:"FragmentSpread",name:"useVideoPlayerCaptionsSettings_video"},{args:null,kind:"FragmentSpread",name:"useVideoPlayerLiveLatencyKnobSettings_video"},{args:null,kind:"FragmentSpread",name:"useVideoPlayerAudioAvailabilityInfoRelay_video"},{alias:null,args:null,concreteType:"SphericalVideoRenderer",kind:"LinkedField",name:"spherical_video_renderer",plural:!1,selections:[{args:null,documentName:"VideoPlayerRelay_video_spherical_video_renderer",fragmentName:"VideoPlayerSphericalRelay_sphericalVideoRenderer",fragmentPropName:"sphericalVideoRenderer",kind:"ModuleImport"}],storageKey:null},{kind:"Defer",selections:[{args:null,kind:"FragmentSpread",name:"InstreamVideoAdBreaksPlayer_video"}]},{args:null,kind:"FragmentSpread",name:"VideoPlayerVideoIsCastingCover_video"},{args:null,kind:"FragmentSpread",name:"useVideoPlayerIMFFromVideoMetadataRelay_video"},{args:null,kind:"FragmentSpread",name:"useVideoPlayerAudioPlayBackLanguageRelay_video"}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("VideoPlayerUnsupportedBrowserMessageFallback.react",["ErrorMetadata","FBLogger","VideoPlayerFallbackCover.react","err","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e,c=u.useEffect,d=u.useMemo,m=u.useRef;function p(e,t){var n=o("react-compiler-runtime").c(11),a;e:{if(e!=null){var i;if(n[0]!==e||n[1]!==t){var l;i=r("err")("Cannot play video: Unsupported browser message from server: %s",e),i.name="VideoPlayerUnsupportedBrowserMessageFromServer";var u=(l=i.metadata)!=null?l:new(r("ErrorMetadata"));i.metadata=u,u.addEntry("COMET_VIDEO","VIDEO_ID",t),n[0]=e,n[1]=t,n[2]=i}else i=n[2];a=i;break e}a=null}var d=a,p=m(!1),_;n[3]!==d?(_=function(){if(d!=null&&!p.current){var e,t,n;p.current=!0,(e=r("FBLogger")("comet_video_player").catching(d)).warn.apply(e,[(t=d.messageFormat)!=null?t:""].concat((n=d.messageParams)!=null?n:[]))}},n[3]=d,n[4]=_):_=n[4];var f;if(n[5]!==d||n[6]!==t?(f=[d,t],n[5]=d,n[6]=t,n[7]=f):f=n[7],c(_,f),e!=null){var g;return n[8]!==e||n[9]!==d?(g=s.jsx(r("VideoPlayerFallbackCover.react"),{debugError:d,message:e}),n[8]=e,n[9]=d,n[10]=g):g=n[10],g}return null}l.useVideoPlayerUnsupportedBrowserMessageFallback=p}),98);
__d("VideoPlayerXImplRelayWrapper.react",["VideoPlayerXImpl.react"],(function(t,n,r,o,a,i,l){"use strict";l.default=r("VideoPlayerXImpl.react")}),98);
__d("XFBLatencySensitiveTypeUtils.facebook",["$InternalEnumUtils","LatencySensitiveType"],(function(t,n,r,o,a,i,l){var e=o("$InternalEnumUtils").createToJSEnum(r("LatencySensitiveType")),s=o("$InternalEnumUtils").createFromJSEnum(r("LatencySensitiveType"));l.toJSEnum=e,l.fromJSEnum=s}),98);
__d("useGraphQLVideoAutoplayGatingResult_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useGraphQLVideoAutoplayGatingResult_video",selections:[{alias:null,args:null,kind:"ScalarField",name:"autoplay_gating_result",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"viewer_autoplay_setting",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"can_autoplay",storageKey:null}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("useGraphQLVideoAutoplayGatingResult",["CometRelay","GraphQLVideoAutoplayGatingResult","react-compiler-runtime","useGraphQLVideoAutoplayGatingResult_video.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){var r=o("react-compiler-runtime").c(4),a=o("CometRelay").useFragment(e!==void 0?e:e=n("useGraphQLVideoAutoplayGatingResult_video.graphql"),t),i;return r[0]!==a.autoplay_gating_result||r[1]!==a.can_autoplay||r[2]!==a.viewer_autoplay_setting?(i=o("GraphQLVideoAutoplayGatingResult").makeGraphQLVideoAutoplayGatingResult(a.autoplay_gating_result,a.viewer_autoplay_setting,a.can_autoplay),r[0]=a.autoplay_gating_result,r[1]=a.can_autoplay,r[2]=a.viewer_autoplay_setting,r[3]=i):i=r[3],i}l.default=s}),98);
__d("useGraphQLVideoDRMInfo_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useGraphQLVideoDRMInfo_video",selections:[{alias:null,args:null,kind:"ScalarField",name:"drm_info",storageKey:null}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("useGraphQLVideoDRMInfo",["CometRelay","GraphQLVideoDRMInfo","react","useGraphQLVideoDRMInfo_video.graphql","useUnsafeRef_DEPRECATED"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=(u||(u=o("react"))).useRef;function d(e){if(e!=null){var t=m(e);return o("GraphQLVideoDRMInfo").makeGraphQLVideoDRMInfo(t)}return null}function m(e){var t=JSON.parse(e)||{},n=t.fairplay_cert,r=t.graph_api_video_license_uri,o=t.video_license_uri_map,a=t.widevine_cert;return{fairplay_cert:n,graph_api_video_license_uri:r,video_license_uri_map:o,widevine_cert:a}}function p(t){var a=o("CometRelay").useFragment(e!==void 0?e:e=n("useGraphQLVideoDRMInfo_video.graphql"),t),i=c(null),l=d(a.drm_info),u=(s||(s=r("useUnsafeRef_DEPRECATED")))(null);return i.current!==a.drm_info&&(i.current=a.drm_info,u.current=l),u.current}l.default=p}),98);
__d("useGraphQLVideoP2PSettings_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useGraphQLVideoP2PSettings_video",selections:[{alias:null,args:null,concreteType:"VideoP2PSettings",kind:"LinkedField",name:"p2p_settings",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ticket",storageKey:null},{alias:null,args:null,concreteType:"VideoP2PSettingsConfig",kind:"LinkedField",name:"config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"delay_p2p_until_play",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"disable_hivejava_for_livevc",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"VideoHiveCommunityInfo",kind:"LinkedField",name:"community_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"community_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"community_name",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"VideoHiveInitializationOptions",kind:"LinkedField",name:"hive_initialization_options",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoHiveInitializationOptionHiveJava",kind:"LinkedField",name:"hive_java",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"min_version",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hive_tech_order",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"debug_level",storageKey:null}],storageKey:null}],storageKey:null}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("useGraphQLVideoP2PSettings",["CometRelay","FBLogger","GraphQLVideoP2PSettings","react","useGraphQLVideoP2PSettings_video.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(s||(s=o("react"))).useState;function c(e){var t=null;if(e){var n,a,i,l,s,u,c,d,m,p,_,f={delay_p2p_until_play:(n=(a=e.config)==null?void 0:a.delay_p2p_until_play)!=null?n:!1,disable_hivejava_for_livevc:(i=(l=e.config)==null?void 0:l.disable_hivejava_for_livevc)!=null?i:!1},g=e.ticket,h=e.community_info,y=(s=e.hive_initialization_options)==null?void 0:s.debug_level,C=(u=(c=e.hive_initialization_options)==null?void 0:c.hive_tech_order.map(function(e){var t=o("GraphQLVideoP2PSettings").hiveTechOrderOrNull(e);return t==null&&e!=null&&r("FBLogger")("comet_video_player").mustfix("Invalid hive tech order: '%s'",e),t}).filter(Boolean))!=null?u:[],b=(d=e.hive_initialization_options)==null||(d=d.hive_java)==null?void 0:d.min_version,v=(m=e.hive_initialization_options)!=null&&m.hive_java?{minVersion:b}:null,S=e.hive_initialization_options?{HiveJava:v,debugLevel:y,hiveTechOrder:C}:null,R={communityId:(p=h==null?void 0:h.community_id)!=null?p:"unknowncustomer",communityName:(_=h==null?void 0:h.community_name)!=null?_:"Unknown Customer"};t={community_info:R,config:f,hive_initialization_options:S,ticket:g}}return t}function d(t){var r,a=o("CometRelay").useFragment(e!==void 0?e:e=n("useGraphQLVideoP2PSettings_video.graphql"),t),i=u(null),l=i[0],s=i[1],d=u(null),m=d[0],p=d[1],_=c((r=a.p2p_settings)!=null?r:null),f=JSON.stringify(_);return l!==f&&(s(f!=null?f:null),p(_!=null?_:null)),m}l.default=d}),98);
__d("useVideoImplementationsParamsRelayImpl_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{kind:"Literal",name:"scrubbing_preference",value:"MPEG_DASH"}],t=[{}];return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useVideoImplementationsParamsRelayImpl_video",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"can_use_oz",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"min_quality_preference",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_spherical",storageKey:null},{alias:null,args:null,concreteType:"SphericalVideoFallbackUrls",kind:"LinkedField",name:"spherical_video_fallback_urls",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"hd",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sd",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"comet_video_player_nextgendash_availability",storageKey:null},{alias:"videoDeliveryLegacyFields",args:[{kind:"Literal",name:"negate",value:!0}],concreteType:"Video",kind:"LinkedField",name:"if_viewer_should_use_video_delivery_response",plural:!1,selections:[{alias:"dash_manifest_xml_string",args:e,kind:"ScalarField",name:"playlist",storageKey:'playlist(scrubbing_preference:"MPEG_DASH")'},{alias:"dash_manifest_url",args:e,kind:"ScalarField",name:"playable_url",storageKey:'playable_url(scrubbing_preference:"MPEG_DASH")'},{alias:"browser_native_sd_url",args:null,kind:"ScalarField",name:"playable_url",storageKey:null},{alias:"browser_native_hd_url",args:[{kind:"Literal",name:"quality",value:"HD"}],kind:"ScalarField",name:"playable_url",storageKey:'playable_url(quality:"HD")'}],storageKey:"if_viewer_should_use_video_delivery_response(negate:true)"},{alias:"videoDeliveryResponseFragment",args:null,concreteType:"Video",kind:"LinkedField",name:"if_viewer_should_use_video_delivery_response",plural:!1,selections:[{kind:"CatchField",field:{alias:"videoDeliveryResponseResult",args:[{kind:"Literal",name:"video_delivery_request",value:{dash_manifest_requests:t,dash_manifest_url_requests:t,hls_playlist_url_requests:t,progressive_url_requests:[{quality:"SD"},{quality:"HD"}]}}],concreteType:"XFBVideoDeliveryResponse",kind:"LinkedField",name:"video_delivery_response",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"CometVideoPlayerVideoDeliveryResponseRelayFragment_video_delivery_response"}],storageKey:'video_delivery_response(video_delivery_request:{"dash_manifest_requests":[{}],"dash_manifest_url_requests":[{}],"hls_playlist_url_requests":[{}],"progressive_url_requests":[{"quality":"SD"},{"quality":"HD"}]})'},to:"RESULT"}],storageKey:null}],type:"Video",abstractKey:null}})();a.exports=e}),null);
__d("useVideoImplementationsParamsRelayImpl",["CometRelay","CometVideoPlayerNextgendashAvailability","CometVideoPlayerVideoDeliveryResponseRelayFragment","getJSEnumSafe","react","react-compiler-runtime","useVideoImplementationsParamsRelayImpl_video.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(s||(s=o("react"))).useMemo;function c(t,a){var i,l,s,u,c,d,m,p,_,f,g,h,y,C,b=o("react-compiler-runtime").c(20),v=o("CometRelay").useFragment(e!==void 0?e:e=n("useVideoImplementationsParamsRelayImpl_video.graphql"),t),S=(i=a.playbackLanguageOnComet)!=null?i:null,R=o("CometVideoPlayerVideoDeliveryResponseRelayFragment").useCometVideoPlayerVideoDeliveryResponseResultFromRelay((l=v.videoDeliveryResponseFragment)==null?void 0:l.videoDeliveryResponseResult);(s=v.spherical_video_fallback_urls)==null||s.hd,(u=v.spherical_video_fallback_urls)==null||u.sd,(c=v.videoDeliveryLegacyFields)==null||c.dash_manifest_xml_string,(d=v.videoDeliveryLegacyFields)==null||d.dash_manifest_url,(m=v.videoDeliveryLegacyFields)==null||m.browser_native_hd_url,(p=v.videoDeliveryLegacyFields)==null||p.browser_native_sd_url;var L=(_=v.videoDeliveryLegacyFields)==null?void 0:_.browser_native_hd_url,E=(f=v.videoDeliveryLegacyFields)==null?void 0:f.browser_native_sd_url,k=(g=v.videoDeliveryLegacyFields)==null?void 0:g.dash_manifest_url,I=(h=v.videoDeliveryLegacyFields)==null?void 0:h.dash_manifest_xml_string,T;if(b[0]!==v.comet_video_player_nextgendash_availability){var D;T=(D=r("getJSEnumSafe")(r("CometVideoPlayerNextgendashAvailability"),v.comet_video_player_nextgendash_availability))!=null?D:"UNAVAILABLE_FROM_JS_NO_INFO_FROM_SERVER",b[0]=v.comet_video_player_nextgendash_availability,b[1]=T}else T=b[1];var x=(y=v.spherical_video_fallback_urls)==null?void 0:y.hd,$=(C=v.spherical_video_fallback_urls)==null?void 0:C.sd,P;return b[2]!==a.dashManifestUrlOverride_DO_NOT_USE||b[3]!==a.minQualityPreferenceOverrideFromProductSurface||b[4]!==a.preferBrowserNativeImplementation||b[5]!==a.videoPlayerShakaConfig||b[6]!==S||b[7]!==L||b[8]!==E||b[9]!==k||b[10]!==I||b[11]!==T||b[12]!==x||b[13]!==$||b[14]!==v.can_use_oz||b[15]!==v.id||b[16]!==v.is_spherical||b[17]!==v.min_quality_preference||b[18]!==R?(P={browserNativeHdUrl:L,browserNativeSdUrl:E,canUseOz:v.can_use_oz,dashManifestUrl:k,dashManifestUrlOverride_DO_NOT_USE:a.dashManifestUrlOverride_DO_NOT_USE,dashManifestXmlString:I,initialAudioUserPreferredLanguage:S,isSpherical:v.is_spherical,minQualityPreference:v.min_quality_preference,minQualityPreferenceOverrideFromProductSurface:a.minQualityPreferenceOverrideFromProductSurface,nextgendashAvailability:T,preferBrowserNativeImplementation:a.preferBrowserNativeImplementation,sphericalVideoFallbackHdUrl:x,sphericalVideoFallbackSdUrl:$,videoDeliveryResponseResult:R,videoFBID:v.id,videoPlayerShakaConfig:a.videoPlayerShakaConfig},b[2]=a.dashManifestUrlOverride_DO_NOT_USE,b[3]=a.minQualityPreferenceOverrideFromProductSurface,b[4]=a.preferBrowserNativeImplementation,b[5]=a.videoPlayerShakaConfig,b[6]=S,b[7]=L,b[8]=E,b[9]=k,b[10]=I,b[11]=T,b[12]=x,b[13]=$,b[14]=v.can_use_oz,b[15]=v.id,b[16]=v.is_spherical,b[17]=v.min_quality_preference,b[18]=R,b[19]=P):P=b[19],P}l.default=c}),98);
__d("VideoPlayerShakaConfigContextProvider",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(){this.$1={}}var t=e.prototype;return t.setContext=function(t,n){if(this.$1[t]!==n){var e;this.$1=babelHelpers.extends({},this.$1,(e={},e[t]=n,e))}},t.setAllContexts=function(t){this.$1=t},t.getAllContexts=function(){return this.$1},e})();i.default=e}),66);
__d("VideoPlayerShakaConfig",["VideoPlayerContextSensitiveConfigResolver","VideoPlayerShakaConfigContextProvider"],(function(t,n,r,o,a,i,l){var e={},s=(function(){function t(e,t,n){this.$1=new(r("VideoPlayerShakaConfigContextProvider")),this.$2=t||null,this.$3=new(r("VideoPlayerContextSensitiveConfigResolver"))(n),this.$3.setContexts(e||{}),e&&this.$1.setAllContexts(e)}t.setGlobalOverrideConfig=function(n){e=n};var n=t.prototype;return n.setContext=function(t,n){var e=this.$1.getAllContexts();this.$1.setContext(t,n);var r=this.$1.getAllContexts();e!==r&&this.$3.setContexts(r)},n.setOverrideConfig=function(t){this.$2=t},n.getBool=function(t,n){var e=this.$4(t,n);return typeof e=="boolean"?e:n},n.getNumber=function(t,n){var e=this.$4(t,n);return typeof e=="number"?e:n},n.getString=function(t,n){var e=this.$4(t,n);return typeof e=="string"?e:n},n.getAllContexts=function(){return this.$1.getAllContexts()},n.$4=function(n,r){return e&&typeof e[n]==typeof r?e[n]:typeof this.$3.getValue(n)==typeof r?this.$3.getValue(n):this.$2&&typeof this.$2[n]==typeof r?this.$2[n]:null},t})();l.default=s}),98);
__d("prepareVideoPlayerImplementations",["CometVideoPlayerVideoDeliveryResponse","ErrorMetadata","VideoPlayerOzImplementationData","VideoPlayerOzWWWConfig","VideoPlayerProgressiveImplementationData","VideoPlayerProgressiveImplementationV2.react","VideoPlayerShakaConfig","cr:12258","cr:1775","cr:1980","cr:592","cr:7519","err","getErrorSafe","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(e=n("cr:12258"))!=null?e:n("cr:1775"),c=(s=n("cr:7519"))==null?void 0:s.makeNextgendashEngineData;u==null||u({clearPrefetchQueue:!1,deprioritizeCurrentPrefetchTasks:r("gkx")("10183"),preventFetchDemandStart:r("gkx")("20702")});function d(e,t,n,r,a,i,l,s,u){var c=null,d=null,m=null,p=null,_=[],f=[],g=[],h=[],y=[];if(e!=null){var C=o("CometVideoPlayerVideoDeliveryResponse").processVideoDeliveryResponseResult(e,t);m=C.browserNativeHdUrl,p=C.browserNativeSdUrl,f=C.dashManifestDeliveryFailures,d=C.dashManifestUrl,g=C.dashManifestUrlDeliveryFailures,c=C.dashManifestXmlString,y=C.hlsDeliveryFailures,h=C.progressiveDeliveryFailures,_=C.videoDeliveryResponseAPIFailures}else c=i!=null?i:null,d=a!=null?a:null,m=n!=null?n:null,p=r!=null?r:null;return l===!0&&(m=s!=null?s:m,p=u!=null?u:p),{browserNativeHdUrl:m,browserNativeSdUrl:p,dashManifestDeliveryFailures:f,dashManifestUrl:d,dashManifestUrlDeliveryFailures:g,dashManifestXmlString:c,hlsDeliveryFailures:y,progressiveDeliveryFailures:h,videoDeliveryResponseAPIFailures:_}}function m(e,t,n,r,o){return!(e.length===0&&(t.length===0||n.length===0||r!=null||o!=null))}function p(e,t,o,a,i,l,s,u){if(!c||!n("cr:592"))return r("err")("Nextgendash implementation not available");var d=c({canUseOz:e,dashManifestUrl:t,dashManifestUrlOverride_DO_NOT_USE:o,dashManifestXmlString:a,experimentationConfig:new(r("VideoPlayerShakaConfig")),initialAudioUserPreferredLanguage:i,minQualityPreference:l,nextgendashAvailability:s,skipManifestPrevalidation:u});return d instanceof Error?d:{Component:n("cr:592"),data:d,typename:"VideoPlayerNextgendashImplementation"}}function _(e,t,a,i,l,s,u,c){if(n("cr:1980")==null)return r("err")("Oz implementation not available");var d=o("VideoPlayerOzImplementationData").makeOzImplementationData({canUseOz:e,dashManifestUrl:t,dashManifestUrlOverride_DO_NOT_USE:a,dashManifestXmlString:i,experimentationConfig:new(r("VideoPlayerOzWWWConfig"))(c!=null?c:new(r("VideoPlayerShakaConfig"))),initialAudioUserPreferredLanguage:l,initiateLivePlaybackFromStart:s,minQualityPreference:u});return d instanceof Error?d:{Component:n("cr:1980"),data:d,typename:"VideoPlayerOzImplementation"}}function f(e,t,n,a,i,l){var s=i!=null?i:a,u=o("VideoPlayerProgressiveImplementationData").makeProgressiveImplementationData({hdSrc:e,hdSrcPreferred:r("gkx")("24369")||n===!0||s==="HD"||s==="UHD",mediaStream:l,sdSrc:t});return u instanceof Error?u:{Component:r("VideoPlayerProgressiveImplementationV2.react"),data:u,typename:"VideoPlayerProgressiveImplementation"}}function g(e,t,n,o,a,i,l){var s;if(!t&&(!l||e.length===0))return null;for(var u=new Map,c=0;c<e.length;++c){var d,m=e[c],p=m.name+": "+((d=m.messageFormat)!=null?d:m.message);u.has(p)||u.set(p,m)}for(var _=Array.from(u.values()),f=[],g=[],h=[],y=0;y<_.length;++y){var C,b=_[y];f.push(b.name),g.push((C=b.messageFormat)!=null?C:b.message),b.messageFormat!=null&&b.messageParams!=null&&h.push.apply(h,b.messageParams)}var v=r("err").apply(void 0,[(t?n===!0?"Cannot play 360 video: ":"Cannot play video: ":n===!0?"Warning for 360 video: ":"Warning: ")+g.join(" ++ ")].concat(h));v.name=f.join("++"),v.type=t?"fatal":"warn",v.project="comet_video_player";var S=(s=v.metadata)!=null?s:new(r("ErrorMetadata"));return v.metadata=S,o!=null&&S.addEntry("COMET_VIDEO","VIDEO_ID",String(o)),S.addEntry("COMET_VIDEO","VIDEO_IMPLEMENTATION_DEBUG_DATA",JSON.stringify({isBroadcast:a,isLiveStreaming:i,isSpherical:n})),v}function h(e){var t=e.browserNativeHdSrcPreferred,o=e.browserNativeHdUrl,a=e.browserNativeSdUrl,i=e.canUseOz,l=e.dashManifestUrl,s=e.dashManifestUrlOverride_DO_NOT_USE,u=e.dashManifestXmlString,h=e.initialAudioUserPreferredLanguage,y=e.initiateLivePlaybackFromStart,C=e.isBroadcast,b=e.isLiveStreaming,v=e.isSpherical,S=e.mediaStream,R=e.minQualityPreference,L=e.minQualityPreferenceOverrideFromProductSurface,E=e.nextgendashAvailability,k=e.preferBrowserNativeImplementation,I=e.skipManifestPrevalidation,T=e.sphericalVideoFallbackHdUrl,D=e.sphericalVideoFallbackSdUrl,x=e.videoDeliveryResponseResult,$=e.videoFBID,P=e.videoPlayerShakaConfig,N=[],M=[],w=r("gkx")("8034"),A=d(x,w,o,a,l,u,v,T,D),F=A.browserNativeHdUrl,O=A.browserNativeSdUrl,B=A.dashManifestDeliveryFailures,W=A.dashManifestUrl,q=A.dashManifestUrlDeliveryFailures,U=A.dashManifestXmlString,V=A.hlsDeliveryFailures,H=A.progressiveDeliveryFailures,G=A.videoDeliveryResponseAPIFailures,z=m(G,B,q,W,U);if(k!==!0){if(!z){if(c&&n("cr:592")){var j=p(i,W,s,U,h,R,E,I);j instanceof Error?M.push(["VideoPlayerNextgendashImplementation",j]):N.push(j)}if(n("cr:1980")!=null){var K=_(i,W,s,U,h,y,R,P);K instanceof Error?M.push(["VideoPlayerOzImplementation",K]):N.push(K)}}}else{var Q=r("err")("preferBrowserNativeImplementation="+String(k));Q.name="VideoImplementationsPreferBrowserNative",c&&n("cr:592")&&M.push(["VideoPlayerNextgendashImplementation",Q]),M.push(["VideoPlayerOzImplementation",Q])}if(G.length===0&&(H.length===0||F!=null||O!=null||S!=null)){var X=f(F,O,t,R,L,S);X instanceof Error?M.push(["VideoPlayerProgressiveImplementation",X]):N.push(X)}var Y=N.length===0,J=[];J.push.apply(J,G),J.push.apply(J,B),J.push.apply(J,q),J.push.apply(J,H),J.push.apply(J,V),J.push.apply(J,M.map(function(e){var t,n,o=e[0],a=e[1],i=r("getErrorSafe")(a),l=o.replace(/^VideoPlayer/,"").replace(/(Implementation)|(Engine)$/,"")+"Engine",s=r("err").apply(void 0,["Cannot use "+l+" / "+((t=i.messageFormat)!=null?t:i.message)].concat(i.messageFormat!=null?(n=i.messageParams)!=null?n:[]:[]));return s.name="VideoPlayerCannotUse"+l+"/"+i.name,s}));var Z=g(J,Y,v,$,C,b,r("gkx")("24370"));if(Y&&Z!=null)throw Z;return{implementations:N,warning:Z}}l.default=h}),98);
__d("useVideoPlayerImplementations",["FBLogger","gkx","prepareVideoPlayerImplementations","react","react-compiler-runtime","useEmptyFunction"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.useEffect,c=s.useMemo;function d(e){var t=o("react-compiler-runtime").c(3),n,a;t[0]!==e?(n=function(){if(e){var t,n,o,a=(t=e.messageFormat)!=null?t:e.message,i=e.messageFormat!=null?(n=e.messageParams)!=null?n:[]:[];(o=r("FBLogger")("comet_video_player").catching(e)).warn.apply(o,[a].concat(i))}},a=[e],t[0]=e,t[1]=n,t[2]=a):(n=t[1],a=t[2]),u(n,a)}var m=r("gkx")("24370")?d:r("useEmptyFunction");function p(e){var t=o("react-compiler-runtime").c(2),n;t[0]!==e?(n=r("prepareVideoPlayerImplementations")(e),t[0]=e,t[1]=n):n=t[1];var a=n;return m(a.warning),a}l.default=p}),98);
__d("useVideoImplementationsRelayImpl",["react","react-compiler-runtime","useVideoImplementationsParamsRelayImpl","useVideoPlayerImplementations"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useDebugValue;function u(e,t){var n=o("react-compiler-runtime").c(4),a=r("useVideoImplementationsParamsRelayImpl")(e,t),i=r("useVideoPlayerImplementations")(a),l=i.implementations,u=i.warning,c;return n[0]!==l||n[1]!==a||n[2]!==u?(c={implementations:l,params:a,warning:u},n[0]=l,n[1]=a,n[2]=u,n[3]=c):c=n[3],s(c),l}l.default=u}),98);
__d("useVideoImplementationsRelay",["useVideoImplementationsRelayImpl"],(function(t,n,r,o,a,i,l){"use strict";l.default=r("useVideoImplementationsRelayImpl")}),98);
__d("useVideoPlayerAudioAvailabilityInfoRelay_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useVideoPlayerAudioAvailabilityInfoRelay_video",selections:[{alias:null,args:null,kind:"ScalarField",name:"audio_availability",storageKey:null},{alias:null,args:null,concreteType:"VideoMutedSegment",kind:"LinkedField",name:"muted_segments",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"mute_start_time_in_sec",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mute_end_time_in_sec",storageKey:null}],storageKey:null}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("useVideoPlayerAudioAvailabilityInfoRelay",["CometRelay","VideoPlayerAudioAvailabilityInfo","react","react-compiler-runtime","useVideoPlayerAudioAvailabilityInfoRelay_video.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(s||(s=o("react"))).useMemo;function c(t){var r=o("react-compiler-runtime").c(3),a=o("CometRelay").useFragment(e!==void 0?e:e=n("useVideoPlayerAudioAvailabilityInfoRelay_video.graphql"),t),i;return r[0]!==a.audio_availability||r[1]!==a.muted_segments?(i=o("VideoPlayerAudioAvailabilityInfo").makeVideoPlayerAudioAvailabilityInfo({audioAvailability:a.audio_availability,mutedSegmentsUnsanitized:a.muted_segments==null?[]:a.muted_segments.map(d)}),r[0]=a.audio_availability,r[1]=a.muted_segments,r[2]=i):i=r[2],i}function d(e){return{muteEndTimeInSec:e.mute_end_time_in_sec,muteStartTimeInSec:e.mute_start_time_in_sec}}l.default=c}),98);
__d("useVideoPlayerAudioPlayBackLanguageRelay_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useVideoPlayerAudioPlayBackLanguageRelay_video",selections:[{alias:null,args:null,kind:"ScalarField",name:"playback_language_on_comet",storageKey:null}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("useVideoPlayerAudioPlayBackLanguageRelay",["CometRelay","useVideoPlayerAudioPlayBackLanguageRelay_video.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){var r,a=o("CometRelay").useFragment(e!==void 0?e:e=n("useVideoPlayerAudioPlayBackLanguageRelay_video.graphql"),t);return(r=a.playback_language_on_comet)!=null?r:null}l.default=s}),98);
__d("useVideoPlayerAudioSettings_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useVideoPlayerAudioSettings_video",selections:[{alias:null,args:null,concreteType:"AudioSettings",kind:"LinkedField",name:"audio_settings",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"video_volume_setting",storageKey:null}],storageKey:null}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("useVideoPlayerAudioSettings",["AudioSettingsVolumeSetting","CometRelay","react","react-compiler-runtime","useVideoPlayerAudioSettings_video.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(s||(s=o("react"))).useMemo,c=1,d=.5,m=new Map([["default",c],["quiet",d]]);function p(t,a){var i,l=o("react-compiler-runtime").c(5),s=o("CometRelay").useFragment(e!==void 0?e:e=n("useVideoPlayerAudioSettings_video.graphql"),t),u=(i=s.audio_settings)==null?void 0:i.video_volume_setting,d="DEFAULT";e:switch(u){case"DEFAULT":case"QUIET":{d=u;break e}default:}var p=r("AudioSettingsVolumeSetting")[d],_;if(l[0]!==p){var f;_=(f=m.get(p))!=null?f:c,l[0]=p,l[1]=_}else _=l[1];var g=_,h=a,y;return l[2]!==g||l[3]!==h?(y={audioUserPreferredLanguage:h,preferredVolumeSetting:g},l[2]=g,l[3]=h,l[4]=y):y=l[4],y}l.default=p}),98);
__d("useVideoPlayerCaptionsSettings_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useVideoPlayerCaptionsSettings_video",selections:[{alias:null,args:null,concreteType:"CaptionsSettings",kind:"LinkedField",name:"captions_settings",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"always_show_captions",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"captions_background_color",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"captions_background_opacity",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"captions_text_color",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"captions_text_size",storageKey:null}],storageKey:null}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("useVideoPlayerCaptionsSettings",["CometRelay","react-compiler-runtime","useVideoPlayerCaptionsSettings_video.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e,s="DEFAULT",u="BLACK",c="WHITE",d="DEFAULT";function m(t){var r,a,i,l,m,p,_,f,g,h,y=o("react-compiler-runtime").c(8),C=o("CometRelay").useFragment(e!==void 0?e:e=n("useVideoPlayerCaptionsSettings_video.graphql"),t),b=(r=(a=C.captions_settings)==null?void 0:a.always_show_captions)!=null?r:!1,v=(i=(l=C.captions_settings)==null?void 0:l.captions_background_color)!=null?i:u,S=(m=(p=C.captions_settings)==null?void 0:p.captions_background_opacity)!=null?m:s,R=(_=(f=C.captions_settings)==null?void 0:f.captions_text_color)!=null?_:c,L=(g=(h=C.captions_settings)==null?void 0:h.captions_text_size)!=null?g:d,E;y[0]!==v||y[1]!==S||y[2]!==R||y[3]!==L?(E={captionsBackgroundColor:v,captionsBackgroundOpacity:S,captionsTextColor:R,captionsTextSize:L},y[0]=v,y[1]=S,y[2]=R,y[3]=L,y[4]=E):E=y[4];var k;return y[5]!==b||y[6]!==E?(k={alwaysShowCaptions:b,captionDisplayStyle:E},y[5]=b,y[6]=E,y[7]=k):k=y[7],k}l.default=m}),98);
__d("useVideoPlayerIMFFromVideoMetadata",["react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.useDebugValue,c=s.useMemo;function d(e){var t=o("react-compiler-runtime").c(5),n=e.isVideoBroadcast,r=e.specInlineJson,a=n===!0,i;t[0]!==a||t[1]!==r?(i={imfExpectedFromEmsg:a,specInlineJson:r},t[0]=a,t[1]=r,t[2]=i):i=t[2];var l=i,s;return t[3]!==l?(s={useVideoPlayerIMFFromVideoMetadata:l},t[3]=l,t[4]=s):s=t[4],u(s),l}l.default=d}),98);
__d("useVideoPlayerIMFFromVideoMetadataRelay_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useVideoPlayerIMFFromVideoMetadataRelay_video",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_video_broadcast",storageKey:null},{alias:null,args:null,concreteType:"VideoIMFData",kind:"LinkedField",name:"video_imf_data",plural:!1,selections:[{args:null,documentName:"useVideoPlayerIMFFromVideoMetadataRelay_video",fragmentName:"useVideoPlayerIMFFromVideoMetadataRelay_video_imf_data",fragmentPropName:"video_imf_data",kind:"ModuleImport"}],storageKey:null}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("useVideoPlayerIMFFromVideoMetadataRelay_video_imf_data.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useVideoPlayerIMFFromVideoMetadataRelay_video_imf_data",selections:[{alias:null,args:null,kind:"ScalarField",name:"spec_inline_json",storageKey:null}],type:"VideoIMFData",abstractKey:null};a.exports=e}),null);
__d("useVideoPlayerIMFFromVideoMetadataRelay",["CometRelay","react-compiler-runtime","useVideoPlayerIMFFromVideoMetadata","useVideoPlayerIMFFromVideoMetadataRelay_video.graphql","useVideoPlayerIMFFromVideoMetadataRelay_video_imf_data.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t){var a=o("react-compiler-runtime").c(4),i=o("CometRelay").useFragment(e!==void 0?e:e=n("useVideoPlayerIMFFromVideoMetadataRelay_video.graphql"),t),l=o("CometRelay").useFragment(s!==void 0?s:s=n("useVideoPlayerIMFFromVideoMetadataRelay_video_imf_data.graphql"),i.video_imf_data),u=l==null?void 0:l.spec_inline_json,c;return a[0]!==u||a[1]!==i.id||a[2]!==i.is_video_broadcast?(c={isVideoBroadcast:i.is_video_broadcast,specInlineJson:u,videoID:i.id},a[0]=u,a[1]=i.id,a[2]=i.is_video_broadcast,a[3]=c):c=a[3],r("useVideoPlayerIMFFromVideoMetadata")(c)}l.default=u}),98);
__d("useVideoPlayerLiveLatencyKnobSettings_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useVideoPlayerLiveLatencyKnobSettings_video",selections:[{alias:null,args:null,concreteType:"VideoBroadcastLowLatencyConfig",kind:"LinkedField",name:"broadcast_low_latency_config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ll_desired_latency_ms",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ll_latency_tolerance_ms",storageKey:null}],storageKey:null}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("useVideoPlayerLiveLatencyKnobSettings",["CometRelay","react-compiler-runtime","useVideoPlayerLiveLatencyKnobSettings_video.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){var r,a,i,l,s=o("react-compiler-runtime").c(3),u=o("CometRelay").useFragment(e!==void 0?e:e=n("useVideoPlayerLiveLatencyKnobSettings_video.graphql"),t),c=(r=(a=u.broadcast_low_latency_config)==null?void 0:a.ll_desired_latency_ms)!=null?r:0,d=(i=(l=u.broadcast_low_latency_config)==null?void 0:l.ll_latency_tolerance_ms)!=null?i:0,m;return s[0]!==c||s[1]!==d?(m={desiredLatencyMs:c,latencyToleranceMs:d},s[0]=c,s[1]=d,s[2]=m):m=s[2],m}l.default=s}),98);
__d("useVideoPlayerShakaConfig_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useVideoPlayerShakaConfig_video",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_spherical",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_gaming_video",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_latency_menu_enabled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_live_streaming",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fbls_tier",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_latency_sensitive_broadcast",storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"selected_latency_setting",storageKey:null}]}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("useVideoPlayerShakaConfig",["CometRelay","VideoPlayerConnectionQuality","VideoPlayerOzWWWGlobalConfig","VideoPlayerShakaConfig","oz-player/networks/OzBandwidthEstimator","react","react-compiler-runtime","useSelectedLatencySetting","useVideoPlayerShakaConfig_video.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=s||(s=o("react")),c=u.useEffect,d=u.useState;function m(t,a){var i,l=o("react-compiler-runtime").c(17),s=a.adClientToken,u=o("CometRelay").useFragment(e!==void 0?e:e=n("useVideoPlayerShakaConfig_video.graphql"),t),m=s!=null,_=u.is_spherical===!0,f=u.is_gaming_video===!0,g=r("useSelectedLatencySetting")((i=u.id)!=null?i:"null",u.selected_latency_setting),h=g[0],y;l[0]!==m||l[1]!==f||l[2]!==_||l[3]!==h||l[4]!==u.fbls_tier||l[5]!==u.is_latency_menu_enabled||l[6]!==u.is_latency_sensitive_broadcast||l[7]!==u.is_live_streaming?(y=function(){var e;return new(r("VideoPlayerShakaConfig"))({connection_quality:o("VideoPlayerConnectionQuality").evaluate(p),content_category:f?"gaming":"general",fbls_tier:(e=u.fbls_tier)!=null&&e.startsWith("user")?"user":"general",is_ad:m,is_latency_sensitive_broadcast:u.is_latency_sensitive_broadcast===!0,is_live:u.is_live_streaming===!0,is_spherical:_,latency_level:u.is_latency_menu_enabled===!0?h:"normal",player_format:"inline",servable_via_fmbs:!1,streaming_implementation:"default"})},l[0]=m,l[1]=f,l[2]=_,l[3]=h,l[4]=u.fbls_tier,l[5]=u.is_latency_menu_enabled,l[6]=u.is_latency_sensitive_broadcast,l[7]=u.is_live_streaming,l[8]=y):y=l[8];var C=d(y),b=C[0],v,S;l[9]!==m||l[10]!==b?(v=function(){b.setContext("is_ad",m)},S=[b,m],l[9]=m,l[10]=b,l[11]=v,l[12]=S):(v=l[11],S=l[12]),c(v,S);var R,L;return l[13]!==_||l[14]!==b?(R=function(){b.setContext("is_spherical",_)},L=[b,_],l[13]=_,l[14]=b,l[15]=R,l[16]=L):(R=l[15],L=l[16]),c(R,L),b}function p(){return r("oz-player/networks/OzBandwidthEstimator").getBandwidth(r("VideoPlayerOzWWWGlobalConfig"))}l.default=m}),98);
__d("useVideoPlayerShakaPerformanceLoggerBuilder_init.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useVideoPlayerShakaPerformanceLoggerBuilder_init",selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],type:"VideoPlayerShakaPerformanceLoggerInit",abstractKey:null};a.exports=e}),null);
__d("useVideoPlayerShakaPerformanceLoggerBuilder_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useVideoPlayerShakaPerformanceLoggerBuilder_video",selections:[{alias:"video_player_shaka_performance_logger_init2",args:null,concreteType:"VideoPlayerShakaPerformanceLoggerInit",kind:"LinkedField",name:"video_player_shaka_performance_logger_init",plural:!1,selections:[{args:null,documentName:"useVideoPlayerShakaPerformanceLoggerBuilder_video",fragmentName:"useVideoPlayerShakaPerformanceLoggerBuilder_init",fragmentPropName:"init",kind:"ModuleImport"},{alias:null,args:null,kind:"ScalarField",name:"per_session_sampling_rate",storageKey:null}],storageKey:null}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("useVideoPlayerShakaPerformanceLoggerBuilder",["CometRelay","react-compiler-runtime","useVideoPlayerShakaPerformanceLoggerBuilder_init.graphql","useVideoPlayerShakaPerformanceLoggerBuilder_video.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e,s;e!==void 0||(e=n("useVideoPlayerShakaPerformanceLoggerBuilder_init.graphql"));function u(e){var t=o("react-compiler-runtime").c(2),r=o("CometRelay").useFragment(s!==void 0?s:s=n("useVideoPlayerShakaPerformanceLoggerBuilder_video.graphql"),e),a;if(t[0]!==r.video_player_shaka_performance_logger_init2){a=Symbol.for("react.early_return_sentinel");e:{var i,l=r.video_player_shaka_performance_logger_init2?o("CometRelay").ModuleResource.read(r.video_player_shaka_performance_logger_init2):null,u=(i=r.video_player_shaka_performance_logger_init2)==null?void 0:i.per_session_sampling_rate;if(l!=null&&u!=null){a=new l({perSessionSampleRate:u});break e}}t[0]=r.video_player_shaka_performance_logger_init2,t[1]=a}else a=t[1];return a!==Symbol.for("react.early_return_sentinel")?a:null}l.default=u}),98);
__d("useVideoPlayerShakaPerformanceLoggerRelayImpl_init.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useVideoPlayerShakaPerformanceLoggerRelayImpl_init",selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],type:"VideoPlayerShakaPerformanceLoggerInit",abstractKey:null};a.exports=e}),null);
__d("useVideoPlayerShakaPerformanceLoggerRelayImpl_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useVideoPlayerShakaPerformanceLoggerRelayImpl_video",selections:[{alias:null,args:null,concreteType:"VideoPlayerShakaPerformanceLoggerInit",kind:"LinkedField",name:"video_player_shaka_performance_logger_init",plural:!1,selections:[{args:null,documentName:"useVideoPlayerShakaPerformanceLoggerRelayImpl_video",fragmentName:"useVideoPlayerShakaPerformanceLoggerRelayImpl_init",fragmentPropName:"init",kind:"ModuleImport"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"video_player_shaka_performance_logger_should_sample",storageKey:null}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("useVideoPlayerShakaPerformanceLoggerRelayImpl",["CometRelay","react-compiler-runtime","useVideoPlayerShakaPerformanceLoggerRelayImpl_init.graphql","useVideoPlayerShakaPerformanceLoggerRelayImpl_video.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e,s;e!==void 0||(e=n("useVideoPlayerShakaPerformanceLoggerRelayImpl_init.graphql"));function u(e){var t=o("react-compiler-runtime").c(3),r=o("CometRelay").useFragment(s!==void 0?s:s=n("useVideoPlayerShakaPerformanceLoggerRelayImpl_video.graphql"),e),a;return t[0]!==r.video_player_shaka_performance_logger_init||t[1]!==r.video_player_shaka_performance_logger_should_sample?(a=r.video_player_shaka_performance_logger_init?o("CometRelay").ModuleResource.read(r.video_player_shaka_performance_logger_init):null,a!=null&&r.video_player_shaka_performance_logger_should_sample===!0&&a.forceShouldSample(),t[0]=r.video_player_shaka_performance_logger_init,t[1]=r.video_player_shaka_performance_logger_should_sample,t[2]=a):a=t[2],a}l.default=u}),98);
__d("useVideoPlayerShakaPerformanceLoggerRelay",["useVideoPlayerShakaPerformanceLoggerRelayImpl"],(function(t,n,r,o,a,i,l){"use strict";l.default=r("useVideoPlayerShakaPerformanceLoggerRelayImpl")}),98);
__d("VideoStatusType",[],(function(t,n,r,o,a,i){var e=Object.freeze({ENCODING:1,DELETED:2,ENCODED:3,UPLOADING:5,OK:6,TOO_LONG:7,ENCODE_FAILED:8,UNPUBLISHED:9,SOFT_DELETED:10,UNDISCOVERABLE:11,UPLOAD_FAILED:13,UPLOADED:14,ORIGINAL_VIDEO_DELETED:15});i.default=e}),66);
__d("evaluateVideoPlayerVideoStatusFallbackCover",["fbt","ErrorMetadata","VideoPlayerFallbackCover.react","VideoStatusType","err","getGraphQLEnumSafe","gkx","react"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react"));function c(e){var t=e.disableVideoStatusFallbackIf,n=e.overrideGkForVideoStatusFallback_EXPERIMENTAL,o=e.videoFBID,a=e.videoStatusTypeFromGraphQL,i=d({videoFBID:o,videoStatusTypeFromGraphQL:a}),l=null,c=null;if(n==null&&!r("gkx")("24384"))l=null,c="disabled_by_gk";else if(n===!1)l=null,c="disabled_by_gk_override";else if((t==null?void 0:t(i))===!0){var m;l=null,c="disable_if:"+i.videoAvailabilityStatus+":"+((m=i.videoStatusTypeFromGraphQL)!=null?m:"null")}else{switch(i.videoAvailabilityStatus){case"unknown":l=null;break;case"ok":l=null;break;case"undiscoverable":l=null;break;case"unpublished":l=null;break;case"processing":{var p=r("gkx")("24385");l=u.jsx(r("VideoPlayerFallbackCover.react"),{debugError:p?i.debugError:null,message:s._(/*BTDS*/"This video is being processed..."),showDebugWithoutError:p,showLearnMoreLink:!1});break}case"processing_failed":l=u.jsx(r("VideoPlayerFallbackCover.react"),{debugError:i.debugError,message:s._(/*BTDS*/"Processing of this video failed.")});break;case"deleted":l=u.jsx(r("VideoPlayerFallbackCover.react"),{debugError:i.debugError,message:s._(/*BTDS*/"This video isn't available right now.")});break;default:i.videoAvailabilityStatus}c=(l==null?"not_needed_for_status:":"fallback_for_status:")+i.videoAvailabilityStatus+":"+String(i.videoStatusTypeFromGraphQL)}return{fallback:l,fallbackDebug:c,videoStatus:i}}function d(e){var t,n,o=e.videoFBID,a=e.videoStatusTypeFromGraphQL,i=(t=r("getGraphQLEnumSafe"))(n=r("VideoStatusType"),6),l=t(n,9),s=t(n,11),u=t(n,5),c=t(n,14),d=t(n,1),m=t(n,3),p=t(n,13),_=t(n,8),f=t(n,7),g=t(n,10),h=t(n,2),y;a===i?y="ok":a===l?y="unpublished":a===s?y="undiscoverable":a===u||a===c||a===d||a===m?y="processing":a===p||a===_||a===f?y="processing_failed":a===g||a===h?y="deleted":y="unknown";var C=y==="ok"||y==="unpublished"||y==="undiscoverable"||y==="processing_failed"||y==="deleted"||y==="unknown",b=null;if(y!=="ok"){var v;b=r("err")("Video is now %s due to video_status_type=%s",y,a);var S=(v=b.metadata)!=null?v:new(r("ErrorMetadata"));S.addEntry("COMET_VIDEO","VIDEO_ID",o!=null?o:""),b.metadata=S,b.name="VideoPlayerVideoStatusInfo"}var R={debugError:b,isTerminalStatus:C,videoAvailabilityStatus:y,videoStatusTypeFromGraphQL:a};return R}l.default=c}),226);
__d("useVideoPlayerVideoStatusRelayWithFallbackCover_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useVideoPlayerVideoStatusRelayWithFallbackCover_video",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"video_status_type",storageKey:null}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("useVideoPlayerVideoStatusRelayWithFallbackCover",["CometRelay","evaluateVideoPlayerVideoStatusFallbackCover","react","react-compiler-runtime","useInterval","useVideoPlayerVideoStatusRelayWithFallbackCover_video.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(s||(s=o("react"))).useDebugValue;function c(t,a,i,l){var s=o("react-compiler-runtime").c(5),c=o("CometRelay").useFragment(e!==void 0?e:e=n("useVideoPlayerVideoStatusRelayWithFallbackCover_video.graphql"),t),d;s[0]!==i||s[1]!==l||s[2]!==c.id||s[3]!==c.video_status_type?(d=r("evaluateVideoPlayerVideoStatusFallbackCover")({disableVideoStatusFallbackIf:i,overrideGkForVideoStatusFallback_EXPERIMENTAL:l,videoFBID:c.id,videoStatusTypeFromGraphQL:c.video_status_type}),s[0]=i,s[1]=l,s[2]=c.id,s[3]=c.video_status_type,s[4]=d):d=s[4];var m=d;return r("useInterval")(a,m.videoStatus.isTerminalStatus||m.fallback==null?0:1e4),u(m),m}l.default=c}),98);
__d("VideoPlayerRelay.react",["CastingStateHooks","CometPlaceholder.react","CometRelay","CometTrackingNodeProvider.react","ErrorMetadata","FBLogger","FBUnifiedVideoGating","InstreamVideoAdBreaksPlayer.react","JSResourceForInteraction","VideoPlayerErrorBoundary.react","VideoPlayerRelay_video.graphql","VideoPlayerUnsupportedBrowserMessageFallback.react","VideoPlayerXImplRelayWrapper.react","XFBLatencySensitiveTypeUtils.facebook","computeAspectRatio","cr:759","defaultErrorBoundaryFallback","deferredLoadComponent","err","getVideoPlayerAutoplayProps","gkx","hero-tracing-placeholder","isStringNullOrEmpty","lazyLoadComponent","normalizeVideoPlayerLoopCount","react","react-compiler-runtime","requireDeferredForDisplay","useEmptyFunction","useGraphQLVideoAutoplayGatingResult","useGraphQLVideoDRMInfo","useGraphQLVideoP2PSettings","useVideoImplementationsRelay","useVideoPlayerAudioAvailabilityInfoRelay","useVideoPlayerAudioPlayBackLanguageRelay","useVideoPlayerAudioSettings","useVideoPlayerAvailableCaptionsLocalesFromRelay","useVideoPlayerCaptionsSettings","useVideoPlayerIMFFromVideoMetadataRelay","useVideoPlayerLiveLatencyKnobSettings","useVideoPlayerShakaConfig","useVideoPlayerShakaPerformanceLoggerBuilder","useVideoPlayerShakaPerformanceLoggerRelay","useVideoPlayerVideoStatusRelayWithFallbackCover"],(function(t,n,r,o,a,i,l){"use strict";var e=["video"],s=["doNotRenderErrorBoundaryIUnderstandIMustProvideMyOwn","errorBoundaryFallback"],u,c,d,m=d||(d=o("react")),p=d,_=p.useCallback,f=p.useEffect,g=p.useRef,h=p.useTransition,y=(c=n("cr:759"))!=null?c:r("useEmptyFunction"),C=r("gkx")("24325"),b=r("gkx")("24326"),v=r("deferredLoadComponent")(r("requireDeferredForDisplay")("VideoPlayerSphericalFallbackCover.react").__setRef("VideoPlayerRelay.react")),S=r("lazyLoadComponent")(r("JSResourceForInteraction")("VideoPlayerVideoIsCastingCover.react").__setRef("VideoPlayerRelay.react"));function R(t){var a=o("react-compiler-runtime").c(13),i,l;a[0]!==t?(l=t.video,i=babelHelpers.objectWithoutPropertiesLoose(t,e),a[0]=t,a[1]=i,a[2]=l):(i=a[1],l=a[2]);var s=o("CometRelay").useRefetchableFragment(u!==void 0?u:u=n("VideoPlayerRelay_video.graphql"),l),c=s[0],d=s[1],p=h(),_=p[1],y;a[3]!==d?(y=function(){_(function(){d({},{fetchPolicy:"network-only"})})},a[3]=d,a[4]=y):y=a[4];var C=y,b=r("useVideoPlayerVideoStatusRelayWithFallbackCover")(c,C,i.disableVideoStatusFallbackIf,i.overrideGkForVideoStatusFallback_EXPERIMENTAL),v=b.fallback,S=b.fallbackDebug,R=b.videoStatus,E=g(null),k;if(a[5]!==S||a[6]!==c||a[7]!==R||a[8]!==v?(k=function(){var e=R,t=E.current;if(v!=null&&(e.videoAvailabilityStatus!==(t==null?void 0:t.videoAvailabilityStatus)||e.videoStatusTypeFromGraphQL!==(t==null?void 0:t.videoStatusTypeFromGraphQL))){var n;E.current=R,r("FBLogger")("comet_video_player").addMetadata("COMET_VIDEO","VIDEO_ID",(n=c.id)!=null?n:"").warn("VideoPlayerRelay rendered the video status fallback: %s",S)}},a[5]=S,a[6]=c,a[7]=R,a[8]=v,a[9]=k):k=a[9],f(k,void 0),v!=null)return v;var I;return a[10]!==i||a[11]!==c?(I=m.jsx(L,babelHelpers.extends({},i,{video:c})),a[10]=i,a[11]=c,a[12]=I):I=a[12],I}function L(e){var t,n,a,l,s=o("react-compiler-runtime").c(111),u=e.accessToken,c=e.adClientToken,d=e.apiRef,p=e.audioOnly,_=e.autoplayGatingResult,f=e.bufferEndLimit,g=e.bypassUseCometSizeError,h=e.canAutoplay,R=e.children,L=e.disableDubbing,k=e.disableLoadingIndicator,I=e.externalLogID,T=e.externalLogType,D=e.forceProgressive_EXPERIMENTAL,x=e.graphQLVideoDRMInfo,$=e.initialForceHD,P=e.initialTracePolicy,N=e.isVOD,M=e.loadSequence,w=e.loggingConfig,A=e.loggingToSNAPLAdditionalData,F=e.loggingToVPLAdditionalData,O=e.loopCount,B=e.manifestURL_DO_NOT_USE,W=e.playerFormat,q=e.playerOriginOverride,U=e.pointerTrackingEnabled,V=e.portalingEnabled,H=e.portalingFromVideoID,G=e.portalingPlaceMetaData,z=e.portalingRenderPlaceholder,j=e.poster,K=e.productAttribution,Q=e.renderVideoPixelsFit,X=e.seoWebCrawlerLookasideUrl,Y=e.seoWebCrawlerVideoTracks,J=e.source_VPL_LOGGING_HACK,Z=e.startTimestamp,ee=e.subOrigin,te=e.video,ne=e.volumeSetting,re=e.wrapVideoPixels_EXPERIMENTAL,oe=L===void 0?!1:L,ae=k===void 0?!1:k,ie=D===void 0?!1:D,le=$===void 0?!1:$,se=N===void 0?!1:N,ue=W===void 0?"inline":W,ce=te.id;if(ce==null||ce===""){var de=r("err")("Cannot play video: Invalid video ID: %s",ce===""?"an empty string":String(ce));throw de.name="VideoPlayerInvalidVideoID",de.project="comet_video_player",de}var me=te.dash_prefetch_experimental,pe=r("useVideoPlayerAvailableCaptionsLocalesFromRelay")(te),_e;s[0]!==pe?(_e=pe==null?void 0:pe.find(E),s[0]=pe,s[1]=_e):_e=s[1];var fe=_e!=null,ge;if(s[2]!==((t=te.latency_sensitive_config)==null?void 0:t.broadcast_latency_sensitivity)){var he,ye;ge=o("XFBLatencySensitiveTypeUtils.facebook").toJSEnum((he=te.latency_sensitive_config)==null?void 0:he.broadcast_latency_sensitivity),s[2]=(ye=te.latency_sensitive_config)==null?void 0:ye.broadcast_latency_sensitivity,s[3]=ge}else ge=s[3];var Ce=ge,be;s[4]!==c?(be={adClientToken:c},s[4]=c,s[5]=be):be=s[5];var ve=r("useVideoPlayerShakaConfig")(te,be),Se=y(ce),Re=r("useGraphQLVideoP2PSettings")(te),Le=r("useGraphQLVideoDRMInfo")(te);Le=x!=null?x:Le;var Ee=!!(Le&&Le.fairplayCert!==null),ke=ie===!0||Ee||C===!0&&te.is_live_streaming===!0||b===!0&&typeof MediaSource=="undefined",Ie=r("useVideoPlayerAudioPlayBackLanguageRelay")(te);oe===!0&&(Ie=null);var Te=le?"HD":null,De;s[6]!==B||s[7]!==Ie||s[8]!==ke||s[9]!==Te||s[10]!==ve?(De={dashManifestUrlOverride_DO_NOT_USE:B,minQualityPreferenceOverrideFromProductSurface:Te,playbackLanguageOnComet:Ie,preferBrowserNativeImplementation:ke,videoPlayerShakaConfig:ve},s[6]=B,s[7]=Ie,s[8]=ke,s[9]=Te,s[10]=ve,s[11]=De):De=s[11];var xe=r("useVideoImplementationsRelay")(te,De),$e=r("useVideoPlayerCaptionsSettings")(te),Pe=r("useVideoPlayerAudioSettings")(te,Ie),Ne=r("useVideoPlayerLiveLatencyKnobSettings")(te),Me=Ne.desiredLatencyMs,we=Ne.latencyToleranceMs,Ae=r("useVideoPlayerAudioAvailabilityInfoRelay")(te),Fe=r("useGraphQLVideoAutoplayGatingResult")(te),Oe;s[12]!==_||s[13]!==h||s[14]!==Fe?(Oe=r("getVideoPlayerAutoplayProps")(Fe,h,_),s[12]=_,s[13]=h,s[14]=Fe,s[15]=Oe):Oe=s[15];var Be=Oe,We=r("useVideoPlayerShakaPerformanceLoggerRelay")(te),qe=r("useVideoPlayerShakaPerformanceLoggerBuilder")(te),Ue=r("useVideoPlayerIMFFromVideoMetadataRelay")(te),Ve=r("gkx")("5522"),He;s[16]!==ue||s[17]!==ee||s[18]!==te?(He=m.jsx(o("hero-tracing-placeholder").HeroInteractionContextPassthrough,{clear:Ve,children:m.jsx(r("CometPlaceholder.react"),{fallback:null,name:i.id,children:m.jsx(r("InstreamVideoAdBreaksPlayer.react"),{playerFormat:ue,subOrigin:ee,video:te})})}),s[16]=ue,s[17]=ee,s[18]=te,s[19]=He):He=s[19];var Ge=He,ze=o("CastingStateHooks").useCastingVideoID(),je=o("VideoPlayerUnsupportedBrowserMessageFallback.react").useVideoPlayerUnsupportedBrowserMessageFallback(te.unsupported_browser_message,ce);if(je!=null)return je;var Ke=te.permalink_url,Qe=te.spherical_video_renderer,Xe;s[20]!==ue||s[21]!==Qe||s[22]!==ee||s[23]!==Ke?(Xe=Qe?m.jsx(o("CometRelay").MatchContainer,{match:Qe,props:{playerFormat:ue,sphericalVideoRenderer:Qe,subOrigin:ee,videoTahoeUrl:Ke}}):null,s[20]=ue,s[21]=Qe,s[22]=ee,s[23]=Ke,s[24]=Xe):Xe=s[24];var Ye=Xe,Je=te.is_spherical,Ze=te.is_spherical_enabled,et=te.permalink_url;if(Je===!0&&Ze!==!0){if(et==null||et===""){var tt,nt=r("err")("Cannot play video: Empty permalink URL for a spherical video");nt.name="VideoPlayerSphericalEmptyPermalinkURL",nt.project="comet_video_player";var rt=(tt=nt.metadata)!=null?tt:new(r("ErrorMetadata"));throw rt.addEntry("COMET_VIDEO","VIDEO_ID",ce),nt.metadata=rt,nt}var ot;return s[25]!==et?(ot=m.jsx(v,{videoTahoeUrl:et}),s[25]=et,s[26]=ot):ot=s[26],ot}if(ze!=null&&ze===ce){var at;return s[27]!==te?(at=m.jsx(r("CometPlaceholder.react"),{fallback:null,name:i.id,children:m.jsx(S,{video:te})}),s[27]=te,s[28]=at):at=s[28],at}var it=(n=(a=te.live_playback_instrumentation_configs)==null?void 0:a.is_client_triggered_trace_enabled)!=null?n:!1,lt=!r("isStringNullOrEmpty")(c),st;s[29]!==O||s[30]!==te.is_looping||s[31]!==te.loop_count?(st=r("normalizeVideoPlayerLoopCount")(O,te.is_looping,te.loop_count),s[29]=O,s[30]=te.is_looping,s[31]=te.loop_count,s[32]=st):st=s[32];var ut=st,ct;s[33]!==lt||s[34]!==se||s[35]!==ut?(ct=!lt&&se&&ut===0&&o("FBUnifiedVideoGating").shouldDisableChainingForVOD()?-1:ut,s[33]=lt,s[34]=se,s[35]=ut,s[36]=ct):ct=s[36];var dt=ct,mt;s[37]!==te.height||s[38]!==te.width?(mt=r("computeAspectRatio")(te.width,te.height),s[37]=te.height,s[38]=te.width,s[39]=mt):mt=s[39];var pt=mt,_t=r("gkx")("23009")?te.animated_image_caption:void 0,ft=te.is_podcast_video===!0||p,gt=te.pmv_metadata!=null,ht=Je===!0,yt=X!=null?X:te.seo_web_crawler_lookaside_url,Ct=((l=pe==null?void 0:pe.length)!=null?l:0)>0,bt=ne!==void 0?ne:Pe.preferredVolumeSetting,vt;return s[40]!==We||s[41]!==u||s[42]!==c||s[43]!==d||s[44]!==fe||s[45]!==Ae||s[46]!==Pe.audioUserPreferredLanguage||s[47]!==Ce||s[48]!==f||s[49]!==g||s[50]!==$e.alwaysShowCaptions||s[51]!==$e.captionDisplayStyle||s[52]!==R||s[53]!==Me||s[54]!==oe||s[55]!==ae||s[56]!==Se||s[57]!==I||s[58]!==T||s[59]!==Le||s[60]!==Re||s[61]!==xe||s[62]!==me||s[63]!==P||s[64]!==Ge||s[65]!==it||s[66]!==we||s[67]!==M||s[68]!==w||s[69]!==A||s[70]!==F||s[71]!==dt||s[72]!==ue||s[73]!==q||s[74]!==U||s[75]!==V||s[76]!==H||s[77]!==G||s[78]!==z||s[79]!==j||s[80]!==K||s[81]!==Q||s[82]!==Y||s[83]!==J||s[84]!==Z||s[85]!==ee||s[86]!==_t||s[87]!==ft||s[88]!==gt||s[89]!==ht||s[90]!==yt||s[91]!==Ct||s[92]!==bt||s[93]!==te.broadcast_id||s[94]!==te.broadcast_status||s[95]!==te.broadcaster_origin||s[96]!==te.captions_url||s[97]!==te.is_live_streaming||s[98]!==te.is_live_trace_enabled||s[99]!==te.is_ncsr||s[100]!==te.is_video_broadcast||s[101]!==ce||s[102]!==pt||s[103]!==Be.autoplayGatingResult||s[104]!==Be.autoplaySetting||s[105]!==Be.canAutoplay||s[106]!==Ue||s[107]!==qe||s[108]!==Ye||s[109]!==re?(vt=m.jsx(r("VideoPlayerXImplRelayWrapper.react"),{VideoPlayerShakaPerformanceLoggerClass:We,accessToken:u,adClientToken:c,alt:_t,alwaysShowCaptions:$e.alwaysShowCaptions,apiRef:d,areCaptionsAutogenerated:fe,audioAvailabilityInfo:Ae,audioOnly:ft,autoplayGatingResult:Be.autoplayGatingResult,autoplaySetting:Be.autoplaySetting,broadcastId:te.broadcast_id,broadcastLatencySensitivity:Ce,broadcastStatus:te.broadcast_status,broadcasterOrigin:te.broadcaster_origin,bufferEndLimit:f,bypassUseCometSizeError:g,canAutoplay:Be.canAutoplay,captionDisplayStyle:$e.captionDisplayStyle,children:R,desiredLatencyMs:Me,disableDubbing:oe,disableLoadingIndicator:ae,expiredVideoUrlRefreshHandler:Se,externalLogID:I,externalLogType:T,graphQLVideoDRMInfo:Le,graphQLVideoP2PSettings:Re,implementations:xe,initialRepresentationIds:me,initialTracePolicy:P,instreamVideoAdBreaksPlayer:Ge,isClientTriggeredTraceEnabled:it,isLiveStreaming:te.is_live_streaming,isLiveTraceEnabled:te.is_live_trace_enabled,isNCSR:te.is_ncsr,isPremiumMusicVideo:gt,isSpherical:ht,isVideoBroadcast:te.is_video_broadcast,latencyToleranceMs:we,loadSequence:M,loggingConfig:w,loggingToSNAPLAdditionalData:A,loggingToVPLAdditionalData:F,loopCount:dt,playerFormat:ue,playerOriginOverride:q,pointerTrackingEnabled:U,portalingEnabled:V,portalingFromVideoID:H,portalingPlaceMetaData:G,portalingRenderPlaceholder:z,poster:j,productAttribution:K,renderVideoPixelsFit:Q,seoWebCrawlerLookasideUrl:yt,seoWebCrawlerVideoTracks:Y,sideLoadCaptionsExpected:Ct,sideLoadCaptionsUrl:te.captions_url,source_VPL_LOGGING_HACK:J,startTimestamp:Z,subOrigin:ee,userPreferenceLang:Pe.audioUserPreferredLanguage,videoFBID:ce,videoPixelsAspectRatio:pt,videoPlayerIMFFromVideoMetadata:Ue,videoPlayerShakaPerformanceLoggerBuilder:qe,videoPlayerSpherical:Ye,volumeSetting:bt,wrapVideoPixels_EXPERIMENTAL:re},ce),s[40]=We,s[41]=u,s[42]=c,s[43]=d,s[44]=fe,s[45]=Ae,s[46]=Pe.audioUserPreferredLanguage,s[47]=Ce,s[48]=f,s[49]=g,s[50]=$e.alwaysShowCaptions,s[51]=$e.captionDisplayStyle,s[52]=R,s[53]=Me,s[54]=oe,s[55]=ae,s[56]=Se,s[57]=I,s[58]=T,s[59]=Le,s[60]=Re,s[61]=xe,s[62]=me,s[63]=P,s[64]=Ge,s[65]=it,s[66]=we,s[67]=M,s[68]=w,s[69]=A,s[70]=F,s[71]=dt,s[72]=ue,s[73]=q,s[74]=U,s[75]=V,s[76]=H,s[77]=G,s[78]=z,s[79]=j,s[80]=K,s[81]=Q,s[82]=Y,s[83]=J,s[84]=Z,s[85]=ee,s[86]=_t,s[87]=ft,s[88]=gt,s[89]=ht,s[90]=yt,s[91]=Ct,s[92]=bt,s[93]=te.broadcast_id,s[94]=te.broadcast_status,s[95]=te.broadcaster_origin,s[96]=te.captions_url,s[97]=te.is_live_streaming,s[98]=te.is_live_trace_enabled,s[99]=te.is_ncsr,s[100]=te.is_video_broadcast,s[101]=ce,s[102]=pt,s[103]=Be.autoplayGatingResult,s[104]=Be.autoplaySetting,s[105]=Be.canAutoplay,s[106]=Ue,s[107]=qe,s[108]=Ye,s[109]=re,s[110]=vt):vt=s[110],vt}function E(e){return e.localizedCreationMethod!=null}function k(e){var t=o("react-compiler-runtime").c(9),n,a,i;t[0]!==e?(i=e.doNotRenderErrorBoundaryIUnderstandIMustProvideMyOwn,n=e.errorBoundaryFallback,a=babelHelpers.objectWithoutPropertiesLoose(e,s),t[0]=e,t[1]=n,t[2]=a,t[3]=i):(n=t[1],a=t[2],i=t[3]);var l=i===void 0?!1:i,u;t[4]!==a?(u=m.jsx(r("CometTrackingNodeProvider.react"),{trackingNode:13,children:m.jsx(R,babelHelpers.extends({},a))}),t[4]=a,t[5]=u):u=t[5];var c=u;if(l)return c;var d=n!=null?n:r("defaultErrorBoundaryFallback"),p;return t[6]!==c||t[7]!==d?(p=m.jsx(r("VideoPlayerErrorBoundary.react"),{description:"VideoPlayerRelayBoundary",fallback:d,children:c}),t[6]=c,t[7]=d,t[8]=p):p=t[8],p}l.default=k}),98);
__d("VideoPlayerRelayWithSSR_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"playerSuborigin"}],kind:"Fragment",metadata:null,name:"VideoPlayerRelayWithSSR_video",selections:[{args:[{kind:"Variable",name:"playerSuborigin",variableName:"playerSuborigin"}],kind:"FragmentSpread",name:"VideoPlayerRelay_video"}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("VideoPlayerRelayWithSSR.react",["CometRelay","CometVisualCompletionAttributes","VideoPlayerHooks","VideoPlayerRelay.react","VideoPlayerRelayWithSSR_video.graphql","VideoPlayerSurface.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e=["portalingRenderPlaceholder","silenceHydrationMutationReporting","video","children"],s,u,c,d=u||(u=o("react")),m=u,p=m.useCallback,_=m.useEffect,f=m.useMemo,g=m.useRef,h=m.useState;function y(e){var t=o("react-compiler-runtime").c(4),n=e.hasPlayScheduled,r=g(!1),a=(c||(c=o("VideoPlayerHooks"))).useController(),i,l;return t[0]!==a||t[1]!==n?(i=function(){if(n&&!r.current){var e=window.requestAnimationFrame(function(){return a.play("user_initiated")});return r.current=!0,(function(){window.cancelAnimationFrame(e)})}},l=[a,n],t[0]=a,t[1]=n,t[2]=i,t[3]=l):(i=t[2],l=t[3]),_(i,l),null}function C(t){var a=o("react-compiler-runtime").c(34),i,l,u,c,m;a[0]!==t?(l=t.portalingRenderPlaceholder,c=t.silenceHydrationMutationReporting,m=t.video,i=t.children,u=babelHelpers.objectWithoutPropertiesLoose(t,e),a[0]=t,a[1]=i,a[2]=l,a[3]=u,a[4]=c,a[5]=m):(i=a[1],l=a[2],u=a[3],c=a[4],m=a[5]);var p=c===void 0?!1:c,f=h(b),g=f[0],C=f[1],v,S;a[6]===Symbol.for("react.memo_cache_sentinel")?(v=function(){C(!0)},S=[],a[6]=v,a[7]=S):(v=a[6],S=a[7]),_(v,S);var R=h(!1),L=R[0],E=R[1],k;a[8]!==g?(k=function(){g||E(!0)},a[8]=g,a[9]=k):k=a[9];var I=k,T=o("CometRelay").useFragment(s!==void 0?s:s=n("VideoPlayerRelayWithSSR_video.graphql"),m),D;e:{if(l!=null){var x;a[10]!==l?(x=function(){return l(null)},a[10]=l,a[11]=x):x=a[11],D=x;break e}D=void 0}var $=D,P;a[12]!==L?(P=d.jsx(y,{hasPlayScheduled:L}),a[12]=L,a[13]=P):P=a[13];var N;a[14]!==i||a[15]!==P?(N=d.jsxs(r("VideoPlayerSurface.react"),{children:[P,i]}),a[14]=i,a[15]=P,a[16]=N):N=a[16];var M;a[17]!==$||a[18]!==u||a[19]!==N||a[20]!==T?(M=d.jsx(r("VideoPlayerRelay.react"),babelHelpers.extends({},u,{portalingRenderPlaceholder:$,video:T,children:N})),a[17]=$,a[18]=u,a[19]=N,a[20]=T,a[21]=M):M=a[21];var w=M,A;a[22]!==p?(A=p?r("CometVisualCompletionAttributes").IGNORE:{},a[22]=p,a[23]=A):A=a[23];var F=A,O;a[24]!==I||a[25]!==l?(O=l&&l(I),a[24]=I,a[25]=l,a[26]=O):O=a[26];var B;a[27]===Symbol.for("react.memo_cache_sentinel")?(B="x1ey2m1c x5yr21d xtijo5x x1o0tod x10l6tqk x13vifvy xh8yej3",a[27]=B):B=a[27];var W;a[28]!==F||a[29]!==w?(W=d.jsx("div",babelHelpers.extends({className:B},F,{children:w})),a[28]=F,a[29]=w,a[30]=W):W=a[30];var q;return a[31]!==O||a[32]!==W?(q=d.jsxs(d.Fragment,{children:[O,W]}),a[31]=O,a[32]=W,a[33]=q):q=a[33],q}function b(){return!1}l.default=C}),98);
__d("VideoPlayerSphericalMediaGyroOverlay.react",["fbt","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c="x7o79ul-B",d="x1ojl3eo-B",m="xj1bu7w-B",p="x1v6v46-B";function _(e){var t=o("react-compiler-runtime").c(5),n=e.isActive,r;t[0]!==n?(r={0:{className:"xal61yo x5yr21d xbudbmw xg01cxk x10l6tqk xwa60dl x11lhmoz x1oyok0e xippbsu x19991ni xl405pv xh8yej3 x1vjfegm"},1:{className:"xal61yo x5yr21d xbudbmw x10l6tqk xwa60dl x11lhmoz x1oyok0e xippbsu x19991ni xl405pv xh8yej3 x1vjfegm x1hc1fzr"}}[!!n<<0],t[0]=n,t[1]=r):r=t[1];var a;t[2]===Symbol.for("react.memo_cache_sentinel")?(a=u.jsxs("div",{className:"xatbrnm x1c9tyrk xeusxvb x1pahc9y x1ertn4p x972fbf x10w94by x1qhh985 x14e42zd xy75621 xbudbmw x1hc1fzr x10l6tqk xwa60dl xnrv1ok xni59qk",children:[u.jsxs("div",{className:"x1x1c4bx x1c74tu6 xa4qsjk xgjxtca x8tsxso x1lqxvo2 x158ip91 x1c9tyrk xeusxvb x1pahc9y x1ertn4p x13fuv20 x18b5jzi x1q0q8m5 x1t7ytsu xamhcws x1alpsbp xlxy82 xyumdvf xng8ra x1v1hl4c x10l6tqk xndqk7f x7p49u4 x1oyok0e x1247r65 x1xwhoib",children:[u.jsx("div",{className:"x1x1c4bx x1c74tu6 xa4qsjk x15r1fc x1ngqhlp x16vvtso xniwfb6 x1c9tyrk xeusxvb x1pahc9y x1ertn4p x13fuv20 x18b5jzi x1q0q8m5 x1t7ytsu x178xt8z x1lun4ml xso031l xpilrb4 xwa7hi xbudbmw x10l6tqk xuuh30 xnhpnai x13w7htt x3zwtg x1esw782"}),u.jsx("div",{className:"x1x1c4bx x1c74tu6 xa4qsjk x1ahlmzr x15r1fc x1ngqhlp x16vvtso xniwfb6 x1c9tyrk xeusxvb x1pahc9y x1ertn4p x13fuv20 x18b5jzi x1q0q8m5 x1t7ytsu x178xt8z x1lun4ml xso031l xpilrb4 x10c73hc x10l6tqk xwa60dl x1cb1t30 x1u78mur x5uqrmk xxoll9x"})]}),u.jsx("div",{className:"x1x1c4bx x1c74tu6 xa4qsjk x1c9tyrk xeusxvb x1pahc9y x1ertn4p x972fbf x10w94by x1qhh985 x14e42zd xng8ra xbudbmw x6ikm8r x10wlt62 x10l6tqk x1atx4j1 xuuh30 xuxw1ft xnhpnai x5uqrmk xi294cv",children:s._(/*BTDS*/"{=m0}",[s._implicitParam("=m0",u.jsx("span",{className:"x972fbf x10w94by x1qhh985 x14e42zd x14ctfv xjb2p0i x1f6kntn xng8ra xbudbmw x1wus3qs x10l6tqk x2b8uid xuuh30 xnhpnai",children:s._(/*BTDS*/"360")}))])})]}),t[2]=a):a=t[2];var i;return t[3]!==r?(i=u.jsx("div",babelHelpers.extends({},r,{children:a})),t[3]=r,t[4]=i):i=t[4],i}l.default=_}),226);
__d("VideoPlayerSphericalFallbackCover.react",["fbt","FBLogger","FDSText.react","VideoPlayerSphericalMediaGyroOverlay.react","react","react-compiler-runtime","useCometRouterDispatcher","useFeedClickEventHandler","vulture"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e.useState;function d(e){var t=o("react-compiler-runtime").c(15),n=e.videoTahoeUrl;r("vulture")("lhuAQVojomXLYSx3ychjFSkrPqY=");var a=r("useCometRouterDispatcher")(),i=c(!1),l=i[0],d=i[1];if(a==null)throw r("FBLogger")("comet_video_player").mustfixThrow("Missing CometRouterDispatcher");var m;t[0]!==a||t[1]!==n?(m=function(){a.go(n,{})},t[0]=a,t[1]=n,t[2]=m):m=t[2];var p=r("useFeedClickEventHandler")(m),_;t[3]===Symbol.for("react.memo_cache_sentinel")?(_={className:"x6s0dn4 x1ey2m1c x9f619 x1ypdohk x78zum5 xdt5ytf xtijo5x x1o0tod x13a6bvl x10l6tqk x13vifvy"},t[3]=_):_=t[3];var f,g;t[4]===Symbol.for("react.memo_cache_sentinel")?(f=function(){return d(!0)},g=function(){return d(!1)},t[4]=f,t[5]=g):(f=t[4],g=t[5]);var h,y;t[6]===Symbol.for("react.memo_cache_sentinel")?(h=u.jsx(r("VideoPlayerSphericalMediaGyroOverlay.react"),{isActive:!0}),y={className:"xwajptj x1n2onr6"},t[6]=h,t[7]=y):(h=t[6],y=t[7]);var C;t[8]!==l?(C=l?u.jsx(r("FDSText.react"),{color:"primaryOnMedia",type:"bodyLink3",children:s._(/*BTDS*/"Click to expand")}):null,t[8]=l,t[9]=C):C=t[9];var b;t[10]!==C?(b=u.jsx("div",babelHelpers.extends({},y,{children:C})),t[10]=C,t[11]=b):b=t[11];var v;return t[12]!==p||t[13]!==b?(v=u.jsxs("div",babelHelpers.extends({},_,{onClick:p,onMouseEnter:f,onMouseLeave:g,role:"link",tabIndex:0,children:[h,b]})),t[12]=p,t[13]=b,t[14]=v):v=t[14],v}l.default=d}),226);
__d("handleCometRelayExpiredVideoUrlRefresh",["ErrorMetadata","ErrorSerializer","FBLogger","err"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){var n=t==null?void 0:t.refreshedUrl,o=t==null?void 0:t.reason,a=null;if(t==null?a=r("err")("Video URL refresh data is missing"):(n==null||n==="")&&(o==null||o==="")&&(a=r("err")("Video URL refresh data refreshedUrl is "+(n===""?"an empty string":n===null?"null":"undefined")+" and reason is "+(o===""?"an empty string":o===null?"null":"undefined"))),a!=null){var i=new(r("ErrorMetadata"));throw i.addEntry("COMET_VIDEO","VIDEO_ID",String(e)),a.metadata=i,r("FBLogger")("comet_video_player").catching(a).mustfixThrow("Video URL refresh failed for ID: %s - %s",String(e),r("ErrorSerializer").toReadableMessage(a))}return{reason:o!=null?o:null,refreshedUrl:n!=null?n:null}}l.default=e}),98);
__d("nextgendashSubscribeCometNav",["CometTimeSpentNavigation","VideoPlayerNextgendashEngine"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.clearPrefetchQueue,n=e.deprioritizeCurrentPrefetchTasks,a=e.preventFetchDemandStart;r("CometTimeSpentNavigation").listenToPathChange(function(){o("VideoPlayerNextgendashEngine").sendNavigationSignalToNextgendashWorker({clearPrefetchQueue:t,deprioritizeCurrentPrefetchTasks:n,preventFetchDemandStart:a})})}l.default=e}),98);
__d("useCometRelayExpiredVideoUrlRefreshHandlerQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="29657303523885443"}),null);
__d("useCometRelayExpiredVideoUrlRefreshHandlerQuery.graphql",["useCometRelayExpiredVideoUrlRefreshHandlerQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={defaultValue:null,kind:"LocalArgument",name:"expiredURL"},t={defaultValue:null,kind:"LocalArgument",name:"videoID"},r=[{kind:"Variable",name:"id",variableName:"videoID"}],o={alias:null,args:[{kind:"Variable",name:"expired_url",variableName:"expiredURL"}],concreteType:"RMDRefreshedUrl",kind:"LinkedField",name:"rmd_refreshed_url",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"new_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reason",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[e,t],kind:"Fragment",metadata:null,name:"useCometRelayExpiredVideoUrlRefreshHandlerQuery",selections:[{alias:null,args:r,concreteType:"Video",kind:"LinkedField",name:"video",plural:!1,selections:[o],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,e],kind:"Operation",name:"useCometRelayExpiredVideoUrlRefreshHandlerQuery",selections:[{alias:null,args:r,concreteType:"Video",kind:"LinkedField",name:"video",plural:!1,selections:[o,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:n("useCometRelayExpiredVideoUrlRefreshHandlerQuery_facebookRelayOperation"),metadata:{},name:"useCometRelayExpiredVideoUrlRefreshHandlerQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("useCometRelayExpiredVideoUrlRefreshHandler",["CometRelay","handleCometRelayExpiredVideoUrlRefresh","react","react-compiler-runtime","useCometRelayExpiredVideoUrlRefreshHandlerQuery.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(s||(s=o("react"))).useCallback;function c(t){var a=o("react-compiler-runtime").c(3),i=o("CometRelay").useRelayEnvironment(),l;return a[0]!==i||a[1]!==t?(l=function(l){var a=e!==void 0?e:e=n("useCometRelayExpiredVideoUrlRefreshHandlerQuery.graphql");return o("CometRelay").fetchQuery(i,a,{expiredURL:btoa(l),videoID:t}).toPromise().then(function(e){var n;return r("handleCometRelayExpiredVideoUrlRefresh")(t,e!=null&&(n=e.video)!=null&&n.rmd_refreshed_url?{reason:e.video.rmd_refreshed_url.reason,refreshedUrl:e.video.rmd_refreshed_url.new_url}:null)})},a[0]=i,a[1]=t,a[2]=l):l=a[2],l}l.default=c}),98);/*FB_PKG_DELIM*/
__d("AutoDubbingConsumptionFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("3742"),s=o("FalcoLoggerInternal").create("auto_dubbing_consumption",e),u=s;l.default=u}),98);
__d("AutoDubbingFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("3504"),s=o("FalcoLoggerInternal").create("auto_dubbing",e),u=s;l.default=u}),98);
__d("CometAudioLanguageMenuItemsMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="29971685009145446"}),null);
__d("CometAudioLanguageMenuItemsMutation.graphql",["CometAudioLanguageMenuItemsMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"SetUserPreferredAudioLanguageResponsePayload",kind:"LinkedField",name:"set_user_preferred_audio_language",plural:!1,selections:[{alias:null,args:null,concreteType:"AudioSettings",kind:"LinkedField",name:"audio_settings",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"preferred_language_string",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"CometAudioLanguageMenuItemsMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"CometAudioLanguageMenuItemsMutation",selections:t},params:{id:n("CometAudioLanguageMenuItemsMutation_facebookRelayOperation"),metadata:{},name:"CometAudioLanguageMenuItemsMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("CometAudioLanguageMenuItemsMutation_doNotTranslateMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="24192497507078198"}),null);
__d("CometAudioLanguageMenuItemsMutation_doNotTranslateMutation.graphql",["CometAudioLanguageMenuItemsMutation_doNotTranslateMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"SetUserDoNotTranslateAudioLanguagesResponsePayload",kind:"LinkedField",name:"set_user_do_not_translate_audio_languages",plural:!1,selections:[{alias:null,args:null,concreteType:"AudioSettings",kind:"LinkedField",name:"audio_settings",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"do_not_translate_languages_string",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"CometAudioLanguageMenuItemsMutation_doNotTranslateMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"CometAudioLanguageMenuItemsMutation_doNotTranslateMutation",selections:t},params:{id:n("CometAudioLanguageMenuItemsMutation_doNotTranslateMutation_facebookRelayOperation"),metadata:{},name:"CometAudioLanguageMenuItemsMutation_doNotTranslateMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("CometAudioLanguageMenuItemsMutation",["CometAudioLanguageMenuItemsMutation.graphql","CometAudioLanguageMenuItemsMutation_doNotTranslateMutation.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=e!==void 0?e:e=n("CometAudioLanguageMenuItemsMutation.graphql"),c=s!==void 0?s:s=n("CometAudioLanguageMenuItemsMutation_doNotTranslateMutation.graphql");l.setUserPreferredAudioLanguageDataMutation=u,l.setDoNotTranslateLanguageDataMutation=c}),98);
__d("CometAudioLanguageSupportedLanguagesEnum",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["EN","VI","ZH","HI","AR","PT","ES","DE","IT","FR","BN","ID","JA","KO","RU","TH","TR"]),l=e;i.default=l}),66);
__d("CometAudioLanguageUtils_doNotTranslate.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometAudioLanguageUtils_doNotTranslate",selections:[{alias:null,args:null,concreteType:"AudioSettings",kind:"LinkedField",name:"audio_settings",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"do_not_translate_languages_string",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("CometAudioLanguageUtils_dubbingInfo.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometAudioLanguageUtils_dubbingInfo",selections:[{alias:null,args:null,kind:"ScalarField",name:"viewer_best_language_prediction_for_dubbing",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"audio_user_preferred_language",storageKey:null},{alias:null,args:null,concreteType:"AudioSettings",kind:"LinkedField",name:"audio_settings",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"do_not_translate_languages_string",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"preferred_language_string",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBDubbedTrackMap",kind:"LinkedField",name:"dubbed_track_mapping",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"audio_lang",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dubbing_type",storageKey:null}],storageKey:null}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("CometAudioLanguageUtils_dubtrackMapping.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometAudioLanguageUtils_dubtrackMapping",selections:[{alias:null,args:null,concreteType:"XFBDubbedTrackMap",kind:"LinkedField",name:"dubbed_track_mapping",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"audio_lang",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dubbing_type",storageKey:null}],storageKey:null}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("CometVideoPlayerAutoDubbingWWWStrings",["fbt","FDSLink.react","react"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=s._(/*BTDS*/"Meta AI translation"),d=s._(/*BTDS*/"This reel is translated into your default language using Meta AI to simulate the speaker\u2019s voice and, if the creator chooses, sync their lips to match."),m=s._(/*BTDS*/"AI translations may be inaccurate."),p=s._(/*BTDS*/"{=m0}",[s._implicitParam("=m0",u.jsx(r("FDSLink.react"),{"aria-label":s._(/*BTDS*/"Learn more about AI voice translations"),href:"https://www.facebook.com/help/576364395068889",target:"_blank",children:s._(/*BTDS*/"Learn more")}))]),_=s._(/*BTDS*/"{warning} {learnMore}",[s._param("warning",m),s._param("learnMore",p)]),f=s._(/*BTDS*/"Learn more"),g=s._(/*BTDS*/"Close"),h=s._(/*BTDS*/"Translated audio"),y=s._(/*BTDS*/"This video has been translated and re-recorded into your default language by the creator. Some translations may be inaccurate."),C=s._(/*BTDS*/"Audio translations rating options"),b=s._(/*BTDS*/"Audio and language"),v=s._(/*BTDS*/"Audio description"),S=s._(/*BTDS*/"Rate this voice translation"),R=s._(/*BTDS*/"Additional details (optional)"),L=s._(/*BTDS*/"Why did you give this rating? (optional)"),E=s._(/*BTDS*/"Thanks for your rating, your feedback helps improve Facebook."),k=s._(/*BTDS*/"Voice translation is inaccurate"),I=s._(/*BTDS*/"Voice translation is accurate"),T=s._(/*BTDS*/"Voice translation is robotic"),D=s._(/*BTDS*/"Voice translation is natural"),x=s._(/*BTDS*/"Poor sound quality"),$=s._(/*BTDS*/"Good sound quality"),P=s._(/*BTDS*/"Audio is unclear"),N=s._(/*BTDS*/"Audio is clear"),M=s._(/*BTDS*/"Audio is too fast or slow"),w=s._(/*BTDS*/"Audio is the right speed"),A=s._(/*BTDS*/"Very good"),F=s._(/*BTDS*/"Good"),O=s._(/*BTDS*/"OK"),B=s._(/*BTDS*/"Very bad"),W=s._(/*BTDS*/"Bad"),q=s._(/*BTDS*/"More menu options"),U=s._(/*BTDS*/"Submit"),V=function(t){return s._(/*BTDS*/"{language}",[s._param("language",t.charAt(0).toUpperCase()+t.slice(1))])},H=s._(/*BTDS*/"Don't translate"),G=s._(/*BTDS*/"Choose languages you prefer to keep untranslated."),z=s._(/*BTDS*/"Original audio"),j=s._(/*BTDS*/"Audio description"),K=s._(/*BTDS*/"Save"),Q=s._(/*BTDS*/"Next"),X=s._(/*BTDS*/"Translations and language"),Y=s._(/*BTDS*/"Off"),J=s._(/*BTDS*/"Hear audio translated into your default language in the speaker\u2019s voice when available."),Z=s._(/*BTDS*/"Review voice translation"),ee=s._(/*BTDS*/"Manage voice translation"),te=s._(/*BTDS*/"This video does not have voice translations available at the moment."),ne=s._(/*BTDS*/"Voice translations not available"),re=s._(/*BTDS*/"View Reel"),oe=s._(/*BTDS*/"Speak in English, Spanish, Hindi or Portuguese"),ae=s._(/*BTDS*/"We currently support voice translations between English, Spanish, Hindi or Portuguese with more languages coming in the future."),ie=s._(/*BTDS*/"Say it loud and clear"),le=s._(/*BTDS*/"Try to speak clearly and limit background noise in the video you upload."),se=s._(/*BTDS*/"Add music later"),ue=s._(/*BTDS*/"Music or audio from the audio library can be added, but it will not be translated."),ce=s._(/*BTDS*/"Film with your mouth visible"),de=s._(/*BTDS*/"To sync your lips to the translation, make sure your mouth is uncovered and in the frame."),me=s._(/*BTDS*/"Failed AI translations image"),pe=s._(/*BTDS*/"About translating your voice with Meta AI"),_e=s._(/*BTDS*/"Sometimes we\u2019re not able to translate certain content. Try following these best practices next time you post."),fe=s._(/*BTDS*/"Review voice translations"),ge=s._(/*BTDS*/"Translated with Meta AI"),he=function(t){var e=V(t);return s._(/*BTDS*/"{ originalLabel} ({language})",[s._param(" originalLabel",z),s._param("language",e)])},ye=s._(/*BTDS*/"Shared"),Ce=s._(/*BTDS*/"Not shared"),be=s._(/*BTDS*/"Approve your translation to share your reel in those languages. Your original reel has already been shared."),ve=function(t,n){var e=n==="approve"?s._(/*BTDS*/"Approve"):s._(/*BTDS*/"Delete");return t===0?s._(/*BTDS*/"{action} translations",[s._param("action",e)]):s._(/*BTDS*/"_j{\"*\":\"{action} {numTranslations} translations\",\"_1\":\"{action} {numTranslations} translation\"}",[s._plural(t),s._param("action",e),s._param("numTranslations",t)])},Se=s._(/*BTDS*/"Your translation has been shared. You can remove it anytime from the reel."),Re=s._(/*BTDS*/"Translations deleted"),Le=s._(/*BTDS*/"Meta AI translation deleted"),Ee=s._(/*BTDS*/"Pending voice translations"),ke=s._(/*BTDS*/"Translation in progress"),Ie=s._(/*BTDS*/"You won't be able to translate this reel again."),Te=function(t){return s._(/*BTDS*/"_j{\"*\":\"Delete {numTranslations} voice translations ?\",\"_1\":\"Delete {numTranslations} voice translation ?\"}",[s._plural(t),s._param("numTranslations",t)])},De=function(t){return s._(/*BTDS*/"Delete {selected language} voice translation?",[s._param("selected language",t)])},xe=s._(/*BTDS*/"Delete"),$e=s._(/*BTDS*/"Go back"),Pe=s._(/*BTDS*/"Cancel");l.AI_TRANSLATION_LABEL=c,l.AI_TRANSLATION_BODY=d,l.AI_TRANSLATION_WARNING=m,l.AI_TRANSLATION_LEARN_MORE=p,l.AI_TRANSLATION_WARNING_LEARN_MORE_BODY=_,l.AI_TRANSLATION_LEARN_MORE_LABEL=f,l.AI_TRANSLATION_MODAL_CLOSE=g,l.AUDIO_TRACKS_TRANSLATION_LABEL=h,l.AUDIO_TRACKS_TRANSLATION_BODY=y,l.AUDIO_LANGUAGE_RATINGS_OPTIONS=C,l.AUDIO_LANGUAGE_MODAL_TITLE=b,l.AUDIO_DESCRIPTION_MENU_ITEM_TITLE=v,l.AUDIO_LANGUAGE_RATE_TITLE=S,l.AUDIO_LANGUAGE_RATE_ADDITIONAL_INFO=R,l.AUDIO_LANGUAGE_RATE_REASON_TITLE=L,l.AUDIO_LANGUAGE_RATE_TOAST=E,l.AUDIO_LANGUAGE_RATE_REASON_INACCURATE=k,l.AUDIO_LANGUAGE_RATE_REASON_ACCURATE=I,l.AUDIO_LANGUAGE_RATE_REASON_ROBOTIC=T,l.AUDIO_LANGUAGE_RATE_REASON_NATURAL=D,l.AUDIO_LANGUAGE_RATE_REASON_BAD_SOUND_QUALITY=x,l.AUDIO_LANGUAGE_RATE_REASON_GOOD_SOUND_QUALITY=$,l.AUDIO_LANGUAGE_RATE_REASON_AUDIO_UNCLEAR=P,l.AUDIO_LANGUAGE_RATE_REASON_AUDIO_CLEAR=N,l.AUDIO_LANGUAGE_RATE_REASON_AUDIO_WRONG_SPEED=M,l.AUDIO_LANGUAGE_RATE_REASON_AUDIO_RIGHT_SPEED=w,l.AUDIO_LANGUAGE_RATE_OPTION_VERY_GOOD=A,l.AUDIO_LANGUAGE_RATE_OPTION_GOOD=F,l.AUDIO_LANGUAGE_RATE_OPTION_OK=O,l.AUDIO_LANGUAGE_RATE_OPTION_VERY_BAD=B,l.AUDIO_LANGUAGE_RATE_OPTION_BAD=W,l.REELS_MENU_MORE_OPTIONS=q,l.AUDIO_LANGUAGE_RATE_SUBMIT=U,l.getLanguageLabel=V,l.DO_NOT_TRANSLATE_TITLE=H,l.DO_NOT_TRANSLATE_EXPLANATION=G,l.ORIGINAL_AUDIO_LABEL=z,l.AUDIO_DESCRIPTION_LABEL=j,l.SAVE_USER_LANGUAGE_PREFERENCE=K,l.GO_TO_NEXT_MODAL=Q,l.VOD_TRANSLATIONS_MENU_ITEM=X,l.VOD_TRANSLATIONS_OFF=Y,l.VOD_TRANSLATIONS_DESCRIPTION=J,l.REVIEW_TRANSLATION_MODAL_HEADER=Z,l.MANAGE_TRANSLATION_MODAL_HEADER=ee,l.DUBBING_NULL_STATE_BODY=te,l.DUBBING_NULL_STATE_HEADER=ne,l.DUBBING_MANAGEMENT_REROUTE_TO_REEL=re,l.BEST_PRACTICES_ELLIGIBLE_LANGUAGES_HEADER=oe,l.BEST_PRACTICES_ELLIGIBLE_LANGUAGES_BODY=ae,l.BEST_PRACTICES_CLEAR_SPEECH_HEADER=ie,l.BEST_PRACTICES_CLEAR_SPEECH_BODY=le,l.BEST_PRACTICES_NO_MUSIC_HEADER=se,l.BEST_PRACTICES_NO_MUSIC_BODY=ue,l.BEST_PRACTICES_VISIBLE_MOUTH_HEADER=ce,l.BEST_PRACTICES_VISIBLE_MOUTH_BODY=de,l.FAILED_TRANSLATION_IMG_ALT=me,l.BEST_PRACTICES_PAGE_HEADER=pe,l.GENERIC_TRANSLATIONS_ERROR=_e,l.REVIEW_TRANSLATION_SECTION_HEADER=fe,l.META_AI_SECTION_HEADER=ge,l.getOriginalLanguageLabel=he,l.TRANSLATION_SHARED_DESCRIPTION=ye,l.TRANSLATION_NOT_SHARED_DESCRIPTION=Ce,l.COMET_TRANSLATION_APPROVAL_META=be,l.COMET_APPROVE_DELETE_TRANSLATION_LABEL=ve,l.COMET_TRANSLATION_APPROVED_SUCCESS=Se,l.COMET_TRANSLATION_DELETED_SUCCESS=Re,l.COMET_TRANSLATION_DELETED_SUCCESS_MANAGEMENT=Le,l.PENDING_VOICE_TRANSLATIONS_HEADER=Ee,l.TRANSLATION_IN_PROGRESS_DESCRIPTION=ke,l.COMET_DELETE_MODAL_BODY=Ie,l.COMET_DELETE_MODAL_TITLE_MULTI_LANG=Te,l.COMET_DELETE_MODAL_TITLE_SINGLE_LANG=De,l.COMET_DELETE_MODAL_CONFIRMATION=xe,l.COMET_DELETE_MODAL_CANCEL=$e,l.COMET_DELETE_MODAL_CANCEL_BUTTON=Pe}),226);
__d("VideoPlayerAudioTrackUtils",["fbt"],(function(t,n,r,o,a,i,l,s){"use strict";var e=function(t,n){if(n!=null){var e=String(t).substring(0,2);try{return new Intl.DisplayNames([e],{type:"language"}).of(n)}catch(e){return}}},u=function(n,r){if(n==null)return s._(/*BTDS*/"Default");var t=e(r,n.lang),o=t!=null?t:s._(/*BTDS*/"Default"),a=null;return n.role==="dub"?a=s._(/*BTDS*/"Dubbed"):(n==null?void 0:n.role)==="description"&&(a=s._(/*BTDS*/"Description")),a!=null?o.toString()+" - "+a.toString():o};l.getIntlDisplayName=e,l.getAudioTrackLabelLocalized=u}),226);
__d("XFBDubbingTypeEnum.facebook",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum").Mirrored(["AUDIODESCRIPTION","AUTODUB","BYOA","MANUALDUB","NONE"]),l=e;i.default=l}),66);
__d("CometAudioLanguageUtils",["AutoDubbingConsumptionFalcoEvent","AutoDubbingFalcoEvent","CometAudioLanguageMenuItemsMutation","CometAudioLanguageSupportedLanguagesEnum","CometAudioLanguageUtils_doNotTranslate.graphql","CometAudioLanguageUtils_dubbingInfo.graphql","CometAudioLanguageUtils_dubtrackMapping.graphql","CometRelay","CometVideoPlayerAutoDubbingWWWStrings","CurrentLocale","VideoPlayerAudioTrackUtils","cometPushToast","gkx","intlList","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e=["label"],s,u,c,d,m=d||(d=o("react")),p=m.useEffect,_=m.useMemo,f=m.useRef,g=null,h=function(t,n,o,a,i,l){var e={client_extra_data:{dubbing_type_from:o==null?"original":o,dubbing_type_to:a==null?"original":a,lang_from:t!=null?t:"original",lang_to:n!=null?n:"original",player_type:"Reel"},event:i,video_id:l!=null?l:""};r("AutoDubbingConsumptionFalcoEvent").log(function(){return e})},y=function(t,n){var e,r=(e=t==null?void 0:t.lang)!=null?e:null;return(t==null?void 0:t.lang)===null&&t.role==null&&(r=n!=null?n:null),r},C=function(t,n,o){var e={client_extra_data:{lang:t!=null?t:""},event:o,video_id:n!=null?n:""};r("AutoDubbingConsumptionFalcoEvent").log(function(){return e})};function b(e){var t,r=o("CometRelay").useFragment(s!==void 0?s:s=n("CometAudioLanguageUtils_dubtrackMapping.graphql"),e);return(t=r==null?void 0:r.dubbed_track_mapping)!=null?t:null}var v=function(t){var e=null;if(t!=null){var n;e=(n=t.find(function(e){return e.dubbing_type==="NONE"&&e.audio_lang!=null}))==null?void 0:n.audio_lang}return e};function S(e,t){var n=o("react-compiler-runtime").c(7),a,i;if(n[0]!==e||n[1]!==t){var l={};if(a=null,e!=null&&t!=null){var s={};t.forEach(function(e){var t;e.dubbing_type==="NONE"&&e.audio_lang!=null?(t="Default",a=e.audio_lang):t=e.audio_lang;var n=o("VideoPlayerAudioTrackUtils").getIntlDisplayName(r("CurrentLocale").get(),e.audio_lang);n!=null&&t!=null&&(s[t]=n.charAt(0).toUpperCase()+n.slice(1))}),e.forEach(function(e){if(e.lang!==null&&!(e.id in l)&&e.lang in s){var t=s[e.lang];e.role==="description"&&(t=t+" \xB7 "+o("CometVideoPlayerAutoDubbingWWWStrings").AUDIO_DESCRIPTION_LABEL.toString()),l[e.id]=babelHelpers.extends({},e,{label:t})}else if(e.displayLabel==="Default"){var n,r=o("CometVideoPlayerAutoDubbingWWWStrings").ORIGINAL_AUDIO_LABEL.toString();if(s[(n=e.lang)!=null?n:"Default"]){var a;r=s[(a=e.lang)!=null?a:"Default"]+" \xB7 "+r}l[e.id]=babelHelpers.extends({},e,{label:r})}})}i=Object.values(l).sort(R),n[0]=e,n[1]=t,n[2]=a,n[3]=i}else a=n[2],i=n[3];var u=i,c;return n[4]!==a||n[5]!==u?(c={allAvailableTracks:u,originalLanguage:a},n[4]=a,n[5]=u,n[6]=c):c=n[6],c}function R(e,t){return e.role===null?-1:t.role===null?1:e.label.localeCompare(t.label)}function L(e){var t,r=o("CometRelay").useFragment(u!==void 0?u:u=n("CometAudioLanguageUtils_doNotTranslate.graphql"),e);return r==null||(t=r.audio_settings)==null?void 0:t.do_not_translate_languages_string}function E(e){var t=o("react-compiler-runtime").c(2),n;if(e==null||e.length===0)n=null;else{var a;if(t[0]!==e){var i=[];e.forEach(function(e){var t=o("VideoPlayerAudioTrackUtils").getIntlDisplayName(r("CurrentLocale").get(),e);t!=null&&(t=t.charAt(0).toUpperCase()+t.slice(1),i.push(t))}),i.sort(),a=r("intlList")(i),t[0]=e,t[1]=a}else a=t[1];n=a}return n}var k=function(n){var t=n.controller,r=n.originalLanguage,o=n.saveAndLogPreferredLanguage,a=n.selectedTrack,i=n.setPause,l=n.setUpdatedTargetAudioTrack,s=n.updatedTargetAudioTrack,u=n.videoId;if((t==null?void 0:t.selectVideoVariant)!=null&&a){var c=a.label,d=babelHelpers.objectWithoutPropertiesLoose(a,e);t.selectVideoVariant({lang:d.lang,role:d.role}),i(!1,"AUDIO_LANGUAGE_SELECTOR");var m=y(d,r),p=y(s!=null?s:null,r);o(p,m,s==null?void 0:s.role,a.role,u),l(d)}};function I(){var e=o("react-compiler-runtime").c(2),t=o("CometRelay").useMutation(o("CometAudioLanguageMenuItemsMutation").setUserPreferredAudioLanguageDataMutation),n=t[0],r;return e[0]!==n?(r=function(t,r,o,a,i){r!=null&&n({onCompleted:D,onError:T,variables:{input:{language_code:r}}}),h(t!=null?t:null,r!=null?r:null,o!=null?o:null,a!=null?a:null,"fb_reel_auto_dub_consumption_preferred_language_changed",i!=null?i:null)},e[0]=n,e[1]=r):r=e[1],r}function T(){}function D(e,t){}function x(e,t){var a=o("react-compiler-runtime").c(4),i=r("gkx")("17327"),l=r("gkx")("19163"),s=o("CometRelay").useFragment(c!==void 0?c:c=n("CometAudioLanguageUtils_dubbingInfo.graphql"),e),u=null,d=g,m=null;if(!t&&s!=null&&(s==null?void 0:s.dubbed_track_mapping)!=null&&(s==null?void 0:s.dubbed_track_mapping.length)>0&&i){var p,_,f,h,y=(p=(_=s.dubbed_track_mapping.find($))==null?void 0:_.audio_lang)!=null?p:null,C=!1;y!=null&&(C=s.dubbed_track_mapping.filter(function(e){return e.audio_lang===y}).length>1);var b=(f=s.audio_settings)==null?void 0:f.do_not_translate_languages_string,v=s==null||(h=s.audio_settings)==null?void 0:h.preferred_language_string,S=s==null?void 0:s.viewer_best_language_prediction_for_dubbing,R=s.audio_user_preferred_language;y!=null&&b!=null&&b.includes(y)?(d=y,u="fb_reel_auto_dub_consumption_do_not_translate_languages_match"):v!=null&&s.dubbed_track_mapping.find(function(e){return e.audio_lang===v})!=null?(d=v,u="fb_reel_auto_dub_consumption_preferred_language_match"):l&&S!=null&&S!==y&&s.dubbed_track_mapping.find(function(e){return e.audio_lang===S})!=null?(d=S,u="fb_reel_auto_dub_consumption_blp_match"):l&&R!=null&&R!==y&&s.dubbed_track_mapping.find(function(e){return e.audio_lang===R})!=null&&(d=R,u="fb_reel_auto_dub_consumption_fallback_to_app_lang"),m=d,C&&d===y&&(d=g)}var L;return a[0]!==u||a[1]!==m||a[2]!==d?(L={event:u,lang:d,loggingLang:m},a[0]=u,a[1]=m,a[2]=d,a[3]=L):L=a[3],L}function $(e){return e.dubbing_type==="NONE"}function P(){var e=o("react-compiler-runtime").c(1),t;if(e[0]===Symbol.for("react.memo_cache_sentinel")){var n=Array.from(r("CometAudioLanguageSupportedLanguagesEnum").members(),w),a=r("CurrentLocale").get();t=n.map(function(e){var t=o("VideoPlayerAudioTrackUtils").getIntlDisplayName(a,e);return t!=null?[e,t]:null}).filter(M),t.sort(N),e[0]=t}else t=e[0];var i=t;return i}function N(e,t){return(e[1]||"").localeCompare(t[1]||"")}function M(e){return e!==null&&e[1]!=null}function w(e){return e.valueOf().toLowerCase()}var A=function(t){var e=t.availableAudioTracks,n=t.controller,r=t.currentValue,o=t.originalVideoLanguage,a=t.selectedLanguages,i=t.setSelectedLanguages,l;return a.includes(r)?l=a.filter(function(e){return e!==r}):(l=[].concat(a,[r]),o!=null&&r===o&&F({availableAudioTracks:e,controller:n,originalVideoLanguage:o})),i(l),l},F=function(t){var e=t.availableAudioTracks,n=t.controller,r=t.originalVideoLanguage;if(r!=null&&n!=null&&e!=null){var o=e.find(function(e){return e.role==null});o!=null&&(n==null||n.selectVideoVariant({lang:o.lang,role:o.role}))}},O=function(t){var e=t.onClose,n=t.rating,a=t.ratingDetails,i=t.selectedReasons,l=t.targetAudioLang,s=t.video_id,u={event:"fb_reel_auto_dub_feedback",extra_data:{feedback:a!=null?a:"",player_type:"Reel",rating_reasons:JSON.stringify(i),selected_language:l!=null?l:"unknown",selected_rating:n!=null?n:"unknown"},video_id:s!=null?String(s):""};r("AutoDubbingFalcoEvent").log(function(){return u}),e(),o("cometPushToast").cometPushToast({message:o("CometVideoPlayerAutoDubbingWWWStrings").AUDIO_LANGUAGE_RATE_TOAST,withoutCloseButton:!0},2e3)},B=function(t,n){var e={client_extra_data:{languages:t.join(",")},event:"fb_reel_auto_dub_consumption_do_not_translate_languages_changed",video_id:n!=null?String(n):""};r("AutoDubbingConsumptionFalcoEvent").log(function(){return e})};function W(){var e=o("react-compiler-runtime").c(2),t=o("CometRelay").useMutation(o("CometAudioLanguageMenuItemsMutation").setDoNotTranslateLanguageDataMutation),n=t[0],r;return e[0]!==n?(r=function(t,r){n({onCompleted:function(){B(t,r)},onError:q,optimisticResponse:{audio_settings:{do_not_translate_languages_string:t,id:r}},variables:{input:{language_codes:t}}})},e[0]=n,e[1]=r):r=e[1],r}function q(){}var U=function(t,n,o,a){var e={client_extra_data:{fromTrackId:o!=null?o:"",reason:t,toTrackId:a!=null?a:""},event:"fb_reel_auto_dub_consumption_logger_error",video_id:n!=null?n:""};r("AutoDubbingConsumptionFalcoEvent").log(function(){return e})},V=function(t,n,r,o){var e=n==null&&(r==null?void 0:r.role)==="dub"||(n==null?void 0:n.id)!=null&&(r==null?void 0:r.id)!==(n==null?void 0:n.id),a=null;return e&&(t==null?(e=!1,a="availableAudioTracks is null"):r==null?e=!1:t!=null&&n!=null&&t.find(function(e){return e.id===n.id})==null?(e=!1,a="fromTrack is not in availableAudioTracks"):t!=null&&r!=null&&t.find(function(e){return e.id===r.id})==null?(e=!1,a="toTrack is not in availableAudioTracks"):(n==null?void 0:n.id)!=null&&(n==null?void 0:n.id)===(r==null?void 0:r.id)?(e=!1,a="fromTrack and toTrack are the same"):n==null&&(r==null?void 0:r.role)!=="dub"&&(e=!1,a="toTrack is not dubbed")),!e&&a!=null&&U(a,o,n==null?void 0:n.id,r==null?void 0:r.id),e};function H(e,t,n,r){var a=o("react-compiler-runtime").c(6),i=f(null),l,s;a[0]!==r||a[1]!==n||a[2]!==t||a[3]!==e?(l=function(){var o=V(r,i.current,e,n);if(o){var a,l,s,u,c=y((a=i.current)!=null?a:null,t);i.current==null&&c==null&&(c=t);var d=y(e,t);h(c,d,(l=(s=i.current)==null?void 0:s.role)!=null?l:null,(u=e==null?void 0:e.role)!=null?u:null,"fb_reel_auto_dub_consumption",n!=null?n:"")}i.current=e},s=[e,t,n,r],a[0]=r,a[1]=n,a[2]=t,a[3]=e,a[4]=l,a[5]=s):(l=a[4],s=a[5]),p(l,s)}l.logConsumptionLanguageChange=h,l.getSelectedLanguage=y,l.logInitialDubbingConsumption=C,l.useGetDubTrackMapping=b,l.getOriginalLanguage=v,l.useGetAllAvailableTracks=S,l.useGetUserSelectedDoNotTranslateLanguageList=L,l.useGetCurrentDoNotTranslateLanguages=E,l.changePreferredLanguage=k,l.useSaveAndLogPreferredLanguage=I,l.useUserPreferredLanguage=x,l.useAllTransalateableLanguages=P,l.changeUserPreferredDoNotTranslateLanguages=A,l.changeAudioToOriginalLanguage=F,l.logTransalationRating=O,l.logDoNotTranslateLanguageSave=B,l.useSaveAndLogDoNotTranslateLanguages=W,l.useLogTargetAudioChange=H}),98);
__d("VideoHomeTypedLiteLogger",["generateLiteTypedLogger"],(function(t,n,r,o,a,i){"use strict";a.exports=n("generateLiteTypedLogger")("logger:VideoHomeLoggerConfig")}),null);
__d("VideoPlayerLiveRewindControlContext",["react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.createContext({cachedLiveRewindTimestamp:null,onLiveRewindControlEvent:function(){}});l.default=u}),98);
__d("VideoPlayerPlaybackControlBase.react",["fbt","ix","FBLogger","VideoPlayerControlIcon.react","fbicon","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s,u){"use strict";var e,c=e||(e=o("react"));function d(e){var t=o("react-compiler-runtime").c(14),n=e.onPress,a=e.playbackIcon,i=e.showTooltip,l=e.useOutlineIcons,d=i===void 0?!0:i,m,p;e:switch(a){case"pause":{var _;t[0]===Symbol.for("react.memo_cache_sentinel")?(_=s._(/*BTDS*/"Pause"),t[0]=_):_=t[0],m=_;var f;t[1]!==l?(f=l===!0?o("fbicon")._(u("497677"),20):o("fbicon")._(u("497675"),20),t[1]=l,t[2]=f):f=t[2],p=f;break e}case"replay":{var g;t[3]===Symbol.for("react.memo_cache_sentinel")?(g=s._(/*BTDS*/"Replay"),t[3]=g):g=t[3],m=g;var h;t[4]!==l?(h=l===!0?o("fbicon")._(u("534222"),20):o("fbicon")._(u("534219"),20),t[4]=l,t[5]=h):h=t[5],p=h;break e}case"play":{var y;t[6]===Symbol.for("react.memo_cache_sentinel")?(y=s._(/*BTDS*/"Play"),t[6]=y):y=t[6],m=y;var C;t[7]!==l?(C=l===!0?o("fbicon")._(u("484866"),20):o("fbicon")._(u("484863"),20),t[7]=l,t[8]=C):C=t[8],p=C;break e}default:throw r("FBLogger")("comet_video_player").mustfixThrow("The playback icon is unsupported %s",a)}var b=d?m:null,v;return t[9]!==p||t[10]!==m||t[11]!==n||t[12]!==b?(v=c.jsx(r("VideoPlayerControlIcon.react"),{icon:p,label:m,onPress:n,tooltip:b}),t[9]=p,t[10]=m,t[11]=n,t[12]=b,t[13]=v):v=t[13],v}l.default=d}),226);
__d("VideoPlayerPlaybackControl.react",["CometTrackingNodeProvider.react","VideoHomeTypedLiteLogger","VideoPlayerHooks","VideoPlayerPlaybackControlBase.react","react","react-compiler-runtime","useFeedClickEventHandler","useMinifiedProductAttribution","useVideoPlayerControllerSubscription"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=e||(e=o("react")),c=e.useEffect;function d(e){var t=o("react-compiler-runtime").c(14),n=e.isNPC,a=e.showTooltip,i=e.unmuteOnPlay,l=e.useOutlineIcons,d=n===void 0?!1:n,p=a===void 0?!0:a,_=i===void 0?!1:i,f,g;t[0]!==d?(f=function(){d&&r("VideoHomeTypedLiteLogger").log({event:"npc_control_playback_button_impression"})},g=[d],t[0]=d,t[1]=f,t[2]=g):(f=t[1],g=t[2]),c(f,g);var h=r("useVideoPlayerControllerSubscription")(m),y=h.showPauseButton,C=h.showReplayButton,b=(s||(s=o("VideoPlayerHooks"))).useController(),v=r("useMinifiedProductAttribution")(),S;t[3]!==b||t[4]!==d||t[5]!==v||t[6]!==y||t[7]!==_?(S=function(){d&&r("VideoHomeTypedLiteLogger").log({attribution_id_v2:v,click_point:"npc_control_playback_button",event:"click",event_target:"video"}),y?b.pause("user_initiated"):(_&&b.setMuted(!1,"user_initiated"),b.play("user_initiated"))},t[3]=b,t[4]=d,t[5]=v,t[6]=y,t[7]=_,t[8]=S):S=t[8];var R=r("useFeedClickEventHandler")(S),L=y?"pause":C?"replay":"play",E;return t[9]!==R||t[10]!==L||t[11]!==p||t[12]!==l?(E=u.jsx(r("CometTrackingNodeProvider.react"),{trackingNode:592,children:u.jsx(r("VideoPlayerPlaybackControlBase.react"),{onPress:R,playbackIcon:L,showTooltip:p,useOutlineIcons:l})}),t[9]=R,t[10]=L,t[11]=p,t[12]=l,t[13]=E):E=t[13],E}function m(e,t){var n=e.getCurrentState(),r=n.ended,o=n.paused,a=n.playing,i=n.stalling,l=e.getPlayheadPosition(),s=n.duration,u=!o&&(a||i),c=!a&&r&&l>=s;return t!=null&&t.showPauseButton===u&&t.showReplayButton===c?t:{showPauseButton:u,showReplayButton:c}}l.default=d}),98);
__d("getFormattedTimestamp",["DateConsts"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t="",n=e;isNaN(n)?n=0:n<0&&(n*=-1,t="-");var r=Math.floor(n/o("DateConsts").SEC_PER_HOUR),a=Math.floor((n-r*o("DateConsts").SEC_PER_HOUR)/o("DateConsts").SEC_PER_MIN),i=Math.round(n-r*o("DateConsts").SEC_PER_HOUR-a*o("DateConsts").SEC_PER_MIN);i===o("DateConsts").SEC_PER_MIN&&(i=0,a++),a===o("DateConsts").MIN_PER_HOUR&&(a=0,r++);var l=("0"+i).slice(-2);if(r===0)return""+t+a+":"+l;var s=("0"+a).slice(-2);return""+t+r+":"+s+":"+l}l.default=e}),98);
__d("VideoPlayerPlaybackTimerBase.react",["getFormattedTimestamp","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){var t=o("react-compiler-runtime").c(11),n=e.currentTime,a=e.duration,i,l;t[0]===Symbol.for("react.memo_cache_sentinel")?(i={className:"x14ctfv x1rg5ohu x1pg5gke xss6m8b x7h9g57 xf6vk7d xpcyujq x9hgts1 x2b8uid x27saw0 x3ajldb"},l={className:"x1s688f x15hfatp"},t[0]=i,t[1]=l):(i=t[0],l=t[1]);var u;t[2]!==n?(u=r("getFormattedTimestamp")(n),t[2]=n,t[3]=u):u=t[3];var c;t[4]!==u?(c=s.jsx("span",babelHelpers.extends({},l,{children:u})),t[4]=u,t[5]=c):c=t[5];var d;t[6]!==a?(d=a!=null&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:" / "}),s.jsx("span",{children:r("getFormattedTimestamp")(a)})]}),t[6]=a,t[7]=d):d=t[7];var m;return t[8]!==c||t[9]!==d?(m=s.jsxs("div",babelHelpers.extends({},i,{children:[c,d]})),t[8]=c,t[9]=d,t[10]=m):m=t[10],m}l.default=u}),98);
__d("useLiveRewindUtils",["VideoPlayerHooks","VideoPlayerLiveRewindControlContext","react","react-compiler-runtime","useVideoPlayerControllerSubscription"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=e||(e=o("react")),c=u.useCallback,d=u.useContext,m=10,p=10;function _(){var e=o("react-compiler-runtime").c(3),t=(s||(s=o("VideoPlayerHooks"))).useController(),n=d(r("VideoPlayerLiveRewindControlContext")),a;return e[0]!==n||e[1]!==t?(a=function(){var e,r=t.getCurrentState().seekableRanges,o=r!=null&&(e=r.end(r.length()-1))!=null?e:0,a=Math.min(t.getPlayheadPosition()+m,o);a===o?(t.setIsLiveRewindActive(!1),t.seek(o)):t.seek(a),n.onLiveRewindControlEvent()},e[0]=n,e[1]=t,e[2]=a):a=e[2],a}function f(){var e=o("react-compiler-runtime").c(3),t=(s||(s=o("VideoPlayerHooks"))).useController(),n=d(r("VideoPlayerLiveRewindControlContext")),a;return e[0]!==n||e[1]!==t?(a=function(){var e,r=t.getCurrentState().seekableRanges,o=(e=r==null?void 0:r.start(0))!=null?e:0,a=Math.max(t.getPlayheadPosition()-p,o);t.seek(a),t.setIsLiveRewindActive(!0),n.onLiveRewindControlEvent()},e[0]=n,e[1]=t,e[2]=a):a=e[2],a}function g(){var e=o("react-compiler-runtime").c(3),t=(s||(s=o("VideoPlayerHooks"))).useController(),n=d(r("VideoPlayerLiveRewindControlContext")),a;return e[0]!==n||e[1]!==t?(a=function(){var e,r=t.getCurrentState().seekableRanges,o=r!=null&&(e=r.end(r.length()-1))!=null?e:0;t.seek(o),t.play("user_initiated"),t.setIsLiveRewindActive(!1),n.onLiveRewindControlEvent()},e[0]=n,e[1]=t,e[2]=a):a=e[2],a}function h(){var e=o("react-compiler-runtime").c(3),t=(s||(s=o("VideoPlayerHooks"))).useController(),n=d(r("VideoPlayerLiveRewindControlContext")),a;return e[0]!==n||e[1]!==t?(a=function(){var e,r=t.getCurrentState().seekableRanges,o=(e=r==null?void 0:r.start(0))!=null?e:0;t.seek(o),t.setIsLiveRewindActive(!0),n.onLiveRewindControlEvent()},e[0]=n,e[1]=t,e[2]=a):a=e[2],a}function y(){var e=o("react-compiler-runtime").c(3),t=(s||(s=o("VideoPlayerHooks"))).useController(),n=d(r("VideoPlayerLiveRewindControlContext")),a;return e[0]!==n||e[1]!==t?(a=function(){t.play("user_initiated"),n.onLiveRewindControlEvent()},e[0]=n,e[1]=t,e[2]=a):a=e[2],a}function C(){var e=o("react-compiler-runtime").c(3),t=(s||(s=o("VideoPlayerHooks"))).useController(),n=d(r("VideoPlayerLiveRewindControlContext")),a;return e[0]!==n||e[1]!==t?(a=function(){t.pause("user_initiated"),t.setIsLiveRewindActive(!0),n.onLiveRewindControlEvent()},e[0]=n,e[1]=t,e[2]=a):a=e[2],a}function b(){var e=o("react-compiler-runtime").c(3),t=(s||(s=o("VideoPlayerHooks"))).useController(),n=d(r("VideoPlayerLiveRewindControlContext")),a;return e[0]!==n||e[1]!==t?(a=function(){var e,r=t.getCurrentState().seekableRanges,o=(e=r==null?void 0:r.start(0))!=null?e:0;t.seek(o),t.setIsLiveRewindActive(!0),t.play("user_initiated"),n.onLiveRewindControlEvent()},e[0]=n,e[1]=t,e[2]=a):a=e[2],a}function v(){var e=o("react-compiler-runtime").c(3),t=(s||(s=o("VideoPlayerHooks"))).useController(),n=d(r("VideoPlayerLiveRewindControlContext")),a;return e[0]!==n||e[1]!==t?(a=function(r){var e,o,a=t.getCurrentState().seekableRanges,i=(e=a==null?void 0:a.start(0))!=null?e:0,l=a!=null&&(o=a.end(a.length()-1))!=null?o:0,s=Math.min(i+r,l);t.scrubEnd(s),s===l?t.setIsLiveRewindActive(!1):t.setIsLiveRewindActive(!0),n.onLiveRewindControlEvent()},e[0]=n,e[1]=t,e[2]=a):a=e[2],a}function S(){return r("useVideoPlayerControllerSubscription")(R)}function R(e){var t,n;return(t=(n=e.getCurrentState().seekableRanges)==null?void 0:n.start(0))!=null?t:0}l.useLiveRewindForward=_,l.useLiveRewindBack=f,l.useLiveRewindLive=g,l.useLiveRewindStart=h,l.useLiveRewindPlay=y,l.useLiveRewindPause=C,l.useLiveRewindReplay=b,l.useLiveRewindScrub=v,l.useLiveRewindSeekableStartTime=S}),98);
__d("VideoPlayerPlaybackTimer.react",["VideoPlayerHooks","VideoPlayerPlaybackTimerBase.react","react","react-compiler-runtime","useLiveRewindUtils"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=e||(e=o("react")),c=_,d=function(t,n){return t-n.duration};function m(){var e=o("react-compiler-runtime").c(2),t=o("useLiveRewindUtils").useLiveRewindSeekableStartTime(),n=(s||(s=o("VideoPlayerHooks"))).useCurrentTimeThrottled(200),a=s.useCurrentTimeThrottled(1e3,d),i=s.useIsLiveRewindActive(),l=i?a:n-t,c;return e[0]!==l?(c=u.jsx(r("VideoPlayerPlaybackTimerBase.react"),{currentTime:l,duration:null}),e[0]=l,e[1]=c):c=e[1],c}function p(){var e=o("react-compiler-runtime").c(3),t=(s||(s=o("VideoPlayerHooks"))).useDuration(),n=s.useCurrentTimeThrottled(200),a;return e[0]!==n||e[1]!==t?(a=u.jsx(r("VideoPlayerPlaybackTimerBase.react"),{currentTime:n,duration:t}),e[0]=n,e[1]=t,e[2]=a):a=e[2],a}function _(){var e=o("react-compiler-runtime").c(2),t=(s||(s=o("VideoPlayerHooks"))).useIsLive();if(t){var n;return e[0]===Symbol.for("react.memo_cache_sentinel")?(n=u.jsx(m,{}),e[0]=n):n=e[0],n}else{var r;return e[1]===Symbol.for("react.memo_cache_sentinel")?(r=u.jsx(p,{}),e[1]=r):r=e[1],r}}var f=c;l.default=f}),98);
__d("VideoPlayerPointerDrag",["react","react-compiler-runtime","useResizeObserver","useStable"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.useEffect,c=s.useRef,d=s.useState;function m(){var e=o("react-compiler-runtime").c(5),t=c(null),n=c(null),a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=function(r,o){t.current=o.getBoundingClientRect(),n.current=o},e[0]=a):a=e[0];var i=r("useResizeObserver")(a),l;e[1]===Symbol.for("react.memo_cache_sentinel")?(l=function(){return function(){var e=n.current;e?t.current=e.getBoundingClientRect():t.current=null}},e[1]=l):l=e[1];var s=r("useStable")(l),u;return e[2]!==s||e[3]!==i?(u={invalidateRootRect:s,rootRectRef:t,rootSizeRefCallback:i},e[2]=s,e[3]=i,e[4]=u):u=e[4],u}function p(e,t){if(t==null)return null;var n=Math.max(0,Math.min(t.width,e.clientX-t.left)),r=Math.max(0,Math.min(t.height,e.clientY-t.top));return{ratioX:t.width>0?n/t.width:0,ratioY:t.height>0?r/t.height:0}}function _(e,t){var n=e.changedTouches;if(t==null||!n)return null;for(var r=0;r<n.length;++r){var o=n[r];if(o.identifier===t)return{clientX:o.clientX,clientY:o.clientY}}return null}function f(e,t){var n=e;switch(t.type){case"start":n=babelHelpers.extends({},e,{clientX:t.clientX,clientY:t.clientY,dragState:"dragging",lastEffect:e.dragState==="idle"?"start":e.lastEffect});break;case"move":if(e.dragState!=="dragging")break;n={clientX:t.clientX,clientY:t.clientY,dragState:"dragging",lastEffect:"move"};break;case"end":if(e.dragState!=="dragging")break;n={clientX:t.clientX,clientY:t.clientY,dragState:"idle",lastEffect:"end"};break;case"cancel":if(e.dragState!=="dragging")break;n={clientX:e.clientX,clientY:e.clientY,dragState:"idle",lastEffect:"cancel"};break;default:break}return n.dragState!==e.dragState||n.lastEffect!==e.lastEffect||n.clientX!==e.clientX||n.clientY!==e.clientY?n:e}var g={clientX:0,clientY:0,dragState:"idle",lastEffect:null},h=function(){return window.navigator.userAgent.indexOf("MSIE")>=0};function y(e,t,n){var r=g,o=null,a=null,i=function(n){r=f(r,n),e(r)},l=function(n){i({clientX:n.clientX,clientY:n.clientY,type:"move"});var e=t.current.onDragMoveSync;e==null||e(r)},s=function(n){o&&o(),i({clientX:n.clientX,clientY:n.clientY,type:"end"});var e=t.current.onDragEndSync;e==null||e(r)},u=function(){o&&o(),i({type:"cancel"});var e=t.current.onDragCancelSync;e==null||e(r)},c=function(o){var e=_(o,n.current);if(e!=null){i({clientX:e.clientX,clientY:e.clientY,type:"move"});var a=t.current.onDragMoveSync;a==null||a(r)}},d=function(o){var e=_(o,n.current);if(e!=null){a&&a(),i({clientX:e.clientX,clientY:e.clientY,type:"end"});var l=t.current.onDragEndSync;l==null||l(r)}},m=d;return{destroy:function(){o&&o(),a&&a()},onMouseDown:function(n){h()||n.preventDefault(),i({clientX:n.clientX,clientY:n.clientY,type:"start"});var e=t.current.onDragStartSync;e==null||e(r),o||(window.addEventListener("mousemove",l),window.addEventListener("mouseup",s),window.addEventListener("blur",u),window.addEventListener("mouseleave",u),o=function(){o=null,window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",s),window.removeEventListener("blur",u),window.removeEventListener("mouseleave",u)})},onTouchStart:function(o){o.preventDefault();var e=o.changedTouches[0];e!=null&&(n.current=e.identifier);var l=_(o,n.current);if(l!=null){i({clientX:l.clientX,clientY:l.clientY,type:"start"});var s=t.current.onDragStartSync;s==null||s(r),a||(window.addEventListener("touchmove",c),window.addEventListener("touchend",d),window.addEventListener("touchcancel",m),window.addEventListener("blur",u),a=function(){a=null,window.removeEventListener("touchmove",c),window.removeEventListener("touchend",d),window.removeEventListener("touchcancel",m),window.removeEventListener("blur",u)})}}}}function C(e,t){var n=o("react-compiler-runtime").c(4),r,a;n[0]!==t||n[1]!==e?(r=function(){var n=t.current,r=n.onDragCancel,o=n.onDragEnd,a=n.onDragMove,i=n.onDragStart;switch(e.lastEffect){case"start":{i(e);return}case"move":{a(e);return}case"end":{o(e);return}case"cancel":{r(e);return}}},a=[e,t],n[0]=t,n[1]=e,n[2]=r,n[3]=a):(r=n[2],a=n[3]),u(r,a)}function b(e,t,n){var a=o("react-compiler-runtime").c(13),i=d(g),l=i[0],s=i[1],c;a[0]!==e||a[1]!==t?(c=function(){return y(s,e,t)},a[0]=e,a[1]=t,a[2]=c):c=a[2];var m=r("useStable")(c),p=m.destroy,_=m.onMouseDown,f=m.onTouchStart,h,C;a[3]!==p?(h=function(){return p},C=[p],a[3]=p,a[4]=h,a[5]=C):(h=a[4],C=a[5]),u(h,C);var b;a[6]!==_||a[7]!==f||a[8]!==(n==null?void 0:n.hasTouchEvents)?(b={onClick:function(t){t.stopPropagation(),t.preventDefault()},onMouseDown:_,onTouchStart:(n==null?void 0:n.hasTouchEvents)===!0?f:void 0},a[6]=_,a[7]=f,a[8]=n==null?void 0:n.hasTouchEvents,a[9]=b):b=a[9];var v;return a[10]!==l||a[11]!==b?(v={dragState:l,rootProps:b},a[10]=l,a[11]=b,a[12]=v):v=a[12],v}function v(e,t){var n=o("react-compiler-runtime").c(7),r=c(e),a=c(null),i,l;n[0]!==e?(i=function(){r.current=e},l=[e],n[0]=e,n[1]=i,n[2]=l):(i=n[1],l=n[2]),u(i,l);var s=b(r,a,t),d=s.dragState,m=s.rootProps;C(d,r);var p=d.dragState==="dragging",_;return n[3]!==d||n[4]!==m||n[5]!==p?(_={dragState:d,isDragging:p,rootProps:m},n[3]=d,n[4]=m,n[5]=p,n[6]=_):_=n[6],_}l.usePointerDragResizeObserver=m,l.computePointerOffsetRatio=p,l.usePointerDrag=v}),98);
__d("VideoPlayerSliderNub.react",["react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){var t=o("react-compiler-runtime").c(4),n=e.isVisible,r;t[0]!==n?(r={0:{className:"x14hiurz x1g7gg9k x16h6fyj x1eoefnw x10eyzkn x1c9tyrk xeusxvb x1pahc9y x1ertn4p x13fuv20 x18b5jzi x1q0q8m5 x1t7ytsu xamhcws x1alpsbp xlxy82 xyumdvf x1nqv1ya x1s85apg xdk7pt x1x862rh x1rdy4ex x10l6tqk x3m8u43 x1xc55vz x1vjfegm"},1:{className:"x14hiurz x1g7gg9k x16h6fyj x1eoefnw x10eyzkn x1c9tyrk xeusxvb x1pahc9y x1ertn4p x13fuv20 x18b5jzi x1q0q8m5 x1t7ytsu xamhcws x1alpsbp xlxy82 xyumdvf x1nqv1ya xdk7pt x1x862rh x1rdy4ex x10l6tqk x3m8u43 x1xc55vz x1vjfegm x1lliihq"}}[!!n<<0],t[0]=n,t[1]=r):r=t[1];var a;return t[2]!==r?(a=s.jsx("div",babelHelpers.extends({},r,{"data-testid":void 0})),t[2]=r,t[3]=a):a=t[3],a}l.default=u}),98);
__d("VideoPlayerScrubberBaseContentDefault.react",["CometVisualCompletionAttributes","VideoPlayerSliderNub.react","react","react-compiler-runtime","stylex"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=s||(s=o("react")),c={liveRewindTimePlayed:{backgroundColor:"xh1tjdi",$$css:!0},liveTimePlayed:{backgroundColor:"x1ciooss",$$css:!0},timelineBackground:{backgroundColor:"x1rwy58d",borderStartStartRadius:"xr9e8f9",borderStartEndRadius:"x1e4oeot",borderEndEndRadius:"x1ui04y5",borderEndStartRadius:"x6en5u8",boxShadow:"xpdb0fs",height:"xuoj239",textShadow:"xd9u3wd",userSelect:"x87ps6o",$$css:!0},timelineBuffered:{height:"xuoj239",position:"x10l6tqk",$$css:!0},timelineBufferedBackground:{backgroundColor:"x17j41np",$$css:!0},timelinePlayed:{backgroundColor:"x1evw4sf",borderStartStartRadius:"xr9e8f9",borderStartEndRadius:"x1e4oeot",borderEndEndRadius:"x1ui04y5",borderEndStartRadius:"x6en5u8",height:"xuoj239",position:"x10l6tqk",userSelect:"x87ps6o",$$css:!0}};function d(t){var n=o("react-compiler-runtime").c(30),a=t.bufferedRatio,i=t.isLive,l=t.isLiveRewindActive,s=t.isNubVisible,d=t.playedRatio,m=t.timelineBackgroundXStyle,p=t.timelineBufferedXStyle,_=t.timelinePlayedXStyle,f;n[0]!==m?(f=(e||(e=r("stylex"))).props(c.timelineBackground,m),n[0]=m,n[1]=f):f=n[1];var g;n[2]!==i||n[3]!==p?(g=(e||(e=r("stylex")))(c.timelineBuffered,!i&&c.timelineBufferedBackground,p),n[2]=i,n[3]=p,n[4]=g):g=n[4];var h=100*a,y;n[5]!==h?(y=h.toFixed(5),n[5]=h,n[6]=y):y=n[6];var C=y+"%",b;n[7]!==C?(b={width:C},n[7]=C,n[8]=b):b=n[8];var v;n[9]!==g||n[10]!==b?(v=u.jsx("div",babelHelpers.extends({className:g},r("CometVisualCompletionAttributes").IGNORE,{style:b})),n[9]=g,n[10]=b,n[11]=v):v=n[11];var S;n[12]!==i||n[13]!==l||n[14]!==_?(S=(e||(e=r("stylex")))(c.timelinePlayed,i&&!l&&c.liveTimePlayed,i&&l&&c.liveRewindTimePlayed,_),n[12]=i,n[13]=l,n[14]=_,n[15]=S):S=n[15];var R=100*d,L;n[16]!==R?(L=R.toFixed(5),n[16]=R,n[17]=L):L=n[17];var E=L+"%",k;n[18]!==E?(k={width:E},n[18]=E,n[19]=k):k=n[19];var I;n[20]!==s?(I=u.jsx(r("VideoPlayerSliderNub.react"),{isVisible:s}),n[20]=s,n[21]=I):I=n[21];var T;n[22]!==k||n[23]!==I||n[24]!==S?(T=u.jsx("div",babelHelpers.extends({className:S},r("CometVisualCompletionAttributes").IGNORE,{style:k,children:I})),n[22]=k,n[23]=I,n[24]=S,n[25]=T):T=n[25];var D;return n[26]!==f||n[27]!==T||n[28]!==v?(D=u.jsxs("div",babelHelpers.extends({},f,{children:[v,T]})),n[26]=f,n[27]=T,n[28]=v,n[29]=D):D=n[29],D}l.default=d}),98);
__d("useVideoPlayerScrubberState",["VideoPlayerPointerDrag","react","react-compiler-runtime","usePrevious"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.useEffect,c=s.useState;function d(e,t){return Math.min(e>0?t/e:0,1)}function m(e){var t=o("react-compiler-runtime").c(41),n=e.bufferEnd,a=e.currentTime,i=e.duration,l=e.onScrubCancel,s=e.onScrubEnd,m=e.onScrubStart,p=e.supportsTouch,_=o("VideoPlayerPointerDrag").usePointerDragResizeObserver(),f=_.invalidateRootRect,g=_.rootRectRef,h=_.rootSizeRefCallback,y=c(0),C=y[0],b=y[1],v=c(!1),S=v[0],R=v[1],L=r("usePrevious")(a),E,k;t[0]!==a||t[1]!==L?(E=function(){a!==L&&R(!1)},k=[a,L],t[0]=a,t[1]=L,t[2]=E,t[3]=k):(E=t[2],k=t[3]),u(E,k);var I;t[4]!==l?(I=function(t){l()},t[4]=l,t[5]=I):I=t[5];var T;t[6]!==i||t[7]!==l||t[8]!==s||t[9]!==g?(T=function(t){var e=o("VideoPlayerPointerDrag").computePointerOffsetRatio(t,g.current);if(!e){l();return}b(e.ratioX);var n=e.ratioX*i;s(n)},t[6]=i,t[7]=l,t[8]=s,t[9]=g,t[10]=T):T=t[10];var D;t[11]===Symbol.for("react.memo_cache_sentinel")?(D=function(){R(!0)},t[11]=D):D=t[11];var x;t[12]!==g?(x=function(t){var e=o("VideoPlayerPointerDrag").computePointerOffsetRatio(t,g.current);e&&b(e.ratioX)},t[12]=g,t[13]=x):x=t[13];var $;t[14]!==f||t[15]!==m||t[16]!==g?($=function(t){f();var e=o("VideoPlayerPointerDrag").computePointerOffsetRatio(t,g.current);e&&(b(e.ratioX),m())},t[14]=f,t[15]=m,t[16]=g,t[17]=$):$=t[17];var P;t[18]!==I||t[19]!==T||t[20]!==x||t[21]!==$?(P={onDragCancel:I,onDragEnd:T,onDragEndSync:D,onDragMove:x,onDragStart:$},t[18]=I,t[19]=T,t[20]=x,t[21]=$,t[22]=P):P=t[22];var N=p===!0,M;t[23]!==N?(M={hasTouchEvents:N},t[23]=N,t[24]=M):M=t[24];var w=o("VideoPlayerPointerDrag").usePointerDrag(P,M),A=w.isDragging,F=w.rootProps,O;t[25]!==n||t[26]!==i?(O=d(i,n),t[25]=n,t[26]=i,t[27]=O):O=t[27];var B=O,W;t[28]!==a||t[29]!==i?(W=d(i,a),t[28]=a,t[29]=i,t[30]=W):W=t[30];var q=W,U;return t[31]!==B||t[32]!==q||t[33]!==f||t[34]!==A||t[35]!==S||t[36]!==C||t[37]!==F||t[38]!==g||t[39]!==h?(U={bufferedRatio:B,currentPlayedRatio:q,invalidateRootRect:f,isDragging:A,isWaitingForSeek:S,pointerOffsetRatio:C,rootProps:F,rootRectRef:g,rootSizeRefCallback:h},t[31]=B,t[32]=q,t[33]=f,t[34]=A,t[35]=S,t[36]=C,t[37]=F,t[38]=g,t[39]=h,t[40]=U):U=t[40],U}l.default=m}),98);
__d("VideoPlayerScrubberBase.react",["fbt","CometComponentWithKeyCommands.react","CometKeys","VideoPlayerScrubberBaseContentDefault.react","VideoPlayerUserInteractionCounter","react","react-compiler-runtime","useVideoPlayerScrubberState"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e,d=c.useCallback,m=c.useMemo,p=c.useState;function _(e){var t=o("react-compiler-runtime").c(86),n=e.bufferEnd,a=e.currentTime,i=e.disableKeyCommands,l=e.duration,c=e.hideNub,d=e.isLive,m=e.isLiveRewindActive,_=e.keyLeftDescription,f=e.keyRightDescription,g=e.onScrubCancel,h=e.onScrubEnd,y=e.onScrubStart,C=e.onUserInteraction,b=e.playFromBeginningImpl,v=e.renderScrubber,S=e.renderTooltip,R=e.skipBackwardImpl,L=e.skipForwardImpl,E=e.skipToEndImpl,k=e.supportsTouch,I=e.timelineBackgroundXStyle,T=e.timelineBufferedXStyle,D=e.timelinePlayedXStyle,x=e.withoutVerticalPadding,$=c===void 0?!1:c,P=x===void 0?!1:x,N=p(!1),M=N[0],w=N[1],A=p(0),F=A[0],O=A[1],B=p(null),W=B[0],q=B[1],U;t[0]!==n||t[1]!==a||t[2]!==l||t[3]!==g||t[4]!==h||t[5]!==y||t[6]!==k?(U={bufferEnd:n,currentTime:a,duration:l,onScrubCancel:g,onScrubEnd:h,onScrubStart:y,supportsTouch:k},t[0]=n,t[1]=a,t[2]=l,t[3]=g,t[4]=h,t[5]=y,t[6]=k,t[7]=U):U=t[7];var V=r("useVideoPlayerScrubberState")(U),H=V.bufferedRatio,G=V.currentPlayedRatio,z=V.invalidateRootRect,j=V.isDragging,K=V.isWaitingForSeek,Q=V.pointerOffsetRatio,X=V.rootProps,Y=V.rootRectRef,J=V.rootSizeRefCallback,Z;t[8]===Symbol.for("react.memo_cache_sentinel")?(Z=function(){w(!0)},t[8]=Z):Z=t[8];var ee=Z,te;t[9]===Symbol.for("react.memo_cache_sentinel")?(te=function(){w(!1)},t[9]=te):te=t[9];var ne=te,re;t[10]!==l||t[11]!==z||t[12]!==Y?(re=function(t){if(z(),Y.current!=null){var e=Y.current.left,n=Y.current.width,r=Math.max(0,Math.min(n,t.clientX-e)),o=n>0?r/n:0,a=Number.isFinite(l)&&l>0?l*o:null;O(t.clientX-e),q(a)}},t[10]=l,t[11]=z,t[12]=Y,t[13]=re):re=t[13];var oe=re,ae=M||j;o("VideoPlayerUserInteractionCounter").useVideoPlayerUserInteraction("video_scrubber",ae,C);var ie=M||j||K,le=j||K?Q:d&&!m?1:G,se;t[14]!==i||t[15]!==_||t[16]!==f||t[17]!==b||t[18]!==R||t[19]!==L||t[20]!==E?(se=i===!0?[]:[{command:{key:r("CometKeys").RIGHT},description:f,handler:L},{command:{key:r("CometKeys").LEFT},description:_,handler:R},{command:{key:r("CometKeys").HOME},description:s._(/*BTDS*/"Play from beginning"),handler:b},{command:{key:r("CometKeys").END},description:s._(/*BTDS*/"Skip to end"),handler:E}],t[14]=i,t[15]=_,t[16]=f,t[17]=b,t[18]=R,t[19]=L,t[20]=E,t[21]=se):se=t[21];var ue=se,ce=!$&&ie,de,me,pe,_e,fe,ge,he,ye,Ce,be,ve,Se,Re,Le,Ee,ke,Ie;if(t[22]!==H||t[23]!==ue||t[24]!==a||t[25]!==l||t[26]!==M||t[27]!==d||t[28]!==m||t[29]!==oe||t[30]!==le||t[31]!==v||t[32]!==X||t[33]!==J||t[34]!==ce||t[35]!==I||t[36]!==T||t[37]!==D||t[38]!==W||t[39]!==P){var Te={bufferedRatio:H,duration:l,hoveringPositionSec:W,isHovering:M,isLive:d,isLiveRewindActive:m,isNubVisible:ce,playedRatio:le,timelineBackgroundXStyle:I,timelineBufferedXStyle:T,timelinePlayedXStyle:D};de=r("CometComponentWithKeyCommands.react"),ke=ue,Ie=X,t[57]===Symbol.for("react.memo_cache_sentinel")?(me=s._(/*BTDS*/"Change Position"),t[57]=me):me=t[57],pe="horizontal",_e=l,fe=0,ge=a,t[58]!==P?(he={0:"x1ypdohk x1y1aw1k xyri2b xwib8y2 x1c1uobl x1n2onr6 x87ps6o xh8yej3",1:"x1ypdohk xyri2b x1c1uobl x1n2onr6 x87ps6o xh8yej3 x18d9i69 xexx8yu"}[!!P<<0],t[58]=P,t[59]=he):he=t[59],ye="video_player_scrubber",Ce=ee,be=ne,ve=oe,Se=J,Re="slider",Le=0,Ee=v!=null?v(Te):u.jsx(r("VideoPlayerScrubberBaseContentDefault.react"),babelHelpers.extends({},Te)),t[22]=H,t[23]=ue,t[24]=a,t[25]=l,t[26]=M,t[27]=d,t[28]=m,t[29]=oe,t[30]=le,t[31]=v,t[32]=X,t[33]=J,t[34]=ce,t[35]=I,t[36]=T,t[37]=D,t[38]=W,t[39]=P,t[40]=de,t[41]=me,t[42]=pe,t[43]=_e,t[44]=fe,t[45]=ge,t[46]=he,t[47]=ye,t[48]=Ce,t[49]=be,t[50]=ve,t[51]=Se,t[52]=Re,t[53]=Le,t[54]=Ee,t[55]=ke,t[56]=Ie}else de=t[40],me=t[41],pe=t[42],_e=t[43],fe=t[44],ge=t[45],he=t[46],ye=t[47],Ce=t[48],be=t[49],ve=t[50],Se=t[51],Re=t[52],Le=t[53],Ee=t[54],ke=t[55],Ie=t[56];var De;t[60]!==M||t[61]!==S||t[62]!==F||t[63]!==W?(De=S!=null&&W!=null&&M&&u.jsx("div",{className:"xfqi8uc x10l6tqk",style:{left:F},children:S(W)}),t[60]=M,t[61]=S,t[62]=F,t[63]=W,t[64]=De):De=t[64];var xe;t[65]!==me||t[66]!==pe||t[67]!==_e||t[68]!==fe||t[69]!==ge||t[70]!==he||t[71]!==ye||t[72]!==Ce||t[73]!==be||t[74]!==ve||t[75]!==Se||t[76]!==Re||t[77]!==Le||t[78]!==Ee||t[79]!==De||t[80]!==Ie?(xe=u.jsxs("div",babelHelpers.extends({},Ie,{"aria-label":me,"aria-orientation":pe,"aria-valuemax":_e,"aria-valuemin":fe,"aria-valuenow":ge,className:he,"data-testid":void 0,onMouseEnter:Ce,onMouseLeave:be,onMouseMove:ve,ref:Se,role:Re,tabIndex:Le,children:[Ee,De]})),t[65]=me,t[66]=pe,t[67]=_e,t[68]=fe,t[69]=ge,t[70]=he,t[71]=ye,t[72]=Ce,t[73]=be,t[74]=ve,t[75]=Se,t[76]=Re,t[77]=Le,t[78]=Ee,t[79]=De,t[80]=Ie,t[81]=xe):xe=t[81];var $e;return t[82]!==de||t[83]!==ke||t[84]!==xe?($e=u.jsx(de,{commandConfigs:ke,children:xe}),t[82]=de,t[83]=ke,t[84]=xe,t[85]=$e):$e=t[85],$e}l.default=_}),226);
__d("VideoPlayerScrubber.react",["fbt","VideoPlayerHooks","VideoPlayerScrubberBase.react","react","react-compiler-runtime","useLiveRewindUtils"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=e||(e=o("react")),d=e.useCallback;function m(){return(u||(u=o("VideoPlayerHooks"))).useCurrentTimeThrottled(200)}function p(e){var t=o("react-compiler-runtime").c(48),n=e.onUserInteraction,a=e.renderScrubber,i=e.renderTooltip,l=m(),d=(u||(u=o("VideoPlayerHooks"))).useDuration(),p=u.useController(),_=u.useBufferEnd(),f=u.useIsLive(),g=u.useIsLiveRewindActive(),h=o("useLiveRewindUtils").useLiveRewindScrub(),y=o("useLiveRewindUtils").useLiveRewindForward(),C=o("useLiveRewindUtils").useLiveRewindBack(),b=o("useLiveRewindUtils").useLiveRewindStart(),v=o("useLiveRewindUtils").useLiveRewindLive(),S=o("useLiveRewindUtils").useLiveRewindSeekableStartTime();f&&(d=d-S,l=l-S);var R;t[0]!==p||t[1]!==d||t[2]!==f||t[3]!==y?(R=function(){if(f)y();else{var e=p.getPlayheadPosition()+5;e>=d?p.seek(d-.01):p.seek(e)}},t[0]=p,t[1]=d,t[2]=f,t[3]=y,t[4]=R):R=t[4];var L=R,E;t[5]!==f?(E=f?s._(/*BTDS*/"Fast forward 10 seconds"):s._(/*BTDS*/"Fast forward 5 seconds"),t[5]=f,t[6]=E):E=t[6];var k=E,I;t[7]!==p||t[8]!==f||t[9]!==C?(I=function(){if(f)C();else{var e=p.getPlayheadPosition()-5;e<0?p.seek(0):p.seek(e)}},t[7]=p,t[8]=f,t[9]=C,t[10]=I):I=t[10];var T=I,D;t[11]!==f?(D=f?s._(/*BTDS*/"Rewind 10 seconds"):s._(/*BTDS*/"Rewind 5 seconds"),t[11]=f,t[12]=D):D=t[12];var x=D,$;t[13]!==p||t[14]!==f||t[15]!==b?($=function(){f?b():p.seek(0)},t[13]=p,t[14]=f,t[15]=b,t[16]=$):$=t[16];var P=$,N;t[17]!==p||t[18]!==d||t[19]!==f||t[20]!==v?(N=function(){f?v():p.seek(d-.01)},t[17]=p,t[18]=d,t[19]=f,t[20]=v,t[21]=N):N=t[21];var M=N,w;t[22]!==p?(w=function(){p.scrubEnd(null)},t[22]=p,t[23]=w):w=t[23];var A=w,F;t[24]!==p?(F=function(){p.scrubBegin()},t[24]=p,t[25]=F):F=t[25];var O=F,B;t[26]!==p||t[27]!==f||t[28]!==h?(B=function(t){f?h(t):p.scrubEnd(t)},t[26]=p,t[27]=f,t[28]=h,t[29]=B):B=t[29];var W=B,q;return t[30]!==_||t[31]!==l||t[32]!==d||t[33]!==f||t[34]!==g||t[35]!==M||t[36]!==x||t[37]!==k||t[38]!==n||t[39]!==P||t[40]!==a||t[41]!==i||t[42]!==A||t[43]!==W||t[44]!==O||t[45]!==T||t[46]!==L?(q=c.jsx(r("VideoPlayerScrubberBase.react"),{bufferEnd:_,currentTime:l,duration:d,isLive:f,isLiveRewindActive:g,keyLeftDescription:x,keyRightDescription:k,onScrubCancel:A,onScrubEnd:W,onScrubStart:O,onUserInteraction:n,playFromBeginningImpl:P,renderScrubber:a,renderTooltip:i,skipBackwardImpl:T,skipForwardImpl:L,skipToEndImpl:M}),t[30]=_,t[31]=l,t[32]=d,t[33]=f,t[34]=g,t[35]=M,t[36]=x,t[37]=k,t[38]=n,t[39]=P,t[40]=a,t[41]=i,t[42]=A,t[43]=W,t[44]=O,t[45]=T,t[46]=L,t[47]=q):q=t[47],q}l.default=p}),226);
__d("VideoPlayerScrubberBaseContentSegmented_renderer.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoPlayerScrubberBaseContentSegmented_renderer",selections:[{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"video",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoVideoChaptersConnection",kind:"LinkedField",name:"video_chapters",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoChapter",kind:"LinkedField",name:"nodes",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"start_time",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"XFBVideoPlayerScrubberBaseContentSegmentedRenderer",abstractKey:null};a.exports=e}),null);
__d("VideoPlayerScrubberBaseContentSegmented.react",["CometRelay","CometVisualCompletionAttributes","VideoPlayerScrubberBaseContentSegmented_renderer.graphql","VideoPlayerSliderNub.react","react","react-compiler-runtime","stylex"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=u||(u=o("react")),d=2,m={hoveredChapter:{height:"x1hagigm",marginTop:"xwt3t8n",$$css:!0},liveRewindTimePlayed:{backgroundColor:"xh1tjdi",$$css:!0},liveTimePlayed:{backgroundColor:"x1ciooss",$$css:!0},timelineBackground:{backgroundColor:"x1rwy58d",borderStartStartRadius:"xr9e8f9",borderStartEndRadius:"x1e4oeot",borderEndEndRadius:"x1ui04y5",borderEndStartRadius:"x6en5u8",boxShadow:"xpdb0fs",height:"xuoj239",marginTop:"xzx6vk8",position:"x10l6tqk",textShadow:"xd9u3wd",userSelect:"x87ps6o",$$css:!0},timelineBuffered:{borderStartStartRadius:"xr9e8f9",borderStartEndRadius:"x1e4oeot",borderEndEndRadius:"x1ui04y5",borderEndStartRadius:"x6en5u8",height:"x5yr21d",position:"x10l6tqk",$$css:!0},timelineBufferedBackground:{backgroundColor:"x17j41np",$$css:!0},timelinePlayed:{backgroundColor:"x1evw4sf",borderStartStartRadius:"xr9e8f9",borderStartEndRadius:"x1e4oeot",borderEndEndRadius:"x1ui04y5",borderEndStartRadius:"x6en5u8",height:"x5yr21d",position:"x10l6tqk",userSelect:"x87ps6o",$$css:!0}};function p(t){var a,i=o("react-compiler-runtime").c(33),l=t.renderer,u=t.videoChapters,p=t.bufferedRatio,f=t.duration,g=t.hoveringPositionSec,h=t.isHovering,y=t.isLive,C=t.isLiveRewindActive,b=t.isNubVisible,v=t.playedRatio,S=t.timelineBackgroundXStyle,R=t.timelineBufferedXStyle,L=t.timelinePlayedXStyle,E=o("CometRelay").useFragment(e!==void 0?e:e=n("VideoPlayerScrubberBaseContentSegmented_renderer.graphql"),l),k;if(i[0]!==(E==null||(a=E.video)==null||(a=a.video_chapters)==null?void 0:a.nodes)||i[1]!==u){var I,T,D,x;k=(I=(T=E==null||(D=E.video)==null||(D=D.video_chapters)==null?void 0:D.nodes)!=null?T:u)!=null?I:[],i[0]=E==null||(x=E.video)==null||(x=x.video_chapters)==null?void 0:x.nodes,i[1]=u,i[2]=k}else k=i[2];var $=k,P;if(i[3]!==p||i[4]!==$||i[5]!==f||i[6]!==g||i[7]!==h||i[8]!==y||i[9]!==C||i[10]!==b||i[11]!==v||i[12]!==S||i[13]!==R||i[14]!==L||i[15]!==u){var N;i[17]!==f?(N=function(t){var e=t.start_time;return{left:(e!=null?e:0)/(f*1e3),right:-1}},i[17]=f,i[18]=N):N=i[18];var M=$.map(N).sort(_);M[0].left!==0&&M.unshift({left:0,right:-1});for(var w=0;w<M.length-1;w++)M[w].right=M[w+1].left;M[M.length-1].right=1;var A=g!=null?g/f:-1,F;i[19]!==p||i[20]!==A||i[21]!==h||i[22]!==y||i[23]!==C||i[24]!==b||i[25]!==v||i[26]!==S||i[27]!==R||i[28]!==L||i[29]!==u?(F=function(t){var e=t.right-t.left,n=h&&t.left<A&&A<t.right;return c.jsxs("div",{className:(s||(s=r("stylex")))(m.timelineBackground,S,n&&m.hoveredChapter),style:{left:(100*t.left).toFixed(5)+"%",width:"calc("+(100*e).toFixed(5)+"% - "+d+"px)"},children:[p>t.left&&c.jsx("div",babelHelpers.extends({className:(s||(s=r("stylex")))(m.timelineBuffered,!y&&m.timelineBufferedBackground,R)},r("CometVisualCompletionAttributes").IGNORE,{style:{width:p>t.right?"100%":(100*(p-t.left)/e).toFixed(5)+"%"}})),(v>t.left||t.left===0)&&c.jsx("div",babelHelpers.extends({className:(s||(s=r("stylex")))(m.timelinePlayed,y&&!C&&m.liveTimePlayed,y&&C&&m.liveRewindTimePlayed,L)},r("CometVisualCompletionAttributes").IGNORE,{style:{width:v>t.right?"100%":(100*(v-t.left)/e).toFixed(5)+"%"},children:v<=t.right&&c.jsx("div",babelHelpers.extends({},{0:{},1:{className:"xr9ek0c"}}[!!n<<0],{children:c.jsx(r("VideoPlayerSliderNub.react"),{isVisible:b})}))}))]},u!=null?t.left.toString()+t.right.toString():t.left)},i[19]=p,i[20]=A,i[21]=h,i[22]=y,i[23]=C,i[24]=b,i[25]=v,i[26]=S,i[27]=R,i[28]=L,i[29]=u,i[30]=F):F=i[30],P=M.map(F),i[3]=p,i[4]=$,i[5]=f,i[6]=g,i[7]=h,i[8]=y,i[9]=C,i[10]=b,i[11]=v,i[12]=S,i[13]=R,i[14]=L,i[15]=u,i[16]=P}else P=i[16];var O;return i[31]!==P?(O=c.jsx(c.Fragment,{children:P}),i[31]=P,i[32]=O):O=i[32],O}function _(e,t){return e.left-t.left}l.default=p}),98);
__d("VideoPlayerScrubberChapterPreview_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoPlayerScrubberChapterPreview_video",selections:[{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"video",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoVideoChaptersConnection",kind:"LinkedField",name:"video_chapters",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoChapter",kind:"LinkedField",name:"nodes",plural:!0,selections:[{kind:"RequiredField",field:{alias:null,args:null,kind:"ScalarField",name:"headline",storageKey:null},action:"LOG",path:"video.video_chapters.nodes.headline"},{kind:"RequiredField",field:{alias:null,args:null,kind:"ScalarField",name:"start_time",storageKey:null},action:"LOG",path:"video.video_chapters.nodes.start_time"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"XFBVideoPlayerScrubberChapterPreviewRenderer",abstractKey:null};a.exports=e}),null);
__d("VideoPlayerScrubberChapterPreview.react",["CometRelay","DateConsts","FDSText.react","VideoPlayerScrubberChapterPreview_video.graphql","formatDurationSeconds","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=s||(s=o("react"));function c(e,t){if(e[0].start_time!==0&&t*o("DateConsts").MS_PER_SEC<e[0].start_time)return"";for(var n=1;n<e.length;n++)if(t*o("DateConsts").MS_PER_SEC<e[n].start_time)return e[n-1].headline;return e[e.length-1].headline}function d(t){var a,i,l=o("react-compiler-runtime").c(18),s=t.timestampSec,d=t.video,m=t.videoChapters,p=o("CometRelay").useFragment(e!==void 0?e:e=n("VideoPlayerScrubberChapterPreview_video.graphql"),d);if((p==null||(a=p.video)==null||(a=a.video_chapters)==null?void 0:a.nodes)==null&&m==null)return null;var _;if(l[0]!==m||l[1]!==(p==null||(i=p.video)==null||(i=i.video_chapters)==null?void 0:i.nodes)){var f,g,h,y;_=(f=(g=p==null||(h=p.video)==null||(h=h.video_chapters)==null?void 0:h.nodes.filter(Boolean))!=null?g:m)!=null?f:[],l[0]=m,l[1]=p==null||(y=p.video)==null||(y=y.video_chapters)==null?void 0:y.nodes,l[2]=_}else _=l[2];var C=_,b;l[3]!==C||l[4]!==s?(b=c(C,s),l[3]=C,l[4]=s,l[5]=b):b=l[5];var v=b,S,R;l[6]===Symbol.for("react.memo_cache_sentinel")?(S={className:"xjwep3j x1t39747 x1wcsgtt x1pczhz8 x78zum5 xl56j7k x1n2onr6 xdzyupr"},R={className:"xjwep3j x1t39747 x1wcsgtt x1pczhz8 x10l6tqk x2b8uid xijtgcl xuuh30 xh8yej3 xjnlgov"},l[6]=S,l[7]=R):(S=l[6],R=l[7]);var L;l[8]!==v?(L=u.jsx("div",babelHelpers.extends({},R,{children:u.jsx(r("FDSText.react"),{color:"primaryOnMedia",type:"body3",children:v})})),l[8]=v,l[9]=L):L=l[9];var E;l[10]===Symbol.for("react.memo_cache_sentinel")?(E={className:"xjwep3j x1t39747 x1wcsgtt x1pczhz8 x10l6tqk x2b8uid xijtgcl xuuh30 xh8yej3 x1ey2m1c"},l[10]=E):E=l[10];var k;l[11]!==s?(k=r("formatDurationSeconds")(Math.round(s)),l[11]=s,l[12]=k):k=l[12];var I;l[13]!==k?(I=u.jsx("div",babelHelpers.extends({},E,{children:u.jsx(r("FDSText.react"),{color:"primaryOnMedia",type:"body4",children:k})})),l[13]=k,l[14]=I):I=l[14];var T;return l[15]!==L||l[16]!==I?(T=u.jsxs("div",babelHelpers.extends({},S,{children:[L,I]})),l[15]=L,l[16]=I,l[17]=T):T=l[17],T}l.default=d}),98);
__d("VideoPlayerScrubberPreview_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoPlayerScrubberPreview_video",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"video_player_scrubber_preview_renderer",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,documentName:"VideoPlayerScrubberPreview_video",fragmentName:"VideoPlayerScrubberChapterPreview_video",fragmentPropName:"video",kind:"ModuleImport"}],type:"XFBVideoPlayerScrubberChapterPreviewRenderer",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"VideoPlayerScrubberPreview_video",fragmentName:"VideoPlayerScrubberDefaultPreview_video",fragmentPropName:"video",kind:"ModuleImport"}],type:"XFBVideoPlayerScrubberDefaultPreviewRenderer",abstractKey:null}],storageKey:null}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("VideoPlayerScrubberPreview.react",["CometRelay","VideoPlayerScrubberChapterPreview.react","VideoPlayerScrubberPreview_video.graphql","VideoPlayerTimeIndicator.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=s||(s=o("react"));function c(t){var a=o("react-compiler-runtime").c(11),i=t.timestampSec,l=t.video,s=t.videoChapters,c=o("CometRelay").useFragment(e!==void 0?e:e=n("VideoPlayerScrubberPreview_video.graphql"),l);if(c==null){if(s!=null){var d;return a[0]!==i||a[1]!==s?(d=u.jsx(r("VideoPlayerScrubberChapterPreview.react"),{timestampSec:i,video:null,videoChapters:s}),a[0]=i,a[1]=s,a[2]=d):d=a[2],d}var m;return a[3]!==i?(m=u.jsx(r("VideoPlayerTimeIndicator.react"),{shouldCenterSelf:!0,timestampSec:i}),a[3]=i,a[4]=m):m=a[4],m}var p=c==null?void 0:c.video_player_scrubber_preview_renderer,_;a[5]!==i||a[6]!==c?(_={timestampSec:i,video:c},a[5]=i,a[6]=c,a[7]=_):_=a[7];var f;return a[8]!==p||a[9]!==_?(f=u.jsx(o("CometRelay").MatchContainer,{match:p,props:_}),a[8]=p,a[9]=_,a[10]=f):f=a[10],f}l.default=c}),98);
__d("VideoPlayerScrubberRenderer_video.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoPlayerScrubberRenderer_video",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"video_player_scrubber_base_content_renderer",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,documentName:"VideoPlayerScrubberRenderer_video",fragmentName:"VideoPlayerScrubberBaseContentSegmented_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"XFBVideoPlayerScrubberBaseContentSegmentedRenderer",abstractKey:null}],storageKey:null}],type:"Video",abstractKey:null};a.exports=e}),null);
__d("VideoPlayerScrubberRenderer.react",["CometRelay","VideoPlayerScrubberBaseContentDefault.react","VideoPlayerScrubberBaseContentSegmented.react","VideoPlayerScrubberRenderer_video.graphql","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=s||(s=o("react"));function c(t){var a=o("react-compiler-runtime").c(11),i=t.scrubberProps,l=t.video,s=t.videoChapters,c=o("CometRelay").useFragment(e!==void 0?e:e=n("VideoPlayerScrubberRenderer_video.graphql"),l);if((c==null?void 0:c.video_player_scrubber_base_content_renderer)==null){if(s!=null){var d;return a[0]!==i||a[1]!==s?(d=u.jsx(r("VideoPlayerScrubberBaseContentSegmented.react"),babelHelpers.extends({},i,{videoChapters:s})),a[0]=i,a[1]=s,a[2]=d):d=a[2],d}var m;return a[3]!==i?(m=u.jsx(r("VideoPlayerScrubberBaseContentDefault.react"),babelHelpers.extends({},i)),a[3]=i,a[4]=m):m=a[4],m}var p=c==null?void 0:c.video_player_scrubber_base_content_renderer,_;a[5]!==i||a[6]!==s?(_=babelHelpers.extends({},i,{videoChapters:s}),a[5]=i,a[6]=s,a[7]=_):_=a[7];var f;return a[8]!==p||a[9]!==_?(f=u.jsx(o("CometRelay").MatchContainer,{match:p,props:_}),a[8]=p,a[9]=_,a[10]=f):f=a[10],f}l.default=c}),98);
__d("useVideoPlayerClickToPauseInteraction",["fbt","VideoPlayerHooks","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=(e||(e=o("react"))).useCallback;function d(){var e=o("react-compiler-runtime").c(5),t=(u||(u=o("VideoPlayerHooks"))).usePlaying(),n=u.useController(),r=u.useIsLive(),a;e[0]!==n?(a=function(){n.pause("user_initiated")},e[0]=n,e[1]=a):a=e[1];var i=a,l=t&&!r,c;return e[2]!==l||e[3]!==i?(c=l?{ariaLabel:s._(/*BTDS*/"Pause reel"),handler:i,overlayLabel:""}:null,e[2]=l,e[3]=i,e[4]=c):c=e[4],c}l.default=d}),226);
__d("useVideoPlayerClickToPlayInteraction",["fbt","VideoPlayerHooks","react","react-compiler-runtime","useFeedClickEventHandler"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=(e||(e=o("react"))).useCallback;function d(e){var t=o("react-compiler-runtime").c(9),n;t[0]!==e?(n=e===void 0?{}:e,t[0]=e,t[1]=n):n=t[1];var a=n,i=a.shouldUnmute,l=(u||(u=o("VideoPlayerHooks"))).usePaused(),c=u.useController(),d=u.useLastMuteReason(),m;t[2]!==c||t[3]!==d||t[4]!==i?(m=function(){c.play("user_initiated"),i===!0&&d!=="user_initiated"&&c.setMuted(!1,"product_initiated")},t[2]=c,t[3]=d,t[4]=i,t[5]=m):m=t[5];var p=m,_=r("useFeedClickEventHandler")(p),f=l,g;return t[6]!==f||t[7]!==_?(g=f?{ariaLabel:s._(/*BTDS*/"Play reel"),handler:_,overlayLabel:""}:null,t[6]=f,t[7]=_,t[8]=g):g=t[8],g}l.default=d}),226);
__d("useVideoPlayerVolumeControlAudioAvailabilityUI",["fbt","CometTooltipImpl.react","VideoPlayerControlsHiddenContext","clearTimeout","emptyFunction","react","setTimeout","useAudioAvailabilityAtPlayhead","usePrevious","useStable"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e,d=c.useContext,m=c.useEffect,p=c.useRef,_=c.useState,f=3e3;function g(e){var t=e.canPlayerProduceSound,n=e.isHovering,o=r("useAudioAvailabilityAtPlayhead")(),a=o.isSilentAtPlayhead,l=o.volumeControlState,c=null;switch(l){case"VOLUME_SILENT":c=s._(/*BTDS*/"Video has no sound");break;case"VOLUME_COPYRIGHT_FULL":c=s._(/*BTDS*/"Muted due to copyright claim");break;case"VOLUME_COPYRIGHT_PARTIAL_SILENCED":c=s._(/*BTDS*/"Partially muted due to copyright claim");break;case"VOLUME_COPYRIGHT_PARTIAL_NOT_SILENCED":break;case"VOLUME_DEFAULT":break;default:}var g=r("usePrevious")(a),h=_(!1),y=h[0],C=h[1],b=p(r("emptyFunction")),v=p(!1),S=_(!1),R=S[0],L=S[1],E=r("useStable")(function(){return function(e){v.current=e,L(e),b.current(e),e||C(!1)}}),k=d(r("VideoPlayerControlsHiddenContext"));m(function(){k||c==null?E(!1):(n||y||a!==g&&a&&t)&&E(!0)},[c,t,k,n,y,a,g,E]),m(function(){if(R){var e=r("setTimeout")(function(){E(!1)},f);return function(){r("clearTimeout")(e)}}},[R,E]);var I=r("useStable")(function(){return function(){C(function(e){return!e})}}),T=r("useStable")(function(){function e(e){var t=_(!1),n=t[0],o=t[1];return m(function(){return b.current=o,function(){b.current=r("emptyFunction")}},[o]),m(function(){e.isVisible||E(!1)},[e.isVisible]),u.jsx(r("CometTooltipImpl.react"),babelHelpers.extends({},e,{isVisible:n}))}return e.displayName=e.name+" [from "+i.id+"]",e}),D=l==="VOLUME_COPYRIGHT_FULL"||l==="VOLUME_SILENT",x=t?a:D;return c==null?null:{onVolumeControlPress:I,shouldDisableVolumeControl:D,shouldShowNullIcon:x,tooltipContent:c,tooltipImpl:T,volumeControlState:l}}l.default=g}),226);/*FB_PKG_DELIM*/
/**
 *
 * This file is generated from fbsource. Please do not modify it directly.
 *
 *
 * @nolint
 * @generated
 * @nopackage
 * @fullSyntaxTransform
 * @preserve-whitespace
 */__d("ls_voprf_utils_v2",["Promise"],(function $module_ls_voprf_utils_v2(global,require,requireDynamic,requireLazy,module,exports){var _require_closure_Promise;


var Module=function(){
var _scriptDir=typeof document!=='undefined'&&document.currentScript?document.currentScript.src:undefined;

return(
function(moduleArg){if(moduleArg===void 0){moduleArg={};}

var Module=moduleArg;var readyPromiseResolve,readyPromiseReject;Module["ready"]=new(_require_closure_Promise||(_require_closure_Promise=require("Promise")))(function(resolve,reject){readyPromiseResolve=resolve;readyPromiseReject=reject;});["_main","getExceptionMessage","___get_exception_message","_free","_memory","_curve_create","_curve_free","_curve_init_ristretto","_get_curve_element_bytes","_get_curve_scalar_bytes","_kdf_create","_kdf_free","_kdf_init_naor_reingold","_sodiumInit","_voprf_create","_voprf_free","_voprf_init_exp_twohashdh","_blind","_verifiable_unblind","_voprf_client_finalize","_voprf_setup","_voprf_evaluate","_voprf_server_finalize","_get_voprf_final_evaluation_bytes","___indirect_function_table","__embind_initialize_bindings","_fflush","___start_em_asm","___stop_em_asm","onRuntimeInitialized"].forEach(function(prop){if(!Object.getOwnPropertyDescriptor(Module["ready"],prop)){Object.defineProperty(Module["ready"],prop,{get:function get(){return abort("You are getting "+prop+" on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js");},set:function set(){return abort("You are setting "+prop+" on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js");}});}});var moduleOverrides=Object.assign({},Module);var arguments_=[];var thisProgram="./this.program";var quit_=function quit_(status,toThrow){throw toThrow;};var ENVIRONMENT_IS_WEB=true;var ENVIRONMENT_IS_WORKER=false;var ENVIRONMENT_IS_NODE=false;var ENVIRONMENT_IS_SHELL=false;if(Module["ENVIRONMENT"]){throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -sENVIRONMENT=web or -sENVIRONMENT=node)");}var scriptDirectory="";function locateFile(path){if(Module["locateFile"]){return Module["locateFile"](path,scriptDirectory);}return scriptDirectory+path;}var read_,readAsync,readBinary,setWindowTitle;if(typeof document!="undefined"&&document.currentScript){scriptDirectory=document.currentScript.src;}if(_scriptDir){scriptDirectory=_scriptDir;}if(scriptDirectory.indexOf("blob:")!==0){scriptDirectory=scriptDirectory.substr(0,scriptDirectory.replace(/[?#].*/,"").lastIndexOf("/")+1);}else{scriptDirectory="";}if(!(typeof window=="object"||typeof importScripts=="function"))throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");{read_=function read_(url){var xhr=new XMLHttpRequest();xhr.open("GET",url,false);xhr.send(null);return xhr.responseText;};readAsync=function readAsync(url,onload,onerror){var xhr=new XMLHttpRequest();xhr.open("GET",url,true);xhr.responseType="arraybuffer";xhr.onload=function(){if(xhr.status==200||xhr.status==0&&xhr.response){onload(xhr.response);return;}onerror();};xhr.onerror=onerror;xhr.send(null);};}setWindowTitle=function setWindowTitle(title){return document.title=title;};var out=Module["print"]||console.log.bind(console);var err=Module["printErr"]||console.error.bind(console);Object.assign(Module,moduleOverrides);moduleOverrides=null;checkIncomingModuleAPI();if(Module["arguments"])arguments_=Module["arguments"];legacyModuleProp("arguments","arguments_");if(Module["thisProgram"])thisProgram=Module["thisProgram"];legacyModuleProp("thisProgram","thisProgram");if(Module["quit"])quit_=Module["quit"];legacyModuleProp("quit","quit_");assert(typeof Module["memoryInitializerPrefixURL"]=="undefined","Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead");assert(typeof Module["pthreadMainPrefixURL"]=="undefined","Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead");assert(typeof Module["cdInitializerPrefixURL"]=="undefined","Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead");assert(typeof Module["filePackagePrefixURL"]=="undefined","Module.filePackagePrefixURL option was removed, use Module.locateFile instead");assert(typeof Module["read"]=="undefined","Module.read option was removed (modify read_ in JS)");assert(typeof Module["readAsync"]=="undefined","Module.readAsync option was removed (modify readAsync in JS)");assert(typeof Module["readBinary"]=="undefined","Module.readBinary option was removed (modify readBinary in JS)");assert(typeof Module["setWindowTitle"]=="undefined","Module.setWindowTitle option was removed (modify setWindowTitle in JS)");assert(typeof Module["TOTAL_MEMORY"]=="undefined","Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY");legacyModuleProp("asm","wasmExports");legacyModuleProp("read","read_");legacyModuleProp("readAsync","readAsync");legacyModuleProp("readBinary","readBinary");legacyModuleProp("setWindowTitle","setWindowTitle");assert(!ENVIRONMENT_IS_WORKER,"worker environment detected but not enabled at build time.  Add 'worker' to `-sENVIRONMENT` to enable.");assert(!ENVIRONMENT_IS_NODE,"node environment detected but not enabled at build time.  Add 'node' to `-sENVIRONMENT` to enable.");assert(!ENVIRONMENT_IS_SHELL,"shell environment detected but not enabled at build time.  Add 'shell' to `-sENVIRONMENT` to enable.");var wasmBinary;if(Module["wasmBinary"])wasmBinary=Module["wasmBinary"];legacyModuleProp("wasmBinary","wasmBinary");var noExitRuntime=Module["noExitRuntime"]||true;legacyModuleProp("noExitRuntime","noExitRuntime");if(typeof WebAssembly!="object"){abort("no native wasm support detected");}var wasmMemory;var wasmExports;var ABORT=false;var EXITSTATUS;function assert(condition,text){if(!condition){abort("Assertion failed"+(text?": "+text:""));}}var HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64;function updateMemoryViews(){var b=wasmMemory.buffer;Module["HEAP8"]=HEAP8=new Int8Array(b);Module["HEAP16"]=HEAP16=new Int16Array(b);Module["HEAP32"]=HEAP32=new Int32Array(b);Module["HEAPU8"]=HEAPU8=new Uint8Array(b);Module["HEAPU16"]=HEAPU16=new Uint16Array(b);Module["HEAPU32"]=HEAPU32=new Uint32Array(b);Module["HEAPF32"]=HEAPF32=new Float32Array(b);Module["HEAPF64"]=HEAPF64=new Float64Array(b);}assert(!Module["STACK_SIZE"],"STACK_SIZE can no longer be set at runtime.  Use -sSTACK_SIZE at link time");assert(typeof Int32Array!="undefined"&&typeof Float64Array!=="undefined"&&Int32Array.prototype.subarray!=undefined&&Int32Array.prototype.set!=undefined,"JS engine does not provide full typed array support");assert(!Module["wasmMemory"],"Use of `wasmMemory` detected.  Use -sIMPORTED_MEMORY to define wasmMemory externally");assert(!Module["INITIAL_MEMORY"],"Detected runtime INITIAL_MEMORY setting.  Use -sIMPORTED_MEMORY to define wasmMemory dynamically");var wasmTable;function writeStackCookie(){var max=_emscripten_stack_get_end2();assert((max&3)==0);if(max==0){max+=4;}HEAPU32[max>>2]=34821223;HEAPU32[max+4>>2]=2310721022;HEAPU32[0>>2]=1668509029;}function checkStackCookie(){if(ABORT)return;var max=_emscripten_stack_get_end2();if(max==0){max+=4;}var cookie1=HEAPU32[max>>2];var cookie2=HEAPU32[max+4>>2];if(cookie1!=34821223||cookie2!=2310721022){abort("Stack overflow! Stack cookie has been overwritten at "+ptrToString(max)+", expected hex dwords 0x89BACDFE and 0x2135467, but received "+ptrToString(cookie2)+" "+ptrToString(cookie1));}if(HEAPU32[0>>2]!=1668509029){abort("Runtime error: The application has corrupted its heap memory area (address zero)!");}}(function(){var h16=new Int16Array(1);var h8=new Int8Array(h16.buffer);h16[0]=25459;if(h8[0]!==115||h8[1]!==99)throw"Runtime error: expected the system to be little-endian! (Run with -sSUPPORT_BIG_ENDIAN to bypass)";})();var __ATPRERUN__=[];var __ATINIT__=[];var __ATPOSTRUN__=[];var runtimeInitialized=false;var runtimeKeepaliveCounter=0;function preRun(){if(Module["preRun"]){if(typeof Module["preRun"]=="function")Module["preRun"]=[Module["preRun"]];while(Module["preRun"].length){addOnPreRun(Module["preRun"].shift());}}callRuntimeCallbacks(__ATPRERUN__);}function initRuntime(){assert(!runtimeInitialized);runtimeInitialized=true;checkStackCookie();callRuntimeCallbacks(__ATINIT__);}function postRun(){checkStackCookie();if(Module["postRun"]){if(typeof Module["postRun"]=="function")Module["postRun"]=[Module["postRun"]];while(Module["postRun"].length){addOnPostRun(Module["postRun"].shift());}}callRuntimeCallbacks(__ATPOSTRUN__);}function addOnPreRun(cb){__ATPRERUN__.unshift(cb);}function addOnInit(cb){__ATINIT__.unshift(cb);}function addOnPostRun(cb){__ATPOSTRUN__.unshift(cb);}assert(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");assert(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");assert(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");assert(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");var runDependencies=0;var runDependencyWatcher=null;var dependenciesFulfilled=null;var runDependencyTracking={};function addRunDependency(id){runDependencies++;if(Module["monitorRunDependencies"]){Module["monitorRunDependencies"](runDependencies);}if(id){assert(!runDependencyTracking[id]);runDependencyTracking[id]=1;if(runDependencyWatcher===null&&typeof setInterval!="undefined"){runDependencyWatcher=setInterval(function(){if(ABORT){clearInterval(runDependencyWatcher);runDependencyWatcher=null;return;}var shown=false;for(var dep in runDependencyTracking){if(!shown){shown=true;err("still waiting on run dependencies:");}err("dependency: "+dep);}if(shown){err("(end of list)");}},1e4);}}else{err("warning: run dependency added without ID");}}function removeRunDependency(id){runDependencies--;if(Module["monitorRunDependencies"]){Module["monitorRunDependencies"](runDependencies);}if(id){assert(runDependencyTracking[id]);delete runDependencyTracking[id];}else{err("warning: run dependency removed without ID");}if(runDependencies==0){if(runDependencyWatcher!==null){clearInterval(runDependencyWatcher);runDependencyWatcher=null;}if(dependenciesFulfilled){var callback=dependenciesFulfilled;dependenciesFulfilled=null;callback();}}}function abort(what){if(Module["onAbort"]){Module["onAbort"](what);}what="Aborted("+what+")";err(what);ABORT=true;EXITSTATUS=1;var e=new WebAssembly.RuntimeError(what);readyPromiseReject(e);throw e;}var FS={error:function error(){abort("Filesystem support (FS) was not included. The problem is that you are using files from JS, but files were not used from C/C++, so filesystem support was not auto-included. You can force-include filesystem support with -sFORCE_FILESYSTEM");},init:function init(){FS.error();},createDataFile:function createDataFile(){FS.error();},createPreloadedFile:function createPreloadedFile(){FS.error();},createLazyFile:function createLazyFile(){FS.error();},open:function open(){FS.error();},mkdev:function mkdev(){FS.error();},registerDevice:function registerDevice(){FS.error();},analyzePath:function analyzePath(){FS.error();},ErrnoError:function ErrnoError(){FS.error();}};Module["FS_createDataFile"]=FS.createDataFile;Module["FS_createPreloadedFile"]=FS.createPreloadedFile;var dataURIPrefix="data:application/octet-stream;base64,";function isDataURI(filename){return filename.startsWith(dataURIPrefix);}function isFileURI(filename){return filename.startsWith("file://");}function createExportWrapper(name){return function(){assert(runtimeInitialized,"native function `"+name+"` called before runtime initialization");var f=wasmExports[name];assert(f,"exported native function `"+name+"` not found");return f.apply(null,arguments);};}var _EmscriptenEH3=function(_Error){"use strict";function EmscriptenEH(){return _Error.apply(this,arguments)||this;}babelHelpers.inheritsLoose(EmscriptenEH,_Error);return EmscriptenEH;}(babelHelpers.wrapNativeSuper(Error));var _EmscriptenSjLj=function(_EmscriptenEH){"use strict";function EmscriptenSjLj(){return _EmscriptenEH.apply(this,arguments)||this;}babelHelpers.inheritsLoose(EmscriptenSjLj,_EmscriptenEH);return EmscriptenSjLj;}(_EmscriptenEH3);var _CppException=function(_EmscriptenEH2){"use strict";function CppException(excPtr){var _this;_this=_EmscriptenEH2.call(this,excPtr)||this;_this.excPtr=excPtr;var excInfo=getExceptionMessage(excPtr);_this.name=excInfo[0];_this.message=excInfo[1];return _this;}babelHelpers.inheritsLoose(CppException,_EmscriptenEH2);return CppException;}(_EmscriptenEH3);var wasmBinaryFile;wasmBinaryFile="crypto_utils_v2.wasm";if(!isDataURI(wasmBinaryFile)){wasmBinaryFile=locateFile(wasmBinaryFile);}function getBinarySync(file){if(file==wasmBinaryFile&&wasmBinary){return new Uint8Array(wasmBinary);}if(readBinary){return readBinary(file);}throw"both async and sync fetching of the wasm failed";}function getBinaryPromise(binaryFile){if(!wasmBinary&&(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)){if(typeof fetch=="function"){return fetch(binaryFile,{credentials:"same-origin"}).then(function(response){if(!response["ok"]){throw"failed to load wasm binary file at '"+binaryFile+"'";}return response["arrayBuffer"]();})["catch"](function(){return getBinarySync(binaryFile);});}}return(_require_closure_Promise||(_require_closure_Promise=require("Promise"))).resolve().then(function(){return getBinarySync(binaryFile);});}function instantiateArrayBuffer(binaryFile,imports,receiver){return getBinaryPromise(binaryFile).then(function(binary){return WebAssembly.instantiate(binary,imports);}).then(function(instance){return instance;}).then(receiver,function(reason){err("failed to asynchronously prepare wasm: "+reason);if(isFileURI(wasmBinaryFile)){err("warning: Loading from a file URI ("+wasmBinaryFile+") is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing");}abort(reason);});}function instantiateAsync(binary,binaryFile,imports,callback){if(!binary&&typeof WebAssembly.instantiateStreaming=="function"&&!isDataURI(binaryFile)&&typeof fetch=="function"){return fetch(binaryFile,{credentials:"same-origin"}).then(function(response){var result=WebAssembly.instantiateStreaming(response,imports);return result.then(callback,function(reason){err("wasm streaming compile failed: "+reason);err("falling back to ArrayBuffer instantiation");return instantiateArrayBuffer(binaryFile,imports,callback);});});}return instantiateArrayBuffer(binaryFile,imports,callback);}function createWasm(){var info={"env":wasmImports,"wasi_snapshot_preview1":wasmImports};function receiveInstance(instance,module){var exports=instance.exports;wasmExports=exports;wasmMemory=wasmExports["memory"];Module["wasmMemory"]=wasmMemory;assert(wasmMemory,"memory not found in wasm exports");updateMemoryViews();wasmTable=wasmExports["__indirect_function_table"];assert(wasmTable,"table not found in wasm exports");addOnInit(wasmExports["__wasm_call_ctors"]);removeRunDependency("wasm-instantiate");return exports;}addRunDependency("wasm-instantiate");var trueModule=Module;function receiveInstantiationResult(result){assert(Module===trueModule,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?");trueModule=null;receiveInstance(result["instance"]);}if(Module["instantiateWasm"]){try{return Module["instantiateWasm"](info,receiveInstance);}catch(e){err("Module.instantiateWasm callback failed with error: "+e);readyPromiseReject(e);}}instantiateAsync(wasmBinary,wasmBinaryFile,info,receiveInstantiationResult)["catch"](readyPromiseReject);return{};}function legacyModuleProp(prop,newName,incomming){if(incomming===void 0){incomming=true;}if(!Object.getOwnPropertyDescriptor(Module,prop)){Object.defineProperty(Module,prop,{configurable:true,get:function get(){var extra=incomming?" (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)":"";abort("`Module."+prop+"` has been replaced by `"+newName+"`"+extra);}});}}function ignoredModuleProp(prop){if(Object.getOwnPropertyDescriptor(Module,prop)){abort("`Module."+prop+"` was supplied but `"+prop+"` not included in INCOMING_MODULE_JS_API");}}function isExportedByForceFilesystem(name){return name==="FS_createPath"||name==="FS_createDataFile"||name==="FS_createPreloadedFile"||name==="FS_unlink"||name==="addRunDependency"||name==="FS_createLazyFile"||name==="FS_createDevice"||name==="removeRunDependency";}function missingGlobal(sym,msg){if(typeof globalThis!=="undefined"){Object.defineProperty(globalThis,sym,{configurable:true,get:function get(){_warnOnce("`"+sym+"` is not longer defined by emscripten. "+msg);return undefined;}});}}missingGlobal("buffer","Please use HEAP8.buffer or wasmMemory.buffer");function missingLibrarySymbol(sym){if(typeof globalThis!=="undefined"&&!Object.getOwnPropertyDescriptor(globalThis,sym)){Object.defineProperty(globalThis,sym,{configurable:true,get:function get(){var msg="`"+sym+"` is a library symbol and not included by default; add it to your library.js __deps or to DEFAULT_LIBRARY_FUNCS_TO_INCLUDE on the command line";var librarySymbol=sym;if(!librarySymbol.startsWith("_")){librarySymbol="$"+sym;}msg+=" (e.g. -sDEFAULT_LIBRARY_FUNCS_TO_INCLUDE='"+librarySymbol+"')";if(isExportedByForceFilesystem(sym)){msg+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you";}_warnOnce(msg);return undefined;}});}unexportedRuntimeSymbol(sym);}function unexportedRuntimeSymbol(sym){if(!Object.getOwnPropertyDescriptor(Module,sym)){Object.defineProperty(Module,sym,{configurable:true,get:function get(){var msg="'"+sym+"' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the Emscripten FAQ)";if(isExportedByForceFilesystem(sym)){msg+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you";}abort(msg);}});}}var ASM_CONSTS={50356:function _(){return Module.getRandomValue();},50392:function _(){if(Module.getRandomValue===undefined){try{var window_="object"===typeof window?window:self;var crypto_=typeof window_.crypto!=="undefined"?window_.crypto:window_.msCrypto;var randomValuesStandard=function randomValuesStandard(){var buf=new Uint32Array(1);crypto_.getRandomValues(buf);return buf[0]>>>0;};randomValuesStandard();Module.getRandomValue=randomValuesStandard;}catch(e){{throw"No secure random number generator found";}}}}};function ExitStatus(status){this.name="ExitStatus";this.message="Program terminated with exit("+status+")";this.status=status;}var callRuntimeCallbacks=function callRuntimeCallbacks(callbacks){while(callbacks.length>0){callbacks.shift()(Module);}};var withStackSave=function withStackSave(f){var stack=stackSave();var ret=f();stackRestore(stack);return ret;};var UTF8Decoder=typeof TextDecoder!="undefined"?new TextDecoder("utf8"):undefined;var UTF8ArrayToString=function UTF8ArrayToString(heapOrArray,idx,maxBytesToRead){var endIdx=idx+maxBytesToRead;var endPtr=idx;while(heapOrArray[endPtr]&&!(endPtr>=endIdx))++endPtr;if(endPtr-idx>16&&heapOrArray.buffer&&UTF8Decoder){return UTF8Decoder.decode(heapOrArray.subarray(idx,endPtr));}var str="";while(idx<endPtr){var u0=heapOrArray[idx++];if(!(u0&128)){str+=String.fromCharCode(u0);continue;}var u1=heapOrArray[idx++]&63;if((u0&224)==192){str+=String.fromCharCode((u0&31)<<6|u1);continue;}var u2=heapOrArray[idx++]&63;if((u0&240)==224){u0=(u0&15)<<12|u1<<6|u2;}else{if((u0&248)!=240)_warnOnce("Invalid UTF-8 leading byte "+ptrToString(u0)+" encountered when deserializing a UTF-8 string in wasm memory to a JS string!");u0=(u0&7)<<18|u1<<12|u2<<6|heapOrArray[idx++]&63;}if(u0<65536){str+=String.fromCharCode(u0);}else{var ch=u0-65536;str+=String.fromCharCode(55296|ch>>10,56320|ch&1023);}}return str;};var UTF8ToString=function UTF8ToString(ptr,maxBytesToRead){assert(typeof ptr=="number");return ptr?UTF8ArrayToString(HEAPU8,ptr,maxBytesToRead):"";};var getExceptionMessageCommon=function getExceptionMessageCommon(ptr){return withStackSave(function(){var type_addr_addr=stackAlloc(4);var message_addr_addr=stackAlloc(4);___get_exception_message(ptr,type_addr_addr,message_addr_addr);var type_addr=HEAPU32[type_addr_addr>>2];var message_addr=HEAPU32[message_addr_addr>>2];var type=UTF8ToString(type_addr);_free(type_addr);var message;if(message_addr){message=UTF8ToString(message_addr);_free(message_addr);}return[type,message];});};function getExceptionMessage(ptr){return getExceptionMessageCommon(ptr);}Module["getExceptionMessage"]=getExceptionMessage;function getValue(ptr,type){if(type===void 0){type="i8";}if(type.endsWith("*"))type="*";switch(type){case"i1":return HEAP8[ptr>>0];case"i8":return HEAP8[ptr>>0];case"i16":return HEAP16[ptr>>1];case"i32":return HEAP32[ptr>>2];case"i64":abort("to do getValue(i64) use WASM_BIGINT");case"float":return HEAPF32[ptr>>2];case"double":return HEAPF64[ptr>>3];case"*":return HEAPU32[ptr>>2];default:abort("invalid type for getValue: "+type);}}var ptrToString=function ptrToString(ptr){assert(typeof ptr==="number");ptr>>>=0;return"0x"+ptr.toString(16).padStart(8,"0");};var _warnOnce=function warnOnce(text){if(!_warnOnce.shown)_warnOnce.shown={};if(!_warnOnce.shown[text]){_warnOnce.shown[text]=1;err(text);}};var ___assert_fail=function ___assert_fail(condition,filename,line,func){abort("Assertion failed: "+UTF8ToString(condition)+", at: "+[filename?UTF8ToString(filename):"unknown filename",line,func?UTF8ToString(func):"unknown function"]);};var exceptionCaught=[];var uncaughtExceptionCount=0;function ___cxa_begin_catch(ptr){var info=new ExceptionInfo(ptr);if(!info.get_caught()){info.set_caught(true);uncaughtExceptionCount--;}info.set_rethrown(false);exceptionCaught.push(info);___cxa_increment_exception_refcount(info.excPtr);return info.get_exception_ptr();}var exceptionLast=0;function ExceptionInfo(excPtr){this.excPtr=excPtr;this.ptr=excPtr-24;this.set_type=function(type){HEAPU32[this.ptr+4>>2]=type;};this.get_type=function(){return HEAPU32[this.ptr+4>>2];};this.set_destructor=function(destructor){HEAPU32[this.ptr+8>>2]=destructor;};this.get_destructor=function(){return HEAPU32[this.ptr+8>>2];};this.set_caught=function(caught){caught=caught?1:0;HEAP8[this.ptr+12>>0]=caught;};this.get_caught=function(){return HEAP8[this.ptr+12>>0]!=0;};this.set_rethrown=function(rethrown){rethrown=rethrown?1:0;HEAP8[this.ptr+13>>0]=rethrown;};this.get_rethrown=function(){return HEAP8[this.ptr+13>>0]!=0;};this.init=function(type,destructor){this.set_adjusted_ptr(0);this.set_type(type);this.set_destructor(destructor);};this.set_adjusted_ptr=function(adjustedPtr){HEAPU32[this.ptr+16>>2]=adjustedPtr;};this.get_adjusted_ptr=function(){return HEAPU32[this.ptr+16>>2];};this.get_exception_ptr=function(){var isPointer=___cxa_is_pointer_type(this.get_type());if(isPointer){return HEAPU32[this.excPtr>>2];}var adjusted=this.get_adjusted_ptr();if(adjusted!==0)return adjusted;return this.excPtr;};}function ___resumeException(ptr){if(!exceptionLast){exceptionLast=new _CppException(ptr);}throw exceptionLast;}var findMatchingCatch=function findMatchingCatch(args){var thrown=exceptionLast&&exceptionLast.excPtr;if(!thrown){setTempRet0(0);return 0;}var info=new ExceptionInfo(thrown);info.set_adjusted_ptr(thrown);var thrownType=info.get_type();if(!thrownType){setTempRet0(0);return thrown;}for(var arg in args){var caughtType=args[arg];if(caughtType===0||caughtType===thrownType){break;}var adjusted_ptr_addr=info.ptr+16;if(___cxa_can_catch(caughtType,thrownType,adjusted_ptr_addr)){setTempRet0(caughtType);return thrown;}}setTempRet0(thrownType);return thrown;};var ___cxa_find_matching_catch_2=function ___cxa_find_matching_catch_2(){return findMatchingCatch([]);};var ___cxa_find_matching_catch_3=function ___cxa_find_matching_catch_3(arg0){return findMatchingCatch([arg0]);};function __embind_register_bigint(primitiveType,name,size,minRange,maxRange){}function getShiftFromSize(size){switch(size){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+size);}}function embind_init_charCodes(){var codes=new Array(256);for(var i=0;i<256;++i){codes[i]=String.fromCharCode(i);}embind_charCodes=codes;}var embind_charCodes=undefined;function readLatin1String(ptr){var ret="";var c=ptr;while(HEAPU8[c]){ret+=embind_charCodes[HEAPU8[c++]];}return ret;}var awaitingDependencies={};var registeredTypes={};var typeDependencies={};var BindingError=undefined;function throwBindingError(message){throw new BindingError(message);}var InternalError=undefined;function throwInternalError(message){throw new InternalError(message);}function sharedRegisterType(rawType,registeredInstance,options){if(options===void 0){options={};}var name=registeredInstance.name;if(!rawType){throwBindingError("type \""+name+"\" must have a positive integer typeid pointer");}if(Object.prototype.hasOwnProperty.call(registeredTypes,rawType)){if(options.ignoreDuplicateRegistrations){return;}else{throwBindingError("Cannot register type '"+name+"' twice");}}registeredTypes[rawType]=registeredInstance;delete typeDependencies[rawType];if(Object.prototype.hasOwnProperty.call(awaitingDependencies,rawType)){var callbacks=awaitingDependencies[rawType];delete awaitingDependencies[rawType];callbacks.forEach(function(cb){return cb();});}}function registerType(rawType,registeredInstance,options){if(options===void 0){options={};}if(!("argPackAdvance"in registeredInstance)){throw new TypeError("registerType registeredInstance requires argPackAdvance");}return sharedRegisterType(rawType,registeredInstance,options);}function __embind_register_bool(rawType,name,size,trueValue,falseValue){var shift=getShiftFromSize(size);name=readLatin1String(name);registerType(rawType,{name:name,"fromWireType":function fromWireType(wt){return!!wt;},"toWireType":function toWireType(destructors,o){return o?trueValue:falseValue;},"argPackAdvance":8,"readValueFromPointer":function readValueFromPointer(pointer){var heap;if(size===1){heap=HEAP8;}else if(size===2){heap=HEAP16;}else if(size===4){heap=HEAP32;}else{throw new TypeError("Unknown boolean type size: "+name);}return this["fromWireType"](heap[pointer>>shift]);},destructorFunction:null});}function handleAllocatorInit(){Object.assign(HandleAllocator.prototype,{get:function get(id){assert(this.allocated[id]!==undefined,"invalid handle: "+id);return this.allocated[id];},has:function has(id){return this.allocated[id]!==undefined;},allocate:function allocate(handle){var id=this.freelist.pop()||this.allocated.length;this.allocated[id]=handle;return id;},free:function free(id){assert(this.allocated[id]!==undefined);this.allocated[id]=undefined;this.freelist.push(id);}});}function HandleAllocator(){this.allocated=[undefined];this.freelist=[];}var emval_handles=new HandleAllocator();function __emval_decref(handle){if(handle>=emval_handles.reserved&&0===--emval_handles.get(handle).refcount){emval_handles.free(handle);}}function count_emval_handles(){var count=0;for(var i=emval_handles.reserved;i<emval_handles.allocated.length;++i){if(emval_handles.allocated[i]!==undefined){++count;}}return count;}function init_emval(){emval_handles.allocated.push({value:undefined},{value:null},{value:true},{value:false});emval_handles.reserved=emval_handles.allocated.length;Module["count_emval_handles"]=count_emval_handles;}var Emval={toValue:function toValue(handle){if(!handle){throwBindingError("Cannot use deleted val. handle = "+handle);}return emval_handles.get(handle).value;},toHandle:function toHandle(value){switch(value){case undefined:return 1;case null:return 2;case true:return 3;case false:return 4;default:{return emval_handles.allocate({refcount:1,value:value});}}}};function simpleReadValueFromPointer(pointer){return this["fromWireType"](HEAP32[pointer>>2]);}function __embind_register_emval(rawType,name){name=readLatin1String(name);registerType(rawType,{name:name,"fromWireType":function fromWireType(handle){var rv=Emval.toValue(handle);__emval_decref(handle);return rv;},"toWireType":function toWireType(destructors,value){return Emval.toHandle(value);},"argPackAdvance":8,"readValueFromPointer":simpleReadValueFromPointer,destructorFunction:null});}function embindRepr(v){if(v===null){return"null";}var t=typeof v;if(t==="object"||t==="array"||t==="function"){return v.toString();}else{return""+v;}}function floatReadValueFromPointer(name,shift){switch(shift){case 2:return function(pointer){return this["fromWireType"](HEAPF32[pointer>>2]);};case 3:return function(pointer){return this["fromWireType"](HEAPF64[pointer>>3]);};default:throw new TypeError("Unknown float type: "+name);}}function __embind_register_float(rawType,name,size){var shift=getShiftFromSize(size);name=readLatin1String(name);registerType(rawType,{name:name,"fromWireType":function fromWireType(value){return value;},"toWireType":function toWireType(destructors,value){if(typeof value!="number"&&typeof value!="boolean"){throw new TypeError("Cannot convert "+embindRepr(value)+" to "+this.name);}return value;},"argPackAdvance":8,"readValueFromPointer":floatReadValueFromPointer(name,shift),destructorFunction:null});}function integerReadValueFromPointer(name,shift,signed){switch(shift){case 0:return signed?function readS8FromPointer(pointer){return HEAP8[pointer];}:function readU8FromPointer(pointer){return HEAPU8[pointer];};case 1:return signed?function readS16FromPointer(pointer){return HEAP16[pointer>>1];}:function readU16FromPointer(pointer){return HEAPU16[pointer>>1];};case 2:return signed?function readS32FromPointer(pointer){return HEAP32[pointer>>2];}:function readU32FromPointer(pointer){return HEAPU32[pointer>>2];};default:throw new TypeError("Unknown integer type: "+name);}}function __embind_register_integer(primitiveType,name,size,minRange,maxRange){name=readLatin1String(name);if(maxRange===-1){maxRange=4294967295;}var shift=getShiftFromSize(size);var fromWireType=function fromWireType(value){return value;};if(minRange===0){var bitshift=32-8*size;fromWireType=function fromWireType(value){return value<<bitshift>>>bitshift;};}var isUnsignedType=name.includes("unsigned");var checkAssertions=function checkAssertions(value,toTypeName){if(typeof value!="number"&&typeof value!="boolean"){throw new TypeError("Cannot convert \""+embindRepr(value)+"\" to "+toTypeName);}if(value<minRange||value>maxRange){throw new TypeError("Passing a number \""+embindRepr(value)+"\" from JS side to C/C++ side to an argument of type \""+name+"\", which is outside the valid range ["+minRange+", "+maxRange+"]!");}};var toWireType;if(isUnsignedType){toWireType=function toWireType(destructors,value){checkAssertions(value,this.name);return value>>>0;};}else{toWireType=function toWireType(destructors,value){checkAssertions(value,this.name);return value;};}registerType(primitiveType,{name:name,"fromWireType":fromWireType,"toWireType":toWireType,"argPackAdvance":8,"readValueFromPointer":integerReadValueFromPointer(name,shift,minRange!==0),destructorFunction:null});}function __embind_register_memory_view(rawType,dataTypeIndex,name){var typeMapping=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];var TA=typeMapping[dataTypeIndex];function decodeMemoryView(handle){handle=handle>>2;var heap=HEAPU32;var size=heap[handle];var data=heap[handle+1];return new TA(heap.buffer,data,size);}name=readLatin1String(name);registerType(rawType,{name:name,"fromWireType":decodeMemoryView,"argPackAdvance":8,"readValueFromPointer":decodeMemoryView},{ignoreDuplicateRegistrations:true});}var stringToUTF8Array=function stringToUTF8Array(str,heap,outIdx,maxBytesToWrite){assert(typeof str==="string");if(!(maxBytesToWrite>0))return 0;var startIdx=outIdx;var endIdx=outIdx+maxBytesToWrite-1;for(var i=0;i<str.length;++i){var u=str.charCodeAt(i);if(u>=55296&&u<=57343){var u1=str.charCodeAt(++i);u=65536+((u&1023)<<10)|u1&1023;}if(u<=127){if(outIdx>=endIdx)break;heap[outIdx++]=u;}else if(u<=2047){if(outIdx+1>=endIdx)break;heap[outIdx++]=192|u>>6;heap[outIdx++]=128|u&63;}else if(u<=65535){if(outIdx+2>=endIdx)break;heap[outIdx++]=224|u>>12;heap[outIdx++]=128|u>>6&63;heap[outIdx++]=128|u&63;}else{if(outIdx+3>=endIdx)break;if(u>1114111)_warnOnce("Invalid Unicode code point "+ptrToString(u)+" encountered when serializing a JS string to a UTF-8 string in wasm memory! (Valid unicode code points should be in range 0-0x10FFFF).");heap[outIdx++]=240|u>>18;heap[outIdx++]=128|u>>12&63;heap[outIdx++]=128|u>>6&63;heap[outIdx++]=128|u&63;}}heap[outIdx]=0;return outIdx-startIdx;};var stringToUTF8=function stringToUTF8(str,outPtr,maxBytesToWrite){assert(typeof maxBytesToWrite=="number","stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!");return stringToUTF8Array(str,HEAPU8,outPtr,maxBytesToWrite);};var lengthBytesUTF8=function lengthBytesUTF8(str){var len=0;for(var i=0;i<str.length;++i){var c=str.charCodeAt(i);if(c<=127){len++;}else if(c<=2047){len+=2;}else if(c>=55296&&c<=57343){len+=4;++i;}else{len+=3;}}return len;};function __embind_register_std_string(rawType,name){name=readLatin1String(name);var stdStringIsUTF8=name==="std::string";registerType(rawType,{name:name,"fromWireType":function fromWireType(value){var length=HEAPU32[value>>2];var payload=value+4;var str;if(stdStringIsUTF8){var decodeStartPtr=payload;for(var i=0;i<=length;++i){var currentBytePtr=payload+i;if(i==length||HEAPU8[currentBytePtr]==0){var maxRead=currentBytePtr-decodeStartPtr;var stringSegment=UTF8ToString(decodeStartPtr,maxRead);if(str===undefined){str=stringSegment;}else{str+=String.fromCharCode(0);str+=stringSegment;}decodeStartPtr=currentBytePtr+1;}}}else{var a=new Array(length);for(var i=0;i<length;++i){a[i]=String.fromCharCode(HEAPU8[payload+i]);}str=a.join("");}_free(value);return str;},"toWireType":function toWireType(destructors,value){if(value instanceof ArrayBuffer){value=new Uint8Array(value);}var length;var valueIsOfTypeString=typeof value=="string";if(!(valueIsOfTypeString||value instanceof Uint8Array||value instanceof Uint8ClampedArray||value instanceof Int8Array)){throwBindingError("Cannot pass non-string to std::string");}if(stdStringIsUTF8&&valueIsOfTypeString){length=lengthBytesUTF8(value);}else{length=value.length;}var base=_malloc(4+length+1);var ptr=base+4;HEAPU32[base>>2]=length;if(stdStringIsUTF8&&valueIsOfTypeString){stringToUTF8(value,ptr,length+1);}else{if(valueIsOfTypeString){for(var i=0;i<length;++i){var charCode=value.charCodeAt(i);if(charCode>255){_free(ptr);throwBindingError("String has UTF-16 code units that do not fit in 8 bits");}HEAPU8[ptr+i]=charCode;}}else{for(var i=0;i<length;++i){HEAPU8[ptr+i]=value[i];}}}if(destructors!==null){destructors.push(_free,base);}return base;},"argPackAdvance":8,"readValueFromPointer":simpleReadValueFromPointer,destructorFunction:function destructorFunction(ptr){_free(ptr);}});}var UTF16Decoder=typeof TextDecoder!="undefined"?new TextDecoder("utf-16le"):undefined;var UTF16ToString=function UTF16ToString(ptr,maxBytesToRead){assert(ptr%2==0,"Pointer passed to UTF16ToString must be aligned to two bytes!");var endPtr=ptr;var idx=endPtr>>1;var maxIdx=idx+maxBytesToRead/2;while(!(idx>=maxIdx)&&HEAPU16[idx])++idx;endPtr=idx<<1;if(endPtr-ptr>32&&UTF16Decoder)return UTF16Decoder.decode(HEAPU8.subarray(ptr,endPtr));var str="";for(var i=0;!(i>=maxBytesToRead/2);++i){var codeUnit=HEAP16[ptr+i*2>>1];if(codeUnit==0)break;str+=String.fromCharCode(codeUnit);}return str;};var stringToUTF16=function stringToUTF16(str,outPtr,maxBytesToWrite){assert(outPtr%2==0,"Pointer passed to stringToUTF16 must be aligned to two bytes!");assert(typeof maxBytesToWrite=="number","stringToUTF16(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!");if(maxBytesToWrite===undefined){maxBytesToWrite=2147483647;}if(maxBytesToWrite<2)return 0;maxBytesToWrite-=2;var startPtr=outPtr;var numCharsToWrite=maxBytesToWrite<str.length*2?maxBytesToWrite/2:str.length;for(var i=0;i<numCharsToWrite;++i){var codeUnit=str.charCodeAt(i);HEAP16[outPtr>>1]=codeUnit;outPtr+=2;}HEAP16[outPtr>>1]=0;return outPtr-startPtr;};var lengthBytesUTF16=function lengthBytesUTF16(str){return str.length*2;};var UTF32ToString=function UTF32ToString(ptr,maxBytesToRead){assert(ptr%4==0,"Pointer passed to UTF32ToString must be aligned to four bytes!");var i=0;var str="";while(!(i>=maxBytesToRead/4)){var utf32=HEAP32[ptr+i*4>>2];if(utf32==0)break;++i;if(utf32>=65536){var ch=utf32-65536;str+=String.fromCharCode(55296|ch>>10,56320|ch&1023);}else{str+=String.fromCharCode(utf32);}}return str;};var stringToUTF32=function stringToUTF32(str,outPtr,maxBytesToWrite){assert(outPtr%4==0,"Pointer passed to stringToUTF32 must be aligned to four bytes!");assert(typeof maxBytesToWrite=="number","stringToUTF32(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!");if(maxBytesToWrite===undefined){maxBytesToWrite=2147483647;}if(maxBytesToWrite<4)return 0;var startPtr=outPtr;var endPtr=startPtr+maxBytesToWrite-4;for(var i=0;i<str.length;++i){var codeUnit=str.charCodeAt(i);if(codeUnit>=55296&&codeUnit<=57343){var trailSurrogate=str.charCodeAt(++i);codeUnit=65536+((codeUnit&1023)<<10)|trailSurrogate&1023;}HEAP32[outPtr>>2]=codeUnit;outPtr+=4;if(outPtr+4>endPtr)break;}HEAP32[outPtr>>2]=0;return outPtr-startPtr;};var lengthBytesUTF32=function lengthBytesUTF32(str){var len=0;for(var i=0;i<str.length;++i){var codeUnit=str.charCodeAt(i);if(codeUnit>=55296&&codeUnit<=57343)++i;len+=4;}return len;};var __embind_register_std_wstring=function __embind_register_std_wstring(rawType,charSize,name){name=readLatin1String(name);var decodeString,encodeString,getHeap,lengthBytesUTF,shift;if(charSize===2){decodeString=UTF16ToString;encodeString=stringToUTF16;lengthBytesUTF=lengthBytesUTF16;getHeap=function getHeap(){return HEAPU16;};shift=1;}else if(charSize===4){decodeString=UTF32ToString;encodeString=stringToUTF32;lengthBytesUTF=lengthBytesUTF32;getHeap=function getHeap(){return HEAPU32;};shift=2;}registerType(rawType,{name:name,"fromWireType":function fromWireType(value){var length=HEAPU32[value>>2];var HEAP=getHeap();var str;var decodeStartPtr=value+4;for(var i=0;i<=length;++i){var currentBytePtr=value+4+i*charSize;if(i==length||HEAP[currentBytePtr>>shift]==0){var maxReadBytes=currentBytePtr-decodeStartPtr;var stringSegment=decodeString(decodeStartPtr,maxReadBytes);if(str===undefined){str=stringSegment;}else{str+=String.fromCharCode(0);str+=stringSegment;}decodeStartPtr=currentBytePtr+charSize;}}_free(value);return str;},"toWireType":function toWireType(destructors,value){if(!(typeof value=="string")){throwBindingError("Cannot pass non-string to C++ string type "+name);}var length=lengthBytesUTF(value);var ptr=_malloc(4+length+charSize);HEAPU32[ptr>>2]=length>>shift;encodeString(value,ptr+4,length+charSize);if(destructors!==null){destructors.push(_free,ptr);}return ptr;},"argPackAdvance":8,"readValueFromPointer":simpleReadValueFromPointer,destructorFunction:function destructorFunction(ptr){_free(ptr);}});};function __embind_register_void(rawType,name){name=readLatin1String(name);registerType(rawType,{isVoid:true,name:name,"argPackAdvance":0,"fromWireType":function fromWireType(){return undefined;},"toWireType":function toWireType(destructors,o){return undefined;}});}var _abort=function _abort(){abort("native code called abort()");};var readEmAsmArgsArray=[];var readEmAsmArgs=function readEmAsmArgs(sigPtr,buf){assert(Array.isArray(readEmAsmArgsArray));assert(buf%16==0);readEmAsmArgsArray.length=0;var ch;buf>>=2;while(ch=HEAPU8[sigPtr++]){var chr=String.fromCharCode(ch);var validChars=["d","f","i"];assert(validChars.includes(chr),"Invalid character "+ch+"(\""+chr+"\") in readEmAsmArgs! Use only ["+validChars+"], and do not specify \"v\" for void return argument.");buf+=ch!=105&buf;readEmAsmArgsArray.push(ch==105?HEAP32[buf]:HEAPF64[buf++>>1]);++buf;}return readEmAsmArgsArray;};var runEmAsmFunction=function runEmAsmFunction(code,sigPtr,argbuf){var args=readEmAsmArgs(sigPtr,argbuf);if(!Object.prototype.hasOwnProperty.call(ASM_CONSTS,code))abort("No EM_ASM constant found at address "+code);return ASM_CONSTS[code].apply(null,args);};var _emscripten_asm_const_int=function _emscripten_asm_const_int(code,sigPtr,argbuf){return runEmAsmFunction(code,sigPtr,argbuf);};var getHeapMax=function getHeapMax(){return 1048576;};var _emscripten_get_heap_max=function _emscripten_get_heap_max(){return getHeapMax();};var growMemory=function growMemory(size){var b=wasmMemory.buffer;var pages=size-b.byteLength+65535>>>16;try{wasmMemory.grow(pages);updateMemoryViews();return 1;}catch(e){err("growMemory: Attempted to grow heap from "+b.byteLength+" bytes to "+size+" bytes, but got error: "+e);}};var _emscripten_resize_heap=function _emscripten_resize_heap(requestedSize){var oldSize=HEAPU8.length;requestedSize>>>=0;assert(requestedSize>oldSize);var maxHeapSize=getHeapMax();if(requestedSize>maxHeapSize){err("Cannot enlarge memory, asked to go up to "+requestedSize+" bytes, but the limit is "+maxHeapSize+" bytes!");return false;}var alignUp=function alignUp(x,multiple){return x+(multiple-x%multiple)%multiple;};for(var cutDown=1;cutDown<=4;cutDown*=2){var overGrownHeapSize=oldSize*(1+.2/cutDown);overGrownHeapSize=Math.min(overGrownHeapSize,requestedSize+100663296);var newSize=Math.min(maxHeapSize,alignUp(Math.max(requestedSize,overGrownHeapSize),65536));var replacement=growMemory(newSize);if(replacement){return true;}}err("Failed to grow the heap from "+oldSize+" bytes to "+newSize+" bytes, not enough memory!");return false;};var SYSCALLS={varargs:undefined,get:function get(){assert(SYSCALLS.varargs!=undefined);SYSCALLS.varargs+=4;var ret=HEAP32[SYSCALLS.varargs-4>>2];return ret;},getStr:function getStr(ptr){var ret=UTF8ToString(ptr);return ret;}};var _fd_close=function _fd_close(fd){abort("fd_close called without SYSCALLS_REQUIRE_FILESYSTEM");};function convertI32PairToI53Checked(lo,hi){assert(lo==lo>>>0||lo==(lo|0));assert(hi===(hi|0));return hi+2097152>>>0<4194305-!!lo?(lo>>>0)+hi*4294967296:NaN;}function _fd_seek(fd,offset_low,offset_high,whence,newOffset){var offset=convertI32PairToI53Checked(offset_low,offset_high);return 70;}var printCharBuffers=[null,[],[]];var printChar=function printChar(stream,curr){var buffer=printCharBuffers[stream];assert(buffer);if(curr===0||curr===10){(stream===1?out:err)(UTF8ArrayToString(buffer,0));buffer.length=0;}else{buffer.push(curr);}};var flush_NO_FILESYSTEM=function flush_NO_FILESYSTEM(){_fflush(0);if(printCharBuffers[1].length)printChar(1,10);if(printCharBuffers[2].length)printChar(2,10);};var _fd_write=function _fd_write(fd,iov,iovcnt,pnum){var num=0;for(var i=0;i<iovcnt;i++){var ptr=HEAPU32[iov>>2];var len=HEAPU32[iov+4>>2];iov+=8;for(var j=0;j<len;j++){printChar(fd,HEAPU8[ptr+j]);}num+=len;}HEAPU32[pnum>>2]=num;return 0;};var getWasmTableEntry=function getWasmTableEntry(funcPtr){return wasmTable.get(funcPtr);};var writeArrayToMemory=function writeArrayToMemory(array,buffer){assert(array.length>=0,"writeArrayToMemory array must have a length (should be an array or typed array)");HEAP8.set(array,buffer);};embind_init_charCodes();BindingError=Module["BindingError"]=function(_Error2){"use strict";function BindingError(message){var _this2;_this2=_Error2.call(this,message)||this;_this2.name="BindingError";return _this2;}babelHelpers.inheritsLoose(BindingError,_Error2);return BindingError;}(babelHelpers.wrapNativeSuper(Error));InternalError=Module["InternalError"]=function(_Error3){"use strict";function InternalError(message){var _this3;_this3=_Error3.call(this,message)||this;_this3.name="InternalError";return _this3;}babelHelpers.inheritsLoose(InternalError,_Error3);return InternalError;}(babelHelpers.wrapNativeSuper(Error));handleAllocatorInit();init_emval();function checkIncomingModuleAPI(){ignoredModuleProp("fetchSettings");}var wasmImports={__assert_fail:___assert_fail,__cxa_begin_catch:___cxa_begin_catch,__cxa_find_matching_catch_2:___cxa_find_matching_catch_2,__cxa_find_matching_catch_3:___cxa_find_matching_catch_3,__resumeException:___resumeException,_embind_register_bigint:__embind_register_bigint,_embind_register_bool:__embind_register_bool,_embind_register_emval:__embind_register_emval,_embind_register_float:__embind_register_float,_embind_register_integer:__embind_register_integer,_embind_register_memory_view:__embind_register_memory_view,_embind_register_std_string:__embind_register_std_string,_embind_register_std_wstring:__embind_register_std_wstring,_embind_register_void:__embind_register_void,abort:_abort,emscripten_asm_const_int:_emscripten_asm_const_int,emscripten_get_heap_max:_emscripten_get_heap_max,emscripten_resize_heap:_emscripten_resize_heap,fd_close:_fd_close,fd_seek:_fd_seek,fd_write:_fd_write,invoke_ii:invoke_ii,invoke_iii:invoke_iii,invoke_iiii:invoke_iiii,invoke_v:invoke_v,invoke_vi:invoke_vi,invoke_vii:invoke_vii,invoke_viii:invoke_viii,invoke_viiii:invoke_viiii};var asm=createWasm();var ___wasm_call_ctors=createExportWrapper("__wasm_call_ctors");var _curve_create=Module["_curve_create"]=createExportWrapper("curve_create");var _malloc=Module["_malloc"]=createExportWrapper("malloc");var _curve_free=Module["_curve_free"]=createExportWrapper("curve_free");var _free=Module["_free"]=createExportWrapper("free");var _curve_init_ristretto=Module["_curve_init_ristretto"]=createExportWrapper("curve_init_ristretto");var _get_curve_element_bytes=Module["_get_curve_element_bytes"]=createExportWrapper("get_curve_element_bytes");var _get_curve_scalar_bytes=Module["_get_curve_scalar_bytes"]=createExportWrapper("get_curve_scalar_bytes");var _kdf_create=Module["_kdf_create"]=createExportWrapper("kdf_create");var _kdf_free=Module["_kdf_free"]=createExportWrapper("kdf_free");var _kdf_init_naor_reingold=Module["_kdf_init_naor_reingold"]=createExportWrapper("kdf_init_naor_reingold");var _sodiumInit=Module["_sodiumInit"]=createExportWrapper("sodiumInit");var _voprf_create=Module["_voprf_create"]=createExportWrapper("voprf_create");var _voprf_free=Module["_voprf_free"]=createExportWrapper("voprf_free");var _voprf_init_exp_twohashdh=Module["_voprf_init_exp_twohashdh"]=createExportWrapper("voprf_init_exp_twohashdh");var _blind=Module["_blind"]=createExportWrapper("blind");var _verifiable_unblind=Module["_verifiable_unblind"]=createExportWrapper("verifiable_unblind");var _voprf_client_finalize=Module["_voprf_client_finalize"]=createExportWrapper("voprf_client_finalize");var _voprf_setup=Module["_voprf_setup"]=createExportWrapper("voprf_setup");var _voprf_evaluate=Module["_voprf_evaluate"]=createExportWrapper("voprf_evaluate");var _voprf_server_finalize=Module["_voprf_server_finalize"]=createExportWrapper("voprf_server_finalize");var _get_voprf_final_evaluation_bytes=Module["_get_voprf_final_evaluation_bytes"]=createExportWrapper("get_voprf_final_evaluation_bytes");var ___errno_location=createExportWrapper("__errno_location");var ___getTypeName=createExportWrapper("__getTypeName");var __embind_initialize_bindings=Module["__embind_initialize_bindings"]=createExportWrapper("_embind_initialize_bindings");var _fflush=Module["_fflush"]=createExportWrapper("fflush");var _emscripten_builtin_memalign=createExportWrapper("emscripten_builtin_memalign");var _setThrew=createExportWrapper("setThrew");var setTempRet0=createExportWrapper("setTempRet0");var _emscripten_stack_init2=function _emscripten_stack_init(){return(_emscripten_stack_init2=wasmExports["emscripten_stack_init"])();};var _emscripten_stack_get_free2=function _emscripten_stack_get_free(){return(_emscripten_stack_get_free2=wasmExports["emscripten_stack_get_free"])();};var _emscripten_stack_get_base2=function _emscripten_stack_get_base(){return(_emscripten_stack_get_base2=wasmExports["emscripten_stack_get_base"])();};var _emscripten_stack_get_end2=function _emscripten_stack_get_end(){return(_emscripten_stack_get_end2=wasmExports["emscripten_stack_get_end"])();};var stackSave=createExportWrapper("stackSave");var stackRestore=createExportWrapper("stackRestore");var stackAlloc=createExportWrapper("stackAlloc");var _emscripten_stack_get_current2=function _emscripten_stack_get_current(){return(_emscripten_stack_get_current2=wasmExports["emscripten_stack_get_current"])();};var ___cxa_free_exception=createExportWrapper("__cxa_free_exception");var ___cxa_increment_exception_refcount=createExportWrapper("__cxa_increment_exception_refcount");var ___cxa_decrement_exception_refcount=createExportWrapper("__cxa_decrement_exception_refcount");var ___get_exception_message=Module["___get_exception_message"]=createExportWrapper("__get_exception_message");var ___cxa_can_catch=createExportWrapper("__cxa_can_catch");var ___cxa_is_pointer_type=createExportWrapper("__cxa_is_pointer_type");var dynCall_iiiji=Module["dynCall_iiiji"]=createExportWrapper("dynCall_iiiji");var dynCall_iiij=Module["dynCall_iiij"]=createExportWrapper("dynCall_iiij");var dynCall_iijii=Module["dynCall_iijii"]=createExportWrapper("dynCall_iijii");var dynCall_iiijiji=Module["dynCall_iiijiji"]=createExportWrapper("dynCall_iiijiji");var dynCall_iiijiii=Module["dynCall_iiijiii"]=createExportWrapper("dynCall_iiijiii");var dynCall_jiji=Module["dynCall_jiji"]=createExportWrapper("dynCall_jiji");function invoke_v(index){var sp=stackSave();try{getWasmTableEntry(index)();}catch(e){stackRestore(sp);if(!(e instanceof _EmscriptenEH3))throw e;_setThrew(1,0);}}function invoke_vii(index,a1,a2){var sp=stackSave();try{getWasmTableEntry(index)(a1,a2);}catch(e){stackRestore(sp);if(!(e instanceof _EmscriptenEH3))throw e;_setThrew(1,0);}}function invoke_viiii(index,a1,a2,a3,a4){var sp=stackSave();try{getWasmTableEntry(index)(a1,a2,a3,a4);}catch(e){stackRestore(sp);if(!(e instanceof _EmscriptenEH3))throw e;_setThrew(1,0);}}function invoke_ii(index,a1){var sp=stackSave();try{return getWasmTableEntry(index)(a1);}catch(e){stackRestore(sp);if(!(e instanceof _EmscriptenEH3))throw e;_setThrew(1,0);}}function invoke_iii(index,a1,a2){var sp=stackSave();try{return getWasmTableEntry(index)(a1,a2);}catch(e){stackRestore(sp);if(!(e instanceof _EmscriptenEH3))throw e;_setThrew(1,0);}}function invoke_viii(index,a1,a2,a3){var sp=stackSave();try{getWasmTableEntry(index)(a1,a2,a3);}catch(e){stackRestore(sp);if(!(e instanceof _EmscriptenEH3))throw e;_setThrew(1,0);}}function invoke_vi(index,a1){var sp=stackSave();try{getWasmTableEntry(index)(a1);}catch(e){stackRestore(sp);if(!(e instanceof _EmscriptenEH3))throw e;_setThrew(1,0);}}function invoke_iiii(index,a1,a2,a3){var sp=stackSave();try{return getWasmTableEntry(index)(a1,a2,a3);}catch(e){stackRestore(sp);if(!(e instanceof _EmscriptenEH3))throw e;_setThrew(1,0);}}Module["wasmMemory"]=wasmMemory;Module["getValue"]=getValue;Module["stringToUTF8"]=stringToUTF8;Module["lengthBytesUTF8"]=lengthBytesUTF8;Module["writeArrayToMemory"]=writeArrayToMemory;var missingLibrarySymbols=["writeI53ToI64","writeI53ToI64Clamped","writeI53ToI64Signaling","writeI53ToU64Clamped","writeI53ToU64Signaling","readI53FromI64","readI53FromU64","convertI32PairToI53","convertU32PairToI53","zeroMemory","exitJS","isLeapYear","ydayFromDate","arraySum","addDays","setErrNo","inetPton4","inetNtop4","inetPton6","inetNtop6","readSockaddr","writeSockaddr","getHostByName","initRandomFill","randomFill","getCallstack","emscriptenLog","convertPCtoSourceLocation","runMainThreadEmAsm","jstoi_q","jstoi_s","getExecutableName","listenOnce","autoResumeAudioContext","dynCallLegacy","getDynCaller","dynCall","setWasmTableEntry","handleException","runtimeKeepalivePush","runtimeKeepalivePop","callUserCallback","maybeExit","safeSetTimeout","asmjsMangle","asyncLoad","alignMemory","mmapAlloc","getNativeTypeSize","STACK_SIZE","STACK_ALIGN","POINTER_SIZE","ASSERTIONS","getCFunc","ccall","cwrap","uleb128Encode","sigToWasmTypes","generateFuncType","convertJsFunctionToWasm","getEmptyTableSlot","updateTableMap","getFunctionAddress","addFunction","removeFunction","reallyNegative","unSign","strLen","reSign","formatString","intArrayFromString","intArrayToString","AsciiToString","stringToAscii","stringToNewUTF8","stringToUTF8OnStack","registerKeyEventCallback","maybeCStringToJsString","findEventTarget","findCanvasEventTarget","getBoundingClientRect","fillMouseEventData","registerMouseEventCallback","registerWheelEventCallback","registerUiEventCallback","registerFocusEventCallback","fillDeviceOrientationEventData","registerDeviceOrientationEventCallback","fillDeviceMotionEventData","registerDeviceMotionEventCallback","screenOrientation","fillOrientationChangeEventData","registerOrientationChangeEventCallback","fillFullscreenChangeEventData","registerFullscreenChangeEventCallback","JSEvents_requestFullscreen","JSEvents_resizeCanvasForFullscreen","registerRestoreOldStyle","hideEverythingExceptGivenElement","restoreHiddenElements","setLetterbox","softFullscreenResizeWebGLRenderTarget","doRequestFullscreen","fillPointerlockChangeEventData","registerPointerlockChangeEventCallback","registerPointerlockErrorEventCallback","requestPointerLock","fillVisibilityChangeEventData","registerVisibilityChangeEventCallback","registerTouchEventCallback","fillGamepadEventData","registerGamepadEventCallback","registerBeforeUnloadEventCallback","fillBatteryEventData","battery","registerBatteryEventCallback","setCanvasElementSize","getCanvasElementSize","demangle","demangleAll","jsStackTrace","stackTrace","getEnvStrings","checkWasiClock","wasiRightsToMuslOFlags","wasiOFlagsToMuslOFlags","createDyncallWrapper","setImmediateWrapped","clearImmediateWrapped","polyfillSetImmediate","getPromise","makePromise","idsToPromises","makePromiseCallback","setMainLoop","getSocketFromFD","getSocketAddress","FS_createPreloadedFile","FS_modeStringToFlags","FS_getMode","FS_stdin_getChar","_setNetworkCallback","heapObjectForWebGLType","heapAccessShiftForWebGLHeap","webgl_enable_ANGLE_instanced_arrays","webgl_enable_OES_vertex_array_object","webgl_enable_WEBGL_draw_buffers","webgl_enable_WEBGL_multi_draw","emscriptenWebGLGet","computeUnpackAlignedImageSize","colorChannelsInGlTextureFormat","emscriptenWebGLGetTexPixelData","__glGenObject","emscriptenWebGLGetUniform","webglGetUniformLocation","webglPrepareUniformLocationsBeforeFirstUse","webglGetLeftBracePos","emscriptenWebGLGetVertexAttrib","__glGetActiveAttribOrUniform","writeGLArray","registerWebGlEventCallback","runAndAbortIfError","SDL_unicode","SDL_ttfContext","SDL_audio","GLFW_Window","ALLOC_NORMAL","ALLOC_STACK","allocate","writeStringToMemory","writeAsciiToMemory","getTypeName","heap32VectorToArray","requireRegisteredType","init_embind","throwUnboundTypeError","ensureOverloadTable","exposePublicSymbol","replacePublicSymbol","extendError","createNamedFunction","getBasestPointer","registerInheritedInstance","unregisterInheritedInstance","getInheritedInstance","getInheritedInstanceCount","getLiveInheritedInstances","enumReadValueFromPointer","runDestructors","craftInvokerFunction","embind__requireFunction","genericPointerToWireType","constNoSmartPtrRawPointerToWireType","nonConstNoSmartPtrRawPointerToWireType","init_RegisteredPointer","RegisteredPointer","RegisteredPointer_getPointee","RegisteredPointer_destructor","RegisteredPointer_deleteObject","RegisteredPointer_fromWireType","runDestructor","releaseClassHandle","detachFinalizer","attachFinalizer","makeClassHandle","init_ClassHandle","ClassHandle","ClassHandle_isAliasOf","throwInstanceAlreadyDeleted","ClassHandle_clone","ClassHandle_delete","ClassHandle_isDeleted","ClassHandle_deleteLater","flushPendingDeletes","setDelayFunction","RegisteredClass","shallowCopyInternalPointer","downcastPointer","upcastPointer","validateThis","char_0","char_9","makeLegalFunctionName","getStringOrSymbol","craftEmvalAllocator","emval_get_global","emval_lookupTypes","emval_allocateDestructors","emval_addMethodCaller"];missingLibrarySymbols.forEach(missingLibrarySymbol);var unexportedSymbols=["run","addOnPreRun","addOnInit","addOnPreMain","addOnExit","addOnPostRun","addRunDependency","removeRunDependency","FS_createFolder","FS_createPath","FS_createDataFile","FS_createLazyFile","FS_createLink","FS_createDevice","FS_unlink","out","err","callMain","abort","keepRuntimeAlive","wasmTable","wasmExports","stackAlloc","stackSave","stackRestore","getTempRet0","setTempRet0","writeStackCookie","checkStackCookie","convertI32PairToI53Checked","ptrToString","getHeapMax","growMemory","ENV","MONTH_DAYS_REGULAR","MONTH_DAYS_LEAP","MONTH_DAYS_REGULAR_CUMULATIVE","MONTH_DAYS_LEAP_CUMULATIVE","ERRNO_CODES","ERRNO_MESSAGES","DNS","Protocols","Sockets","timers","warnOnce","UNWIND_CACHE","readEmAsmArgsArray","readEmAsmArgs","runEmAsmFunction","getWasmTableEntry","handleAllocatorInit","HandleAllocator","freeTableIndexes","functionsInTableMap","setValue","PATH","PATH_FS","UTF8Decoder","UTF8ArrayToString","UTF8ToString","stringToUTF8Array","UTF16Decoder","UTF16ToString","stringToUTF16","lengthBytesUTF16","UTF32ToString","stringToUTF32","lengthBytesUTF32","JSEvents","specialHTMLTargets","currentFullscreenStrategy","restoreOldWindowedStyle","ExitStatus","flush_NO_FILESYSTEM","promiseMap","uncaughtExceptionCount","exceptionLast","exceptionCaught","ExceptionInfo","findMatchingCatch","getExceptionMessageCommon","incrementExceptionRefcount","decrementExceptionRefcount","getExceptionMessage","Browser","wget","SYSCALLS","preloadPlugins","FS_stdin_getChar_buffer","FS","MEMFS","TTY","PIPEFS","SOCKFS","tempFixedLengthArray","miniTempWebGLFloatBuffers","miniTempWebGLIntBuffers","GL","emscripten_webgl_power_preferences","AL","GLUT","EGL","GLEW","IDBStore","SDL","SDL_gfx","GLFW","allocateUTF8","allocateUTF8OnStack","InternalError","BindingError","throwInternalError","throwBindingError","registeredTypes","awaitingDependencies","typeDependencies","tupleRegistrations","structRegistrations","sharedRegisterType","whenDependentTypesAreResolved","embind_charCodes","embind_init_charCodes","readLatin1String","UnboundTypeError","PureVirtualError","embindRepr","registeredInstances","registeredPointers","registerType","getShiftFromSize","integerReadValueFromPointer","floatReadValueFromPointer","simpleReadValueFromPointer","finalizationRegistry","detachFinalizer_deps","deletionQueue","delayFunction","emval_handles","emval_symbols","init_emval","count_emval_handles","Emval","emval_newers","emval_methodCallers","emval_registeredMethods"];unexportedSymbols.forEach(unexportedRuntimeSymbol);var calledRun;dependenciesFulfilled=function runCaller(){if(!calledRun)run();if(!calledRun)dependenciesFulfilled=runCaller;};function stackCheckInit(){_emscripten_stack_init2();writeStackCookie();}function run(){if(runDependencies>0){return;}stackCheckInit();preRun();if(runDependencies>0){return;}function doRun(){if(calledRun)return;calledRun=true;Module["calledRun"]=true;if(ABORT)return;initRuntime();readyPromiseResolve(Module);if(Module["onRuntimeInitialized"])Module["onRuntimeInitialized"]();assert(!Module["_main"],'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]');postRun();}if(Module["setStatus"]){Module["setStatus"]("Running...");setTimeout(function(){setTimeout(function(){Module["setStatus"]("");},1);doRun();},1);}else{doRun();}checkStackCookie();}if(Module["preInit"]){if(typeof Module["preInit"]=="function")Module["preInit"]=[Module["preInit"]];while(Module["preInit"].length>0){Module["preInit"].pop()();}}run();


return moduleArg.ready;
});


}();
if(typeof exports==='object'&&typeof module==='object')
module.exports=Module;else
if(typeof define==='function'&&define['amd'])
define([],function(){return Module;});}),null);/*FB_PKG_DELIM*/
__d("E2EEBackupCommon",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["ALREADY_REGISTERED","BACKUP_KEY_PAIR_SERIALIZATION_ERROR","CLIENT_PARAMS_ERROR","NETWORK_PROVIDER_ERROR","NOT_REGISTERED","VESTA_CLIENT_ERROR","VESTA_SERVER_ERROR","ISLAND_PUB_RSA_KEY_INVALID","ISLAND_PUB_ED25519_KEY_INVALID","MISSING_PIN_INPUT","GENERAL_ERROR","INVALID_PASSWORD"]),l=(function(e){function t(t,n){var r;return r=e.call(this,n==null?void 0:n.message)||this,r.name="BackupError",r.errorType=t,r.detailedError=n,r.message=t+((n==null?void 0:n.message)!=null?": "+(n==null?void 0:n.message):""),r}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error));i.BackupErrorType=e,i.BackupError=l}),66);
__d("E2EEBackupUtil",["tweetnacl-util"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return r("tweetnacl-util").encodeBase64(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function s(e){var t=e.replace(/-/g,"+").replace(/_/g,"/"),n=e.length%4;if(n>0){if(n===1)throw new Error("Invalid length, couldn't decode input string");t=t.padEnd(t.length+(4-n),"=")}return r("tweetnacl-util").decodeBase64(t)}l.encodeBase64Url=e,l.decodeBase64Url=s}),98);
__d("MAWEncryptedBackupsClearRecoveryCode",["Promise","ReQL"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){return(e||(e=n("Promise"))).all([o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.tables.secure_recovery_code_data)),o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.tables.secure_encrypted_backups_recovery_code_status))]).then(function(r){var o=r[0],a=r[1];if(o!=null||a!=null)return t.runInTransaction(function(t){return(e||(e=n("Promise"))).all([(o==null?void 0:o.taskId)!=null?t.secure_recovery_code_data.delete(o.taskId):(e||(e=n("Promise"))).resolve(),(a==null?void 0:a.pk)!=null?t.secure_encrypted_backups_recovery_code_status.delete(a.pk):(e||(e=n("Promise"))).resolve()])},"readwrite",void 0,void 0,i.id+":27")})}l.encryptedBackupsClearRecoveryCode=s}),98);
__d("MWChatEBPinCodeVerifyIndicator.react",["fbt","MWXRow.react","MWXRowItem.react","MWXSpinner.react","MWXText.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react"));function c(e){var t=o("react-compiler-runtime").c(5),n=e.isMessenger,a=n?"disabled_DEPRECATED":"blue",i;t[0]!==a?(i=u.jsx(r("MWXRowItem.react"),{verticalAlign:"center",children:u.jsx(r("MWXSpinner.react"),{color:a,size:12})}),t[0]=a,t[1]=i):i=t[1];var l;t[2]===Symbol.for("react.memo_cache_sentinel")?(l=u.jsx(r("MWXRowItem.react"),{verticalAlign:"center",children:u.jsx(r("MWXText.react"),{color:"secondary",testid:void 0,type:"meta3",children:s._(/*BTDS*/"Verifying your PIN")})}),t[2]=l):l=t[2];var c;return t[3]!==i?(c=u.jsxs(r("MWXRow.react"),{align:"center",paddingTop:8,spacing:8,children:[i,l]}),t[3]=i,t[4]=c):c=t[4],c}l.default=c}),226);
__d("MWChatEncrypedBackupsNumericCodeKeyTypes",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["NUM_PAD_WITHOUT_NUM_LOCK","NON_NUMERIC_CHAR"]);i.InvalidKeyType=e}),66);
__d("MWChatEncrypedBackupsNumericCodeValidation",[],(function(t,n,r,o,a,i){"use strict";var e=function(t){var e=/^[0-9]*$/;return e.test(t)},l=function(n,r){return n.length>r?!1:e(n)},s=function(n,r){return n.length!==r?!1:e(n)};i.numericCodeIsValid=l,i.numericCodeIsCompleted=s}),66);
__d("MWChatEncryptedBackupsForgotPINDialogQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="24783313654667152"}),null);
__d("MWChatEncryptedBackupsForgotPINDialogQuery$Parameters",["MWChatEncryptedBackupsForgotPINDialogQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e={kind:"PreloadableConcreteRequest",params:{id:n("MWChatEncryptedBackupsForgotPINDialogQuery_facebookRelayOperation"),metadata:{},name:"MWChatEncryptedBackupsForgotPINDialogQuery",operationKind:"query",text:null}};a.exports=e}),null);
__d("MWChatEncryptedBackupsForgotPINDialog.entrypoint",["JSResourceForInteraction","MWChatEncryptedBackupsForgotPINDialogQuery$Parameters"],(function(t,n,r,o,a,i,l){"use strict";var e={getPreloadProps:function(){return{queries:{queryReference:{parameters:r("MWChatEncryptedBackupsForgotPINDialogQuery$Parameters"),variables:{}}}}},root:r("JSResourceForInteraction")("MWChatEncryptedBackupsForgotPINDialog.react").__setRef("MWChatEncryptedBackupsForgotPINDialog.entrypoint")};l.default=e}),98);
__d("MWChatEncryptedBackupsForgotPinStepDialogPage.entrypoint",["JSResourceForInteraction"],(function(t,n,r,o,a,i,l){"use strict";var e={getPreloadProps:function(){return{queries:{}}},root:r("JSResourceForInteraction")("MWChatEncryptedBackupsForgotPinStepDialogPage.react").__setRef("MWChatEncryptedBackupsForgotPinStepDialogPage.entrypoint")};l.default=e}),98);
__d("MWChatEncryptedBackupsNumericCodeErrorWrapper.react",["MWXColumn.react","MWXColumnItem.react","MWXText.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u={outterWrapper:{minHeight:"x10sr9ya",$$css:!0},outterWrapperSmall:{minHeight:"x1h7t28c",$$css:!0}};function c(e){var t=o("react-compiler-runtime").c(15),n=e.children,a=e.error,i=e.inputSize,l=e.labelId,c=i===void 0?"large":i,d=c==="large"?u.outterWrapper:u.outterWrapperSmall,m=c==="large"?20:0,p;t[0]!==a?(p={0:{},1:{className:"x18d9i69"}}[(a!=null)<<0],t[0]=a,t[1]=p):p=t[1];var _;t[2]!==n||t[3]!==p?(_=s.jsx("div",babelHelpers.extends({},p,{children:n})),t[2]=n,t[3]=p,t[4]=_):_=t[4];var f;t[5]!==a||t[6]!==l?(f=a!=null?s.jsx("div",{className:"x10b6aqq x1y1aw1k x2b8uid",children:s.jsx(r("MWXText.react"),{color:"negative",id:l,testid:void 0,type:"body4",children:a})}):null,t[5]=a,t[6]=l,t[7]=f):f=t[7];var g;t[8]!==m||t[9]!==_||t[10]!==f?(g=s.jsxs(r("MWXColumnItem.react"),{align:"center",paddingHorizontal:m,paddingTop:0,children:[_,f]}),t[8]=m,t[9]=_,t[10]=f,t[11]=g):g=t[11];var h;return t[12]!==d||t[13]!==g?(h=s.jsx(r("MWXColumn.react"),{xstyle:d,children:g}),t[12]=d,t[13]=g,t[14]=h):h=t[14],h}l.default=c}),98);
__d("useMWChatEncryptedBackupsNumericCodeInputAutoFocus",["FocusRegion.react","HiddenSubtreePassiveContext","focusScopeQueries","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.useContext,c=s.useEffect;function d(e){if(!("elementsFromPoint"in document))return!0;var t=e.getBoundingClientRect(),n=document.elementsFromPoint(t.left+t.width/2,t.top+t.height/2);for(var r of n){if(r===e)return!1;var o=window.getComputedStyle(r);if(o.visibility!=="hidden"&&o.display!=="none")return!0}return!1}function m(e){var t=o("react-compiler-runtime").c(3),n,r;t[0]!==e?(n=function(){var t=function(n){n.key>="0"&&n.key<="9"&&e(n.key)};return window.addEventListener("keydown",t),(function(){window.removeEventListener("keydown",t)})},r=[e],t[0]=e,t[1]=n,t[2]=r):(n=t[1],r=t[2]),c(n,r)}function p(e,t,n){var a=o("react-compiler-runtime").c(5),i=u(r("HiddenSubtreePassiveContext")),l;a[0]!==t||a[1]!==e||a[2]!==i||a[3]!==n?(l=function(){var r=i.getCurrentState(),a=["input","textarea"].some(_);!e&&!a&&!r.hiddenOrBackgrounded&&!(!n.current||d(n.current))&&o("FocusRegion.react").focusRegionById(t,o("focusScopeQueries").tabbableScopeQuery)},a[0]=t,a[1]=e,a[2]=i,a[3]=n,a[4]=l):l=a[4],m(l)}function _(e){var t;return(t=document.activeElement)==null?void 0:t.matches(e)}l.default=p}),98);
__d("MWChatEncryptedBackupsNumericCodeInputInner.react",["BaseTextInput.react","FocusRegion.react","MWChatEncrypedBackupsNumericCodeKeyTypes","MWChatEncrypedBackupsNumericCodeValidation","focusScopeQueries","gkx","react","react-compiler-runtime","useMWChatEncryptedBackupsNumericCodeInputAutoFocus"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e,c=u.useCallback,d=u.useEffect,m=u.useRef,p=u.useState,_=r("gkx")("24058"),f=function(t){return["0","1","2","3","4","5","6","7","8","9"].includes(t.key)},g=new Map([["Numpad0","0"],["Numpad1","1"],["Numpad2","2"],["Numpad3","3"],["Numpad4","4"],["Numpad5","5"],["Numpad6","6"],["Numpad7","7"],["Numpad8","8"],["Numpad9","9"]]),h=function(t){var e;return t.location===3&&!f(t)&&!t.shiftKey&&!t.ctrlKey&&!t.altKey&&!t.metaKey?g.get((e=t.nativeEvent)==null?void 0:e.code):null},y={input:{height:"x5yr21d",insetInlineStart:"x1o0tod",left:null,right:null,opacity:"xg01cxk",position:"x10l6tqk",top:"x13vifvy",width:"xh8yej3",$$css:!0},testOpacity:{opacity:"x1ptxcow",$$css:!0}};function C(e){var t=o("react-compiler-runtime").c(44),n=e.extraProps,a=e.props,i=n.hasFocus,l=n.setFocus,u=a["aria-describedby"],c=a["aria-label"],f=a.disabled,g=a.focusRegionId,C=a.inputMode,v=a.isError,S=a.onChange,R=a.onCompletionChange,L=a.onEnabledNumLock,E=a.onPressedInvalidKey,k=a.size,I=a.testid,T=a.value,D=f===void 0?!1:f,x=p(T.length===k),$=x[0],P=x[1],N=m(null),M=m(D);r("useMWChatEncryptedBackupsNumericCodeInputAutoFocus")(i,g,N);var w;t[0]!==$||t[1]!==S||t[2]!==R||t[3]!==k?(w=function(t){var e=o("MWChatEncrypedBackupsNumericCodeValidation").numericCodeIsCompleted(t,k);S(t),R!=null&&e!==$&&(P(e),R(e))},t[0]=$,t[1]=S,t[2]=R,t[3]=k,t[4]=w):w=t[4];var A=w,F,O;t[5]===Symbol.for("react.memo_cache_sentinel")?(F=function(){var e=b,t=N.current;return t==null||t.addEventListener("selectstart",e),(function(){t==null||t.removeEventListener("selectstart",e)})},O=[],t[5]=F,t[6]=O):(F=t[5],O=t[6]),d(F,O);var B,W;t[7]!==D||t[8]!==l?(B=function(){D&&l(!1)},W=[D,l],t[7]=D,t[8]=l,t[9]=B,t[10]=W):(B=t[9],W=t[10]),d(B,W);var q,U;t[11]===Symbol.for("react.memo_cache_sentinel")?(U=function(){var e=N.current;if(e!=null){var t=function(){var t=e.value.length,n=e.selectionStart===e.selectionEnd&&e.selectionStart===t;n||e.setSelectionRange(t,t)};return e.addEventListener("selectionchange",t),(function(){e.removeEventListener("selectionchange",t)})}},q=[],t[11]=q,t[12]=U):(q=t[11],U=t[12]),d(U,q);var V,H;t[13]!==D||t[14]!==g?(V=function(){M.current!==D&&(M.current=D,D||o("FocusRegion.react").focusRegionById(g,o("focusScopeQueries").tabbableScopeQuery))},H=[D,g],t[13]=D,t[14]=g,t[15]=V,t[16]=H):(V=t[15],H=t[16]),d(V,H);var G;t[17]!==L||t[18]!==E?(G=function(t){var e=h(t);e!=null?E==null||E(o("MWChatEncrypedBackupsNumericCodeKeyTypes").InvalidKeyType.NUM_PAD_WITHOUT_NUM_LOCK):t.key==="NumLock"&&(t.getModifierState==null?void 0:t.getModifierState("NumLock"))===!0&&(L==null||L())},t[17]=L,t[18]=E,t[19]=G):G=t[19];var z=G,j=I!=null?I+"-mw-numeric-code-input-prevent-composer-focus-steal":"mw-numeric-code-input-prevent-composer-focus-steal",K,Q;t[20]!==l?(K=function(){l(!1)},Q=function(){l(!0)},t[20]=l,t[21]=K,t[22]=Q):(K=t[21],Q=t[22]);var X;t[23]!==z?(X=function(t){var e=t.keyCode;(e===35||e===36||e===37||e===38||e===39||e===40)&&(t.preventDefault(),t.stopPropagation()),z==null||z(t)},t[23]=z,t[24]=X):X=t[24];var Y;t[25]!==E||t[26]!==k||t[27]!==A?(Y=function(t){var e=t.toString();o("MWChatEncrypedBackupsNumericCodeValidation").numericCodeIsValid(e,k)?A(e):E==null||E(o("MWChatEncrypedBackupsNumericCodeKeyTypes").InvalidKeyType.NON_NUMERIC_CHAR)},t[25]=E,t[26]=k,t[27]=A,t[28]=Y):Y=t[28];var J;t[29]===Symbol.for("react.memo_cache_sentinel")?(J=[y.input,_&&y.testOpacity],t[29]=J):J=t[29];var Z;return t[30]!==u||t[31]!==c||t[32]!==D||t[33]!==C||t[34]!==v||t[35]!==k||t[36]!==j||t[37]!==K||t[38]!==Q||t[39]!==X||t[40]!==Y||t[41]!==I||t[42]!==T?(Z=s.jsx(r("BaseTextInput.react"),{"aria-describedby":u,"aria-invalid":v,"aria-label":c,autoComplete:"one-time-code",disabled:D,id:j,inputMode:C,maxLength:k,onBlur:K,onFocus:Q,onKeyDown:X,onValueChange:Y,ref:N,testid:void 0,value:T,xstyle:J}),t[30]=u,t[31]=c,t[32]=D,t[33]=C,t[34]=v,t[35]=k,t[36]=j,t[37]=K,t[38]=Q,t[39]=X,t[40]=Y,t[41]=I,t[42]=T,t[43]=Z):Z=t[43],Z}function b(e){e.preventDefault()}l.default=C}),98);
__d("MWChatEncryptedBackupsNumericCodeInputRenderer.react",["MWXRow.react","MWXRowItem.react","MWXText.react","react","react-compiler-runtime","stylex"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=s||(s=o("react")),c=s,d=c.useEffect,m=c.useState,p={focusRing:{boxShadow:"x18bame2",outline:"x1a2a7pz xvetz19",$$css:!0},input:{alignItems:"x6s0dn4",borderStartStartRadius:"x1i5p2am",borderStartEndRadius:"x1whfx0g",borderEndEndRadius:"xr2y4jy",borderEndStartRadius:"x1ihp6rs",borderTopStyle:"x1ejq31n",borderInlineEndStyle:"x18oe1m7",borderBottomStyle:"x1sy0etr",borderInlineStartStyle:"xstzfhl",boxSizing:"x9f619",display:"x78zum5",height:"xng8ra",justifyContent:"xl56j7k",position:"x1n2onr6",width:"x1o817pb",$$css:!0},inputBox:{marginTop:"x1k70j0n",marginInlineEnd:"xbelrpt",marginBottom:"xzueoph",marginInlineStart:"xdzw4kq",$$css:!0},inputColorPrimary:{backgroundColor:"xljulmy",$$css:!0},inputColorSecondary:{backgroundColor:"xwcfey6",$$css:!0},inputSmall:{height:"xaymia4",width:"x1bgwkul",$$css:!0},inputTiny:{height:"x1vqgdyp",width:"x10faclu",$$css:!0}},_="-",f="\u25CF";function g(e,t){return t?"disabled":e===_?"secondary":"primary"}function h(t){var n=o("react-compiler-runtime").c(28),a=t.color,i=t.disabled,l=t.enableMasking,s=t.hasFocus,c=t.inputSize,h=t.size,y=t.testid,C=t.value,b=a===void 0?"primary":a,v=i===void 0?!1:i,S=l===void 0?!1:l,R=c===void 0?"large":c,L=y===void 0?"numeric-renderer":y,E;n[0]!==s||n[1]!==h||n[2]!==C?(E=function(t){return(C.length===t||C.length>t&&t===h-1)&&s},n[0]=s,n[1]=h,n[2]=C,n[3]=E):E=n[3];var k=E,I;n[4]!==h?(I=Array(h).fill(_),n[4]=h,n[5]=I):I=n[5];var T=m(I),D=T[0],x=T[1],$,P;n[6]!==S||n[7]!==h||n[8]!==C?($=function(){x(Array(h).fill().map(function(e,t){return C[t]!=null?S?f:C[t]:_}))},P=[S,h,C],n[6]=S,n[7]=h,n[8]=C,n[9]=$,n[10]=P):($=n[9],P=n[10]),d($,P);var N;if(n[11]!==b||n[12]!==v||n[13]!==S||n[14]!==R||n[15]!==k||n[16]!==L||n[17]!==D){var M;n[19]!==b||n[20]!==v||n[21]!==S||n[22]!==R||n[23]!==k||n[24]!==L?(M=function(n,o){return u.jsx(r("MWXRowItem.react"),{xstyle:p.inputBox,children:u.jsx("div",babelHelpers.extends({},(e||(e=r("stylex"))).props(p.input,R==="small"&&p.inputSmall,R==="tiny"&&p.inputTiny,b==="primary"&&p.inputColorPrimary,b==="secondary"&&p.inputColorSecondary,k(o)&&p.focusRing),{"aria-hidden":n===_,"data-testid":void 0,children:S?u.jsx(r("MWXText.react"),{color:g(n,v),type:n===_?"entityHeaderHeadline1":"headlineEmphasized4",children:v?f:n}):u.jsx(r("MWXText.react"),{color:g(n,v),type:n===_?"entityHeaderHeadline1":"headlineEmphasized1",children:n})}))},o)},n[19]=b,n[20]=v,n[21]=S,n[22]=R,n[23]=k,n[24]=L,n[25]=M):M=n[25],N=D.map(M),n[11]=b,n[12]=v,n[13]=S,n[14]=R,n[15]=k,n[16]=L,n[17]=D,n[18]=N}else N=n[18];var w;return n[26]!==N?(w=u.jsx(r("MWXRow.react"),{align:"center",paddingHorizontal:0,paddingVertical:0,role:"group",spacing:0,children:N}),n[26]=N,n[27]=w):w=n[27],w}l.MWChatEncryptedBackupsNumericCodeInputRenderer=h}),98);
__d("MWChatEncryptedBackupsNumericCodeInput.react",["FocusRegion.react","MWChatEncryptedBackupsNumericCodeInputInner.react","MWChatEncryptedBackupsNumericCodeInputRenderer.react","focusScopeQueries","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e.useState;function c(e){var t=o("react-compiler-runtime").c(22),n=e.enableMasking,a=e.focusRegionId,i=e.inputSize,l=e.size,c=e.testid,d=e.value,m=e.withAutoFocus,p=m===void 0?!0:m,_=u(!1),f=_[0],g=_[1],h=p?o("focusScopeQueries").tabbableScopeQuery:void 0,y;t[0]===Symbol.for("react.memo_cache_sentinel")?(y={className:"x1n2onr6"},t[0]=y):y=t[0];var C;t[1]!==n||t[2]!==f||t[3]!==e.color||t[4]!==e.disabled||t[5]!==i||t[6]!==l||t[7]!==c||t[8]!==d?(C=s.jsx(o("MWChatEncryptedBackupsNumericCodeInputRenderer.react").MWChatEncryptedBackupsNumericCodeInputRenderer,{color:e.color,disabled:e.disabled,enableMasking:n,hasFocus:f,inputSize:i,size:l,testid:void 0,value:d}),t[1]=n,t[2]=f,t[3]=e.color,t[4]=e.disabled,t[5]=i,t[6]=l,t[7]=c,t[8]=d,t[9]=C):C=t[9];var b;t[10]!==f?(b={hasFocus:f,setFocus:g},t[10]=f,t[11]=b):b=t[11];var v;t[12]!==e||t[13]!==b?(v=s.jsx(r("MWChatEncryptedBackupsNumericCodeInputInner.react"),{extraProps:b,props:e}),t[12]=e,t[13]=b,t[14]=v):v=t[14];var S;t[15]!==C||t[16]!==v?(S=s.jsxs("div",babelHelpers.extends({},y,{children:[C,v]})),t[15]=C,t[16]=v,t[17]=S):S=t[17];var R;return t[18]!==a||t[19]!==h||t[20]!==S?(R=s.jsx(o("FocusRegion.react").FocusRegion,{autoFocusQuery:h,id:a,children:S}),t[18]=a,t[19]=h,t[20]=S,t[21]=R):R=t[21],R}l.default=c}),98);
__d("MWChatEncryptedBackupsSetIsDialogPersistedContext",["react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.createContext({setIsDialogPersisted:function(){}});l.default=u}),98);
__d("MWChatEncryptedBackupsSettingsDialogQuery.graphql",["MWChatEncryptedBackupsSettingsDialogQuery_facebookRelayOperation","relay-runtime"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:!1,kind:"LocalArgument",name:"labyrinthOnePointOneSecurityUX"}],t={alias:null,args:null,kind:"ScalarField",name:"has_seen_eb_auto_restore_notice",storageKey:null},r={alias:null,args:[{kind:"Literal",name:"family_device_id",value:""}],kind:"ScalarField",name:"has_otc_eligible_devices",storageKey:'has_otc_eligible_devices(family_device_id:"")'},o={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"MWChatEncryptedBackupsSettingsDialogQuery",selections:[{kind:"RequiredField",field:{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"MWEBVestaUserInfoContextProvider_viewer"},{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[t],storageKey:null}],storageKey:null},action:"THROW",path:"viewer"},{args:[{kind:"Variable",name:"labyrinthOnePointOneSecurityUX",variableName:"labyrinthOnePointOneSecurityUX"}],kind:"FragmentSpread",name:"MWChatEncryptedBackupsSettingsDialogStep_query"},{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"xfb_backup",plural:!1,selections:[r,{args:null,kind:"FragmentSpread",name:"useMWEncryptedBackupsGetVirtualDevicesPreloaded_xfbEncryptedBackup"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"MWChatEncryptedBackupsSettingsDialogQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerDefaultEncryptedBackup",kind:"LinkedField",name:"messenger_default_encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"VestaGetUserInfoResponse",kind:"LinkedField",name:"vesta_user_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"attempts_remaining",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_registered",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"login_timeout_remaining_secs",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[t,o],storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"backup_state",storageKey:null}]},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actor",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"encrypted_backup_encryption_management_delegator_id",storageKey:null}],type:"User",abstractKey:null},o],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"xfb_backup",plural:!1,selections:[a,o,{alias:null,args:null,kind:"ScalarField",name:"last_sync_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"backup_creation_time",storageKey:null},{condition:"labyrinthOnePointOneSecurityUX",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"allow_sender_backup",storageKey:null}]},r,{alias:null,args:null,concreteType:"XFBEBVirtualDevice",kind:"LinkedField",name:"virtual_devices",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"client_generated_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"device_type",storageKey:null},o],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"logout_whitelist",storageKey:null}]},params:{id:n("MWChatEncryptedBackupsSettingsDialogQuery_facebookRelayOperation"),metadata:{},name:"MWChatEncryptedBackupsSettingsDialogQuery",operationKind:"query",text:null}}})();n("relay-runtime").PreloadableQueryRegistry.set(e.params.id,e),a.exports=e}),null);
__d("MWEBFlowSourceContextProvider.react",["MWEBFlowSourceContext","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e.useMemo;function c(e){var t=o("react-compiler-runtime").c(5),n=e.children,a=e.source,i;t[0]!==a?(i={source:a},t[0]=a,t[1]=i):i=t[1];var l=i,u;return t[2]!==n||t[3]!==l?(u=s.jsx(r("MWEBFlowSourceContext").Provider,{value:l,children:n}),t[2]=n,t[3]=l,t[4]=u):u=t[4],u}l.default=c}),98);
__d("MWEBNoMobileEOTRInformationalDialog.entrypoint",["JSResourceForInteraction"],(function(t,n,r,o,a,i,l){"use strict";var e={getPreloadProps:function(){return{queries:{}}},root:r("JSResourceForInteraction")("MWEBNoMobileEOTRInformationalDialogForEntrypoint.react").__setRef("MWEBNoMobileEOTRInformationalDialog.entrypoint")};l.default=e}),98);
__d("MWEBPinCodeSetupResult",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["SUCCESS","LABYRINTH_ERROR","VESTA_ERROR","DELETE_MAILBOX_ERROR"]);i.CodeSetupResult=e}),66);
__d("MWEBPinCodeSize",[],(function(t,n,r,o,a,i){"use strict";var e=6;i.EB_PIN_CODE_SIZE=e}),66);
__d("MWEBUntrustedMobileEOTRInformationalDialog.entrypoint",["JSResourceForInteraction"],(function(t,n,r,o,a,i,l){"use strict";var e={getPreloadProps:function(){return{queries:{}}},root:r("JSResourceForInteraction")("MWEBUntrustedMobileEOTRInformationalDialogForEntrypoint.react").__setRef("MWEBUntrustedMobileEOTRInformationalDialog.entrypoint")};l.default=e}),98);
__d("UserMobileEBState",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["UNKNOWN","NO_MOBILE","UNTRUSTED_MOBILE","TRUSTED_MOBILE"]);i.UserMobileEBState=e}),66);
__d("useWAInfraMobileDeviceList",["cr:8431","react","react-compiler-runtime","useWAInfraDeviceList"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useMemo;function u(){var e=o("react-compiler-runtime").c(3),t=r("useWAInfraDeviceList")(),a;e[0]!==t?(a=t.filter(c),e[0]=t,e[1]=a):a=e[1];var i=a;if(n("cr:8431")){var l;return e[2]===Symbol.for("react.memo_cache_sentinel")?(l=[n("cr:8431")],e[2]=l):l=e[2],l}return i}function c(e){var t;return e.platform==="Messenger"&&e.manufacturer!=="Mac OS X"&&e.manufacturer!=="Windows"&&(e.model==null||!["Chrome","Safari","Firefox","Edge","System Product Name"].includes(e.model))&&!(e.manufacturer==="Apple"&&(t=e.model)!=null&&t.includes("Mac"))}l.default=u}),98);
__d("useGetUserMobileEBState",["MAWOneTimeCodeGating","UserMobileEBState","gkx","react-compiler-runtime","useHasOTCEligibleDevicesFromReStore","useWAInfraMobileDeviceList"],(function(t,n,r,o,a,i,l){"use strict";function e(){var e=o("react-compiler-runtime").c(7),t=r("useWAInfraMobileDeviceList")(),n=r("useHasOTCEligibleDevicesFromReStore")(),a=n.hasOtcEligibleDevices;if(a){var i;return e[0]===Symbol.for("react.memo_cache_sentinel")?(i={state:o("UserMobileEBState").UserMobileEBState.TRUSTED_MOBILE},e[0]=i):i=e[0],i}var l=o("MAWOneTimeCodeGating").isOneTimeCodeEnabled()&&a,u=t.length===0&&r("gkx")("14456");if(u){var c;return e[1]===Symbol.for("react.memo_cache_sentinel")?(c={state:o("UserMobileEBState").UserMobileEBState.NO_MOBILE},e[1]=c):c=e[1],c}var d=t.length>0&&!l,m=d&&r("gkx")("14456");if(m){var p;e[2]!==t?(p=t.map(s),e[2]=t,e[3]=p):p=e[3];var _;return e[4]!==p?(_={deviceInfoList:p,state:o("UserMobileEBState").UserMobileEBState.UNTRUSTED_MOBILE},e[4]=p,e[5]=_):_=e[5],_}var f;return e[6]===Symbol.for("react.memo_cache_sentinel")?(f={state:o("UserMobileEBState").UserMobileEBState.UNKNOWN},e[6]=f):f=e[6],f}function s(e){return{lastSeen:e.lastSeen,model:e.model,platform:e.platform}}l.default=e}),98);
__d("MWEncryptedBackupsForgotPinStep",["fbt","MAWEncryptedBackupsRestoreDialog.entrypoint","MWChatEncryptedBackupsForgotPINDialog.entrypoint","MWChatEncryptedBackupsForgotPinStepDialogPage.entrypoint","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsQPLSource.enum","MWEBVirtualDevicesContext.react","MWJewelPopoverDialogContext.react","QPLUserFlow","UserMobileEBState","cr:12326","cr:12327","emptyFunction","gkx","react","react-compiler-runtime","useGetUserMobileEBState","useMWXEntryPointDialog","usePushPage"],(function(t,n,r,o,a,i,l,s){"use strict";var e=["onHighIntent"],u=["onHighIntent"],c=["onHighIntent"],d,m=d||(d=o("react")),p=d.useContext,_=s._(/*BTDS*/"Forgot PIN?"),f=s._(/*BTDS*/"Need help?"),g="https://www.facebook.com/help/messenger-app/431055522328649?ref=learn_more",h=r("gkx")("14456"),y=function(t){r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,t===_?"PIN_CODE_RESTORE_FORGOT_PIN_CLICK":"PIN_CODE_RESTORE_NEED_HELP_CLICK")},C=h?_:f,b=function(){y(C)},v={children:C,href:g,onClick:b,rel:"noreferrer",target:"_blank"};function S(t){var a=o("react-compiler-runtime").c(39),i=t.offlineDevicesCount,l=t.onClose,s=t.onComplete,d=t.pushPage,m=r("useGetUserMobileEBState")(),p;a[0]===Symbol.for("react.memo_cache_sentinel")?(p={},a[0]=p):p=a[0];var g=r("usePushPage")(n("cr:12326"),p),h=g[0],C=g[1],b;if(a[1]!==C){var S=C.onHighIntent,R=babelHelpers.objectWithoutPropertiesLoose(C,e);b=R,a[1]=C,a[2]=b}else b=a[2];var L;a[3]===Symbol.for("react.memo_cache_sentinel")?(L={},a[3]=L):L=a[3];var E=r("usePushPage")(n("cr:12327"),L),k=E[0],I=E[1],T;if(a[4]!==I){var D=I.onHighIntent,x=babelHelpers.objectWithoutPropertiesLoose(I,u);T=x,a[4]=I,a[5]=T}else T=a[5];var $;a[6]===Symbol.for("react.memo_cache_sentinel")?($={},a[6]=$):$=a[6];var P=r("usePushPage")(r("MWChatEncryptedBackupsForgotPinStepDialogPage.entrypoint"),$),N=P[0],M=P[1],w;if(a[7]!==M){var A=M.onHighIntent,F=babelHelpers.objectWithoutPropertiesLoose(M,c);w=F,a[7]=M,a[8]=w}else w=a[8];if(m.state===o("UserMobileEBState").UserMobileEBState.UNTRUSTED_MOBILE){var O;a[9]!==l||a[10]!==s||a[11]!==d||a[12]!==k?(O=function(){y(_),k({onClose:l,onComplete:s,pushPage:d})},a[9]=l,a[10]=s,a[11]=d,a[12]=k,a[13]=O):O=a[13];var B;return a[14]!==O||a[15]!==T.onHoverIn||a[16]!==T.onHoverOut||a[17]!==T.onPressIn?(B={children:_,onClick:O,onHoverEnd:T.onHoverOut,onHoverStart:T.onHoverIn,onPressStart:T.onPressIn},a[14]=O,a[15]=T.onHoverIn,a[16]=T.onHoverOut,a[17]=T.onPressIn,a[18]=B):B=a[18],B}if(m.state===o("UserMobileEBState").UserMobileEBState.NO_MOBILE){var W;a[19]!==l||a[20]!==s||a[21]!==h?(W=function(){y(_),h({onClose:l,onComplete:s})},a[19]=l,a[20]=s,a[21]=h,a[22]=W):W=a[22];var q;return a[23]!==b.onHoverIn||a[24]!==b.onHoverOut||a[25]!==b.onPressIn||a[26]!==W?(q={children:_,onClick:W,onHoverEnd:b.onHoverOut,onHoverStart:b.onHoverIn,onPressStart:b.onPressIn},a[23]=b.onHoverIn,a[24]=b.onHoverOut,a[25]=b.onPressIn,a[26]=W,a[27]=q):q=a[27],q}var U=i>0||!0;if(U){var V;a[28]!==U||a[29]!==l||a[30]!==s||a[31]!==N||a[32]!==d?(V=function(){y(f),N({isRCDeviceEnabled:U,onClose:l,onComplete:s,pushPage:d},{})},a[28]=U,a[29]=l,a[30]=s,a[31]=N,a[32]=d,a[33]=V):V=a[33];var H;return a[34]!==w.onHoverIn||a[35]!==w.onHoverOut||a[36]!==w.onPressIn||a[37]!==V?(H={children:f,onClick:V,onHoverEnd:w.onHoverOut,onHoverStart:w.onHoverIn,onPressStart:w.onPressIn},a[34]=w.onHoverIn,a[35]=w.onHoverOut,a[36]=w.onPressIn,a[37]=V,a[38]=H):H=a[38],H}else return v}function R(e){var t=o("react-compiler-runtime").c(18),n=e.onDismiss,a=n===void 0?r("emptyFunction"):n,i=r("useGetUserMobileEBState")(),l;t[0]===Symbol.for("react.memo_cache_sentinel")?(l={},t[0]=l):l=t[0];var s=r("useMWXEntryPointDialog")(r("MAWEncryptedBackupsRestoreDialog.entrypoint"),l),u=s[0],c=o("MWEBVirtualDevicesContext.react").useMWEBVirtualDevices(),d=c.virtualDeviceInfo,m=d.offlineDevicesCount,g=p(r("MWJewelPopoverDialogContext.react")),h=g.setIsOpenForDialog,C;t[1]===Symbol.for("react.memo_cache_sentinel")?(C={},t[1]=C):C=t[1];var b=r("useMWXEntryPointDialog")(r("MWChatEncryptedBackupsForgotPINDialog.entrypoint"),C),S,R;if(t[2]!==b?(R=b[0],S=babelHelpers.arrayLikeToArray(b).slice(1),t[2]=b,t[3]=S,t[4]=R):(S=t[3],R=t[4]),i.state===o("UserMobileEBState").UserMobileEBState.UNTRUSTED_MOBILE||i.state===o("UserMobileEBState").UserMobileEBState.NO_MOBILE){var L;return t[5]!==h||t[6]!==u||t[7]!==i.state?(L={children:_,onClick:function(){y(_),h(!0),u({onDismissUpsell:r("emptyFunction"),skipToEOTRForgotPINStep:i.state,source:r("MWChatEncryptedBackupsQPLSource.enum").JEWEL_THREADLIST_QP})}},t[5]=h,t[6]=u,t[7]=i.state,t[8]=L):L=t[8],L}var E=m>0;if(E){var k=S,I=k[0],T=k[1],D=k[2],x;t[9]!==a||t[10]!==h||t[11]!==R?(x=function(){y(f),h(!0),R({onDismiss:a})},t[9]=a,t[10]=h,t[11]=R,t[12]=x):x=t[12];var $;return t[13]!==T||t[14]!==I||t[15]!==D||t[16]!==x?($={children:f,onClick:x,onHoverEnd:T,onHoverStart:I,onPressStart:D},t[13]=T,t[14]=I,t[15]=D,t[16]=x,t[17]=$):$=t[17],$}else return v}l.STATIC_HELP_CENTER_LINK_PROPS=v,l.useForgotPinLinkPushPageProps=S,l.useForgotPinLinkShowDialogProps=R}),226);
__d("VestaClientError",[],(function(t,n,r,o,a,i){"use strict";var e=(function(e){function t(t){var n;return n=e.call(this,t)||this,n.message=t,n}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error));i.default=e}),66);
__d("VestaGetWasm",["WAWasmModuleCache","bx"],(function(t,n,r,o,a,i,l){"use strict";var e=r("bx").getURL(r("bx")("72238")),s=function(){return o("WAWasmModuleCache").loadWasmModule(e)};l.getVestaWasm=s}),98);
__d("VestaWasm.pb",["WAProtoConst"],(function(t,n,r,o,a,i,l){var e,s={},u={},c={},d={},m={},p={},_={},f={},g={},h={},y={},C={},b={},v={};s.name="ValidateHsmKeyRequest",s.internalSpec={hsmKey:[1,(e=o("WAProtoConst")).FLAGS.REQUIRED|e.TYPES.BYTES],signature:[2,e.FLAGS.REQUIRED|e.TYPES.BYTES]},u.name="ValidateHsmKeyResponse",u.internalSpec={isValid:[1,e.FLAGS.REQUIRED|e.TYPES.BOOL]},c.name="BeginRegisterRequest",c.internalSpec={password:[1,e.FLAGS.REQUIRED|e.TYPES.BYTES]},d.name="BeginRegisterResponse",d.internalSpec={r1Message:[1,e.FLAGS.REQUIRED|e.TYPES.BYTES],clientState:[2,e.FLAGS.REQUIRED|e.TYPES.BYTES]},m.name="FinishRegisterRequest",m.internalSpec={r1Message:[1,e.FLAGS.REQUIRED|e.TYPES.BYTES],r2Message:[2,e.FLAGS.REQUIRED|e.TYPES.BYTES],r2MessageSig:[3,e.FLAGS.REQUIRED|e.TYPES.BYTES],islandEd25519Pub:[4,e.FLAGS.REQUIRED|e.TYPES.BYTES],clientState:[5,e.FLAGS.REQUIRED|e.TYPES.BYTES],userSecret:[6,e.FLAGS.REQUIRED|e.TYPES.BYTES],registrationChallenge:[7,e.FLAGS.REQUIRED|e.TYPES.BYTES],hsmRsaPublicKey:[8,e.FLAGS.REQUIRED|e.TYPES.BYTES],loginAttempts:[9,e.TYPES.UINT32],useProtobufMode:[10,e.FLAGS.REQUIRED|e.TYPES.BOOL]},p.name="FinishRegisterResponse",p.internalSpec={registrationPayloadEncrypted:[1,e.FLAGS.REQUIRED|e.TYPES.BYTES],registrationIdentifier:[2,e.FLAGS.REQUIRED|e.TYPES.BYTES]},_.name="BeginLoginRequest",_.internalSpec={password:[1,e.FLAGS.REQUIRED|e.TYPES.BYTES]},f.name="BeginLoginResponse",f.internalSpec={l1Message:[1,e.FLAGS.REQUIRED|e.TYPES.BYTES],clientState:[2,e.FLAGS.REQUIRED|e.TYPES.BYTES]},g.name="FinishLoginRequest",g.internalSpec={l2Message:[1,e.FLAGS.REQUIRED|e.TYPES.BYTES],l2MessageSig:[2,e.FLAGS.REQUIRED|e.TYPES.BYTES],islandEd25519Pub:[3,e.FLAGS.REQUIRED|e.TYPES.BYTES],clientState:[4,e.FLAGS.REQUIRED|e.TYPES.BYTES]},h.name="FinishLoginResponse",h.internalSpec={l3Message:[1,e.FLAGS.REQUIRED|e.TYPES.BYTES],sessionKey:[2,e.FLAGS.REQUIRED|e.TYPES.BYTES],exportKey:[3,e.FLAGS.REQUIRED|e.TYPES.BYTES]},y.name="UnpackLoginPayloadRequest",y.internalSpec={loginPayload:[1,e.FLAGS.REQUIRED|e.TYPES.BYTES],sessionKey:[2,e.FLAGS.REQUIRED|e.TYPES.BYTES],exportKey:[3,e.FLAGS.REQUIRED|e.TYPES.BYTES],useProtobufMode:[4,e.FLAGS.REQUIRED|e.TYPES.BOOL]},C.name="UnpackLoginPayloadResponse",C.internalSpec={userSecret:[1,e.FLAGS.REQUIRED|e.TYPES.BYTES]},b.name="CliCommand",b.internalSpec={validateHsmKey:[1,e.TYPES.MESSAGE,s],beginRegister:[2,e.TYPES.MESSAGE,c],finishRegister:[3,e.TYPES.MESSAGE,m],beginLogin:[4,e.TYPES.MESSAGE,_],finishLogin:[5,e.TYPES.MESSAGE,g],unpackLoginPayload:[6,e.TYPES.MESSAGE,y],__oneofs__:{command:["validateHsmKey","beginRegister","finishRegister","beginLogin","finishLogin","unpackLoginPayload"]}},v.name="CliResponse",v.internalSpec={errorCode:[1,e.FLAGS.REQUIRED|e.TYPES.INT32],validateHsmKey:[2,e.TYPES.MESSAGE,u],beginRegister:[3,e.TYPES.MESSAGE,d],finishRegister:[4,e.TYPES.MESSAGE,p],beginLogin:[5,e.TYPES.MESSAGE,f],finishLogin:[6,e.TYPES.MESSAGE,h],unpackLoginPayload:[7,e.TYPES.MESSAGE,C],__oneofs__:{response:["validateHsmKey","beginRegister","finishRegister","beginLogin","finishLogin","unpackLoginPayload"]}},l.ValidateHsmKeyRequestSpec=s,l.ValidateHsmKeyResponseSpec=u,l.BeginRegisterRequestSpec=c,l.BeginRegisterResponseSpec=d,l.FinishRegisterRequestSpec=m,l.FinishRegisterResponseSpec=p,l.BeginLoginRequestSpec=_,l.BeginLoginResponseSpec=f,l.FinishLoginRequestSpec=g,l.FinishLoginResponseSpec=h,l.UnpackLoginPayloadRequestSpec=y,l.UnpackLoginPayloadResponseSpec=C,l.CliCommandSpec=b,l.CliResponseSpec=v}),98);
__d("mapVestaClientError",["VestaClientError"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e){switch(e){case 1:return new u;case 2:return new c;case 3:return new d;case 4:return new m;case 5:return new p;case 6:return new _;case 7:return new f;case 8:return new g;case 9:return new h;case 10:return new y;case 11:return new C;case 12:return new b;default:return new v}}var u=(function(e){function t(t){var n;return t===void 0&&(t="Buffer supplied to WASM for response is too small"),n=e.call(this,t)||this,n.name="InsufficientResultBuffer",n}return babelHelpers.inheritsLoose(t,e),t})(e=r("VestaClientError")),c=(function(e){function t(t){var n;return t===void 0&&(t="Incorrect user password supplied during login"),n=e.call(this,t)||this,n.name="InvalidUserPassword",n}return babelHelpers.inheritsLoose(t,e),t})(e),d=(function(e){function t(t){var n;return t===void 0&&(t="Invalid input from server"),n=e.call(this,t)||this,n.name="MalformedServerResponse",n}return babelHelpers.inheritsLoose(t,e),t})(e),m=(function(e){function t(t){var n;return t===void 0&&(t="Invalid input from client"),n=e.call(this,t)||this,n.name="MalformedClientInput",n}return babelHelpers.inheritsLoose(t,e),t})(e),p=(function(e){function t(t){var n;return t===void 0&&(t="Error during encryption operation"),n=e.call(this,t)||this,n.name="EncryptionFailure",n}return babelHelpers.inheritsLoose(t,e),t})(e),_=(function(e){function t(t){var n;return t===void 0&&(t="Error during decryption operation"),n=e.call(this,t)||this,n.name="DecryptionFailure",n}return babelHelpers.inheritsLoose(t,e),t})(e),f=(function(e){function t(t){var n;return t===void 0&&(t="Error during serialization operation."),n=e.call(this,t)||this,n.name="SerializationFailure",n}return babelHelpers.inheritsLoose(t,e),t})(e),g=(function(e){function t(t){var n;return t===void 0&&(t="Error deserializing inputs, likely due to malformed input"),n=e.call(this,t)||this,n.name="DeserializationFailure",n}return babelHelpers.inheritsLoose(t,e),t})(e),h=(function(e){function t(t){var n;return t===void 0&&(t="Passed RSA public key is in an invalid format."),n=e.call(this,t)||this,n.name="RsaInvalidKey",n}return babelHelpers.inheritsLoose(t,e),t})(e),y=(function(e){function t(t){var n;return t===void 0&&(t="Unable to verify RSA signature"),n=e.call(this,t)||this,n.name="RsaVerificationFailure",n}return babelHelpers.inheritsLoose(t,e),t})(e),C=(function(e){function t(t){var n;return t===void 0&&(t="Passed Ed25519 public key is in an invalid format."),n=e.call(this,t)||this,n.name="Ed25519InvalidKey",n}return babelHelpers.inheritsLoose(t,e),t})(e),b=(function(e){function t(t){var n;return t===void 0&&(t="Unable to verify Ed25519 signature"),n=e.call(this,t)||this,n.name="Ed25519VerificationFailure",n}return babelHelpers.inheritsLoose(t,e),t})(e),v=(function(e){function t(t){var n;return t===void 0&&(t="Unknown error code received from WASM binary"),n=e.call(this,t)||this,n.name="UnknownErrorCode",n}return babelHelpers.inheritsLoose(t,e),t})(e);l.mapErrorCode=s,l.DeserializationFailure=g}),98);
__d("VestaClient",["$InternalEnum","VestaClientError","VestaGetWasm","VestaWasm.pb","WAByteArray","WAResultOrError","WATagsLogger","WAWasmReactor","err","mapVestaClientError"],(function(t,n,r,o,a,i,l){"use strict";var e,s=o("WATagsLogger").TAGS(["VestaClient"]),u=0,c="VestaClientV2_REPL",d=(function(){function e(){if(!e.$2){var t=o("WAWasmReactor").createWasmInstance(o("VestaGetWasm").getVestaWasm,c);e.$1=t;return}throw r("err")("VestaWasmReactorSingleton is already initialized")}e.getInstance=function(){if(!e.$2){var t=new e;e.$2=t;var n=o("WAWasmReactor").createWasmInstance(o("VestaGetWasm").getVestaWasm,c);e.$1=n}return e.$2};var t=e.prototype;return t.createWasmReactorCommand=async function(n){var t=n.InputSpec,o=n.ResultSpec,a=n.validateResult,i=await e.$1;if(!i)throw r("err")("wasmReactor is not initialized");return i.DEPRECATED_createWasmCommand({InputSpec:t,ResultSpec:o,validateResult:a})},e})();d.$1=null,d.$2=null;var m=function(t){var e=d.getInstance();if(!e)throw r("err")("VestaWasmReactorSingleton is not initialized");return e.createWasmReactorCommand(t)};function p(t){var n=t.processResult;function a(t){var a=t.errorCode;if(a!==u)return s.ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Vesta error: ",""])),a),o("WAResultOrError").makeError(o("mapVestaClientError").mapErrorCode(a));try{return o("WAResultOrError").makeResult(n(t))}catch(e){if(e instanceof r("VestaClientError"))return o("WAResultOrError").makeError(e);throw e}}return m({InputSpec:o("VestaWasm.pb").CliCommandSpec,ResultSpec:o("VestaWasm.pb").CliResponseSpec,validateResult:a})}function _(e,t){var n=p({processResult:function(t){if(t.validateHsmKey)return t.validateHsmKey.isValid;throw new(o("mapVestaClientError")).DeserializationFailure}}),r={validateHsmKey:{hsmKey:o("WAByteArray").uint8ArrayToBuffer(e),signature:o("WAByteArray").uint8ArrayToBuffer(t)}};return n.then(function(e){return e(r)})}function f(e){var t=p({processResult:function(t){if(t.beginRegister){var e=t.beginRegister;return{clientState:new Uint8Array(e.clientState),r1Message:new Uint8Array(e.r1Message)}}throw new(o("mapVestaClientError")).DeserializationFailure}}),n={beginRegister:{password:o("WAByteArray").uint8ArrayToBuffer(e)}};return t.then(function(e){return e(n)})}var g=n("$InternalEnum").Mirrored(["WaBackupKeyData","Raw"]);function h(e,t,n,r,a,i,l,s,u,c){u===void 0&&(u=0),c===void 0&&(c=g.WaBackupKeyData);var d=p({processResult:function(t){if(t.finishRegister){var e=t.finishRegister;return{registerIdentifier:new Uint8Array(e.registrationIdentifier),registerPayload:new Uint8Array(e.registrationPayloadEncrypted)}}throw new(o("mapVestaClientError")).DeserializationFailure}}),m={finishRegister:{clientState:o("WAByteArray").uint8ArrayToBuffer(a),hsmRsaPublicKey:o("WAByteArray").uint8ArrayToBuffer(s),islandEd25519Pub:o("WAByteArray").uint8ArrayToBuffer(r),loginAttempts:u>0?u:void 0,r1Message:o("WAByteArray").uint8ArrayToBuffer(e),r2Message:o("WAByteArray").uint8ArrayToBuffer(t),r2MessageSig:o("WAByteArray").uint8ArrayToBuffer(n),registrationChallenge:o("WAByteArray").uint8ArrayToBuffer(l),useProtobufMode:c===g.WaBackupKeyData,userSecret:o("WAByteArray").uint8ArrayToBuffer(i)}};return d.then(function(e){return e(m)})}function y(e){var t=p({processResult:function(t){if(t.beginLogin){var e=t.beginLogin;return{clientState:new Uint8Array(e.clientState),l1Message:new Uint8Array(e.l1Message)}}throw new(o("mapVestaClientError")).DeserializationFailure}}),n={beginLogin:{password:o("WAByteArray").uint8ArrayToBuffer(e)}};return t.then(function(e){return e(n)})}function C(e,t,n,r){var a,i=p({processResult:function(t){if(t.finishLogin){var e=t.finishLogin;return{exportKey:new Uint8Array(e.exportKey),l3Message:new Uint8Array(e.l3Message),sessionKey:new Uint8Array(e.sessionKey)}}throw new(o("mapVestaClientError")).DeserializationFailure}}),l={finishLogin:{clientState:(a=o("WAByteArray")).uint8ArrayToBuffer(r),islandEd25519Pub:a.uint8ArrayToBuffer(n),l2Message:a.uint8ArrayToBuffer(e),l2MessageSig:a.uint8ArrayToBuffer(t)}};return i.then(function(e){return e(l)})}function b(e,t,n,r){r===void 0&&(r=g.WaBackupKeyData);var a=p({processResult:function(t){if(t.unpackLoginPayload){var e=t.unpackLoginPayload;return{userSecret:new Uint8Array(e.userSecret)}}throw new(o("mapVestaClientError")).DeserializationFailure}}),i={unpackLoginPayload:{exportKey:o("WAByteArray").uint8ArrayToBuffer(n),loginPayload:o("WAByteArray").uint8ArrayToBuffer(e),sessionKey:o("WAByteArray").uint8ArrayToBuffer(t),useProtobufMode:r===g.WaBackupKeyData}};return a.then(function(e){return e(i)})}l.validateHsmKey=_,l.beginRegister=f,l.SerializationMode=g,l.finishRegister=h,l.beginLogin=y,l.finishLogin=C,l.unpackLoginPayload=b}),98);
__d("getMWChatEncryptedBackupsPinCodeInvalidKeyPressedError",["fbt","MWChatEncrypedBackupsNumericCodeKeyTypes"],(function(t,n,r,o,a,i,l,s){"use strict";function e(e,t){if(e===o("MWChatEncrypedBackupsNumericCodeKeyTypes").InvalidKeyType.NON_NUMERIC_CHAR)return t==="pin"?s._(/*BTDS*/"Your PIN can only contain numbers"):null;if(e===o("MWChatEncrypedBackupsNumericCodeKeyTypes").InvalidKeyType.NUM_PAD_WITHOUT_NUM_LOCK)return s._(/*BTDS*/"Press Num Lock to use the numeric keypad")}l.default=e}),226);
__d("getMWEBRestoreQPCautionCircleProperties",["ix","gkx"],(function(t,n,r,o,a,i,l,s){"use strict";var e=r("gkx")("23433");function u(){var t=s(e?"414274":"1745665");return t}l.default=u}),98);
__d("mwEBAddDevice",["EBSMAPI","MAWCurrentUser","MWChatEncryptedBackupsQPLEvents","MWEncryptedBackupsInitializeRestoreDeferred","QPLUserFlow","isInstamadilloEB"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.environment,n=e.onFailure,a=e.onInvalidRecoveryCode,i=e.onSuccess,l=e.recoveryCode,s=e.storage;return r("EBSMAPI").addDeviceWithRecoveryCode({environment:t,recoveryCode:l,userId:o("MAWCurrentUser").getID()}).then(function(e){e.success?(i(),r("isInstamadilloEB")()?r("QPLUserFlow").endSuccess(o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent):o("MWEncryptedBackupsInitializeRestoreDeferred").encryptedBackupsInitializeRestoreDeferred({db:s,onFailure:function(){},onSuccess:function(){}})):e.error==="INVALID_RECOVERY_CODE"?a():n(e.error)})}l.EBAddDevice=e}),98);
__d("vestaBackupSecretRestore",["requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e=r("requireDeferred")("E2EEBackupSecretRestoreModule").__setRef("vestaBackupSecretRestore"),s=r("requireDeferred")("VestaServerGraphQLLoginProvider").__setRef("vestaBackupSecretRestore");async function u(t){var n=t.environment,r=t.input,o=await Promise.all([s.load(),e.load()]),a=o[0],i=a.beginLogin,l=a.finishLogin,u=a.initLogin,c=o[1].restoreBackupSecret;return c({beginLogin:i,finishLogin:l,initLogin:u},r,{environment:n})}l.default=u}),98);
__d("mwEBGetPINSecretFromVesta",["CometRelay","E2EEBackupCommon","FBLogger","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsSettingsDialogQuery.graphql","MWEBODSEntityKey.enum","MWEBODSEntityName.enum","QPLUserFlow","getErrorSafe","promiseDone","vestaBackupSecretRestore"],(function(t,n,r,o,a,i,l){"use strict";async function e(e){var t=e.addDevice,n=e.clientID,a=e.environment,i=e.getSourceFromContext,l=e.onSubmitPin,s=e.onSubmitPinFailure,u=e.onVestaSecretFetch,c=e.pinCode,d=e.productUseCase,m=e.setIsInProgress,p=e.setIsPinCodeIncorrect,_=e.setIsVestaError,f=e.startFlow;m(!0),l==null||l();var g=i();r("QPLUserFlow").addAnnotations(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,{string:{restore_type:"pin_code",source:g}});var h=new TextDecoder,y;f({additionalAnnotations:{device_type:"HSM"},event:o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH,source:g});try{r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,"vesta_login_begin"),r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"PIN_CODE_RESTORE_SUBMIT"),y=h.decode(await r("vestaBackupSecretRestore")({environment:a,input:{clientId:n,productUseCase:d,vestaAccountPin:c}})),r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,"vesta_login_success")}catch(e){var C=r("getErrorSafe")(e),b=typeof e=="object"&&e!=null&&"errorType"in e&&typeof e.errorType=="string"?e.errorType:void 0;if(s==null||s(),r("promiseDone")(o("CometRelay").fetchQuery(a,r("MWChatEncryptedBackupsSettingsDialogQuery.graphql"),{}).toPromise()),b===o("E2EEBackupCommon").BackupErrorType.INVALID_PASSWORD)m(!1),p(!0),o("MWChatEncryptedBackupsLogging").endFailure({errorName:"incorrect_pin_code",event:o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityKey:r("MWEBODSEntityKey.enum").INCORRECT_PIN_CODE,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH}),r("QPLUserFlow").markError(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"incorrect_pin_code");else{o("MWChatEncryptedBackupsLogging").endFailure({annotations:{string:{errorMessage:C.message,errorType:b}},errorName:"vesta_login_failure",event:o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH}),r("QPLUserFlow").markError(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"pin_code_error"),m(!1),_(!0);var v="Error when restoring using PIN: "+C.message;r("FBLogger")("wmi_eb").mustfix(v)}throw e}y!=null&&(u==null||u(),r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,"add_device_begin"),t(y,c))}l.default=e}),98);
__d("updateUpsellsStateInRelayStore",["CometRelay","FBLogger"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.environment,n=e.updateValue;o("CometRelay").commitLocalUpdate(t,function(e){var t=e.getRoot().getLinkedRecord("viewer");if(t==null){r("FBLogger")("wmi_eb").mustfix("[labyrinth][upsells] A viewer record does not exist when updating upsell state.");return}t.setValue(n,"is_eb_restore_upsells_dismissed")})}l.default=e}),98);
__d("useEncryptedBackupsQplImpressionRef",["QPLUserFlow","react-compiler-runtime","useVisibilityObserver"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n,a){var i=o("react-compiler-runtime").c(5),l;return i[0]!==a||i[1]!==e||i[2]!==n||i[3]!==t?(l={onVisible:function(){r("QPLUserFlow").addPoint(e,t,{instanceKey:n}),a==null||a()}},i[0]=a,i[1]=e,i[2]=n,i[3]=t,i[4]=l):l=i[4],r("useVisibilityObserver")(l)}l.default=e}),98);
__d("useMWChatEncryptedBackupsAddDevice",["EBMainThreadEBDBApiDeferred","EBSMAPI","FBLogger","getErrorSafe","react","react-compiler-runtime","requireDeferred","useAsyncReStore"],(function(t,n,r,o,a,i,l){"use strict";var e=["onStart"],s,u=s||(s=o("react")),c=u.useCallback,d=u.useRef,m=u.useState,p=r("requireDeferred")("MAWEncryptedBackupsClearRecoveryCode").__setRef("useMWChatEncryptedBackupsAddDevice"),_=r("requireDeferred")("mwEBAddDevice").__setRef("useMWChatEncryptedBackupsAddDevice");function f(t){var n=o("react-compiler-runtime").c(12),a=t.environment,i=t.hsmFleetMigrationResetPIN,l=t.onComplete,s=t.onFailure,u=t.onInvalidRecoveryCode,c=t.onStart,f=m(!1),C=f[0],b=f[1],v;n[0]===Symbol.for("react.memo_cache_sentinel")?(v=function(){b(!1)},n[0]=v):v=n[0];var S=v,R=r("useAsyncReStore")(),L=d(""),E;n[1]!==R||n[2]!==a||n[3]!==i||n[4]!==l||n[5]!==s||n[6]!==u||n[7]!==c?(E=async function(n,o){L.current=o||"";try{var t=await Promise.all([R,p.load(),_.load()]),d=t[0],m=t[1],f=t[2],C=m.encryptedBackupsClearRecoveryCode,v=f.EBAddDevice;await C(d);var E={onFailure:function(t){S(),s(t)},onInvalidRecoveryCode:function(){S(),u()},onStart:function(){b(!0),c==null||c()},onSuccess:function(){r("EBSMAPI").fetchBackupIds("useMWChatEncryptedBackupsAddDevice").catch(y),S(),l(),i&&L.current!==""&&i(L.current)},recoveryCode:n,storage:d};E.onStart();var k=E.onStart,I=babelHelpers.objectWithoutPropertiesLoose(E,e);await v(babelHelpers.extends({},I,{environment:a,trackAddingDevice:h,trackOverprompting:g}))}catch(e){var T=e,D=r("getErrorSafe")(T);r("FBLogger")("wmi_eb").tags(["pin_restore","add_device_error"]).catching(D).warn("Error in addDevice"),S(),s("add_device_error")}},n[1]=R,n[2]=a,n[3]=i,n[4]=l,n[5]=s,n[6]=u,n[7]=c,n[8]=E):E=n[8];var k=E,I;return n[9]!==C||n[10]!==k?(I=[k,C],n[9]=C,n[10]=k,n[11]=I):I=n[11],I}function g(e){return o("EBMainThreadEBDBApiDeferred").trackOverprompting(e)}function h(){return o("EBMainThreadEBDBApiDeferred").addNewDevice()}function y(e){var t=r("getErrorSafe")(e);r("FBLogger")("wmi_eb").tags(["pin_restore","fetch_backup_ids_error"]).catching(t).warn("Error in fetchBackupIds")}l.default=f}),98);
__d("useMWChatEncryptedBackupsNumericCode",["fbt","FBLogger","FocusRegion.react","MWChatEncrypedBackupsNumericCodeKeyTypes","MWChatEncrypedBackupsNumericCodeValidation","MWLogInteraction","focusScopeQueries","getMWChatEncryptedBackupsPinCodeInvalidKeyPressedError","gkx","promiseDone","react"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e,d=c.useRef,m=c.useState,p={confirmPin:s._(/*BTDS*/"Confirm your PIN"),otc:s._(/*BTDS*/"One-time code"),pin:s._(/*BTDS*/"PIN")};function _(e){var t=e.ariaDescribedBy,n=e.checkPreviouslyInsertedCode,a=e.clearInputOnComplete,i=a===void 0?!1:a,l=e.enableMasking,s=e.errorId,u=e.focusRegionId,c=e.inputSize,_=e.isMismatchError,f=e.onChange,g=e.onComplete,h=e.type,y=m(!1),C=y[0],b=y[1],v=m(!0),S=v[0],R=v[1],L=m(""),E=L[0],k=L[1],I=m(null),T=I[0],D=I[1],x=d(!1),$=function(t){D(null),R(!t)},P=async function(t){if(o("MWChatEncrypedBackupsNumericCodeValidation").numericCodeIsCompleted(t,c)){if(x.current&&(r("FBLogger")("wmi_eb").info("onPinCodeSetup already executing, allowing duplicate call for observation"),r("gkx")("19490")))return;if(x.current=!0,o("MWLogInteraction").logPopoverOpenCancel("initiate_restore"),n!=null){var e=n.onCodeMismatch,a=n.previouslyInsertedCode,l=a===t;if(!l){x.current=!1,e();return}}R(!0),b(!0);try{await g(t),i&&k("")}catch(e){k("")}finally{b(!1),x.current=!1}}},N=n!=null&&h==="pin"?"confirmPin":h,M=r("getMWChatEncryptedBackupsPinCodeInvalidKeyPressedError")(T,h),w=s!=null&&_===!0;return[{"aria-describedby":w?s:t,"aria-label":p[N],disabled:C,enableMasking:l,focusRegionId:u,isError:w,onChange:function(t){var e=function(){o("MWChatEncrypedBackupsNumericCodeValidation").numericCodeIsValid(t,c)&&(k(t),D(null),f==null||f(t),r("promiseDone")(P(t)))};e()},onCompletionChange:$,onEnabledNumLock:function(){T===o("MWChatEncrypedBackupsNumericCodeKeyTypes").InvalidKeyType.NUM_PAD_WITHOUT_NUM_LOCK&&D(null)},onPressedInvalidKey:function(t){(t===o("MWChatEncrypedBackupsNumericCodeKeyTypes").InvalidKeyType.NON_NUMERIC_CHAR||t===o("MWChatEncrypedBackupsNumericCodeKeyTypes").InvalidKeyType.NUM_PAD_WITHOUT_NUM_LOCK)&&D(t)},size:c,value:E},{clearNumericInput:function(){return k("")},disabled:S,focusOnInput:function(){o("FocusRegion.react").focusRegionById(u,o("focusScopeQueries").tabbableScopeQuery)},invalidKeyPressedError:M,isLoading:C}]}l.useMWChatEncryptedBackupsNumericCode=_}),226);
__d("useMWEBFlowSourceContext",["FBLogger","MWChatEncryptedBackupsQPLSource.enum","MWEBFlowSourceContext","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.useCallback,c=s.useContext;function d(){var e=o("react-compiler-runtime").c(2),t=c(r("MWEBFlowSourceContext")),n=t.source,a;return e[0]!==n?(a=function(){return n==null?(r("FBLogger")("wmi_eb").mustfix("[labyrinth][web] source is null. Did you wrap your flow with MWEBFlowSourceContextProvider?"),r("MWChatEncryptedBackupsQPLSource.enum").UNKNOWN):n},e[0]=n,e[1]=a):a=e[1],a}l.default=d}),98);
__d("useMWChatEncryptedBackupsPinCodeRestore",["CometRelay","EBSMGatingUI","JSResourceForInteraction","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsSetIsDialogPersistedContext","MWEBODSEntityName.enum","MWEBPinCodeSize","MWEBUpsellDismissedEnum.facebook","MWEncryptedBackupsLocalStorageEntryEnum","QPLUserFlow","promiseDone","react","react-compiler-runtime","requireDeferred","useLabyrinthLogging","useMWChatEncryptedBackupsAddDevice","useMWChatEncryptedBackupsNumericCode","useMWEBFlowSourceContext","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=s||(s=o("react")),c=u.useCallback,d=u.useContext,m=u.useEffect,p=u.useRef,_=u.useState,f=r("requireDeferred")("MWEBUseLocalStorage").__setRef("useMWChatEncryptedBackupsPinCodeRestore"),g=r("requireDeferred")("MWEncryptedBackupsSharedState").__setRef("useMWChatEncryptedBackupsPinCodeRestore"),h=r("requireDeferred")("mwEBGetPINSecretFromVesta").__setRef("useMWChatEncryptedBackupsPinCodeRestore"),y=r("requireDeferred")("updateUpsellsStateInRelayStore").__setRef("useMWChatEncryptedBackupsPinCodeRestore"),C=r("JSResourceForInteraction")("MWEncryptedBackupsHsmFleetMigrationGated").__setRef("useMWChatEncryptedBackupsPinCodeRestore");function b(t){var n=o("react-compiler-runtime").c(47),a=t.clientID,i=t.focusRegionId,l=t.onSubmitPin,s=t.onSubmitPinFailure,u=t.onVestaComplete,c=o("CometRelay").useRelayEnvironment(),b=_(!1),S=b[0],R=b[1],L=_(!1),E=L[0],k=L[1],I=_(!1),T=I[0],D=I[1],x=p(!1),$=o("useLabyrinthLogging").useLabyrinthLoggingFlow(),P=$.startFlow,N=(e||(e=r("useReStore")))(),M=r("useMWEBFlowSourceContext")(),w=_(!1),A=w[0],F=w[1],O=d(r("MWChatEncryptedBackupsSetIsDialogPersistedContext")).setIsDialogPersisted,B;n[0]!==N||n[1]!==c||n[2]!==P?(B=function(t){r("promiseDone")(C.load().then(function(e){e({db:N,environment:c,pinCode:t,startFlow:P})}))},n[0]=N,n[1]=c,n[2]=P,n[3]=B):B=n[3];var W=B,q;n[4]!==N||n[5]!==c||n[6]!==u?(q=function(){var e;r("QPLUserFlow").addPoint((e=o("MWChatEncryptedBackupsQPLEvents")).restoreDeviceAuthQplEvent,"add_device_success"),r("QPLUserFlow").addPoint(e.restoreQplEvent,"restore_auth_finished_and_dismissed"),g.onReady(function(e){var t=e.upsertEBSharedStateEntry;r("promiseDone")(t({db:N,stateKey:r("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_RESTORED_SUCCESSFULLY}))}),f.onReady(v),o("MWChatEncryptedBackupsLogging").endSuccess({annotations:{bool:{is_backend_setup:o("EBSMGatingUI").isBackendSetupSuccessfulForEBSM()}},event:e.restoreQplEvent}),o("MWChatEncryptedBackupsLogging").endSuccess({event:e.restoreDeviceAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH}),u(),F(!1),r("promiseDone")(y.load(),function(e){e({environment:c,updateValue:o("MWEBUpsellDismissedEnum.facebook").MWEBUpsellDismissedStateEnum.UPSELLS_DISMISSED})})},n[4]=N,n[5]=c,n[6]=u,n[7]=q):q=n[7];var U=q,V;n[8]!==c||n[9]!==s||n[10]!==O?(V=function(t){s==null||s(),x.current=!0,k(!0),F(!1),r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,t),o("MWChatEncryptedBackupsLogging").endFailure({errorName:t,event:o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH}),r("promiseDone")(y.load(),function(e){e({environment:c,updateValue:o("MWEBUpsellDismissedEnum.facebook").MWEBUpsellDismissedStateEnum.NOT_DISMISSED})}),O==null||O(!1)},n[8]=c,n[9]=s,n[10]=O,n[11]=V):V=n[11];var H=V,G;n[12]!==c||n[13]!==s||n[14]!==O?(G=function(){s==null||s(),x.current=!0,k(!0),F(!1),o("MWChatEncryptedBackupsLogging").endFailure({errorName:"pin_code_restore_wrong_recovery_code",event:o("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:r("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH}),r("QPLUserFlow").addPoint(o("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"pin_code_restore_wrong_recovery_code"),r("promiseDone")(y.load(),function(e){e({environment:c,updateValue:o("MWEBUpsellDismissedEnum.facebook").MWEBUpsellDismissedStateEnum.NOT_DISMISSED})}),O==null||O(!1)},n[12]=c,n[13]=s,n[14]=O,n[15]=G):G=n[15];var z=G,j;n[16]!==c||n[17]!==W||n[18]!==U||n[19]!==H||n[20]!==z?(j={environment:c,hsmFleetMigrationResetPIN:W,onComplete:U,onFailure:H,onInvalidRecoveryCode:z},n[16]=c,n[17]=W,n[18]=U,n[19]=H,n[20]=z,n[21]=j):j=n[21];var K=r("useMWChatEncryptedBackupsAddDevice")(j),Q=K[0],X;n[22]===Symbol.for("react.memo_cache_sentinel")?(X=function(){k(!1),D(!1),R(!1)},n[22]=X):X=n[22];var Y;n[23]!==Q||n[24]!==a||n[25]!==c||n[26]!==M||n[27]!==l||n[28]!==s||n[29]!==O||n[30]!==P?(Y=async function(t){var e=await h.load();await e({addDevice:Q,clientID:a,environment:c,getSourceFromContext:M,onSubmitPin:l,onSubmitPinFailure:s,onVestaSecretFetch:function(){O==null||O(!0)},pinCode:t,productUseCase:"MSGR_ENC_BACKUP",setIsInProgress:F,setIsPinCodeIncorrect:R,setIsVestaError:D,startFlow:P})},n[23]=Q,n[24]=a,n[25]=c,n[26]=M,n[27]=l,n[28]=s,n[29]=O,n[30]=P,n[31]=Y):Y=n[31];var J;n[32]!==i||n[33]!==Y?(J={enableMasking:!0,focusRegionId:i,inputSize:o("MWEBPinCodeSize").EB_PIN_CODE_SIZE,onChange:X,onComplete:Y,type:"pin"},n[32]=i,n[33]=Y,n[34]=J):J=n[34];var Z=o("useMWChatEncryptedBackupsNumericCode").useMWChatEncryptedBackupsNumericCode(J),ee=Z[0],te=Z[1],ne=te.clearNumericInput,re=te.disabled,oe=te.focusOnInput,ae=te.invalidKeyPressedError,ie,le;n[35]!==ne?(ie=function(){x.current&&(ne(),x.current=!1)},le=[ne],n[35]=ne,n[36]=ie,n[37]=le):(ie=n[36],le=n[37]),m(ie,le);var se=re!=null?re:!1,ue;return n[38]!==oe||n[39]!==ee||n[40]!==ae||n[41]!==A||n[42]!==E||n[43]!==S||n[44]!==T||n[45]!==se?(ue={focusOnInput:oe,inputProps:ee,invalidKeyPressedError:ae,isDisabled:se,isInProgress:A,isLabyrinthError:E,isPinCodeIncorrect:S,isVestaError:T},n[38]=oe,n[39]=ee,n[40]=ae,n[41]=A,n[42]=E,n[43]=S,n[44]=T,n[45]=se,n[46]=ue):ue=n[46],ue}function v(e){var t=e.mwEBCreateLocalStorageEntry,n=e.mwEBDeleteLocalStorageEntry;t(r("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION),t(r("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION_2),n(r("MWEncryptedBackupsLocalStorageEntryEnum").EBSM_CORRUPTION_WIPE)}l.useMWChatEncryptedBackupsPinCodeRestore=b}),98);
__d("useMWEBSetHasSeenNoticeMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="9618790408209960"}),null);
__d("useMWEBSetHasSeenNoticeMutation.graphql",["useMWEBSetHasSeenNoticeMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{alias:null,args:null,concreteType:"SetHasSeenEbAutoRestoreNoticeResponsePayload",kind:"LinkedField",name:"set_has_seen_eb_auto_restore_notice",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useMWEBSetHasSeenNoticeMutation",selections:e,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"useMWEBSetHasSeenNoticeMutation",selections:e},params:{id:n("useMWEBSetHasSeenNoticeMutation_facebookRelayOperation"),metadata:{},name:"useMWEBSetHasSeenNoticeMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("useMWEBSetHasSeenNotice",["CometRelay","react","react-compiler-runtime","useMWEBSetHasSeenNoticeMutation.graphql"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(s||(s=o("react"))).useCallback;function c(){var t=o("react-compiler-runtime").c(3),r;t[0]===Symbol.for("react.memo_cache_sentinel")?(r=e!==void 0?e:e=n("useMWEBSetHasSeenNoticeMutation.graphql"),t[0]=r):r=t[0];var a=o("CometRelay").useMutation(r),i=a[0],l;return t[1]!==i?(l=function(){i({variables:{}})},t[1]=i,t[2]=l):l=t[2],l}l.default=c}),98);/*FB_PKG_DELIM*/
__d("BizKitScopingContext",["emptyFunction","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.createContext({assets:[],businessUnifiedMultiAssetScopingSelectorQueryReference:null,globalScope:null,setAssets:r("emptyFunction"),setGlobalScope:r("emptyFunction")});u.displayName="BizKitScopingContext";var c=u;l.default=c}),98);
__d("BusinessAssetTypeEnum.facebook",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum").Mirrored(["ADS_EVENT_SOURCE","ADVANCED_ANALYTICS_INSTANCE","AD_ACCOUNT","AD_ACCOUNT_CREATION_REQUEST","AD_DRAFT_WORKSPACE","AD_IMAGE","AD_STUDY","APP","BANK","BIZ_AI_BILLABLE_ACCOUNT","BLOCK_LIST","BRAND","BUSINESS_CREATIVE_ASSET","BUSINESS_CREATIVE_FOLDER","BUSINESS_FRANCHISE_CONFIG","BUSINESS_IMAGE","BUSINESS_LOCATIONS_WRAPPER","BUSINESS_LOYALTY_PROGRAM","BUSINESS_PAYOUT_ACCOUNT","BUSINESS_PERSON","BUSINESS_REQUEST","BUSINESS_RESOURCE_GROUP","BUSINESS_UNIT","BUSINESS_VIDEO","CAIPT_ASSET","CLOUD_PLAYABLE_ASSET","CONTENT_BLOCK_LIST","CREATOR_MARKETPLACE_BRAND_PROFILE","CREATOR_SELLER_PROFILE","CREDENTIAL_SHARE_REQUEST","CREDIT_CARD","CREDIT_PARTITION","CREDIT_PARTITION_CONFIG","CUSTOM_AUDIENCE","CUSTOM_CONVERSION","DYNAMIC_CONTENT_SET","EVENTS_DATASET","EVENTS_DATASET_AND_PIXEL","EVENTS_DATASET_NEW","EVENT_SOURCE_GROUP","EXAMPLE_CAT","FINANCE","FUNDING_SOURCE","GRP_PLAN","HOTEL_PRICE_FETCHER_PULL_CONFIG","INSTAGRAM_ACCOUNT","INSTAGRAM_ACCOUNT_V2","INSTAGRAM_BUSINESS_ASSET","IP","LEADS_ACCESS","LEGACY_LOGIN","LEGAL_ENTITY","MARKETPLACE_PARTNER_BILLABLE_ACCOUNT","MESSAGING_DATASET","MONETIZATION_PROPERTY","MV4B_BILLABLE_ACCOUNT","NEWS_PAGE","NME_BUSINESS_SUBSCRIPTION_ASSET","OFFLINE_CONVERSION_DATA_SET","OFFSITE_EMAIL_ACCOUNT","OWNED_DOMAIN","PAGE","PAGE_FOR_LOCATIONS","PAYOUT_ACCOUNT","PHOTO","PIXEL","PLACE_PAGE_SET","PLATFORM_CUSTOM_AUDIENCE","PRODUCT_CATALOG","PROFILE_PLUS","PROJECT","PUBLISHER_WHITE_LIST","RECEIPT","REGISTERED_TRADEMARK","RESELLER_VETTING_OE_REQUEST","SAVED_AUDIENCE","SELLER_PROFILE","SIGNALS_EVENT_NAME","SIGNAL_SEGMENT","SLICED_EVENT_SOURCE_GROUP","SPACO_DS_DATA_COLLECTION","SYSTEM_USER","THREADS_ACCOUNT","UNKNOWN","USER","VIDEO_ASSET","WHATSAPP_BUSINESS_ACCOUNT","WHATSAPP_BUSINESS_PRESENCE","WHATSAPP_MARKETING_MESSAGE_SUBSCRIBER_POOL"]),l=e;i.default=l}),66);
__d("FBNucleusMinusCircleOutline20Icon.react",["react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react"));function u(e){return s.jsxs("svg",babelHelpers.extends({viewBox:"0 0 20 20",width:"1em",height:"1em",fill:"currentColor"},e,{children:[e.title!=null&&s.jsx("title",{children:e.title}),e.children!=null&&s.jsx("defs",{children:e.children}),s.jsx("path",{d:"M13.25 10.75a.75.75 0 0 0 0-1.5h-6.5a.75.75 0 0 0 0 1.5h6.5z"}),s.jsx("path",{d:"M10 .5a9.5 9.5 0 1 0 0 19 9.5 9.5 0 0 0 0-19zM2 10a8 8 0 1 1 16 0 8 8 0 0 1-16 0z"})]}))}u.displayName=u.name+" [from "+i.id+"]",u._size=20,u._isSVG=!0;var c=u;l.default=c}),98);
__d("LSOptimisticRemoveThreadStoredProcedure",["LSOptimisticRemoveThread","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSOptimisticRemoveThread"),a.threadKey,a.removeType);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSThreadRemoveType",[],(function(t,n,r,o,a,i){var e=Object.freeze({DELETE_THREAD:0,ARCHIVE_THREAD:1,IGNORE_THREAD:2});i.default=e}),66);
__d("MDSTextConfig",["UserAgent","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e={blueLink:{color:"x1fey0fg",$$css:!0},disabled:{color:"x1dntmbh",$$css:!0},highlight:{color:"x1qq9wsj",$$css:!0},negative:{color:"x1a1m0xk",$$css:!0},positive:{color:"x6u5lvz",$$css:!0},primary:{color:"xzsf02u",$$css:!0},secondary:{color:"xi81zsa",$$css:!0},secondaryOnMedia:{color:"xkxfvhb",$$css:!0},tertiary:{color:"x12scifz",$$css:!0},white:{color:"x14ctfv",$$css:!0}},s={disabledButton:{color:"x1x80s81",$$css:!0},primaryButton:{color:"xtk6v10",$$css:!0},primaryDeemphasizedButton:{color:"x1mvi0mv",$$css:!0},secondaryButton:{color:"x1dem4cn",$$css:!0}},u={blueLink:{color:"x15k1xyk",$$css:!0},disabled:{color:"xc7hbz8",$$css:!0},highlight:{color:"x16uf79r",$$css:!0},negative:{color:"x1unwjcu",$$css:!0},positive:{color:"xxmynsg",$$css:!0},primary:{color:"xw2npq5",$$css:!0},primaryOnMedia:{color:"x8w7gz1",$$css:!0},secondary:{color:"xhgddhk",$$css:!0},secondaryOnMedia:{color:"xzutexd",$$css:!0},tertiary:{color:"xerl464",$$css:!0},white:{color:"xnba3h0",$$css:!0}},c={apple:{MozOsxFontSmoothing:"xlh3980",WebkitFontSmoothing:"xvmahel",fontFamily:"x1n0sxbx",$$css:!0},default:{fontFamily:"x10flsy6",$$css:!0},segoe:{fontFamily:"x1xmvt09",$$css:!0}},d={default:function(t){switch(t){case"body1":return[4,5];case"body2":return[3,5];case"body3":return[4,5];case"body4":return[3,4];case"bodyLink1":return[4,5];case"bodyLink2":return[3,5];case"bodyLink3":return[4,5];case"bodyLink4":return[3,4];case"button1":return[3,5];case"button2":return[4,5];case"entityHeaderHeadline1":return[7,8];case"entityHeaderHeadline2":return[5,7];case"entityHeaderMeta1":return[4,5];case"entityHeaderMeta2":return[4,5];case"entityHeaderMeta3":return[4,3];case"headline3":return[3,5];case"headline4":return[4,5];case"headlineDeemphasized3":return[3,5];case"headlineDeemphasized4":return[4,5];case"headlineEmphasized1":return[5,6];case"headlineEmphasized2":return[4,5];case"headlineEmphasized3":return[3,4];case"headlineEmphasized4":return[4,5];case"headlineEmphasized5":return[3,4];case"meta1":return[3,4];case"meta2":return[3,4];case"meta3":return[3,4];case"meta4":return[3,4]}},segoe:function(t){switch(t){case"body1":return[6,4,1];case"body2":return[5,3,1];case"body3":return[5,4];case"body4":return[4,3,1];case"bodyLink1":return[6,4,1];case"bodyLink2":return[5,3,1];case"bodyLink3":return[5,4];case"bodyLink4":return[4,3,1];case"button1":return[5,3,1];case"button2":return[5,4];case"entityHeaderHeadline1":return[10,6,2];case"entityHeaderHeadline2":return[8,5,3];case"entityHeaderMeta1":return[5,4,1];case"entityHeaderMeta2":return[5,4,1];case"entityHeaderMeta3":return[4,3];case"headline3":return[5,3,1];case"headline4":return[5,4];case"headlineDeemphasized3":return[5,3,1];case"headlineDeemphasized4":return[5,4];case"headlineEmphasized1":return[7,4,2];case"headlineEmphasized2":return[6,4,2];case"headlineEmphasized3":return[5,3,1];case"headlineEmphasized4":return[5,4];case"headlineEmphasized5":return[5,3,1];case"meta1":return[4,3,1];case"meta2":return[4,3,1];case"meta3":return[4,3,1];case"meta4":return[4,3]}},sfGecko:function(t){switch(t){case"body1":return[5,5];case"body2":return[4,4];case"body3":return[5,4];case"body4":return[4,3];case"bodyLink1":return[6,4];case"bodyLink2":return[4,3];case"bodyLink3":return[5,4];case"bodyLink4":return[4,3];case"button1":return[4,3];case"button2":return[5,4];case"entityHeaderHeadline1":return[8,7];case"entityHeaderHeadline2":return[7,5];case"entityHeaderMeta1":return[5,4];case"entityHeaderMeta2":return[5,4];case"entityHeaderMeta3":return[4,3];case"headline3":return[5,3];case"headline4":return[5,4];case"headlineDeemphasized3":return[5,3];case"headlineDeemphasized4":return[5,4];case"headlineEmphasized1":return[6,5];case"headlineEmphasized2":return[6,4];case"headlineEmphasized3":return[4,3];case"headlineEmphasized4":return[5,4];case"headlineEmphasized5":return[4,3];case"meta1":return[4,3];case"meta2":return[4,3];case"meta3":return[4,3];case"meta4":return[4,3]}},sfWebkit:function(t){switch(t){case"body1":return[5,5];case"body2":return[4,4];case"body3":return[4,4];case"body4":return[4,3];case"bodyLink1":return[5,5];case"bodyLink2":return[4,4];case"bodyLink3":return[4,4];case"bodyLink4":return[4,3];case"button1":return[4,4];case"button2":return[4,4];case"entityHeaderHeadline1":return[8,7];case"entityHeaderHeadline2":return[6,6];case"entityHeaderMeta1":return[4,4];case"entityHeaderMeta2":return[4,4];case"entityHeaderMeta3":return[4,3];case"headline3":return[4,4];case"headline4":return[4,4];case"headlineDeemphasized3":return[4,4];case"headlineDeemphasized4":return[4,4];case"headlineEmphasized1":return[6,5];case"headlineEmphasized2":return[5,5];case"headlineEmphasized3":return[4,4];case"headlineEmphasized4":return[4,4];case"headlineEmphasized5":return[4,3];case"meta1":return[4,3];case"meta2":return[4,3];case"meta3":return[4,3];case"meta4":return[3,3]}}},m=(function(){return r("UserAgent").isPlatform("Windows >= 6")?[c.segoe,d.segoe]:r("UserAgent").isPlatform("Mac OS X >= 10.11")&&!r("UserAgent").isBrowser("Firefox < 55")||r("UserAgent").isPlatform("iOS >= 9")?[c.apple,r("UserAgent").isEngine("Gecko")?d.sfGecko:d.sfWebkit]:[c.default,d.default]})(),p=m[0],_=m[1],f={body1:{fontSize:"x1603h9y",fontWeight:"x1fcty0u",$$css:!0},body2:{fontSize:"x1lkfr7t",fontWeight:"x1fcty0u",$$css:!0},body2ForDenseMode:{fontSize:"x1jchvi3",fontWeight:"x1fcty0u",$$css:!0},body3:{fontSize:"x6prxxf",fontWeight:"x1fcty0u",$$css:!0},body3ForDenseMode:{fontSize:"x1f6kntn",fontWeight:"x1fcty0u",$$css:!0},body4:{fontSize:"x1nxh6w3",fontWeight:"x1fcty0u",$$css:!0},body4ForDenseMode:{fontSize:"x1pg5gke",fontWeight:"x1fcty0u",$$css:!0},bodyLink1:{fontSize:"x1603h9y",fontWeight:"x1s688f",$$css:!0},bodyLink2:{fontSize:"x1lkfr7t",fontWeight:"x1s688f",$$css:!0},bodyLink2ForDenseMode:{fontSize:"x1jchvi3",fontWeight:"x1s688f",$$css:!0},bodyLink3:{fontSize:"x6prxxf",fontWeight:"x1s688f",$$css:!0},bodyLink3ForDenseMode:{fontSize:"x1f6kntn",fontWeight:"x1s688f",$$css:!0},bodyLink4:{fontSize:"x1nxh6w3",fontWeight:"x1s688f",$$css:!0},bodyLink4ForDenseMode:{fontSize:"x1pg5gke",fontWeight:"x1s688f",$$css:!0},button1:{fontSize:"x1lkfr7t",fontWeight:"x1s688f",$$css:!0},button1ForDenseMode:{fontSize:"x1jchvi3",fontWeight:"x1s688f",$$css:!0},button2:{fontSize:"x6prxxf",fontWeight:"x1s688f",$$css:!0},button2ForDenseMode:{fontSize:"x1f6kntn",fontWeight:"x1s688f",$$css:!0},entityHeaderHeadline1:{fontSize:"x579bpy",fontWeight:"x1xlr1w8",$$css:!0},entityHeaderHeadline2:{fontSize:"x1q74xe4",fontWeight:"x1xlr1w8",$$css:!0},entityHeaderMeta1:{fontSize:"x6prxxf",fontWeight:"x1xlr1w8",$$css:!0},entityHeaderMeta1ForDenseMode:{fontSize:"x1f6kntn",fontWeight:"x1xlr1w8",$$css:!0},entityHeaderMeta2:{fontSize:"x6prxxf",fontWeight:"x1xlr1w8",$$css:!0},entityHeaderMeta2ForDenseMode:{fontSize:"x1f6kntn",fontWeight:"x1xlr1w8",$$css:!0},entityHeaderMeta3:{fontSize:"x1nxh6w3",fontWeight:"x1xlr1w8",$$css:!0},headline3:{fontSize:"x1lkfr7t",fontWeight:"xk50ysn",$$css:!0},headline3ForDenseMode:{fontSize:"x1jchvi3",fontWeight:"xk50ysn",$$css:!0},headline4:{fontSize:"x6prxxf",fontWeight:"xk50ysn",$$css:!0},headline4ForDenseMode:{fontSize:"x1f6kntn",fontWeight:"xk50ysn",$$css:!0},headlineEmphasized1:{fontSize:"xngnso2",fontWeight:"x1xlr1w8",$$css:!0},headlineEmphasized2:{fontSize:"x1603h9y",fontWeight:"x1xlr1w8",$$css:!0},headlineEmphasized3:{fontSize:"x1lkfr7t",fontWeight:"x1s688f",$$css:!0},headlineEmphasized3ForDenseMode:{fontSize:"x1jchvi3",fontWeight:"x1s688f",$$css:!0},headlineEmphasized4:{fontSize:"x6prxxf",fontWeight:"x1s688f",$$css:!0},headlineEmphasized4ForDenseMode:{fontSize:"x1f6kntn",fontWeight:"x1s688f",$$css:!0},headlineEmphasized5:{fontSize:"x6prxxf",fontWeight:"xk50ysn",$$css:!0},meta1:{fontSize:"x1nxh6w3",fontWeight:"x1s688f",$$css:!0},meta1ForDenseMode:{fontSize:"x1pg5gke",fontWeight:"x1s688f",$$css:!0},meta2:{fontSize:"x1nxh6w3",fontWeight:"x1s688f",$$css:!0},meta2ForDenseMode:{fontSize:"x1pg5gke",fontWeight:"x1s688f",$$css:!0},meta3:{fontSize:"x1nxh6w3",fontWeight:"x1fcty0u",$$css:!0},meta3ForDenseMode:{fontSize:"x1pg5gke",fontWeight:"x1fcty0u",$$css:!0},meta4:{fontSize:"x1pg5gke",fontWeight:"x1fcty0u",$$css:!0},meta4ForDenseMode:{fontSize:"x1pg5gke",fontWeight:"x1fcty0u",$$css:!0}},g=r("gkx")("5751"),h={colors:{blueLink:g?u.blueLink:e.blueLink,disabled:g?u.disabled:e.disabled,disabledButton:s.disabledButton,highlight:g?u.highlight:e.highlight,negative:g?u.negative:e.negative,positive:g?u.positive:e.positive,primary:g?u.primary:e.primary,primaryButton:s.primaryButton,primaryDeemphasizedButton:s.primaryDeemphasizedButton,primaryOnMedia:g?u.primaryOnMedia:void 0,secondary:g?u.secondary:e.secondary,secondaryButton:s.secondaryButton,secondaryOnMedia:g?u.secondaryOnMedia:e.secondaryOnMedia,tertiary:g?u.tertiary:e.tertiary,white:g?u.white:e.white},defaultFontFamily:p,offsets:_,styles:{body1:{lineHeight:24,style:f.body1},body2:{lineHeight:20,style:f.body2},body3:{lineHeight:19.9995,style:f.body3},body4:{lineHeight:16,style:f.body4},bodyLink1:{lineHeight:24,style:f.bodyLink1},bodyLink2:{lineHeight:20,style:f.bodyLink2},bodyLink3:{lineHeight:19.9995,style:f.bodyLink3},bodyLink4:{lineHeight:16,style:f.bodyLink4},button1:{lineHeight:20,style:f.button1},button2:{lineHeight:19.9995,style:f.button2},entityHeaderHeadline1:{lineHeight:38,style:f.entityHeaderHeadline1},entityHeaderHeadline2:{lineHeight:32,style:f.entityHeaderHeadline2},entityHeaderMeta1:{lineHeight:19,style:f.entityHeaderMeta1},entityHeaderMeta2:{lineHeight:19,style:f.entityHeaderMeta2},entityHeaderMeta3:{lineHeight:17,style:f.entityHeaderMeta3},headline3:{lineHeight:20,style:f.headline3},headline4:{lineHeight:19.9995,style:f.headline4},headlineEmphasized1:{lineHeight:28,style:f.headlineEmphasized1},headlineEmphasized2:{lineHeight:24,style:f.headlineEmphasized2},headlineEmphasized3:{lineHeight:20,style:f.headlineEmphasized3},headlineEmphasized4:{lineHeight:19.9995,style:f.headlineEmphasized4},headlineEmphasized5:{lineHeight:20,style:f.headlineEmphasized5},meta1:{lineHeight:16,style:f.meta1},meta2:{lineHeight:16,style:f.meta2},meta3:{lineHeight:16,style:f.meta3},meta4:{lineHeight:15,style:f.meta4}},stylesForDenseMode:{body2:{lineHeight:20,style:f.body2ForDenseMode},body3:{lineHeight:20,style:f.body3ForDenseMode},body4:{lineHeight:16,style:f.body4ForDenseMode},bodyLink2:{lineHeight:20,style:f.bodyLink2ForDenseMode},bodyLink3:{lineHeight:20,style:f.bodyLink3ForDenseMode},bodyLink4:{lineHeight:16,style:f.bodyLink4ForDenseMode},button1:{lineHeight:18,style:f.button1ForDenseMode},button2:{lineHeight:18,style:f.button2ForDenseMode},entityHeaderMeta1:{lineHeight:18,style:f.entityHeaderMeta1ForDenseMode},entityHeaderMeta2:{lineHeight:18,style:f.entityHeaderMeta2ForDenseMode},headline3:{lineHeight:20,style:f.headline3ForDenseMode},headline4:{lineHeight:20,style:f.headline4ForDenseMode},headlineEmphasized3:{lineHeight:20,style:f.headlineEmphasized3ForDenseMode},headlineEmphasized4:{lineHeight:20,style:f.headlineEmphasized4ForDenseMode},meta1:{lineHeight:14,style:f.meta1ForDenseMode},meta2:{lineHeight:14,style:f.meta2ForDenseMode},meta3:{lineHeight:14,style:f.meta3ForDenseMode},meta4:{lineHeight:15,style:f.meta4ForDenseMode}}},y=h;l.default=y}),98);
__d("useXPlatReactTranslationKeyForTextParent",["cr:2099"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){}var u=(e=n("cr:2099"))!=null?e:{useTranslationKeyForTextParent:s},c=u.useTranslationKeyForTextParent;function d(){return c()}l.default=d}),98);
__d("MDSTextImpl.react",["BaseHeading.react","BaseText.react","BaseTextContext","CometDensityModeContext","JSResourceForInteraction","MDSTextConfig","react","react-compiler-runtime","useXPlatReactTranslationKeyForTextParent","xplatToDOMRef"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e,c=u.useContext,d=u.useMemo,m=r("JSResourceForInteraction")("MDSTooltipImpl.react").__setRef("MDSTextImpl.react"),p=o("BaseText.react").createBaseTextComponent(r("MDSTextConfig"),m),_={heading:{maxWidth:"x193iq5w",minWidth:"xeuugli",$$css:!0},text:{whiteSpace:"xq9mrsl",$$css:!0}},f={disabled:"disabledButton",highlight:"primaryDeemphasizedButton",secondary:"secondaryButton",white:"primaryButton"};function g(e,t){var n;return t&&(n=f[e])!=null?n:e}var h=["entityHeaderMeta1","entityHeaderMeta2","meta1","meta2","meta3","meta4"];function y(e){var t=o("react-compiler-runtime").c(25),n=e.ref,a=e.align,i=e.children,l=e.color,u=e.dir,d=e.id,m=e.isPrimaryHeading,f=e.isSemanticHeading,y=e.numberOfLines,C=e.showTruncationTooltip,b=e.testid,v=e.truncationTooltip,S=e.type,R=a===void 0?"auto":a,L=u===void 0?"auto":u,E=m===void 0?!1:m,k=f===void 0?!1:f,I=C===void 0?!0:C,T=h.includes(S)?"secondary":"primary",D=l!=null?l:T,x=S==="button1"||S==="button2",$;t[0]!==D||t[1]!==x?($=g(D,x),t[0]=D,t[1]=x,t[2]=$):$=t[2];var P=$,N=r("useXPlatReactTranslationKeyForTextParent")(),M=o("BaseTextContext").useBaseTextContext(),w=c(r("CometDensityModeContext")),A=w[0],F=(M==null?void 0:M.nested)===!0,O=R!=null?R:void 0,B=F?void 0:L,W=y||0,q;t[3]!==n?(q=o("xplatToDOMRef").xplatToDOMRef(n),t[3]=n,t[4]=q):q=t[4];var U;t[5]!==i||t[6]!==I||t[7]!==v?(U=I?{tooltip:v!=null?v:i}:void 0,t[5]=i,t[6]=I,t[7]=v,t[8]=U):U=t[8];var V;t[9]!==i||t[10]!==P||t[11]!==d||t[12]!==A||t[13]!==N||t[14]!==B||t[15]!==W||t[16]!==q||t[17]!==U||t[18]!==O||t[19]!==b||t[20]!==S?(V=s.jsx(p,{alignment:O,colorName:P,dir:B,id:d,isDenseModeEnabled:A,lines:W,ref:q,styleName:S,testid:void 0,truncationTooltip:U,xstyle:_.text,children:i},N),t[9]=i,t[10]=P,t[11]=d,t[12]=A,t[13]=N,t[14]=B,t[15]=W,t[16]=q,t[17]=U,t[18]=O,t[19]=b,t[20]=S,t[21]=V):V=t[21];var H=V;if(k||E){var G;return t[22]!==E||t[23]!==H?(G=s.jsx(r("BaseHeading.react"),{isPrimaryHeading:E,xstyle:_.heading,children:H}),t[22]=E,t[23]=H,t[24]=G):G=t[24],G}return H}y.displayName="MDSText",l.default=y}),98);
__d("MDSText.react",["MDSTextImpl.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e=["ref"],s,u=s||(s=o("react"));function c(t){var n=o("react-compiler-runtime").c(6),a,i;n[0]!==t?(i=t.ref,a=babelHelpers.objectWithoutPropertiesLoose(t,e),n[0]=t,n[1]=a,n[2]=i):(a=n[1],i=n[2]);var l;return n[3]!==a||n[4]!==i?(l=u.jsx(r("MDSTextImpl.react"),babelHelpers.extends({ref:i},a)),n[3]=a,n[4]=i,n[5]=l):l=n[5],l}l.default=c}),98);
__d("MDSButtonImpl.react",["BaseStyledButton.react","BaseTheme.react","CometContainerPressableContext","FDSIcon.react","MDSText.react","emptyFunction","gkx","mergeRefs","react"],(function(t,n,r,o,a,i,l){"use strict";var e=["ref"],s=["addOnStart","disabled","icon","isContainerTarget","label","labelIsHidden","linkProps","onFocusIn","onFocusOut","onHoverIn","onHoverOut","onPress","onPressIn","onPressOut","padding","reduceEmphasis","size","suppressHydrationWarning","testid","type"],u,c=u||(u=o("react")),d=u,m=d.useContext,p=d.useEffect,_=d.useRef,f={destructive:{backgroundColor:"xb4tp27",$$css:!0},disabled:{backgroundColor:"xwcfey6",$$css:!0},primary:{backgroundColor:"xtvsq51",$$css:!0},primaryDeemphasized:{backgroundColor:"x1hr4nm9",$$css:!0},secondary:{backgroundColor:"x1qhmfi1",$$css:!0},secondaryDeemphasized:{backgroundColor:"x1f3278h",$$css:!0},secondaryDeemphasized_DEPRECATED:{backgroundColor:"xjbqb8w",$$css:!0},sizeLarge:{height:"xc9qbxq",$$css:!0},sizeMedium:{height:"x10w6t97",$$css:!0},sizeSmall:{borderStartStartRadius:"xbjudin",borderStartEndRadius:"xnlwouz",borderEndEndRadius:"xpp8er5",borderEndStartRadius:"xs9wviy",height:"x1fgtraw",$$css:!0}},g={dark:{"destructive-button-background":"rgba(235, 52, 52, 100)","disabled-button-background":"var(--secondary-button-background)","disabled-button-text":"rgba(155, 160, 168, 0.5)","primary-button-background":"#429AFF","secondary-button-background":"rgba(255, 255, 255, 0.19)"},light:{"destructive-button-background":"rgba(255, 41, 41, 100)","disabled-button-background":"var(--secondary-button-background)","disabled-button-text":"rgba(134, 142, 153, 0.5)","primary-button-background":"#0A7CFF","secondary-button-background":"rgba(0, 0, 0, 0.04)"},type:"VARIABLES"},h={":deemphasized":{iconColor:"highlight",textColor:"highlight"},":disabled":{iconColor:"disabled",textColor:"disabled"},iconColor:"white",textColor:"white"},y={":deemphasized":{iconColor:"highlight",textColor:"highlight"},":disabled":{iconColor:"disabled",textColor:"disabled"},iconColor:"primary",textColor:"secondary"};function C(e){switch(e){case"secondary":return y;case"destructive":case"primary":default:return h}}function b(e,t){var n=t.disabled,r=t.reduceEmphasis,o=C(e);return(n?o[":disabled"]:null)||(r?o[":deemphasized"]:null)||o}function v(t){var n,o=t.ref,a=babelHelpers.objectWithoutPropertiesLoose(t,e),i=a.addOnStart,l=a.disabled,u=l===void 0?!1:l,d=a.icon,h=a.isContainerTarget,y=h===void 0?!1:h,C=a.label,v=a.labelIsHidden,S=v===void 0?!1:v,R=a.linkProps,L=a.onFocusIn,E=a.onFocusOut,k=a.onHoverIn,I=a.onHoverOut,T=a.onPress,D=a.onPressIn,x=a.onPressOut,$=a.padding,P=$===void 0?"normal":$,N=a.reduceEmphasis,M=N===void 0?!1:N,w=a.size,A=w===void 0?32:w,F=a.suppressHydrationWarning,O=F===void 0?!1:F,B=a.testid,W=a.type,q=W===void 0?"primary":W,U=babelHelpers.objectWithoutPropertiesLoose(a,s),V=b(q,{disabled:u,reduceEmphasis:M}),H=V.iconColor,G=V.textColor,z=_(null),j=_(null),K=m(r("CometContainerPressableContext"));return p(function(){y&&K&&K.onMount({onContextMenu:r("emptyFunction"),onPress:function(t){var e=z.current;e&&e.click()},target:R==null?void 0:R.target,url:R==null?void 0:R.url},j)},[K,y,R==null?void 0:R.url,R==null?void 0:R.target]),c.jsx(r("BaseTheme.react"),{config:r("gkx")("5751")?void 0:g,style:{width:"100%"},children:c.jsx(r("BaseStyledButton.react"),babelHelpers.extends({},U,{addOnStart:i,"aria-label":(n=U["aria-label"])!=null?n:C,content:S?null:c.jsx(r("MDSText.react"),{color:G,numberOfLines:1,type:"button2",children:C}),contentXstyle:[A===28&&f.sizeSmall,A===32&&f.sizeMedium,A===36&&f.sizeLarge],disabled:u,icon:d==null?null:c.jsx(r("FDSIcon.react"),{color:H,icon:d,size:24}),linkProps:R,onFocusIn:L,onFocusOut:E,onHoverIn:k,onHoverOut:I,onPress:T,onPressIn:D,onPressOut:x,padding:P,ref:r("mergeRefs")(z,o),suppressHydrationWarning:O,testid:void 0,xstyle:[q==="primary"&&f.primary,q==="secondary"&&f.secondary,q==="destructive"&&f.destructive,q==="secondary"&&M?r("gkx")("5751")?f.secondaryDeemphasized:f.secondaryDeemphasized_DEPRECATED:null,q==="primary"&&M&&f.primaryDeemphasized,u&&f.disabled]}))})}v.displayName=v.name+" [from "+i.id+"]",l.default=v}),98);
__d("MDSButton.react",["MDSButtonImpl.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e=["ref"],s,u=s||(s=o("react"));function c(t){var n=o("react-compiler-runtime").c(6),a,i;n[0]!==t?(a=t.ref,i=babelHelpers.objectWithoutPropertiesLoose(t,e),n[0]=t,n[1]=a,n[2]=i):(a=n[1],i=n[2]);var l;return n[3]!==a||n[4]!==i?(l=u.jsx(r("MDSButtonImpl.react"),babelHelpers.extends({ref:a},i)),n[3]=a,n[4]=i,n[5]=l):l=n[5],l}l.default=c}),98);
__d("MDSColumn.react",["BaseView.react","MDSColumnContext","MDSColumnItem.react","MDSColumnItemContext","isIE11OrGreater","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e=["ref","align","children","expanding","hasDividers","paddingHorizontal","paddingTop","paddingVertical","spacing","verticalAlign","xstyle"],s,u=s||(s=o("react")),c=s,d=c.useContext,m=c.useMemo,p={expanding:{flexBasis:"x1l7klhg",flexGrow:"x1iyjqo2",flexShrink:"xs83m0k",minHeight:"x2lwn1j",$$css:!0},expandingIE11:{flexBasis:"xdl72j9",$$css:!0},inner:{display:"x78zum5",flexDirection:"xdt5ytf",flexGrow:"x1iyjqo2",minHeight:"x2lwn1j",$$css:!0},root:{boxSizing:"x9f619",display:"x78zum5",flexDirection:"xdt5ytf",flexShrink:"x2lah0s",maxWidth:"x193iq5w",$$css:!0}},_={0:{paddingTop:"xexx8yu",$$css:!0},4:{paddingTop:"x1iorvi4",$$css:!0},8:{paddingTop:"x1y1aw1k",$$css:!0},12:{paddingTop:"xz9dl7a",$$css:!0},16:{paddingTop:"xyamay9",$$css:!0},20:{paddingTop:"x1cnzs8",$$css:!0}},f={4:{paddingTop:"x1iorvi4",paddingBottom:"xjkvuk6",$$css:!0},8:{paddingTop:"x1y1aw1k",paddingBottom:"xwib8y2",$$css:!0},12:{paddingTop:"xz9dl7a",paddingBottom:"xsag5q8",$$css:!0},16:{paddingTop:"xyamay9",paddingBottom:"x1l90r2v",$$css:!0},20:{paddingTop:"x1cnzs8",paddingBottom:"xx6bls6",$$css:!0}},g={bottom:{justifyContent:"x13a6bvl",$$css:!0},center:{justifyContent:"xl56j7k",$$css:!0},"space-between":{justifyContent:"x1qughib",$$css:!0}};function h(t){var n=o("react-compiler-runtime").c(43),a,i,l,s,c,m,h,y,C,b,v,S;n[0]!==t?(s=t.ref,c=t.align,a=t.children,m=t.expanding,h=t.hasDividers,y=t.paddingHorizontal,i=t.paddingTop,C=t.paddingVertical,b=t.spacing,v=t.verticalAlign,S=t.xstyle,l=babelHelpers.objectWithoutPropertiesLoose(t,e),n[0]=t,n[1]=a,n[2]=i,n[3]=l,n[4]=s,n[5]=c,n[6]=m,n[7]=h,n[8]=y,n[9]=C,n[10]=b,n[11]=v,n[12]=S):(a=n[1],i=n[2],l=n[3],s=n[4],c=n[5],m=n[6],h=n[7],y=n[8],C=n[9],b=n[10],v=n[11],S=n[12]);var L=c===void 0?null:c,E=m===void 0?!1:m,k=h===void 0?!1:h,I=y===void 0?null:y,T=C===void 0?0:C,D=b===void 0?null:b,x=v===void 0?"top":v,$=d(r("MDSColumnContext")),P;n[13]!==L||n[14]!==k||n[15]!==I||n[16]!==D?(P={align:L,hasDividers:k,paddingHorizontal:I,spacing:D},n[13]=L,n[14]=k,n[15]=I,n[16]=D,n[17]=P):P=n[17];var N=P,M;n[18]!==E?(M=E===!0&&[p.expanding,r("isIE11OrGreater")&&p.expandingIE11],n[18]=E,n[19]=M):M=n[19];var w=f[T],A=i!=null&&_[i],F;n[20]!==w||n[21]!==A||n[22]!==M||n[23]!==S?(F=[p.root,M,w,A,S],n[20]=w,n[21]=A,n[22]=M,n[23]=S,n[24]=F):F=n[24];var O=x!=="top"&&g[x],B;n[25]!==O?(B=[p.inner,O],n[25]=O,n[26]=B):B=n[26];var W;n[27]!==a?(W=R(a),n[27]=a,n[28]=W):W=n[28];var q;n[29]!==N||n[30]!==W?(q=u.jsx(r("MDSColumnContext").Provider,{value:N,children:W}),n[29]=N,n[30]=W,n[31]=q):q=n[31];var U;n[32]!==B||n[33]!==q?(U=u.jsx(r("BaseView.react"),{xstyle:B,children:q}),n[32]=B,n[33]=q,n[34]=U):U=n[34];var V;n[35]!==l||n[36]!==s||n[37]!==F||n[38]!==U?(V=u.jsx(r("BaseView.react"),babelHelpers.extends({},l,{ref:s,xstyle:F,children:U})),n[35]=l,n[36]=s,n[37]=F,n[38]=U,n[39]=V):V=n[39];var H=V;if($!=null){var G=E!=null?E:void 0,z;return n[40]!==H||n[41]!==G?(z=u.jsx(r("MDSColumnItem.react"),{expanding:G,children:H}),n[40]=H,n[41]=G,n[42]=z):z=n[42],z}return H}var y=h,C={isFirst:!0,isLast:!1},b={isFirst:!1,isLast:!0},v={isFirst:!0,isLast:!0},S={isFirst:!1,isLast:!1};function R(e){return u.Children.toArray(e).map(function(e,t,n){var o=t===0,a=t===n.length-1,i=o&&a?v:o?C:a?b:S;return u.jsx(r("MDSColumnItemContext").Provider,{value:i,children:e},t)})}l.default=y}),98);
__d("MDSPressable.react",["CometPressable.react","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e=["overlayRadius","ref"],s,u=s||(s=o("react")),c={hover:{backgroundColor:"x1yjz2vk",$$css:!0}};function d(e){switch(e){case"normal":return 6;case"50%":return"50%";case"compact":return 4;case"inherit":default:return}}function m(t){var n=o("react-compiler-runtime").c(10),a,i,l;n[0]!==t?(i=t.overlayRadius,l=t.ref,a=babelHelpers.objectWithoutPropertiesLoose(t,e),n[0]=t,n[1]=a,n[2]=i,n[3]=l):(a=n[1],i=n[2],l=n[3]);var s;n[4]!==i?(s=d(i),n[4]=i,n[5]=s):s=n[5];var m;return n[6]!==a||n[7]!==l||n[8]!==s?(m=u.jsx(r("CometPressable.react"),babelHelpers.extends({overlayFocusVisibleStyle:c.hover,overlayHoveredStyle:c.hover,overlayRadius:s,ref:l},a)),n[6]=a,n[7]=l,n[8]=s,n[9]=m):m=n[9],m}l.default=m}),98);
__d("MessengerCreateVideoMeetupLinkMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="9685249484907022"}),null);
__d("MessengerCreateVideoMeetupLinkMutation.graphql",["MessengerCreateVideoMeetupLinkMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"CreateVideoMeetupLinkResponsePayload",kind:"LinkedField",name:"create_video_meetup_link",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerCallInviteLink",kind:"LinkedField",name:"meetup_link",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link_hash",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_audio_only",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"MessengerCreateVideoMeetupLinkMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"MessengerCreateVideoMeetupLinkMutation",selections:t},params:{id:n("MessengerCreateVideoMeetupLinkMutation_facebookRelayOperation"),metadata:{},name:"MessengerCreateVideoMeetupLinkMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("MessengerCreateVideoMeetupLinkMutation",["MessengerCreateVideoMeetupLinkMutation.graphql","Promise","cr:1012418","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t,o,a){return new(s||(s=n("Promise")))(function(i,l){var s,u,c,d,m,p,_,f,g,h,y;n("cr:1012418").commitMutation(t,{mutation:e!==void 0?e:e=n("MessengerCreateVideoMeetupLinkMutation.graphql"),onCompleted:function(t){var e,n,r,o,a=t==null||(e=t.create_video_meetup_link)==null||(e=e.meetup_link)==null?void 0:e.is_audio_only,s=t==null||(n=t.create_video_meetup_link)==null||(n=n.meetup_link)==null?void 0:n.link_url,u=t==null||(r=t.create_video_meetup_link)==null||(r=r.meetup_link)==null?void 0:r.link_hash,c=t==null||(o=t.create_video_meetup_link)==null||(o=o.meetup_link)==null?void 0:o.id;return s!=null&&u!=null&&a!=null?i({isAudioOnly:a,linkHash:u,linkId:c,linkUrl:s}):l({error:"Failed to create linkurl."})},onError:function(t){l(t)},optimisticUpdater:null,variables:{input:{client_mutation_id:"",funnel_session_id:a,link_options:{availability_settings_options:(o==null?void 0:o.linkSurface)==="MESSENGER_V2"?{join_permission:o==null?void 0:o.joinPermission,visibility_mode:(s=o==null?void 0:o.visibilityMode)!=null?s:"NONE"}:void 0,chat_mode:(u=o==null?void 0:o.chatMode)!=null?u:null,is_audio_only:(c=o==null?void 0:o.isAudioOnly)!=null?c:null,is_live_enabled:(d=o==null?void 0:o.isLiveEnabled)!=null?d:null,is_room_join_requestable:(m=o==null?void 0:o.joinRequestable)!=null?m:null,link_surface:(p=o==null?void 0:o.linkSurface)!=null?p:r("gkx")("20836")?"WORKPLACE":void 0,revocation_behavior:(_=o==null?void 0:o.revocationBehavior)!=null?_:null,should_allow_anonymous_guests:(f=o==null?void 0:o.allowAnonymousGuests)!=null?f:!0,supports_pages:(g=o==null?void 0:o.supportsPages)!=null?g:!1,supports_profile_plus:(h=o==null?void 0:o.supportsProfilePlus)!=null?h:!1,visibility_mode:(o==null?void 0:o.linkSurface)==="MESSENGER_V2"?void 0:(y=o==null?void 0:o.visibilityMode)!=null?y:"NONE"}}}})})}l.default=u}),98);
__d("RoomsLinkUtils",["ConstUriUtils"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t,n=o("ConstUriUtils").getUri(e),r=n==null?void 0:n.getDomain(),a=n==null||(t=n.stripTrailingSlash())==null?void 0:t.getPath();if(a==null)return null;if(r==="msngr.com")return a.substring(1);var i=/^\/v(id)?\//;if(r==="m.me"&&i.test(a))return a.replace(i,"");var l=/^\/groupcall\/LINK:/;return l.test(a)?a.replace(l,""):null}l.getRoomsLinkHash=e}),98);
__d("VideoChatLinksUserActionsMultiplexLogger",["cr:1443591"],(function(t,n,r,o,a,i,l){"use strict";l.default=n("cr:1443591")}),98);
__d("XGroupCallControllerRouteBuilder",["jsRouteBuilder"],(function(t,n,r,o,a,i,l){var e=r("jsRouteBuilder")("/groupcall/{?call_context}/",Object.freeze({users_to_ring:[],has_video:!0,initialize_video:!0,auto_join:!1,use_joining_context:!1,has_seen_interstitial:!1,use_dapp:!1,is_e2ee_mandated:!1,use_www:!1}),void 0),s=e;l.default=s}),98);
__d("ZenonCallIdentifiersUtil",["Random"],(function(t,n,r,o,a,i,l){"use strict";function e(){return String(o("Random").uint32()+1)}l.generateZenonClientSessionID=e}),98);
__d("ZenonCallWindowErrors",[],(function(t,n,r,o,a,i){"use strict";var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="ZenonOpeningAnotherCallError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),l=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="ZenonConferenceNameMutationFailedError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),s=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="ZenonIncompleteControllerParamsError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),u=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="ZenonUnsupportedThreadTypeError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),c=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="ZenonCannotAcceptInviteError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),d=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="ZenonInviteNotFoundError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),m=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="ZenonUninitializedError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error));i.OpeningAnotherCallError=e,i.ConferenceNameMutationFailedError=l,i.IncompleteControllerParamsError=s,i.UnsupportedThreadTypeError=u,i.CannotAcceptInviteError=c,i.InviteNotFoundError=d,i.UninitializedError=m}),66);
__d("ZenonPeerID",["invariant"],(function(t,n,r,o,a,i,l,s){"use strict";var e="MW_PEER_ID";function u(t){return t.length>0||s(0,33504),t==="MW_PEER_ID"?e:(isNaN(t)===!1||s(0,33551,t),t)}function c(t){return isNaN(t)||t===e?null:t}l.ZenonMWPeerID=e,l.convertStringToPeerID=u,l.convertPeerIDForLogging=c}),98);
__d("randomZenonNonce",["Random"],(function(t,n,r,o,a,i,l){"use strict";var e=2,s=6,u=36,c=2176782336;function d(){for(var t="",n=0;n<e;n++){for(var r=Math.floor(o("Random").random()*c).toString(u);r.length<s;)r="0"+r;t+=r}return t}l.default=d}),98);
__d("ZenonPreCallHookBuilderHelper",["ConstUriUtils","FBLogger","MessengerCreateVideoMeetupLinkMutation","RoomsLinkUtils","VideoChatLinksUserActionsMultiplexLogger","XGroupCallControllerRouteBuilder","ZenonActorHooks","ZenonCallIdentifiersUtil","ZenonCallWindowErrors","ZenonPeerID","ZenonSignalingProtocol","getErrorSafe","gkx","nullthrows","randomZenonNonce"],(function(t,n,r,o,a,i,l){"use strict";async function e(e,t){if(e===null)throw new(o("ZenonCallWindowErrors")).UninitializedError;var n=e.callInviteModel,a=e.callWindowController,i=n.getCurrentInvite();if(i===null)throw new(o("ZenonCallWindowErrors")).InviteNotFoundError;if(i.type!=="ringing"||i.context.type!=="thread")throw new(o("ZenonCallWindowErrors")).CannotAcceptInviteError;var l=r("randomZenonNonce")(),s=i.context.thread,u=a.initCall({context:{controllerParams:i.controllerParams,intent:"accept invite"},hideE2eeAttributions:t,isE2eeMandated:i.isE2eeMandated,joinContext:{thread:s!=null?s:{id:"0",type:2},type:"thread"},mediaType:i.requestingVideo?"video":"audio",nonce:l,representedID:i.receiverUserId}),c=u[0],d=u[1];n.accept(l,{isPopupBlocked:c===null}),await d}async function s(e,t,n,a,i,l){if(l===void 0&&(l={allowAnonymousGuests:!r("gkx")("20836")}),e===null)throw new(o("ZenonCallWindowErrors")).UninitializedError;p(i,n,a).setEvent("meetup_attempt_create_meetup").log();try{var s=await r("MessengerCreateVideoMeetupLinkMutation")(t,l,i),u=s.linkUrl;return u!=null?(p(i,n,a).setEvent("meetup_create_success").setVideoCallLinkURLRaw(u).log(),u):(p(i,n,a).setEvent("meetup_create_failed").log(),u)}catch(e){var c=r("getErrorSafe")(e);throw p(i,n,a).setEvent("meetup_create_failed").log(),p(i,n,a).setEvent("error").setErrorType("LinkCreationError "+c.name).setErrorDetails(c.message).log(),c}}async function u(e){var t=e.actorID,n=e.callback_users,a=e.context,i=e.forceSkipChildLobby,l=i===void 0?!1:i,s=e.funnelSessionID,u=s===void 0?null:s,c=e.hasVideo,p=c===void 0?!0:c,_=e.linkUrl,f=e.referrerContext,g=f===void 0?null:f,h=e.skipLinkUrlRewrite,y=h===void 0?!1:h,C=e.startCallImmediately,b=C===void 0?!1:C,v=e.trigger;if(a===null)throw new(o("ZenonCallWindowErrors")).UninitializedError;var S=a.callWindowController,R=a.incomingRingSDK,L=r("randomZenonNonce")(),E=o("ZenonCallIdentifiersUtil").generateZenonClientSessionID(),k=_;if(!y){var I,T=(I=o("ConstUriUtils").getUri(_))==null?void 0:I.getQueryParam("funnel_session_id"),D=d(_);k=m(D,b?L:null,n,T!=null?String(T):u,l,g,t,v,p)}if(k==null)return Promise.reject("An invalid URI was provided");var x=S.initCall({context:{existingCall:null,intent:"start or join",invitees:[],signalingID:E},joinContext:{linkUrl:k,type:"link"},mediaType:"video",nonce:L,representedID:o("ZenonActorHooks").ZenonActor.getID()}),$=x[0],P=x[1];R.startCallIntent(L,{callTrigger:v!=null?v:"meetup_join",isE2eeMandated:!1,isPopupBlocked:$===null,isVideo:p,peerID:o("ZenonPeerID").ZenonMWPeerID,protocol:r("ZenonSignalingProtocol").MW,signalingID:E}),await P}async function c(e,t){var n=t.existingCall,a=t.extra,i=t.hideE2eeAttributions,l=t.invitees,s=t.isE2eeMandated,u=t.mediaType,c=t.representedID,d=t.thread,m=t.trigger;if(e===null)throw new(o("ZenonCallWindowErrors")).UninitializedError;var p=e.callWindowController,_=e.incomingRingSDK,f=o("ZenonCallIdentifiersUtil").generateZenonClientSessionID(),g=r("randomZenonNonce")(),h=p.initCall({context:{existingCall:n,intent:"start or join",invitees:l,signalingID:f},extra:a,hideE2eeAttributions:i,isE2eeMandated:s,joinContext:{thread:d,type:"thread"},mediaType:u,nonce:g,representedID:c!=null?c:o("ZenonActorHooks").ZenonActor.getID()}),y=h[0],C=h[1];_.startCallIntent(g,{callTrigger:m,isE2eeMandated:s!=null?s:!1,isPopupBlocked:y===null,isVideo:u==="video",peerID:d.type===1?d.id:o("ZenonPeerID").ZenonMWPeerID,protocol:r("ZenonSignalingProtocol").MW,signalingID:f}),await C}function d(e){var t=o("RoomsLinkUtils").getRoomsLinkHash(e);return t==null&&r("FBLogger")("rtc_www").mustfix('Could not extract LinkHash from Video Chat Link. Link = "%s"',e),t}function m(e,t,n,o,a,i,l,s,u){if(e==null)return"";var c={call_context:"LINK:"+e,call_trigger:s!=null?s:"",has_video:u,users_to_ring:n!=null?n:[]};return t!=null&&(c.nonce=t),o!=null&&(c.funnel_session_id=o),a===!0&&(c.auto_join=!0),i!=null&&(c.referrer_context=i),l!=null&&(c.av=l),r("nullthrows")(r("XGroupCallControllerRouteBuilder").buildUri(c).getQualifiedUri()).toString()}function p(e,t,n){return new(r("VideoChatLinksUserActionsMultiplexLogger"))().setFunnelSessionIDRaw(e).setSurface(t).setComponent(n)}l.acceptCall=e,l.createMeetup=s,l.joinMeetup=u,l.startCall=c}),98);
__d("useZenonCallInvite",["react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.useEffect,c=s.useState;function d(e){var t=o("react-compiler-runtime").c(5),n;t[0]!==e?(n=function(){return e?e.getCurrentInvite():null},t[0]=e,t[1]=n):n=t[1];var r=c(n),a=r[0],i=r[1],l,s;return t[2]!==e?(l=function(){if(e){var t=e.addListener("callInvite",i);return(function(){t.remove()})}else i(null)},s=[e],t[2]=e,t[3]=l,t[4]=s):(l=t[3],s=t[4]),u(l,s),a}l.default=d}),98);
__d("ZenonPreCallHookBuilder",["CometRelay","FBLogger","Promise","ZenonPreCallHookBuilderHelper","err","gkx","promiseDone","react","react-compiler-runtime","useZenonCallInvite"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=s||(s=o("react")),c=u.useCallback,d=u.useContext,m=u.useDebugValue,p=u.useEffect,_=6e4;function f(e){function t(t){var n=o("react-compiler-runtime").c(3),r=d(e),a;return n[0]!==r||n[1]!==t?(a=function(){return o("ZenonPreCallHookBuilderHelper").acceptCall(r,t)},n[0]=r,n[1]=t,n[2]=a):a=n[2],a}return t}function g(e){function t(){var t=d(e),n=r("useZenonCallInvite")(t?t.callInviteModel:null);return m(n),n}return t}function h(e,t){return function(n,a,i){function l(){var l=o("react-compiler-runtime").c(6),s=d(e),u=n(),c=a(),m=i(),p=t(),_;return l[0]!==s||l[1]!==u||l[2]!==c||l[3]!==m||l[4]!==p?(_=function(t){if(r("gkx")("24231")){var e=t.existingCall,n=t.thread;if(!s||!s.incomingRingSDK.isCallSupported({threadType:n.type,type:"thread"}))m(t);else e:switch(n.type){case 1:{r("promiseDone")(p(babelHelpers.extends({},t,{invitees:[n.id]})));break e}case 15:{if(n.secureOneToOneThreadPeerId==null)throw r("err")("secureOneToOneThreadPeerId should be defined when starting a call from a secure 1:1 thread");r("promiseDone")(p(babelHelpers.extends({},t,{invitees:[n.secureOneToOneThreadPeerId]})));break e}case 2:case 16:{e===null||e.call_state==="NO_ONGOING_CALL"?u(t,function(e){r("promiseDone")(p(babelHelpers.extends({},t,{invitees:e})))}):c(t,function(){r("promiseDone")(p(babelHelpers.extends({},t,{invitees:[]})))});break e}default:r("FBLogger")("rtc_www").blameToPreviousFrame().mustfix("Attempted to start RTC call for unsupported thread type %d",n.type)}}},l[0]=s,l[1]=u,l[2]=c,l[3]=m,l[4]=p,l[5]=_):_=l[5],_}return l}}function y(e,t){function n(){var n=o("react-compiler-runtime").c(4),r=d(e),a=t(),i,l;n[0]!==r||n[1]!==a?(i=function(){if(r&&a&&a.type==="ringing"){var e=window.setTimeout(function(){r.callInviteModel.decline("NoAnswerTimeout")},_);return(function(){window.clearTimeout(e)})}},l=[r,a],n[0]=r,n[1]=a,n[2]=i,n[3]=l):(i=n[2],l=n[3]),p(i,l)}return n}function C(t){function a(){var a=o("react-compiler-runtime").c(2),i=d(t),l;return a[0]!==i?(l=function(a){var t=a.existingCall,l=a.extra,s=a.hideE2eeAttributions,u=a.invitees,c=a.isE2eeMandated,d=a.mediaType,m=a.representedID,p=a.thread,_=a.trigger;return r("gkx")("24231")?o("ZenonPreCallHookBuilderHelper").startCall(i,{existingCall:t,extra:l,hideE2eeAttributions:s,invitees:u,isE2eeMandated:c,mediaType:d,representedID:m,thread:p,trigger:_}):(e||(e=n("Promise"))).resolve()},a[0]=i,a[1]=l):l=a[1],l}return a}function b(t){function a(){var a=o("react-compiler-runtime").c(3),i=d(t),l=o("CometRelay").useRelayEnvironment(),s;return a[0]!==i||a[1]!==l?(s=function(a,s,u,c){return r("gkx")("24231")?o("ZenonPreCallHookBuilderHelper").createMeetup(i,l,a,s,u,c):(e||(e=n("Promise"))).resolve(null)},a[0]=i,a[1]=l,a[2]=s):s=a[2],s}return a}function v(t){function a(){var a=o("react-compiler-runtime").c(2),i=d(t),l;return a[0]!==i?(l=function(a,l){var t=l===void 0?{}:l;if(!r("gkx")("24231"))return(e||(e=n("Promise"))).resolve();var s=t!=null?t:{},u=s.actorID,c=s.callbackUsers,d=s.mediaType,m=s.referrerContext,p=s.startCallImmediately,_=s.trigger;return o("ZenonPreCallHookBuilderHelper").joinMeetup({actorID:u,callback_users:c,context:i,forceSkipChildLobby:!1,hasVideo:d!=null?d==="video":!0,linkUrl:a,referrerContext:m,startCallImmediately:p,trigger:_})},a[0]=i,a[1]=l):l=a[1],l}return a}l.createAcceptCallCallbackHook=f,l.createCallInviteHook=g,l.createInviteAndStartCallCallbackHookFactory=h,l.createNoAnswerTimeoutHook=y,l.createStartCallCallbackHook=C,l.createCreateMeetupCallbackHook=b,l.createJoinMeetupCallbackHook=v}),98);
__d("RTWebPreCallHooks",["RTWebPreCallContext","ZenonPreCallHookBuilder"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(s=o("ZenonPreCallHookBuilder")).createAcceptCallCallbackHook(e=r("RTWebPreCallContext")),c=s.createCallInviteHook(e),d=s.createNoAnswerTimeoutHook(e,c),m=s.createStartCallCallbackHook(e),p=s.createCreateMeetupCallbackHook(e),_=s.createJoinMeetupCallbackHook(e),f=s.createInviteAndStartCallCallbackHookFactory(e,m);l.useAcceptCallCallback=u,l.useCallInvite=c,l.useNoAnswerTimeout=d,l.useStartCallCallback=m,l.useCreateMeetupCallback=p,l.useJoinMeetupCallback=_,l.createInviteAndStartCallCallbackHook=f}),98);
__d("VideoChatLinksUserActionsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(){this.$1={}}var t=e.prototype;return t.log=function(t){n("GeneratedLoggerUtils").log("logger:VideoChatLinksUserActionsLoggerConfig",this.$1,n("Banzai").BASIC,t)},t.logVital=function(t){n("GeneratedLoggerUtils").log("logger:VideoChatLinksUserActionsLoggerConfig",this.$1,n("Banzai").VITAL,t)},t.logImmediately=function(t){n("GeneratedLoggerUtils").log("logger:VideoChatLinksUserActionsLoggerConfig",this.$1,{signal:!0},t)},t.clear=function(){return this.$1={},this},t.getData=function(){return babelHelpers.extends({},this.$1)},t.updateData=function(t){return this.$1=babelHelpers.extends({},this.$1,t),this},t.setCallEndReason=function(t){return this.$1.call_end_reason=t,this},t.setCallID=function(t){return this.$1.call_id=t,this},t.setCameraEnabled=function(t){return this.$1.camera_enabled=t,this},t.setClientAppVersion=function(t){return this.$1.client_app_version=t,this},t.setClientLockStatus=function(t){return this.$1.client_lock_status=t,this},t.setClientMonoTimeMs=function(t){return this.$1.client_mono_time_ms=t,this},t.setClienttime=function(t){return this.$1.clienttime=t,this},t.setComponent=function(t){return this.$1.component=t,this},t.setConferenceNameRaw=function(t){return this.$1.conference_name_raw=t,this},t.setCreationAction=function(t){return this.$1.creation_action=t,this},t.setErrorDetails=function(t){return this.$1.error_details=t,this},t.setErrorType=function(t){return this.$1.error_type=t,this},t.setEvent=function(t){return this.$1.event=t,this},t.setEventDetails=function(t){return this.$1.event_details=n("GeneratedLoggerUtils").serializeMap(t),this},t.setEventFireTimestamp=function(t){return this.$1.event_fire_timestamp=t,this},t.setEventFireTimestampOnClient=function(t){return this.$1.event_fire_timestamp_on_client=t,this},t.setExceptionObject=function(t){return this.$1.exception_object=t,this},t.setExperimentsEnabled=function(t){return this.$1.experiments_enabled=n("GeneratedLoggerUtils").serializeMap(t),this},t.setFalcoBatchSequence=function(t){return this.$1.falco_batch_sequence=t,this},t.setFunnelSessionIDRaw=function(t){return this.$1.funnel_session_id_raw=t,this},t.setGroupID=function(t){return this.$1.group_id=t,this},t.setGroupSize=function(t){return this.$1.group_size=t,this},t.setGuestUserID=function(t){return this.$1.guest_user_id=t,this},t.setKickedUserID=function(t){return this.$1.kicked_user_id=t,this},t.setLinkShareTo=function(t){return this.$1.link_share_to=t,this},t.setLocalCallID=function(t){return this.$1.local_call_id=t,this},t.setMediaDevices=function(t){return this.$1.media_devices=t,this},t.setMicrophoneEnabled=function(t){return this.$1.microphone_enabled=t,this},t.setOpenLinkFrom=function(t){return this.$1.open_link_from=t,this},t.setOpenLinkFromAppVersion=function(t){return this.$1.open_link_from_app_version=t,this},t.setReason=function(t){return this.$1.reason=t,this},t.setReferralSurface=function(t){return this.$1.referral_surface=t,this},t.setRoomIDRaw=function(t){return this.$1.room_id_raw=t,this},t.setServerInfoData=function(t){return this.$1.server_info_data=t,this},t.setSource=function(t){return this.$1.source=t,this},t.setStatus=function(t){return this.$1.status=t,this},t.setSurface=function(t){return this.$1.surface=t,this},t.setTargetedUserIds=function(t){return this.$1.targeted_user_ids=n("GeneratedLoggerUtils").serializeVector(t),this},t.setThreadSyncRoomData=function(t){return this.$1.thread_sync_room_data=n("GeneratedLoggerUtils").serializeMap(t),this},t.setThreadType=function(t){return this.$1.thread_type=t,this},t.setUserIdsToBeRemoved=function(t){return this.$1.user_ids_to_be_removed=n("GeneratedLoggerUtils").serializeVector(t),this},t.setVideoCallLinkHashRaw=function(t){return this.$1.video_call_link_hash_raw=t,this},t.setVideoCallLinkIDRaw=function(t){return this.$1.video_call_link_id_raw=t,this},t.setVideoCallLinkIdentifierRaw=function(t){return this.$1.video_call_link_identifier_raw=t,this},t.setVideoCallLinkURLRaw=function(t){return this.$1.video_call_link_url_raw=t,this},t.updateExtraData=function(t){var e=n("nullthrows")(n("GeneratedLoggerUtils").serializeMap(t));return n("GeneratedLoggerUtils").checkExtraDataFieldNames(e,l),this.$1=babelHelpers.extends({},this.$1,e),this},t.addToExtraData=function(t,n){var e={};return e[t]=n,this.updateExtraData(e)},e})(),l={call_end_reason:!0,call_id:!0,camera_enabled:!0,client_app_version:!0,client_lock_status:!0,client_mono_time_ms:!0,clienttime:!0,component:!0,conference_name_raw:!0,creation_action:!0,error_details:!0,error_type:!0,event:!0,event_details:!0,event_fire_timestamp:!0,event_fire_timestamp_on_client:!0,exception_object:!0,experiments_enabled:!0,falco_batch_sequence:!0,funnel_session_id_raw:!0,group_id:!0,group_size:!0,guest_user_id:!0,kicked_user_id:!0,link_share_to:!0,local_call_id:!0,media_devices:!0,microphone_enabled:!0,open_link_from:!0,open_link_from_app_version:!0,reason:!0,referral_surface:!0,room_id_raw:!0,server_info_data:!0,source:!0,status:!0,surface:!0,targeted_user_ids:!0,thread_sync_room_data:!0,thread_type:!0,user_ids_to_be_removed:!0,video_call_link_hash_raw:!0,video_call_link_id_raw:!0,video_call_link_identifier_raw:!0,video_call_link_url_raw:!0};i.default=e}),66);
__d("ZenonProductConnectFunnel",["FBLogger","performanceNow","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(){return Math.trunc((e||(e=r("performanceNow")))())},u=(function(){function e(){this.$6=null,this.$7=null,this.$1=null,this.$2=null,this.$3=null,this.$4=null,this.$5=null,this.$8=new Map,this.$9=new Map}var t=e.prototype;return t.$10=function(t){var e=this.$8.get(t);if(e!=null)return e;e={acceptedTs:this.$3,connectedTs:null,connectingTs:null,contactingTs:null,endCallTs:null,permissionsReceivedTs:this.$5,permissionsRequestTs:this.$4,ringingTs:this.$2,triggeredTs:this.$1};var n={cameraPermission:this.$6,microphonePermission:this.$7};return this.clearPreJoinTimings(),this.$8.set(t,e),this.$9.set(t,n),e},t.$11=function(t,n){var e,o=t==null||(e=t.getLogIdentifiers())==null?void 0:e.clientSessionID;if(o==null){r("FBLogger")("rtc_www").warn("ProductConnectFunnel: could not record UI event due to missing signaling ID");return}var a=this.$10(o);a[n]==null&&(a[n]=s())},t.getTimings=function(t){return this.$8.get(t)},t.getPreJoinTimings=function(){return{acceptedTs:this.$3,ringingTs:this.$2,triggeredTs:this.$1}},t.clearPreJoinTimings=function(){this.$3=null,this.$2=null,this.$1=null,this.$4=null,this.$5=null,this.$6=null,this.$7=null},t.setPreJoinTimings=function(t){this.$3=t.acceptedTs,this.$2=t.ringingTs,this.$1=t.triggeredTs},t.getAnnotations=function(t){return this.$9.get(t)},t.remove=function(t){this.clearPreJoinTimings(),this.$8.delete(t),this.$9.delete(t)},t.setUITriggered=function(){var e;(e=this.$1)!=null||(this.$1=s())},t.setUIPermissionsRequest=function(){var e=this;if(!(this.$4!=null||!navigator.permissions)){this.$4=s();var t=navigator.permissions;r("promiseDone")(t.query({name:"microphone"}).then(function(t){e.$7=t.state})),r("promiseDone")(t.query({name:"camera"}).then(function(t){e.$6=t.state}))}},t.setUIPermissionsReceived=function(){var e;this.$4!=null&&((e=this.$5)!=null||(this.$5=s()))},t.setUIAccepted=function(){var e;(e=this.$3)!=null||(this.$3=s())},t.setUIConnected=function(t){this.$11(t,"connectedTs")},t.setUIConnecting=function(t){this.$11(t,"connectingTs")},t.setUIRinging=function(){var e;(e=this.$2)!=null||(this.$2=s())},t.setUIContacting=function(t){this.$11(t,"contactingTs")},t.setUIEnded=function(t){this.$11(t,"endCallTs")},e})(),c=new u;l.default=c}),98);
__d("bs_caml_array",[],(function(t,n,r,o,a,i){"use strict";function e(e,t,n){for(var r=new Array(n),o=0,a=t;o<n;)r[o]=e[a],o=o+1|0,a=a+1|0;return r}function l(e,t){for(;;){var n=t,r=e;if(!n)return r;t=n.tl,e=n.hd.length+r|0}}function s(e,t,n){for(;;){var r=n,o=t;if(!r)return;for(var a=r.hd,i=a.length,l=o,s=0;s<i;)e[l]=a[s],l=l+1|0,s=s+1|0;n=r.tl,t=l}}function u(e){var t=l(0,e),n=new Array(t);return s(n,0,e),n}function c(e,t,n){if(t<0||t>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};e[t]=n}function d(e,t){if(t<0||t>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};return e[t]}function m(e,t){for(var n=new Array(e),r=0;r<e;++r)n[r]=t;return n}function p(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function _(e,t,n,r,o){if(r<=t){for(var a=0;a<o;++a)n[a+r|0]=e[a+t|0];return}for(var i=o-1|0;i>=0;--i)n[i+r|0]=e[i+t|0]}function f(e){return e.slice(0)}i.dup=f,i.sub=e,i.concat=u,i.make=m,i.make_float=p,i.blit=_,i.get=d,i.set=c}),null);
__d("bs_curry",["bs_caml_array"],(function(t,n,r,o,a,i){"use strict";function e(t,r){for(;;){var o=r,a=t,i=a.length,l=i===0?1:i,s=o.length,u=l-s|0;if(u===0)return a.apply(null,o);if(u>=0)return(function(t,n){return function(r){return e(t,n.concat([r]))}})(a,o);r=n("bs_caml_array").sub(o,l,-u|0),t=a.apply(null,n("bs_caml_array").sub(o,0,l))}}function l(t,n){var r=t.length;if(r===1)return t(n);switch(r){case 1:return t(n);case 2:return function(e){return t(n,e)};case 3:return function(e,r){return t(n,e,r)};case 4:return function(e,r,o){return t(n,e,r,o)};case 5:return function(e,r,o,a){return t(n,e,r,o,a)};case 6:return function(e,r,o,a,i){return t(n,e,r,o,a,i)};case 7:return function(e,r,o,a,i,l){return t(n,e,r,o,a,i,l)};default:return e(t,[n])}}function s(e){var t=e.length;return t===1?e:function(t){return l(e,t)}}function u(t,n,r){var o=t.length;if(o===2)return t(n,r);switch(o){case 1:return e(t(n),[r]);case 2:return t(n,r);case 3:return function(e){return t(n,r,e)};case 4:return function(e,o){return t(n,r,e,o)};case 5:return function(e,o,a){return t(n,r,e,o,a)};case 6:return function(e,o,a,i){return t(n,r,e,o,a,i)};case 7:return function(e,o,a,i,l){return t(n,r,e,o,a,i,l)};default:return e(t,[n,r])}}function c(e){var t=e.length;return t===2?e:function(t,n){return u(e,t,n)}}function d(t,n,r,o){var a=t.length;if(a===3)return t(n,r,o);switch(a){case 1:return e(t(n),[r,o]);case 2:return e(t(n,r),[o]);case 3:return t(n,r,o);case 4:return function(e){return t(n,r,o,e)};case 5:return function(e,a){return t(n,r,o,e,a)};case 6:return function(e,a,i){return t(n,r,o,e,a,i)};case 7:return function(e,a,i,l){return t(n,r,o,e,a,i,l)};default:return e(t,[n,r,o])}}function m(e){var t=e.length;return t===3?e:function(t,n,r){return d(e,t,n,r)}}function p(t,n,r,o,a){var i=t.length;if(i===4)return t(n,r,o,a);switch(i){case 1:return e(t(n),[r,o,a]);case 2:return e(t(n,r),[o,a]);case 3:return e(t(n,r,o),[a]);case 4:return t(n,r,o,a);case 5:return function(e){return t(n,r,o,a,e)};case 6:return function(e,i){return t(n,r,o,a,e,i)};case 7:return function(e,i,l){return t(n,r,o,a,e,i,l)};default:return e(t,[n,r,o,a])}}function _(e){var t=e.length;return t===4?e:function(t,n,r,o){return p(e,t,n,r,o)}}function f(t,n,r,o,a,i){var l=t.length;if(l===5)return t(n,r,o,a,i);switch(l){case 1:return e(t(n),[r,o,a,i]);case 2:return e(t(n,r),[o,a,i]);case 3:return e(t(n,r,o),[a,i]);case 4:return e(t(n,r,o,a),[i]);case 5:return t(n,r,o,a,i);case 6:return function(e){return t(n,r,o,a,i,e)};case 7:return function(e,l){return t(n,r,o,a,i,e,l)};default:return e(t,[n,r,o,a,i])}}function g(e){var t=e.length;return t===5?e:function(t,n,r,o,a){return f(e,t,n,r,o,a)}}function h(t,n,r,o,a,i,l){var s=t.length;if(s===6)return t(n,r,o,a,i,l);switch(s){case 1:return e(t(n),[r,o,a,i,l]);case 2:return e(t(n,r),[o,a,i,l]);case 3:return e(t(n,r,o),[a,i,l]);case 4:return e(t(n,r,o,a),[i,l]);case 5:return e(t(n,r,o,a,i),[l]);case 6:return t(n,r,o,a,i,l);case 7:return function(e){return t(n,r,o,a,i,l,e)};default:return e(t,[n,r,o,a,i,l])}}function y(e){var t=e.length;return t===6?e:function(t,n,r,o,a,i){return h(e,t,n,r,o,a,i)}}function C(t,n,r,o,a,i,l,s){var u=t.length;if(u===7)return t(n,r,o,a,i,l,s);switch(u){case 1:return e(t(n),[r,o,a,i,l,s]);case 2:return e(t(n,r),[o,a,i,l,s]);case 3:return e(t(n,r,o),[a,i,l,s]);case 4:return e(t(n,r,o,a),[i,l,s]);case 5:return e(t(n,r,o,a,i),[l,s]);case 6:return e(t(n,r,o,a,i,l),[s]);case 7:return t(n,r,o,a,i,l,s);default:return e(t,[n,r,o,a,i,l,s])}}function b(e){var t=e.length;return t===7?e:function(t,n,r,o,a,i,l){return C(e,t,n,r,o,a,i,l)}}function v(t,n,r,o,a,i,l,s,u){var c=t.length;if(c===8)return t(n,r,o,a,i,l,s,u);switch(c){case 1:return e(t(n),[r,o,a,i,l,s,u]);case 2:return e(t(n,r),[o,a,i,l,s,u]);case 3:return e(t(n,r,o),[a,i,l,s,u]);case 4:return e(t(n,r,o,a),[i,l,s,u]);case 5:return e(t(n,r,o,a,i),[l,s,u]);case 6:return e(t(n,r,o,a,i,l),[s,u]);case 7:return e(t(n,r,o,a,i,l,s),[u]);default:return e(t,[n,r,o,a,i,l,s,u])}}function S(e){var t=e.length;return t===8?e:function(t,n,r,o,a,i,l,s){return v(e,t,n,r,o,a,i,l,s)}}i.app=e,i._1=l,i.__1=s,i._2=u,i.__2=c,i._3=d,i.__3=m,i._4=p,i.__4=_,i._5=f,i.__5=g,i._6=h,i.__6=y,i._7=C,i.__7=b,i._8=v,i.__8=S}),null);
__d("bs_belt_Option",["bs_caml_option","bs_curry"],(function(t,n,r,o,a,i){"use strict";function e(e,t){if(e!==void 0&&t(n("bs_caml_option").valFromOption(e)))return e}function l(t,r){return e(t,n("bs_curry").__1(r))}function s(e,t){if(e!==void 0)return t(n("bs_caml_option").valFromOption(e))}function u(e,t){return s(e,n("bs_curry").__1(t))}function c(e){if(e!==void 0)return n("bs_caml_option").valFromOption(e);throw{RE_EXN_ID:"Not_found",Error:new Error}}function d(e,t,r){return e!==void 0?r(n("bs_caml_option").valFromOption(e)):t}function m(e,t,r){return d(e,t,n("bs_curry").__1(r))}function p(e,t){if(e!==void 0)return n("bs_caml_option").some(t(n("bs_caml_option").valFromOption(e)))}function _(e,t){return p(e,n("bs_curry").__1(t))}function f(e,t){if(e!==void 0)return t(n("bs_caml_option").valFromOption(e))}function g(e,t){return f(e,n("bs_curry").__1(t))}function h(e,t){return e!==void 0?n("bs_caml_option").valFromOption(e):t}function y(e){return e!==void 0}function C(e){return e===void 0}function b(e,t,r){return e!==void 0?t!==void 0?r(n("bs_caml_option").valFromOption(e),n("bs_caml_option").valFromOption(t)):!1:t===void 0}function v(e,t,r){return b(e,t,n("bs_curry").__2(r))}function S(e,t,r){return e!==void 0?t!==void 0?r(n("bs_caml_option").valFromOption(e),n("bs_caml_option").valFromOption(t)):1:t!==void 0?-1:0}function R(e,t,r){return S(e,t,n("bs_curry").__2(r))}i.keepU=e,i.keep=l,i.forEachU=s,i.forEach=u,i.getExn=c,i.mapWithDefaultU=d,i.mapWithDefault=m,i.mapU=p,i.map=_,i.flatMapU=f,i.flatMap=g,i.getWithDefault=h,i.isSome=y,i.isNone=C,i.eqU=b,i.eq=v,i.cmpU=S,i.cmp=R}),null);
__d("getAssetsByType",[],(function(t,n,r,o,a,i){"use strict";function e(e){return{adAccount:e.filter(function(e){return e.type==="AD_ACCOUNT"}),appAccount:e.filter(function(e){return e.type==="APP"}),igAccount:e.filter(function(e){return e.type==="INSTAGRAM_ACCOUNT_V2"}),pageAccount:e.filter(function(e){return e.type==="PAGE"}),wabAccount:e.filter(function(e){return e.type==="WHATSAPP_BUSINESS_ACCOUNT"})}}i.default=e}),66);
__d("getFirstAssetOfType",[],(function(t,n,r,o,a,i){"use strict";function e(e,t){return e.find(function(e){return e.type===t})}i.default=e}),66);
__d("useBizKitSelectedAssets",["BizKitScopingContext","getAssetsByType","getFirstAssetOfType","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useContext;function u(){var e,t,n=s(r("BizKitScopingContext")),o=n.assets,a=n.setAssets,i=(e=(t=r("getFirstAssetOfType")(o,"PAGE"))!=null?t:o[0])!=null?e:null;return{assetID:i==null?void 0:i.id,assets:o,assetsByType:r("getAssetsByType")(o),assetType:i==null?void 0:i.type,setAssets:a,setSelectedLinkedAsset:function(t){a(t.assets)}}}l.default=u}),98);
__d("useGroupCallBlockedUserWarningInterstitial",["I64","JSResourceForInteraction","MAWMiActMappingTableAPI","Promise","ReQL","WAJids","nullthrows","react","react-compiler-runtime","useBlockedUserInterstitial","useMWXLazyDialog","useReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=(c||(c=o("react"))).useCallback,m=function(t,r,a){return r===!0?t.runInTransaction(function(e){return o("MAWMiActMappingTableAPI").getThreadKeyForChatJid(e,o("WAJids").unsafeCoerceToChatJid(a+"@g.us"))},"readonly",void 0,void 0,i.id+":41"):(s||(s=n("Promise"))).resolve((u||(u=o("I64"))).of_string(a))};function p(e,t,n){return o("useBlockedUserInterstitial").getBlockedUserQuery(e,t,r("nullthrows")(n)).then(function(e){return e==null?[]:o("ReQL").toArrayAsync(e).then(function(e){return e})})}function _(){var t=o("react-compiler-runtime").c(6),n=(e||(e=r("useReStore")))(),a;t[0]===Symbol.for("react.memo_cache_sentinel")?(a=r("JSResourceForInteraction")("MWReceivedGroupCallBlockedUserInGroupInterstitialDialog.react").__setRef("useGroupCallBlockedUserWarningInterstitial"),t[0]=a):a=t[0];var i=r("useMWXLazyDialog")(a),l=i[0],s;t[1]===Symbol.for("react.memo_cache_sentinel")?(s=r("JSResourceForInteraction")("MWGroupCallBlockedUserInGroupInterstitialDialog.react").__setRef("useGroupCallBlockedUserWarningInterstitial"),t[1]=s):s=t[1];var u=r("useMWXLazyDialog")(s),c=u[0],d;return t[2]!==n||t[3]!==c||t[4]!==l?(d=function(t){var e=t.callType,o=t.isE2eeMandated,a=t.onContinue,i=t.threadID,s=t.threadType;m(n,o,i).then(function(t){return t==null?a():p(n,t,r("nullthrows")(s)).then(function(n){if(n.length===0)return a();e==="start"?c({blockedUsers:n,onContinue:a,threadKey:t}):l({blockedUsers:n,onContinue:a,threadKey:t})})})},t[2]=n,t[3]=c,t[4]=l,t[5]=d):d=t[5],d}l.fetchThreadKeyFromID=m,l.getBlockedUsers=p,l.useGroupCallBlockedUserWarningInterstitial=_}),98);